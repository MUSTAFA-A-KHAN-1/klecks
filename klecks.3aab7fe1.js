!function(){function $parcel$export(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}function $parcel$resolve(e){if(e=parcelRequire.i?.[e]||e,!$parcel$bundleURL)try{throw Error()}catch(i){var t=(""+i.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(!t)return $parcel$distDir+e;$parcel$bundleURL=t[0]}return new URL($parcel$distDir+e,$parcel$bundleURL).toString()}function $parcel$extendImportMap(e){Object.assign(parcelRequire.i??={},e)}function $parcel$interopDefault(e){return e&&e.__esModule?e.default:e}var $parcel$bundleURL,$6796041293c91113$export$9852986a3ec5f6a0,$8df31a3769a54937$export$77aefb1076e6c10f,$8df31a3769a54937$export$48c2d0f2f545ac27,$8df31a3769a54937$export$d7b7311ec04a3e8f,$c08bd94435b4b84a$export$8bb18c96af1baaf3,$c08bd94435b4b84a$export$eea3e4f737fa39e3,$c08bd94435b4b84a$export$d1eb619e8f7efb22,$c08bd94435b4b84a$export$2f48b40a5a83dc1b,$5043c756765ef749$export$7b388ca536128c6d,$5043c756765ef749$export$62d58b1c91e8e902,$5043c756765ef749$export$84aa927130f1a919,$5043c756765ef749$export$ee483a02838ec162,$5043c756765ef749$export$e114d13b1a258938,$4c230b0de5e1a470$var$kl2PsdMap,$4c230b0de5e1a470$var$psd2KlMap,$e304e157140fab16$export$cc1a246adca07dd4,$6d7e036695a5135c$export$6bf57c7f0219f07d,$d0eaf415184a9ac7$export$a2d3d93c57d16a1a,$1f208ea7a7967b27$export$41a461248611663e,$d23dd65cd1a3f1f7$export$56c1e4693edf08f9,$e2421ddcce10c8e2$export$1009f0178778a981,$a78ee5b112786af3$export$5385b9a82993d2c8,$b4cbc69301f7091d$export$d3c0448523aecc2e,$830938a01a5571f6$export$a061a4a5d124ecc0,$faa26ded1880cb9a$export$3d7865934588d77e,$adc6fc25ebf8fc6e$export$9e83d65c7ba90739,$7d7aa6fd00f3e48f$export$73c2705cb2da08ab,$cb51e19a22472144$export$cd01a11ba097c64c,$5ac773a3339b2d5e$export$c17cb29bf4746ec8,$ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2,$5c76476020892ee7$export$e9c6a0495dc4055f,$35f0e6a9a0aa9be9$export$143a800d561d28fd,$a49f5cd2bf596e66$export$2e559b10bdb6bb80,$a591b6a325fc72d7$export$2ede450fbdbb4e4c,$b315ee1492430f48$export$9506977ce2a96a5b,$6d37125ffb90f03e$export$20d70ee9873a8ba,$4ffd794d8a54e991$export$483bfb5d033dec0c,$f36d91ca9b37c82f$export$bd46b8ab3689edc4,$f36d91ca9b37c82f$export$b5381822af66064b,$e87f92103dc0908f$export$48c2d0f2f545ac27,$34d04701a8a02997$export$bd7a7a9fa7e7f04b,$deb6b884ba4ae312$export$5822a9d0880a5d82,$e0143068cd462268$var$floatPrecision,$a12fba8bc3214c1d$var$agPsdLazy,$7bc9f014309fd931$export$d4ef1ef99f1461a4,$8c9a65b29d77fa51$export$1c6ca1c73436aa3c,$31a0dd41d7428d32$var$preferenceIsTransparentBg,$b07b255a18a05a27$export$bb5ee47d9ea2348e,$b07b255a18a05a27$export$534219b709288da9,$b07b255a18a05a27$export$8001e369bcc9b474,$b07b255a18a05a27$export$efe229eab43a9869,$b07b255a18a05a27$export$ad430d422a89f9f0,$b07b255a18a05a27$export$48c2d0f2f545ac27,$b07b255a18a05a27$export$4a3e8128f471434a,$b07b255a18a05a27$export$e8e78c978b129247,$b07b255a18a05a27$export$bbeb943159d69f5b,$parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$distDir="./",$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire94c2;null==parcelRequire&&((parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var i={id:e,exports:{}};return $parcel$modules[e]=i,t.call(i.exports,i,i.exports),i.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire94c2=parcelRequire);var parcelRegister=parcelRequire.register;parcelRegister("cx0mh",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}}),parcelRegister("7h4XF",function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}$parcel$export(e.exports,"_",function(){return n})}),parcelRegister("8mlhh",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("5RGAp")).then(function(){return parcelRequire("fz5vW")})}),parcelRegister("ih7W4",function(e,t){"use strict";e.exports=parcelRequire("5Y6Bl")(function(e){return new Promise(function(t,i){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e}))return void t();var n=document.createElement("link");n.href=e,n.rel="preload",n.as="script",document.head.appendChild(n);var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.src=e,r.onerror=function(t){var n=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));r.onerror=r.onload=null,r.remove(),i(n)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),parcelRegister("5Y6Bl",function(e,t){"use strict";var i={},n={},r={};function a(e){switch(e){case"preload":return n;case"prefetch":return r;default:return i}}e.exports=function(e,t){return function(i){var n=a(t);return n[i]?n[i]:n[i]=e.apply(null,arguments).catch(function(e){throw delete n[i],e})}}}),parcelRegister("hLG03",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("3uTpJ")).then(function(){return parcelRequire("5xWmk")})}),parcelRegister("kJrPi",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("4XbAZ")).then(function(){return parcelRequire("gFNXg")})}),parcelRegister("bI71U",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("2bKIP")).then(function(){return parcelRequire("iGIhP")})}),parcelRegister("eICi1",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("i0BNf")).then(function(){return parcelRequire("9105N")})}),parcelRegister("kqusB",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("98Cvg")).then(function(){return parcelRequire("dH6Cx")})}),parcelRegister("57GX6",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("y5edP")).then(function(){return parcelRequire("7ZPTi")})}),parcelRegister("h75GH",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("9fDFY")).then(function(){return parcelRequire("2Ylu6")})}),parcelRegister("55azR",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("cW2nR")).then(function(){return parcelRequire("aeHic")})}),parcelRegister("fWO0c",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("8ucza")).then(function(){return parcelRequire("52L7X")})}),parcelRegister("4zES7",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("f3RKT")).then(function(){return parcelRequire("hmSlK")})}),parcelRegister("7KXHm",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("fVlhe")).then(function(){return parcelRequire("cmxjs")})}),parcelRegister("aqoL6",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("kcBSP")).then(function(){return parcelRequire("6vhv2")})}),parcelRegister("7TgKV",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("4RByM")).then(function(){return parcelRequire("3bjy6")})}),parcelRegister("2HU4B",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("ap9yw")).then(function(){return parcelRequire("aWNha")})}),parcelRegister("lWIVr",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("dsJ3g")).then(function(){return parcelRequire("blNy6")})}),parcelRegister("bGxAd",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("lF1Tu")).then(function(){return parcelRequire("iRLcJ")})}),parcelRegister("dJPtW",function(e,t){$parcel$export(e.exports,"Input",function(){return s}),$parcel$export(e.exports,"input",function(){return o});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("eWjiX"),a=parcelRequire("7jh4K"),s=function(){"use strict";function e(t){var n,s,o=this;(0,i._)(this,e),this.keyListener={destroy:function(){}},this.rootEl=r.BB.el({tagName:"label",content:t.label,css:{display:"flex",alignItems:"center",gap:"5px"}}),this.input=r.BB.el({tagName:"input",parent:this.rootEl,title:t.title,custom:{name:t.name}}),this.type=null!=(n=t.type)?n:"text";try{this.input.type=this.type}catch(e){}var l=null!=(s=t.step)?s:1;"number"===this.type&&(void 0!==t.min&&(this.input.min=""+t.min),void 0!==t.max&&(this.input.max=""+t.max),void 0!==t.step&&(this.input.step=""+l)),this.input.value=""+t.init;var h=this.input.value,c=function(){var e=h,i=o.input.value;if(t.doResetIfInvalid){var n=!1;""===i&&(i=h,n=!0),void 0!==t.min&&parseFloat(i)<t.min&&(i=""+t.min,n=!0),void 0!==t.max&&parseFloat(i)>t.max&&(i=""+t.max,n=!0),n&&(o.input.value=""+i)}return h=i,e!==i};if(t.onChange){var u=t.onChange;this.input.onchange=function(){c()&&u(o.input.value)}}if(t.css&&(0,a.css)(this.input,t.css),t.doScrollWithoutFocus&&"number"===t.type&&t.onChange){var d=t.onChange;this.keyListener=new r.BB.KeyListener({}),this.pointerListener=new r.BB.PointerListener({target:this.input,onWheel:function(e){var t=o.keyListener.isPressed("shift")?4:1;o.input.value=""+(parseFloat(o.input.value)-e.deltaY*l*t),c()&&d(o.input.value)}})}}return(0,n._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getValue",value:function(){return this.input.value}},{key:"setValue",value:function(e){this.input.value=""+e}},{key:"destroy",value:function(){this.pointerListener&&this.pointerListener.destroy(),this.keyListener.destroy()}}]),e}(),o=function(e){var t=document.createElement("input");if(e.type)try{t.type=e.type}catch(e){}else t.type="text";return void 0!==e.min&&(t.min=""+e.min),void 0!==e.max&&(t.max=""+e.max),t.value=""+e.init,e.callback&&(t.onchange=function(){e.callback(t.value)}),e.css&&(0,a.css)(t,e.css),t}}),parcelRegister("eWjiX",function(e,t){$parcel$export(e.exports,"BB",function(){return k});var i=parcelRequire("7jh4K"),n=parcelRequire("6J2My"),r=parcelRequire("idV3L"),a=parcelRequire("04lDo"),s=parcelRequire("eIcQa"),o=parcelRequire("kVHNC"),l=parcelRequire("4toIY"),h=parcelRequire("af1iA"),c=parcelRequire("dJ1E2"),u=parcelRequire("72Jv0"),d=parcelRequire("eg83P"),p=parcelRequire("eelgW"),f=parcelRequire("i0uIf"),g=parcelRequire("6l0gQ"),v=parcelRequire("jjWRi"),m=parcelRequire("2pgVs"),y=parcelRequire("joplQ"),x=parcelRequire("c1lmK"),b=parcelRequire("635F6"),w=parcelRequire("gCzYB"),k={eventUsesHighResTimeStamp:n.EVENT_USES_HIGH_RES_TIMESTAMP,hasPointerEvents:n.HAS_POINTER_EVENTS,isCssMinMaxSupported:n.IS_CSS_MIN_MAX_SUPPORTED,canShareFiles:n.canShareFiles,unsetEventHandler:n.unsetEventHandler,insertAfter:i.insertAfter,loadImage:i.loadImage,css:i.css,setAttributes:i.setAttributes,append:i.append,fitInto:i.fitInto,centerWithin:i.centerWithin,getDate:i.getDate,gcd:i.gcd,reduce:i.reduce,decToFraction:i.decToFraction,imageBlobToUrl:i.imageBlobToUrl,dateDayDifference:i.dateDayDifference,copyObj:i.copyObj,shareCanvas:i.shareCanvas,handleClick:i.handleClick,createSvg:i.createSvg,BbLog:f.BbLog,LocalStorage:g.LocalStorage,throwIfNull:i.throwIfNull,nullToUndefined:i.nullToUndefined,isDark:i.isDark,mix:d.mix,dist:d.dist,distSquared:d.distSquared,lenSquared:d.lenSquared,pointsToAngleRad:d.pointsToAngleRad,pointsToAngleDeg:d.pointsToAngleDeg,isInsideRect:d.isInsideRect,clamp:d.clamp,rotate:d.rotate,rotateAround:d.rotateAround,Matrix:o.Matrix,Vec2:l.Vec2,intDxy:d.intDxy,roundEven:d.roundEven,roundUneven:d.roundUneven,round:d.round,updateBounds:d.updateBounds,boundsInArea:d.boundsInArea,projectPointOnLine:h.projectPointOnLine,PointLine:h.PointLine,BezierLine:h.BezierLine,SplineInterpolator:h.SplineInterpolator,powerSplineInput:h.powerSplineInput,canvas:p.createCanvas,ctx:s.ctx,copyCanvas:s.copyCanvas,testShouldPixelate:s.testShouldPixelate,drawTransformedImageWithBounds:s.drawTransformedImageWithBounds,drawTransformedImageOnCanvas:s.drawTransformedImageOnCanvas,createCheckerCanvas:s.createCheckerCanvas,createCheckerDataUrl:s.createCheckerDataUrl,resizeCanvas:s.resizeCanvas,convertToAlphaChannelCanvas:s.convertToAlphaChannelCanvas,freeCanvas:s.freeCanvas,canvasBounds:s.canvasBounds,HSV:c.HSV,RGB:c.RGB,CMYK:c.CMYK,ColorConverter:c.ColorConverter,testIsWhiteBestContrast:c.testIsWhiteBestContrast,appendTextDiv:u.appendTextDiv,clearSelection:u.clearSelection,el:u.el,destroyEl:u.destroyEl,isInputFocused:u.isInputFocused,unfocusAnyInput:u.unfocusAnyInput,KeyListener:r.KeyListener,PointerListener:a.PointerListener,sameKeys:r.sameKeys,EventChain:w.EventChain,DoubleTapper:x.DoubleTapper,NFingerTapper:m.NFingerTapper,PinchZoomer:y.PinchZoomer,CoalescedExploder:v.CoalescedExploder,OnePointerLimiter:b.OnePointerLimiter};Object.keys(k)}),parcelRegister("7jh4K",function(e,t){$parcel$export(e.exports,"insertAfter",function(){return a}),$parcel$export(e.exports,"loadImage",function(){return s}),$parcel$export(e.exports,"asyncLoadImage",function(){return o}),$parcel$export(e.exports,"css",function(){return l}),$parcel$export(e.exports,"setAttributes",function(){return h}),$parcel$export(e.exports,"append",function(){return c}),$parcel$export(e.exports,"fitInto",function(){return u}),$parcel$export(e.exports,"centerWithin",function(){return d}),$parcel$export(e.exports,"getDate",function(){return p}),$parcel$export(e.exports,"gcd",function(){return f}),$parcel$export(e.exports,"reduce",function(){return g}),$parcel$export(e.exports,"decToFraction",function(){return v}),$parcel$export(e.exports,"isBlob",function(){return m}),$parcel$export(e.exports,"imageBlobToUrl",function(){return y}),$parcel$export(e.exports,"dateDayDifference",function(){return x}),$parcel$export(e.exports,"copyObj",function(){return b}),$parcel$export(e.exports,"shareCanvas",function(){return w}),$parcel$export(e.exports,"handleClick",function(){return k}),$parcel$export(e.exports,"createSvg",function(){return B}),$parcel$export(e.exports,"throwIfNull",function(){return S}),$parcel$export(e.exports,"throwIfUndefined",function(){return C}),$parcel$export(e.exports,"nullToUndefined",function(){return E}),$parcel$export(e.exports,"isDark",function(){return I}),$parcel$export(e.exports,"addIsDarkListener",function(){return T}),$parcel$export(e.exports,"base64ToBlob",function(){return M}),$parcel$export(e.exports,"createArray",function(){return L}),$parcel$export(e.exports,"randomUuid",function(){return R}),$parcel$export(e.exports,"sleep",function(){return P}),$parcel$export(e.exports,"timeoutWrapper",function(){return A});var i=parcelRequire("1LaJZ"),n=parcelRequire("8N5YG"),r=parcelRequire("2gUX3");function a(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function s(e,t){var i=0;function n(){1e3===i?alert("couldn't load"):e.complete?(i++,t()):setTimeout(n,1)}n()}function o(e){return new Promise(function(t,i){var n=new Image;n.onload=function(){return t(n)},n.onerror=i,n.src=e})}function l(e,t){var i=e.style;Object.keys(t).forEach(function(e){var n=e;i[n]=t[n],"userSelect"===n&&(i.webkitUserSelect=t[n])})}function h(e,t){for(var i,n=Object.keys(t),r=0;r<n.length;r++)i=n[r],e.setAttribute(i,t[i])}function c(e,t){var i=document.createDocumentFragment();t.forEach(function(e){return e&&i.append(e)}),e.append(i)}function u(e,t,i,n,r){var a=e*i,s=t*i;return a>i&&(s=i/a*s,a=i),s>n&&(a=n/s*a,s=n),r&&(a=Math.max(r,a),s=Math.max(r,s)),{width:a,height:s}}function d(e,t,i,n){return{x:e/2-i/2,y:t/2-n/2}}function p(){var e=new Date;return e.getFullYear()+"_"+(e.getMonth()+1).toString().padStart(2,"0")+"_"+e.getDate().toString().padStart(2,"0")+"_"+(60*e.getHours()+e.getMinutes()).toString(36).padStart(3,"0")+"_"}function f(e,t){return t?f(t,e%t):e}function g(e,t){var i=f(e,t);return[e/i,t/i]}function v(e){var t=Math.pow(10,e.toString().length-2);return g(e*t,t)}function m(e){return e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e)}function y(e){if(!e)throw Error("blobObj is undefined or null");if(window.Blob&&e instanceof Blob)return URL.createObjectURL(e);if("Object"===e.constructor.name){var t=e;return"data:"+t.type+";"+t.encoding+","+t.data}throw Error("unknown blob format")}function x(e,t){return e=new Date(e),t=new Date(t),e.setHours(0,0,0,0),t.setHours(0,0,0,0),(t.getTime()-e.getTime())/864e5}function b(e){return JSON.parse(JSON.stringify(e))}function w(e){var t="image/png",i=function(){return alert("sharing not supported")};e.canvas.toBlob(function(n){if(!n){i(),e.callback();return}try{var r=[new File([n],e.fileName,{type:t})];navigator.share({title:e.title,files:r}).then(function(){}).catch(function(){i()})}catch(e){i()}e.callback()},t)}function k(e){var t=e.target;if(!t)return!1;for(var i=t;i;){if(["A","LABEL","INPUT","SUMMARY"].includes(i.tagName))return!0;i=i.parentElement}return e.preventDefault(),!1}function B(e){var t=document.createElementNS("http://www.w3.org/2000/svg",e.elementType);return Object.entries(e).forEach(function(e){var i=(0,n._)(e,2),r=i[0],a=i[1];"childrenArr"===r?a.forEach(function(e){t.append(B(e))}):"css"===r?l(t,a):"elementType"!==r&&t.setAttribute(r,a)}),t}function S(e){if(null===e)throw Error("value is null");return e}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value is undefined";if(void 0===e)throw Error(t);return e}function E(e){return null===e?void 0:e}var _="matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)");function I(){return _&&_.matches}function T(e){_&&"addEventListener"in _&&_.addEventListener("change",e)}function M(e){for(var t=e.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),i=atob(t[3]),n=new Uint8Array(new ArrayBuffer(i.length)),r=0;r<n.length;r++)n[r]=i.charCodeAt(r);return new Blob([n],{type:t[1]})}function L(e,t){return Array(e).fill(t)}function R(){return"randumUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function P(e){return new Promise(function(t){return setTimeout(t,e)})}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return(0,i._)(function(){return(0,r.__generator)(this,function(i){return[2,Promise.race([e,new Promise(function(e,i){setTimeout(function(){return i(Error(`Promise "${t}" timed out.`))},n)})])]})})()}}),parcelRegister("1LaJZ",function(e,t){function i(e,t,i,n,r,a,s){try{var o=e[a](s),l=o.value}catch(e){i(e);return}o.done?t(l):Promise.resolve(l).then(n,r)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var s=e.apply(t,n);function o(e){i(s,r,a,o,l,"next",e)}function l(e){i(s,r,a,o,l,"throw",e)}o(void 0)})}}$parcel$export(e.exports,"_",function(){return n})}),parcelRegister("8N5YG",function(e,t){$parcel$export(e.exports,"_",function(){return s});var i=parcelRequire("vDBh4"),n=parcelRequire("lMMat"),r=parcelRequire("keO5I"),a=parcelRequire("kWe4k");function s(e,t){return(0,i._)(e)||(0,n._)(e,t)||(0,a._)(e,t)||(0,r._)()}}),parcelRegister("vDBh4",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){if(Array.isArray(e))return e}}),parcelRegister("lMMat",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e,t){var i,n,r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}}),parcelRegister("keO5I",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}),parcelRegister("kWe4k",function(e,t){$parcel$export(e.exports,"_",function(){return n});var i=parcelRequire("gszWS");function n(e,t){if(e){if("string"==typeof e)return(0,i._)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return(0,i._)(e,t)}}}),parcelRegister("gszWS",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}}),parcelRegister("2gUX3",function(e,t){$parcel$export(e.exports,"__generator",function(){return n}),$parcel$export(e.exports,"__values",function(){return a});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function n(e,t){var i,n,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(e){return function(t){return l([e,t])}}function l(o){if(i)throw TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var r=Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]};function a(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,a=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return s}function o(e){return this instanceof o?(this.v=e,this):new o(e)}var l=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},h=function(e){return(h=Object.getOwnPropertyNames||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[t.length]=i);return t})(e)},c="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var n=Error(i);return n.name="SuppressedError",n.error=e,n.suppressed=t,n}}),parcelRegister("6J2My",function(e,t){$parcel$export(e.exports,"IS_FIREFOX",function(){return i}),$parcel$export(e.exports,"EVENT_USES_HIGH_RES_TIMESTAMP",function(){return n}),$parcel$export(e.exports,"HAS_POINTER_EVENTS",function(){return r}),$parcel$export(e.exports,"IS_CSS_MIN_MAX_SUPPORTED",function(){return a}),$parcel$export(e.exports,"canShareFiles",function(){return s}),$parcel$export(e.exports,"unsetEventHandler",function(){return o});var i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,n=function(){var e=new Event("").timeStamp<36e5;return function(){return e}}(),r=!!window.PointerEvent,a=function(){var e;function t(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="max(0px, 25px)",document.body.append(t),setTimeout(function(){e=25===t.offsetLeft,t.remove()},25)}return document.body?t():window.addEventListener("DOMContentLoaded",function(){t()}),function(){if(void 0===e)throw Error("isCssMinMaxSupported not initialized");return e}}(),s=function(){return"share"in navigator&&"canShare"in navigator};function o(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];i.forEach(function(t){e[t]=null})}}),parcelRegister("idV3L",function(e,t){$parcel$export(e.exports,"KeyListener",function(){return s}),$parcel$export(e.exports,"sameKeys",function(){return o});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("8N5YG"),a=function(){var e,t=function(t){var i=t.key,r=t.code;if(i in l){var a=l[i];if(o[a])return void p(a,t,h.join("+"),!0);"cmd"===a?d(a,r):clearTimeout(e),"esc"===a&&setTimeout(function(){return n()}),o[a]=!0,c[r]=a,h.push(a),p(a,t,h.join("+"))}},i=function(e){var t=e.code,i=h.join("+");if(["Meta","MetaLeft","MetaRight","OSLeft","OSRight"].includes(t)||o.cmd)return void n();var r=c[t];if(void 0!==r){o[r]=!1,c[t]=void 0;for(var a=0;a<h.length;a++)h[a]==r&&(h.splice(a,1),a--);f(r,e,i)}},n=function(){var e=h.join("+");h=[],c={};var t=[];s.forEach(function(e){o[e]&&(o[e]=!1,t.push(e))});for(var i=0;i<t.length;i++)f(t[i],{preventDefault:function(){},stopPropagation:function(){}},e);g()},a={space:[" ","Spacebar"],alt:["Alt","AltGraph"],shift:"Shift",ctrl:"Control",cmd:["Meta","MetaLeft","MetaRight"],enter:"Enter",esc:"Escape",backspace:"Backspace",delete:"Delete",sqbr_open:"[",sqbr_close:"]",a:["a","A"],b:["b","B"],c:["c","C"],e:["e","E"],f:["f","F"],g:["g","G"],l:["l","L"],r:["r","R"],s:["s","S"],t:["t","T"],u:["u","U"],x:["x","X"],y:["y","Y"],z:["z","Z"],plus:"+",minus:"-",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",home:"Home",end:"End"},s=Object.keys(a),o=Object.entries(a).reduce(function(e,t){return e[(0,r._)(t,1)[0]]=!1,e},{}),l=Object.entries(a).reduce(function(e,t){var i=(0,r._)(t,2),n=i[0],a=i[1];return"string"==typeof a?e[a]=n:a.forEach(function(t){e[t]=n}),e},{}),h=[],c={},u=[],d=function(t,i){e=setTimeout(function(){if(1===h.length&&"cmd"!==h[0]){var n=h.join("+");o[t]=!1,c[i]=void 0;for(var r=0;r<h.length;r++)h[r]==t&&(h.splice(r,1),r--);f(t,{preventDefault:function(){},stopPropagation:function(){}},n),e=void 0}},1e3)},p=function(e,t,i,n){u.forEach(function(r){r[0]&&r[0](e,t,i,n)})},f=function(e,t,i){u.forEach(function(n){n[1]&&n[1](e,t,i)})},g=function(){u.forEach(function(e){e[2]&&e[2]()})};return{add:function(e){if(!u.includes(e)){var r=0===u.length;u.push(e),r&&(document.addEventListener("keydown",t),document.addEventListener("keyup",i),window.addEventListener("blur",n))}},remove:function(e){if(u.includes(e)){for(var r=1===u.length,a=0;a<u.length;a++)if(u[a]===e){u.splice(a,1);break}r&&(document.removeEventListener("keydown",t),document.removeEventListener("keyup",i),window.removeEventListener("blur",n))}},getIsDown:function(){return o},getCombo:function(){return h},blur:n}}(),s=function(){"use strict";function e(t){(0,i._)(this,e),this.onDown=t.onDown,this.onUp=t.onUp,this.onBlur=t.onBlur,this.ref=[this.onDown,this.onUp,this.onBlur],a.add(this.ref)}return(0,n._)(e,[{key:"isPressed",value:function(e){if(!(e in a.getIsDown()))throw'key "'+e+'" not found';return a.getIsDown()[e]}},{key:"getComboStr",value:function(){return a.getCombo().join("+")}},{key:"comboOnlyContains",value:function(e){for(var t=0;t<a.getCombo().length;t++)if(!e.includes(a.getCombo()[t]))return!1;return!0}},{key:"destroy",value:function(){a.remove(this.ref),a.blur()}}]),e}();function o(e,t){return e.split("+").sort().join("+")===t.split("+").sort().join("+")}}),parcelRegister("04lDo",function(e,t){$parcel$export(e.exports,"PointerListener",function(){return B});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("cL71g"),a=parcelRequire("4EWN2"),s=parcelRequire("6J2My"),o=parcelRequire("93oLo"),l=parcelRequire("eIAon"),h=[];function c(e){var t={pointerId:e.pointerId,lastPageX:null,lastPageY:null};return h.push(t),h.length>15&&h.shift(),t}function u(e){for(var t=h.length-1;t>=0;t--)if(e.pointerId===h[t].pointerId)return h[t];return null}function d(e){switch(e){case 1:return"left";case 2:return"right";case 4:return"middle";default:return}}var p=new(0,l.PressureNormalizer),f=(0,s.EVENT_USES_HIGH_RES_TIMESTAMP)()?0:-performance.timing.navigationStart,g=s.HAS_POINTER_EVENTS?"pointerdown":"mousedown",v=s.HAS_POINTER_EVENTS?"pointermove":"mousemove",m=s.HAS_POINTER_EVENTS?"pointerup":"mouseup",y=s.HAS_POINTER_EVENTS?"pointercancel":"mousecancel",x=s.HAS_POINTER_EVENTS?"pointerleave":"mouseleave",b=s.HAS_POINTER_EVENTS?"pointerenter":"mouseenter";function w(e){if("corrected"in e)return e.corrected;function t(){return void 0!==e.buttons?e.buttons:void 0!==e.button?[1,4,2,8,16][e.button]:0}var i={pointerId:e.pointerId,pointerType:e.pointerType,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY,timeStamp:e.timeStamp+f,pressure:p.normalize(e.pressure,e.type,e.pointerType),buttons:t(),button:e.button,coalescedArr:[],eventPreventDefault:function(){return e.preventDefault()},eventStopPropagation:function(){return e.stopPropagation()}};e.corrected=i;var n=null;"pointerId"in e?"pressure"in e&&0!==e.buttons&&("touch"===e.pointerType&&0===e.pressure&&(i.pressure=1,n=1),"mouse"===e.pointerType&&(.5===e.pressure||0===e.pressure)&&(i.pressure=1,n=1)):(i.pointerId=0,i.pointerType="mouse",i.pressure=+(0!==e.buttons),n=i.pressure),s.IS_FIREFOX&&"mouse"!=e.pointerType&&"pointermove"===e.type&&0===e.buttons&&(i.buttons=1);var r=[];"getCoalescedEvents"in e&&(r=e.getCoalescedEvents());for(var a=u(i)||c(i),o=a.lastPageX,l=a.lastPageY,h=0;h<r.length;h++){var d=r[h];i.coalescedArr.push({pageX:d.pageX,pageY:d.pageY,clientX:d.clientX,clientY:d.clientY,movementX:null===a.lastPageX?0:d.pageX-a.lastPageX,movementY:null===a.lastPageY?0:d.pageY-a.lastPageY,timeStamp:0===d.timeStamp?i.timeStamp:d.timeStamp+f,pressure:null===n?p.normalize(d.pressure):n}),a.lastPageX=d.pageX,a.lastPageY=d.pageY}return a.lastPageX=i.pageX,a.lastPageY=i.pageY,i.movementX=null===o?0:a.lastPageX-o,i.movementY=null===l?0:a.lastPageY-l,i}var k={passive:!1},B=function(){"use strict";function e(t){var n,l=this;(0,i._)(this,e),this.isDestroyed=!1,this.isOverCounter=0,this.dragObjArr=[],this.dragPointerIdArr=[],this.lastPointerType=null,this.didSkip=!1,this.targetElement=t.target,this.onPointerCallback=t.onPointer,this.onWheelCallback=t.onWheel,this.onEnterLeaveCallback=t.onEnterLeave,this.maxPointers=Math.max(1,null!=(n=t.maxPointers)?n:1);var h=function(e){if(!l.isDestroyed&&l.onWheelCallback){var t=l.targetElement.getBoundingClientRect(),i=(0,r._)((0,a._)((0,r._)({},e instanceof WheelEvent?{deltaY:e.deltaY/120,pageX:e.pageX,pageY:e.pageY}:e),{relX:e.clientX-t.left+l.targetElement.scrollLeft,relY:e.clientY-t.top+l.targetElement.scrollTop}),e instanceof WheelEvent?{event:e}:{});l.onWheelCallback(i)}};if(this.wheelCleaner=t.useDirtyWheel?void 0:new(0,o.WheelCleaner)(h),this.onPointerCallback&&(this.onPointerMove=function(e){var t,i,n=w(e),r=l.lastPointerType;if(l.lastPointerType=n.pointerType,l.dragPointerIdArr.includes(n.pointerId)||l.dragPointerIdArr.length===l.maxPointers||"touch"===n.pointerType){l.didSkip=!1;return}if(!l.didSkip&&"mouse"===n.pointerType&&"pen"===r){l.didSkip=!0;return}l.didSkip=!1;var a=l.createPointerOutEvent("pointermove",n);null==(t=(i=l).onPointerCallback)||t.call(i,a)},this.onPointerDown=function(e,t){var i,n,r=w(e);if(!l.dragPointerIdArr.includes(r.pointerId)&&l.dragPointerIdArr.length!==l.maxPointers&&[1,2,4].includes(r.buttons)){0!==l.dragObjArr.length||t||l.setupDocumentListeners();var a={pointerId:r.pointerId,pointerType:r.pointerType,downPageX:r.pageX,downPageY:r.pageY,buttons:r.buttons,lastPageX:r.pageX,lastPageY:r.pageY,lastTimeStamp:r.timeStamp};l.dragObjArr.push(a),l.dragPointerIdArr.push(r.pointerId);var s=l.createPointerOutEvent("pointerdown",r,{downPageX:r.pageX,downPageY:r.pageY,button:d(r.buttons),pressure:r.pressure});null==(i=(n=l).onPointerCallback)||i.call(n,s)}},this.windowOnPointerMove=function(e){var t=w(e);if(l.dragPointerIdArr.includes(t.pointerId)){var i=l.getDragObj(t.pointerId);if(i){if(t.buttons!==i.buttons){1===l.dragObjArr.length&&l.destroyDocumentListeners(),l.removeDragObj(t.pointerId);var n,r,a,s,o=l.createPointerOutEvent("pointerup",t,{downPageX:i.downPageX,downPageY:i.downPageY});null==(a=(s=l).onPointerCallback)||a.call(s,o);return}if("pen"!==t.pointerType||t.pageX!==i.lastPageX||t.pageY!==i.lastPageY||t.timeStamp!==i.lastTimeStamp){var h=l.createPointerOutEvent("pointermove",t,{downPageX:i.downPageX,downPageY:i.downPageY,button:d(t.buttons),pressure:t.pressure});i.lastPageX=t.pageX,i.lastPageY=t.pageY,i.lastTimeStamp=t.timeStamp,null==(n=(r=l).onPointerCallback)||n.call(r,h)}}}},this.windowOnPointerUp=function(e){var t,i,n=w(e);if(l.dragPointerIdArr.includes(n.pointerId)){1===l.dragObjArr.length&&l.destroyDocumentListeners();var r=l.removeDragObj(n.pointerId);if(r){var a=l.createPointerOutEvent("pointerup",n,{downPageX:r.downPageX,downPageY:r.downPageY});null==(t=(i=l).onPointerCallback)||t.call(i,a)}}},this.windowOnPointerLeave=function(e){var t,i,n=w(e);if(l.dragPointerIdArr.includes(n.pointerId)){1===l.dragObjArr.length&&l.destroyDocumentListeners();var r=l.removeDragObj(n.pointerId);if(r){var a=l.createPointerOutEvent("pointerup",n,{downPageX:r.downPageX,downPageY:r.downPageY});null==(t=(i=l).onPointerCallback)||t.call(i,a)}}},this.targetElement.addEventListener(v,this.onPointerMove,k),this.targetElement.addEventListener(g,this.onPointerDown,k),!s.HAS_POINTER_EVENTS)){var c=function(e,t,i){return{pointerId:e.identifier,pointerType:"touch",pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY,button:i?0:void 0,buttons:+!!i,timeStamp:t.timeStamp,target:t.target,pressure:+!!i,preventDefault:function(){return t.preventDefault()},stopPropagation:function(){return t.stopPropagation()}}},u=function(e,t){for(var i=0;i<e.changedTouches.length;i++){var n=c(e.changedTouches[i],e,["start","move"].includes(t));"start"===t?l.onPointerDown(n,!1):"move"===t?l.windowOnPointerMove(n):"end"===t?l.windowOnPointerUp(n):l.windowOnPointerLeave(n)}};this.onTouchStart=function(e){e.preventDefault(),u(e,"start")},this.onTouchMove=function(e){u(e,"move")},this.onTouchEnd=function(e){u(e,"end")},this.onTouchCancel=function(e){u(e,"cancel")},this.targetElement.addEventListener("touchstart",this.onTouchStart,k),this.targetElement.addEventListener("touchmove",this.onTouchMove,k),this.targetElement.addEventListener("touchend",this.onTouchEnd,k),this.targetElement.addEventListener("touchcancel",this.onTouchCancel,k)}this.onWheelCallback&&(this.onWheel=function(e){l.wheelCleaner?l.wheelCleaner.process(e):h(e)},this.targetElement.addEventListener("wheel",this.onWheel,{passive:!!t.isWheelPassive})),this.onEnterLeaveCallback&&(this.onPointerEnter=function(){var e,t;l.isOverCounter++,null==(e=(t=l).onEnterLeaveCallback)||e.call(t,!0)},this.onPointerLeave=function(){var e,t;l.isOverCounter--,null==(e=(t=l).onEnterLeaveCallback)||e.call(t,!1)},this.targetElement.addEventListener(b,this.onPointerEnter,k),this.targetElement.addEventListener(x,this.onPointerLeave,k)),t.fixScribble&&(this.onTouchMoveScribbleFix=function(e){return e.preventDefault()},this.targetElement.addEventListener("touchmove",this.onTouchMoveScribbleFix,k))}return(0,n._)(e,[{key:"getDragObj",value:function(e){for(var t=0;t<this.dragObjArr.length;t++)if(e===this.dragObjArr[t].pointerId)return this.dragObjArr[t];return null}},{key:"removeDragObj",value:function(e){for(var t=null,i=0;i<this.dragPointerIdArr.length;i++)this.dragPointerIdArr[i]===e&&(t=this.dragObjArr[i],this.dragObjArr.splice(i,1),this.dragPointerIdArr.splice(i,1),i--);return t}},{key:"createPointerOutEvent",value:function(e,t,i){var n,a=this.targetElement.getBoundingClientRect(),s=(0,r._)({type:e,pointerId:t.pointerId,pointerType:t.pointerType,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,relX:t.clientX-a.left+this.targetElement.scrollLeft,relY:t.clientY-a.top+this.targetElement.scrollTop,dX:t.movementX,dY:t.movementY,time:t.timeStamp,eventPreventDefault:t.eventPreventDefault,eventStopPropagation:t.eventStopPropagation},i);if("pointermove"===e&&(s.coalescedArr=[],t.coalescedArr.length>1))for(var o=0;o<t.coalescedArr.length;o++)n=t.coalescedArr[o],s.coalescedArr.push({pageX:n.pageX,pageY:n.pageY,clientX:n.clientX,clientY:n.clientY,relX:n.clientX-a.left+this.targetElement.scrollLeft,relY:n.clientY-a.top+this.targetElement.scrollTop,dX:n.movementX,dY:n.movementY,time:n.timeStamp});return s}},{key:"setupDocumentListeners",value:function(){this.windowOnPointerMove&&document.addEventListener(v,this.windowOnPointerMove,k),this.windowOnPointerUp&&document.addEventListener(m,this.windowOnPointerUp,k),this.windowOnPointerLeave&&document.addEventListener(y,this.windowOnPointerLeave,k),this.windowOnPointerLeave&&document.addEventListener(x,this.windowOnPointerLeave,k)}},{key:"destroyDocumentListeners",value:function(){this.windowOnPointerMove&&document.removeEventListener(v,this.windowOnPointerMove),this.windowOnPointerUp&&document.removeEventListener(m,this.windowOnPointerUp),this.windowOnPointerLeave&&document.removeEventListener(y,this.windowOnPointerLeave),this.windowOnPointerLeave&&document.removeEventListener(x,this.windowOnPointerLeave)}},{key:"destroy",value:function(){!this.isDestroyed&&(this.isDestroyed=!0,this.onPointerEnter&&this.targetElement.removeEventListener(b,this.onPointerEnter),this.onPointerLeave&&this.targetElement.removeEventListener(x,this.onPointerLeave),this.onPointerMove&&this.targetElement.removeEventListener(v,this.onPointerMove),this.onPointerDown&&this.targetElement.removeEventListener(g,this.onPointerDown),this.onWheel&&this.targetElement.removeEventListener("wheel",this.onWheel),this.destroyDocumentListeners(),this.onTouchMoveScribbleFix&&document.removeEventListener("touchmove",this.onTouchMoveScribbleFix),this.onTouchStart&&this.targetElement.removeEventListener("touchstart",this.onTouchStart),this.onTouchMove&&this.targetElement.removeEventListener("touchmove",this.onTouchMove),this.onTouchEnd&&this.targetElement.removeEventListener("touchend",this.onTouchEnd),this.onTouchCancel&&this.targetElement.removeEventListener("touchcancel",this.onTouchCancel))}}]),e}()}),parcelRegister("cL71g",function(e,t){$parcel$export(e.exports,"_",function(){return n});var i=parcelRequire("exh8t");function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){(0,i._)(e,t,n[t])})}return e}}),parcelRegister("exh8t",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}}),parcelRegister("4EWN2",function(e,t){function i(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function n(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}),e}$parcel$export(e.exports,"_",function(){return n})}),parcelRegister("93oLo",function(e,t){$parcel$export(e.exports,"WheelCleaner",function(){return a});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=200,a=function(){"use strict";function e(t){(0,i._)(this,e),this.callback=t,this.knownUnitArr=[100],this.sequenceLength=0,this.sequenceUnit=null,this.toEmitDelta=null,this.position=null}return(0,n._)(e,[{key:"emit",value:function(e){null!==this.position&&null!==this.sequenceUnit&&this.callback({deltaY:Math.round(e/this.sequenceUnit),pageX:this.position.pageX,pageY:this.position.pageY,clientX:this.position.clientX,clientY:this.position.clientY})}},{key:"endSequence",value:function(){null!==this.toEmitDelta&&(this.emit(this.toEmitDelta),this.toEmitDelta=null),null===this.sequenceUnit||this.knownUnitArr.includes(this.sequenceUnit)||this.knownUnitArr.push(this.sequenceUnit),this.sequenceLength=0,this.sequenceUnit=null}},{key:"process",value:function(e){var t=this;this.position={pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY},this.endSequenceTimeout&&clearTimeout(this.endSequenceTimeout),this.endSequenceTimeout=setTimeout(function(){return t.endSequence()},r);var i=e.deltaY;"deltaMode"in e&&1===e.deltaMode&&(i*=100/3);var n=Math.abs(i);if(0===this.sequenceLength){if(this.sequenceLength++,n<50)return;this.sequenceUnit=n,this.knownUnitArr.includes(this.sequenceUnit)?this.emit(i):this.toEmitDelta=i;return}if(null===this.sequenceUnit){this.toEmitDelta=null;return}if(0!==n){if(n===this.sequenceUnit||n/this.sequenceUnit%1<1e-4);else if(this.sequenceUnit/n%1<1e-4)this.sequenceUnit=n;else if(n!==this.sequenceUnit){this.sequenceUnit=null,this.toEmitDelta=null;return}null!==this.toEmitDelta&&(this.emit(this.toEmitDelta),this.toEmitDelta=null),this.emit(i)}}}]),e}()}),parcelRegister("eIAon",function(e,t){$parcel$export(e.exports,"PressureNormalizer",function(){return r});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=function(){"use strict";function e(){(0,i._)(this,e),this.detectionComplete=!1,this.isApplePencil=!1,this.initialPointerDownPressure=-1,this.pointerDownPressureRepeatCount=0,this.pointerMoveHasDifferentPressure=!1}return(0,n._)(e,[{key:"normalize",value:function(e,t,i){if("pen"!==i)return e;if(!this.detectionComplete&&("pointerdown"===t?-1===this.initialPointerDownPressure?this.initialPointerDownPressure=e:this.initialPointerDownPressure===e?(this.pointerDownPressureRepeatCount++,this.pointerDownPressureRepeatCount>1&&this.pointerMoveHasDifferentPressure&&(this.detectionComplete=!0,this.isApplePencil=!0)):(this.detectionComplete=!0,this.isApplePencil=!1):"pointermove"===t&&this.initialPointerDownPressure!==e&&(this.pointerMoveHasDifferentPressure=!0)),this.detectionComplete&&this.isApplePencil){if(this.initialPointerDownPressure===e)return 0;e=Math.min(2,2*e)}return e}}]),e}()}),parcelRegister("eIcQa",function(e,t){$parcel$export(e.exports,"copyCanvas",function(){return o}),$parcel$export(e.exports,"ctx",function(){return l}),$parcel$export(e.exports,"testShouldPixelate",function(){return h}),$parcel$export(e.exports,"drawTransformedImageWithBounds",function(){return c}),$parcel$export(e.exports,"drawTransformedImageOnCanvas",function(){return u}),$parcel$export(e.exports,"createCheckerCanvas",function(){return d}),$parcel$export(e.exports,"createCheckerDataUrl",function(){return p}),$parcel$export(e.exports,"resizeCanvas",function(){return f}),$parcel$export(e.exports,"convertToAlphaChannelCanvas",function(){return g}),$parcel$export(e.exports,"freeCanvas",function(){return v}),$parcel$export(e.exports,"canvasBounds",function(){return m}),$parcel$export(e.exports,"canvasToBlob",function(){return x}),$parcel$export(e.exports,"drawSelectionMask",function(){return b});var i=parcelRequire("1LaJZ"),n=parcelRequire("2gUX3"),r=parcelRequire("eelgW"),a=parcelRequire("7jh4K"),s=parcelRequire("9b3eo");function o(e){var t=(0,r.createCanvas)(e.width,e.height),i=t.getContext("2d");if(!i)throw Error("2d context not supported or canvas already initialized");return i.drawImage(e,0,0),t}function l(e,t){var i=e.getContext("2d",t);if(!i)throw Error("couldn't get 2d context");return i}function h(e,t,i){if(![1,-1].includes(t)||![1,-1].includes(i)||e.width%1!=0||e.height%1!=0||Math.abs(e.angleDeg)%90!=0)return!1;var n=Math.abs(e.angleDeg-90)%180==0,r=n?e.height:e.width,a=n?e.width:e.height;return(Math.abs(r)%2==0&&e.x%1==0||Math.abs(r)%2==1&&e.x%1==.5)&&(Math.abs(a)%2==0&&e.y%1==0||Math.abs(a)%2==1&&e.y%1==.5)}function c(e,t,i,n,r){n||(n={x:0,y:0,width:t.width,height:t.height}),e.save(),r?e.imageSmoothingEnabled=!1:(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high"),e.translate(i.x,i.y),e.rotate(i.angleDeg/180*Math.PI),e.scale(i.width>0?1:-1,i.height>0?1:-1),e.drawImage(t,n.x,n.y,n.width,n.height,-Math.abs(i.width)/2,-Math.abs(i.height)/2,Math.abs(i.width),Math.abs(i.height)),e.restore()}function u(e,t,i){(i=(0,a.copyObj)(i)).center||(i.center={x:t.width/2,y:t.height/2}),i.scale||(i.scale={x:1,y:1}),i.angleDegree||(i.angleDegree=0),i.translate||(i.translate={x:0,y:0});var n=e.getContext("2d");if(!n)throw Error("2d context not supported or canvas already initialized");n.save(),Math.abs(i.scale.x-1)>1e-6||Math.abs(i.scale.y-1)>1e-6||Math.abs(i.angleDegree%90)>1e-6?(n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high"):n.imageSmoothingEnabled=!1,n.translate(i.translate.x,i.translate.y),n.translate(i.center.x,i.center.y),n.rotate(i.angleDegree/180*Math.PI),n.scale(i.scale.x,i.scale.y),n.translate(-i.center.x,-i.center.y),n.drawImage(t,0,0,t.width,t.height),n.restore()}var d=function(e,t){var i,n=(0,r.createCanvas)();if(e<1){if(n.width=1,n.height=1,!(i=n.getContext("2d")))throw Error("2d context not supported or canvas already initialized");i.fillStyle="rgb(128, 128, 128)",i.fillRect(0,0,1,1)}else{if(n.width=2*e,n.height=2*e,!(i=n.getContext("2d")))throw Error("2d context not supported or canvas already initialized");i.fillStyle=t?"rgb(90, 90, 90)":"rgb(255, 255, 255)",i.fillRect(0,0,2*e,2*e),i.fillStyle=t?"rgb(63, 63, 63)":"rgb(200, 200, 200)",i.fillRect(0,0,e,e),i.fillRect(e,e,2*e,2*e)}return n},p=function(){var e={};return function(t,i,n){var r=n?"d":"l";function a(t){if(e[""+(t=parseInt(""+t))+r])return e[""+t+r];var i=d(t,n).toDataURL("image/png");return e[""+t+r]=i,i}if(!i)return a(t);setTimeout(function(){i(a(t))},1)}}();function f(e,t,i,n,a){function s(e,t,i,n){var r={oldWidthEx:Math.round(Math.log2(e)),oldHeightEx:Math.round(Math.log2(t)),newWidthEx:Math.ceil(Math.log2(i)),newHeightEx:Math.ceil(Math.log2(n))};return r.oldWidthEx=Math.max(r.oldWidthEx,r.newWidthEx),r.oldHeightEx=Math.max(r.oldHeightEx,r.newHeightEx),r}if(t&&i&&(t!==e.width||i!==e.height))if(t=Math.max(t,1),i=Math.max(i,1),t<=e.width&&i<=e.height){n=n||(0,r.createCanvas)(),a=a||(0,r.createCanvas)();var o,l,h=s(e.width,e.height,t,i);a.width=h.oldWidthEx>h.newWidthEx?Math.pow(2,h.oldWidthEx):t,a.height=h.oldHeightEx>h.newHeightEx?Math.pow(2,h.oldHeightEx):i,n.getContext("2d").save(),a.getContext("2d").save();var c=n,u=a;o=h.oldWidthEx,l=h.oldHeightEx;var d=u.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.globalCompositeOperation="copy",d.drawImage(e,0,0,u.width,u.height);for(var p=u.width,g=u.height;o>h.newWidthEx||l>h.newHeightEx;o--,l--){(d=c.getContext("2d")).imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.globalCompositeOperation="copy";var v=o>h.newWidthEx?p/2:p,m=l>h.newHeightEx?g/2:g;c.width=v,c.height=m,d.drawImage(u,0,0,p,g,0,0,v,m),p=v,g=m;var y=c;c=u,u=y}e.width=t,e.height=i;var x=e.getContext("2d");x.save(),x.imageSmoothingEnabled=!0,x.imageSmoothingQuality="high",x.drawImage(u,0,0,p,g,0,0,t,i),x.restore(),n.getContext("2d").restore(),a.getContext("2d").restore()}else if(t>=e.width&&i>=e.height){(n=n||(0,r.createCanvas)()).width=t,n.height=i;var b=n.getContext("2d");b.save(),b.imageSmoothingEnabled=!0,b.imageSmoothingQuality="high",b.drawImage(e,0,0,t,i),b.restore(),e.width=t,e.height=i,e.getContext("2d").drawImage(n,0,0)}else f(e,t,e.height,n,a),f(e,t,i,n,a)}function g(e){for(var t=e.getContext("2d").getImageData(0,0,e.width,e.height),i=0;i<t.data.length;i+=4)0!==t.data[i+3]&&(t.data[i+3]=(t.data[i]+t.data[i+1]+t.data[i+2])/3*(t.data[i+3]/255));e.getContext("2d").putImageData(t,0,0)}function v(e){e.width=1,e.height=1,e.remove()}function m(e,t){var i=null!=t?t:{x1:0,y1:0,x2:e.canvas.width-1,y2:e.canvas.height-1},n=i.x2-i.x1+1,r=i.y2-i.y1+1,a=e.getImageData(i.x1,i.y1,n,r);if(a.data[3]>0&&a.data[a.data.length-1]>0)return{x:i.x1,y:i.y1,width:i.x2-i.x1+1,height:i.y2-i.y1+1};for(var s={x1:void 0,y1:void 0,x2:void 0,y2:void 0},o=3;o<a.data.length;o+=4)if(a.data[o]>0){var l=(o-3)/4%n,h=Math.floor((o-3)/4/n);(void 0===s.x1||s.x1>l)&&(s.x1=l),void 0===s.y1&&(s.y1=h),(void 0===s.x2||s.x2<l)&&(s.x2=l),(void 0===s.y2||s.y2<h)&&(s.y2=h)}if(void 0!==s.x1&&void 0!==s.y1&&void 0!==s.x2&&void 0!==s.y2)return{x:s.x1+i.x1,y:s.y1+i.y1,width:s.x2-s.x1+1,height:s.y2-s.y1+1}}function y(e,t){return new Promise(function(i,n){e.toBlob(function(e){e?i(e):n(Error("Failed to create blob from canvas."))},t)})}function x(e,t){return(0,i._)(function(){return(0,n.__generator)(this,function(i){switch(i.label){case 0:if(!("toBlob"in HTMLCanvasElement.prototype))return[3,2];return[4,y(e,t)];case 1:return[2,i.sent()];case 2:return[2,(0,a.base64ToBlob)(e.toDataURL(t))];case 3:return[2]}})})()}function b(e,t){var i=t.canvas;t.save(),t.fillRect(0,0,i.width,i.height);var n=(0,s.getSelectionPath2d)(e);t.clip(n),t.fillStyle="white",t.fillRect(0,0,i.width,i.height),t.restore()}}),parcelRegister("eelgW",function(e,t){$parcel$export(e.exports,"createCanvas",function(){return i});function i(e,t){var i=document.createElement("canvas");return e&&t&&(i.width=e,i.height=t),i}}),parcelRegister("9b3eo",function(e,t){$parcel$export(e.exports,"getSelectionPath2d",function(){return n}),$parcel$export(e.exports,"getSvgPathD",function(){return r});var i=parcelRequire("bX4ja");function n(e){var t=new Path2D;return e.forEach(function(e){e.forEach(function(e){e.forEach(function(e,n){var r,a;0===n?(r=t).moveTo.apply(r,(0,i._)(e)):(a=t).lineTo.apply(a,(0,i._)(e))})}),t.closePath()}),t}function r(e){var t="";return e.forEach(function(e){e.forEach(function(e){t+="M",e.forEach(function(e){t+=e.join(",")+" "})})}),t.trim()}}),parcelRegister("bX4ja",function(e,t){$parcel$export(e.exports,"_",function(){return s});var i=parcelRequire("6KGpL"),n=parcelRequire("5mm0I"),r=parcelRequire("kD20o"),a=parcelRequire("kWe4k");function s(e){return(0,i._)(e)||(0,n._)(e)||(0,a._)(e)||(0,r._)()}}),parcelRegister("6KGpL",function(e,t){$parcel$export(e.exports,"_",function(){return n});var i=parcelRequire("gszWS");function n(e){if(Array.isArray(e))return(0,i._)(e)}}),parcelRegister("5mm0I",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}}),parcelRegister("kD20o",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}),parcelRegister("kVHNC",function(e,t){function i(e,t){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12],t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+t[3]*e[13],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+t[3]*e[14],t[0]*e[3]+t[1]*e[7]+t[2]*e[11]+t[3]*e[15]]}function n(e,t){var n=[t[0],t[1],t[2],t[3]],r=[t[4],t[5],t[6],t[7]],a=[t[8],t[9],t[10],t[11]],s=[t[12],t[13],t[14],t[15]],o=i(e,n),l=i(e,r),h=i(e,a),c=i(e,s);return[o[0],o[1],o[2],o[3],l[0],l[1],l[2],l[3],h[0],h[1],h[2],h[3],c[0],c[1],c[2],c[3]]}$parcel$export(e.exports,"Matrix",function(){return r});var r=Object.freeze({getIdentity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiplyMatrixAndPoint:i,multiplyMatrices:n,createTranslationMatrix:function(e,t){return[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]},createRotationMatrix:function(e){return[Math.cos(-e),-Math.sin(-e),0,0,Math.sin(-e),Math.cos(-e),0,0,0,0,1,0,0,0,0,1]},createScaleMatrix:function(e){return[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1]}})}),parcelRegister("4toIY",function(e,t){$parcel$export(e.exports,"Vec2",function(){return i});var i={add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},sub:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},nor:function(e){var t=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));return{x:e.x/t,y:e.y/t}},len:function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},dist:function(e,t){return i.len(i.sub(e,t))},mul:function(e,t){return{x:e.x*t,y:e.y*t}},angle:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},dot:function(e,t){var i=[e.x,e.y],n=[t.x,t.y];return i.map(function(e,t){return i[t]*n[t]}).reduce(function(e,t){return e+t})}}}),parcelRegister("af1iA",function(e,t){$parcel$export(e.exports,"projectPointOnLine",function(){return o}),$parcel$export(e.exports,"PointLine",function(){return l}),$parcel$export(e.exports,"BezierLine",function(){return h}),$parcel$export(e.exports,"SplineInterpolator",function(){return c}),$parcel$export(e.exports,"powerSplineInput",function(){return u});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("4toIY"),a=parcelRequire("eg83P"),s=parcelRequire("7jh4K"),o=function(e,t,i){if(e.x===t.x)return{x:n=e.x,y:r=i.y};var n,r,a=(t.y-e.y)/(t.x-e.x),s=e.y-a*e.x;return{x:n=(a*i.y+i.x-a*s)/(a*a+1),y:r=(a*a*i.y+a*i.x+s)/(a*a+1)}},l=function(){"use strict";function e(t){var n=this;(0,i._)(this,e),this.segmentArr=[];for(var r=0;r<t.points.length;r++)!function(e){var i=0;e<t.points.length-1&&(i=(0,a.dist)(t.points[e].x,t.points[e].y,t.points[e+1].x,t.points[e+1].y)),n.segmentArr[e]={x:t.points[e].x,y:t.points[e].y,length:i}}(r)}return(0,n._)(e,[{key:"getAtDist",value:function(e){for(var t=Math.min(this.getLength(),e),i=0;t>this.segmentArr[i].length&&i<this.segmentArr.length-2;i++)t-=this.segmentArr[i].length;var n=Math.min(1,Math.max(0,t/this.segmentArr[i].length));return{x:this.segmentArr[i].x*(1-n)+this.segmentArr[i+1].x*n,y:this.segmentArr[i].y*(1-n)+this.segmentArr[i+1].y*n}}},{key:"getLength",value:function(){for(var e=0,t=0;t<this.segmentArr.length-1;t++)e+=this.segmentArr[t].length;return e}}]),e}(),h=function(){"use strict";function e(){(0,i._)(this,e),this.lastDot=0,this.pointArr=[]}return(0,n._)(e,[{key:"getBezierPoints",value:function(e,t,i,n,r){for(var a,s=[],o=0;o<=r;o++)a=o/r,s[s.length]={x:Math.pow(1-a,3)*e.x+3*Math.pow(1-a,2)*a*t.x+3*(1-a)*Math.pow(a,2)*i.x+Math.pow(a,3)*n.x,y:Math.pow(1-a,3)*e.y+3*Math.pow(1-a,2)*a*t.y+3*(1-a)*Math.pow(a,2)*i.y+Math.pow(a,3)*n.y};return s}},{key:"add",value:function(e,t,i,n,o){if(!this.lastPoint||e!==this.lastPoint.x||t!==this.lastPoint.y){if(this.lastPoint={x:e,y:t},this.pointArr[this.pointArr.length]={x:e,y:t,spacing:i},1===this.pointArr.length){this.lastSpacing=i;return}if(2===this.pointArr.length){this.pointArr[0].dir=r.Vec2.nor(r.Vec2.sub(this.pointArr[1],this.pointArr[0])),this.lastDot=i,this.lastSpacing=i;return}var h,c=this.pointArr[this.pointArr.length-1],u=this.pointArr[this.pointArr.length-2],d=this.pointArr[this.pointArr.length-3];u.dir=r.Vec2.nor(r.Vec2.sub(c,d)),(isNaN(u.dir.x)||isNaN(u.dir.y))&&(u.dir=(0,s.copyObj)(d.dir));var p=this.pointArr[this.pointArr.length-3],f=this.pointArr[this.pointArr.length-2],g=p,v=r.Vec2.add(p,r.Vec2.mul(p.dir,r.Vec2.dist(p,f)/4)),m=r.Vec2.sub(f,r.Vec2.mul(f.dir,r.Vec2.dist(p,f)/4)),y=f;h=new l(n?{points:this.getBezierPoints(g,v,m,y,20)}:{points:[g,y]});for(var x=h.getLength(),b=(0,a.mix)(this.lastSpacing,i,(0,a.clamp)(this.lastDot/x,0,1)),w=this.lastDot;w<=x;w+=b){b=(0,a.mix)(this.lastSpacing,i,(0,a.clamp)(w/x,0,1));var k=h.getAtDist(w),B=this.lastCallbackPoint?(0,a.pointsToAngleDeg)(this.lastCallbackPoint,k):void 0;n&&n({x:k.x,y:k.y,t:w/x,angle:B,dAngle:this.lastCallbackPoint?B-this.lastAngle:0}),this.lastCallbackPoint=k,this.lastAngle=B}n?this.lastDot=w-x:(this.lastDot=0,null==o||o({p1:g,p2:v,p3:m,p4:y})),this.lastSpacing=i}}},{key:"addFinal",value:function(e,t,i){if(!(this.pointArr.length<2)){var n=this.pointArr[this.pointArr.length-2],a=this.pointArr[this.pointArr.length-1],s=r.Vec2.add(a,r.Vec2.sub(a,n));this.add(s.x,s.y,e,t,i)}}}]),e}(),c=function(){"use strict";function e(t){(0,i._)(this,e);var n,r=t.length;for(this.xa=[],this.ya=[],this.u=[],this.y2=[],this.first=t[0][0],this.last=t[t.length-1][0],t.sort(function(e,t){return e[0]-t[0]}),n=0;n<r;n++)this.xa.push(t[n][0]),this.ya.push(t[n][1]);for(n=1,this.u[0]=0,this.y2[0]=0;n<r-1;++n){var a=this.xa[n+1]-this.xa[n-1],s=(this.xa[n]-this.xa[n-1])/a,o=s*this.y2[n-1]+2;this.y2[n]=(s-1)/o;var l=(this.ya[n+1]-this.ya[n])/(this.xa[n+1]-this.xa[n])-(this.ya[n]-this.ya[n-1])/(this.xa[n]-this.xa[n-1]);this.u[n]=(6*l/a-s*this.u[n-1])/o}for(this.y2[r-1]=0,n=r-2;n>=0;--n)this.y2[n]=this.y2[n]*this.y2[n+1]+this.u[n]}return(0,n._)(e,[{key:"getFirstX",value:function(){return this.first}},{key:"getLastX",value:function(){return this.last}},{key:"interpolate",value:function(e){for(var t=this.ya.length,i=0,n=t-1;n-i>1;){var r=n+i>>1;this.xa[r]>e?n=r:i=r}var a=this.xa[n]-this.xa[i],s=(this.xa[n]-e)/a,o=(e-this.xa[i])/a;return s*this.ya[i]+o*this.ya[n]+((s*s*s-s)*this.y2[i]+(o*o*o-o)*this.y2[n])*(a*a)/6}},{key:"findX",value:function(e,t){for(var i,n,r=0;r<=t;r++){var a=r/t,s=this.interpolate(a);if(void 0===i){i=a,n=Math.abs(s-e);continue}var o=Math.abs(s-e);if(o<n)i=a,n=o;else break}return i}}]),e}();function u(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;function r(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}for(var a=[],s=0;s<=1;s+=i)a.push([r(s,4),r(e+Math.pow(s,n)*(t-e),4)]);return a}}),parcelRegister("eg83P",function(e,t){function i(e,t,i){return e*(1-i)+t*i}function n(e,t,i,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(t-n,2))}function r(e,t,i,n){return Math.pow(e-i,2)+Math.pow(t-n,2)}function a(e,t){return e*e+t*t}function s(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function o(e,t){return 180*s(e,t)/Math.PI}function l(e,t){return t.x<=e.x&&e.x<=t.x+t.width&&t.y<=e.y&&e.y<=t.y+t.height}function h(e,t,i){return e<t?t:e>i?i:e}function c(e,t,i){var n=Math.PI/180*i,r=Math.cos(n),a=Math.sin(n);return{x:e*r-t*a,y:e*a+t*r}}function u(e,t,i){var n=c(t.x-e.x,t.y-e.y,i);return n.x+=e.x,n.y+=e.y,n}function d(e,t,i){var n=Math.abs(e%t);return Math.min(n,t-n)<=i&&(e=Math.round(e/t)*t),e}function p(e){return(e%=360)>180?e-=360:e<-180&&(e+=360),e}function f(e,t,i){e.x+=t,e.y+=i;var n=Math.round(e.x),r=Math.round(e.y);return e.x-=n,e.y-=r,{dX:n,dY:r}}function g(e){if(e%1==0)return e%2==0?e:e+1;var t=Math.ceil(e),i=Math.floor(e);return t%2==0?t:i}function v(e){if(e%1==0)return e%2==0?e+1:e;var t=Math.ceil(e),i=Math.floor(e);return t%2==1?t:i}function m(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}function y(e,t){if(!t&&!e)throw Error("at least one param needs to be defined");return t&&(e?(e.x1=Math.min(e.x1,t.x1),e.y1=Math.min(e.y1,t.y1),e.x2=Math.max(e.x2,t.x2),e.y2=Math.max(e.y2,t.y2)):e={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),e}function x(e,t){if(e){if(!t)return e;var i=Math.max(t.x1,e.x1),n=Math.max(t.y1,e.y1),r=Math.min(t.x2,e.x2),a=Math.min(t.y2,e.y2);if(!(i>r)&&!(n>a))return{x1:i,y1:n,x2:r,y2:a}}}function b(e,t,i){if(e)return x(e,{x1:0,y1:0,x2:t-1,y2:i-1})}function w(e,t,i,n){var r=Math.max(0,Math.floor(e.x1)),a=Math.max(0,Math.floor(e.y1)),s=Math.min(t-!!n,Math.ceil(e.x2)),o=Math.min(i-!!n,Math.ceil(e.y2));if(!(r>s)&&!(a>o))return{x1:r,y1:a,x2:s,y2:o}}function k(e,t){return{x:e.x1,y:e.y1,width:e.x2-e.x1+ +!!t,height:e.y2-e.y1+ +!!t}}function B(e){return{x1:Math.floor(e.x1),y1:Math.floor(e.y1),x2:Math.ceil(e.x2),y2:Math.ceil(e.y2)}}$parcel$export(e.exports,"mix",function(){return i}),$parcel$export(e.exports,"dist",function(){return n}),$parcel$export(e.exports,"distSquared",function(){return r}),$parcel$export(e.exports,"lenSquared",function(){return a}),$parcel$export(e.exports,"pointsToAngleRad",function(){return s}),$parcel$export(e.exports,"pointsToAngleDeg",function(){return o}),$parcel$export(e.exports,"isInsideRect",function(){return l}),$parcel$export(e.exports,"clamp",function(){return h}),$parcel$export(e.exports,"rotate",function(){return c}),$parcel$export(e.exports,"rotateAround",function(){return u}),$parcel$export(e.exports,"snapAngleDeg",function(){return d}),$parcel$export(e.exports,"minimizeAngleDeg",function(){return p}),$parcel$export(e.exports,"intDxy",function(){return f}),$parcel$export(e.exports,"roundEven",function(){return g}),$parcel$export(e.exports,"roundUneven",function(){return v}),$parcel$export(e.exports,"round",function(){return m}),$parcel$export(e.exports,"updateBounds",function(){return y}),$parcel$export(e.exports,"boundsOverlap",function(){return x}),$parcel$export(e.exports,"boundsInArea",function(){return b}),$parcel$export(e.exports,"intBoundsWithinArea",function(){return w}),$parcel$export(e.exports,"boundsToRect",function(){return k}),$parcel$export(e.exports,"integerBounds",function(){return B})}),parcelRegister("dJ1E2",function(e,t){$parcel$export(e.exports,"HSV",function(){return n}),$parcel$export(e.exports,"RGB",function(){return r}),$parcel$export(e.exports,"CMYK",function(){return a}),$parcel$export(e.exports,"ColorConverter",function(){return s}),$parcel$export(e.exports,"testIsWhiteBestContrast",function(){return o});var i=parcelRequire("cx0mh"),n=function e(t,n,r){"use strict";(0,i._)(this,e),this.h=Math.max(0,Math.min(360,t)),this.s=Math.max(.001,Math.min(100,n)),this.v=Math.max(0,Math.min(100,r))},r=function e(t,n,r){"use strict";(0,i._)(this,e),this.r=Math.max(0,Math.min(255,t)),this.g=Math.max(0,Math.min(255,n)),this.b=Math.max(0,Math.min(255,r))},a=function e(t,n,r,a){"use strict";(0,i._)(this,e),this.c=Math.max(0,Math.min(100,t)),this.m=Math.max(0,Math.min(100,n)),this.y=Math.max(0,Math.min(100,r)),this.k=Math.max(0,Math.min(100,a))},s={_RGBtoHSV:function(e){var t=new n(0,0,0),i=e.r/255,r=e.g/255,a=e.b/255,s=Math.min(i,r,a),o=Math.max(i,r,a),l=o-s;if(t.v=o,0==l)t.h=0,t.s=0;else{t.s=l/o;var h=((o-i)/6+l/2)/l,c=((o-r)/6+l/2)/l,u=((o-a)/6+l/2)/l;i==o?t.h=u-c:r==o?t.h=1/3+h-u:a==o&&(t.h=2/3+c-h),t.h<0&&(t.h+=1),t.h>1&&(t.h-=1)}return t.h=Math.round(360*t.h),t.s=Math.round(100*t.s),t.v=Math.round(100*t.v),t},_HSVtoRGB:function(e){var t,i,n,a,s,o,l,h,c=new r(0,0,0),u=e.h/360%1,d=e.s/100,p=e.v/100;return 0==d?(c.r=255*p,c.g=255*p,c.b=255*p):(i=Math.floor(t=6*u),n=p*(1-d),a=p*(1-d*(t-i)),s=p*(1-d*(1-(t-i))),0==i?(o=p,l=s,h=n):1==i?(o=a,l=p,h=n):2==i?(o=n,l=p,h=s):3==i?(o=n,l=a,h=p):4==i?(o=s,l=n,h=p):(o=p,l=n,h=a),c.r=255*o,c.g=255*l,c.b=255*h,c.r=Math.round(c.r),c.g=Math.round(c.g),c.b=Math.round(c.b)),c},_CMYKtoRGB:function(e){var t=new r(0,0,0),i=e.c/100,n=e.m/100,a=e.y/100,s=e.k/100;return t.r=1-Math.min(1,i*(1-s)+s),t.g=1-Math.min(1,n*(1-s)+s),t.b=1-Math.min(1,a*(1-s)+s),t.r=Math.round(255*t.r),t.g=Math.round(255*t.g),t.b=Math.round(255*t.b),t},_RGBtoCMYK:function(e){var t=new a(0,0,0,0),i=e.r/255,n=e.g/255,r=e.b/255;return t.k=Math.min(1-i,1-n,1-r),t.c=(1-i-t.k)/(1-t.k),t.m=(1-n-t.k)/(1-t.k),t.y=(1-r-t.k)/(1-t.k),t.c=Math.round(100*t.c),t.m=Math.round(100*t.m),t.y=Math.round(100*t.y),t.k=Math.round(100*t.k),t},toRGB:function(e){if(e instanceof r)return e;if(e instanceof n)return this._HSVtoRGB(e);if(e instanceof a)return this._CMYKtoRGB(e);throw Error("unknown type")},toHSV:function(e){if(e instanceof n)return e;if(e instanceof r)return this._RGBtoHSV(e);if(e instanceof a)return this._RGBtoHSV(this._CMYKtoRGB(e));throw Error("unknown type")},toCMYK:function(e){if(e instanceof a)return e;if(e instanceof r)return this._RGBtoCMYK(e);if(e instanceof n)return this._RGBtoCMYK(this._HSVtoRGB(e));throw Error("unknown type")},toHexString:function(e){if(e instanceof r||"r"in e&&"g"in e&&"b"in e){var t=parseInt(""+e.r).toString(16),i=parseInt(""+e.g).toString(16),n=parseInt(""+e.b).toString(16);return 1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),1==n.length&&(n="0"+n),t+i+n}return"#000"},toRgbStr:function(e){return"rgb("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+")"},toRgbaStr:function(e){return"rgba("+Math.round(e.r)+", "+Math.round(e.g)+", "+Math.round(e.b)+", "+e.a+")"},hexToRGB:function(e){e=e.trim();var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,n){return t+t+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?new r(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)):void 0}};function o(e){return .299*e.r+.587*e.g+.114*e.b<125}}),parcelRegister("72Jv0",function(e,t){$parcel$export(e.exports,"appendTextDiv",function(){return r}),$parcel$export(e.exports,"isInputFocused",function(){return a}),$parcel$export(e.exports,"unfocusAnyInput",function(){return s}),$parcel$export(e.exports,"clearSelection",function(){return o}),$parcel$export(e.exports,"makeUnfocusable",function(){return l}),$parcel$export(e.exports,"el",function(){return c}),$parcel$export(e.exports,"destroyEl",function(){return u}),$parcel$export(e.exports,"createImage",function(){return d});var i=parcelRequire("7jh4K"),n=parcelRequire("eWjiX");function r(e,t){var i=document.createElement("div");return i.innerHTML=t,e.append(i),i}function a(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!!document.activeElement&&["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName);return t?i:i&&!(null==(e=document.activeElement)?void 0:e.getAttribute("data-ignore-focus"))}function s(){if(a(!0)){var e=n.BB.el({parent:document.body,tagName:"input",css:{opacity:"0",width:"0",height:"0"}});setTimeout(function(){e.select(),e.focus(),e.remove()},10)}}function o(){if(window.getSelection){var e=window.getSelection();e&&(e.empty?e.empty():e.removeAllRanges&&e.removeAllRanges())}}var l=function(){function e(e){e.preventDefault();var t=!1;if(e.relatedTarget)try{e.relatedTarget.focus(),t=!0}catch(e){console.error("failed to focus")}t||e.currentTarget.blur()}return function(t){t.setAttribute("tabindex","-1"),t.addEventListener("focus",e)}}(),h=[];function c(e){if(!e)return document.createElement("div");var t=document.createElement(e.tagName?e.tagName:"div");e.css&&(0,i.css)(t,e.css),e.content&&("string"==typeof e.content?t.innerHTML=e.content:Array.isArray(e.content)?n.BB.append(t,e.content):t.append(e.content)),e.textContent&&(t.textContent=e.textContent),e.className&&(t.className=e.className),e.id&&(t.id=e.id),e.parent&&e.parent.append(t),"title"in e&&void 0!==e.title&&(t.title=e.title);var r=[];if(void 0!==e.onClick&&(t.addEventListener("click",e.onClick),e.noRef||r.push(["click",e.onClick])),void 0!==e.onChange&&(t.addEventListener("change",e.onChange),e.noRef||r.push(["change",e.onChange])),r.length>0&&h.push({el:t,listeners:r}),"custom"in e&&e.custom)for(var a=Object.keys(e.custom),s=0;s<a.length;s++)t.setAttribute(a[s],e.custom[a[s]]);return t}function u(e){if(e)for(var t=0;t<h.length;t++){var i=h[t];if(i.el===e){i.listeners.forEach(function(t){e.removeEventListener(t[0],t[1])}),h.splice(t,1);break}}}function d(e){var t=new Image;return void 0!==e.src&&(t.src=e.src),void 0!==e.alt&&(t.alt=e.alt),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.className&&(t.className=e.className),e.css&&(0,i.css)(t,e.css),t}}),parcelRegister("i0uIf",function(e,t){$parcel$export(e.exports,"BbLog",function(){return r});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=function(){"use strict";function e(){(0,i._)(this,e)}return(0,n._)(e,null,[{key:"subscribe",value:function(t){e.listeners.includes(t)||e.listeners.push(t)}},{key:"unsubscribe",value:function(t){for(var i=0;i<e.listeners.length;i++)if(t===e.listeners[i])return void e.listeners.splice(i,1)}},{key:"emit",value:function(t){e.listeners.forEach(function(e){e(t)})}}]),e}();r.listeners=[]}),parcelRegister("6l0gQ",function(e,t){$parcel$export(e.exports,"LocalStorage",function(){return r});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=function(){"use strict";function e(){(0,i._)(this,e)}return(0,n._)(e,null,[{key:"getItem",value:function(e){var t=null;try{t=localStorage.getItem(e)}catch(e){this.error=e}return t}},{key:"setItem",value:function(e,t){try{localStorage.setItem(e,t)}catch(e){this.error=e}}},{key:"removeItem",value:function(e){try{localStorage.removeItem(e)}catch(e){this.error=e}}},{key:"getError",value:function(){return this.error}}]),e}()}),parcelRegister("jjWRi",function(e,t){$parcel$export(e.exports,"CoalescedExploder",function(){return a});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("7jh4K"),a=function(){"use strict";function e(){(0,i._)(this,e)}return(0,n._)(e,[{key:"setChainOut",value:function(e){this.chainOut=e}},{key:"chainIn",value:function(e){if("pointermove"!==e.type||!e.coalescedArr||!(e.coalescedArr.length>0))return e;for(var t=0;t<e.coalescedArr.length;t++){var i=(0,r.copyObj)(e);0===t&&(i.coalescedArr=[]);var n=e.coalescedArr[t];i.pageX=n.pageX,i.pageY=n.pageY,i.relX=n.relX,i.relY=n.relY,i.dX=n.dX,i.dY=n.dY,i.time=n.time,i.isCoalesced=t<e.coalescedArr.length-1,this.chainOut&&this.chainOut(i)}return null}}]),e}()}),parcelRegister("2pgVs",function(e,t){$parcel$export(e.exports,"NFingerTapper",function(){return a});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("eg83P"),a=function(){"use strict";function e(t){(0,i._)(this,e),this.minSilenceBeforeDurationMs=50,this.maxTapMs=500,this.maxFirstLastFingerDownMs=250,this.maxPressedDistancePx=12,this.fingerArr=[],this.eventQueueArr=[],this.firstDownTime=0,this.lastEventTime=0,this.nowTime=performance.now(),this.pointersDownIdArr=[],this.timeoutObj={firstLastDownTimeout:null,tapTimeout:null},this.fingers=t.fingers,this.onTap=t.onTap}return(0,n._)(e,[{key:"failGesture",value:function(){if(0!==this.eventQueueArr.length){this.timeoutObj.firstLastDownTimeout&&clearTimeout(this.timeoutObj.firstLastDownTimeout),this.timeoutObj.tapTimeout&&clearTimeout(this.timeoutObj.tapTimeout);for(var e=0;e<this.eventQueueArr.length;e++)this.chainOut&&this.chainOut(this.eventQueueArr[e]);this.eventQueueArr=[],this.fingerArr=[]}}},{key:"success",value:function(){this.timeoutObj.firstLastDownTimeout&&clearTimeout(this.timeoutObj.firstLastDownTimeout),this.timeoutObj.tapTimeout&&clearTimeout(this.timeoutObj.tapTimeout),this.eventQueueArr=[],this.fingerArr=[],this.onTap()}},{key:"setupTimeout",value:function(e,t){var i=this,n=t-this.nowTime;return!(n<=0)&&(this.timeoutObj[e]=setTimeout(function(){return i.failGesture()},n),!0)}},{key:"processEvent",value:function(e){var t=this.lastEventTime;if(this.lastEventTime=e.time,"pointerdown"===e.type)this.pointersDownIdArr.push(e.pointerId);else if("pointerup"===e.type){for(var i=0;i<this.pointersDownIdArr.length;i++)if(this.pointersDownIdArr[i]===e.pointerId){this.pointersDownIdArr.splice(i,1);break}}if("touch"!==e.pointerType){this.fingerArr.length>0&&this.failGesture();return}if(this.nowTime=performance.now(),"pointerdown"===e.type)return this.fingerArr.length+1!==this.pointersDownIdArr.length||this.fingerArr.length===this.fingers||this.fingerArr.length>0&&e.time-this.maxFirstLastFingerDownMs>this.fingerArr[0].downTimeMs||0===this.fingerArr.length&&e.time-this.minSilenceBeforeDurationMs<t||0===this.fingerArr.length&&(this.firstDownTime=e.time,!this.setupTimeout("firstLastDownTimeout",e.time+this.maxFirstLastFingerDownMs)||!this.setupTimeout("tapTimeout",e.time+this.maxTapMs))?void this.failGesture():void this.fingerArr.push({pointerId:e.pointerId,downTimeMs:e.time,downPageX:e.pageX,downPageY:e.pageY});if("pointermove"===e.type){if(0===this.fingerArr.length)return;for(var n=null,a=0;a<this.fingerArr.length;a++)if(this.fingerArr[a].pointerId===e.pointerId){n=this.fingerArr[a];break}if(null===n||e.time-this.maxTapMs>this.firstDownTime||(0,r.dist)(e.pageX,e.pageY,n.downPageX,n.downPageY)>this.maxPressedDistancePx)return void this.failGesture()}if("pointerup"===e.type){if(0===this.fingerArr.length)return;if(this.fingerArr.length!==this.fingers)return void this.failGesture();for(var s=null,o=0;o<this.fingerArr.length;o++)if(this.fingerArr[o].pointerId===e.pointerId){s=this.fingerArr[o];break}if(null===s)return;if(e.time-this.maxTapMs>this.firstDownTime||(0,r.dist)(e.pageX,e.pageY,s.downPageX,s.downPageY)>this.maxPressedDistancePx)return void this.failGesture();s.isUp=!0;for(var l=!0,h=0;h<this.fingerArr.length;h++)if(!this.fingerArr[h].isUp){l=!1;break}if(l)return this.success(),!0}}},{key:"chainIn",value:function(e){return!0===this.processEvent(e)?null:0===this.fingerArr.length?e:(this.eventQueueArr.push(e),null)}},{key:"setChainOut",value:function(e){this.chainOut=e}}]),e}()}),parcelRegister("joplQ",function(e,t){$parcel$export(e.exports,"PinchZoomer",function(){return a});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("eg83P"),a=function(){"use strict";function e(t){(0,i._)(this,e),this.firstFingerMaxDistancePx=10,this.untilSecondFingerDurationMs=250,this.pointersDownIdArr=[],this.gestureObj=null,this.eventQueueArr=[],this.nowTime=performance.now(),this.timeoutObj={secondFingerTimeout:null},this.pincherArr=[],this.onPinch=t.onPinch}return(0,n._)(e,[{key:"end",value:function(){this.gestureObj=null,this.eventQueueArr=[]}},{key:"fail",value:function(e){if(this.gestureObj){if(this.timeoutObj.secondFingerTimeout&&clearTimeout(this.timeoutObj.secondFingerTimeout),!e)for(var t=0;t<this.eventQueueArr.length;t++)this.chainOut&&this.chainOut(this.eventQueueArr[t]);this.end()}}},{key:"setupFailTimeout",value:function(e){var t=this,i=e-this.nowTime;return!(i<=0)&&(this.timeoutObj.secondFingerTimeout=setTimeout(function(){return t.fail()},i),!0)}},{key:"processEvent",value:function(e){if("pointerdown"===e.type)this.pointersDownIdArr.push(e.pointerId);else if("pointerup"===e.type){for(var t=0;t<this.pointersDownIdArr.length;t++)if(this.pointersDownIdArr[t]===e.pointerId){this.pointersDownIdArr.splice(t,1);break}}if(this.gestureObj||"touch"===e.pointerType&&("pointermove"!==e.type||!(this.pointersDownIdArr.length>0))&&!(this.pointersDownIdArr.length>1)&&"pointerup"!==e.type){if(this.nowTime=performance.now(),"pointerdown"===e.type)if(!this.gestureObj)return(this.gestureObj={touchPointerArr:[{pointerId:e.pointerId,relX:e.relX,relY:e.relY,downRelX:e.relX,downRelY:e.relY}],otherPointerIdArr:[],isInProgress:!1},this.setupFailTimeout(e.time+this.untilSecondFingerDurationMs))?void 0:void this.fail();else{if("touch"!==e.pointerType)return void(this.gestureObj.isInProgress?this.gestureObj.otherPointerIdArr.push(e.pointerId):this.fail());this.gestureObj.touchPointerArr.push({pointerId:e.pointerId,relX:e.relX,relY:e.relY}),this.gestureObj.isInProgress?this.continuePinch(this.gestureObj,{type:"down",index:this.gestureObj.touchPointerArr.length-1}):(this.timeoutObj.secondFingerTimeout&&clearTimeout(this.timeoutObj.secondFingerTimeout),this.gestureObj.isInProgress=!0,this.beginPinch(this.gestureObj));return}if(!this.gestureObj)return void this.fail();if("pointermove"===e.type&&"touch"===e.pointerType){for(var i=null,n=0;n<this.gestureObj.touchPointerArr.length;n++)if(e.pointerId===this.gestureObj.touchPointerArr[n].pointerId){i=this.gestureObj.touchPointerArr[n];break}if(!i)return void this.fail();if(i.relX=e.relX,i.relY=e.relY,this.gestureObj.isInProgress)n<2&&this.continuePinch(this.gestureObj,{type:"move",index:n});else if(!("downRelX"in i&&void 0!==i.downRelX)||!("downRelY"in i&&void 0!==i.downRelY)||(0,r.dist)(i.downRelX,i.downRelY,i.relX,i.relY)>this.firstFingerMaxDistancePx)return void this.fail();return}if("pointerup"===e.type){if("touch"===e.pointerType){for(var a=0;a<this.gestureObj.touchPointerArr.length;a++)if(this.gestureObj.touchPointerArr[a].pointerId===e.pointerId){this.gestureObj.touchPointerArr.splice(a,1);break}this.gestureObj.touchPointerArr.length>0&&this.continuePinch(this.gestureObj,{type:"up",index:a})}else for(var s=0;s<this.gestureObj.otherPointerIdArr.length;s++)if(this.gestureObj.otherPointerIdArr[s]===e.pointerId){this.gestureObj.otherPointerIdArr.splice(s,1);break}if(0===this.gestureObj.touchPointerArr.length&&0===this.gestureObj.otherPointerIdArr.length)return void(this.gestureObj.isInProgress?(this.end(),this.endPinch()):this.fail())}}}},{key:"beginPinch",value:function(e){for(var t=0;t<e.touchPointerArr.length;t++){var i=e.touchPointerArr[t];this.pincherArr.push({pointerId:i.pointerId,relX:i.relX,relY:i.relY,downRelX:i.relX,downRelY:i.relY})}var n={type:"move",downRelX:0,downRelY:0,relX:0,relY:0,angleRad:0,scale:1};1===this.pincherArr.length?(n.relX=this.pincherArr[0].downRelX,n.relY=this.pincherArr[0].downRelY):(n.relX=.5*(this.pincherArr[0].downRelX+this.pincherArr[1].downRelX),n.relY=.5*(this.pincherArr[0].downRelY+this.pincherArr[1].downRelY)),n.downRelX=n.relX,n.downRelY=n.relY,this.onPinch(n)}},{key:"continuePinch",value:function(e,t){if(!(t.index>1))if("move"===t.type){var i;if(this.pincherArr[t.index].relX=e.touchPointerArr[t.index].relX,this.pincherArr[t.index].relY=e.touchPointerArr[t.index].relY,1===this.pincherArr.length)i={type:"move",downRelX:this.pincherArr[0].downRelX,downRelY:this.pincherArr[0].downRelY,relX:this.pincherArr[0].relX,relY:this.pincherArr[0].relY,angleRad:0,scale:1};else{var n=(0,r.dist)(this.pincherArr[0].downRelX,this.pincherArr[0].downRelY,this.pincherArr[1].downRelX,this.pincherArr[1].downRelY),a=(0,r.dist)(this.pincherArr[0].relX,this.pincherArr[0].relY,this.pincherArr[1].relX,this.pincherArr[1].relY),s=(0,r.pointsToAngleRad)({x:this.pincherArr[0].downRelX,y:this.pincherArr[0].downRelY},{x:this.pincherArr[1].downRelX,y:this.pincherArr[1].downRelY}),o=(0,r.pointsToAngleRad)({x:this.pincherArr[0].relX,y:this.pincherArr[0].relY},{x:this.pincherArr[1].relX,y:this.pincherArr[1].relY});i={type:"move",downRelX:.5*(this.pincherArr[0].downRelX+this.pincherArr[1].downRelX),downRelY:.5*(this.pincherArr[0].downRelY+this.pincherArr[1].downRelY),relX:.5*(this.pincherArr[0].relX+this.pincherArr[1].relX),relY:.5*(this.pincherArr[0].relY+this.pincherArr[1].relY),angleRad:o-s,scale:a/n}}this.onPinch(i)}else("down"===t.type||"up"===t.type)&&(this.endPinch(),this.beginPinch(e))}},{key:"endPinch",value:function(){this.pincherArr=[],this.onPinch({type:"end"})}},{key:"chainIn",value:function(e){return(this.processEvent(e),this.gestureObj)?(this.gestureObj.isInProgress||this.eventQueueArr.push(e),null):e}},{key:"setChainOut",value:function(e){this.chainOut=e}}]),e}()}),parcelRegister("c1lmK",function(e,t){$parcel$export(e.exports,"DoubleTapper",function(){return s});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("bX4ja"),a=parcelRequire("eg83P"),s=function(){"use strict";function e(t){var n=this;(0,i._)(this,e),this.allowedPointerTypeArr=["touch","mouse","pen"],this.allowedButtonArr=["left"],this.minSilenceBeforeDurationMs=400,this.maxPressedDurationMs=300,this.maxPressedDistancePx=10,this.maxInbetweenDistancePx=19,this.maxUpToUpDurationMs=500,this.maxUntilSecondDownDurationMs=300,this.minSilenceAfterMs=250,this.sequenceArr=[],this.pointersDownIdArr=[],this.lastUpTime=0,this.nowTime=0,this.eventQueueArr=[],this.timeoutObj={fail:null,maxUntilSecondDown:null,success:null},this.onDoubleTap=t.onDoubleTap,t.isInstant&&(this.minSilenceBeforeDurationMs=0,this.minSilenceAfterMs=0),this.gestureFailed=function(){if(0!==n.sequenceArr.length){if(n.timeoutObj.fail&&clearTimeout(n.timeoutObj.fail),n.timeoutObj.maxUntilSecondDown&&clearTimeout(n.timeoutObj.maxUntilSecondDown),n.timeoutObj.success&&clearTimeout(n.timeoutObj.success),n.timeoutObj.fail=null,n.timeoutObj.maxUntilSecondDown=null,n.timeoutObj.success=null,n.chainOut)for(var e=0;e<n.eventQueueArr.length;e++)n.chainOut(n.eventQueueArr[e]);n.eventQueueArr=[],n.sequenceArr=[]}}}return(0,n._)(e,[{key:"success",value:function(){this.timeoutObj.fail=null,this.timeoutObj.success=null,this.eventQueueArr=[];var e=this.sequenceArr[this.sequenceArr.length-1];this.sequenceArr=[],"pageX"in e&&this.onDoubleTap({pageX:e.pageX,pageY:e.pageY,relX:e.relX,relY:e.relY})}},{key:"setupTimeout",value:function(e,t,i,n){var r=i-this.nowTime;return(!(r<=0)||!!n)&&(this.timeoutObj[e]=setTimeout(t,Math.max(0,r)),!0)}},{key:"processEvent",value:function(e){var t=this;if("pointerdown"===e.type)this.pointersDownIdArr.push(e.pointerId);else if("pointerup"===e.type){for(var i=0;i<this.pointersDownIdArr.length;i++)if(this.pointersDownIdArr[i]===e.pointerId){this.pointersDownIdArr.splice(i,1);break}}if(!this.allowedPointerTypeArr.includes(e.pointerType))return void this.gestureFailed();this.nowTime=performance.now();var n=this.sequenceArr.length>0?this.sequenceArr[this.sequenceArr.length-1]:null;if("pointerup"===e.type&&(this.lastUpTime=e.time),"pointerdown"===e.type){if(this.pointersDownIdArr.length>1||null!==this.timeoutObj.success||0===this.sequenceArr.length&&this.nowTime-this.lastUpTime<this.minSilenceBeforeDurationMs||e.button&&!this.allowedButtonArr.includes(e.button)||n&&"isDown"in n&&n.isDown||this.sequenceArr.length>2)return void this.gestureFailed();if(n&&"position"in n&&(0,a.dist)(n.position[0],n.position[1],e.pageX,e.pageY)>this.maxInbetweenDistancePx&&(this.gestureFailed(),"time"in n&&this.nowTime-n.time<this.minSilenceBeforeDurationMs))return;if(this.sequenceArr.push({isDown:!0,time:this.nowTime,position:[e.pageX,e.pageY],pointerId:e.pointerId}),this.sequenceArr.length>1)this.timeoutObj.maxUntilSecondDown&&clearTimeout(this.timeoutObj.maxUntilSecondDown);else if(!this.setupTimeout("maxUntilSecondDown",function(){return t.gestureFailed()},e.time+this.maxUntilSecondDownDurationMs))return void this.gestureFailed();if(this.timeoutObj.fail&&clearTimeout(this.timeoutObj.fail),!this.setupTimeout("fail",function(){return t.gestureFailed()},e.time+this.maxPressedDurationMs))return void this.gestureFailed()}if(n&&"pointermove"===e.type&&"pointerId"in n&&n.pointerId===e.pointerId&&(0,a.dist)(n.position[0],n.position[1],e.pageX,e.pageY)>this.maxPressedDistancePx)return void this.gestureFailed();if(n&&"pointerup"===e.type){if("pointerId"in n&&n.pointerId!==e.pointerId||"time"in n&&this.nowTime>=n.time+this.maxPressedDurationMs)return void this.gestureFailed();if(this.timeoutObj.fail&&clearTimeout(this.timeoutObj.fail),this.sequenceArr.length<3)return this.setupTimeout("fail",function(){return t.gestureFailed()},e.time+this.maxUpToUpDurationMs)?void(this.sequenceArr=[n,{isUp:!0,time:this.nowTime,position:[e.pageX,e.pageY]}]):void this.gestureFailed();"time"in this.sequenceArr[1]&&this.nowTime<this.sequenceArr[1].time+this.maxUpToUpDurationMs?(this.sequenceArr.push({pageX:e.pageX,pageY:e.pageY,relX:e.relX,relY:e.relY}),this.setupTimeout("success",function(){return t.success()},e.time+this.minSilenceAfterMs,!0)||this.gestureFailed()):this.gestureFailed()}}},{key:"chainIn",value:function(e){return(this.processEvent(e),0===this.sequenceArr.length)?(this.gestureFailed(),e):(this.eventQueueArr.push(e),null)}},{key:"setChainOut",value:function(e){this.chainOut=e}},{key:"setAllowedPointerTypeArr",value:function(e){this.allowedPointerTypeArr=(0,r._)(e)}},{key:"setAllowedButtonArr",value:function(e){this.allowedButtonArr=(0,r._)(e)}}]),e}()}),parcelRegister("635F6",function(e,t){$parcel$export(e.exports,"OnePointerLimiter",function(){return r});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=function(){"use strict";function e(){(0,i._)(this,e),this.downPointerId=null,this.ignorePointerIdArr=[]}return(0,n._)(e,[{key:"chainIn",value:function(e){if(this.ignorePointerIdArr.includes(e.pointerId)){if("pointerup"===e.type){for(var t=0;t<this.ignorePointerIdArr.length;t++)if(this.ignorePointerIdArr[t]===e.pointerId){this.ignorePointerIdArr.splice(t,1);break}}return null}return null===this.downPointerId?("pointerdown"===e.type&&(this.downPointerId=e.pointerId),e):e.pointerId!==this.downPointerId?("pointerdown"===e.type&&this.ignorePointerIdArr.push(e.pointerId),null):("pointerup"===e.type&&(this.downPointerId=null),e)}},{key:"setChainOut",value:function(e){this.chainOut=e}}]),e}()}),parcelRegister("gCzYB",function(e,t){$parcel$export(e.exports,"EventChain",function(){return r});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=function(){"use strict";function e(t){var n=this;(0,i._)(this,e),this.chainArr=t.chainArr;for(var r=0;r<this.chainArr.length;r++)!function(e){n.chainArr[e].setChainOut(function(t){n.continueChain(e+1,t)})}(r)}return(0,n._)(e,[{key:"continueChain",value:function(e,t){for(;e<this.chainArr.length;e++)if(null===(t=this.chainArr[e].chainIn(t)))return null;return this.chainOut&&this.chainOut(t),null}},{key:"chainIn",value:function(e){return this.continueChain(0,e)}},{key:"setChainOut",value:function(e){this.chainOut=e}}]),e}()}),parcelRegister("fFwUa",function(e,t){$parcel$export(e.exports,"_",function(){return a});var i=parcelRequire("2JCCy"),n=parcelRequire("ff8rK"),r=parcelRequire("5IlRA");function a(e,t,a){return t=(0,i._)(t),(0,r._)(e,(0,n._)()?Reflect.construct(t,a||[],(0,i._)(e).constructor):t.apply(e,a))}}),parcelRegister("2JCCy",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}}),parcelRegister("ff8rK",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(i=function(){return!!e})()}}),parcelRegister("5IlRA",function(e,t){$parcel$export(e.exports,"_",function(){return r});var i=parcelRequire("d6zUP"),n=parcelRequire("8KHnw");function r(e,t){return t&&("object"===(0,n._)(t)||"function"==typeof t)?t:(0,i._)(e)}}),parcelRegister("d6zUP",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}}),parcelRegister("8KHnw",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}}),parcelRegister("9xmuV",function(e,t){$parcel$export(e.exports,"_",function(){return n});var i=parcelRequire("5oklS");function n(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,i._)(e,t)}}),parcelRegister("5oklS",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}}),parcelRegister("6otAp",function(e,t){$parcel$export(e.exports,"RECOVERY_THUMB_WIDTH_PX",function(){return c}),$parcel$export(e.exports,"RECOVERY_THUMB_HEIGHT_PX",function(){return u}),$parcel$export(e.exports,"RECOVERY_AGE_LIMIT_MS",function(){return d}),$parcel$export(e.exports,"RECOVERY_MEMORY_LIMIT_BYTES",function(){return p}),$parcel$export(e.exports,"DEBUG_RETURN_ALL_RECOVERIES",function(){return y}),$parcel$export(e.exports,"KlRecoveryManager",function(){return C});var i=parcelRequire("1LaJZ"),n=parcelRequire("cx0mh"),r=parcelRequire("7h4XF"),a=parcelRequire("2gUX3"),s=parcelRequire("gDbpE"),o=parcelRequire("7jh4K"),l=parcelRequire("3uJxV"),h=parcelRequire("jTg9g"),c=300,u=180,d=6048e5,p=1e9,f=3e5,g=8,v=6e4,m=4,y=!1,x=!1;function b(e){void 0===e?history.replaceState(null,""," "):history.replaceState(null,"",window.location.origin+window.location.pathname+window.location.search+"#"+e)}function w(){return window.location.hash?window.location.hash.substring(1):void 0}var k=["licenses"];function B(e){if(!(void 0===e||k.includes(e))){var t=+e;if(!isNaN(t)&&!(t<0)&&t%1==0)return t}}function S(e){var t=1e3;if(e.length>=t)throw Error("No available IDs");var i=new Set(e),n=(0,o.createArray)(t,0).map(function(e,t){return t}).filter(function(e){return!i.has(e)}),r=Math.floor(Math.random()*n.length);if(void 0===n[r])throw Error("No available IDs");return n[r]}var C=function(){"use strict";function e(t){(0,n._)(this,e),this.klHistory={},this.isStoring=!1,this.listeners=new Set,this.crossTabChannel=new(0,l.CrossTabChannel)("kl-tab-communication"),this.initListeners()}return(0,r._)(e,[{key:"announceTabId",value:function(){this.crossTabChannel.postMessage({type:"new-tab"})}},{key:"initListeners",value:function(){var e=this;document.addEventListener("visibilitychange",function(){document.hidden||setTimeout(function(){e.update()},500)}),window.addEventListener("focus",function(){setTimeout(function(){e.update()},500)}),this.crossTabChannel.subscribe(function(t){if("new-tab"===t.type){if(document.hidden)return;setTimeout(function(){e.update()},500)}"request-ids"===t.type&&void 0!==e.tabId&&e.crossTabChannel.postMessage({type:"response-ids",id:e.tabId})})}},{key:"emitUpdate",value:function(){return(0,i._)(function(){var e,t,i,n,r;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(e=this,!h.KL_INDEXED_DB.getIsAvailable())return[2];return[4,(0,s.getIdsFromRecoveryStore)()];case 1:return t=a.sent(),[4,this.getIdsFromTabs()];case 2:return i=a.sent(),[4,Promise.all((y?t:t.filter(function(t){return!i.includes(t)&&t!==e.tabId})).map(function(e){return(0,s.getMetadata)(""+e,!0)}))];case 3:return n=a.sent(),[4,this.getTotalMemoryUsedBytes()];case 4:return r=a.sent(),this.listeners.forEach(function(e){e(n,r)}),[2]}})}).call(this)}},{key:"setHash",value:function(e){b(void 0===e?void 0:""+e),this.announceTabId()}},{key:"getIdsFromTabs",value:function(){return(0,i._)(function(){var e,t;return(0,a.__generator)(this,function(i){switch(i.label){case 0:return this.crossTabChannel.postMessage({type:"request-ids"}),e=[],t=function(t){"response-ids"===t.type&&e.push(+t.id)},this.crossTabChannel.subscribe(t),[4,(0,o.sleep)(100)];case 1:return i.sent(),this.crossTabChannel.unsubscribe(t),[2,e]}})}).call(this)}},{key:"getTotalMemoryUsedBytes",value:function(){return(0,i._)(function(){var e,t,i,n,r,o,l,h,c,u;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,(0,s.getIdsFromRecoveryStore)()];case 1:e=a.sent(),t=0,i=!0,n=!1,r=void 0,a.label=2;case 2:a.trys.push([2,7,8,9]),o=e[Symbol.iterator](),a.label=3;case 3:if(i=(l=o.next()).done)return[3,6];return h=l.value,[4,(0,s.getMetadata)(""+h)];case 4:c=a.sent(),t+=c.memoryEstimateBytes,a.label=5;case 5:return i=!0,[3,3];case 6:return[3,9];case 7:return u=a.sent(),n=!0,r=u,[3,9];case 8:try{i||null==o.return||o.return()}finally{if(n)throw r}return[7];case 9:return[2,t]}})})()}},{key:"getRecovery",value:function(){return(0,i._)(function(){var e,t,i,n;return(0,a.__generator)(this,function(r){switch(r.label){case 0:if(void 0===(e=B(w())))return this.noRecoveryReason="noTabIdHash",[2,void 0];return[4,this.getIdsFromTabs()];case 1:if(r.sent().includes(e))return this.noRecoveryReason="alreadyOpened",this.setHash(void 0),[2,void 0];return[4,(0,s.getIdsFromRecoveryStore)()];case 2:if(!(t=r.sent()).includes(e))return this.noRecoveryReason="idNotFound",this.setHash(void 0),[2,void 0];return i=S(t),[4,(0,s.changeRecoveryId)(e,i)];case 3:if(!r.sent())return this.noRecoveryReason="idChangeFailed",this.setHash(void 0),[2,void 0];return this.setHash(i),[4,(0,s.getRecovery)(i)];case 4:return(n=r.sent())&&(this.tabId=i),setTimeout(function(){(0,s.removeOrphans)()}),[2,n]}})}).call(this)}},{key:"setKlHistory",value:function(e){var t=this;this.klHistory=e;var n=new Date().getTime(),r=0;this.klHistory.addListener(function(){return(0,i._)(function(){var e,t,i,l,h;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(this.isStoring||(e=this.klHistory.getChangeCount(),!x&&(t=new Date().getTime()-n,void 0===this.tabId&&(t<f||e<g)||void 0!==this.tabId&&(t<v||e-r<m))))return[2];if(i=!1,this.tabId)return[3,2];return[4,(0,o.timeoutWrapper)((0,s.getIdsFromRecoveryStore)(),"setKlHistory.getIdsFromStore")];case 1:l=a.sent(),this.tabId=S(l),i=!0,a.label=2;case 2:this.isStoring=!0,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,(0,s.storeRecovery)(this.tabId,this.klHistory.getComposed(),this.getThumbnail)];case 4:return a.sent(),n=new Date().getTime(),[3,6];case 5:return h=a.sent(),setTimeout(function(){throw h}),[3,6];case 6:if(!i)return[3,8];return this.setHash(this.tabId),[4,(0,s.clearOldRecoveries)()];case 7:a.sent(),a.label=8;case 8:return n=new Date().getTime(),r=e,this.isStoring=!1,[2]}})}).call(t)})}},{key:"setGetThumbnail",value:function(e){this.getThumbnail=e}},{key:"subscribe",value:function(e){this.listeners.add(e)}},{key:"unsubscribe",value:function(e){this.listeners.delete(e)}},{key:"update",value:function(){return(0,i._)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:if(!(this.listeners.size>0))return[3,2];return[4,this.emitUpdate()];case 1:e.sent(),e.label=2;case 2:return[2]}})}).call(this)}},{key:"remove",value:function(e){return(0,i._)(function(){return(0,a.__generator)(this,function(t){switch(t.label){case 0:return[4,(0,s.deleteRecovery)(""+e)];case 1:return t.sent(),this.update(),[2]}})}).call(this)}},{key:"getTabId",value:function(){return this.tabId}},{key:"getNoRecoveryReason",value:function(){return this.noRecoveryReason}},{key:"destroy",value:function(){}}]),e}()}),parcelRegister("gDbpE",function(e,t){$parcel$export(e.exports,"getIdsFromRecoveryStore",function(){return v}),$parcel$export(e.exports,"clearOldRecoveries",function(){return y}),$parcel$export(e.exports,"deleteRecovery",function(){return E}),$parcel$export(e.exports,"removeOrphans",function(){return w}),$parcel$export(e.exports,"getRecovery",function(){return k}),$parcel$export(e.exports,"changeRecoveryId",function(){return S}),$parcel$export(e.exports,"storeRecovery",function(){return C}),$parcel$export(e.exports,"getMetadata",function(){return T});var i=parcelRequire("1LaJZ"),n=parcelRequire("cL71g"),r=parcelRequire("4EWN2"),a=parcelRequire("bX4ja"),s=(parcelRequire("2gUX3"),parcelRequire("2gUX3")),o=parcelRequire("jTg9g"),l=parcelRequire("3hwQ7"),h=parcelRequire("esGm2"),c=parcelRequire("eWjiX"),u=parcelRequire("gWfkn"),d=parcelRequire("7nLJW"),p=parcelRequire("7jh4K"),f=parcelRequire("6otAp"),g=parcelRequire("6mTnI");function v(){return(0,i._)(function(){return(0,s.__generator)(this,function(e){switch(e.label){case 0:return[4,o.KL_INDEXED_DB.getKeys(o.RECOVERY_STORE)];case 1:return[2,e.sent().map(function(e){return+e})]}})})()}function m(){return(0,i._)(function(){return(0,s.__generator)(this,function(e){switch(e.label){case 0:return[4,o.KL_INDEXED_DB.getKeys(o.IMAGE_DATA_STORE)];case 1:return[2,e.sent()]}})})()}function y(){return(0,i._)(function(){var e;return(0,s.__generator)(this,function(t){switch(t.label){case 0:return[4,o.KL_INDEXED_DB.getKeys(o.RECOVERY_STORE)];case 1:return[4,Promise.all((e=t.sent()).map(function(e){return o.KL_INDEXED_DB.get(o.RECOVERY_STORE,e)}))];case 2:return[4,Promise.all(t.sent().map(function(t,i){return t.timestamp<new Date().getTime()-f.RECOVERY_AGE_LIMIT_MS?E(e[i]):Promise.resolve()}))];case 3:return t.sent(),[2]}})})()}function x(e,t){return(0,i._)(function(){var i,n,r,a,h;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return[4,o.KL_INDEXED_DB.get(o.IMAGE_DATA_STORE,e)];case 1:if(!(i=s.sent()))return t.clearRect(0,0,u.HISTORY_TILE_SIZE,u.HISTORY_TILE_SIZE),[2,t.getImageData(0,0,u.HISTORY_TILE_SIZE,u.HISTORY_TILE_SIZE)];if(!(0,p.isBlob)(i))return[3,6];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,(0,l.loadImage)(i)];case 3:return n=s.sent(),[3,5];case 4:return r=s.sent(),[3,5];case 5:return t.canvas.width=null!=(a=null==n?void 0:n.width)?a:t.canvas.width,t.canvas.height=null!=(h=null==n?void 0:n.height)?h:t.canvas.height,n&&t.drawImage(n,0,0),[2,t.getImageData(0,0,t.canvas.width,t.canvas.height)];case 6:return[2,i]}})})()}function b(e){return(0,i._)(function(){return(0,s.__generator)(this,function(t){switch(t.label){case 0:return[4,o.KL_INDEXED_DB.get(o.RECOVERY_STORE,""+e)];case 1:return[2,t.sent()]}})})()}function w(e){return(0,i._)(function(){var t,i,n,r,a,l,c,u,d,p,f,y,x,b,w,k,B,S,C,E,_,I,T,M,L,R,P,A,D,O,z;return(0,s.__generator)(this,function(s){switch(s.label){case 0:if(null==e)return[3,1];return i=e,[3,3];case 1:return[4,m()];case 2:i=s.sent(),s.label=3;case 3:return t=i,n=new Set,[4,v()];case 4:r=s.sent(),a=!0,l=!1,c=void 0,s.label=5;case 5:s.trys.push([5,10,11,12]),u=r[Symbol.iterator](),s.label=6;case 6:if(a=(d=u.next()).done)return[3,9];return p=d.value,[4,o.KL_INDEXED_DB.get(o.RECOVERY_STORE,""+p)];case 7:if(!(f=s.sent()))return[3,8];y=!0,x=!1,b=void 0;try{for(w=f.layers[Symbol.iterator]();!(y=(k=w.next()).done);y=!0){B=k.value,S=!0,C=!1,E=void 0;try{for(_=B.image[Symbol.iterator]();!(S=(I=_.next()).done);S=!0)T=I.value,(0,h.isLayerFill)(T)||n.add(T.id)}catch(e){C=!0,E=e}finally{try{S||null==_.return||_.return()}finally{if(C)throw E}}}}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}n.add(f.thumbnail),s.label=8;case 8:return a=!0,[3,6];case 9:return[3,12];case 10:return M=s.sent(),l=!0,c=M,[3,12];case 11:try{a||null==u.return||u.return()}finally{if(l)throw c}return[7];case 12:return[4,o.KL_INDEXED_DB.get(o.BROWSER_STORAGE_STORE,1)];case 13:if(L=s.sent()){(0,g.isTImageDataReference)(L.thumbnail)&&n.add(L.thumbnail.id),R=!0,P=!1,A=void 0;try{for(D=L.layers[Symbol.iterator]();!(R=(O=D.next()).done);R=!0)z=O.value,(0,g.isTImageDataReference)(z.blob)&&n.add(z.blob.id)}catch(e){P=!0,A=e}finally{try{R||null==D.return||D.return()}finally{if(P)throw A}}}return[4,o.KL_INDEXED_DB.bulkRemove(o.IMAGE_DATA_STORE,t.filter(function(e){return!n.has(e)}))];case 14:return s.sent(),[2]}})})()}function k(e){return(0,i._)(function(){var t,a,l,d,f,g;return(0,s.__generator)(this,function(v){switch(v.label){case 0:return[4,o.KL_INDEXED_DB.get(o.RECOVERY_STORE,""+e)];case 1:if(void 0===(t=v.sent()))return[2,void 0];return a=c.BB.canvas(u.HISTORY_TILE_SIZE,u.HISTORY_TILE_SIZE),l=c.BB.ctx(a),d=[],[4,Promise.all(t.layers.map(function(e,t){return(0,i._)(function(){var i,a,o,c,u;return(0,s.__generator)(this,function(s){switch(s.label){case 0:i=[],a=0,s.label=1;case 1:if(!(a<e.image.length))return[3,5];if(o=e.image[a],!(0,h.isLayerFill)(o))return[3,2];return i.push(o),[3,4];case 2:return c=i.push,u={id:o.id},[4,x(o.id,l)];case 3:c.apply(i,[(u.data=s.sent(),u)]),s.label=4;case 4:return a++,[3,1];case 5:return d[t]=(0,r._)((0,n._)({},e),{image:i}),[2]}})})()}))];case 2:return v.sent(),g={project:{projectId:null!=(f=t.projectId)?f:(0,p.randomUuid)(),width:t.width,height:t.height,layers:d},timestamp:0},[4,B(t.thumbnail)];case 3:return[2,(g.thumbnail=v.sent(),g)]}})})()}function B(e){return(0,i._)(function(){var t,i,n;return(0,s.__generator)(this,function(r){switch(r.label){case 0:return t=c.BB.canvas(u.HISTORY_TILE_SIZE,u.HISTORY_TILE_SIZE),[4,x(e,i=c.BB.ctx(t))];case 1:return n=r.sent(),t.width=n.width,t.height=n.height,i.putImageData(n,0,0),[2,t]}})})()}function S(e,t){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,b(e)];case 1:if(!(i=n.sent()))return[2,!1];return i.timestamp=new Date().getTime(),[4,o.KL_INDEXED_DB.set(o.RECOVERY_STORE,""+t,i)];case 2:return n.sent(),[4,o.KL_INDEXED_DB.remove(o.RECOVERY_STORE,""+e)];case 3:return n.sent(),[2,!0]}})})()}function C(e,t,n){return(0,i._)(function(){var r,l,u,g,v,m,y,x,k,B,S,C,T,M,L,R,P,A,D,O,z,H,j,F,X,V,U,W;return(0,s.__generator)(this,function(N){switch(N.label){case 0:return N.trys.push([0,,22,24]),l=n((0,p.fitInto)(t.size.width,t.size.height,f.RECOVERY_THUMB_WIDTH_PX,f.RECOVERY_THUMB_HEIGHT_PX).width/t.size.width),u=Object.values(t.layerMap).sort(d.sortLayerMap),[4,(0,p.timeoutWrapper)(b(e),"storeRecovery.getRawRecoveryProject")];case 1:v=new Set(null==(g=N.sent())?void 0:g.layers.flatMap(function(e){return e.image.map(function(e){return(0,h.isLayerFill)(e)?void 0:e.id}).filter(function(e){return void 0!==e})})),g&&v.add(g.thumbnail),m={},g&&g.layers.forEach(function(e){e.image.forEach(function(e){(0,h.isLayerFill)(e)||(m[e.id]=e.sizeBytes||0)})}),y=new Set(u.flatMap(function(e){return e.tiles.flatMap(function(e){return(0,h.isLayerFill)(e)?[]:[e.id]})})),r=(0,a._)(v).filter(function(e){return!y.has(e)}),x=[],k=[],B=0,S=!0,C=!1,T=void 0,N.label=2;case 2:N.trys.push([2,7,8,9]),M=function(){var e,t,n;return(0,s.__generator)(this,function(r){switch(r.label){case 0:return e=R.value,t=x.push,n={name:e.name,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr},[4,function(){return(0,i._)(function(){var t,i,n,r,a,o,l,c;return(0,s.__generator)(this,function(s){t=[],i=!0,n=!1,r=void 0;try{for(a=e.tiles[Symbol.iterator]();!(i=(o=a.next()).done);i=!0)l=o.value,(0,h.isLayerFill)(l)?(t.push(l),B+=l.fill.length):(c=0,v.has(l.id)?c=m[l.id]:(k.push({id:l.id,data:l.data}),c=l.data.width*l.data.height*4),B+=c,t.push({id:l.id,sizeBytes:c}))}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}return[2,t]})})()}()];case 1:return t.apply(x,[(n.image=r.sent(),n)]),[2]}})},L=u[Symbol.iterator](),N.label=3;case 3:if(S=(R=L.next()).done)return[3,6];return[5,(0,s.__values)(M())];case 4:N.sent(),N.label=5;case 5:return S=!0,[3,3];case 6:return[3,9];case 7:return P=N.sent(),C=!0,T=P,[3,9];case 8:try{S||null==L.return||L.return()}finally{if(C)throw T}return[7];case 9:return A={id:(0,p.randomUuid)(),data:function(){return c.BB.ctx(l).getImageData(0,0,l.width,l.height)}()},k.push(A),B+=A.data.width*A.data.height*4,D={projectId:t.projectId.value,width:t.size.width,height:t.size.height,timestamp:new Date().getTime(),thumbnail:A.id,layers:x,memoryEstimateBytes:B},[4,(0,p.timeoutWrapper)(I(e),"storeRecovery.getTotalMemory")];case 10:if(!((O=N.sent())+B>f.RECOVERY_MEMORY_LIMIT_BYTES))return[3,19];return z=O+B-f.RECOVERY_MEMORY_LIMIT_BYTES,H=0,j=[],[4,_()];case 11:N.sent().sort(function(e,t){return e.timestamp>t.timestamp?1:e.timestamp<t.timestamp?-1:0}).forEach(function(e){H>=z||(j.push(e.id),H+=e.memoryEstimateBytes)}),F=!0,X=!1,V=void 0,N.label=12;case 12:N.trys.push([12,17,18,19]),U=j[Symbol.iterator](),N.label=13;case 13:if(F=(W=U.next()).done)return[3,16];return[4,E(W.value)];case 14:N.sent(),N.label=15;case 15:return F=!0,[3,13];case 16:return[3,19];case 17:return P=N.sent(),X=!0,V=P,[3,19];case 18:try{F||null==U.return||U.return()}finally{if(X)throw V}return[7];case 19:return[4,(0,p.timeoutWrapper)(o.KL_INDEXED_DB.bulkSet(o.IMAGE_DATA_STORE,k.map(function(e){return{key:e.id,value:e.data}})),"storeRecovery.storeTile",3e4)];case 20:return N.sent(),[4,(0,p.timeoutWrapper)(o.KL_INDEXED_DB.set(o.RECOVERY_STORE,""+e,D),"storeRecovery.storeRecovery")];case 21:return N.sent(),[3,24];case 22:return[4,(0,p.timeoutWrapper)(w(r),"storeRecovery.removeOrphans",8e3)];case 23:return N.sent(),[7];case 24:return[2]}})})()}function E(e){return(0,i._)(function(){var t,i,n,r,a,l,c,u,d,p,f,g,v,m;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return[4,o.KL_INDEXED_DB.get(o.RECOVERY_STORE,e)];case 1:if(!(t=s.sent()))return[2];return[4,o.KL_INDEXED_DB.remove(o.RECOVERY_STORE,e)];case 2:s.sent(),i=[t.thumbnail],n=!0,r=!1,a=void 0;try{for(l=t.layers[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){u=c.value,d=!0,p=!1,f=void 0;try{for(g=u.image[Symbol.iterator]();!(d=(v=g.next()).done);d=!0)m=v.value,(0,h.isLayerFill)(m)||i.push(m.id)}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}}}catch(e){r=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}return[4,w(i)];case 3:return s.sent(),[2]}})})()}function _(){return(0,i._)(function(){var e,t,i,n,r,a,o,l,h,c;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return[4,v()];case 1:e=s.sent(),t=[],i=!0,n=!1,r=void 0,s.label=2;case 2:s.trys.push([2,7,8,9]),a=e[Symbol.iterator](),s.label=3;case 3:if(i=(o=a.next()).done)return[3,6];return l=o.value,h=t.push,[4,T(""+l)];case 4:h.apply(t,[s.sent()]),s.label=5;case 5:return i=!0,[3,3];case 6:return[3,9];case 7:return c=s.sent(),n=!0,r=c,[3,9];case 8:try{i||null==a.return||a.return()}finally{if(n)throw r}return[7];case 9:return[2,t]}})})()}function I(e){return(0,i._)(function(){var t,i,n,r,a,o,l,h,c,u;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return[4,v()];case 1:t=s.sent(),i=0,n=!0,r=!1,a=void 0,s.label=2;case 2:s.trys.push([2,7,8,9]),o=t[Symbol.iterator](),s.label=3;case 3:if(n=(l=o.next()).done)return[3,6];if((h=l.value)===e)return[3,5];return[4,T(""+h)];case 4:c=s.sent(),i+=c.memoryEstimateBytes,s.label=5;case 5:return n=!0,[3,3];case 6:return[3,9];case 7:return u=s.sent(),r=!0,a=u,[3,9];case 8:try{n||null==o.return||o.return()}finally{if(r)throw a}return[7];case 9:return[2,i]}})})()}function T(e,t){return(0,i._)(function(){var i,n,r,a;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return[4,o.KL_INDEXED_DB.get(o.RECOVERY_STORE,e)];case 1:if(void 0===(i=s.sent()))throw Error("drawing not found");if(r={id:e,width:(n=i).width,height:n.height},!t)return[3,3];return[4,B(n.thumbnail)];case 2:return a=s.sent(),[3,4];case 3:a=void 0,s.label=4;case 4:return[2,(r.thumbnail=a,r.timestamp=n.timestamp,r.memoryEstimateBytes=n.memoryEstimateBytes,r)]}})})()}}),parcelRegister("jTg9g",function(e,t){$parcel$export(e.exports,"getKlIndexedDbName",function(){return r}),$parcel$export(e.exports,"RECOVERY_STORE",function(){return a}),$parcel$export(e.exports,"IMAGE_DATA_STORE",function(){return s}),$parcel$export(e.exports,"BROWSER_STORAGE_STORE",function(){return o}),$parcel$export(e.exports,"KL_INDEXED_DB_STORES",function(){return l}),$parcel$export(e.exports,"KL_INDEXED_DB_VERSION",function(){return h}),$parcel$export(e.exports,"KL_INDEXED_DB_UPGRADER",function(){return c}),$parcel$export(e.exports,"KL_INDEXED_DB",function(){return u});var i=parcelRequire("hzsIx"),n="Klecks";function r(){return n}var a="RecoveryStore",s="ImageDataStore",o="ProjectStore",l=[a,s,o],h=2,c=function(e){var t=e.oldVersion,i=e.target.result;t<1&&i.createObjectStore(o,{keyPath:"id"}).createIndex("id","id",{unique:!0}),t<2&&(i.createObjectStore(s),i.createObjectStore(a))},u=new(0,i.IndexedDb)({})}),parcelRegister("hzsIx",function(e,t){$parcel$export(e.exports,"IndexedDb",function(){return h});var i=parcelRequire("1LaJZ"),n=parcelRequire("cx0mh"),r=parcelRequire("7h4XF"),a=parcelRequire("bX4ja"),s=parcelRequire("2gUX3"),o=parcelRequire("7jh4K"),l=function(){return(0,i._)(function(){var e,t,i,n,r;return(0,s.__generator)(this,function(a){switch(a.label){case 0:e=!0,t="kl-blob-url-test",a.label=1;case 1:return a.trys.push([1,4,,5]),i=new Blob(["test"],{type:"text/plain"}),[4,(0,o.timeoutWrapper)(new Promise(function(e,i){var n=indexedDB.open(t,1);n.onerror=function(){return i(n.error)},n.onsuccess=function(){return e(n.result)},n.onupgradeneeded=function(e){e.target.result.createObjectStore("testStore")}}),"areBlobUrlsSupported.createDb")];case 2:return n=a.sent(),[4,(0,o.timeoutWrapper)(new Promise(function(e,t){var r=n.transaction("testStore","readwrite"),a=r.objectStore("testStore").put(i,"testStore");r.onabort=function(){return e()},a.onsuccess=function(){return e()},a.onerror=function(){return t(a.error)}}),"areBlobUrlsSupported.storeBlob")];case 3:return a.sent(),n.close(),[3,5];case 4:return r=a.sent(),e=!1,[3,5];case 5:try{indexedDB.deleteDatabase(t)}catch(e){}return[2,e]}})})()},h=function(){"use strict";function e(t){(0,n._)(this,e),this.dbVersion=-1,this.dbName="",this.storeNames=[],this.upgrader=function(){},this.isAvailable=!0,this.openTransactionCount=0}return(0,r._)(e,[{key:"disconnect",value:function(){var e;null==(e=this.db)||e.close(),this.db=void 0}},{key:"autoDisconnectWrapper",value:function(e){return(0,i._)(function(){var t;return(0,s.__generator)(this,function(i){switch(i.label){case 0:t=this,i.label=1;case 1:return i.trys.push([1,,3,4]),this.openTransactionCount++,clearTimeout(this.disconnectTimeout),[4,e()];case 2:return[2,i.sent()];case 3:return this.openTransactionCount--,0===this.openTransactionCount&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=setTimeout(function(){return t.disconnect()},1e3)),[7];case 4:return[2]}})}).call(this)}},{key:"openDb",value:function(){return(0,i._)(function(){var e;return(0,s.__generator)(this,function(t){return(e=this,this.db)?[2]:[2,new Promise(function(t,i){var n=indexedDB.open(e.dbName,e.dbVersion);n.onupgradeneeded=function(t){e.upgrader(t)},n.onsuccess=function(i){e.db=i.target.result,e.db.onversionchange=function(){throw e.isAvailable=!1,e.disconnect(),Error("idb onversionchange")},t()},n.onerror=function(t){e.isAvailable=!1,i(t.target.error)}})]})}).call(this)}},{key:"getTransaction",value:function(e,t){if(!this.storeNames.includes(e))throw Error(`indexedDb store "${e}" not found in "${this.dbName}"`);var i=this.db.transaction(e,t);return{transaction:i,objectStore:i.objectStore(e)}}},{key:"init",value:function(e,t,i,n){if(""!==this.dbName)throw Error("IndexedDb already initialized");this.dbName=e,this.storeNames=(0,a._)(t),this.dbVersion=i,this.upgrader=n}},{key:"testConnection",value:function(){return(0,i._)(function(){var e,t,i,n,r,a,h,c,u,d;return(0,s.__generator)(this,function(s){switch(s.label){case 0:if(e=this,!(t=this.isAvailable))return[3,2];return[4,l()];case 1:t=s.sent(),s.label=2;case 2:if(e.isAvailable=t,!this.isAvailable)return[2,this.isAvailable];s.label=3;case 3:s.trys.push([3,12,,13]),i=!0,n=!1,r=void 0,s.label=4;case 4:s.trys.push([4,9,10,11]),a=this.storeNames[Symbol.iterator](),s.label=5;case 5:if(i=(h=a.next()).done)return[3,8];return c=h.value,[4,(0,o.timeoutWrapper)(this.openDb(),"indexed-db.testConnection.openDb")];case 6:s.sent(),this.getTransaction(c,"readonly").transaction.abort(),s.label=7;case 7:return i=!0,[3,5];case 8:return[3,11];case 9:return u=s.sent(),n=!0,r=u,[3,11];case 10:try{i||null==a.return||a.return()}finally{if(n)throw r}return[7];case 11:return[3,13];case 12:return d=s.sent(),this.isAvailable=!1,[3,13];case 13:return[2,this.isAvailable]}})}).call(this)}},{key:"set",value:function(e,t,n){return(0,i._)(function(){var r;return(0,s.__generator)(this,function(a){return r=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(r){switch(r.label){case 0:return i=this,[4,this.openDb()];case 1:return r.sent(),[4,new Promise(function(r,a){var s=i.getTransaction(e,"readwrite"),o=s.transaction,l=s.objectStore;o.onabort=function(){return a(o.error)};var h=l.put(n,t);h.onsuccess=function(){r()},h.onerror=function(){return a(h.error)}})];case 2:return[2,r.sent()]}})}).call(r)})]})}).call(this)}},{key:"get",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[4,new Promise(function(n,r){var a=i.getTransaction(e,"readonly"),s=a.transaction,o=a.objectStore;s.onabort=function(){return r(s.error)};var l=o.get(t);l.onsuccess=function(){return n(l.result)},l.onerror=function(){return r(l.error)}})];case 2:return[2,n.sent()]}})}).call(n)})]})}).call(this)}},{key:"has",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[4,new Promise(function(n,r){var a=i.getTransaction(e,"readonly"),s=a.transaction,o=a.objectStore;s.onabort=function(){return r(s.error)};var l=o.getKey(t);l.onsuccess=function(){return n(!!l.result)},l.onerror=function(){return r(l.error)}})];case 2:return[2,n.sent()]}})}).call(n)})]})}).call(this)}},{key:"getKeys",value:function(e){return(0,i._)(function(){var t;return(0,s.__generator)(this,function(n){return t=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var t;return(0,s.__generator)(this,function(i){switch(i.label){case 0:return t=this,[4,this.openDb()];case 1:return i.sent(),[4,new Promise(function(i,n){var r=t.getTransaction(e,"readonly"),a=r.transaction,s=r.objectStore;a.onabort=function(){return n(a.error)};var o=s.getAllKeys();o.onsuccess=function(){return i(o.result.map(function(e){return e.toString()}))},o.onerror=function(){return n(o.error)}})];case 2:return[2,i.sent()]}})}).call(t)})]})}).call(this)}},{key:"remove",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[4,new Promise(function(n,r){var a=i.getTransaction(e,"readwrite"),s=a.transaction,o=a.objectStore;s.onabort=function(){return r(s.error)};var l=o.delete(t);l.onsuccess=function(){n()},l.onerror=function(){return r(l.error)}})];case 2:return[2,n.sent()]}})}).call(n)})]})}).call(this)}},{key:"bulkSet",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[2,new Promise(function(n,r){var a=i.getTransaction(e,"readwrite"),s=a.transaction,o=a.objectStore;s.onabort=function(){return r(s.error)},s.onerror=function(){return r(s.error)},s.oncomplete=function(){return n()};var l=!0,h=!1,c=void 0;try{for(var u,d=function(){var e=u.value,t=e.key,i=e.value,n=o.put(i,t);n.onerror=function(){return r(n.error)}},p=t[Symbol.iterator]();!(l=(u=p.next()).done);l=!0)d()}catch(e){h=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw c}}})]}})}).call(n)})]})}).call(this)}},{key:"bulkGet",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[2,new Promise(function(n,r){var a={},s=i.getTransaction(e,"readonly"),o=s.transaction,l=s.objectStore;o.onabort=function(){return r(o.error)},o.onerror=function(){return r(o.error)},o.oncomplete=function(){return n(a)},t.forEach(function(e,t){var i=l.get(e);i.onsuccess=function(){return a[""+e]=i.result},i.onerror=function(){return r(i.error)}})})]}})}).call(n)})]})}).call(this)}},{key:"bulkRemove",value:function(e,t){return(0,i._)(function(){var n;return(0,s.__generator)(this,function(r){return n=this,[2,this.autoDisconnectWrapper(function(){return(0,i._)(function(){var i;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return i=this,[4,this.openDb()];case 1:return n.sent(),[2,new Promise(function(n,r){var a=i.getTransaction(e,"readwrite"),s=a.transaction,o=a.objectStore;s.onabort=function(){return r(s.error)},s.onerror=function(){return r(s.error)},s.oncomplete=function(){return n()};var l=!0,h=!1,c=void 0;try{for(var u,d=function(){var e=u.value,t=o.delete(e);t.onerror=function(){return r(t.error)}},p=t[Symbol.iterator]();!(l=(u=p.next()).done);l=!0)d()}catch(e){h=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw c}}})]}})}).call(n)})]})}).call(this)}},{key:"getIsAvailable",value:function(){return this.isAvailable}},{key:"destroy",value:function(){this.disconnect()}}]),e}()}),parcelRegister("3hwQ7",function(e,t){$parcel$export(e.exports,"PROJECT_STORE_THUMBNAIL_SIZE_PX",function(){return h}),$parcel$export(e.exports,"loadImage",function(){return c}),$parcel$export(e.exports,"ProjectConverter",function(){return u});var i=parcelRequire("1LaJZ"),n=parcelRequire("cx0mh"),r=parcelRequire("7h4XF"),a=parcelRequire("2gUX3"),s=parcelRequire("eWjiX"),o=parcelRequire("aSJRf"),l=parcelRequire("eIcQa"),h=240;function c(e){return new Promise(function(t,i){var n=new Image;try{n.src=s.BB.imageBlobToUrl(e)}catch(e){i("imageBlobToUrl, "+(e instanceof Error?e.message:""));return}n.onload=function(){URL.revokeObjectURL(n.src),t(n)},n.onabort=function(){URL.revokeObjectURL(n.src),i("layer image failed loading (abort)")},n.onerror=function(){URL.revokeObjectURL(n.src),i("layer image failed loading (error)")}})}var u=function(){"use strict";function e(){(0,n._)(this,e)}return(0,r._)(e,null,[{key:"createThumbnail",value:function(e){var t=s.BB.fitInto(e.width,e.height,h,h).width/e.width;return(0,o.drawProject)(e,t)}},{key:"createStorageProject",value:function(t){return(0,i._)(function(){var i,n,r,s,o,h,c,u,d,p,f;return(0,a.__generator)(this,function(a){switch(a.label){case 0:i=[],n=!0,r=!1,s=void 0,a.label=1;case 1:a.trys.push([1,8,9,10]),o=t.layers[Symbol.iterator](),a.label=2;case 2:if(n=(h=o.next()).done)return[3,7];if(c=h.value,u=void 0,!(c.image instanceof HTMLCanvasElement))return[3,4];return[4,(0,l.canvasToBlob)(c.image,"image/png")];case 3:return u=a.sent(),[3,5];case 4:throw Error("Not implemented");case 5:i.push({name:c.name,isVisible:c.isVisible,opacity:c.opacity,mixModeStr:null!=(d=c.mixModeStr)?d:"source-over",blob:u}),a.label=6;case 6:return n=!0,[3,2];case 7:return[3,10];case 8:return p=a.sent(),r=!0,s=p,[3,10];case 9:try{n||null==o.return||o.return()}finally{if(r)throw s}return[7];case 10:return f={id:1,projectId:t.projectId,timestamp:new Date().getTime()},[4,(0,l.canvasToBlob)(e.createThumbnail(t),"image/png")];case 11:return[2,(f.thumbnail=a.sent(),f.width=t.width,f.height=t.height,f.layers=i,f)]}})})()}},{key:"readStorageProject",value:function(e){return(0,i._)(function(){var t,i;return(0,a.__generator)(this,function(n){switch(n.label){case 0:if(!e.width||!e.height||isNaN(e.width)||isNaN(e.height)||e.width<1||e.height<1)throw Error("readStorageProject invalid canvas size: "+e.width+", "+e.height);return t={projectId:e.projectId,width:e.width,height:e.height},[4,Promise.all(e.layers.map(function(t){return t.blob?c(t.blob).catch(function(){return new Image(e.width,e.height)}):new Image(e.width,e.height)}))];case 1:return t.layers=n.sent().map(function(t,i){var n=e.layers[i];return{name:n.name,isVisible:n.isVisible,opacity:n.opacity,mixModeStr:n.mixModeStr,image:t}}),i={project:t,timestamp:e.timestamp},[4,c(e.thumbnail).catch(function(){return new Image(h,h)})];case 2:return[2,(i.thumbnail=n.sent(),i)]}})})()}},{key:"readStorageMeta",value:function(e){return(0,i._)(function(){var t,i;return(0,a.__generator)(this,function(n){switch(n.label){case 0:if(t={projectId:e.projectId,timestamp:e.timestamp},!e.thumbnail)return[3,2];return[4,c(e.thumbnail).catch(function(){return new Image(h,h)})];case 1:return i=n.sent(),[3,3];case 2:i=s.BB.canvas(10,10),n.label=3;case 3:return[2,(t.thumbnail=i,t)]}})})()}}]),e}()}),parcelRegister("aSJRf",function(e,t){$parcel$export(e.exports,"drawProject",function(){return o});var i=parcelRequire("eWjiX"),n=parcelRequire("esGm2"),r=parcelRequire("bbA6w");parcelRequire("ciAU9");var a=parcelRequire("kFecW"),s=parcelRequire("9b3eo");function o(e,t,o){var l=i.BB.canvas(Math.max(1,Math.round(e.width*t)),Math.max(1,Math.round(e.height*t))),h=o?(0,r.transformMultiPolygon)(o,(0,a.scale)(l.width/e.width,l.height/e.height)):void 0,c=i.BB.ctx(l);c.save(),h&&c.clip((0,s.getSelectionPath2d)(h)),t>1&&(c.imageSmoothingEnabled=!1);for(var u=0;u<e.layers.length;u++){var d=e.layers[u];if(d.isVisible&&0!==d.opacity){c.globalAlpha=d.opacity;var p=d.mixModeStr;if(c.globalCompositeOperation=void 0!==p?p:"source-over",(0,n.isLayerFill)(d.image))c.fillStyle=d.image.fill,c.fillRect(0,0,l.width,l.height);else if(d.image instanceof Array)throw Error("not implemented");else c.drawImage(d.image,0,0,l.width,l.height)}}return c.restore(),l}}),parcelRegister("esGm2",function(e,t){function i(e){return"object"==typeof e&&null!==e&&"fill"in e&&"string"==typeof e.fill}$parcel$export(e.exports,"isLayerFill",function(){return i})}),parcelRegister("bbA6w",function(e,t){$parcel$export(e.exports,"transformMultiPolygon",function(){return n}),parcelRequire("ciAU9");var i=parcelRequire("cdZRx");function n(e,t){return e.map(function(e){return e.map(function(e){return e.map(function(e){return Object.values((0,i.applyToPoint)(t,{x:e[0],y:e[1]}))})})})}}),parcelRegister("ciAU9",function(e,t){$parcel$export(e.exports,"applyToPoint",function(){return parcelRequire("cdZRx").applyToPoint}),$parcel$export(e.exports,"identity",function(){return parcelRequire("83Kse").identity}),$parcel$export(e.exports,"inverse",function(){return parcelRequire("kDVZW").inverse}),$parcel$export(e.exports,"rotate",function(){return parcelRequire("1RMPr").rotate}),$parcel$export(e.exports,"scale",function(){return parcelRequire("kFecW").scale}),$parcel$export(e.exports,"compose",function(){return parcelRequire("dZ59l").compose}),$parcel$export(e.exports,"translate",function(){return parcelRequire("kr2fR").translate}),parcelRequire("cdZRx"),parcelRequire("3wE7v"),parcelRequire("btdnM"),parcelRequire("83Kse"),parcelRequire("kDVZW"),parcelRequire("lNvMw"),parcelRequire("1RMPr"),parcelRequire("kFecW"),parcelRequire("8jtBQ"),parcelRequire("ibhub"),parcelRequire("2mZ9s"),parcelRequire("dZ59l"),parcelRequire("kr2fR"),parcelRequire("5687o"),parcelRequire("eP59S"),parcelRequire("i0iB3"),parcelRequire("ag5pW"),parcelRequire("gvDD3"),parcelRequire("4JElo"),parcelRequire("90Qul")}),parcelRegister("cdZRx",function(e,t){function i(e,t){return Array.isArray(t)?[e.a*t[0]+e.c*t[1]+e.e,e.b*t[0]+e.d*t[1]+e.f]:{x:e.a*t.x+e.c*t.y+e.e,y:e.b*t.x+e.d*t.y+e.f}}$parcel$export(e.exports,"applyToPoint",function(){return i})}),parcelRegister("3wE7v",function(e,t){$parcel$export(e.exports,"fromObject",function(){return i});function i(e){return{a:parseFloat(e.a),b:parseFloat(e.b),c:parseFloat(e.c),d:parseFloat(e.d),e:parseFloat(e.e),f:parseFloat(e.f)}}}),parcelRegister("btdnM",function(e,t){}),parcelRegister("83Kse",function(e,t){$parcel$export(e.exports,"identity",function(){return i});function i(){return{a:1,c:0,e:0,b:0,d:1,f:0}}}),parcelRegister("kDVZW",function(e,t){$parcel$export(e.exports,"inverse",function(){return i});function i(e){var t=e.a,i=e.b,n=e.c,r=e.d,a=e.e,s=e.f,o=t*r-i*n;return{a:r/o,b:-(i/o),c:-(n/o),d:t/o,e:-((r*a-n*s)/o),f:(i*a-t*s)/o}}}),parcelRegister("lNvMw",function(e,t){parcelRequire("9LyQ8")}),parcelRegister("9LyQ8",function(e,t){function i(e){return void 0===e}function n(e){return"number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e)}function r(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}$parcel$export(e.exports,"isUndefined",function(){return i}),$parcel$export(e.exports,"isNumeric",function(){return n}),$parcel$export(e.exports,"isObject",function(){return r})}),parcelRegister("1RMPr",function(e,t){$parcel$export(e.exports,"rotate",function(){return l}),$parcel$export(e.exports,"rotateDEG",function(){return h});var i=parcelRequire("9LyQ8"),n=parcelRequire("kr2fR"),r=parcelRequire("dZ59l"),a=Math.cos,s=Math.sin,o=Math.PI;function l(e,t,o){var l=a(e),h=s(e),c={a:l,c:-h,e:0,b:h,d:l,f:0};return(0,i.isUndefined)(t)||(0,i.isUndefined)(o)?c:(0,r.transform)([(0,n.translate)(t,o),c,(0,n.translate)(-t,-o)])}function h(e,t,i){return l(e*o/180,t,i)}}),parcelRegister("kr2fR",function(e,t){$parcel$export(e.exports,"translate",function(){return i});function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{a:1,c:0,e:e,b:0,d:1,f:t}}}),parcelRegister("dZ59l",function(e,t){$parcel$export(e.exports,"transform",function(){return r}),$parcel$export(e.exports,"compose",function(){return a});var i=parcelRequire("lYyRs"),n=parcelRequire("bX4ja");function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];t=Array.isArray(t[0])?t[0]:t;var s=function(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}};switch(t.length){case 0:throw Error("no matrices provided");case 1:return t[0];case 2:return s(t[0],t[1]);default:var o=(0,i._)(t),l=o[0],h=o[1],c=o.slice(2),u=s(l,h);return r.apply(void 0,[u].concat((0,n._)(c)))}}function a(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.apply(void 0,(0,n._)(t))}}),parcelRegister("lYyRs",function(e,t){$parcel$export(e.exports,"_",function(){return s});var i=parcelRequire("vDBh4"),n=parcelRequire("5mm0I"),r=parcelRequire("keO5I"),a=parcelRequire("kWe4k");function s(e){return(0,i._)(e)||(0,n._)(e)||(0,a._)(e)||(0,r._)()}}),parcelRegister("kFecW",function(e,t){$parcel$export(e.exports,"scale",function(){return a});var i=parcelRequire("9LyQ8"),n=parcelRequire("kr2fR"),r=parcelRequire("dZ59l");function a(e,t,a,s){(0,i.isUndefined)(t)&&(t=e);var o={a:e,c:0,e:0,b:0,d:t,f:0};return(0,i.isUndefined)(a)||(0,i.isUndefined)(s)?o:(0,r.transform)([(0,n.translate)(a,s),o,(0,n.translate)(-a,-s)])}}),parcelRegister("8jtBQ",function(e,t){$parcel$export(e.exports,"shear",function(){return i});function i(e,t){return{a:1,c:e,e:0,b:t,d:1,f:0}}}),parcelRegister("ibhub",function(e,t){$parcel$export(e.exports,"skewDEG",function(){return r});var i=Math.tan;function n(e,t){return{a:1,c:i(e),e:0,b:i(t),d:1,f:0}}function r(e,t){return n(e*Math.PI/180,t*Math.PI/180)}}),parcelRegister("2mZ9s",function(e,t){}),parcelRegister("5687o",function(e,t){parcelRequire("kDVZW"),parcelRequire("dZ59l"),parcelRequire("eP59S")}),parcelRegister("eP59S",function(e,t){$parcel$export(e.exports,"smoothMatrix",function(){return i});function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return{a:Math.round(e.a*t)/t,b:Math.round(e.b*t)/t,c:Math.round(e.c*t)/t,d:Math.round(e.d*t)/t,e:Math.round(e.e*t)/t,f:Math.round(e.f*t)/t}}}),parcelRegister("i0iB3",function(e,t){parcelRequire("3wE7v"),parcelRequire("kr2fR"),parcelRequire("kFecW"),parcelRequire("1RMPr"),parcelRequire("ibhub"),parcelRequire("8jtBQ")}),parcelRegister("ag5pW",function(e,t){parcelRequire("376sE")}),parcelRegister("376sE",function(e,t){$parcel$export(e.exports,"parse",function(){return o});var i=parcelRequire("fFwUa"),n=parcelRequire("cx0mh"),r=parcelRequire("7h4XF"),a=parcelRequire("9xmuV"),s=function(e){"use strict";function t(e,r,a,s){var o;return(0,n._)(this,t),(o=(0,i._)(this,t,[e])).expected=r,o.found=a,o.location=s,o.name="SyntaxError",o}return(0,a._)(t,e),(0,r._)(t,[{key:"format",value:function(e){var t=this,i="Error: "+this.message;if(this.location){var n=null,r=e.find(function(e){return e.source===t.location.source});r&&(n=r.text.split(/\r\n|\n|\r/g));var a=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(a):a,o=this.location.source+":"+s.line+":"+s.column;if(n){var l=this.location.end,h="".padEnd(s.line.toString().length," "),c=n[a.line-1],u=(a.line===l.line?l.column:c.length+1)-a.column||1;i+="\n --\x3e "+o+"\n"+h+" |\n"+s.line+" | "+c+"\n"+h+" | "+"".padEnd(a.column-1," ")+"".padEnd(u,"^")}else i+="\n at "+o}return i}}],[{key:"buildMessage",value:function(e,t){function i(e){return e.codePointAt(0).toString(16).toUpperCase()}var n=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function r(e){return n?e.replace(n,function(e){return"\\u{"+i(e)+"}"}):e}function a(e){return r(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)}))}function s(e){return r(e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)}))}var o={literal:e=>'"'+a(e.text)+'"',class(e){var t=e.parts.map(function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)});return"["+(e.inverted?"^":"")+t.join("")+"]"+(e.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:e=>e.description};function l(e){return o[e.type](e)}function h(e){return e?'"'+a(e)+'"':"end of input"}return"Expected "+function(e){var t=e.map(l);if(t.sort(),t.length>0){for(var i=1,n=1;n<t.length;n++)t[n-1]!==t[n]&&(t[i]=t[n],i++);t.length=i}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+h(t)+" found."}}]),t}((0,parcelRequire("9DtGe")._)(SyntaxError));function o(e,t){var i,n={},r=(t=void 0!==t?t:{}).grammarSource,a={transformList:ev},o=ev,l="matrix",h="(",c=")",u="translate",d="scale",p="rotate",f="skewX",g="skewY",v=",",m=".",y=/^[eE]/,x=/^[+\-]/,b=/^[0-9]/,w=/^[ \t\r\n]/,k=el("matrix",!1),B=el("(",!1),S=el(")",!1),C=el("translate",!1),E=el("scale",!1),_=el("rotate",!1),I=el("skewX",!1),T=el("skewY",!1),M=el(",",!1),L=eu("fractionalConstant"),R=el(".",!1),P=eh(["e","E"],!1,!1,!1),A=eh(["+","-"],!1,!1,!1),D=eh([["0","9"]],!1,!1,!1),O=eh([" ","	","\r","\n"],!1,!1,!1);function z(e){return e}function H(e,t){return e.concat(t)}function j(e,t,i,n,r,a){return[{type:"matrix",a:e,b:t,c:i,d:n,e:r,f:a}]}function F(e,t){var i={type:"translate",tx:e};return t&&(i.ty=t),[i]}function X(e,t){var i={type:"scale",sx:e};return t&&(i.sy=t),[i]}function V(e,t){var i={type:"rotate",angle:e};return t&&(i.cx=t[0],i.cy=t[1]),[i]}function U(e){return[{type:"skewX",angle:e}]}function W(e){return[{type:"skewY",angle:e}]}function N(e){return parseFloat(e.join(""))}function Y(e){return parseInt(e.join(""))}function G(e){return e}function K(e,t){return[e,t]}function Z(e){return e.join("")}function q(e,t){return[e,t||null].join("")}function $(e,t){return[e,t].join("")}function J(e,t){return(e?e.join(""):null)+"."+t.join("")}function Q(e){return e.join("")}function ee(e,t){return"e"+e+t.join("")}var et=0|t.peg$currPos,ei=et,en=[{line:1,column:1}],er=et,ea=t.peg$maxFailExpected||[],es=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in a))throw Error("Can't start parsing from rule \""+t.startRule+'".');o=a[t.startRule]}function eo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,i=e.codePointAt(t);return void 0===i?"":String.fromCodePoint(i)}function el(e,t){return{type:"literal",text:e,ignoreCase:t}}function eh(e,t,i,n){return{type:"class",parts:e,inverted:t,ignoreCase:i,unicode:n}}function ec(){return{type:"end"}}function eu(e){return{type:"other",description:e}}function ed(t){var i,n=en[t];if(n)return n;if(t>=en.length)i=en.length-1;else for(i=t;!en[--i];);for(n={line:(n=en[i]).line,column:n.column};i<t;)10===e.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return en[t]=n,n}function ep(e,t,i){var n=ed(e),a=ed(t),s={source:r,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}};return i&&r&&"function"==typeof r.offset&&(s.start=r.offset(s.start),s.end=r.offset(s.end)),s}function ef(e){et<er||(et>er&&(er=et,ea=[]),ea.push(e))}function eg(e,t,i){return new s(s.buildMessage(e,t),e,t,i)}function ev(){var e,t,i,r,a;for(e=et,t=[],i=ez();i!==n;)t.push(i),i=ez();for((i=em())===n&&(i=null),r=[],a=ez();a!==n;)r.push(a),a=ez();return ei=e,e=z(i)}function em(){var e,t,i,r;if(e=et,(t=ey())!==n){if(i=[],(r=eI())!==n)for(;r!==n;)i.push(r),r=eI();else i=n;i!==n&&(r=em())!==n?(ei=e,e=H(t,r)):(et=e,e=n)}else et=e,e=n;return e===n&&(e=ey()),e}function ey(){var e;return(e=ex())===n&&(e=eb())===n&&(e=ew())===n&&(e=ek())===n&&(e=eB())===n&&(e=eS()),e}function ex(){var t,i,r,a,s,o,u,d,p,f,g,v,m;if(t=et,e.substr(et,6)===l?(i=l,et+=6):(i=n,0===es&&ef(k)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n)if(eI()!==n)if((u=eC())!==n)if(eI()!==n)if((d=eC())!==n)if(eI()!==n)if((p=eC())!==n)if(eI()!==n)if((f=eC())!==n)if(eI()!==n)if((g=eC())!==n){for(v=[],m=ez();m!==n;)v.push(m),m=ez();41===e.charCodeAt(et)?(m=c,et++):(m=n,0===es&&ef(S)),m!==n?(ei=t,t=j(o,u,d,p,f,g)):(et=t,t=n)}else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n;else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function eb(){var t,i,r,a,s,o,l,d,p;if(t=et,e.substr(et,9)===u?(i=u,et+=9):(i=n,0===es&&ef(C)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n){for((l=eE())===n&&(l=null),d=[],p=ez();p!==n;)d.push(p),p=ez();41===e.charCodeAt(et)?(p=c,et++):(p=n,0===es&&ef(S)),p!==n?(ei=t,t=F(o,l)):(et=t,t=n)}else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function ew(){var t,i,r,a,s,o,l,u,p;if(t=et,e.substr(et,5)===d?(i=d,et+=5):(i=n,0===es&&ef(E)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n){for((l=eE())===n&&(l=null),u=[],p=ez();p!==n;)u.push(p),p=ez();41===e.charCodeAt(et)?(p=c,et++):(p=n,0===es&&ef(S)),p!==n?(ei=t,t=X(o,l)):(et=t,t=n)}else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function ek(){var t,i,r,a,s,o,l,u,d;if(t=et,e.substr(et,6)===p?(i=p,et+=6):(i=n,0===es&&ef(_)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n){for((l=e_())===n&&(l=null),u=[],d=ez();d!==n;)u.push(d),d=ez();41===e.charCodeAt(et)?(d=c,et++):(d=n,0===es&&ef(S)),d!==n?(ei=t,t=V(o,l)):(et=t,t=n)}else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function eB(){var t,i,r,a,s,o,l,u;if(t=et,e.substr(et,5)===f?(i=f,et+=5):(i=n,0===es&&ef(I)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n){for(l=[],u=ez();u!==n;)l.push(u),u=ez();41===e.charCodeAt(et)?(u=c,et++):(u=n,0===es&&ef(S)),u!==n?(ei=t,t=U(o)):(et=t,t=n)}else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function eS(){var t,i,r,a,s,o,l,u;if(t=et,e.substr(et,5)===g?(i=g,et+=5):(i=n,0===es&&ef(T)),i!==n){for(r=[],a=ez();a!==n;)r.push(a),a=ez();if(40===e.charCodeAt(et)?(a=h,et++):(a=n,0===es&&ef(B)),a!==n){for(s=[],o=ez();o!==n;)s.push(o),o=ez();if((o=eC())!==n){for(l=[],u=ez();u!==n;)l.push(u),u=ez();41===e.charCodeAt(et)?(u=c,et++):(u=n,0===es&&ef(S)),u!==n?(ei=t,t=W(o)):(et=t,t=n)}else et=t,t=n}else et=t,t=n}else et=t,t=n;return t}function eC(){var e,t,i,r;return e=et,t=et,(i=eA())===n&&(i=null),(r=eL())!==n?t=i=[i,r]:(et=t,t=n),t!==n&&(ei=e,t=N(t)),(e=t)===n&&(e=et,t=et,(i=eA())===n&&(i=null),(r=eM())!==n?t=i=[i,r]:(et=t,t=n),t!==n&&(ei=e,t=Y(t)),e=t),e}function eE(){var e,t;return e=et,eI()!==n&&(t=eC())!==n?(ei=e,e=G(t)):(et=e,e=n),e}function e_(){var e,t,i;return e=et,eI()!==n&&(t=eC())!==n&&eI()!==n&&(i=eC())!==n?(ei=e,e=K(t,i)):(et=e,e=n),e}function eI(){var e,t,i,r,a;if(e=et,t=[],(i=ez())!==n)for(;i!==n;)t.push(i),i=ez();else t=n;if(t!==n){for((i=eT())===n&&(i=null),r=[],a=ez();a!==n;)r.push(a),a=ez();e=t=[t,i,r]}else et=e,e=n;if(e===n)if(e=et,(t=eT())!==n){for(i=[],r=ez();r!==n;)i.push(r),r=ez();e=t=[t,i]}else et=e,e=n;return e}function eT(){var t;return 44===e.charCodeAt(et)?(t=v,et++):(t=n,0===es&&ef(M)),t}function eM(){var e,t;return e=et,(t=eD())!==n&&(ei=e,t=Z(t)),e=t}function eL(){var e,t,i;return e=et,(t=eR())!==n?((i=eP())===n&&(i=null),ei=e,e=q(t,i)):(et=e,e=n),e===n&&(e=et,(t=eD())!==n&&(i=eP())!==n?(ei=e,e=$(t,i)):(et=e,e=n)),e}function eR(){var t,i,r,a;return es++,t=et,(i=eD())===n&&(i=null),46===e.charCodeAt(et)?(r=m,et++):(r=n,0===es&&ef(R)),r!==n&&(a=eD())!==n?(ei=t,t=J(i,a)):(et=t,t=n),t===n&&(t=et,(i=eD())!==n?(46===e.charCodeAt(et)?(r=m,et++):(r=n,0===es&&ef(R)),r!==n?(ei=t,t=Q(i)):(et=t,t=n)):(et=t,t=n)),es--,t===n&&(i=n,0===es&&ef(L)),t}function eP(){var t,i,r,a;return t=et,i=e.charAt(et),y.test(i)?et++:(i=n,0===es&&ef(P)),i!==n?((r=eA())===n&&(r=null),(a=eD())!==n?(ei=t,t=ee(r,a)):(et=t,t=n)):(et=t,t=n),t}function eA(){var t;return t=e.charAt(et),x.test(t)?et++:(t=n,0===es&&ef(A)),t}function eD(){var e,t;if(e=[],(t=eO())!==n)for(;t!==n;)e.push(t),t=eO();else e=n;return e}function eO(){var t;return t=e.charAt(et),b.test(t)?et++:(t=n,0===es&&ef(D)),t}function ez(){var t;return t=e.charAt(et),w.test(t)?et++:(t=n,0===es&&ef(O)),t}var eH=(i=o())!==n&&et===e.length;function ej(){throw i!==n&&et<e.length&&ef(ec()),eg(ea,er<e.length?eo(er):null,er<e.length?ep(er,er+1):ep(er,er))}return t.peg$library?{peg$result:i,peg$currPos:et,peg$FAILED:n,peg$maxFailExpected:ea,peg$maxFailPos:er,peg$success:eH,peg$throw:eH?void 0:ej}:eH?i:void ej()}}),parcelRegister("9DtGe",function(e,t){$parcel$export(e.exports,"_",function(){return s});var i=parcelRequire("6J7qs"),n=parcelRequire("2JCCy"),r=parcelRequire("idL7u"),a=parcelRequire("5oklS");function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||!(0,r._)(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return(0,i._)(e,arguments,(0,n._)(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),(0,a._)(s,e)})(e)}}),parcelRegister("6J7qs",function(e,t){$parcel$export(e.exports,"_",function(){return r});var i=parcelRequire("ff8rK"),n=parcelRequire("5oklS");function r(e,t,a){return(r=(0,i._)()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return i&&(0,n._)(a,i.prototype),a}).apply(null,arguments)}}),parcelRegister("idL7u",function(e,t){$parcel$export(e.exports,"_",function(){return i});function i(e){return -1!==Function.toString.call(e).indexOf("[native code]")}}),parcelRegister("gvDD3",function(e,t){parcelRequire("kFecW"),parcelRequire("dZ59l")}),parcelRegister("4JElo",function(e,t){}),parcelRegister("90Qul",function(e,t){var i=parcelRequire("kr2fR");parcelRequire("cdZRx"),parcelRequire("1RMPr"),parcelRequire("kFecW"),parcelRequire("dZ59l")}),parcelRegister("gWfkn",function(e,t){$parcel$export(e.exports,"HISTORY_TILE_SIZE",function(){return l}),$parcel$export(e.exports,"KlHistory",function(){return c});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("bX4ja"),a=parcelRequire("e9flx"),s=parcelRequire("c3MH7"),o=parcelRequire("c0vOZ"),l=256,h=!1,c=function(){"use strict";function e(t){var n=this;(0,i._)(this,e),this.maxUndoSteps=20,this.totalThresholdBytes=1e9,this.isFreeThresholdBytes=2048,this.index=0,this.indexOffset=0,this.changeCount=0,this.pauseStack=0,this.listeners=[],this.entries=[{timestamp:new Date().getTime(),memoryEstimateBytes:(0,s.estimateBytes)(t.oldest),data:t.oldest}],this.composed=t.oldest,h&&(window.getHistoryEntries=function(){return n.entries})}return(0,n._)(e,[{key:"broadcast",value:function(){var e=this;this.changeCount++,setTimeout(function(){for(var t=0;t<e.listeners.length;t++)e.listeners[t]()},1)}},{key:"updateComposed",value:function(){this.composed=(0,a.composeHistoryStateData)(this.entries.slice(0,this.index+1).map(function(e){return e.data}))}},{key:"pause",value:function(e){e?this.pauseStack++:this.pauseStack=Math.max(0,this.pauseStack-1)}},{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"push",value:function(e,t){if(!(this.pauseStack>0)){var i={timestamp:new Date().getTime(),memoryEstimateBytes:(0,s.estimateBytes)(e),data:e};if(t&&this.index>0){for(this.index--;this.index<this.entries.length-1;)this.entries.pop();(0,o.entryCausesChange)(e,(0,a.composeHistoryStateData)(this.entries.slice(0,this.index+1).map(function(e){return e.data})))&&this.entries.push(i)}else{for(;this.index<this.entries.length-1;)this.entries.pop();this.entries.push(i)}for(var n=this.maxUndoSteps,l=this.entries.length-1,h=this.totalThresholdBytes-i.memoryEstimateBytes;l>0&&n>=0;){l--;var c=this.entries[l].memoryEstimateBytes;if(c<this.isFreeThresholdBytes){h-=c;continue}if(0===n||h-c<0){l++;break}h-=c,n--}for(;l>0;){var u=(0,a.composeHistoryStateData)(this.entries.slice(0,l+1).map(function(e){return e.data}),l),d=(0,s.estimateBytes)(u);this.entries=[{timestamp:this.entries[l].timestamp,memoryEstimateBytes:d,description:"oldest",data:u}].concat((0,r._)(this.entries.slice(l+1))),this.indexOffset+=l,l=0,this.entries.reduce(function(e,t){return e+t.memoryEstimateBytes},0)>this.totalThresholdBytes&&(l=1)}this.index=this.entries.length-1,this.updateComposed(),this.broadcast()}}},{key:"increaseIndex",value:function(){return this.canRedo()&&this.index++,this.updateComposed(),this.broadcast(),this.entries[this.index]}},{key:"decreaseIndex",value:function(){return this.canUndo()&&this.index--,this.updateComposed(),this.broadcast(),this.entries[this.index]}},{key:"canUndo",value:function(){return this.index>0}},{key:"canRedo",value:function(){return this.index<this.entries.length-1}},{key:"getEntries",value:function(){return this.entries.slice(0,this.index+1)}},{key:"getComposed",value:function(){return this.composed}},{key:"getChangeCount",value:function(){return this.changeCount}},{key:"getTotalIndex",value:function(){return this.indexOffset+this.index}},{key:"isPaused",value:function(){return this.pauseStack>0}}]),e}()}),parcelRegister("e9flx",function(e,t){$parcel$export(e.exports,"composeHistoryStateData",function(){return c});var i=parcelRequire("cL71g"),n=parcelRequire("8N5YG"),r=parcelRequire("bX4ja");function a(e){for(var t=e.length-1;t>=0;t--){var i=e[t];if(void 0!==i)return i}throw Error("no defined entry found")}function s(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]){var n=e[i][t];if(void 0!==n)return n}throw Error("no defined entry found")}function o(e){var t=(0,r._)(a(e));return Object.entries(t).forEach(function(i){var r=(0,n._)(i,1)[0];t[+r]=s(e,r)}),t}function l(e){return{name:s(e,"name"),opacity:s(e,"opacity"),isVisible:s(e,"isVisible"),mixModeStr:s(e,"mixModeStr"),index:s(e,"index"),tiles:o(e.map(function(e){return e?e.tiles:void 0}))}}function h(e){var t=(0,i._)({},a(e));return Object.entries(t).forEach(function(i){var r=(0,n._)(i,1)[0];t[r]=l(e.map(function(e){return e?e[r]:void 0}))}),t}function c(e,t){return void 0===t&&(t=e.length-1),{projectId:s(e=e.slice(0,t+1),"projectId"),size:s(e,"size"),activeLayerId:s(e,"activeLayerId"),selection:s(e,"selection"),layerMap:h(e.map(function(e){return e.layerMap}))}}}),parcelRegister("c3MH7",function(e,t){$parcel$export(e.exports,"estimateBytes",function(){return r});var i=parcelRequire("8N5YG"),n=parcelRequire("esGm2");function r(e){var t,r,a=0;return null==(r=e.selection)||null==(t=r.value)||t.forEach(function(e){e.forEach(function(e){a+=2*e.length*8})}),e.layerMap&&Object.entries(e.layerMap).forEach(function(e){var t;null==(t=(0,i._)(e,2)[1].tiles)||t.forEach(function(e){void 0!==e&&((0,n.isLayerFill)(e)?a+=2*e.fill.length:a+=e.data.width*e.data.height*4)})}),a}}),parcelRegister("c0vOZ",function(e,t){$parcel$export(e.exports,"entryCausesChange",function(){return i});function i(e,t){if(void 0!==e.size&&(e.size.width!==t.size.width||e.size.height!==t.size.height)||void 0!==e.selection&&e.selection.value!==t.selection.value||void 0!==e.activeLayerId&&e.activeLayerId!==t.activeLayerId)return!0;if(void 0!==e.layerMap){var i=Object.keys(e.layerMap),n=!0,r=!1,a=void 0;try{for(var s,o=Object.keys(t.layerMap)[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;if(!i.includes(l))return!0}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}var h=!0,c=!1,u=void 0;try{for(var d,p=i[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var f=d.value,g=t.layerMap[f];if(!g)return!0;var v=e.layerMap[f];if(void 0!==v.name&&v.name!==g.name||void 0!==v.opacity&&v.opacity!==g.opacity||void 0!==v.isVisible&&v.isVisible!==g.isVisible||void 0!==v.mixModeStr&&v.mixModeStr!==g.mixModeStr||void 0!==v.index&&v.index!==g.index||void 0!==v.tiles)return!0}}catch(e){c=!0,u=e}finally{try{h||null==p.return||p.return()}finally{if(c)throw u}}}return!1}}),parcelRegister("7nLJW",function(e,t){$parcel$export(e.exports,"sortLayerMap",function(){return i});function i(e,t){return e.index>t.index?1:e.index<t.index?-1:0}}),parcelRegister("6mTnI",function(e,t){$parcel$export(e.exports,"isTImageDataReference",function(){return f}),$parcel$export(e.exports,"ProjectStore",function(){return v});var i=parcelRequire("1LaJZ"),n=parcelRequire("cx0mh"),r=parcelRequire("7h4XF"),a=parcelRequire("cL71g"),s=parcelRequire("4EWN2"),o=parcelRequire("2gUX3"),l=parcelRequire("3hwQ7"),h=parcelRequire("6l0gQ"),c=parcelRequire("jTg9g"),u=parcelRequire("7jh4K"),d=parcelRequire("eWjiX"),p=parcelRequire("eIcQa");function f(e){return"object"==typeof e&&null!==e&&"id"in e&&"string"==typeof e.id}function g(){return(0,i._)(function(){return(0,o.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,p.canvasToBlob)(d.BB.canvas(l.PROJECT_STORE_THUMBNAIL_SIZE_PX,l.PROJECT_STORE_THUMBNAIL_SIZE_PX),"image/png")];case 1:return[2,e.sent()]}})})()}var v=function(){"use strict";function e(){var t=this;if((0,n._)(this,e),this.listeners=[],this.isAvailable=!0,!c.KL_INDEXED_DB.getIsAvailable()){this.isAvailable=!1;return}window.addEventListener("storage",function(e){return(0,i._)(function(){return(0,o.__generator)(this,function(t){switch(t.label){case 0:if("indexedDbUpdatedAt"!==e.key||0===this.listeners.length)return[2];return[4,this.update()];case 1:return t.sent(),[2]}})}).call(t)})}return(0,r._)(e,[{key:"lowLevelStore",value:function(e){return(0,i._)(function(){var t,i,n,r,l,h,d,p,g,v,m,y,x,b,w,k,B,S,C,E,_,I,T,M,L,R,P,A,D,O,z,H;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,c.KL_INDEXED_DB.get(c.BROWSER_STORAGE_STORE,1)];case 1:if(t=o.sent(),i=[],t){f(t.thumbnail)&&i.push(t.thumbnail.id),n=!0,r=!1,l=void 0;try{for(h=t.layers[Symbol.iterator]();!(n=(d=h.next()).done);n=!0)p=d.value,f(p.blob)&&i.push(p.blob.id)}catch(e){r=!0,l=e}finally{try{n||null==h.return||h.return()}finally{if(r)throw l}}}g=[],v={id:(0,u.randomUuid)()},g.push({id:v.id,data:e.thumbnail}),m=[],y=!0,x=!1,b=void 0;try{for(w=e.layers[Symbol.iterator]();!(y=(k=w.next()).done);y=!0)B=k.value,S={id:(0,u.randomUuid)()},g.push({id:S.id,data:B.blob}),m.push((0,s._)((0,a._)({},B),{blob:S}))}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}C=(0,s._)((0,a._)({},e),{thumbnail:v,layers:m}),E=!0,_=!1,I=void 0,o.label=2;case 2:o.trys.push([2,7,8,9]),T=g[Symbol.iterator](),o.label=3;case 3:if(E=(M=T.next()).done)return[3,6];return L=M.value,[4,c.KL_INDEXED_DB.set(c.IMAGE_DATA_STORE,L.id,L.data)];case 4:o.sent(),o.label=5;case 5:return E=!0,[3,3];case 6:return[3,9];case 7:return R=o.sent(),_=!0,I=R,[3,9];case 8:try{E||null==T.return||T.return()}finally{if(_)throw I}return[7];case 9:return[4,c.KL_INDEXED_DB.set(c.BROWSER_STORAGE_STORE,void 0,C)];case 10:o.sent(),P=!0,A=!1,D=void 0,o.label=11;case 11:o.trys.push([11,16,17,18]),O=i[Symbol.iterator](),o.label=12;case 12:if(P=(z=O.next()).done)return[3,15];return H=z.value,[4,c.KL_INDEXED_DB.remove(c.IMAGE_DATA_STORE,H)];case 13:o.sent(),o.label=14;case 14:return P=!0,[3,12];case 15:return[3,18];case 16:return R=o.sent(),A=!0,D=R,[3,18];case 17:try{P||null==O.return||O.return()}finally{if(A)throw D}return[7];case 18:return[2]}})})()}},{key:"lowLevelReadMeta",value:function(){return(0,i._)(function(){var e,t,i,n,r;return(0,o.__generator)(this,function(a){switch(a.label){case 0:return[4,c.KL_INDEXED_DB.get(c.BROWSER_STORAGE_STORE,1)];case 1:if(!(e=a.sent()))return[2,void 0];if(!f(e.thumbnail))return[3,3];return[4,c.KL_INDEXED_DB.get(c.IMAGE_DATA_STORE,e.thumbnail.id)];case 2:return i=a.sent(),(0,u.isBlob)(i)&&(t=i),[3,4];case 3:t=e.thumbnail,a.label=4;case 4:if(null==t)return[3,5];return n=t,[3,7];case 5:return[4,g()];case 6:n=a.sent(),a.label=7;case 7:return t=n,[2,{projectId:null!=(r=e.projectId)?r:(0,u.randomUuid)(),timestamp:e.timestamp,thumbnail:t}]}})})()}},{key:"lowLevelRead",value:function(){return(0,i._)(function(){var e,t,i,n,r,l,h,d,p,v,m,y,x,b,w,k,B;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,c.KL_INDEXED_DB.get(c.BROWSER_STORAGE_STORE,1)];case 1:if(!(e=o.sent()))return[2,void 0];if(!f(e.thumbnail))return[3,3];return[4,c.KL_INDEXED_DB.get(c.IMAGE_DATA_STORE,e.thumbnail.id)];case 2:return i=o.sent(),(0,u.isBlob)(i)&&(t=i),[3,4];case 3:t=e.thumbnail,o.label=4;case 4:if(null==t)return[3,5];return n=t,[3,7];case 5:return[4,g()];case 6:n=o.sent(),o.label=7;case 7:t=n,r=[],l=!0,h=!1,d=void 0,o.label=8;case 8:o.trys.push([8,15,16,17]),p=e.layers[Symbol.iterator](),o.label=9;case 9:if(l=(v=p.next()).done)return[3,14];if(m=v.value,y=void 0,!f(m.blob))return[3,11];return[4,c.KL_INDEXED_DB.get(c.IMAGE_DATA_STORE,m.blob.id)];case 10:return x=o.sent(),(0,u.isBlob)(x)&&(y=x),[3,12];case 11:y=m.blob,o.label=12;case 12:r.push((0,s._)((0,a._)({},m),{isVisible:null==(b=m.isVisible)||b,mixModeStr:null!=(w=m.mixModeStr)?w:"source-over",blob:y})),o.label=13;case 13:return l=!0,[3,9];case 14:return[3,17];case 15:return k=o.sent(),h=!0,d=k,[3,17];case 16:try{l||null==p.return||p.return()}finally{if(h)throw d}return[7];case 17:return[2,(0,s._)((0,a._)({},e),{projectId:null!=(B=e.projectId)?B:(0,u.randomUuid)(),thumbnail:t,layers:r})]}})})()}},{key:"lowLevelClear",value:function(){return(0,i._)(function(){var e,t,i,n,r,a,s,l,h,u,d,p,g,v,m;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,c.KL_INDEXED_DB.get(c.BROWSER_STORAGE_STORE,1)];case 1:if(e=o.sent(),t=[],e){f(e.thumbnail)&&t.push(e.thumbnail.id),i=!0,n=!1,r=void 0;try{for(a=e.layers[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)l=s.value,f(l.blob)&&t.push(l.blob.id)}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}}return[4,c.KL_INDEXED_DB.remove(c.BROWSER_STORAGE_STORE,1)];case 2:o.sent(),h=!0,u=!1,d=void 0,o.label=3;case 3:o.trys.push([3,8,9,10]),p=t[Symbol.iterator](),o.label=4;case 4:if(h=(g=p.next()).done)return[3,7];return v=g.value,[4,c.KL_INDEXED_DB.remove(c.IMAGE_DATA_STORE,v)];case 5:o.sent(),o.label=6;case 6:return h=!0,[3,4];case 7:return[3,10];case 8:return m=o.sent(),u=!0,d=m,[3,10];case 9:try{h||null==p.return||p.return()}finally{if(u)throw d}return[7];case 10:return[2]}})})()}},{key:"emit",value:function(e){this.currentMeta=e?(0,a._)({},e):void 0,this.listeners.forEach(function(t){t.onUpdate(e)})}},{key:"updateTimestamp",value:function(){h.LocalStorage.setItem("indexedDbUpdatedAt",""+new Date().getTime())}},{key:"update",value:function(){return(0,i._)(function(){var e,t,i;return(0,o.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=(e=this).emit,[4,this.readMeta()];case 1:return t.apply(e,[n.sent()]),[3,3];case 2:return(i=n.sent())instanceof Error&&0===i.message.indexOf("db-error")&&(this.isAvailable=!1),[3,3];case 3:return[2]}})}).call(this)}},{key:"read",value:function(){return(0,i._)(function(){var e,t,i;return(0,o.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.lowLevelRead()];case 1:return e=n.sent(),[3,3];case 2:throw t=n.sent(),this.isAvailable=!1,Error("db-error: "+t);case 3:if(!e)return[2,void 0];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,l.ProjectConverter.readStorageProject(e)];case 5:return i=n.sent(),[3,7];case 6:throw Error("format-error: "+n.sent());case 7:return[2,i]}})}).call(this)}},{key:"readMeta",value:function(){return(0,i._)(function(){var e,t,i;return(0,o.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.lowLevelReadMeta()];case 1:return e=n.sent(),[3,3];case 2:throw t=n.sent(),this.isAvailable=!1,Error("db-error: "+t);case 3:if(!e)return[2,void 0];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,l.ProjectConverter.readStorageMeta(e)];case 5:return i=n.sent(),[3,7];case 6:throw Error("format-error: "+n.sent());case 7:return[2,i]}})}).call(this)}},{key:"store",value:function(e){return(0,i._)(function(){var t,n,r;return(0,o.__generator)(this,function(a){switch(a.label){case 0:t=this,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,l.ProjectConverter.createStorageProject(e)];case 2:return n=a.sent(),[4,this.lowLevelStore(n)];case 3:return a.sent(),[3,5];case 4:throw r=a.sent(),this.isAvailable=!1,Error("db-error: "+r);case 5:return this.updateTimestamp(),setTimeout(function(){return(0,i._)(function(){var e;return(0,o.__generator)(this,function(t){switch(t.label){case 0:return[4,this.readMeta()];case 1:return e=t.sent(),this.emit(e),[2]}})}).call(t)}),[2]}})}).call(this)}},{key:"clear",value:function(){return(0,i._)(function(){var e;return(0,o.__generator)(this,function(t){switch(t.label){case 0:return e=this,[4,this.lowLevelClear()];case 1:return t.sent(),this.updateTimestamp(),setTimeout(function(){return e.emit()},0),[2]}})}).call(this)}},{key:"subscribe",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"unsubscribe",value:function(e){for(var t=0;t<this.listeners.length;t++)if(e===this.listeners[t])return void this.listeners.splice(t,1)}},{key:"getIsAvailable",value:function(){return this.isAvailable=this.isAvailable&&c.KL_INDEXED_DB.getIsAvailable(),this.isAvailable}},{key:"getCurrentMeta",value:function(){return this.currentMeta}}]),e}()}),parcelRegister("3uJxV",function(e,t){$parcel$export(e.exports,"CrossTabChannel",function(){return s});var i=parcelRequire("cx0mh"),n=parcelRequire("7h4XF"),r=parcelRequire("6l0gQ"),a=(0,parcelRequire("7jh4K").randomUuid)(),s=function(){"use strict";function e(t){var n=this;(0,i._)(this,e),this.name=t,this.broadcastChannelListeners=[],this.lastReadTimestamp=new Date().getTime(),this.maxAgeMs=1e4,this.localStoragePrefix="cross-tab-channel--",this.localStorageListeners=new Set,this.onLocalStorageChange=function(e){if(e.key===n.getLsKey()&&null!==e.newValue)try{JSON.parse(e.newValue).forEach(function(e){e.originId===a||e.timestamp<=n.lastReadTimestamp||(n.lastReadTimestamp=e.timestamp,n.localStorageListeners.forEach(function(t){return t(e.message)}))})}catch(e){r.LocalStorage.removeItem(n.getLsKey())}},"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel(t))}return(0,n._)(e,[{key:"getLsKey",value:function(){return this.localStoragePrefix+this.name}},{key:"postMessage",value:function(e){var t=this;if(this.broadcastChannel)this.broadcastChannel.postMessage(e);else{var i=new Date().getTime(),n=null;try{n=r.LocalStorage.getItem(this.getLsKey())}catch(e){}var s=null===n?[]:JSON.parse(n);(s=s.filter(function(e){return e.timestamp>i-t.maxAgeMs})).push({timestamp:i,originId:a,message:e}),r.LocalStorage.setItem(this.getLsKey(),JSON.stringify(s))}}},{key:"subscribe",value:function(e){if(this.broadcastChannel){var t=function(t){return e(t.data)};this.broadcastChannelListeners.push({preListener:t,listener:e}),this.broadcastChannel.addEventListener("message",t)}else 0===this.localStorageListeners.size&&window.addEventListener("storage",this.onLocalStorageChange),this.localStorageListeners.add(e)}},{key:"unsubscribe",value:function(e){if(this.broadcastChannel){var t=this.broadcastChannelListeners.find(function(t){return t.listener===e});t&&this.broadcastChannel.removeEventListener("message",t.preListener)}else this.localStorageListeners.delete(e),0===this.localStorageListeners.size&&window.removeEventListener("storage",this.onLocalStorageChange)}},{key:"close",value:function(){this.broadcastChannel&&this.broadcastChannel.close()}}]),e}()}),parcelRegister("6caCk",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("kNYzr")).then(function(){return parcelRequire("2m2jt")})}),parcelRegister("kUTcy",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("62mlz")).then(function(){return parcelRequire("17YSH")})}),parcelRegister("6rG3P",function(e,t){e.exports=parcelRequire("ih7W4")($parcel$resolve("76QQo")).then(function(){return parcelRequire("evhrb")})}),parcelRegister("3jT0U",function(module,exports){$parcel$export(module.exports,"ShapeRecognition",function(){return ShapeRecognition});var $1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$bX4ja=parcelRequire("bX4ja"),$8KHnw=parcelRequire("8KHnw"),$2gUX3=parcelRequire("2gUX3"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),ShapeRecognition=function(){"use strict";function ShapeRecognition(e){(0,$cx0mh._)(this,ShapeRecognition),this.points=[],this.isHolding=!1,this.holdThreshold=500,this.recognizedShape=null,this.externalRecognizer=null,this.onShapeRecognized=e.onShapeRecognized,this.loadExternalRecognizer()}return(0,$7h4XF._)(ShapeRecognition,[{key:"chainIn",value:function(e){var t=this;e=$eWjiX.BB.copyObj(e);var i=Date.now();return"down"===e.type?(this.points=[{x:e.x,y:e.y,time:i}],this.isHolding=!1,clearTimeout(this.holdTimeout),this.holdTimeout=setTimeout(function(){t.isHolding=!0,t.recognizeShape()},this.holdThreshold)):"move"===e.type?(this.points.push({x:e.x,y:e.y,time:i}),this.points.length>200&&this.points.shift(),this.isHolding||(clearTimeout(this.holdTimeout),this.holdTimeout=setTimeout(function(){t.isHolding=!0,t.recognizeShape()},this.holdThreshold))):"up"===e.type&&(clearTimeout(this.holdTimeout),this.isHolding=!1,this.points=[]),e}},{key:"recognizeShape",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(this.points.length<10)return[2];if(!(this.externalRecognizer&&"function"==typeof this.externalRecognizer.recognize))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.externalRecognizer.recognize(this.points)];case 2:if(e=a.sent())return t=this.externalRecognizer.getParams?this.externalRecognizer.getParams(e,this.points):this.getShapeParams(e,this.points),this.recognizedShape=(0,$cL71g._)({type:e},t),this.onShapeRecognized&&this.onShapeRecognized(e),[2];return[3,4];case 3:return i=a.sent(),[3,4];case 4:return(n=this.detectShape(this.points))?(r=this.getShapeParams(n,this.points),this.recognizedShape=(0,$cL71g._)({type:n},r),this.onShapeRecognized&&this.onShapeRecognized(n)):this.recognizedShape=null,[2]}})}).call(this)}},{key:"loadExternalRecognizer",value:function loadExternalRecognizer(){return(0,$1LaJZ._)(function(){var _this,candidates,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_this1,_loop,_iterator,_step,_ret,err;return(0,$2gUX3.__generator)(this,function(_state){switch(_state.label){case 0:_this=this,candidates=["@tldraw/tldraw","@tldraw/core","shape-recognition","shape-recognizer"],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_state.label=1;case 1:_state.trys.push([1,6,7,8]),_loop=function(){var pkg,mod,_mod_default,candidate,normalizePoints,_candidate_getEllipseFromPoints,_ref,getEllipse,_candidate_getRectangleFromPoints,_ref1,getRect,_candidate_getLineFromPoints,_ref2,getLine,names,lowerNames,hasEllipse,hasRect,hasLine,fnEllipse,fnRect,fnLine,err;return(0,$2gUX3.__generator)(this,function(_state){switch(_state.label){case 0:pkg=_step.value,_state.label=1;case 1:return _state.trys.push([1,3,,4]),[4,eval('import("'+pkg+'")').catch(function(){return null})];case 2:if(mod=_state.sent(),!mod)return[2,"continue"];if(candidate=null!=(_mod_default=mod.default)?_mod_default:mod,normalizePoints=function(e){return e.map(function(e){return{x:e.x,y:e.y}})},"function"==typeof(null==candidate?void 0:candidate.detectShape))return _this1.externalRecognizer={recognize:function(e){return candidate.detectShape(e)},getParams:function(e,t){return"function"==typeof candidate.getShapeParams?candidate.getShapeParams(e,t):_this.getShapeParams(e,t)}},console.log("ShapeRecognition: using",pkg,"detectShape"),[2,{v:void 0}];if(getEllipse=null!=(_ref=null!=(_candidate_getEllipseFromPoints=null==candidate?void 0:candidate.getEllipseFromPoints)?_candidate_getEllipseFromPoints:null==candidate?void 0:candidate.getEllipse)?_ref:null==candidate?void 0:candidate.ellipseFromPoints,getRect=null!=(_ref1=null!=(_candidate_getRectangleFromPoints=null==candidate?void 0:candidate.getRectangleFromPoints)?_candidate_getRectangleFromPoints:null==candidate?void 0:candidate.getRectangle)?_ref1:null==candidate?void 0:candidate.rectFromPoints,getLine=null!=(_ref2=null!=(_candidate_getLineFromPoints=null==candidate?void 0:candidate.getLineFromPoints)?_candidate_getLineFromPoints:null==candidate?void 0:candidate.getLine)?_ref2:null==candidate?void 0:candidate.lineFromPoints,getEllipse||getRect||getLine)return _this1.externalRecognizer={recognize:function(e){var t=normalizePoints(e);if(getEllipse)try{if(getEllipse(t))return"circle"}catch(e){}if(getRect)try{if(getRect(t))return"rectangle"}catch(e){}if(getLine)try{if(getLine(t))return"line"}catch(e){}return null},getParams:function(e,t){var i=normalizePoints(t);if("circle"===e&&getEllipse){var n=getEllipse(i);if(n&&void 0!==n.cx&&void 0!==n.cy&&void 0!==n.rx&&void 0!==n.ry){var r=n.cx,a=n.cy,s=Math.max(n.rx,n.ry);return{x1:r-s,y1:a-s,x2:r+s,y2:a+s}}}if("rectangle"===e&&getRect){var o=getRect(i);if(o&&void 0!==o.x&&void 0!==o.y&&void 0!==o.width&&void 0!==o.height)return{x1:o.x,y1:o.y,x2:o.x+o.width,y2:o.y+o.height}}if("line"===e&&getLine){var l=getLine(i);if(l&&void 0!==l.x1)return{x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2}}return _this.getShapeParams(e,t)}},console.log("ShapeRecognition: using",pkg,"ellipse/rect/line helpers"),[2,{v:void 0}];if(candidate&&(hasEllipse=(lowerNames=(names=Object.keys(candidate)).map(function(e){return e.toLowerCase()})).find(function(e){return e.includes("ellipse")||e.includes("ellipsefrom")}),hasRect=lowerNames.find(function(e){return e.includes("rectangle")||e.includes("rectfrom")||e.includes("rect")}),hasLine=lowerNames.find(function(e){return e.includes("line")||e.includes("linestart")||e.includes("segment")}),fnEllipse=hasEllipse?candidate[names[lowerNames.indexOf(hasEllipse)]]:null,fnRect=hasRect?candidate[names[lowerNames.indexOf(hasRect)]]:null,fnLine=hasLine?candidate[names[lowerNames.indexOf(hasLine)]]:null,fnEllipse||fnRect||fnLine))return _this1.externalRecognizer={recognize:function(e){var t=normalizePoints(e);if(fnEllipse)try{if(fnEllipse(t))return"circle"}catch(e){}if(fnRect)try{if(fnRect(t))return"rectangle"}catch(e){}if(fnLine)try{if(fnLine(t))return"line"}catch(e){}return null},getParams:function(e,t){var i=normalizePoints(t);try{if("circle"===e&&fnEllipse){var n=fnEllipse(i);if(n&&void 0!==n.cx){var r,a,s,o=n.cx,l=n.cy,h=null!=(s=n.r)?s:Math.max(null!=(r=n.rx)?r:0,null!=(a=n.ry)?a:0);return{x1:o-h,y1:l-h,x2:o+h,y2:l+h}}}if("rectangle"===e&&fnRect){var c=fnRect(i);if(c&&void 0!==c.x&&void 0!==c.y&&void 0!==c.width&&void 0!==c.height)return{x1:c.x,y1:c.y,x2:c.x+c.width,y2:c.y+c.height}}if("line"===e&&fnLine){var u=fnLine(i);if(u&&void 0!==u.x1)return{x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2}}}catch(e){}return _this.getShapeParams(e,t)}},console.log("ShapeRecognition: using heuristics from",pkg),[2,{v:void 0}];return[3,4];case 3:return err=_state.sent(),[3,4];case 4:return[2]}})},_iterator=candidates[Symbol.iterator](),_state.label=2;case 2:if(_iteratorNormalCompletion=(_step=_iterator.next()).done)return[3,5];return _this1=this,[5,(0,$2gUX3.__values)(_loop())];case 3:if(_ret=_state.sent(),"object"===(0,$8KHnw._)(_ret))return[2,_ret.v];_state.label=4;case 4:return _iteratorNormalCompletion=!0,[3,2];case 5:return[3,8];case 6:return err=_state.sent(),_didIteratorError=!0,_iteratorError=err,[3,8];case 7:try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}return[7];case 8:return this.externalRecognizer=null,[2]}})}).call(this)}},{key:"detectShape",value:function(e){if(e.length<10)return null;var t,i,n,r,a=e.map(function(e){return e.x}),s=e.map(function(e){return e.y}),o=(t=Math).min.apply(t,(0,$bX4ja._)(a)),l=(i=Math).max.apply(i,(0,$bX4ja._)(a)),h=(n=Math).min.apply(n,(0,$bX4ja._)(s)),c=(r=Math).max.apply(r,(0,$bX4ja._)(s)),u=l-o,d=c-h,p=0===d?1/0:u/d;return p>5||p<.2?this.isLine(e)?"line":null:p>.7&&p<1.3&&this.isCircle(e)?"circle":this.isRectangle(e)?"rectangle":this.isLine(e)?"line":null}},{key:"isCircle",value:function(e){if(e.length<20)return!1;var t=e.map(function(e){return e.x}),i=e.map(function(e){return e.y}),n=(g=Math).min.apply(g,(0,$bX4ja._)(t)),r=(v=Math).max.apply(v,(0,$bX4ja._)(t)),a=(m=Math).min.apply(m,(0,$bX4ja._)(i)),s=(y=Math).max.apply(y,(0,$bX4ja._)(i)),o=r-n,l=s-a;if(o<10||l<10)return!1;var h=o/l;if(h<.7||h>1.3)return!1;var c=0,u=0,d=!0,p=!1,f=void 0;try{for(var g,v,m,y,x,b=e[Symbol.iterator]();!(d=(x=b.next()).done);d=!0){var w=x.value;c+=w.x,u+=w.y}}catch(e){p=!0,f=e}finally{try{d||null==b.return||b.return()}finally{if(p)throw f}}var k=c/e.length,B=u/e.length,S=0,C=!0,E=!1,_=void 0;try{for(var I,T=e[Symbol.iterator]();!(C=(I=T.next()).done);C=!0){var M=I.value,L=Math.sqrt(Math.pow(M.x-k,2)+Math.pow(M.y-B,2));S+=L}}catch(e){E=!0,_=e}finally{try{C||null==T.return||T.return()}finally{if(E)throw _}}var R=S/e.length,P=0,A=!0,D=!1,O=void 0;try{for(var z,H=e[Symbol.iterator]();!(A=(z=H.next()).done);A=!0){var j=z.value,F=Math.sqrt(Math.pow(j.x-k,2)+Math.pow(j.y-B,2));P+=Math.abs(F-R)}}catch(e){D=!0,O=e}finally{try{A||null==H.return||H.return()}finally{if(D)throw O}}return(P/=e.length)<.5*R}},{key:"isRectangle",value:function(e){if(e.length<12)return!1;var t=e.map(function(e){return e.x}),i=e.map(function(e){return e.y}),n=(y=Math).min.apply(y,(0,$bX4ja._)(t)),r=(x=Math).max.apply(x,(0,$bX4ja._)(t)),a=(b=Math).min.apply(b,(0,$bX4ja._)(i)),s=(w=Math).max.apply(w,(0,$bX4ja._)(i)),o=r-n,l=s-a;if(o<15||l<15)return!1;var h=o/l;if(h>5||h<.2)return!1;var c=Math.max(8,.25*Math.min(o,l)),u=!1,d=!1,p=!1,f=!1,g=!0,v=!1,m=void 0;try{for(var y,x,b,w,k,B=e[Symbol.iterator]();!(g=(k=B.next()).done);g=!0){var S=k.value,C=Math.abs(S.x-n),E=Math.abs(S.x-r),_=Math.abs(S.y-a),I=Math.abs(S.y-s);C<c&&_<c&&(u=!0),E<c&&_<c&&(d=!0),C<c&&I<c&&(p=!0),E<c&&I<c&&(f=!0)}}catch(e){v=!0,m=e}finally{try{g||null==B.return||B.return()}finally{if(v)throw m}}return[u,d,p,f].filter(function(e){return e}).length>=3}},{key:"isLine",value:function(e){for(var t=e[0],i=e[e.length-1],n=i.x-t.x,r=i.y-t.y,a=Math.sqrt(n*n+r*r),s=0,o=1;o<e.length-1;o++){var l=e[o];s+=Math.abs(r*(l.x-t.x)-n*(l.y-t.y))/(a||1)}return s/Math.max(1,e.length-2)<7}},{key:"getShapeParams",value:function(e,t){if("line"===e)return{x1:t[0].x,y1:t[0].y,x2:t[t.length-1].x,y2:t[t.length-1].y};if("rectangle"===e){var i=t.map(function(e){return e.x}).sort(function(e,t){return e-t}),n=t.map(function(e){return e.y}).sort(function(e,t){return e-t});return{x1:i[0],y1:n[0],x2:i[i.length-1],y2:n[n.length-1]}}if("circle"===e){var r=0,a=0,s=!0,o=!1,l=void 0;try{for(var h,c=t[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){var u=h.value;r+=u.x,a+=u.y}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}var d=r/t.length,p=a/t.length,f=0,g=!0,v=!1,m=void 0;try{for(var y,x=t[Symbol.iterator]();!(g=(y=x.next()).done);g=!0){var b=y.value,w=Math.sqrt(Math.pow(b.x-d,2)+Math.pow(b.y-p,2));f+=w}}catch(e){v=!0,m=e}finally{try{g||null==x.return||x.return()}finally{if(v)throw m}}var k=f/t.length;return{x1:d-k,y1:p-k,x2:d+k,y2:p+k}}throw Error("Unknown shape type")}},{key:"getRecognizedShape",value:function(){return this.recognizedShape}},{key:"setChainOut",value:function(e){this.chainOut=e}},{key:"setOnShapeRecognized",value:function(e){this.onShapeRecognized=e}}],[{key:"recognizeShapeFromPoints",value:function recognizeShapeFromPoints(points){return(0,$1LaJZ._)(function(){var _Math,_Math1,_Math2,_Math3,ptsWithTime,mod,_tmp,_mod_default,candidate,e,xs,ys,minX,maxX,minY,maxY,width,height,aspect;return(0,$2gUX3.__generator)(this,function(_state){switch(_state.label){case 0:if(points.length<10)return[2,null];ptsWithTime=points.map(function(e){return(0,$4EWN2._)((0,$cL71g._)({},e),{time:Date.now()})}),_state.label=1;case 1:return _state.trys.push([1,5,,6]),[4,eval('import("@tldraw/tldraw")').catch(function(){return null})];case 2:if(_tmp=_state.sent())return[3,4];return[4,eval('import("@tldraw/core")').catch(function(){return null})];case 3:_tmp=_state.sent(),_state.label=4;case 4:if((mod=_tmp)&&"function"==typeof(null==(candidate=null!=(_mod_default=mod.default)?_mod_default:mod)?void 0:candidate.detectShape))return[2,candidate.detectShape(ptsWithTime)];return[3,6];case 5:return e=_state.sent(),[3,6];case 6:if(xs=ptsWithTime.map(function(e){return e.x}),ys=ptsWithTime.map(function(e){return e.y}),minX=(_Math=Math).min.apply(_Math,(0,$bX4ja._)(xs)),maxX=(_Math1=Math).max.apply(_Math1,(0,$bX4ja._)(xs)),minY=(_Math2=Math).min.apply(_Math2,(0,$bX4ja._)(ys)),maxY=(_Math3=Math).max.apply(_Math3,(0,$bX4ja._)(ys)),width=maxX-minX,height=maxY-minY,aspect=0===height?1/0:width/height,aspect>5||aspect<.2){if(ShapeRecognition.isLineStatic(ptsWithTime))return[2,"line"];return[2,null]}if(aspect>.7&&aspect<1.3&&ShapeRecognition.isCircleStatic(ptsWithTime))return[2,"circle"];if(ShapeRecognition.isRectangleStatic(ptsWithTime))return[2,"rectangle"];if(ShapeRecognition.isLineStatic(ptsWithTime))return[2,"line"];return[2,null]}})})()}},{key:"isCircleStatic",value:function(e){if(e.length<20)return!1;var t=e.map(function(e){return e.x}),i=e.map(function(e){return e.y}),n=(g=Math).min.apply(g,(0,$bX4ja._)(t)),r=(v=Math).max.apply(v,(0,$bX4ja._)(t)),a=(m=Math).min.apply(m,(0,$bX4ja._)(i)),s=(y=Math).max.apply(y,(0,$bX4ja._)(i)),o=r-n,l=s-a;if(o<10||l<10)return!1;var h=o/l;if(h<.7||h>1.3)return!1;var c=0,u=0,d=!0,p=!1,f=void 0;try{for(var g,v,m,y,x,b=e[Symbol.iterator]();!(d=(x=b.next()).done);d=!0){var w=x.value;c+=w.x,u+=w.y}}catch(e){p=!0,f=e}finally{try{d||null==b.return||b.return()}finally{if(p)throw f}}var k=c/e.length,B=u/e.length,S=0,C=!0,E=!1,_=void 0;try{for(var I,T=e[Symbol.iterator]();!(C=(I=T.next()).done);C=!0){var M=I.value;S+=Math.sqrt(Math.pow(M.x-k,2)+Math.pow(M.y-B,2))}}catch(e){E=!0,_=e}finally{try{C||null==T.return||T.return()}finally{if(E)throw _}}var L=S/e.length,R=0,P=!0,A=!1,D=void 0;try{for(var O,z=e[Symbol.iterator]();!(P=(O=z.next()).done);P=!0){var H=O.value;R+=Math.abs(Math.sqrt(Math.pow(H.x-k,2)+Math.pow(H.y-B,2))-L)}}catch(e){A=!0,D=e}finally{try{P||null==z.return||z.return()}finally{if(A)throw D}}return(R/=e.length)<.5*L}},{key:"isRectangleStatic",value:function(e){if(e.length<12)return!1;var t=e.map(function(e){return e.x}),i=e.map(function(e){return e.y}),n=(y=Math).min.apply(y,(0,$bX4ja._)(t)),r=(x=Math).max.apply(x,(0,$bX4ja._)(t)),a=(b=Math).min.apply(b,(0,$bX4ja._)(i)),s=(w=Math).max.apply(w,(0,$bX4ja._)(i)),o=r-n,l=s-a;if(o<15||l<15)return!1;var h=o/l;if(h>5||h<.2)return!1;var c=Math.max(8,.25*Math.min(o,l)),u=!1,d=!1,p=!1,f=!1,g=!0,v=!1,m=void 0;try{for(var y,x,b,w,k,B=e[Symbol.iterator]();!(g=(k=B.next()).done);g=!0){var S=k.value,C=Math.abs(S.x-n),E=Math.abs(S.x-r),_=Math.abs(S.y-a),I=Math.abs(S.y-s);C<c&&_<c&&(u=!0),E<c&&_<c&&(d=!0),C<c&&I<c&&(p=!0),E<c&&I<c&&(f=!0)}}catch(e){v=!0,m=e}finally{try{g||null==B.return||B.return()}finally{if(v)throw m}}return[u,d,p,f].filter(function(e){return e}).length>=3}},{key:"isLineStatic",value:function(e){if(e.length<5)return!1;var t=e[0],i=e[e.length-1],n=i.x-t.x,r=i.y-t.y,a=Math.sqrt(n*n+r*r);if(a<15)return!1;for(var s=0,o=1;o<e.length-1;o++){var l=e[o];s+=Math.abs(r*(l.x-t.x)-n*(l.y-t.y))/(a||1)}return s/Math.max(1,e.length-2)<7}}]),ShapeRecognition}()});var $75fea8404da73e4f$exports={};$parcel$extendImportMap({"5RGAp":"de.9af5c274.js","3uTpJ":"es.ba06aaff.js","4XbAZ":"fi.7629ab8b.js","2bKIP":"fr.8783c9d5.js",i0BNf:"hu.89de6ca3.js","98Cvg":"id.05cc6376.js",y5edP:"ja.0e606fe2.js","9fDFY":"jv.c2e22eb2.js",cW2nR:"ko.d8e6b1c3.js","8ucza":"lv.ee5d3af5.js",f3RKT:"nl.1402c478.js",fVlhe:"pt-BR.988d347f.js",kcBSP:"ru.4e97c337.js","4RByM":"su.2f297e13.js",ap9yw:"sv.2e7effd2.js",dsJ3g:"zh-CN.dac2191e.js",lF1Tu:"zh-TW.71abe7bc.js",kbyFQ:"cancel.340fb0bb.svg",l7FYj:"check.e6114d75.svg",kino6:"remove-layer.da17ce5a.svg","5H9IS":"brush-pressure.8782e24b.svg",la7yv:"copy.22819386.svg",cTtMO:"tool-picker.896489f2.svg",iQ1f0:"angle.319ede69.svg","04ZZm":"tool-zoom-in.a322442c.svg",j9xio:"tool-zoom-out.a0c9b082.svg",fER1z:"viewport-reset.f69c6fbc.svg","2gZH2":"tool-hand.b64de96e.svg",ghFv7:"edit-pencil.070f95f1.svg",cazOx:"edit-crop.5a25544f.svg","1mb1v":"add-layer.ec19e714.svg","11KJK":"duplicate-layer.fd421984.svg",floUo:"merge-layers.ec5eab67.svg",hhQeq:"rename-layer.a037b591.svg",dz3mY:"caret-down.5e676c46.svg",iPQe1:"merge-moved.161569b7.png","045N6":"cursor-rotate.0c8e34b1.png",eHdqz:"klecks-logo.2d4f704b.png","3x5dR":"new-image.1891be3f.svg",hbDTd:"import.eacba42d.svg","16iGk":"export.15a4d72c.svg","2ME3z":"share.ab903904.svg",hZnSk:"help.648f7d00.svg","6mHrC":"tool-paint.1b2f44ed.svg",hS5Hj:"tool-fill.bbd4ae51.svg","4KGfM":"tool-gradient.dedc893d.svg",doX4v:"tool-text.0da9f984.svg","7NqHO":"tool-shape.522cd4b5.svg",kOuYd:"tool-select.5ec1da7d.svg",AnO0a:"tool-undo.9138898d.svg","6toXQ":"edit-rotate.8fb5b1ef.svg",b1UMP:"ui-collapse.da4b78fc.svg",lvwQ5:"align-left.dd4a3407.svg",imAvm:"align-center.13c1a9ae.svg",dC0sF:"align-right.20a4fe41.svg",h3hPo:"typo-italic.010c7282.svg","1pAeY":"typo-bold.e186ac23.svg",hapKl:"Caveat-Regular.2fe80bbd.woff2",dqzux:"ClimateCrisis-Regular-VariableFont_YEAR.3ad02523.woff2",l7VGL:"CorrectionBrush.a69973aa.woff2",dm0T7:"DancingScript-Regular.ef2fe647.woff2","2U3dq":"Diabolik-Regular-VF.f4eeb79e.woff2",axzlU:"FreckleFace-Regular.05946539.woff2",avgh6:"Gloock-Regular.60f8f765.woff2",H9bSu:"Pacha.08c8457a.woff2",emBfm:"GochiHand-Regular.c45792b0.woff2",kjRvm:"PassionOne-Bold.9e08b0dc.woff2",c79R0:"PixeloidSans.bc292131.woff2",fndWQ:"PlaypenSans-Thin.314b29a4.woff2",iAFmc:"Quicksand-Light.1f0c44a2.woff2","2Bq6W":"Silkscreen-Regular.cef2b4cb.woff2",hmfbp:"Tehroc-Regular.4540047b.woff2",iItsG:"YUNGA-Display.30c04a15.woff2","5tPq3":"edit-brightness-contrast.78620665.svg","245NA":"edit-curves.56e09e16.svg","1hkCG":"edit-flip.8010ad0f.svg",k2eFf:"edit-hue-saturation.373aa41d.svg",krKGd:"edit-invert.91bfa402.png",ehfxY:"edit-perspective.474c436b.svg",beOjS:"edit-resize.673fffa7.svg",Gk9bV:"edit-tilt-shift.7ad164eb.png",csed7:"edit-to-alpha.10878d74.svg",equSE:"edit-transform.56e34528.svg",h1dN3:"edit-triangle-blur.17417e43.png",LfAXI:"edit-unsharp-mask.38afa514.png",cB6q6:"edit-grid.c20f8e5f.svg",S9ano:"edit-noise.20c18f19.svg","4eqRj":"edit-pattern.f6d27c58.svg","8mvSV":"edit-vanish-point.a8c2dde8.svg",kbc0v:"edit-distort.33c9d58d.svg",iiCd6:"brush-pen.c04fbc65.svg","6fRlX":"brush-blend.d8ce5270.svg",hC7PC:"brush-sketchy.6c75169d.png",eZgVv:"brush-pixel.bfd351cf.svg",fPZin:"brush-eraser.388bfa8c.svg",fp7H1:"brush-smudge.9c9edfb1.svg",eX098:"brush-chemy.a5a188f6.svg","2oHM2":"upload.fb4a8f36.svg",iGeXe:"loading.7ff8a2ac.gif",kNYzr:"dist.94750278.js",kSWIa:"bitbof-logo.738252a6.svg","4FMUg":"ui-swap-lr.695f74b3.svg","62mlz":"licenses.fc8627f9.js","76QQo":"font-licenses.0e2c26a4.js","2BZYe":"constrain.46a31747.svg",k9Nks:"tab-settings.980aa34c.svg",bBxqy:"tab-layers.e4748a75.svg","3UXKl":"tab-edit.0d1e8b85.svg","1dLwT":"cursor-picker.71be1460.png",hQSEH:"cursor-fill.ab749dde.png","916ZI":"cursor-text.b4ebf6cd.png","9wZxU":"cursor-zoom-ew.d3ab2d60.png",kiEfz:"select-mode-select.46ceb4fe.svg","4uXfZ":"select-mode-move.321505b0.svg",bjhUB:"select-default.a4d71ff2.svg","9MYhm":"select-union.add41cd9.svg",fsl8L:"select-subtract.a2c61ba8.svg","3QHUd":"select-shape-rect.ecb1b83c.svg","5GkZe":"select-shape-ellipse.42a3a2f0.svg","2zM6R":"select-shape-lasso.3dedd955.svg","5rTlv":"select-shape-poly.25fd4f29.svg"});var $1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja");if(!function(){function e(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var i=e instanceof Node;t.appendChild(i?e:document.createTextNode(String(e)))}),this.appendChild(t)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(t){t.hasOwnProperty("append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value:e})})}(),!function(){function e(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var i=e instanceof Node;t.appendChild(i?e:document.createTextNode(String(e)))}),this.insertBefore(t,this.firstChild)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(t){t.hasOwnProperty("prepend")||Object.defineProperty(t,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:e})})}(),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var n=arguments[1],r=0;r<i;){var a=t[r];if(e.call(n,a,r,t))return r;r++}return -1}}),"scrollTo"in Element.prototype||Object.defineProperty(Element.prototype,"scrollTo",{value:function(e,t){this.scrollLeft=e,this.scrollTop=t}}),"scrollBy"in Element.prototype||Object.defineProperty(Element.prototype,"scrollBy",{value:function(e,t){this.scrollLeft+=e,this.scrollTop+=t}}),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=isNaN(i[0])?1:Number(i[0]);return r?Array.prototype.reduce.call(this,function(t,i){return Array.isArray(i)?t.push.apply(t,e.call(i,r-1)):t.push(i),t},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(e,t){if("function"!=typeof e)throw TypeError(e+" is not a function");for(var i=[],n=0;n<this.length;n++)if(n in this){var r,a=e.call(t,this[n],n,this);Array.isArray(a)?(r=i).push.apply(r,(0,$bX4ja._)(a)):i.push(a)}return i}}),String.prototype.replaceAll||Object.defineProperty(String.prototype,"replaceAll",{value:function(e,t){if("function"==typeof t)throw Error("replaceAll polyfill does not support replaceValue: function");return this.replace(RegExp(e,"g"),t)}}),"at"in Array.prototype||Object.defineProperty(Array.prototype,"at",{value:function(e){return e>0?this[e]:e<0?this[e+this.length]:void 0}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{value(e){if(!e||!e[Symbol.iterator])throw Error("Object.fromEntries() requires a single iterable argument");var t={};return Object.keys(e).forEach(function(i){var n=(0,$8N5YG._)(e[i],2),r=n[0],a=n[1];t[r]=a}),t}}),!("localStorage"in window))try{window.localStorage={getItem:function(){return null},setItem:function(){},removeItem:function(){}}}catch(e){}var $1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$dd0d395ff14a3e11$export$f5386afdb763a67e=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.listeners=[],this.count=0}return(0,$7h4XF._)(e,[{key:"emit",value:function(){var e=this;this.listeners.forEach(function(t){t(e.count)})}},{key:"increase",value:function(e){void 0!==e?this.count+=e:this.count++,this.emit()}},{key:"decrease",value:function(e){void 0!==e?this.count-=e:this.count--,this.emit()}},{key:"get",value:function(){return this.count}},{key:"subscribe",value:function(e){this.listeners.push(e)}}]),e}(),$dd0d395ff14a3e11$export$d3d1650bc39c4419=new $dd0d395ff14a3e11$export$f5386afdb763a67e,$eWjiX=parcelRequire("eWjiX"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$2gUX3=parcelRequire("2gUX3"),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$db912034305429b0$exports={};$db912034305429b0$exports=JSON.parse('{"switch-ui-left-right":"Switch left/right UI","toggle-show-tools":"Show/Hide Tools","scroll":"Scroll","donate":"Donate","home":"Home","modal-new-tab":"Open in new tab","tab-edit":"Edit","tab-file":"File","tool-brush":"Brush","tool-paint-bucket":"Paint Bucket","tool-gradient":"Gradient","tool-shape":"Shape","tool-text":"Text","tool-hand":"Hand Tool","tool-select":"Select Tool","tool-zoom":"Zoom","tool-more-tools":"More Tools","tool-more-tools-click-again":"Click again for more tools","undo":"Undo","redo":"Redo","brush-pen":"Pen","brush-blend":"Blend","brush-sketchy":"Sketchy","brush-pixel":"Pixel","brush-chemy":"Chemy","brush-smudge":"Smudge","brush-glitter":"Glitter","brush-size":"Size","brush-blending":"Blending","brush-toggle-pressure":"Toggle Pressure Sensitivity","brush-pen-circle":"Circle","brush-pen-chalk":"Chalk","brush-pen-calligraphy":"Calligraphy","brush-pen-square":"Square","brush-sketchy-scale":"Scale","brush-pixel-dither":"Dither","brush-chemy-fill":"Fill","brush-chemy-stroke":"Stroke","brush-chemy-mirror-x":"Horizontal Symmetry","brush-chemy-mirror-y":"Vertical Symmetry","brush-chemy-gradient":"Gradient","brush-eraser-transparent-bg":"Transparent Background","stabilizer":"Stabilizer","stabilizer-title":"Stroke Stabilizer","eyedropper":"Eyedropper","secondary-color":"Secondary Color","manual-color-input":"Manual Color Input","mci-hex":"Hex","mci-copy":"Copy","modal-ok":"Ok","modal-cancel":"Cancel","modal-close":"Close","layers-active-layer":"Active Layer","layers-layer":"Layer","layers-copy":"copy","layers-blending":"Blending","layers-new":"New Layer","layers-remove":"Remove Layer","layers-duplicate":"Duplicate Layer","layers-merge":"Merge with layer below","layers-clear":"Clear layer","layers-merge-advanced":"Advanced merge","layers-merge-all":"Merge all","layers-rename":"Rename","layers-active-layer-visible":"Active layer is visible","layers-active-layer-hidden":"Active layer is hidden","layers-visibility-toggle":"Layer Visibility","layers-blend-normal":"normal","layers-blend-darken":"darken","layers-blend-multiply":"multiply","layers-blend-color-burn":"color burn","layers-blend-lighten":"lighten","layers-blend-screen":"screen","layers-blend-color-dodge":"color dodge","layers-blend-overlay":"overlay","layers-blend-soft-light":"soft light","layers-blend-hard-light":"hard light","layers-blend-difference":"difference","layers-blend-exclusion":"exclusion","layers-blend-hue":"hue","layers-blend-saturation":"saturation","layers-blend-color":"color","layers-blend-luminosity":"luminosity","layers-rename-title":"Rename Layer","layers-rename-name":"Name","layers-rename-clear":"Clear Name","layers-rename-sketch":"Sketch","layers-rename-colors":"Colors","layers-rename-shading":"Shading","layers-rename-lines":"Lines","layers-rename-effects":"Effects","layers-rename-foreground":"Foreground","layers-merge-modal-title":"Merge/Mix Layers","layers-merge-description":"Merges the selected layer with the one underneath. Select the mix mode:","file-no-autosave":"No autosave, no cloud storage","file-new":"New","file-import":"Import","file-save":"Save","file-format":"File Format","file-show-save-dialog":"Show save dialog","file-copy":"Copy","file-copy-title":"Copy To Clipboard","file-paste":"Paste","file-share":"Share","file-storage":"Browser Storage","file-storage-about":"About Browser Storage","file-storage-cant-access":"Can\'t access storage.","file-storage-empty":"Empty","file-storage-store":"Store","file-storage-open":"Open","file-storage-open-confirmation":"This image is already open in another tab. Open it here too?","file-storage-open-failed":"Failed to load.","file-storage-clear":"Clear","file-storage-clear-prompt":"Clear Browser Storage? Clearing can not be undone.","file-storage-storing":"Storing","file-storage-overwrite":"Overwrite","file-storage-overwrite-confirm":"Overwrite Browser Storage? Overwritten data will be permanently deleted.","file-storage-min-ago":"{x}min ago","file-storage-hours-ago":"{x}h ago","file-storage-days-ago":"{x}d ago","file-storage-month-ago":"> 1month ago","file-storage-restored":"Restored from Browser Storage","file-storage-stored":"Stored to Browser Storage","file-storage-failed":"Failed to store to Browser Storage","file-storage-failed-1":"Failed to store. Possible causes:","file-storage-failed-2":"Out of disk space","file-storage-failed-3":"Storage disabled in incognito tab","file-storage-failed-4":"Browser doesn\'t support storage","file-storage-failed-clear":"Failed to clear.","file-upload":"Upload","tab-recovery-recover-tabs":"Recover closed tabs","tab-recovery-explanation":"Recovery data is only kept for a little while. Save to ensure your work is not lost.","tab-recovery-total-quota-label":"Total:","tab-recovery-empty":"Nothing to recover.","tab-recovery-recover":"Recover","tab-recovery-delete":"Delete","tab-recovery-delete-confirmation":"Delete this recovery? Deletion can not be undone.","tab-recovery-failed-to-recover":"Failed to recover tab.","tab-recovery-recovered":"Tab recovered.","cleared-layer":"Cleared layer","cleared-selected-area":"Cleared selected area","filled":"Filled","filled-selected-area":"Filled selection","new-title":"New Image","new-current":"Current","new-fit":"Fit","new-oversize":"Oversize","new-square":"Square","new-landscape":"Landscape","new-portrait":"Portrait","new-screen":"Screen","new-video":"Video","new-din-paper":"DIN Paper","new-px":"px","new-ratio":"Ratio","upload-title":"Upload to Imgur","upload-link-notice":"Anyone with the link to your uploaded image will be able to view it.","upload-name":"Title","upload-title-untitled":"Untitled","upload-caption":"Caption","upload-submit":"Upload","upload-uploading":"Uploading...","upload-success":"Upload Successful","upload-failed":"Upload failed.","upload-delete":"To delete your image from Imgur visit:","cropcopy-title-copy":"Copy To Clipboard","cropcopy-title-crop":"Crop","cropcopy-mask":"Mask unselected","cropcopy-click-hold":"Right-click or press hold to copy.","cropcopy-btn-copy":"To Clipboard","cropcopy-copied":"Copied.","cropcopy-btn-crop":"Apply Crop","crop-drag-to-crop":"Drag to crop","filter-crop-extend":"Crop/Extend","filter-flip":"Flip","filter-perspective":"Perspective","filter-resize":"Resize","filter-rotate":"Rotate","filter-transform":"Transform","filter-bright-contrast":"Bright/Contrast","filter-curves":"Curves","filter-hue-sat":"Hue/Saturation","filter-invert":"Invert","filter-tilt-shift":"Tilt Shift","filter-to-alpha":"To Alpha","filter-triangle-blur":"Triangle Blur","filter-unsharp-mask":"Unsharp Mask","filter-crop-title":"Crop / Extend","filter-crop-description":"Crop or extend the image.","filter-crop-left":"Left","filter-crop-right":"Right","filter-crop-top":"Top","filter-crop-bottom":"Bottom","filter-crop-rule-thirds":"Rule of Thirds","filter-crop-fill":"Fill","filter-flip-title":"Flip","filter-flip-description":"Flips layer or whole image.","filter-flip-horizontal":"Horizontal","filter-flip-vertical":"Vertical","filter-flip-image":"Flip Image","filter-flip-layer":"Flip Layer","filter-perspective-title":"Perspective","filter-perspective-description":"Transforms the selected layer.","filter-resize-title":"Resize","filter-resize-description":"Resizes the image.","filter-rotate-title":"Rotate","filter-rotate-description":"Rotates the image.","filter-transform-empty":"Layer is empty.","filter-transform-empty-selection":"Layer is empty in selected area.","filter-transform-title":"Transform","filter-transform-description":"Transforms selected layer. Hold Shift for additional behavior.","filter-transform-rotation":"Rotation","filter-transform-flip":"Flip","filter-transform-center":"Center","filter-transform-constrain":"Constrain","filter-transform-snap":"Snap","filter-transform-snap-title":"Snap Rotation And Position","filter-bright-contrast-title":"Brightness / Contrast","filter-bright-contrast-description":"Change brightness and contrast for the selected layer.","filter-bright-contrast-brightness":"Brightness","filter-bright-contrast-contrast":"Contrast","filter-curves-title":"Curves","filter-curves-description":"Apply curves on the selected layer.","filter-curves-all":"All","filter-hue-sat-title":"Hue / Saturation","filter-hue-sat-description":"Change hue and saturation for the selected layer.","filter-hue-sat-hue":"Hue","filter-hue-sat-saturation":"Saturation","filter-applied":"applied","filter-tilt-shift-title":"Tilt Shift","filter-tilt-shift-description":"Applies tilt shift on the selected layer.","filter-tilt-shift-blur":"Blur Radius","filter-tilt-shift-gradient":"Gradient Radius","filter-to-alpha-title":"To Alpha","filter-to-alpha-description":"Generates alpha channel for selected layer from:","filter-to-alpha-inverted-lum":"Inverted Luminance","filter-to-alpha-lum":"Luminance","filter-to-alpha-replace":"Replace RGB","filter-triangle-blur-title":"Triangle Blur","filter-triangle-blur-description":"Applies triangle blur on the selected layer.","filter-unsharp-mask-title":"Unsharp Mask","filter-unsharp-mask-description":"Sharpens the selected layer by scaling pixels away from the average of their neighbors.","filter-unsharp-mask-strength":"Strength","filter-grid":"Grid","filter-grid-description":"Draws grid on selected layer.","filter-noise":"Noise","filter-noise-description":"Adds noise to selected layer.","filter-noise-scale":"Scale","filter-noise-alpha":"Alpha","filter-pattern":"Pattern","filter-pattern-description":"Generates pattern on selected layer. Drag the preview for further controls.","filter-distort":"Distort","filter-distort-description":"Distorts the selected layer.","filter-distort-phase":"Phase","filter-distort-stepsize":"Step Size","filter-distort-sync-xy":"Sync XY","filter-vanish-point":"Vanish Point","filter-vanish-point-title":"Vanishing Point","filter-vanish-point-description":"Adds vanishing point to selected layer. Drag preview to move.","filter-vanish-point-lines":"Lines","dropper-drop":"Drop to import","dropper-as-image":"As New Image","dropper-as-layer":"As Layer","import-opening":"Opening file...","import-title":"Import Image","import-too-large":"Image too large, will be downscaled.","import-btn-as-layer":"As Layer","import-btn-as-image":"As Image","import-as-layer-title":"Import Image as New Layer","import-as-layer-description":"Adjust the position of the imported image.","import-as-layer-limit-reached":"Layer limit reached. Image will be placed on existing layer.","import-as-layer-fit":"Fit","import-flatten":"Flatten image","import-unsupported-file":"Unsupported file type. See Help for supported types.","import-broken-file":"Couldn\'t load image. File might be corrupted.","import-psd-unsupported":"Unsupported features. PSD had to be flattened.","import-psd-limited-support":"PSD support is limited. Flattened will more likely look correct.","import-psd-too-large":"Image exceeds maximum dimensions of {x} x {x} pixels. Unable to import.","import-psd-size":"Image size","clipboard-read-fail":"Failed to read from clipboard.","clipboard-no-image":"No image found in clipboard.","hand-reset":"Reset","hand-fit":"Fit","hand-inertia-scrolling":"Inertia Scrolling","bucket-tolerance":"Tolerance","bucket-sample":"Sample","bucket-sample-title":"Which layers to sample color from","bucket-sample-all":"All","bucket-sample-active":"Active","bucket-sample-above":"Above","bucket-grow":"Grow","bucket-grow-title":"Grow filled area (in pixels)","bucket-contiguous":"Contiguous","bucket-contiguous-title":"Only fill connected areas","gradient-linear":"Linear","gradient-linear-mirror":"Linear-Mirror","gradient-radial":"Radial","shape-stroke":"Stroke","shape-fill":"Fill","shape-rect":"Rectangle","shape-ellipse":"Ellipse","shape-line":"Line","shape-line-width":"Line Width","shape-outwards":"Outwards","shape-fixed":"Fixed 1:1","shape-auto-pan":"Auto-pan","shape-auto-pan-title":"Automatically moves as you draw","text-instruction":"Click canvas to place text","text-title":"Add Text","text-text":"Text","text-font":"Font","text-placeholder":"Your text","text-color":"Color","text-size":"Size","text-line-height":"Line Height","text-letter-spacing":"Letter Spacing","text-left":"Left","text-center":"Center","text-right":"Right","text-italic":"Italic","text-bold":"Bold","text-failed-import":"Failed to import the following files:","text-supported-formats":"Supported formats:","select-select":"Select","select-transform":"Transform","select-lasso":"Lasso","select-polygon":"Polygon","select-boolean-replace":"Replace","select-boolean-add":"Add","select-boolean-subtract":"Subtract","select-all":"All","select-invert":"Invert","select-reset":"Reset","select-fill":"Fill","select-erase":"Erase","select-transform-clone":"Clone","select-transform-clone-applied":"Cloned","select-transform-move-to-layer":"Move to layer:","select-transform-applied":"Transformation applied","select-transform-empty":"Selected area on active layer is empty.","save-reminder-title":"Unsaved Work","save-reminder-text":"Image was not saved in {a} minutes{b}. Save now to prevent eventual loss.","save-reminder-save-psd":"Save As PSD","save-reminder-psd-layers":"PSD will remember all layers.","backup-drawing":"You can backup your drawing.","submit":"Submit","submit-title":"Submit Drawing","submit-prompt":"Submit drawing?","submit-submitting":"Submitting","embed-init-loading":"Loading app","embed-init-waiting":"Waiting for image","help":"Help","tab-settings":"Settings","settings-language":"Language","settings-language-reload":"Will update after reloading.","settings-theme":"Theme","settings-save-reminder-label":"Save Reminder","settings-save-reminder-disabled":"disabled","settings-save-reminder-confirm-title":"Turn off Save Reminder?","settings-save-reminder-confirm-a":"There is no autosave and browser tabs don\'t last forever. If you don\'t periodically save you will likely lose work.","settings-save-reminder-confirm-b":"Disable at your own risk?","settings-save-reminder-confirm-disable":"Disable","theme-dark":"Dark","theme-light":"Light","terms-of-service":"Terms of Service","licenses":"Licenses","source-code":"Source Code","auto":"auto","zoom-in":"Zoom In","zoom-out":"Zoom Out","radius":"Radius","constrain-proportions":"Constrain Proportions","width":"Width","height":"Height","opacity":"Opacity","scatter":"Scatter","red":"Red","green":"Green","blue":"Blue","eraser":"Eraser","center":"Center","layers":"Layers","background":"Background","scaling-algorithm":"Scaling Algorithm","algorithm-smooth":"Smooth","algorithm-pixelated":"Pixelated","preview":"Preview","angle-snap":"Snap","angle-snap-title":"45 Angle Snapping","lock-alpha":"Lock Alpha","lock-alpha-title":"Locks layer\'s alpha channel","reverse":"Reverse","compare-before":"Before","compare-after":"After","loading":"Loading","more":"More","x-minutes":"{x}min","wip":"Work in progress","browser-zoom-help":"Double-tap or pinch-out to reset browser zoom.","dismiss":"Dismiss"}');var $90c6410f4b764e9c$export$33e6c23ebe2ee669=$parcel$interopDefault($db912034305429b0$exports),$90c6410f4b764e9c$export$d0d68bb9ed2c643d=[{code:"en",name:"English"},{code:"de",name:"Deutsch"},{code:"es",name:"Espaol"},{code:"fi",name:"suomi"},{code:"fr",name:"Franais"},{code:"hu",name:"Magyar"},{code:"id",name:"Bahasa Indonesia"},{code:"ja",name:""},{code:"jv",name:"Basa Jawa"},{code:"ko",name:""},{code:"lv",name:"Latvieu Valoda"},{code:"nl",name:"Nederlands"},{code:"pt-BR",name:"Portugus Brasil"},{code:"ru",name:""},{code:"su",name:"Basa Sunda"},{code:"sv",name:"Svenska"},{code:"zh-CN",name:""},{code:"zh-TW",name:""}],$90c6410f4b764e9c$export$f02cbd868e2f57cf=function(e){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:if("en"!==e)return[3,1];return[2,$90c6410f4b764e9c$export$33e6c23ebe2ee669];case 1:if("de"!==e)return[3,3];return[4,parcelRequire("8mlhh")];case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:case 20:case 22:case 24:case 26:case 28:case 30:case 32:case 34:return[2,t.sent()];case 3:if("es"!==e)return[3,5];return[4,parcelRequire("hLG03")];case 5:if("fi"!==e)return[3,7];return[4,parcelRequire("kJrPi")];case 7:if("fr"!==e)return[3,9];return[4,parcelRequire("bI71U")];case 9:if("hu"!==e)return[3,11];return[4,parcelRequire("eICi1")];case 11:if("id"!==e)return[3,13];return[4,parcelRequire("kqusB")];case 13:if("ja"!==e)return[3,15];return[4,parcelRequire("57GX6")];case 15:if("jv"!==e)return[3,17];return[4,parcelRequire("h75GH")];case 17:if("ko"!==e)return[3,19];return[4,parcelRequire("55azR")];case 19:if("lv"!==e)return[3,21];return[4,parcelRequire("fWO0c")];case 21:if("nl"!==e)return[3,23];return[4,parcelRequire("4zES7")];case 23:if("pt-BR"!==e)return[3,25];return[4,parcelRequire("7KXHm")];case 25:if("ru"!==e)return[3,27];return[4,parcelRequire("aqoL6")];case 27:if("su"!==e)return[3,29];return[4,parcelRequire("7TgKV")];case 29:if("sv"!==e)return[3,31];return[4,parcelRequire("2HU4B")];case 31:if("zh-CN"!==e)return[3,33];return[4,parcelRequire("lWIVr")];case 33:if("zh-TW"!==e)return[3,35];return[4,parcelRequire("bGxAd")];case 35:throw Error("unknown language code")}})})()},$6l0gQ=parcelRequire("6l0gQ"),$8d7403abedf7cefa$export$991796128b2ca217="klecks-language",$8d7403abedf7cefa$var$LanguageStrings=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.listeners=[],this.data=(0,$cL71g._)({},$90c6410f4b764e9c$export$33e6c23ebe2ee669),this.code="en"}return(0,$7h4XF._)(e,[{key:"setLanguage",value:function(e){return(0,$1LaJZ._)(function(){var t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:if("en"!==e)return[3,1];return this.data=(0,$cL71g._)({},$90c6410f4b764e9c$export$33e6c23ebe2ee669),[3,3];case 1:return t=this,i=[{},$90c6410f4b764e9c$export$33e6c23ebe2ee669],[4,$90c6410f4b764e9c$export$f02cbd868e2f57cf(e)];case 2:t.data=$cL71g._.apply(void 0,i.concat([n.sent()])),n.label=3;case 3:return this.code=e,document.documentElement.setAttribute("lang",e),this.listeners.forEach(function(e){e()}),[2]}})}).call(this)}},{key:"get",value:function(e){if(!(e in this.data))throw Error("translation code doesn't exist: "+e);return this.data[e]}},{key:"getLanguage",value:function(){var e=this;return $90c6410f4b764e9c$export$d0d68bb9ed2c643d.find(function(t){return t.code===e.code})}},{key:"getAutoLanguage",value:function(){var e=$8d7403abedf7cefa$export$64783e31db14f0ba(!1);return $90c6410f4b764e9c$export$d0d68bb9ed2c643d.find(function(t){return t.code===e})}},{key:"getCode",value:function(){return this.code}},{key:"subscribe",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"unsubscribe",value:function(e){for(var t=0;t<this.listeners.length;t++)if(e===this.listeners[t])return void this.listeners.splice(t,1)}}]),e}();function $8d7403abedf7cefa$export$64783e31db14f0ba(e){var t=function(e){var t=n[e],r=$90c6410f4b764e9c$export$d0d68bb9ed2c643d.find(function(e){return e.code.toLowerCase()===t.toLowerCase()});if(r)return i=r.code,"break"},i="en",n=[];if((navigator.languages?navigator.languages:[navigator.language]).forEach(function(e){var t=e.split("-");n.push(e),2===t.length&&n.push(t[0])}),e)try{var r=$6l0gQ.LocalStorage.getItem($8d7403abedf7cefa$export$991796128b2ca217);r&&n.unshift(r)}catch(e){}for(var a=0;a<n.length&&"break"!==t(a);a++);return i}var $8d7403abedf7cefa$var$activeLanguageCode=$8d7403abedf7cefa$export$64783e31db14f0ba(!0),$8d7403abedf7cefa$export$e4ce066d17694649=new $8d7403abedf7cefa$var$LanguageStrings,$8d7403abedf7cefa$export$ce37e184d908d785=function(e,t){if(!t)return $8d7403abedf7cefa$export$e4ce066d17694649.get(e);var i=$8d7403abedf7cefa$export$e4ce066d17694649.get(e);return Object.keys(t).forEach(function(e){i=i.replace(`{${e}}`,t[e])}),i},$8d7403abedf7cefa$export$7a2ea9f2e4d199d3=function(){return $8d7403abedf7cefa$export$e4ce066d17694649.setLanguage($8d7403abedf7cefa$var$activeLanguageCode)};window.onscroll=function(e){e.preventDefault()};var $e33dc4efcac9043e$exports={};$e33dc4efcac9043e$exports=$parcel$resolve("kbyFQ");var $10da88069cb8e734$exports={};$10da88069cb8e734$exports=$parcel$resolve("l7FYj");var $720ba2c010612610$exports={};function $c902829f68f42bce$export$d7e8d4d4450c819c(e){$dd0d395ff14a3e11$export$d3d1650bc39c4419.increase();var t,i,n=!1,r=!!e.ignoreBackground,a=$eWjiX.BB.el({parent:document.body,css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",overflow:"hidden"}}),s=$eWjiX.BB.el({parent:a,className:"kl-popup"}),o=$eWjiX.BB.el({parent:s,css:{width:"100%",minHeight:"100%",position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}),l=$eWjiX.BB.el({parent:o,onClick:function(){r||y("Cancel")},css:{position:"absolute",left:"0",top:"0",zIndex:"0",width:"100%",height:"100%"}}),h=40,c=$eWjiX.BB.el({tagName:"button",className:"popup-x",content:`<img alt="${$8d7403abedf7cefa$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($e33dc4efcac9043e$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("modal-close"),onClick:function(){y("Cancel")},css:{width:h+"px",height:h+"px",lineHeight:h+"px",position:"absolute",right:"0",top:"0",background:"none",boxShadow:"none"}}),u=void 0;e.type&&(u=$eWjiX.BB.el({className:{error:"kl-popup__icon-error",ok:"kl-popup__icon-ok",warning:"kl-popup__icon-warning",upload:"kl-popup__icon-upload"}[e.type]}));var d=["kl-popup-box"];d.push("kl-popup-box--sm");var p=$eWjiX.BB.el({content:[c,u,$eWjiX.BB.el({content:e.message,css:{marginRight:"15px",marginBottom:e.div?"10px":void 0}}),e.div],className:d.join(" "),css:e.style?e.style:void 0});o.append($eWjiX.BB.el({css:{flex:"0.5"}}),p,$eWjiX.BB.el({css:{flex:"1"}}));var f=new $eWjiX.BB.KeyListener({onDown:function(e,t,r){n||(i&&"enter"===r&&!$eWjiX.BB.isInputFocused()&&(t.stopPropagation(),setTimeout(function(){i&&i.click()},10)),"esc"===r&&(t.stopPropagation(),t.preventDefault(),y("Cancel")))}}),g=function(e){f.isPressed("ctrl")&&e.preventDefault()};s.addEventListener("wheel",g,{passive:!1}),s.onclick=$eWjiX.BB.handleClick,t=e.autoFocus?e.autoFocus:!1===e.autoFocus?void 0:"Ok";var v=e.buttons&&e.buttons.length>0?$eWjiX.BB.el({parent:p,css:{display:"flex",flexWrap:"wrap",justifyContent:"flex-end",marginTop:"12px",marginLeft:"-8px"}}):void 0,m=[];function y(t){!n&&(n=!0,$eWjiX.BB.clearSelection(),$eWjiX.BB.unfocusAnyInput(),a.remove(),$dd0d395ff14a3e11$export$d3d1650bc39c4419.decrease(),$eWjiX.BB.destroyEl(c),$eWjiX.BB.destroyEl(l),f.destroy(),s.removeEventListener("wheel",g),s.onclick=null,m.forEach(function(e){return $eWjiX.BB.destroyEl(e)}),m.splice(0,m.length),e.callback&&e.callback(t))}return e.buttons&&e.buttons.forEach(function(n){var r,a=["kl-popup__btn"];("Ok"===n||e.primaries&&e.primaries.includes(n))&&a.push("kl-button-primary"),n===e.deleteButtonName&&a.push("kl-button-delete");var o=n;"Ok"===n&&(o=$8d7403abedf7cefa$export$ce37e184d908d785("modal-ok"),r=$parcel$interopDefault($10da88069cb8e734$exports)),"Cancel"===n&&(o=$8d7403abedf7cefa$export$ce37e184d908d785("modal-cancel"),r=$parcel$interopDefault($e33dc4efcac9043e$exports),a.push("kl-button-cancel")),n===e.deleteButtonName&&(r=$parcel$interopDefault($720ba2c010612610$exports));var l=void 0;r&&(l=$eWjiX.BB.el({tagName:"img",custom:{src:r,height:"17"}}));var h=$eWjiX.BB.el({parent:v,tagName:"button",className:a.join(" "),content:[l,$eWjiX.BB.el({className:"kl-popup__btn__text",content:o})],onClick:function(){y(n)}});m.push(h),t===n&&(setTimeout(function(){h.focus(),s.scrollTo(0,0)},10),setTimeout(function(){s.scrollTo(0,0)},20)),n===e.clickOnEnter&&(i=h)}),e.closeFunc&&e.closeFunc(function(){y("Cancel")}),{setIgnoreBackground:function(e){r=e}}}$720ba2c010612610$exports=$parcel$resolve("kino6");var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$e59fbd08bcc1a36b$export$185108a9b725b68=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),$dd0d395ff14a3e11$export$d3d1650bc39c4419.increase(),this.onClose=t.onClose,this.parent=document.body,this.rootEl=$eWjiX.BB.el({parent:this.parent,className:"g-root kl-d-modal-root",css:{position:"fixed",left:"0",top:"0",bottom:"0",right:"0",overflow:"auto",animationName:"consoleIn",animationDuration:"0.3s",animationTimingFunction:"ease-out"},onClick:$eWjiX.BB.handleClick}),this.bgEl=$eWjiX.BB.el({parent:this.rootEl,css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"},onClick:function(){return i.close()}});var n=$eWjiX.BB.el({parent:this.rootEl,className:"kl-d-modal",css:{position:"absolute",width:$eWjiX.BB.isCssMinMaxSupported()?"min(calc(100% - 40px), "+(t.width?t.width:400)+"px)":(t.width?t.width:400)+"px",height:"calc(100% - 40px)",borderRadius:"10px",overflow:"hidden"}});this.updatePos=function(){var e=n.offsetWidth,t=n.offsetHeight;(0,$7jh4K.css)(n,{left:Math.max(0,(window.innerWidth-e)/2)+"px",top:Math.max(20,(window.innerHeight-t)/2-.2*t)+"px"})},this.updatePos(),window.addEventListener("resize",this.updatePos);var r=40,a=$eWjiX.BB.el({parent:n,css:{height:r+"px",display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:r/2+"px"}});t.title&&a.append(t.title),this.xButton=$eWjiX.BB.el({parent:a,tagName:"button",className:"popup-x",content:`<img alt="${$8d7403abedf7cefa$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($e33dc4efcac9043e$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("modal-close"),onClick:function(){return i.close()},css:{width:r+"px",height:r+"px",lineHeight:r+"px",background:"none",boxShadow:"none"},custom:{tabindex:"0"}});var s=$eWjiX.BB.el({parent:n,css:{height:"calc(100% - "+r+"px)"}});t.content&&s.append(t.content),this.keyListener=new $eWjiX.BB.KeyListener({onDown:function(e,t){"esc"===e&&(t.stopPropagation(),t.preventDefault(),i.close())}})}return(0,$7h4XF._)(e,[{key:"close",value:function(){$dd0d395ff14a3e11$export$d3d1650bc39c4419.decrease(),$eWjiX.BB.destroyEl(this.rootEl),this.rootEl.remove(),window.removeEventListener("resize",this.updatePos),this.keyListener.destroy(),$eWjiX.BB.destroyEl(this.xButton),$eWjiX.BB.destroyEl(this.bgEl),this.onClose&&this.onClose()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$365a915dfb503274$export$48513f6b9f8ce62d=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.doHighlight=!!t.doHighlight,this.rootEl=$eWjiX.BB.el({className:"kl-checkbox"});var n=$eWjiX.BB.el({parent:this.rootEl,tagName:"label",className:"kl-checkbox__inner",css:{display:"flex"}});this.check=$eWjiX.BB.el({parent:n,tagName:"input",css:{margin:"0 5px 0 0"},custom:{type:"checkbox",name:t.name}}),this.check.checked=!!t.init,this.doHighlight&&this.check.checked&&this.rootEl.classList.add("kl-checkbox--highlight"),t.allowTab||(this.check.tabIndex=-1),t.title&&(n.title=t.title),$eWjiX.BB.el({parent:n,content:t.label,css:{}}),this.check.onchange=function(){i.doHighlight&&i.rootEl.classList.toggle("kl-checkbox--highlight",i.check.checked),t.callback&&t.callback(i.check.checked),setTimeout(function(){i.check.blur()},0)},t.css&&(0,$7jh4K.css)(this.rootEl,t.css)}return(0,$7h4XF._)(e,[{key:"getValue",value:function(){return this.check.checked}},{key:"setValue",value:function(e){this.check.checked=e,this.doHighlight&&this.rootEl.classList.toggle("kl-checkbox--highlight",this.check.checked)}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.check.onchange=null}}]),e}(),$dJPtW=parcelRequire("dJPtW"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$7a3263857aacf58f$export$ef9b1a59e592288f=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.optionArr=[],this.selectEl=$eWjiX.BB.el({tagName:"select",title:t.title,className:"kl-select",css:{cursor:"pointer",fontSize:"15px",padding:"3px"},custom:{name:t.name}}),t.css&&(0,$7jh4K.css)(this.selectEl,t.css);var n=t.isFocusable;n||(this.selectEl.tabIndex=-1),this.setOptionArr(t.optionArr),t.onChange&&(this.onChange=t.onChange),this.changeListener=function(){n||i.selectEl.blur(),i.onChange&&i.onChange(i.getValue())},this.selectEl.addEventListener("change",this.changeListener),this.selectEl.value=void 0!==t.initValue?t.initValue:""}return(0,$7h4XF._)(e,[{key:"setValue",value:function(e){this.selectEl.value=void 0===e?"":e}},{key:"getValue",value:function(){return this.selectEl.value}},{key:"setDeltaValue",value:function(e){for(var t=0,i=0;i<this.optionArr.length;i++){var n=this.optionArr[i];if(n.item&&""+n.item[0]===this.selectEl.value){t=i;break}}t=Math.max(0,Math.min(this.optionArr.length-1,t+e));var r=this.optionArr[t];this.selectEl.value=r.item?r.item[0]:"",this.onChange&&this.onChange(this.getValue())}},{key:"getElement",value:function(){return this.selectEl}},{key:"updateLabel",value:function(e,t){this.optionArr.forEach(function(i){i.item&&i.item[0]===e&&i.el&&(i.item[1]=t,i.el.textContent=i.item[1])})}},{key:"setOptionArr",value:function(e){var t=this.selectEl.value;this.optionArr=[],this.selectEl.innerHTML="";for(var i=0;i<e.length;i++){var n=e[i];if(!n){this.optionArr.push({item:n});continue}var r=document.createElement("option");r.value=n[0],r.textContent=n[1],n[2]&&(0,$7jh4K.css)(r,n[2].css),this.optionArr.push({item:n,el:r}),this.selectEl.append(r)}(""===t||e.findIndex(function(e){return e&&e[0]===t})>-1)&&this.setValue(t)}},{key:"destroy",value:function(){this.selectEl.removeEventListener("change",this.changeListener)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$8fa94d142febb502$export$b6d053cded550773=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.isActive=t.initValue,this.rootEl=$eWjiX.BB.el({className:"image-toggle",title:t.title,content:$eWjiX.BB.el({className:"image-toggle__im"+(t.darkInvert?" dark-invert":""),css:{backgroundImage:"url('"+t.image+"')"}}),onClick:function(e){e.preventDefault(),t.isRadio&&i.isActive||(i.isActive=!i.isActive,i.update(),t.onChange(i.isActive))}}),this.update()}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.rootEl.classList.toggle("image-toggle-active",this.isActive)}},{key:"setValue",value:function(e){this.isActive=e,this.update()}},{key:"getElement",value:function(){return this.rootEl}},{key:"getValue",value:function(){return this.isActive}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.rootEl)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$8cb981a3c9e5b15b$export$7cc1012a658e6ad8=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({className:"image-radio-wrapper",css:{display:"flex"}}),this.optionArr=[];for(var r=function(e,i){n.activeIndex=e;for(var r=0;r<n.optionArr.length;r++)n.optionArr[r].radioEl.setValue(r===n.activeIndex);t.onChange(i)},a=function(e,a){a.id===t.initId&&(i=e);var s=new $8fa94d142febb502$export$b6d053cded550773({image:a.image,title:a.title,initValue:a.id===t.initId,isRadio:!0,onChange:function(){r(e,a.id)},darkInvert:a.darkInvert});return n.rootEl.append(s.getElement()),{id:a.id,radioEl:s}},s=0;s<t.optionArr.length;s++)this.optionArr.push(a(s,t.optionArr[s]));if(void 0===i)throw Error("initId not in optionArr");this.activeIndex=i}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getValue",value:function(){return this.optionArr[this.activeIndex].id}},{key:"destroy",value:function(){this.optionArr.forEach(function(e){e.radioEl.destroy()})}}]),e}(),$eWjiX=parcelRequire("eWjiX"),$98a18d2a4a92ce67$exports={};$98a18d2a4a92ce67$exports=$parcel$resolve("5H9IS");var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$afe02cc26c765c2c$export$2358c75ad3c15b2d=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.value=!!t.init,this.el=$eWjiX.BB.el({content:t.label,title:t.title,className:"string"==typeof t.label?"kl-box-toggle":"kl-box-toggle kl-box-toggle--custom-el",onClick:function(){i.value=!i.value,i.update(),t.onChange(i.value)},css:{cursor:"pointer"}}),"string"!=typeof t.label&&(0,$7jh4K.css)(t.label,{display:"block",pointerEvents:"none"}),this.update()}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.el.classList.toggle("kl-box-toggle--active",this.value)}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e,this.update()}},{key:"getElement",value:function(){return this.el}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.el)}}]),e}(),$a49c90053f8766a2$export$9da2e8821e6cbb57=function(e,t){return new $afe02cc26c765c2c$export$2358c75ad3c15b2d({label:$eWjiX.BB.el({className:"dark-invert",css:{width:"17px",height:"17px",backgroundImage:'url("'+$parcel$interopDefault($98a18d2a4a92ce67$exports)+'")',backgroundSize:"contain",backgroundRepeat:"no-repeat",margin:"1px",borderRadius:"3px"}}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-toggle-pressure"),init:e,onChange:function(e){t(e)}}).getElement()},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX");function $16ee6d1163eaf409$export$f8e41e222e32615d(e,t){var i=Math.min(10,1+Math.pow(Math.floor(e/50),2));return t&&(i*=2),1/i}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$7jh4K=parcelRequire("7jh4K"),$068903cd1342554f$export$db3d4fde05db9a5e=function(){"use strict";function e(t,i,n,r,a,s,o){var l,h=this;(0,$cx0mh._)(this,e),this.onChange=a,this.onClose=s,this.isEnabled=!0,this.isClosed=!1,this.input=(0,$dJPtW.input)({type:"number",init:t,min:i,max:n,callback:function(e){h.emit()}}),0!==o&&this.input.setAttribute("step","any"),this.input.onblur=function(){h.privateOnClose()},this.input.addEventListener("keyup",function(e){["Enter","Escape"].includes(e.key)?h.privateOnClose():h.emit()},{passive:!1}),this.input.addEventListener("wheel",function(){return h.emit()},{passive:!1}),this.scrollBefore={x:window.scrollX,y:window.scrollY},l=o||0===o?$eWjiX.BB.round(t,o):t,this.lastValue=l,this.input.value=""+l,(0,$7jh4K.css)(this.input,{width:r.width+"px",height:r.height+"px"})}return(0,$7h4XF._)(e,[{key:"emit",value:function(){this.lastValue!==Number(this.input.value)&&(this.onChange(Number(this.input.value)),this.lastValue=Number(this.input.value))}},{key:"privateOnClose",value:function(){var e=this;this.isClosed||(this.isClosed=!0,this.emit(),this.onClose(),setTimeout(function(){e.scrollBefore&&window.scrollTo(e.scrollBefore.x,e.scrollBefore.y),e.scrollBefore=void 0}))}},{key:"getElement",value:function(){return this.input}},{key:"setIsEnabled",value:function(e){this.isEnabled=e}},{key:"focus",value:function(){this.input.focus(),this.input.select()}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.input)}}]),e}(),$7jh4K=parcelRequire("7jh4K"),$5c0625e6104e2c75$export$a1855b925e534de7=function(){"use strict";function e(t){var i,n=this;if((0,$cx0mh._)(this,e),this.isEnabled=!1!==t.isEnabled,this.manualInputRoundDigits=t.manualInputRoundDigits,this.useSpline=!!t.curve,!t.label)throw Error("KlSlider missing params");if(0!=t.min&&0!=t.max&&0!=t.value&&(!t.min||!t.max||!t.value)||t.min>=t.max)throw Error("KlSlider broken params");if(this.min=t.min,this.max=t.max,this.value=$eWjiX.BB.clamp(t.value,this.min,this.max),this.elementWidth=t.width,this.elementHeight=t.height,this.resolution=t.resolution?t.resolution:2*this.elementWidth,this.onChange=t.onChange?t.onChange:function(){},!t.toValue!=!t.toDisplayValue)throw Error("both or neither have to be set, toValue and toDisplayValue");if(this.displayValueToValue=t.toValue?t.toValue:function(e){return e},this.valueToDisplayValue=t.toDisplayValue?t.toDisplayValue:function(e){return e},this.isChangeOnFinal=!!t.isChangeOnFinal,this.formatFunc=t.formatFunc,this.eventResMs=t.eventResMs,this.unit=t.unit,this.useSpline){if(!t.curve)throw Error("curve needs to be set if useSpline true");var r="quadratic"===t.curve?$eWjiX.BB.powerSplineInput(this.min,this.max,.1):t.curve;this.splineInterpolator=new $eWjiX.BB.SplineInterpolator(r)}this.rootEl=$eWjiX.BB.el({css:{display:"flex"}}),this.sliderWrapperEl=$eWjiX.BB.el({parent:this.rootEl,className:"slider-wrapper",css:{overflow:"hidden",position:"relative",width:this.elementWidth+"px",height:this.elementHeight+"px",userSelect:"none"}}),this.rootEl.oncontextmenu=function(){return!1},this.label=t.label;var a=this.elementHeight-14;this.labelValueEl=$eWjiX.BB.el({css:{fontWeight:"bold"}}),this.textEl=$eWjiX.BB.el({content:[$eWjiX.BB.el({content:this.label,css:{overflow:"hidden",textOverflow:"ellipsis"}}),this.labelValueEl],css:{position:"absolute",display:"flex",alignItems:"center",padding:"0 7px",height:"100%",width:"100%",fontSize:a+"px",pointerEvents:"none",gap:"8px"}}),this.control=$eWjiX.BB.el({className:"slider-inner",css:{position:"absolute",left:"0",top:"0",width:this.valueToSliderValue(this.value)*this.elementWidth+"px",height:this.elementHeight+"px"}});var s=document.createElement("div");this.sliderWrapperEl.append(this.control,this.textEl),this.control.append(s),this.updateEnable();var o=new $eWjiX.BB.DoubleTapper({onDoubleTap:function(){n.showManualInput()}});o.setAllowedButtonArr(["left","right"]);var l=new $eWjiX.BB.EventChain({chainArr:[o]}),h=function(e){if(e.eventPreventDefault(),n.isEnabled){if("pointerdown"===e.type){if($eWjiX.BB.unfocusAnyInput(),n.sliderWrapperEl.className="slider-wrapper slider-wrapper--active","left"===e.button){var t=e.relX/n.elementWidth;t=Math.max(0,Math.min(1,t)),n.value=n.sliderValueToValue(t),n.updateLabel(),n.emit(!1)}i=n.valueToSliderValue(n.value)}if("pointermove"===e.type&&["left","right"].includes(e.button||"")){var r=e.dX;r*=$16ee6d1163eaf409$export$f8e41e222e32615d(Math.abs(e.pageY-(e.downPageY||0)),"right"===e.button),r/=n.elementWidth;var a=Math.max(0,Math.min(1,i+=r));n.value=n.sliderValueToValue(a),n.updateLabel(),n.emit(!1)}"pointerup"===e.type&&(n.sliderWrapperEl.className="slider-wrapper",n.emit(!0))}};this.pointerListenerTimeout=setTimeout(function(){n.pointerListener=new $eWjiX.BB.PointerListener({target:n.sliderWrapperEl,fixScribble:!0,onPointer:function(e){h(e),l.chainIn(e)},onWheel:function(e){var t=n.valueToSliderValue(n.value);t=$eWjiX.BB.clamp(t-e.deltaY/40,0,1),n.value=n.sliderValueToValue(t),n.updateLabel(),n.onChange(n.value)}}),n.updateLabel()},1)}return(0,$7h4XF._)(e,[{key:"valueToSliderValue",value:function(e){return this.useSpline&&this.splineInterpolator?this.splineInterpolator.findX(e,Math.floor(this.resolution))||0:(e-this.min)/(this.max-this.min)}},{key:"sliderValueToValue",value:function(e){var t=this.min+e*(this.max-this.min);return this.useSpline&&this.splineInterpolator&&(t=this.splineInterpolator.interpolate(e)||0),t}},{key:"updateLabel",value:function(){var e=this.valueToDisplayValue(this.value);e=(e=this.formatFunc?this.formatFunc(e):Math.round(e)).toLocaleString($8d7403abedf7cefa$export$e4ce066d17694649.getCode());var t=void 0!==this.unit?this.unit:"";this.labelValueEl.textContent=e+t;var i=this.valueToSliderValue(this.value);this.control.style.width=i*this.elementWidth+"px"}},{key:"emit",value:function(e){var t=this;if(e||!this.isChangeOnFinal){if(e||!this.eventResMs){this.onChange(this.value),this.emitInterval&&(clearInterval(this.emitInterval),this.emitInterval=void 0);return}this.emitInterval?this.emitValue=this.value:(this.onChange(this.value),this.emitInterval=setInterval(function(){void 0===t.emitValue?(clearInterval(t.emitInterval),t.emitInterval=void 0):(t.onChange(t.emitValue),t.emitValue=void 0)},this.eventResMs))}}},{key:"updateEnable",value:function(){this.sliderWrapperEl.classList.toggle("slider-wrapper--disabled",!this.isEnabled),(0,$7jh4K.css)(this.sliderWrapperEl,{opacity:this.isEnabled?"":"0.5",pointerEvents:this.isEnabled?"":"none"}),this.manualInput&&this.manualInput.setIsEnabled(this.isEnabled)}},{key:"showManualInput",value:function(){var e=this;this.manualInput=new $068903cd1342554f$export$db3d4fde05db9a5e(this.valueToDisplayValue(this.value),this.valueToDisplayValue(this.min),this.valueToDisplayValue(this.max),this.sliderWrapperEl.getBoundingClientRect(),function(t){t=e.displayValueToValue(t),e.setValue($eWjiX.BB.clamp(t,e.min,e.max)),e.onChange(e.value)},function(){(0,$7jh4K.css)(e.sliderWrapperEl,{display:""}),e.manualInput&&(e.manualInput.getElement().remove(),e.manualInput.destroy()),e.manualInput=void 0},this.manualInputRoundDigits&&this.manualInputRoundDigits>0?this.manualInputRoundDigits:0),this.manualInput.setIsEnabled(this.isEnabled),this.rootEl.append(this.manualInput.getElement()),setTimeout(function(){e.manualInput&&e.manualInput.focus()}),(0,$7jh4K.css)(this.sliderWrapperEl,{display:"none"})}},{key:"changeSliderValue",value:function(e){if(this.isEnabled){var t=this.valueToSliderValue(this.value);t=$eWjiX.BB.clamp(t+e,0,1),this.value=this.sliderValueToValue(t),this.updateLabel(),this.onChange(this.value)}}},{key:"setValue",value:function(e){this.value=$eWjiX.BB.clamp(e,this.min,this.max),this.updateLabel()}},{key:"getValue",value:function(){return this.value}},{key:"getDisplayValue",value:function(){return this.valueToDisplayValue(this.value)}},{key:"update",value:function(e){if(this.min=e.min,this.max=e.max,this.useSpline=!!e.curve,this.useSpline){if(!e.curve)throw Error("curve needs to be set if useSpline true");var t="quadratic"===e.curve?$eWjiX.BB.powerSplineInput(this.min,this.max,.1):e.curve;this.splineInterpolator=new $eWjiX.BB.SplineInterpolator(t)}else this.splineInterpolator=void 0;this.setIsEnabled(!e.isDisabled)}},{key:"setIsEnabled",value:function(e){this.isEnabled=e,this.updateEnable()}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){clearTimeout(this.pointerListenerTimeout),this.pointerListener&&this.pointerListener.destroy(),this.manualInput&&this.manualInput.destroy(),this.emitInterval&&clearInterval(this.emitInterval)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$a77baa3d81294bff$exports={};$a77baa3d81294bff$exports=$parcel$resolve("la7yv");var $bX4ja=parcelRequire("bX4ja"),$72Jv0=parcelRequire("72Jv0"),$7jh4K=parcelRequire("7jh4K");function $075b9fd415bad4ff$var$decomposeElString(e){if(""===e)return{};var t,i,n=[];1===(t=e.split(".")).length?i=(t=t[0].split(",")).shift():(i=t.shift(),t.forEach(function(e,i){if(i===t.length-1){var r=(t=e.split(",")).shift();void 0!==r&&n.push(r)}else n.push(e)}));var r={};return""!==i&&(r.tagName=i),n.length>0&&(r.classes=n),t.length>0&&(r.styles=t),r}function $075b9fd415bad4ff$var$applyStyleNames(e,t){var i={},n={c:function(e){i.color=e[0]},bg:function(e){i.background=e[0]},p:function(e){i.padding=e[0]+"px"},py:function(e){i.paddingTop=e[0]+"px",i.paddingBottom=e[0]+"px"},pt:function(e){i.paddingTop=e[0]+"px"},pr:function(e){i.paddingRight=e[0]+"px"},pb:function(e){i.paddingBottom=e[0]+"px"},pl:function(e){i.paddingLeft=e[0]+"px"},mt:function(e){i.marginTop=e[0]+"px"},mr:function(e){i.marginRight=e[0]+"px"},mb:function(e){i.marginBottom=e[0]+"px"},ml:function(e){i.marginLeft=e[0]+"px"},flex:function(){i.display="flex"},flexCol:function(){i.flexDirection="column"},flexWrap:function(){i.flexWrap="wrap"},gap:function(e){i.gap=e.map(function(e){return e+"px"}).join(" ")},grow:function(){i.flexGrow="1"},justify:function(e){i.justifyContent=e[0]},items:function(e){i.alignItems=e[0]},hidden:function(){i.display="none"},nowrap:function(){i.whiteSpace="nowrap"},abs:function(e){i.position="absolute",i.left=e[0]+"px",i.top=e[1]+"px"},w:function(e){i.width="full"===e[0]?"100%":e[0]+"px"},h:function(e){i.height="full"===e[0]?"100%":e[0]+"px"},minh:function(e){i.minHeight=e[0]+"px"},z:function(e){i.zIndex=e[0]},overflow:function(e){i.overflow=e[0]},pos:function(e){i.position=e[0]},left:function(e){i.left="full"===e[0]?"100%":e[0]+"px"},top:function(e){i.top="full"===e[0]?"100%":e[0]+"px"},right:function(e){i.right="full"===e[0]?"100%":e[0]+"px"},bottom:function(e){i.bottom="full"===e[0]?"100%":e[0]+"px"},size:function(e){i.fontSize=e[0]+"px"},pointer:function(e){i.pointerEvents=e[0]}};t.forEach(function(e){var t=e.split("-");n[t.shift()](t)}),(0,$7jh4K.css)(e,i)}function $075b9fd415bad4ff$export$db3b6bfb95261072(e,t){if(void 0===e)return document.createElement("div");if("string"!=typeof e)return e instanceof HTMLElement||(e=(0,$72Jv0.el)(e)),t&&("string"==typeof t?e.innerHTML=t:(n=e).append.apply(n,(0,$bX4ja._)(t))),e;var i,n,r,a,s=$075b9fd415bad4ff$var$decomposeElString(e),o=document.createElement(null!=(r=s.tagName)?r:"div");return s.classes&&(i=o.classList).add.apply(i,(0,$bX4ja._)(s.classes)),s.styles&&$075b9fd415bad4ff$var$applyStyleNames(o,s.styles),t&&("string"==typeof t?o.innerHTML=t:(a=o).append.apply(a,(0,$bX4ja._)(t))),o}$6796041293c91113$export$9852986a3ec5f6a0="_7-bVqq_table";var $dada52d673c8c4ac$export$cc42e119007cb939=function e(t){"use strict";(0,$cx0mh._)(this,e);var i=function(e,t){var i=(0,$dJPtW.input)({init:n[t],min:0,max:255,type:"number",css:{width:"80px"},callback:function(){""===i.value||0>parseFloat(i.value)||parseFloat(i.value)>255?a.update():(i.value=""+Math.round(parseFloat(i.value)),n[t]=Number(i.value),r.style.background="#"+$eWjiX.BB.ColorConverter.toHexString(n),s.value="#"+$eWjiX.BB.ColorConverter.toHexString(n))}}),a={update:function(){i.value=""+n[t]},destroy:function(){$eWjiX.BB.unsetEventHandler(i,"onchange")},element:$075b9fd415bad4ff$export$db3b6bfb95261072("tr",[$075b9fd415bad4ff$export$db3b6bfb95261072("td,pr-10",e),$075b9fd415bad4ff$export$db3b6bfb95261072("td",[i])])};return a},n=new $eWjiX.BB.RGB(t.color.r,t.color.g,t.color.b),r=$eWjiX.BB.el({css:{width:"20px",height:"20px",marginBottom:"10px",boxShadow:"inset 0 0 0 1px #fff, 0 0 0 1px #000",background:"#"+$eWjiX.BB.ColorConverter.toHexString(n)}}),a=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("mci-hex")}),s=(0,$dJPtW.input)({init:"#"+$eWjiX.BB.ColorConverter.toHexString(n),css:{width:"80px"},callback:function(){var e=$eWjiX.BB.ColorConverter.hexToRGB(s.value);e?n=e:(e=n,s.value="#"+$eWjiX.BB.ColorConverter.toHexString(n)),r.style.background="#"+$eWjiX.BB.ColorConverter.toHexString(e);for(var t=0;t<h.length;t++)h[t].update()}}),o=$eWjiX.BB.el({tagName:"button",content:'<img src="'+$parcel$interopDefault($a77baa3d81294bff$exports)+'" height="20" alt=""/>',title:$8d7403abedf7cefa$export$ce37e184d908d785("mci-copy"),onClick:function(){s.select(),navigator.clipboard.writeText(s.value).then().catch()}}),l=$075b9fd415bad4ff$export$db3b6bfb95261072({css:{display:"flex",alignItems:"center",marginBottom:"15px",flexWrap:"wrap",gap:"5px 10px",maxWidth:"250px"}},[a,$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,items-center,gap-10",[s,o])]);setTimeout(function(){s.focus(),s.select()},0);var h=[i($8d7403abedf7cefa$export$ce37e184d908d785("red"),"r"),i($8d7403abedf7cefa$export$ce37e184d908d785("green"),"g"),i($8d7403abedf7cefa$export$ce37e184d908d785("blue"),"b")],c=$075b9fd415bad4ff$export$db3b6bfb95261072("",[r,l,$075b9fd415bad4ff$export$db3b6bfb95261072("table."+$6796041293c91113$export$9852986a3ec5f6a0,[$075b9fd415bad4ff$export$db3b6bfb95261072("tbody",h.map(function(e){return e.element}))])]);$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("manual-color-input")}</b>`,div:c,autoFocus:!1,clickOnEnter:"Ok",buttons:["Ok","Cancel"],callback:function(e){$eWjiX.BB.destroyEl(o),h.forEach(function(e){return e.destroy()}),h.splice(0,h.length),t.onClose("Ok"===e?$eWjiX.BB.ColorConverter.hexToRGB(s.value):void 0)}})},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$c698add026ba173f$exports={};$c698add026ba173f$exports=$parcel$resolve("cTtMO");var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$7jh4K=parcelRequire("7jh4K"),$6l0gQ=parcelRequire("6l0gQ"),$e3b2ff8d1f8c5253$var$LS_THEME_KEY="klecks-theme",$e3b2ff8d1f8c5253$var$Theme=function(){"use strict";function e(){var t=this;(0,$cx0mh._)(this,e),this.mediaQueryTheme="light",this.theme="light",this.listeners=[],this.mediaQueryTheme=(0,$7jh4K.isDark)()?"dark":"light",(0,$7jh4K.addIsDarkListener)(function(){t.mediaQueryTheme=(0,$7jh4K.isDark)()?"dark":"light",t.updateTheme()}),this.storedTheme=this.readLocalStorage(),addEventListener("storage",function(e){e.key===$e3b2ff8d1f8c5253$var$LS_THEME_KEY&&(t.storedTheme=t.readLocalStorage(),t.updateTheme())}),this.updateTheme()}return(0,$7h4XF._)(e,[{key:"updateTheme",value:function(){var e=this.theme;this.theme=this.storedTheme||this.mediaQueryTheme,this.theme!==e&&(document.body.classList.toggle("kl-theme-dark","dark"===this.theme),this.listeners.forEach(function(e){return e()}))}},{key:"readLocalStorage",value:function(){var e=$6l0gQ.LocalStorage.getItem($e3b2ff8d1f8c5253$var$LS_THEME_KEY);return e&&("string"!=typeof e||["dark","light"].includes(e))||(e=void 0,$6l0gQ.LocalStorage.removeItem($e3b2ff8d1f8c5253$var$LS_THEME_KEY)),e}},{key:"isDark",value:function(){return"dark"===this.theme}},{key:"addIsDarkListener",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"removeIsDarkListener",value:function(e){for(var t=0;t<this.listeners.length;t++)if(this.listeners[t]===e)return void this.listeners.splice(t,1)}},{key:"getMediaQueryTheme",value:function(){return this.mediaQueryTheme}},{key:"getStoredTheme",value:function(){return this.storedTheme}},{key:"setStoredTheme",value:function(e){e?$6l0gQ.LocalStorage.setItem($e3b2ff8d1f8c5253$var$LS_THEME_KEY,e):$6l0gQ.LocalStorage.removeItem($e3b2ff8d1f8c5253$var$LS_THEME_KEY),this.storedTheme=e,this.updateTheme()}}]),e}(),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2=new $e3b2ff8d1f8c5253$var$Theme,$00f785a5ea9e210d$export$e4203cb02d5e5b28=($e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark(),255);function $00f785a5ea9e210d$export$8627e24041b28589(){return{r:$00f785a5ea9e210d$export$e4203cb02d5e5b28,g:$00f785a5ea9e210d$export$e4203cb02d5e5b28,b:$00f785a5ea9e210d$export$e4203cb02d5e5b28}}var $7jh4K=parcelRequire("7jh4K"),$0ebf4eb3a9343b24$export$4e5102252876c5d7=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({className:"kl-color-picker",css:{position:"relative"}}),this.outputDiv=$eWjiX.BB.el({css:{display:"flex",alignItems:"center"}}),this.width=t.width,this.svHeight=t.svHeight,this.height=t.height,this.emitColor=t.onPick,this.onEyedropper=t.onEyedropper,this.primaryColorRgb={r:parseInt(""+t.startValue.r),g:parseInt(""+t.startValue.g),b:parseInt(""+t.startValue.b)},this.primaryColorHsv=$eWjiX.BB.ColorConverter.toHSV(t.startValue),this.secondaryColorRgb={r:$00f785a5ea9e210d$export$e4203cb02d5e5b28,g:$00f785a5ea9e210d$export$e4203cb02d5e5b28,b:$00f785a5ea9e210d$export$e4203cb02d5e5b28},this.secondaryColorHsv=$eWjiX.BB.ColorConverter._RGBtoHSV(this.secondaryColorRgb);var n=$eWjiX.BB.el();this.svGradient=$eWjiX.BB.el({css:{background:"linear-gradient(0deg, #000 0%, rgba(255, 0, 0, 0) 100%), linear-gradient(-90deg, var(--kl-color-picker--hue) 0%, #fff 100%)",width:this.width+"px",height:this.svHeight+"px"}}),n.append(this.svGradient);var r=$eWjiX.BB.el({className:"kl-color-picker__h",css:{overflow:"hidden",position:"relative",width:this.width+"px",height:this.height+"px",cursor:"ew-resize",marginTop:"1px",marginBottom:"1px"}});this.divPreview=$eWjiX.BB.el({className:"kl-color-picker__preview",css:{display:"flex",justifyContent:"space-between",width:2.5*this.height+"px",height:this.height+"px"}}),this.controlH=$eWjiX.BB.el();var a=function(e){var t=new Image;(0,$7jh4K.css)(t,{position:"absolute",left:"0",top:"0",display:"none",pointerEvents:"none"});for(var n=$eWjiX.BB.canvas(i.width,i.height),r=$eWjiX.BB.ctx(n),a=r.createLinearGradient(0,0,i.width,0),s=0;s<1;s+=.01){var o=$eWjiX.BB.ColorConverter.toRGB(new $eWjiX.BB.HSV(360*s,100,100)),l=parseInt(""+o.r).toString(16),h=parseInt(""+o.g).toString(16),c=parseInt(""+o.b).toString(16);1===l.length&&(l="0"+l),1===h.length&&(h="0"+h),1===c.length&&(c="0"+c),a.addColorStop(s,"#"+l+h+c)}r.fillStyle=a,r.fillRect(0,0,i.width,i.height),e.append(t),t.alt="hue",t.src=n.toDataURL("image/png"),t.style.display="block"};this.updateSVCanvas(),this.rootEl.style.width=this.width+"px",this.rootEl.oncontextmenu=function(){return!1},this.SVContainer=$eWjiX.BB.el({className:"kl-color-picker__sv",css:{width:this.width+"px",height:this.svHeight+"px",overflow:"hidden",display:"block",position:"relative",cursor:"crosshair"}}),this.pointerSV=$eWjiX.BB.el({css:{width:"12px",height:"12px",borderRadius:"6px",position:"absolute",pointerEvents:"none",boxShadow:"0px 0px 0 1px #000, inset 0px 0px 0 1px #fff"}}),this.SVContainer.append(n,this.pointerSV),this.updateSVPointer(),this.rootEl.append(this.SVContainer,r),this.outputDiv.append(this.divPreview),(0,$7jh4K.css)(this.controlH,{width:"2px",height:this.height+"px",background:"#000",borderLeft:"1px solid #fff",position:"absolute",top:"0",left:parseInt(""+(this.primaryColorHsv.h/360*this.width-1))+"px"});var s={h:0,s:0,v:0};this.pickerButton=$eWjiX.BB.el({title:$8d7403abedf7cefa$export$ce37e184d908d785("eyedropper")+" [Alt]",className:"color-picker-preview-button",css:{width:"30px",height:"30px",backgroundImage:"url("+$parcel$interopDefault($c698add026ba173f$exports)+")",backgroundRepeat:"no-repeat",backgroundSize:"70%",backgroundPosition:"center"},onClick:function(){i.isPicking?i.setIsEyedropping(!1):(i.pickerButton.classList.remove("color-picker-preview-button-hover"),i.pickerButton.classList.add("color-picker-preview-button-active"),i.isPicking=!0,i.onEyedropper(!0))}}),this.isPicking=!1,new $eWjiX.BB.PointerListener({target:this.pickerButton,onEnterLeave:function(e){i.isPicking||i.pickerButton.classList.toggle("color-picker-preview-button-hover",e)}}),this.divPreview.append(this.pickerButton),this.hexButton=$eWjiX.BB.el({content:"#",className:"color-picker-preview-button",title:$8d7403abedf7cefa$export$ce37e184d908d785("manual-color-input"),css:{height:"100%",width:this.height+"px",lineHeight:this.height+"px",fontSize:.65*this.height+"px"},onClick:function(){new $dada52d673c8c4ac$export$cc42e119007cb939({color:new $eWjiX.BB.RGB(i.primaryColorRgb.r,i.primaryColorRgb.g,i.primaryColorRgb.b),onClose:function(e){e&&(i.setColor(e),i.emitColor(new $eWjiX.BB.RGB(i.primaryColorRgb.r,i.primaryColorRgb.g,i.primaryColorRgb.b)))}})}}),new $eWjiX.BB.PointerListener({target:this.hexButton,onEnterLeave:function(e){i.hexButton.classList.toggle("color-picker-preview-button-hover",e)}}),this.divPreview.append(this.hexButton),this.setColPreview(),setTimeout(function(){a(r),r.append(i.controlH),new $eWjiX.BB.PointerListener({target:n,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&($eWjiX.BB.unfocusAnyInput(),i.SVContainer.classList.toggle("kl-color-picker--active",!0),"left"===e.button?(s.s=e.relX/i.width*100,s.v=100-e.relY/i.svHeight*100,i.primaryColorHsv=new $eWjiX.BB.HSV(i.primaryColorHsv.h,s.s,s.v),i.primaryColorRgb=$eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv),i.updateSVPointer(),i.setColPreview(),i.emitColor($eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv))):(s.s=i.primaryColorHsv.s,s.v=i.primaryColorHsv.v)),"pointermove"===e.type&&["left","right"].includes(e.button||"")){var t=1;"right"===e.button&&(t=.5),s.s+=e.dX/i.width*100*t,s.v-=e.dY/i.svHeight*100*t,i.primaryColorHsv=new $eWjiX.BB.HSV(i.primaryColorHsv.h,s.s,s.v),i.primaryColorRgb=$eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv),i.updateSVPointer(),i.setColPreview(),i.emitColor($eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv))}"pointerup"===e.type&&i.SVContainer.classList.toggle("kl-color-picker--active",!1)}}),new $eWjiX.BB.PointerListener({target:r,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&($eWjiX.BB.unfocusAnyInput(),r.classList.toggle("kl-color-picker--active",!0),"left"===e.button?(s.h=e.relX/i.width*359.99,i.primaryColorHsv=new $eWjiX.BB.HSV(s.h,i.primaryColorHsv.s,i.primaryColorHsv.v),i.primaryColorRgb=$eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv),i.controlH.style.left=Math.round(i.primaryColorHsv.h/359.99*i.width)-1+"px",i.updateSVCanvas(),i.setColPreview(),i.emitColor($eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv))):s.h=i.primaryColorHsv.h),"pointermove"===e.type&&["left","right"].includes(e.button||"")){var t=$16ee6d1163eaf409$export$f8e41e222e32615d(Math.abs(e.pageY-e.downPageY),"right"===e.button);s.h+=e.dX/i.width*359.99*t,"right"===e.button&&(s.h=s.h%359.99,s.h<0&&(s.h+=359.99)),s.h=Math.min(359.99,s.h),i.primaryColorHsv=new $eWjiX.BB.HSV(s.h,i.primaryColorHsv.s,i.primaryColorHsv.v),i.primaryColorRgb=$eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv),i.controlH.style.left=Math.round(i.primaryColorHsv.h/359.99*i.width)-1+"px",i.updateSVCanvas(),i.setColPreview(),i.emitColor($eWjiX.BB.ColorConverter.toRGB(i.primaryColorHsv))}"pointerup"===e.type&&r.classList.toggle("kl-color-picker--active",!1)}})},1),this.secondaryColorBtn=$eWjiX.BB.el({parent:this.outputDiv,title:$8d7403abedf7cefa$export$ce37e184d908d785("secondary-color")+" [X]",className:"kl-color-picker__secondary",css:{cursor:"pointer",marginLeft:"5px",width:"22px",height:"22px"},onClick:function(e){e.preventDefault(),i.swapColors()}}),this.updateSecondaryColor()}return(0,$7h4XF._)(e,[{key:"updatePrimaryHSV",value:function(e){0===e.s?this.primaryColorHsv=new $eWjiX.BB.HSV(this.primaryColorHsv.h,e.s,e.v):this.primaryColorHsv=new $eWjiX.BB.HSV(e.h,e.s,e.v)}},{key:"updateSVCanvas",value:function(){var e=$eWjiX.BB.ColorConverter.toRGB(new $eWjiX.BB.HSV(this.primaryColorHsv.h,100,100));this.svGradient.style.setProperty("--kl-color-picker--hue","#"+$eWjiX.BB.ColorConverter.toHexString(e))}},{key:"updateSVPointer",value:function(){var e=this.primaryColorHsv.s/100*this.width-7,t=(1-this.primaryColorHsv.v/100)*this.svHeight-6;(0,$7jh4K.css)(this.pointerSV,{left:e+"px",top:t+"px"})}},{key:"setColPreview",value:function(){this.divPreview.style.backgroundColor="rgb("+this.primaryColorRgb.r+","+this.primaryColorRgb.g+","+this.primaryColorRgb.b+")",$eWjiX.BB.testIsWhiteBestContrast(this.primaryColorRgb)?((0,$7jh4K.css)(this.pickerButton,{filter:"invert(1)"}),(0,$7jh4K.css)(this.hexButton,{filter:"invert(1)"})):((0,$7jh4K.css)(this.pickerButton,{filter:""}),(0,$7jh4K.css)(this.hexButton,{filter:""}))}},{key:"updateSecondaryColor",value:function(){this.secondaryColorBtn.style.backgroundColor=$eWjiX.BB.ColorConverter.toRgbStr(this.secondaryColorRgb)}},{key:"setColor",value:function(e){this.primaryColorRgb={r:parseInt(""+e.r),g:parseInt(""+e.g),b:parseInt(""+e.b)},this.updatePrimaryHSV($eWjiX.BB.ColorConverter.toHSV(e)),this.controlH.style.left=parseInt(""+(this.primaryColorHsv.h/359*this.width-1))+"px",this.updateSVCanvas(),this.updateSVPointer(),this.setColPreview()}},{key:"getColor",value:function(){return new $eWjiX.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b)}},{key:"getSecondaryRGB",value:function(){return new $eWjiX.BB.RGB(this.secondaryColorRgb.r,this.secondaryColorRgb.g,this.secondaryColorRgb.b)}},{key:"getIsEyedropping",value:function(){return this.isPicking}},{key:"setIsEyedropping",value:function(e){e?(this.isPicking=!0,this.onEyedropper(!0),this.pickerButton.classList.add("color-picker-preview-button-active")):(this.isPicking=!1,this.onEyedropper(!1),this.pickerButton.classList.remove("color-picker-preview-button-active"))}},{key:"enable",value:function(e){var t={pointerEvents:e?"":"none",opacity:e?"1":"0.5"};(0,$7jh4K.css)(this.rootEl,t),(0,$7jh4K.css)(this.outputDiv,t)}},{key:"setHeight",value:function(e){(e=parseInt(""+(e-2*this.height-3),10))!==this.svHeight&&(this.svHeight=e,(0,$7jh4K.css)(this.svGradient,{width:this.width+"px",height:this.svHeight+"px"}),this.SVContainer.style.height=this.svHeight+"px",this.updateSVPointer())}},{key:"swapColors",value:function(){var e=this.secondaryColorHsv;this.secondaryColorHsv=this.primaryColorHsv,this.updatePrimaryHSV(e),e=this.secondaryColorRgb,this.secondaryColorRgb=this.primaryColorRgb,this.primaryColorRgb=e,this.controlH.style.left=parseInt(""+(this.primaryColorHsv.h/359*this.width-1))+"px",this.updateSVCanvas(),this.updateSVPointer(),this.setColPreview(),this.updateSecondaryColor(),this.emitColor(new $eWjiX.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b))}},{key:"getElement",value:function(){return this.rootEl}},{key:"getOutputElement",value:function(){return this.outputDiv}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$3ce0af1e789f1ab4$export$66306bf21a9ff39e=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:{width:t.width+"px",position:"relative",overflow:"hidden",userSelect:"none"}}),this.rootEl.oncontextmenu=function(e){e.preventDefault()},this.color=$eWjiX.BB.ColorConverter.toHSV(new $eWjiX.BB.RGB(t.color.r,t.color.g,t.color.b)),this.width=t.width,this.heightSV=t.heightSV,this.canvasSV=$eWjiX.BB.canvas(10,10),(0,$7jh4K.css)(this.canvasSV,{width:this.width+"px",height:this.heightSV+"px",cursor:"crosshair"}),this.updateSV();var n=$eWjiX.BB.canvas(t.width,t.heightH);n.style.cursor="ew-resize",function(){for(var e=$eWjiX.BB.ctx(n),i=e.createLinearGradient(0,0,t.width,0),r=0;r<1;r+=.01){var a=$eWjiX.BB.ColorConverter.toRGB(new $eWjiX.BB.HSV(360*r,100,100));i.addColorStop(r,"rgba("+parseInt(""+a.r)+", "+parseInt(""+a.g)+", "+parseInt(""+a.b)+", 1)")}e.fillStyle=i,e.fillRect(0,0,t.width,t.heightH)}(),(0,$7jh4K.css)(this.canvasSV,{width:t.width+"px",height:t.heightSV+"px",overflow:"hidden",position:"relative"}),this.canvasSV.style.cssFloat="left",n.style.cssFloat="left",this.rootEl.append(this.canvasSV,n),this.pointerSV=$eWjiX.BB.el({parent:this.rootEl,css:{width:"8px",height:"8px",borderRadius:"8px",position:"absolute",pointerEvents:"none",boxShadow:"0 0 0 1px #000, inset 0 0 0 1px #fff"}}),this.pointerH=$eWjiX.BB.el({parent:this.rootEl,css:{width:"0",height:t.heightH+"px",borderLeft:"1px solid #fff",borderRight:"1px solid #000",position:"absolute",top:t.heightSV+"px",pointerEvents:"none"}}),this.updateSVPointer(),this.updateHPointer();var r={h:0,s:0,v:0};this.svPointerId=null,this.svPointerListener=new $eWjiX.BB.PointerListener({target:this.canvasSV,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&($eWjiX.BB.unfocusAnyInput(),i.svPointerId=e.pointerId,"left"===e.button?(r.s=e.relX/t.width*100,r.v=100-e.relY/t.heightSV*100,i.color=new $eWjiX.BB.HSV(i.color.h,r.s,r.v),i.updateSVPointer(),t.callback($eWjiX.BB.ColorConverter.toRGB(i.color))):(r.s=i.color.s,r.v=i.color.v)),"pointermove"===e.type&&["left","right"].includes(""+e.button)&&i.svPointerId===e.pointerId){var n=1;"right"===e.button&&(n=.5),r.s+=e.dX/t.width*100*n,r.v-=e.dY/t.heightSV*100*n,i.color=new $eWjiX.BB.HSV(i.color.h,r.s,r.v),i.updateSVPointer(),t.callback($eWjiX.BB.ColorConverter.toRGB(i.color))}"pointerup"===e.type&&(i.svPointerId=null)}}),this.hPointerId=null,this.hPointerListener=new $eWjiX.BB.PointerListener({target:n,fixScribble:!0,onPointer:function(e){if("pointerdown"===e.type&&(i.hPointerId=e.pointerId,"left"===e.button?(r.h=e.relX/t.width*359.99,i.color=new $eWjiX.BB.HSV(r.h,i.color.s,i.color.v),i.updateSV(),i.updateHPointer(),t.callback($eWjiX.BB.ColorConverter.toRGB(i.color))):r.h=i.color.h),"pointermove"===e.type&&["left","right"].includes(""+e.button)&&i.hPointerId===e.pointerId){var n=$16ee6d1163eaf409$export$f8e41e222e32615d(Math.abs(e.pageY-e.downPageY),"right"===e.button);r.h+=e.dX/t.width*359.99*n,"right"===e.button&&(r.h=r.h%359.99,r.h<0&&(r.h+=359.99)),r.h=Math.min(359.99,r.h),i.color=new $eWjiX.BB.HSV(r.h,i.color.s,i.color.v),i.updateSV(),i.updateHPointer(),t.callback($eWjiX.BB.ColorConverter.toRGB(i.color))}"pointerup"===e.type&&(i.hPointerId=null)}}),$eWjiX.BB.el({parent:this.rootEl,css:{clear:"both"}})}return(0,$7h4XF._)(e,[{key:"updateSV",value:function(){var e=$eWjiX.BB.ctx(this.canvasSV);if(!e)throw Error("couldn't create canvas");for(var t=0;t<this.canvasSV.height;t+=1){var i=e.createLinearGradient(0,0,this.canvasSV.width,0),n=$eWjiX.BB.ColorConverter.toRGB(new $eWjiX.BB.HSV(this.color.h,1,100-t/this.canvasSV.height*100)),r=$eWjiX.BB.ColorConverter.toRGB(new $eWjiX.BB.HSV(this.color.h,100,100-t/this.canvasSV.height*100));i.addColorStop(0,"#"+$eWjiX.BB.ColorConverter.toHexString(n)),i.addColorStop(1,"#"+$eWjiX.BB.ColorConverter.toHexString(r)),e.fillStyle="#ff0000",e.fillStyle=i,e.fillRect(0,t,this.canvasSV.width,1)}}},{key:"updateSVPointer",value:function(){var e=this.color.s/100*this.width-4,t=(1-this.color.v/100)*this.heightSV-4;(0,$7jh4K.css)(this.pointerSV,{left:e+"px",top:t+"px"})}},{key:"updateHPointer",value:function(){this.pointerH.style.left=this.color.h/359.999*this.width-1+"px"}},{key:"setColor",value:function(e){null===this.hPointerId&&null===this.svPointerId&&(this.color=$eWjiX.BB.ColorConverter.toHSV(new $eWjiX.BB.RGB(e.r,e.g,e.b)),this.updateSV(),this.updateSVPointer(),this.updateHPointer())}},{key:"getColor",value:function(){return $eWjiX.BB.ColorConverter.toRGB(this.color)}},{key:"getElement",value:function(){return this.rootEl}},{key:"end",value:function(){this.svPointerId=null,this.hPointerId=null}},{key:"destroy",value:function(){this.svPointerListener.destroy(),this.hPointerListener.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$5e81242a941997c7$export$ac00cea56cec3037=function(){"use strict";function e(t){var i,n,r,a=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:{position:"relative"}}),$eWjiX.BB.el({parent:this.rootEl,className:"kl-point-slider__line",css:{marginTop:parseInt(""+(t.pointSize/2-1))+"px",width:t.width+"px"}}),this.sliderPoint=$eWjiX.BB.el({parent:this.rootEl,className:"kl-point-slider__point"});var s=!1;$eWjiX.BB.el({parent:this.sliderPoint,css:{margin:"-7px 0 0 -7px",width:"calc(100% + 14px)",height:"calc(100% + 7px)"}});var o=function(){(0,$7jh4K.css)(a.sliderPoint,{left:i+"px"})},l=function(){return i/(t.width-t.pointSize)};i=$eWjiX.BB.clamp(t.init*(t.width-t.pointSize),0,t.width-t.pointSize),(0,$7jh4K.css)(this.sliderPoint,{width:t.pointSize+"px",height:t.pointSize+"px",borderRadius:t.pointSize+"px"}),o(),this.pointerListener=new $eWjiX.BB.PointerListener({target:this.sliderPoint,fixScribble:!0,onPointer:function(e){"pointerdown"===e.type&&"left"===e.button?(n=!0,s=!0,r=i,o(),e.eventStopPropagation()):"pointermove"===e.type&&"left"===e.button&&(e.eventStopPropagation(),r+=e.dX,i=parseInt(""+$eWjiX.BB.clamp(r,0,t.width-t.pointSize)),o(),t.callback(l(),n,!1),n=!1),"pointerup"===e.type&&(e.eventStopPropagation(),s=!1,o(),t.callback(l(),!1,!0))}})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"setActive",value:function(e){this.sliderPoint.style.backgroundColor=e?"#fff":"#eaeaea"}},{key:"destroy",value:function(){this.pointerListener.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX"),$dJ1E2=parcelRequire("dJ1E2"),$4db8cbbb01889095$export$24ba9b81662d4366=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.colorArr=[],this.selectedIndex=0,this.rootEl=$eWjiX.BB.el({content:t.label?t.label:"",title:null!=(i=t.title)?i:void 0,css:(0,$cL71g._)({display:"flex",alignItems:"center",gap:"7px",position:"relative"},t.css)}),this.buttonArr=[];var r=22;this.onColorInputChange=function(){var e=n.selectedIndex,i=n.colorArr[e];if(i&&!(i.a<1)){var r=n.colorInput.value;n.buttonArr[n.selectedIndex].el.style.backgroundColor=r,n.colorArr[e]=(0,$4EWN2._)((0,$cL71g._)({},$dJ1E2.ColorConverter.hexToRGB(r)),{a:1}),t.onChange(n.colorArr[e])}},this.colorInput=$eWjiX.BB.el({tagName:"input",custom:{type:"color",tabIndex:"-1"}}),this.colorInput.onchange=this.onColorInputChange,this.colorInput.oninput=this.onColorInputChange;for(var a=0;a<t.colorArr.length;a++){for(var s=t.colorArr[a],o=!1,l=0;l<this.colorArr.length;l++){var h=this.colorArr[l];if(h===s||null!==h&&null!==s&&h.r===s.r&&h.g===s.g&&h.b===s.b&&h.a===s.a){o=!0;break}}!o&&(this.colorArr.push(s),"initialIndex"in t&&t.initialIndex===a&&(this.selectedIndex=this.colorArr.length-1))}for(var c=0;c<this.colorArr.length;c++)!function(e){var i=n.colorArr[e],a=$eWjiX.BB.el({parent:n.rootEl,content:i?"":"X",className:"kl-color-option",css:{width:r+"px",height:r+"px",backgroundColor:i?$eWjiX.BB.ColorConverter.toRgbaStr(i):"transparent",lineHeight:r+1+"px"},onClick:function(r){if(n.selectedIndex===e){i&&1===i.a&&(n.colorInput.showPicker?n.colorInput.showPicker():n.colorInput.click());return}r.preventDefault(),n.selectedIndex=e,u(),t.onChange(n.colorArr[e])}});i&&0===i.a&&(a.style.background="var(--kl-checkerboard-background)");var s=function(e){a.classList.toggle("kl-color-option--active",e)};n.buttonArr.push({el:a,setIsSelected:s})}(c);this.rootEl.append($075b9fd415bad4ff$export$db3b6bfb95261072(",w-0,h-0,overflow-hidden,abs-0-0",[this.colorInput]));var u=function(){for(var e=0;e<n.buttonArr.length;e++)n.buttonArr[e].setIsSelected(e===n.selectedIndex)};u()}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getValue",value:function(){return this.colorArr[this.selectedIndex]}},{key:"destroy",value:function(){this.rootEl.remove(),this.buttonArr.forEach(function(e){$eWjiX.BB.destroyEl(e.el)}),this.buttonArr.splice(0,this.buttonArr.length),this.colorInput.onchange=null,this.colorInput.oninput=null}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$7960d0c50ff12b0d$export$c019608e5b5bb4cb=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:t.css});var n=$eWjiX.BB.el({parent:this.rootEl,className:"kl-option-wrapper",css:{display:"flex",flexDirection:t.isColumn?"column":"row"}});t.onChange&&(this.onChange=t.onChange),this.optionArr=[],this.selectedId="initialId"in t&&void 0!==t.initId?t.initId:t.optionArr[0].id;for(var r=function(e){var r=["kl-option"];t.isSmall&&r.push("kl-option--small"),"string"!=typeof e.label&&(r.push("kl-option--custom-el"),(0,$7jh4K.css)(e.label,{display:"block",pointerEvents:"none"}));var a={id:e.id,el:$eWjiX.BB.el({parent:n,content:e.label,className:r.join(" "),onClick:function(){i.selectedId!==a.id&&(!t.onBeforeChange||t.onBeforeChange(a.id))&&(i.selectedId=a.id,i.update(),i.onChange&&i.onChange(i.selectedId))},css:t.optionCss})};e.title&&(a.el.title=e.title),i.optionArr.push(a)},a=0;a<t.optionArr.length;a++)r(t.optionArr[a]);this.update(),t.changeOnInit&&setTimeout(function(){i.onChange&&i.onChange(i.selectedId)},0)}return(0,$7h4XF._)(e,[{key:"getIndex",value:function(){for(var e=0;e<this.optionArr.length;e++)if(this.optionArr[e].id===this.selectedId)return e;return -1}},{key:"update",value:function(){for(var e=0;e<this.optionArr.length;e++)this.optionArr[e].el.classList.toggle("kl-option-selected",this.optionArr[e].id===this.selectedId)}},{key:"getElement",value:function(){return this.rootEl}},{key:"getValue",value:function(){return this.selectedId}},{key:"next",value:function(){this.selectedId=this.optionArr[(this.getIndex()+1)%this.optionArr.length].id,this.update(),this.onChange&&this.onChange(this.selectedId)}},{key:"setValue",value:function(e,t){this.selectedId!==e&&(this.selectedId=e,this.update(),!t&&this.onChange&&this.onChange(this.selectedId))}},{key:"previous",value:function(){this.selectedId=this.optionArr[(this.optionArr.length+this.getIndex()-1)%this.optionArr.length].id,this.update(),this.onChange&&this.onChange(this.selectedId)}},{key:"destroy",value:function(){this.rootEl.remove(),this.optionArr.forEach(function(e){$eWjiX.BB.destroyEl(e.el)}),this.optionArr.splice(0,this.optionArr.length)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$ad47d2e0edfb40c7$exports={};$ad47d2e0edfb40c7$exports=$parcel$resolve("iQ1f0");var $7jh4K=parcelRequire("7jh4K"),$c1a93a3cd82636c9$export$5ee0af1d5c87e856=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.isWide=!1,this.uiState="right",this.el=$eWjiX.BB.el({className:"top-overlay g-root",onClick:$eWjiX.BB.handleClick}),this.updateUiState(),this.innerEl=$eWjiX.BB.el({className:"top-overlay--inner"}),this.angleIm=new Image,this.angleIm.src=$parcel$interopDefault($ad47d2e0edfb40c7$exports),(0,$7jh4K.css)(this.angleIm,{verticalAlign:"bottom",width:"20px",height:"20px",marginLeft:"5px",borderRadius:"10px"}),this.innerInnerEl=document.createElement("div"),this.innerInnerEl.style.display="inline-block",this.innerEl.append(this.innerInnerEl,this.angleIm),this.el.append(this.innerEl),document.body.append(this.el),this.el.style.display="none"}return(0,$7h4XF._)(e,[{key:"updateUiState",value:function(){"left"===this.uiState?this.el.style.left="271px":this.el.style.removeProperty("left")}},{key:"setWide",value:function(e){this.isWide=e,this.el&&(this.isWide?(this.el.style.width="100%",this.el.style.left=""):(this.el.style.removeProperty("width"),this.el.style.left="left"===this.uiState?"271px":""))}},{key:"setUiState",value:function(e){this.uiState=e,this.updateUiState()}},{key:"out",value:function(e,t){var i=this;"string"==typeof e?(this.angleIm.style.display="none",this.innerInnerEl.style.removeProperty("font-family"),this.innerInnerEl.innerHTML=e):"transform"===e.type?(this.angleIm.style.display="inline-block",this.angleIm.style.transform="rotate("+e.angleDeg+"deg)",e.angleDeg%90==0?this.angleIm.style.boxShadow="inset 0 0 0 1px rgba(255, 255, 255, 0.7)":this.angleIm.style.boxShadow="",this.innerInnerEl.style.fontFamily="monospace",this.innerInnerEl.innerHTML=Math.round(100*e.scale)+"%"):this.angleIm.style.display="none",t&&(this.innerEl.style.animation="",setTimeout(function(){return i.innerEl.style.animation="topOverlayPulse 0.5s ease-out"},20),clearTimeout(this.timeout3),this.timeout3=setTimeout(function(){return i.innerEl.style.animation=""},520)),clearTimeout(this.timeout),clearTimeout(this.timeout2),this.el.style.animationName=t?"consoleInFast":"consoleIn",this.el.style.opacity="1",this.timeout=setTimeout(function(){i.el.style.opacity="0",i.el.style.animationName="consoleOut",i.timeout2=setTimeout(function(){i.el.style.display="none"},450)},1200),this.el.style.display="flex"}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$bX4ja=parcelRequire("bX4ja"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$kDVZW=parcelRequire("kDVZW");parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$1RMPr=parcelRequire("1RMPr"),$kFecW=parcelRequire("kFecW"),$kr2fR=parcelRequire("kr2fR");function $92816524e1b72be4$export$ad1d215dd03fe75a(e){var t="scale"in e?e.scale:e.scaleX,i="scale"in e?e.scale:e.scaleY;return(0,$dZ59l.compose)((0,$kr2fR.translate)(e.x,e.y),(0,$1RMPr.rotate)(e.angleDeg/180*Math.PI),(0,$kFecW.scale)(t,i))}function $c9ab5bbe74e01c89$export$2b60e7dafdbde18a(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$gWfkn=parcelRequire("gWfkn"),$41bd6edeccc713f6$export$40257b1b753712da=!1,$41bd6edeccc713f6$var$DebugRender=function(){"use strict";function e(){if((0,$cx0mh._)(this,e),this.internalRenderFuncs=[],this.renderFuncs=[],$41bd6edeccc713f6$export$40257b1b753712da){var t=$eWjiX.BB.createCheckerCanvas(256,!1),i=(0,$7jh4K.throwIfNull)($eWjiX.BB.ctx($eWjiX.BB.canvas($gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE)).createPattern(t,"repeat"));this.internalRenderFuncs.push(function(e,t,n){e.fillStyle=i,e.globalAlpha=.2,e.fillRect(0,0,t,n)})}}return(0,$7h4XF._)(e,[{key:"render",value:function(e,t,i,n){this.internalRenderFuncs.forEach(function(r){e.save(),r(e,t,i,n),e.restore()}),this.renderFuncs.forEach(function(r){e.save(),r(e,t,i,n),e.restore()})}},{key:"add",value:function(e){this.renderFuncs.push(e)}},{key:"remove",value:function(e){for(var t=0;t<this.renderFuncs.length;t++)if(this.renderFuncs[t]===e)return void this.renderFuncs.splice(t,1)}},{key:"clear",value:function(){this.renderFuncs=[]}}]),e}(),$41bd6edeccc713f6$export$7bf40fdf7bf55821=new $41bd6edeccc713f6$var$DebugRender;function $ee6e64f1b33d2735$var$fixScale(e,t){return Math.round(t*e)/t}var $ee6e64f1b33d2735$export$a140ed60c2ca052c=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.doResize=!0,this.onIsDark=function(){n.pattern=(0,$7jh4K.throwIfNull)(n.ctx.createPattern($eWjiX.BB.createCheckerCanvas(10,$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark()),"repeat")),n.render()},this.oldDPR=devicePixelRatio,this.resizeListener=function(){n.oldDPR=devicePixelRatio},this.width=t.width,this.height=t.height,this.project=t.project,this.useNativeResolution=!!t.useNativeResolution,this.drawBackground=null==(i=t.drawBackground)||i,this.doFillParent=!!t.fillParent,this.renderAfter=t.renderAfter,this.transform=(0,$cL71g._)({},t.transform),this.resFactor=this.useNativeResolution?devicePixelRatio:1,this.canvas=$eWjiX.BB.canvas(this.width*this.resFactor,this.height*this.resFactor),this.ctx=$eWjiX.BB.ctx(this.canvas),(0,$7jh4K.css)(this.canvas,{width:this.doFillParent?"100%":this.width+"px",height:this.doFillParent?"100%":this.height+"px",display:"block"}),window.addEventListener("resize",this.resizeListener),this.pattern=(0,$7jh4K.throwIfNull)(this.ctx.createPattern($eWjiX.BB.createCheckerCanvas(10,$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark()),"repeat")),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.addIsDarkListener(this.onIsDark)}return(0,$7h4XF._)(e,[{key:"render",value:function(e){var t,i,n=this,r=$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark(),a=(0,$4EWN2._)((0,$cL71g._)({},this.transform),{x:this.transform.x,y:this.transform.y,scale:this.transform.scale});this.doResize&&(this.doResize=!1,this.resFactor=this.useNativeResolution?devicePixelRatio:1,this.canvas.width=Math.round(this.width*this.resFactor),this.canvas.height=Math.round(this.height*this.resFactor));var s=e?{x:a.x,y:a.y,angleDeg:a.angleDeg,scaleX:a.scale,scaleY:a.scale}:{x:Math.round(a.x),y:Math.round(a.y),scaleX:$ee6e64f1b33d2735$var$fixScale(a.scale,this.project.width),scaleY:$ee6e64f1b33d2735$var$fixScale(a.scale,this.project.height),angleDeg:a.angleDeg},o=$92816524e1b72be4$export$ad1d215dd03fe75a(s);if(this.ctx.save(),s.scaleX>=10?this.ctx.imageSmoothingEnabled=!1:(this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high"),this.drawBackground?(this.ctx.fillStyle=r?"rgb(33, 33, 33)":"rgb(158,158,158)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):(this.ctx.fillStyle=this.pattern,this.ctx.fillRect(0,0,this.width,this.height)),this.ctx.translate(s.x,s.y),this.ctx.scale(s.scaleX,s.scaleY),this.ctx.rotate(s.angleDeg/180*Math.PI),this.drawBackground){this.ctx.save(),this.ctx.fillStyle=$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark()?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)";var l=1/s.scaleX,h=1/s.scaleY;this.ctx.fillRect(-l,-h,this.project.width+2*l,this.project.height+2*h),this.ctx.fillStyle=this.pattern;try{this.pattern.setTransform((0,$kDVZW.inverse)(o))}catch(e){}this.ctx.fillRect(0,0,this.project.width,this.project.height),this.ctx.restore()}this.project.layers.forEach(function(e){if(e.isVisible&&e.opacity){if(n.ctx.save(),n.ctx.globalCompositeOperation=e.mixModeStr,n.ctx.globalAlpha=e.opacity,"function"==typeof e.image){var t,i,r=e.image(s,n.canvas.width,n.canvas.height);"image"in r&&"transform"in r?(t=r.image,(i=n.ctx).setTransform.apply(i,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a((0,$dZ59l.compose)(o,r.transform))))):t=r}else t=e.image;n.ctx.drawImage(t,0,0),n.ctx.restore()}}),null==(t=(i=this).renderAfter)||t.call(i,this.ctx,s),$41bd6edeccc713f6$export$40257b1b753712da&&$41bd6edeccc713f6$export$7bf40fdf7bf55821.render(this.ctx,this.project.width,this.project.height,s.scaleX),this.ctx.restore()}},{key:"setSize",value:function(e,t){this.doResize=!0,this.width=e,this.height=t,(0,$7jh4K.css)(this.canvas,{width:this.doFillParent?"100%":this.width+"px",height:this.doFillParent?"100%":this.height+"px"})}},{key:"setTransform",value:function(e){this.transform=(0,$cL71g._)({},e)}},{key:"setProject",value:function(e){this.project=e}},{key:"getTransform",value:function(){return(0,$cL71g._)({},this.transform)}},{key:"setUseNativeResolution",value:function(e){this.useNativeResolution=e,this.doResize=!0}},{key:"getUseNativeResolution",value:function(){return this.useNativeResolution}},{key:"getElement",value:function(){return this.canvas}},{key:"destroy",value:function(){$eWjiX.BB.freeCanvas(this.canvas),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.removeIsDarkListener(this.onIsDark),window.removeEventListener("resize",this.resizeListener)}}]),e}(),$eWjiX=parcelRequire("eWjiX"),$04lDo=parcelRequire("04lDo"),$c88da6b7fdef67e7$exports={};$c88da6b7fdef67e7$exports=$parcel$resolve("04ZZm");var $e503dd0072d83d49$exports={};$e503dd0072d83d49$exports=$parcel$resolve("j9xio");var $f121c15402c4c25f$exports={};$f121c15402c4c25f$exports=$parcel$resolve("fER1z");var $ec1da9254c8485a7$exports={};$ec1da9254c8485a7$exports=$parcel$resolve("2gZH2");var $0a0c8fa06baa05ba$exports={};$0a0c8fa06baa05ba$exports=$parcel$resolve("ghFv7");var $gCzYB=parcelRequire("gCzYB"),$c1lmK=parcelRequire("c1lmK");function $6ac4ab2dc9a117c8$export$8c03162b1a39d183(e,t){var i=Math.log2(e)/Math.abs(t);return i+=t>0?1:-1,Math.pow(2,i=Math.round(i)*Math.abs(t))}$8df31a3769a54937$export$77aefb1076e6c10f="VFEAZq_kl-theme-dark",$8df31a3769a54937$export$48c2d0f2f545ac27="VFEAZq_preview",$8df31a3769a54937$export$d7b7311ec04a3e8f="VFEAZq_viewport";var $joplQ=parcelRequire("joplQ");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$dZ59l=parcelRequire("dZ59l"),$1RMPr=parcelRequire("1RMPr"),$kFecW=parcelRequire("kFecW");function $926e1894e59cf403$export$99c68a89351e15c0(e,t,i,n){var r=(0,$dZ59l.compose)((0,$kFecW.scale)(-i,-i),(0,$1RMPr.rotate)(n/180*Math.PI)),a=(0,$cdZRx.applyToPoint)(r,t);return a.x+=e.x,a.y+=e.y,{x:a.x,y:a.y,scale:i,angleDeg:n}}parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW");function $c4f45fb8696b5286$export$935bc53f7df03c95(e,t){var i=$92816524e1b72be4$export$ad1d215dd03fe75a(e),n=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),t);return{viewportP:t,canvasP:n,scale:e.scale,angleDeg:e.angleDeg}}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX");$c08bd94435b4b84a$export$8bb18c96af1baaf3="uIhb5a_blackAnim",$c08bd94435b4b84a$export$eea3e4f737fa39e3="uIhb5a_blackPath",$c08bd94435b4b84a$export$d1eb619e8f7efb22="uIhb5a_whiteAnim",$c08bd94435b4b84a$export$2f48b40a5a83dc1b="uIhb5a_whitePath";var $9b3eo=parcelRequire("9b3eo"),$bbA6w=parcelRequire("bbA6w"),$bX4ja=parcelRequire("bX4ja"),$1627388b93b6ebf7$exports={},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");function $0b0ef140191bcf10$export$7ec1a3fdd6e82838(e,t){for(var i,n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var s=[];try{s=(i=$1627388b93b6ebf7$exports)[e].apply(i,[t].concat((0,$bX4ja._)(r)))}catch(e){}return s}function $396117890b5c76b0$export$f3040a9d9c5d06ba(e){return e.map(function(e){return e.map(function(e){return e.map(function(e){return[Math.round(e[0]+.5)-.5,Math.round(e[1]+.5)-.5]})})})}!function(e,t){$1627388b93b6ebf7$exports=t()}(0,function(){"use strict";function e(e,t){var i,n,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(e){return function(t){return l([e,t])}}function l(a){if(i)throw TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}var t=function(){return function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}}();function i(e,t){return e>t?1:e<t?-1:0}function n(e,i,n){for(var r=new t(null,null),a=r,s=r;;){var o=n(e,i.key);if(o<0){if(null===i.left)break;if(0>n(e,i.left.key)){var l=i.left;if(i.left=l.right,l.right=i,null===(i=l).left)break}s.left=i,s=i,i=i.left}else if(o>0){if(null===i.right)break;if(n(e,i.right.key)>0){var l=i.right;if(i.right=l.left,l.left=i,null===(i=l).right)break}a.right=i,a=i,i=i.right}else break}return a.right=i.left,s.left=i.right,i.left=r.right,i.right=r.left,i}function r(e,i,r,a){var s=new t(e,i);if(null===r)return s.left=s.right=null,s;r=n(e,r,a);var o=a(e,r.key);return o<0?(s.left=r.left,s.right=r,r.left=null):o>=0&&(s.right=r.right,s.left=r,r.right=null),s}function a(e,t,i){var r=null,a=null;if(t){t=n(e,t,i);var s=i(t.key,e);0===s?(r=t.left,a=t.right):s<0?(a=t.right,t.right=null,r=t):(r=t.left,t.left=null,a=t)}return{left:r,right:a}}function s(e,t,i){return null===t?e:(null===e||((t=n(e.key,t,i)).left=e),t)}function o(e,t,i,n,r){if(e){n(""+t+(i?" ":" ")+r(e)+"\n");var a=t+(i?"    ":"   ");e.left&&o(e.left,a,!1,n,r),e.right&&o(e.right,a,!0,n,r)}}var l=function(){function l(e){void 0===e&&(e=i),this._root=null,this._size=0,this._comparator=e}return l.prototype.insert=function(e,t){return this._size++,this._root=r(e,t,this._root,this._comparator)},l.prototype.add=function(e,i){var r=new t(e,i);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var a=this._comparator,s=n(e,this._root,a),o=a(e,s.key);return 0===o?this._root=s:(o<0?(r.left=s.left,r.right=s,s.left=null):o>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},l.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},l.prototype._remove=function(e,t,i){var r;return null===t?null:(t=n(e,t,i),0===i(e,t.key))?(null===t.left?r=t.right:(r=n(e,t.left,i)).right=t.right,this._size--,r):t},l.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=n(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},l.prototype.findStatic=function(e){for(var t=this._root,i=this._comparator;t;){var n=i(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},l.prototype.find=function(e){return this._root&&(this._root=n(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},l.prototype.contains=function(e){for(var t=this._root,i=this._comparator;t;){var n=i(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},l.prototype.forEach=function(e,t){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),e.call(t,i),i=i.right):r=!0;return this},l.prototype.range=function(e,t,i,n){for(var r=[],a=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(a((s=r.pop()).key,t)>0)break;if(a(s.key,e)>=0&&i.call(n,s))return this;s=s.right}return this},l.prototype.keys=function(){var e=[];return this.forEach(function(t){var i=t.key;return e.push(i)}),e},l.prototype.values=function(){var e=[];return this.forEach(function(t){var i=t.data;return e.push(i)}),e},l.prototype.min=function(){return this._root?this.minNode(this._root).key:null},l.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},l.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},l.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},l.prototype.at=function(e){for(var t=this._root,i=!1,n=0,r=[];!i;)if(t)r.push(t),t=t.left;else if(r.length>0){if(t=r.pop(),n===e)return t;n++,t=t.right}else i=!0;return null},l.prototype.next=function(e){var t=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var n=this._comparator;t;){var r=n(e.key,t.key);if(0===r)break;r<0?(i=t,t=t.left):t=t.right}return i},l.prototype.prev=function(e){var t=this._root,i=null;if(null!==e.left){for(i=e.left;i.right;)i=i.right;return i}for(var n=this._comparator;t;){var r=n(e.key,t.key);if(0===r)break;r<0?t=t.left:(i=t,t=t.right)}return i},l.prototype.clear=function(){return this._root=null,this._size=0,this},l.prototype.toList=function(){return u(this._root)},l.prototype.load=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i=!1);var n=e.length,r=this._comparator;if(i&&f(e,t,0,n-1,r),null===this._root)this._root=h(e,t,0,n),this._size=n;else{var a=p(this.toList(),c(e,t),r);n=this._size+n,this._root=d({head:a},0,n)}return this},l.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(l.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),l.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return o(this._root,"",!0,function(e){return t.push(e)},e),t.join("")},l.prototype.update=function(e,t,i){var n=this._comparator,o=a(e,this._root,n),l=o.left,h=o.right;0>n(e,t)?h=r(t,i,h,n):l=r(t,i,l,n),this._root=s(l,h,n)},l.prototype.split=function(e){return a(e,this._root,this._comparator)},l.prototype[Symbol.iterator]=function(){var t,i,n;return e(this,function(e){switch(e.label){case 0:t=this._root,i=[],n=!1,e.label=1;case 1:if(n)return[3,6];if(null===t)return[3,2];return i.push(t),t=t.left,[3,5];case 2:if(0===i.length)return[3,4];return[4,t=i.pop()];case 3:return e.sent(),t=t.right,[3,5];case 4:n=!0,e.label=5;case 5:return[3,1];case 6:return[2]}})},l}();function h(e,i,n,r){var a=r-n;if(a>0){var s=n+Math.floor(a/2),o=new t(e[s],i[s]);return o.left=h(e,i,n,s),o.right=h(e,i,s+1,r),o}return null}function c(e,i){for(var n=new t(null,null),r=n,a=0;a<e.length;a++)r=r.next=new t(e[a],i[a]);return r.next=null,n.next}function u(e){for(var i=e,n=[],r=!1,a=new t(null,null),s=a;!r;)i?(n.push(i),i=i.left):n.length>0?i=(i=s=s.next=n.pop()).right:r=!0;return s.next=null,a.next}function d(e,t,i){var n=i-t;if(n>0){var r=t+Math.floor(n/2),a=d(e,t,r),s=e.head;return s.left=a,e.head=e.head.next,s.right=d(e,r+1,i),s}return null}function p(e,i,n){for(var r=new t(null,null),a=r,s=e,o=i;null!==s&&null!==o;)0>n(s.key,o.key)?(a.next=s,s=s.next):(a.next=o,o=o.next),a=a.next;return null!==s?a.next=s:null!==o&&(a.next=o),r.next}function f(e,t,i,n,r){if(!(i>=n)){for(var a=e[i+n>>1],s=i-1,o=n+1;;){do s++;while(0>r(e[s],a))do o--;while(r(e[o],a)>0)if(s>=o)break;var l=e[s];e[s]=e[o],e[o]=l,l=t[s],t[s]=t[o],t[o]=l}f(e,t,i,o,r),f(e,t,o+1,n,r)}}var g=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},v=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var i=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x;return{ll:{x:i,y:e.ll.y<t.ll.y?t.ll.y:e.ll.y},ur:{x:n,y:e.ur.y<t.ur.y?e.ur.y:t.ur.y}}},m=Number.EPSILON;void 0===m&&(m=2220446049250313e-31);var y=m*m,x=function(e,t){if(-m<e&&e<m&&-m<t&&t<m)return 0;var i=e-t;return i*i<y*e*t?0:e<t?-1:1},b=function(){function e(){(0,$cx0mh._)(this,e),this.reset()}return(0,$7h4XF._)(e,[{key:"reset",value:function(){this.xRounder=new w,this.yRounder=new w}},{key:"round",value:function(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}]),e}(),w=function(){function e(){(0,$cx0mh._)(this,e),this.tree=new l,this.round(0)}return(0,$7h4XF._)(e,[{key:"round",value:function(e){var t=this.tree.add(e),i=this.tree.prev(t);if(null!==i&&0===x(t.key,i.key))return this.tree.remove(e),i.key;var n=this.tree.next(t);return null!==n&&0===x(t.key,n.key)?(this.tree.remove(e),n.key):e}}]),e}(),k=new b,B=0x8000001,S=(3+8881784197001252e-31)*11102230246251565e-32;function C(e,t,i,n,r){var a,s,o,l,h=t[0],c=n[0],u=0,d=0;c>h==c>-h?(a=h,h=t[++u]):(a=c,c=n[++d]);var p=0;if(u<e&&d<i)for(c>h==c>-h?(s=h+a,o=a-(s-h),h=t[++u]):(s=c+a,o=a-(s-c),c=n[++d]),a=s,0!==o&&(r[p++]=o);u<e&&d<i;)c>h==c>-h?(l=(s=a+h)-a,o=a-(s-l)+(h-l),h=t[++u]):(l=(s=a+c)-a,o=a-(s-l)+(c-l),c=n[++d]),a=s,0!==o&&(r[p++]=o);for(;u<e;)l=(s=a+h)-a,o=a-(s-l)+(h-l),h=t[++u],a=s,0!==o&&(r[p++]=o);for(;d<i;)l=(s=a+c)-a,o=a-(s-l)+(c-l),c=n[++d],a=s,0!==o&&(r[p++]=o);return(0!==a||0===p)&&(r[p++]=a),p}function E(e,t){for(var i=t[0],n=1;n<e;n++)i+=t[n];return i}function _(e){return new Float64Array(e)}var I=(3+17763568394002505e-31)*11102230246251565e-32,T=(2+13322676295501878e-31)*11102230246251565e-32,M=(9+7105427357601002e-30)*11102230246251565e-32*11102230246251565e-32,L=_(4),R=_(8),P=_(12),A=_(16),D=_(4);function O(e,t,i,n,r,a,s){var o,l,h,c,u,d,p,f,g,v,m,y,x,b,w,k,_,I,O=e-r,z=i-r,H=t-a,j=n-a;b=O*j,p=(d=B*O)-(d-O),f=O-p,g=(d=B*j)-(d-j),w=f*(v=j-g)-(b-p*g-f*g-p*v),k=H*z,p=(d=B*H)-(d-H),f=H-p,g=(d=B*z)-(d-z),m=w-(_=f*(v=z-g)-(k-p*g-f*g-p*v)),u=w-m,L[0]=w-(m+u)+(u-_),u=(y=b+m)-b,m=(x=b-(y-u)+(m-u))-k,u=x-m,L[1]=x-(m+u)+(u-k),u=(I=y+m)-y,L[2]=y-(I-u)+(m-u),L[3]=I;var F=E(4,L),X=T*s;if(F>=X||-F>=X||(u=e-O,o=e-(O+u)+(u-r),u=i-z,h=i-(z+u)+(u-r),u=t-H,l=t-(H+u)+(u-a),u=n-j,c=n-(j+u)+(u-a),0===o&&0===l&&0===h&&0===c)||(X=M*s+S*Math.abs(F),(F+=O*c+j*o-(H*h+z*l))>=X||-F>=X))return F;b=o*j,p=(d=B*o)-(d-o),f=o-p,g=(d=B*j)-(d-j),w=f*(v=j-g)-(b-p*g-f*g-p*v),k=l*z,p=(d=B*l)-(d-l),f=l-p,g=(d=B*z)-(d-z),m=w-(_=f*(v=z-g)-(k-p*g-f*g-p*v)),u=w-m,D[0]=w-(m+u)+(u-_),u=(y=b+m)-b,m=(x=b-(y-u)+(m-u))-k,u=x-m,D[1]=x-(m+u)+(u-k),u=(I=y+m)-y,D[2]=y-(I-u)+(m-u),D[3]=I;var V=C(4,L,4,D,R);b=O*c,p=(d=B*O)-(d-O),f=O-p,g=(d=B*c)-(d-c),w=f*(v=c-g)-(b-p*g-f*g-p*v),k=H*h,p=(d=B*H)-(d-H),f=H-p,g=(d=B*h)-(d-h),m=w-(_=f*(v=h-g)-(k-p*g-f*g-p*v)),u=w-m,D[0]=w-(m+u)+(u-_),u=(y=b+m)-b,m=(x=b-(y-u)+(m-u))-k,u=x-m,D[1]=x-(m+u)+(u-k),u=(I=y+m)-y,D[2]=y-(I-u)+(m-u),D[3]=I;var U=C(V,R,4,D,P);b=o*c,p=(d=B*o)-(d-o),f=o-p,g=(d=B*c)-(d-c),w=f*(v=c-g)-(b-p*g-f*g-p*v),k=l*h,p=(d=B*l)-(d-l),f=l-p,g=(d=B*h)-(d-h),m=w-(_=f*(v=h-g)-(k-p*g-f*g-p*v)),u=w-m,D[0]=w-(m+u)+(u-_),u=(y=b+m)-b,m=(x=b-(y-u)+(m-u))-k,u=x-m,D[1]=x-(m+u)+(u-k),u=(I=y+m)-y,D[2]=y-(I-u)+(m-u),D[3]=I;var W=C(U,P,4,D,A);return A[W-1]}function z(e,t,i,n,r,a){var s=(t-a)*(i-r),o=(e-r)*(n-a),l=s-o,h=Math.abs(s+o);return Math.abs(l)>=I*h?l:-O(e,t,i,n,r,a,h)}var H=function(e,t){return e.x*t.y-e.y*t.x},j=function(e,t){return e.x*t.x+e.y*t.y},F=function(e,t,i){var n=z(e.x,e.y,t.x,t.y,i.x,i.y);return n>0?-1:+(n<0)},X=function(e){return Math.sqrt(j(e,e))},V=function(e,t,i){var n={x:t.x-e.x,y:t.y-e.y},r={x:i.x-e.x,y:i.y-e.y};return H(r,n)/X(r)/X(n)},U=function(e,t,i){var n={x:t.x-e.x,y:t.y-e.y},r={x:i.x-e.x,y:i.y-e.y};return j(r,n)/X(r)/X(n)},W=function(e,t,i){return 0===t.y?null:{x:e.x+t.x/t.y*(i-e.y),y:i}},N=function(e,t,i){return 0===t.x?null:{x:i,y:e.y+t.y/t.x*(i-e.x)}},Y=function(e,t,i,n){if(0===t.x)return N(i,n,e.x);if(0===n.x)return N(e,t,i.x);if(0===t.y)return W(i,n,e.y);if(0===n.y)return W(e,t,i.y);var r=H(t,n);if(0==r)return null;var a={x:i.x-e.x,y:i.y-e.y},s=H(a,t)/r,o=H(a,n)/r;return{x:(e.x+o*t.x+(i.x+s*n.x))/2,y:(e.y+o*t.y+(i.y+s*n.y))/2}},G=function(){function e(t,i){(0,$cx0mh._)(this,e),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=i}return(0,$7h4XF._)(e,[{key:"link",value:function(e){if(e.point===this.point)throw Error("Tried to link already linked events");for(var t=e.point.events,i=0,n=t.length;i<n;i++){var r=t[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,t=0;t<e;t++){var i=this.point.events[t];if(void 0===i.segment.consumedBy)for(var n=t+1;n<e;n++){var r=this.point.events[n];void 0===r.consumedBy&&i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],t=0,i=this.point.events.length;t<i;t++){var n=this.point.events[t];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&e.push(n)}return e}},{key:"getLeftmostComparator",value:function(e){var t=this,i=new Map,n=function(n){var r=n.otherSE;i.set(n,{sine:V(t.point,e.point,r.point),cosine:U(t.point,e.point,r.point)})};return function(e,t){i.has(e)||n(e),i.has(t)||n(t);var r=i.get(e),a=r.sine,s=r.cosine,o=i.get(t),l=o.sine,h=o.cosine;return a>=0&&l>=0?s<h?1:s>h?-1:0:a<0&&l<0?s<h?-1:+(s>h):l<a?-1:+(l>a)}}}],[{key:"compare",value:function(t,i){var n=e.comparePoints(t.point,i.point);return 0!==n?n:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft)?t.isLeft?1:-1:Z.compare(t.segment,i.segment)}},{key:"comparePoints",value:function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:+(e.y>t.y)}}]),e}(),K=0,Z=function(){function e(t,i,n,r){(0,$cx0mh._)(this,e),this.id=++K,this.leftSE=t,t.segment=this,t.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=t,this.rings=n,this.windings=r}return(0,$7h4XF._)(e,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var t=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(t.x===i.x)return e.x===t.x?0:e.x<t.x?1:-1;var r=(e.y-t.y)/n.y,a=t.x+r*n.x;if(e.x===a)return 0;var s=(e.x-t.x)/n.x,o=t.y+s*n.y;return e.y===o?0:e.y<o?-1:1}},{key:"getIntersection",value:function(e){var t=this.bbox(),i=e.bbox(),n=v(t,i);if(null===n)return null;var r=this.leftSE.point,a=this.rightSE.point,s=e.leftSE.point,o=e.rightSE.point,l=g(t,s)&&0===this.comparePoint(s),h=g(i,r)&&0===e.comparePoint(r),c=g(t,o)&&0===this.comparePoint(o),u=g(i,a)&&0===e.comparePoint(a);if(h&&l)return u&&!c?a:!u&&c?o:null;if(h)return c&&r.x===o.x&&r.y===o.y?null:r;if(l)return u&&a.x===s.x&&a.y===s.y?null:s;if(u&&c)return null;if(u)return a;if(c)return o;var d=Y(r,this.vector(),s,e.vector());return null!==d&&g(n,d)?k.round(d.x,d.y):null}},{key:"split",value:function(t){var i=[],n=void 0!==t.events,r=new G(t,!0),a=new G(t,!1),s=this.rightSE;this.replaceRightSE(a),i.push(a),i.push(r);var o=new e(r,s,this.rings.slice(),this.windings.slice());return G.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),G.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),a.checkForConsuming()),i}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var t=0,i=this.windings.length;t<i;t++)this.windings[t]*=-1}},{key:"consume",value:function(t){for(var i=this,n=t;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=e.compare(i,n);if(0!==r){if(r>0){var a=i;i=n,n=a}if(i.prev===n){var s=i;i=n,n=s}for(var o=0,l=n.rings.length;o<l;o++){var h=n.rings[o],c=n.windings[o],u=i.rings.indexOf(h);-1===u?(i.rings.push(h),i.windings.push(c)):i.windings[u]+=c}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var t=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,a=this.rings.length;r<a;r++){var s=this.rings[r],o=this.windings[r],l=t.indexOf(s);-1===l?(t.push(s),i.push(o)):i[l]+=o}for(var h=[],c=[],u=0,d=t.length;u<d;u++)if(0!==i[u]){var p=t[u],f=p.poly;if(-1===c.indexOf(f))if(p.isExterior)h.push(f);else{-1===c.indexOf(f)&&c.push(f);var g=h.indexOf(p.poly);-1!==g&&h.splice(g,1)}}for(var v=0,m=h.length;v<m;v++){var y=h[v].multiPoly;-1===n.indexOf(y)&&n.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var e,t,i=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(ea.type){case"union":var r=0===i.length,a=0===n.length;this._isInResult=r!==a;break;case"intersection":i.length<n.length?(e=i.length,t=n.length):(e=n.length,t=i.length),this._isInResult=t===ea.numMultiPolys&&e<t;break;case"xor":var s=Math.abs(i.length-n.length);this._isInResult=s%2==1;break;case"difference":var o=function(e){return 1===e.length&&e[0].isSubject};this._isInResult=o(i)!==o(n);break;default:throw Error(`Unrecognized operation type found ${ea.type}`)}return this._isInResult}}],[{key:"compare",value:function(e,t){var i=e.leftSE.point.x,n=t.leftSE.point.x,r=e.rightSE.point.x,a=t.rightSE.point.x;if(a<i)return 1;if(r<n)return -1;var s=e.leftSE.point.y,o=t.leftSE.point.y,l=e.rightSE.point.y,h=t.rightSE.point.y;if(i<n){if(o<s&&o<l)return 1;if(o>s&&o>l)return -1;var c=e.comparePoint(t.leftSE.point);if(c<0)return 1;if(c>0)return -1;var u=t.comparePoint(e.rightSE.point);return 0!==u?u:-1}if(i>n){if(s<o&&s<h)return -1;if(s>o&&s>h)return 1;var d=t.comparePoint(e.leftSE.point);if(0!==d)return d;var p=e.comparePoint(t.rightSE.point);return p<0?1:p>0?-1:1}if(s<o)return -1;if(s>o)return 1;if(r<a){var f=t.comparePoint(e.rightSE.point);if(0!==f)return f}if(r>a){var g=e.comparePoint(t.rightSE.point);if(g<0)return 1;if(g>0)return -1}if(r!==a){var v=l-s,m=r-i,y=h-o,x=a-n;if(v>m&&y<x)return 1;if(v<m&&y>x)return -1}return r>a?1:r<a||l<h?-1:l>h?1:e.id<t.id?-1:+(e.id>t.id)}},{key:"fromRing",value:function(t,i,n){var r,a,s,o=G.comparePoints(t,i);if(o<0)r=t,a=i,s=1;else if(o>0)r=i,a=t,s=-1;else throw Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);return new e(new G(r,!0),new G(a,!1),[n],[s])}}]),e}(),q=function(){function e(t,i,n){if((0,$cx0mh._)(this,e),!Array.isArray(t)||0===t.length||(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1]))throw Error("Input geometry is not a valid Polygon or MultiPolygon");var r=k.round(t[0][0],t[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var a=r,s=1,o=t.length;s<o;s++){if("number"!=typeof t[s][0]||"number"!=typeof t[s][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");var l=k.round(t[s][0],t[s][1]);(l.x!==a.x||l.y!==a.y)&&(this.segments.push(Z.fromRing(a,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),a=l)}(r.x!==a.x||r.y!==a.y)&&this.segments.push(Z.fromRing(a,r,this))}return(0,$7h4XF._)(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,i=this.segments.length;t<i;t++){var n=this.segments[t];e.push(n.leftSE),e.push(n.rightSE)}return e}}]),e}(),$=function(){function e(t,i){if((0,$cx0mh._)(this,e),!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new q(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=t.length;n<r;n++){var a=new q(t[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=i}return(0,$7h4XF._)(e,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),t=0,i=this.interiorRings.length;t<i;t++)for(var n=this.interiorRings[t].getSweepEvents(),r=0,a=n.length;r<a;r++)e.push(n[r]);return e}}]),e}(),J=function(){function e(t,i){if((0,$cx0mh._)(this,e),!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(e){}this.polys=[],this.bbox={ll:{x:1/0,y:1/0},ur:{x:-1/0,y:-1/0}};for(var n=0,r=t.length;n<r;n++){var a=new $(t[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=i}return(0,$7h4XF._)(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,i=this.polys.length;t<i;t++)for(var n=this.polys[t].getSweepEvents(),r=0,a=n.length;r<a;r++)e.push(n[r]);return e}}]),e}(),Q=function(){function e(t){(0,$cx0mh._)(this,e),this.events=t;for(var i=0,n=t.length;i<n;i++)t[i].segment.ringOut=this;this.poly=null}return(0,$7h4XF._)(e,[{key:"getGeom",value:function(){for(var e=this.events[0].point,t=[e],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point;0!==F(r,e,this.events[i+1].point)&&(t.push(r),e=r)}if(1===t.length)return null;0===F(t[0],e,t[1])&&t.shift(),t.push(t[0]);for(var a=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:t.length-1,o=this.isExteriorRing()?t.length:-1,l=[],h=s;h!=o;h+=a)l.push([t[h].x,t[h].y]);return l}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],t=1,i=this.events.length;t<i;t++){var n=this.events[t];G.compare(e,n)>0&&(e=n)}for(var r=e.segment.prevInResult(),a=r?r.prevInResult():null;;){if(!r)return null;if(!a)return r.ringOut;if(a.ringOut!==r.ringOut)if(a.ringOut.enclosingRing()!==r.ringOut)return r.ringOut;else return r.ringOut.enclosingRing();a=(r=a.prevInResult())?r.prevInResult():null}}}],[{key:"factory",value:function(t){for(var i=[],n=0,r=t.length;n<r;n++){var a=t[n];if(a.isInResult()&&!a.ringOut){for(var s=null,o=a.leftSE,l=a.rightSE,h=[o],c=o.point,u=[];s=o,o=l,h.push(o),o.point!==c;)for(;;){var d=o.getAvailableLinkedEvents();if(0===d.length){var p=h[0].point,f=h[h.length-1].point;throw Error(`Unable to complete output ring starting at [${p.x}, ${p.y}]. Last matching segment found ends at [${f.x}, ${f.y}].`)}if(1===d.length){l=d[0].otherSE;break}for(var g=null,v=0,m=u.length;v<m;v++)if(u[v].point===o.point){g=v;break}if(null!==g){var y=u.splice(g)[0],x=h.splice(y.index);x.unshift(x[0].otherSE),i.push(new e(x.reverse()));continue}u.push({index:h.length,point:o.point});var b=o.getLeftmostComparator(s);l=d.sort(b)[0].otherSE;break}i.push(new e(h))}}return i}}]),e}(),ee=function(){function e(t){(0,$cx0mh._)(this,e),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}return(0,$7h4XF._)(e,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(var t=0,i=this.interiorRings.length;t<i;t++){var n=this.interiorRings[t].getGeom();null!==n&&e.push(n)}return e}}]),e}(),et=function(){function e(t){(0,$cx0mh._)(this,e),this.rings=t,this.polys=this._composePolys(t)}return(0,$7h4XF._)(e,[{key:"getGeom",value:function(){for(var e=[],t=0,i=this.polys.length;t<i;t++){var n=this.polys[t].getGeom();null!==n&&e.push(n)}return e}},{key:"_composePolys",value:function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];if(!r.poly)if(r.isExteriorRing())t.push(new ee(r));else{var a=r.enclosingRing();a.poly||t.push(new ee(a)),a.poly.addInterior(r)}}return t}}]),e}(),ei=function(){function e(t){(0,$cx0mh._)(this,e);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.compare;this.queue=t,this.tree=new l(i),this.segments=[]}return(0,$7h4XF._)(e,[{key:"process",value:function(e){var t=e.segment,i=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),i;var n=e.isLeft?this.tree.add(t):this.tree.find(t);if(!n)throw Error(`Unable to find segment #${t.id} [${t.leftSE.point.x}, ${t.leftSE.point.y}] -> [${t.rightSE.point.x}, ${t.rightSE.point.y}] in SweepLine tree.`);for(var r=n,a=n,s=void 0,o=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===o;)null===(a=this.tree.next(a))?o=null:void 0===a.key.consumedBy&&(o=a.key);if(e.isLeft){var l=null;if(s){var h=s.getIntersection(t);if(null!==h&&(t.isAnEndpoint(h)||(l=h),!s.isAnEndpoint(h)))for(var c=this._splitSafely(s,h),u=0,d=c.length;u<d;u++)i.push(c[u])}var p=null;if(o){var f=o.getIntersection(t);if(null!==f&&(t.isAnEndpoint(f)||(p=f),!o.isAnEndpoint(f)))for(var g=this._splitSafely(o,f),v=0,m=g.length;v<m;v++)i.push(g[v])}if(null!==l||null!==p){var y=null;y=null===l?p:null===p||0>=G.comparePoints(l,p)?l:p,this.queue.remove(t.rightSE),i.push(t.rightSE);for(var x=t.split(y),b=0,w=x.length;b<w;b++)i.push(x[b])}i.length>0?(this.tree.remove(t),i.push(e)):(this.segments.push(t),t.prev=s)}else{if(s&&o){var k=s.getIntersection(o);if(null!==k){if(!s.isAnEndpoint(k))for(var B=this._splitSafely(s,k),S=0,C=B.length;S<C;S++)i.push(B[S]);if(!o.isAnEndpoint(k))for(var E=this._splitSafely(o,k),_=0,I=E.length;_<I;_++)i.push(E[_])}}this.tree.remove(t)}return i}},{key:"_splitSafely",value:function(e,t){this.tree.remove(e);var i=e.rightSE;this.queue.remove(i);var n=e.split(t);return n.push(i),void 0===e.consumedBy&&this.tree.add(e),n}}]),e}(),en=1e6,er=1e6,ea=new(function(){function e(){(0,$cx0mh._)(this,e)}return(0,$7h4XF._)(e,[{key:"run",value:function(e,t,i){ea.type=e,k.reset();for(var n=[new J(t,!0)],r=0,a=i.length;r<a;r++)n.push(new J(i[r],!1));if(ea.numMultiPolys=n.length,"difference"===ea.type)for(var s=n[0],o=1;o<n.length;)null!==v(n[o].bbox,s.bbox)?o++:n.splice(o,1);if("intersection"===ea.type){for(var h=0,c=n.length;h<c;h++)for(var u=n[h],d=h+1,p=n.length;d<p;d++)if(null===v(u.bbox,n[d].bbox))return[]}for(var f=new l(G.compare),g=0,m=n.length;g<m;g++)for(var y=n[g].getSweepEvents(),x=0,b=y.length;x<b;x++)if(f.insert(y[x]),f.size>en)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).");for(var w=new ei(f),B=f.size,S=f.pop();S;){var C=S.key;if(f.size===B){var E=C.segment;throw Error(`Unable to pop() ${C.isLeft?"left":"right"} SweepEvent [${C.point.x}, ${C.point.y}] from segment #${E.id} [${E.leftSE.point.x}, ${E.leftSE.point.y}] -> [${E.rightSE.point.x}, ${E.rightSE.point.y}] from queue.`)}if(f.size>en)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(w.segments.length>er)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");for(var _=w.process(C),I=0,T=_.length;I<T;I++){var M=_[I];void 0===M.consumedBy&&f.insert(M)}B=f.size,S=f.pop()}return k.reset(),new et(Q.factory(w.segments)).getGeom()}}]),e}());return{union:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ea.run("union",e,i)},intersection:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ea.run("intersection",e,i)},xor:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ea.run("xor",e,i)},difference:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return ea.run("difference",e,i)}}});var $396117890b5c76b0$export$c61ab90e0d3eb9b1=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.renderedSelection=null,this.viewportTransform=t.transform,this.viewportMat=$92816524e1b72be4$export$ad1d215dd03fe75a(this.viewportTransform),this.selection=t.selection,this.viewportWidth=t.width,this.viewportHeight=t.height,this.svgPath1=$eWjiX.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke"}),this.svgPath1.classList.add($c08bd94435b4b84a$export$2f48b40a5a83dc1b),this.svgPath2=$eWjiX.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke"}),this.svgPath2.classList.add($c08bd94435b4b84a$export$eea3e4f737fa39e3),this.rootEl=$eWjiX.BB.createSvg({elementType:"g"}),this.rootEl.append(this.svgPath1,this.svgPath2)}return(0,$7h4XF._)(e,[{key:"update",value:function(){var e=null===this.renderedSelection?this.selection:this.renderedSelection;if(!e){this.svgPath1.setAttribute("d",""),this.svgPath2.setAttribute("d","");return}var t=(0,$bbA6w.transformMultiPolygon)(e,this.viewportMat),i=10,n=$0b0ef140191bcf10$export$7ec1a3fdd6e82838("intersection",t,[[[-10,-10],[this.viewportWidth+i,-i],[this.viewportWidth+i,this.viewportHeight+i],[-i,this.viewportHeight+i],[-i,-i]]]),r=(0,$9b3eo.getSvgPathD)($396117890b5c76b0$export$f3040a9d9c5d06ba(n));this.svgPath1.setAttribute("d",r),this.svgPath2.setAttribute("d",r)}},{key:"setTransform",value:function(e){this.viewportTransform=e,this.viewportMat=$92816524e1b72be4$export$ad1d215dd03fe75a(this.viewportTransform),this.update()}},{key:"setSelection",value:function(e){this.selection!==e&&(this.selection=e,null===this.renderedSelection&&this.update())}},{key:"setRenderedSelection",value:function(e,t){this.renderedSelection!==e&&(this.renderedSelection=e,this.update())}},{key:"clearRenderedSelection",value:function(e){this.renderedSelection=null,e&&this.update()}},{key:"setSize",value:function(e,t){this.viewportWidth=e,this.viewportHeight=t}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.rootEl.remove(),this.selection=void 0}}]),e}(),$7jh4K=parcelRequire("7jh4K"),$99362267c0b49949$var$DEFAULT_PADDING=10,$99362267c0b49949$export$133773870222880f=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.isReset=!0,this.doRender=!1,this.lastEmittedTransform={x:0,y:0,scale:0,angleDeg:0},this.renderLoop=function(){if(n.animationFrameId=requestAnimationFrame(n.renderLoop),n.doRender){n.doRender=!1,n.viewport.render();var e,t=n.viewport.getTransform();null==(e=n.selectionRenderer)||e.setTransform(t),n.onTransformChange&&JSON.stringify(n.lastEmittedTransform)!==JSON.stringify(t)&&(n.onTransformChange(t),n.lastEmittedTransform=t)}},this.onWheel=function(e){var t=n.viewport.getElement().getBoundingClientRect(),i=e.pageX-t.x,r=e.pageY-t.y,a=n.viewport.getTransform().scale,s=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(a,-e.deltaY/2);n.transformCanvas({type:"zoom",vX:i,vY:r,fac:s/a})},this.width=t.width,this.height=t.height,this.project=t.project,this.onTransformChange=t.onTransformChange,this.padding=null!=(i=t.padding)?i:$99362267c0b49949$var$DEFAULT_PADDING;var r=$eWjiX.BB.fitInto(this.project.width,this.project.height,this.width-2*this.padding,this.height-2*this.padding).width/this.project.width;this.viewport=new $ee6e64f1b33d2735$export$a140ed60c2ca052c({width:this.width,height:this.height,transform:$926e1894e59cf403$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},r,0),project:this.project,useNativeResolution:!1,drawBackground:!0});var a=new(0,$c1lmK.DoubleTapper)({onDoubleTap:function(e){var t=$92816524e1b72be4$export$ad1d215dd03fe75a(n.viewport.getTransform()),i=(0,$cdZRx.applyToPoint)(t,{x:0,y:0}),r=(0,$cdZRx.applyToPoint)(t,{x:n.project.width,y:n.project.height}),a=$eWjiX.BB.isInsideRect({x:e.relX,y:e.relY},{x:i.x,y:i.y,width:r.x-i.x,height:r.y-i.y});(!n.isReset||a)&&n.resetOrZoom(e.relX,e.relY)},isInstant:!0}),s=void 0,o=new(0,$joplQ.PinchZoomer)({onPinch:function(e){if("move"===e.type){s||(s=n.viewport.getTransform());var t=$c4f45fb8696b5286$export$935bc53f7df03c95(s,{x:e.downRelX,y:e.downRelY});t.scale*=e.scale,t.viewportP.x+=e.relX-e.downRelX,t.viewportP.y+=e.relY-e.downRelY,n.viewport.setTransform($926e1894e59cf403$export$99c68a89351e15c0(t.viewportP,t.canvasP,t.scale,t.angleDeg)),n.requestRerender(),n.isReset=!1}else"end"===e.type&&(s=void 0)}});this.pointerChain=new(0,$gCzYB.EventChain)({chainArr:[o,a]}),this.pointerChain.setChainOut(function(e){e.button&&["left","middle"].includes(e.button)&&n.transformCanvas({type:"translate",x:e.dX,y:e.dY})}),this.viewport.getElement().classList.add($8df31a3769a54937$export$d7b7311ec04a3e8f),(0,$7jh4K.css)(this.viewport.getElement(),{userSelect:"none",touchAction:"none"}),this.viewport.getElement().addEventListener("touchend",function(e){return e.preventDefault(),!1}),this.viewport.getElement().addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),this.viewport.getElement().addEventListener("dragstart",function(e){return e.preventDefault(),!1}),this.viewportPointerListener=new(0,$04lDo.PointerListener)({target:this.viewport.getElement(),onPointer:function(e){n.pointerChain.chainIn(e)},onWheel:this.onWheel,maxPointers:2}),this.viewport.getElement().addEventListener("wheel",function(e){e.preventDefault()});var l=$eWjiX.BB.createSvg({elementType:"svg"});(0,$7jh4K.css)(l,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",pointerEvents:"none"}),t.selection&&(this.selectionRenderer=new $396117890b5c76b0$export$c61ab90e0d3eb9b1({transform:this.lastEmittedTransform,selection:t.selection,width:this.width,height:this.height}),l.append(this.selectionRenderer.getElement())),t.hasEditMode&&(this.modeToggle=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:["edit","hand"].map(function(e){var i,n=$eWjiX.BB.el({className:"dark-invert",css:{width:"28px",height:"28px",backgroundSize:"contain",margin:"5px",backgroundImage:`url(${"edit"===e?null!=(i=t.editIcon)?i:$parcel$interopDefault($0a0c8fa06baa05ba$exports):$parcel$interopDefault($ec1da9254c8485a7$exports)})`,backgroundPosition:"center",backgroundRepeat:"no-repeat"}});return{id:e,label:n,title:"edit"===e?$8d7403abedf7cefa$export$ce37e184d908d785("tab-edit"):$8d7403abedf7cefa$export$ce37e184d908d785("tool-hand")}}),initId:"edit",onChange:function(e){t.onModeChange&&t.onModeChange(e)}})),this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072({className:!1===t.hasBorder?void 0:$8df31a3769a54937$export$48c2d0f2f545ac27,css:{position:"relative",zIndex:"0"}},[this.viewport.getElement(),l].concat((0,$bX4ja._)(this.modeToggle?[$075b9fd415bad4ff$export$db3b6bfb95261072(",pos-absolute,left-5,top-5,z-1,pointer-auto",[this.modeToggle.getElement()])]:[]),[$075b9fd415bad4ff$export$db3b6bfb95261072(",pos-absolute,right-5,bottom-5,flex,flexCol,gap-5,z-1,pointer-auto",[$075b9fd415bad4ff$export$db3b6bfb95261072({tagName:"button",title:$8d7403abedf7cefa$export$ce37e184d908d785("hand-reset"),onClick:function(){n.reset()},content:`<img alt="reset" height="20" src="${$parcel$interopDefault($f121c15402c4c25f$exports)}">`,noRef:!0}),$075b9fd415bad4ff$export$db3b6bfb95261072({tagName:"button",title:$8d7403abedf7cefa$export$ce37e184d908d785("zoom-in"),onClick:function(){var e=n.viewport.getTransform().scale,t=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(e,1);n.transformCanvas({type:"zoom",fac:t/e})},content:`<img alt="zoom-in" height="20" src="${$parcel$interopDefault($c88da6b7fdef67e7$exports)}">`,noRef:!0}),$075b9fd415bad4ff$export$db3b6bfb95261072({tagName:"button",title:$8d7403abedf7cefa$export$ce37e184d908d785("zoom-out"),onClick:function(){var e=n.viewport.getTransform().scale,t=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(e,-1);n.transformCanvas({type:"zoom",fac:t/e})},content:`<img alt="zoom-out" height="20" src="${$parcel$interopDefault($e503dd0072d83d49$exports)}">`,noRef:!0})])])),this.renderLoop()}return(0,$7h4XF._)(e,[{key:"requestRerender",value:function(){this.doRender=!0}},{key:"resetOrZoom",value:function(e,t){if(this.isReset){this.isReset=!1;var i=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)($92816524e1b72be4$export$ad1d215dd03fe75a(this.viewport.getTransform())),{x:e,y:t});this.viewport.setTransform($926e1894e59cf403$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},i,1,0)),this.requestRerender()}else this.reset()}},{key:"reset",value:function(){var e=$eWjiX.BB.fitInto(this.project.width,this.project.height,this.width-2*this.padding,this.height-2*this.padding).width/this.project.width;this.viewport.setTransform($926e1894e59cf403$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},e,0)),this.isReset=!0,this.requestRerender()}},{key:"transformCanvas",value:function(e){if("translate"===e.type){var t=this.viewport.getTransform();if(0===e.x&&0===e.y)return;this.viewport.setTransform((0,$4EWN2._)((0,$cL71g._)({},t),{x:t.x+e.x,y:t.y+e.y}))}else if("zoom"===e.type){var i,n,r=this.viewport.getTransform(),a=this.viewport.getElement().getBoundingClientRect();e.vX=null!=(i=e.vX)?i:a.width/2,e.vY=null!=(n=e.vY)?n:a.height/2;var s=$c4f45fb8696b5286$export$935bc53f7df03c95(r,{x:e.vX,y:e.vY});s.scale*=e.fac,this.viewport.setTransform($926e1894e59cf403$export$99c68a89351e15c0(s.viewportP,s.canvasP,s.scale,s.angleDeg))}this.isReset=!1,this.requestRerender()}},{key:"render",value:function(){this.requestRerender()}},{key:"setTransform",value:function(e){this.viewport.setTransform(e),this.requestRerender(),this.isReset=!1}},{key:"getTransform",value:function(){return this.viewport.getTransform()}},{key:"onPointer",value:function(e){this.pointerChain.chainIn(e)}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){var e;void 0!==this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.viewport.destroy(),this.viewportPointerListener.destroy(),this.rootEl.remove(),this.modeToggle&&this.modeToggle.destroy(),null==(e=this.selectionRenderer)||e.destroy()}}]),e}();parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$eg83P=parcelRequire("eg83P"),$96cbdba315fc6e81$exports={};$96cbdba315fc6e81$exports=$parcel$resolve("cazOx");var $gCzYB=parcelRequire("gCzYB"),$635F6=parcelRequire("635F6"),$eIcQa=parcelRequire("eIcQa"),$7jh4K=parcelRequire("7jh4K"),$01fcd0ed15aa4018$export$40175a5948a88a57=function(){"use strict";function e(t){var i,n,r=this;(0,$cx0mh._)(this,e),this.cropRect={x:0,y:0,width:0,height:0},this.mode="edit",this.rootEl=$eWjiX.BB.el({className:"kl-edit-crop-preview",css:{position:"relative",height:t.height+"px",width:t.width+"px",overflow:"hidden"}}),t.onChange&&(this.onChange=t.onChange),this.canvas=t.canvas,t.init?this.cropRect=t.init:this.resetCrop();var a=function(e){return $eWjiX.BB.isInsideRect(e,r.getViewportSelectionRect())};this.croppedCanvas=$eWjiX.BB.canvas(),this.croppedBlob={},this.croppedObjectUrl="",this.eventTarget=this.croppedCanvas,t.enableRightClickCopy&&(this.croppedImageElement=new Image,this.eventTarget=this.croppedImageElement),(0,$7jh4K.css)(this.eventTarget,{height:t.height+"px",width:t.width+"px"}),this.rootEl.append(this.eventTarget),this.updateCroppedCanvas(),this.previewLayer={image:t.canvas,opacity:1,isVisible:!0,mixModeStr:"source-over",hasClipping:!1},this.preview=new $99362267c0b49949$export$133773870222880f({width:t.width,height:t.height-2,project:{width:t.canvas.width,height:t.canvas.height,layers:[this.previewLayer]},hasEditMode:!0,onModeChange:function(e){r.mode=e,r.preview.getElement().style.pointerEvents="edit"===e?"none":"",r.rootEl.title="edit"===e?$8d7403abedf7cefa$export$ce37e184d908d785("crop-drag-to-crop"):""},onTransformChange:function(){return r.updateSelectionRect()},padding:20,hasBorder:!1,editIcon:$parcel$interopDefault($96cbdba315fc6e81$exports)}),(0,$7jh4K.css)(this.preview.getElement(),{position:"absolute",left:"0",top:"0",overflow:"hidden",pointerEvents:"none"}),this.preview.render(),this.rootEl.append(this.preview.getElement()),this.selectionRectEl=$eWjiX.BB.el({parent:this.preview.getElement(),className:"kl-edit-crop-preview__sel"}),this.updateSelectionRect();var s=function(e,t){var i=$92816524e1b72be4$export$ad1d215dd03fe75a(r.preview.getTransform()),n=(0,$kDVZW.inverse)(i),a={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},s={x:Math.max(e.x,t.x),y:Math.max(e.y,t.y)},o=(0,$cdZRx.applyToPoint)(n,a),l=(0,$cdZRx.applyToPoint)(n,s);return o.x=(0,$eg83P.clamp)(Math.floor(o.x),0,r.canvas.width),o.y=(0,$eg83P.clamp)(Math.floor(o.y),0,r.canvas.height),l.x=(0,$eg83P.clamp)(Math.ceil(l.x),0,r.canvas.width),l.y=(0,$eg83P.clamp)(Math.ceil(l.y),0,r.canvas.height),{x:o.x,y:o.y,width:l.x-o.x,height:l.y-o.y}},o=null,l=!1,h=!1,c=new(0,$gCzYB.EventChain)({chainArr:[new(0,$635F6.OnePointerLimiter)]});c.setChainOut(function(e){if("pointerdown"===e.type&&"left"===e.button)e.eventPreventDefault(),l=!0,i={x:e.relX,y:e.relY},!r.isReset()&&a(i)?o={x:r.cropRect.x,y:r.cropRect.y,width:r.cropRect.width,height:r.cropRect.height}:r.cropRect=s(i,i);else if("pointermove"===e.type&&"left"===e.button){if(e.eventPreventDefault(),h=!0,o){var t=r.preview.getTransform();r.cropRect.x=o.x+Math.round((e.relX-i.x)/t.scale),r.cropRect.y=o.y+Math.round((e.relY-i.y)/t.scale),r.cropRect.x=$eWjiX.BB.clamp(r.cropRect.x,0,r.canvas.width-r.cropRect.width),r.cropRect.y=$eWjiX.BB.clamp(r.cropRect.y,0,r.canvas.height-r.cropRect.height)}else r.cropRect=s(i,{x:e.relX,y:e.relY});r.updateSelectionRect()}else"pointerup"===e.type&&i&&(e.eventPreventDefault(),l=!1,o=null,i=null,0!==r.cropRect.width&&0!==r.cropRect.height&&h||(r.resetCrop(),r.updateSelectionRect()),h=!1,n=setTimeout(function(){return r.updateCroppedCanvas()},1))}),this.pointerListener=new $eWjiX.BB.PointerListener({target:this.eventTarget,fixScribble:!0,onWheel:function(e){r.preview.onWheel(e)},onPointer:function(e){if("hand"===r.mode){e.eventPreventDefault(),r.preview.onPointer(e);return}c.chainIn(e)},maxPointers:2}),this.keyListener=new $eWjiX.BB.KeyListener({onDown:function(e,t){if(!l){var i=!1,a=r.preview.getTransform(),s=Math.max(1,1/a.scale),o=r.keyListener.isPressed("shift");"left"===e&&(o?r.cropRect.width=$eWjiX.BB.clamp(r.cropRect.width-s,1,r.canvas.width-r.cropRect.x):r.cropRect.x=$eWjiX.BB.clamp(r.cropRect.x-s,0,r.canvas.width-r.cropRect.width),i=!0),"right"===e&&(o?r.cropRect.width=$eWjiX.BB.clamp(r.cropRect.width+s,1,r.canvas.width-r.cropRect.x):r.cropRect.x=$eWjiX.BB.clamp(r.cropRect.x+s,0,r.canvas.width-r.cropRect.width),i=!0),"up"===e&&(o?r.cropRect.height=$eWjiX.BB.clamp(r.cropRect.height-s,1,r.canvas.height-r.cropRect.y):r.cropRect.y=$eWjiX.BB.clamp(r.cropRect.y-s,0,r.canvas.height-r.cropRect.height),i=!0),"down"===e&&(o?r.cropRect.height=$eWjiX.BB.clamp(r.cropRect.height+s,1,r.canvas.height-r.cropRect.y):r.cropRect.y=$eWjiX.BB.clamp(r.cropRect.y+s,0,r.canvas.height-r.cropRect.height),i=!0),i&&(t.preventDefault(),r.updateSelectionRect(),clearTimeout(n),n=setTimeout(function(){return r.updateCroppedCanvas()},100))}}})}return(0,$7h4XF._)(e,[{key:"resetCrop",value:function(){this.cropRect={x:0,y:0,width:this.canvas.width,height:this.canvas.height}}},{key:"getViewportSelectionRect",value:function(){var e=this.preview.getTransform(),t=$92816524e1b72be4$export$ad1d215dd03fe75a(e),i=(0,$cdZRx.applyToPoint)(t,this.cropRect);return{x:i.x,y:i.y,width:this.cropRect.width*e.scale,height:this.cropRect.height*e.scale}}},{key:"updateCroppedCanvas",value:function(){return(0,$1LaJZ._)(function(){var e,t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return this.croppedCanvas.width=Math.round(this.cropRect.width),this.croppedCanvas.height=Math.round(this.cropRect.height),$eWjiX.BB.ctx(this.croppedCanvas).drawImage(this.canvas,Math.round(-this.cropRect.x),Math.round(-this.cropRect.y)),[4,(0,$eIcQa.canvasToBlob)(this.croppedCanvas,"image/png")];case 1:return i=n.sent(),this.croppedBlob=i,""!==this.croppedObjectUrl&&URL.revokeObjectURL(this.croppedObjectUrl),this.croppedObjectUrl=URL.createObjectURL(i),this.croppedImageElement&&(this.croppedImageElement.src=this.croppedObjectUrl),null==(e=(t=this).onChange)||e.call(t,this.croppedCanvas.width,this.croppedCanvas.height),[2]}})}).call(this)}},{key:"updateSelectionRect",value:function(){var e,t,i=this.getViewportSelectionRect();(0,$7jh4K.css)(this.selectionRectEl,{left:i.x+"px",top:i.y+"px",width:i.width+"px",height:i.height+"px",display:this.isReset()?"none":""}),null==(e=(t=this).onChange)||e.call(t,Math.round(this.cropRect.width),Math.round(this.cropRect.height))}},{key:"isReset",value:function(){return 0===this.cropRect.x&&0===this.cropRect.y&&this.cropRect.width===this.canvas.width&&this.cropRect.height===this.canvas.height}},{key:"getElement",value:function(){return this.rootEl}},{key:"getCropRect",value:function(){return $eWjiX.BB.copyObj(this.cropRect)}},{key:"getCroppedCanvas",value:function(){return this.croppedCanvas}},{key:"getCroppedBlob",value:function(){return this.croppedBlob}},{key:"setCanvas",value:function(e){this.canvas=e,this.previewLayer.image=e,this.updateCroppedCanvas(),this.preview.render()}},{key:"destroy",value:function(){this.croppedImageElement&&(this.croppedImageElement.src=""),URL.revokeObjectURL(this.croppedObjectUrl),this.rootEl.remove(),this.eventTarget.style.removeProperty("width"),this.eventTarget.style.removeProperty("height"),this.keyListener.destroy(),this.pointerListener.destroy(),this.preview.destroy()}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$eg83P=parcelRequire("eg83P");function $2c64e9e8cb297da3$export$a04a50ae6d6450f8(e){var t=void 0,i=void 0,n=void 0,r=void 0;if(e.forEach(function(e){e.forEach(function(e){e.forEach(function(e){t=void 0===t?e[0]:Math.min(t,e[0]),i=void 0===i?e[1]:Math.min(i,e[1]),n=void 0===n?e[0]:Math.max(n,e[0]),r=void 0===r?e[1]:Math.max(r,e[1])})})}),void 0===t||void 0===i||void 0===n||void 0===r)throw"empty poly";return{x1:t,y1:i,x2:n,y2:r}}var $7jh4K=parcelRequire("7jh4K"),$ffd40240385bb9f9$var$maskSelection=!1;function $ffd40240385bb9f9$export$32b89bc9bb92706a(e,t,i,n,r){var a,s,o=!(arguments.length>5)||void 0===arguments[5]||arguments[5],l=arguments.length>6?arguments[6]:void 0,h=!1;try{h=!!ClipboardItem}catch(e){}var c=document.createElement("div"),u=window.innerWidth<550||window.innerHeight<550,d=l?new $365a915dfb503274$export$48513f6b9f8ce62d({init:$ffd40240385bb9f9$var$maskSelection,label:$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-mask"),name:"check-mask-selection",css:{width:"fit-content"},callback:function(e){$ffd40240385bb9f9$var$maskSelection=e,m.setCanvas(t(e))}}):void 0,p=$eWjiX.BB.el({content:[null==d?void 0:d.getElement(),$8d7403abedf7cefa$export$ce37e184d908d785("crop-drag-to-crop")+(h?"":"<br>"+$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-click-hold"))],css:{textAlign:"center"}});c.append(p);var f=t($ffd40240385bb9f9$var$maskSelection);if(l){var g=$2c64e9e8cb297da3$export$a04a50ae6d6450f8(l),v=(0,$eg83P.intBoundsWithinArea)(g,f.width,f.height);a=v?(0,$eg83P.boundsToRect)(v):void 0}var m=new $01fcd0ed15aa4018$export$40175a5948a88a57({width:u?340:540,height:u?300:350,canvas:f,enableRightClickCopy:!0,init:a});function y(){return(0,$1LaJZ._)(function(){var e,t;return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=m.getCroppedBlob(),[4,navigator.clipboard.write([new ClipboardItem({[e.type]:e})])];case 1:return i.sent(),setTimeout(function(){n.out($8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-copied"),!0)},200),[3,3];case 2:return console.error((t=i.sent()).name,t.message),[2];case 3:return[2]}})})()}(0,$7jh4K.css)(m.getElement(),{marginTop:"10px",marginLeft:"-20px"}),c.append(m.getElement());var x=new $eWjiX.BB.KeyListener({onDown:function(e,t,i){["ctrl+c","cmd+c"].includes(i)&&(y(),s&&s())}});function b(){o&&(null==s||s())}window.addEventListener("blur",b);var w=[];h&&w.push($8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-copy")),r&&w.push($8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-crop")),w.push("Cancel"),$c902829f68f42bce$export$d7e8d4d4450c819c({target:e,message:"<b>"+(r?`${$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-title-copy")} / ${$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-title-crop")}`:`${$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-title-copy")}`)+"</b>",div:c,style:u?{}:{width:"540px"},buttons:w,primaries:[$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-copy")],callback:function(e){if(e===$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-copy"))y();else if(e===$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-crop")){var t=m.getCropRect();i({left:Math.round(-t.x),right:Math.round(t.x+t.width-f.width),top:Math.round(-t.y),bottom:Math.round(t.y+t.height-f.height)})}window.removeEventListener("blur",b),$eWjiX.BB.freeCanvas(m.getCroppedCanvas()),m.destroy(),x.destroy()},clickOnEnter:$8d7403abedf7cefa$export$ce37e184d908d785("cropcopy-btn-copy"),closeFunc:function(e){s=e}})}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX");function $7069db2f5e23d00f$var$fillRect(e,t,i,n,r,a){for(var s=i;s<=r;s++)for(var o=n;o<=a;o++)255!==e[o*t+s]&&(e[o*t+s]=254)}function $7069db2f5e23d00f$var$toleranceTest(e,t,i,n,r,a,s){return Math.pow(e[4*s]-t,2)<=a&&Math.pow(e[4*s+1]-i,2)<=a&&Math.pow(e[4*s+2]-n,2)<=a&&Math.pow(e[4*s+3]-r,2)<=a}function $7069db2f5e23d00f$var$selectionMaskTest(e,t){return!e||!!e[t]}function $7069db2f5e23d00f$var$floodFill(e,t,i,n,r,a,s,o,l,h){var c,u,d,p,f,g,v,m,y,x,b,w,k=e[(s*n+a)*4],B=e[(s*n+a)*4+1],S=e[(s*n+a)*4+2],C=e[(s*n+a)*4+3],E=new DataView(e.buffer),_=E.getUint32((s*n+a)*4,!0),I=Math.pow(o,2),T={x1:a,y1:s,x2:a,y2:s};if(h){var M,L,R,P,A=[];for(A.push(s*n+a),i[s*n+a]=255;A.length;)P=Math.floor((M=A.pop())/n),(R=M%n)>0&&255!==i[L=M-1]&&$7069db2f5e23d00f$var$selectionMaskTest(t,L)&&(E.getUint32(4*L,!0)===_||o>0&&$7069db2f5e23d00f$var$toleranceTest(e,k,B,S,C,I,L))&&(T.x1=Math.min(T.x1,R-1),i[L]=255,A.push(L)),R<n-1&&255!==i[L=M+1]&&$7069db2f5e23d00f$var$selectionMaskTest(t,L)&&(E.getUint32(4*L,!0)===_||o>0&&$7069db2f5e23d00f$var$toleranceTest(e,k,B,S,C,I,L))&&(T.x2=Math.max(T.x2,R+1),i[L]=255,A.push(L)),P>0&&255!==i[L=M-n]&&$7069db2f5e23d00f$var$selectionMaskTest(t,L)&&(E.getUint32(4*L,!0)===_||o>0&&$7069db2f5e23d00f$var$toleranceTest(e,k,B,S,C,I,L))&&(T.y1=Math.min(T.y1,P-1),i[L]=255,A.push(L)),P<r-1&&255!==i[L=M+n]&&$7069db2f5e23d00f$var$selectionMaskTest(t,L)&&(E.getUint32(4*L,!0)===_||o>0&&$7069db2f5e23d00f$var$toleranceTest(e,k,B,S,C,I,L))&&(T.y2=Math.max(T.y2,P+1),i[L]=255,A.push(L))}else for(var D=0,O=0;D<r;D++)for(var z=0;z<n;z++,O++)$7069db2f5e23d00f$var$selectionMaskTest(t,O)&&(E.getUint32(4*O,!0)===_||o>0&&$7069db2f5e23d00f$var$toleranceTest(e,k,B,S,C,I,O))&&(i[O]=255,z<T.x1&&(T.x1=z),D<T.y1&&(T.y1=D),z>T.x2&&(T.x2=z),D>T.y2&&(T.y2=D));if(0===l)return T;for(var H=T.x1;H<=T.x2;H++)for(var j=T.y1;j<=T.y2;j++)255===i[j*n+H]&&(c=H,u=H,d=j,p=j,f=255!==i[j*n+H-1],g=255!==i[(j-1)*n+H-1],v=255!==i[(j-1)*n+H],m=255!==i[(j-1)*n+H+1],y=255!==i[j*n+H+1],x=255!==i[(j+1)*n+H+1],b=255!==i[(j+1)*n+H],w=255!==i[(j+1)*n+H-1],f&&(c=H-l),f&&g&&v&&(c=H-l,d=j-l),v&&(d=Math.min(d,j-l)),v&&m&&y&&(d=Math.min(d,j-l),u=H+l),y&&(u=Math.max(u,H+l)),y&&x&&b&&(u=Math.max(u,H+l),p=Math.max(p,j+l)),b&&(p=Math.max(p,j+l)),b&&w&&f&&(c=Math.min(c,H-l),p=Math.max(p,j+l)),(f||g||v||m||y||x||b||w)&&$7069db2f5e23d00f$var$fillRect(i,n,Math.max(0,c),Math.max(0,d),Math.min(n-1,u),Math.min(r-1,p)));for(var F=0;F<n*r;F++)254===i[F]&&(i[F]=255);return T.x1-=l,T.y1-=l,T.x2+=l,T.y2+=l,T}function $7069db2f5e23d00f$export$13d50f258a8034f(e,t,i,n,r,a,s,o,l){r=Math.round(r),a=Math.round(a);var h=new Uint8Array(new ArrayBuffer(i*n)),c=$7069db2f5e23d00f$var$floodFill(e,t,h,i,n,r,a,s,o,l);return{data:h,bounds:c}}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx");function $32a8ea052c2ead31$export$7efa1f930df882cc(e,t){var i=(0,$cdZRx.applyToPoint)(t,{x:e.x1,y:e.y1}),n=(0,$cdZRx.applyToPoint)(t,{x:e.x2,y:e.y1}),r=(0,$cdZRx.applyToPoint)(t,{x:e.x2,y:e.y2}),a=(0,$cdZRx.applyToPoint)(t,{x:e.x1,y:e.y2});return{x1:Math.min(i.x,n.x,r.x,a.x),y1:Math.min(i.y,n.y,r.y,a.y),x2:Math.max(i.x,n.x,r.x,a.x),y2:Math.max(i.y,n.y,r.y,a.y)}}parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$1RMPr=parcelRequire("1RMPr"),$01d7180c5d1d0fdf$export$27550cc14d7ae85a=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.downX=0,this.downY=0,this.downAngleRad=0,this.onShape=t.onShape}return(0,$7h4XF._)(e,[{key:"onDown",value:function(e,t,i){this.downX=e,this.downY=t,this.downAngleRad=i}},{key:"onMove",value:function(e,t){this.onShape(!1,this.downX,this.downY,e,t,this.downAngleRad)}},{key:"onUp",value:function(e,t){this.onShape(!0,this.downX,this.downY,e,t,this.downAngleRad)}}]),e}();function $01d7180c5d1d0fdf$export$71b514a25c47df50(e,t,i){t=(0,$cL71g._)({angleRad:0,isOutwards:!1,opacity:1,isEraser:!1,doLockAlpha:!1},$eWjiX.BB.copyObj(t));var n={x1:0,y1:0,x2:0,y2:0};if(["rect","ellipse","line"].includes(t.type)){if(void 0===t.angleRad)throw Error("angleRad undefined");var r,a,s,o=void 0===t.lineWidth?-1:Math.round(t.lineWidth),l=180*t.angleRad/Math.PI;if(!t.isEraser&&void 0===t.fillRgb&&void 0===t.strokeRgb)throw Error("fillRgb and strokeRgb undefined");var h=t.isEraser?{r:255,g:255,b:255}:t.fillRgb?t.fillRgb:t.strokeRgb;e.save(),i&&e.clip(i),t.opacity&&(e.globalAlpha=t.opacity),t.isEraser&&(e.globalCompositeOperation="destination-out"),t.doLockAlpha&&(e.globalCompositeOperation="source-atop");var c=(0,$dZ59l.compose)((0,$1RMPr.rotate)(-t.angleRad));(r=e).setTransform.apply(r,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(c))),t.fillRgb?e.fillStyle=$eWjiX.BB.ColorConverter.toRgbStr(h):t.strokeRgb&&(e.strokeStyle=$eWjiX.BB.ColorConverter.toRgbStr(h),e.lineWidth=o);var u=t.x1,d=t.y1,p=t.x2,f=t.y2;if(t.isAngleSnap){var g=$eWjiX.BB.rotate(u,d,t.angleRad/Math.PI*180),v=$eWjiX.BB.rotate(p,f,t.angleRad/Math.PI*180),m=$eWjiX.BB.pointsToAngleDeg(g,v)+90,y=45*Math.round(m/45),x=$eWjiX.BB.rotateAround({x:u,y:d},{x:p,y:f},y-m);p=x.x,f=x.y,(l+y)%90==0&&(Math.round((l-y)/90)%2==0?p=u:f=d)}var b=u,w=d,k=p-u,B=f-d;if("line"!==t.type&&t.isFixedRatio){var S=$eWjiX.BB.rotate(t.x1,t.y1,t.angleRad/Math.PI*180),C=$eWjiX.BB.rotate(t.x2,t.y2,t.angleRad/Math.PI*180),E=S.x,_=S.y,I=C.x-S.x,T=C.y-S.y;Math.abs(I)<Math.abs(T)?T=Math.abs(I)*(T<0?-1:1):I=Math.abs(T)*(I<0?-1:1),C.x=E+I,C.y=_+T,S=$eWjiX.BB.rotate(S.x,S.y,-t.angleRad/Math.PI*180),C=$eWjiX.BB.rotate(C.x,C.y,-t.angleRad/Math.PI*180),u=S.x,d=S.y,p=C.x,f=C.y,b=u,w=d,k=p-u,B=f-d}if(t.isOutwards&&(b-=k,w-=B,k*=2,B*=2,u=b,d=w,p=b+k,f=w+B),"line"===t.type){var M=Math.round(u),L=Math.round(d),R=Math.round(p),P=Math.round(f),A=Math.floor(u),D=Math.floor(d),O=Math.floor(p),z=Math.floor(f);o%2==0?L===P?(a={x:A,y:L},s={x:O,y:P},A<O?s.x+=1:a.x+=1):M===R?(a={x:M,y:D},s={x:R,y:z},D<z?s.y+=1:a.y+=1):(a={x:u,y:d},s={x:p,y:f}):(a={x:A,y:D},s={x:O,y:z},D===z?(A<O?s.x+=1:a.x+=1,a.y+=.5,s.y+=.5):A===O?(D<z?s.y+=1:a.y+=1,a.x+=.5,s.x+=.5):(a.x=u,a.y=d,s.x=p,s.y=f)),n={x1:Math.min(a.x,s.x)-o/2,y1:Math.min(a.y,s.y)-o/2,x2:Math.max(a.x,s.x)+o/2,y2:Math.max(a.y,s.y)+o/2},a=$eWjiX.BB.rotate(a.x,a.y,t.angleRad/Math.PI*180),s=$eWjiX.BB.rotate(s.x,s.y,t.angleRad/Math.PI*180),e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(s.x,s.y),e.stroke()}else if("rect"===t.type){var H=Math.floor(u),j=Math.floor(d),F=Math.floor(p),X=Math.floor(f);l%90==0?t.fillRgb?(u%1==0&&(u+=1),d%1==0&&(d+=1),p%1==0&&(p+=1),f%1==0&&(f+=1),a={x:u<p?H:F,y:d<f?j:X},(s={x:Math.ceil((u<p?p:u)-a.x),y:Math.ceil((d<f?f:d)-a.y)}).x=a.x+s.x,s.y=a.y+s.y):o%2==0?(a={x:H,y:j},s={x:F,y:X}):(a={x:H+.5,y:j+.5},s={x:F+.5,y:X+.5}):(a={x:u,y:d},s={x:p,y:f}),a=$eWjiX.BB.rotate(a.x,a.y,t.angleRad/Math.PI*180),s=$eWjiX.BB.rotate(s.x,s.y,t.angleRad/Math.PI*180);var V={x:a.x,y:a.y,width:s.x-a.x,height:s.y-a.y},U=t.fillRgb?0:o/2;n=$32a8ea052c2ead31$export$7efa1f930df882cc({x1:Math.min(a.x,s.x)-U,y1:Math.min(a.y,s.y)-U,x2:Math.max(a.x,s.x)+U,y2:Math.max(a.y,s.y)+U},c),t.fillRgb?e.fillRect(V.x,V.y,V.width,V.height):e.strokeRect(V.x,V.y,V.width,V.height)}else{a=$eWjiX.BB.rotate(u,d,t.angleRad/Math.PI*180),s=$eWjiX.BB.rotate(p,f,t.angleRad/Math.PI*180),b=a.x,w=a.y;var W={x:b+(k=s.x-a.x)/2,y:w+(B=s.y-a.y)/2},N=Math.abs(k/2),Y=Math.abs(B/2);e.beginPath(),e.ellipse(W.x,W.y,N,Y,0,0,2*Math.PI),t.fillRgb?e.fill():e.stroke();var G=t.fillRgb?0:o/2;n=$32a8ea052c2ead31$export$7efa1f930df882cc({x1:W.x-N-G,y1:W.y-Y-G,x2:W.x+N+G,y2:W.y+Y+G},c)}e.restore()}else throw Error("unknown shape");return n}var $eWjiX=parcelRequire("eWjiX");function $fdc12d72a3df9be9$var$textMetricToRect(e,t){var i=e.actualBoundingBoxAscent,n=e.actualBoundingBoxDescent,r=e.actualBoundingBoxLeft,a=e.actualBoundingBoxRight+r,s=i+n;return"left"===t?{x:-r,y:-i,width:a,height:s}:"right"===t?{x:-a,y:-i,width:a,height:s}:{x:-r,y:-i,width:a,height:s}}function $fdc12d72a3df9be9$export$482c90f94eb9717c(e,t,i){t=$eWjiX.BB.copyObj(t);var n=$eWjiX.BB.ctx(e);n.save(),i&&n.clip(i),n.textAlign=t.align,n.letterSpacing=t.letterSpacing?t.letterSpacing+"px":"0";var r=[t.size+"px "+(t.font?t.font:"sans-serif")];t.isBold&&r.unshift("bold"),t.isItalic&&r.unshift("italic"),n.font=r.join(" "),n.fillStyle=t.fill?$eWjiX.BB.ColorConverter.toRgbaStr(t.fill.color):"transparent",n.strokeStyle=t.stroke?$eWjiX.BB.ColorConverter.toRgbaStr(t.stroke.color):"transparent",t.stroke&&(n.lineWidth=t.stroke.lineWidth,n.lineJoin="round"),n.translate(t.x,t.y),n.rotate(-t.angleRad);var a=t.text.split("\n").map(function(e){return e.replaceAll("	","    ")}),s={x1:0,y1:0,x2:0,y2:0},o=!0;return a.forEach(function(e,i){var r,a=n.measureText(e),l=0,h=t.size*(null!=(r=t.lineHeight)?r:1)*i,c=$fdc12d72a3df9be9$var$textMetricToRect(a,t.align);o?(o=!1,s.x1=l+c.x,s.y1=h+c.y,s.x2=l+c.x+c.width,s.y2=h+c.y+c.height):(s.x1=Math.min(s.x1,l+c.x),s.y1=Math.min(s.y1,h+c.y),s.x2=Math.max(s.x2,l+c.x+c.width),s.y2=Math.max(s.y2,h+c.y+c.height))}),a.forEach(function(e,i){var r,a=0,s=t.size*(null!=(r=t.lineHeight)?r:1)*i;n.strokeText(e,a,s)}),a.forEach(function(e,i){var r,a=0,s=t.size*(null!=(r=t.lineHeight)?r:1)*i;n.fillText(e,a,s)}),n.restore(),{x:s.x1,y:s.y1,width:s.x2-s.x1,height:s.y2-s.y1}}var $esGm2=parcelRequire("esGm2"),$aSJRf=parcelRequire("aSJRf"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX"),$5e45fa121ba5050f$export$74d12f09ff9f1956=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.downX=0,this.downY=0,this.downAngleRad=0,this.onGradient=t.onGradient}return(0,$7h4XF._)(e,[{key:"onDown",value:function(e,t,i){this.downX=e,this.downY=t,this.downAngleRad=i}},{key:"onMove",value:function(e,t){this.onGradient(!1,this.downX,this.downY,e,t,this.downAngleRad)}},{key:"onUp",value:function(e,t){this.onGradient(!0,this.downX,this.downY,e,t,this.downAngleRad)}}]),e}();function $5e45fa121ba5050f$export$b1f70a113e3b5c1b(e,t,i){e.save(),i&&e.clip(i);var n,r=t.x1,a=t.y1,s=t.x2,o=t.y2;if(t.doSnap){var l=180*t.angleRad/Math.PI,h=$eWjiX.BB.rotate(r,a,t.angleRad/Math.PI*180),c=$eWjiX.BB.rotate(s,o,t.angleRad/Math.PI*180),u=$eWjiX.BB.pointsToAngleDeg(h,c)+90,d=45*Math.round(u/45),p=$eWjiX.BB.rotateAround({x:r,y:a},{x:s,y:o},d-u);s=p.x,o=p.y,(l+d)%90==0&&(Math.round((l-d)/90)%2==0?s=r:o=a)}var f=t.color1;t.isEraser&&t.doLockAlpha&&(f={r:255,g:255,b:255});var g=(0,$4EWN2._)((0,$cL71g._)({},f),{a:t.opacity}),v=(0,$4EWN2._)((0,$cL71g._)({},f),{a:0});if(t.isReversed){var m=g;g=v,v=m}if("linear"===t.type)(n=e.createLinearGradient(r,a,s,o)).addColorStop(0,$eWjiX.BB.ColorConverter.toRgbaStr(g)),n.addColorStop(1,$eWjiX.BB.ColorConverter.toRgbaStr(v));else if("linear-mirror"===t.type){var y={x:s-r,y:o-a};(n=e.createLinearGradient(r-y.x,a-y.y,s,o)).addColorStop(0,$eWjiX.BB.ColorConverter.toRgbaStr(v)),n.addColorStop(.5,$eWjiX.BB.ColorConverter.toRgbaStr(g)),n.addColorStop(1,$eWjiX.BB.ColorConverter.toRgbaStr(v))}else if("radial"===t.type){var x=$eWjiX.BB.Vec2.dist({x:r,y:a},{x:s,y:o});(n=e.createRadialGradient(r,a,0,r,a,x)).addColorStop(0,$eWjiX.BB.ColorConverter.toRgbaStr(g)),n.addColorStop(1,$eWjiX.BB.ColorConverter.toRgbaStr(v))}e.fillStyle=n,t.isEraser&&(e.globalCompositeOperation="destination-out"),t.doLockAlpha&&(e.globalCompositeOperation="source-atop"),e.fillRect(0,0,e.canvas.width,e.canvas.height),e.restore()}parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$83Kse=parcelRequire("83Kse"),$1RMPr=parcelRequire("1RMPr"),$kFecW=parcelRequire("kFecW"),$kr2fR=parcelRequire("kr2fR"),$9b3eo=parcelRequire("9b3eo"),$bbA6w=parcelRequire("bbA6w"),$eg83P=parcelRequire("eg83P"),$gWfkn=parcelRequire("gWfkn"),$47ad43347dcf2f3c$var$layerId=0;function $47ad43347dcf2f3c$export$b2ce7a8a096070e2(){return""+$47ad43347dcf2f3c$var$layerId++}var $gWfkn=parcelRequire("gWfkn");function $d031f92b803c75e5$export$9a1731baa7701cc7(e,t,i){for(var n=[],r=Math.ceil(e/$gWfkn.HISTORY_TILE_SIZE),a=Math.ceil(t/$gWfkn.HISTORY_TILE_SIZE),s=0;s<a;s++)for(var o=0;o<r;o++)n.push({fill:i});return n}var $8N5YG=parcelRequire("8N5YG"),$gWfkn=parcelRequire("gWfkn"),$eWjiX=parcelRequire("eWjiX"),$7nLJW=parcelRequire("7nLJW"),$esGm2=parcelRequire("esGm2");function $5d9e95126ab2b87f$export$cee5b735b1b9bad1(e,t,i){var n=t.size.width!==i.size.width||t.size.height!==i.size.height;return Object.entries(i.layerMap).map(function(r){var a=(0,$8N5YG._)(r,2),s=a[0],o=a[1],l={},h={},c=t.layerMap[s],u=Math.ceil(i.size.width/$gWfkn.HISTORY_TILE_SIZE);return n||!c?(l=$eWjiX.BB.canvas(i.size.width,i.size.height),h=$eWjiX.BB.ctx(l),o.tiles.forEach(function(e,t){var i=t%u,n=Math.floor(t/u);(0,$esGm2.isLayerFill)(e)?(h.save(),h.fillStyle=e.fill,h.fillRect(i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE),h.restore()):h.putImageData(e.data,i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE)})):(l=e[c.index].canvas,h=e[c.index].context,o.tiles.forEach(function(e,t){if(e!==c.tiles[t]){var i=t%u,n=Math.floor(t/u);(0,$esGm2.isLayerFill)(e)?(h.save(),h.fillStyle=e.fill,h.clearRect(i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE),h.fillRect(i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE),h.restore()):h.putImageData(e.data,i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE)}})),{id:s,index:o.index,name:o.name,mixModeStr:o.mixModeStr,isVisible:o.isVisible,opacity:o.opacity,canvas:l,context:h}}).sort($7nLJW.sortLayerMap)}function $66a11a95db3a7e23$export$e173233eae155bba(e,t){if(1!==Object.keys(e).length||!e.layerMap)return!1;for(var i=Object.keys(e.layerMap),n=0;n<i.length;n++){var r=i[n],a=e.layerMap[r];if(r===t){var s=Object.keys(a);if(1!==s.length||"opacity"!==s[0])return!1}else if(Object.keys(a).length>0)return!1}return!0}function $ac5e0dd69c1dea2d$export$b706b44cfdbaaa7d(e,t){if(1!==Object.keys(e).length||!e.layerMap)return!1;for(var i=Object.keys(e.layerMap),n=0;n<i.length;n++){var r=i[n],a=e.layerMap[r];if(r===t){var s=Object.keys(a);if(1!==s.length||"isVisible"!==s[0])return!1}else if(Object.keys(a).length>0)return!1}return!0}var $gWfkn=parcelRequire("gWfkn"),$eWjiX=parcelRequire("eWjiX");function $9497dda3f00e23d9$export$6b742be78fc940fb(e,t,i,n){var r=$eWjiX.BB.ctx(e),a=Math.min(e.width,(t+1)*n)-t*n,s=Math.min(e.height,(i+1)*n)-i*n;if(a<=0||s<=0)throw Error("invalid out-of-bounds tile");return r.getImageData(t*n,i*n,a,s)}var $gWfkn=parcelRequire("gWfkn"),$eg83P=parcelRequire("eg83P"),$7jh4K=parcelRequire("7jh4K");function $3798530d3967d87a$export$2098fe43203ddd32(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$gWfkn.HISTORY_TILE_SIZE;e={x1:Math.min(e.x1,e.x2),y1:Math.min(e.y1,e.y2),x2:Math.max(e.x1,e.x2),y2:Math.max(e.y1,e.y2)};var r=(0,$eg83P.boundsInArea)(e,t,i),a=Math.ceil(t/n),s=Math.ceil(i/n);if(!r)return(0,$7jh4K.createArray)(a*s,!1);for(var o=(0,$7jh4K.createArray)(a*s,!1),l={x1:(0,$eg83P.clamp)(Math.floor(e.x1/n),0,a-1),y1:(0,$eg83P.clamp)(Math.floor(e.y1/n),0,s-1),x2:(0,$eg83P.clamp)(Math.floor(e.x2/n),0,a-1),y2:(0,$eg83P.clamp)(Math.floor(e.y2/n),0,s-1)},h=l.x1;h<=l.x2;h++)for(var c=l.y1;c<=l.y2;c++)o[c*a+h]=!0;return o}function $3798530d3967d87a$export$1774f90c6da5013c(e,t){return t.map(function(t,i){return t||!!e[i]})}var $871c020f286838cc$export$3d7bd55e322555b1=function(e){return new ImageData(new Uint8ClampedArray(e.data),e.width,e.height)},$7jh4K=parcelRequire("7jh4K");function $90d1e8bd87cfe19c$export$55941c74c8f934(e){return{id:(0,$7jh4K.randomUuid)(),data:e}}function $90d1e8bd87cfe19c$export$1a44c122b8668cb(e){return{id:(0,$7jh4K.randomUuid)(),data:$871c020f286838cc$export$3d7bd55e322555b1(e.data)}}function $1a6c9997bc8182ff$export$6706c882ea9c3dbd(e,t){for(var i=[],n=Math.ceil(e.width/$gWfkn.HISTORY_TILE_SIZE),r=Math.ceil(e.height/$gWfkn.HISTORY_TILE_SIZE),a=0;a<r;a++)for(var s=0;s<n;s++)i.push(t[a*n+s]?$90d1e8bd87cfe19c$export$55941c74c8f934($9497dda3f00e23d9$export$6b742be78fc940fb(e,s,a,$gWfkn.HISTORY_TILE_SIZE)):void 0);return i}function $1a6c9997bc8182ff$export$7b1ba44282f9a519(e,t){if(t){var i=$3798530d3967d87a$export$2098fe43203ddd32(t,e.width,e.height);return $1a6c9997bc8182ff$export$6706c882ea9c3dbd(e,i)}for(var n=e.getContext("2d").getImageData(0,0,e.width,e.height),r=Math.ceil(e.width/$gWfkn.HISTORY_TILE_SIZE),a=Math.ceil(e.height/$gWfkn.HISTORY_TILE_SIZE),s=[],o=0;o<a;o++)for(var l=0;l<r;l++){for(var h=l*$gWfkn.HISTORY_TILE_SIZE,c=o*$gWfkn.HISTORY_TILE_SIZE,u=Math.min($gWfkn.HISTORY_TILE_SIZE,e.width-h),d=Math.min($gWfkn.HISTORY_TILE_SIZE,e.height-c),p=new ImageData(u,d),f=0;f<d;f++){var g=((c+f)*e.width+h)*4,v=f*u*4;p.data.set(n.data.subarray(g,g+4*u),v)}s.push($90d1e8bd87cfe19c$export$55941c74c8f934(p))}return s}function $17f5ce4410029f54$var$createEntryLayer(e,t,i,n){var r="all"===t,a={};return(r||t.includes("name"))&&(a.name=e.name),(r||t.includes("opacity"))&&(a.opacity=e.opacity),(r||t.includes("isVisible"))&&(a.isVisible=e.isVisible),(r||t.includes("mixModeStr"))&&(a.mixModeStr=e.mixModeStr),(r||t.includes("index"))&&(a.index=e.index),(r||t.includes("tiles"))&&(a.tiles=null!=n?n:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.context.canvas,i)),a}function $17f5ce4410029f54$export$7cefb04ac49374c4(e){for(var t,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var a=null!=(t=n.find(function(e){return e&&!("layerId"in e)}))?t:{attributes:[]},s=n.filter(function(e){return!!e}).filter(function(e){return"layerId"in e});return Object.fromEntries(e.map(function(e,t){var i=!0,n=!1,r=void 0;try{for(var o,l=s[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var h=o.value;if(h.layerId===e.id)return[e.id,$17f5ce4410029f54$var$createEntryLayer(e,h.attributes,h.bounds,h.tiles)]}}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}return[e.id,$17f5ce4410029f54$var$createEntryLayer(e,a.attributes)]}))}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$esGm2=parcelRequire("esGm2"),$eWjiX=parcelRequire("eWjiX"),$gWfkn=parcelRequire("gWfkn"),$7nLJW=parcelRequire("7nLJW"),$ed54e2a153d1f006$export$a8c18874b9331404=function(){"use strict";function e(){(0,$cx0mh._)(this,e)}return(0,$7h4XF._)(e,[{key:"getColorAt",value:function(e,t,i){if(e=Math.floor(e),t=Math.floor(t),e<0||e>=i.size.width||t<0||t>=i.size.height)return new $eWjiX.BB.RGB(0,0,0);var n=$eWjiX.BB.canvas(1,1),r=$eWjiX.BB.ctx(n);r.imageSmoothingEnabled=!1;var a=Math.ceil(i.size.width/$gWfkn.HISTORY_TILE_SIZE),s=Math.floor(e/$gWfkn.HISTORY_TILE_SIZE),o=Math.floor(t/$gWfkn.HISTORY_TILE_SIZE)*a+s;Object.values(i.layerMap).sort($7nLJW.sortLayerMap).forEach(function(n){if(n.isVisible&&0!==n.opacity){var l=n.tiles[o],h="";if((0,$esGm2.isLayerFill)(l))h=l.fill;else{var c=$gWfkn.HISTORY_TILE_SIZE;i.size.width%$gWfkn.HISTORY_TILE_SIZE!=0&&s===a-1&&(c=i.size.width%$gWfkn.HISTORY_TILE_SIZE);var u=t%$gWfkn.HISTORY_TILE_SIZE*c+e%$gWfkn.HISTORY_TILE_SIZE;if(0===l.data.data[4*u+3])return;h=$eWjiX.BB.ColorConverter.toRgbaStr({r:l.data.data[4*u],g:l.data.data[4*u+1],b:l.data.data[4*u+2],a:l.data.data[4*u+3]/255})}r.fillStyle=h,r.globalAlpha=n.opacity,r.globalCompositeOperation=n.mixModeStr,r.fillRect(0,0,1,1)}});var l=r.getImageData(0,0,1,1);return new $eWjiX.BB.RGB(l.data[0],l.data[1],l.data[2])}}]),e}(),$7jh4K=parcelRequire("7jh4K"),$eg83P=parcelRequire("eg83P"),$eIcQa=parcelRequire("eIcQa");function $4ae5c842364e8628$export$6be4733fa804854c(e,t){var i=$2c64e9e8cb297da3$export$a04a50ae6d6450f8(e),n=(0,$eg83P.intBoundsWithinArea)(i,t.canvas.width,t.canvas.height,!0);if(n)return(0,$eIcQa.canvasBounds)(t,n)}function $f2ea5f654adc2709$export$199acb5b15c43176(e,t,i){return e.map(function(e){return e.map(function(e){return e.map(function(e){return[e[0]+t,e[1]+i]})})})}var $eWjiX=parcelRequire("eWjiX"),$eIcQa=parcelRequire("eIcQa");function $bdef137f4147ecbc$export$820c5732ce56544(e,t,i){var n=new Uint8Array(new ArrayBuffer(t*i)),r=$eWjiX.BB.canvas(t,i),a=$eWjiX.BB.ctx(r);(0,$eIcQa.drawSelectionMask)(e,a);var s=a.getImageData(0,0,t,i);$eWjiX.BB.freeCanvas(r);for(var o=t*i,l=0,h=0;l<o;l++,h+=4)n[l]=s.data[h]>>>7;return n}function $0621fc8724f6bfac$var$workaroundForChromium1281185(e){e.save(),e.fillStyle="rgba(0,0,0,0.01)",e.fillRect(-.9999999,-.9999999,1,1),e.restore()}var $0621fc8724f6bfac$export$9f4f73b1bd7c2f26=16,$0621fc8724f6bfac$var$KL_CANVAS_DEBUGGING=!1,$0621fc8724f6bfac$export$4a819bde91671014=function(){"use strict";function e(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,$cx0mh._)(this,e),this.layerNrOffset=n,this.isDestroyed=!1,this.selection=void 0,this.klHistory=t,this.layers=[],$0621fc8724f6bfac$var$KL_CANVAS_DEBUGGING&&(window.getCanvasLayers=function(){return i.layers}),this.eyedropper=new $ed54e2a153d1f006$export$a8c18874b9331404,this.width=0,this.height=0,this.updateViaComposed({projectId:{value:(0,$7jh4K.randomUuid)()},size:{width:0,height:0},activeLayerId:"",selection:{value:[]},layerMap:{}},this.klHistory.getComposed())}return(0,$7h4XF._)(e,[{key:"updateIndices",value:function(){this.layers.forEach(function(e,t){e.index=t})}},{key:"getSelectionOrFallback",value:function(){var e;return null!=(e=this.selection)?e:[[[[0,0],[this.width,0],[this.width,this.height],[0,this.height],[0,0]]]]}},{key:"reset",value:function(e){if(!e.width||!e.height||e.width<1||e.height<1||isNaN(e.width)||isNaN(e.height))throw Error("invalid canvas size");if(this.klHistory.pause(!0),this.width=e.width,this.height=e.height,this.selection=void 0,this.layers.splice(1,Math.max(0,this.layers.length-1)),e.layers)for(var t=0;t<e.layers.length;t++){var i=e.layers[t];this.layers[t]||this.addLayer();var n=this.layers[t];n.id=i.id,n.name=i.name,n.isVisible=i.isVisible,n.mixModeStr=i.mixModeStr?i.mixModeStr:"source-over",n.canvas.width=this.width,n.canvas.height=this.height,n.context.drawImage(i.image,0,0),this.setOpacity(t,i.opacity)}else{var r=this.layers[0];r.name=e.layerName?e.layerName:$8d7403abedf7cefa$export$ce37e184d908d785("layers-layer")+" 1",r.isVisible=!0,r.canvas.width=this.width,r.canvas.height=this.height,r.mixModeStr="source-over",this.setOpacity(0,1),e.color?this.layerFill(0,e.color):e.image&&r.context.drawImage(e.image,0,0)}if(this.updateIndices(),this.klHistory.pause(!1),!this.klHistory.isPaused()){var a,s={projectId:{value:null!=(a=e.projectId)?a:(0,$7jh4K.randomUuid)()},size:{width:this.width,height:this.height},selection:{value:this.selection},activeLayerId:this.layers[this.layers.length-1].id,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:"all"})};this.klHistory.push(s)}return this.layers.length-1}},{key:"isLayerLimitReached",value:function(){return this.layers.length>=$0621fc8724f6bfac$export$9f4f73b1bd7c2f26}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"setSize",value:function(e,t){this.width=e,this.height=t}},{key:"getLayerCount",value:function(){return this.layers.length}},{key:"resize",value:function(e,t){var i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"smooth";if(!e||!t||e===this.width&&t===this.height||isNaN(e)||isNaN(t)||e<1||t<1)return!1;if(e=Math.max(e,1),t=Math.max(t,1),"pixelated"===r){i=$eWjiX.BB.canvas(e,t);var a=$eWjiX.BB.ctx(i);a.imageSmoothingEnabled=!1;for(var s=0;s<this.layers.length;s++){s>0&&a.clearRect(0,0,e,t);var o=this.layers[s];a.drawImage(o.canvas,0,0,e,t),o.canvas.width=e,o.canvas.height=t,o.context.drawImage(i,0,0)}}else if("smooth"===r){i=$eWjiX.BB.canvas(),n=$eWjiX.BB.canvas();for(var l=0;l<this.layers.length;l++)$eWjiX.BB.resizeCanvas(this.layers[l].canvas,e,t,i,n)}else throw Error("unknown resize algorithm");return this.selection&&(this.selection=(0,$bbA6w.transformMultiPolygon)(this.selection,(0,$kFecW.scale)(e/this.width,t/this.height))),this.width=e,this.height=t,this.klHistory.push((0,$cL71g._)({size:{width:this.width,height:this.height},layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{})),!0}},{key:"resizeCanvas",value:function(e){var t=Math.round(e.left)+this.width+Math.round(e.right),i=Math.round(e.top)+this.height+Math.round(e.bottom),n=Math.round(e.left),r=Math.round(e.top);if(isNaN(t)||isNaN(i)||t<1||i<1)throw Error("KlCanvas.resizeCanvas - invalid canvas size");for(var a=0;a<this.layers.length;a++){var s=$eWjiX.BB.canvas(this.width,this.height),o=this.layers[a];$eWjiX.BB.ctx(s).drawImage(o.canvas,0,0),o.canvas.width=t,o.canvas.height=i,o.context.save(),0===a&&e.fillColor&&(o.context.fillStyle=$eWjiX.BB.ColorConverter.toRgbStr(e.fillColor),o.context.fillRect(0,0,t,i),o.context.clearRect(n,r,this.width,this.height)),o.context.drawImage(s,n,r),o.context.restore()}this.width=t,this.height=i,this.selection&&(this.selection=$f2ea5f654adc2709$export$199acb5b15c43176(this.selection,n,r)),this.klHistory.push((0,$cL71g._)({size:{width:this.width,height:this.height},layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}},{key:"addLayer",value:function(e,t){if(this.isLayerLimitReached())return!1;var i,n=void 0===e?this.layers.length:e+1,r=$eWjiX.BB.canvas(this.width,this.height),a=$eWjiX.BB.ctx(r);t&&("function"==typeof t.image?t.image(a):a.drawImage(t.image,0,0));var s=$47ad43347dcf2f3c$export$b2ce7a8a096070e2(),o={id:s,index:n,name:t&&void 0!==t.name?t.name:$8d7403abedf7cefa$export$ce37e184d908d785("layers-layer")+" "+(this.layers.length+this.layerNrOffset),mixModeStr:t&&null!=(i=t.mixModeStr)?i:"source-over",isVisible:!t||t.isVisible,opacity:t?t.opacity:1,canvas:r,context:a};return this.layers.splice(n,0,o),this.klHistory.pause(!0),this.setOpacity(n,1),this.klHistory.pause(!1),this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:s,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},{layerId:s,attributes:"all",tiles:t?void 0:$d031f92b803c75e5$export$9a1731baa7701cc7(this.width,this.height,"transparent")})}),n}},{key:"duplicateLayer",value:function(e){if(!this.layers[e]||this.isLayerLimitReached())return!1;var t=this.layers[e],i=e+1,n=this.klHistory.getComposed().layerMap[t.id],r=$eWjiX.BB.canvas(this.width,this.height),a=$eWjiX.BB.ctx(r),s=$47ad43347dcf2f3c$export$b2ce7a8a096070e2(),o={id:s,index:i,name:t.name+" "+$8d7403abedf7cefa$export$ce37e184d908d785("layers-copy"),mixModeStr:t.mixModeStr,isVisible:t.isVisible,opacity:t.opacity,canvas:r,context:a};this.layers.splice(i,0,o);var l=Math.ceil(this.width/$gWfkn.HISTORY_TILE_SIZE);return n.tiles.forEach(function(e,t){var i=t%l,n=Math.floor(t/l);a.save(),(0,$esGm2.isLayerFill)(e)?(a.fillStyle=e.fill,a.fillRect(i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE)):a.putImageData(e.data,i*$gWfkn.HISTORY_TILE_SIZE,n*$gWfkn.HISTORY_TILE_SIZE),a.restore()}),this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:s,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},{layerId:s,attributes:"all",tiles:n.tiles.map(function(e){return(0,$esGm2.isLayerFill)(e)?(0,$cL71g._)({},e):$90d1e8bd87cfe19c$export$1a44c122b8668cb(e)})})}),e+1}},{key:"getLayerContext",value:function(e,t){if(this.layers[e])return this.layers[e].context;if(t)return null;throw Error("layer of index "+e+" not found (in "+this.layers.length+" layers)")}},{key:"removeLayer",value:function(e){var t=this.layers[e];if(!t)return!1;$eWjiX.BB.freeCanvas(t.canvas),this.layers.splice(e,1),this.updateIndices();var i=Math.max(0,e-1),n=this.layers[i].id;return this.klHistory.isPaused()||this.klHistory.push({activeLayerId:n,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["index"]})}),i}},{key:"renameLayer",value:function(e,t){var i=this.layers[e];return!!i&&(i.name=t,this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["name"]})}),!0)}},{key:"setOpacity",value:function(e,t){if(this.layers[e]&&(t=Math.max(0,Math.min(1,t)),this.layers[e].opacity=t,!this.klHistory.isPaused())){var i=this.layers[e].id,n=$66a11a95db3a7e23$export$e173233eae155bba(this.klHistory.getEntries().at(-1).data,i);this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i,attributes:["opacity"]})},n)}}},{key:"setLayerIsVisible",value:function(e,t){if(this.layers[e])this.layers[e].isVisible=t;else throw Error(`layer ${e} undefined`);if(!this.klHistory.isPaused()){var i=this.layers[e].id,n=$ac5e0dd69c1dea2d$export$b706b44cfdbaaa7d(this.klHistory.getEntries().at(-1).data,i);this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i,attributes:["isVisible"]})},n)}}},{key:"moveLayer",value:function(e,t){if(0!==t&&this.layers[e]){var i=this.layers[e];this.layers.splice(e,1);var n=Math.max(0,Math.min(e+t,this.layers.length));return this.layers.splice(n,0,i),this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:this.layers[n].id,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["index"]})}),n}}},{key:"mergeLayers",value:function(e,t,i){if(this.layers[e]&&this.layers[t]&&e!==t){if(e>t){var n=e;e=t,t=n}var r=this.layers[t],a=this.layers[e];void 0===i&&(i=r.mixModeStr);var s=this.layers[t].opacity,o=r.opacity>0;if(o){var l=a.context;l.save(),"as-alpha"===i?($eWjiX.BB.convertToAlphaChannelCanvas(r.canvas),l.globalCompositeOperation="destination-in"):i&&(l.globalCompositeOperation=i),l.globalAlpha=s,l.drawImage(r.canvas,0,0),l.restore(),i&&$0621fc8724f6bfac$var$workaroundForChromium1281185(l)}return this.klHistory.pause(!0),this.removeLayer(t),this.klHistory.pause(!1),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:a.id,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},o?{layerId:a.id,attributes:"all"}:void 0)}),e}}},{key:"mergeAll",value:function(){if(1===this.layers.length)return!1;var e=this.layers[0];e.name=$8d7403abedf7cefa$export$ce37e184d908d785("layers-layer")+" 1";for(var t=e.context,i=1;i<this.layers.length;i++){var n=this.layers[i];n.isVisible&&0!==n.opacity&&(t.save(),t.globalCompositeOperation=n.mixModeStr,t.globalAlpha=n.opacity,t.drawImage(n.canvas,0,0),t.restore())}this.klHistory.pause(!0);for(var r=this.layers.length-1;r>0;r--)this.removeLayer(r);if(this.klHistory.pause(!1),!this.klHistory.isPaused()){var a=e.id;this.klHistory.push({activeLayerId:a,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})})}return 0}},{key:"rotate",value:function(e){for(;e<0;)e+=360;if(90==(e%=360)||180===e||270===e){var t,i=$eWjiX.BB.canvas();180===e?(i.width=this.width,i.height=this.height):(90===e||270===e)&&(i.width=this.height,i.height=this.width);var n=(0,$83Kse.identity)();90===e?n=(0,$dZ59l.compose)((0,$kr2fR.translate)(this.height,0),(0,$1RMPr.rotate)(Math.PI/2)):180===e?n=(0,$dZ59l.compose)((0,$kr2fR.translate)(this.width,this.height),(0,$1RMPr.rotate)(Math.PI)):270===e&&(n=(0,$dZ59l.compose)((0,$kr2fR.translate)(0,this.width),(0,$1RMPr.rotate)(3*Math.PI/2)));for(var r=$eWjiX.BB.ctx(i),a=0;a<this.layers.length;a++)r.clearRect(0,0,i.width,i.height),r.save(),(t=r).setTransform.apply(t,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(n))),r.drawImage(this.layers[a].canvas,0,0),r.restore(),this.layers[a].canvas.width=i.width,this.layers[a].canvas.height=i.height,this.layers[a].context.drawImage(i,0,0);this.width=i.width,this.height=i.height,this.selection&&(this.selection=(0,$bbA6w.transformMultiPolygon)(this.selection,n)),this.klHistory.push((0,$cL71g._)({size:{width:this.width,height:this.height},layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}}},{key:"flip",value:function(e,t,i){if(e||t){var n,r=$eWjiX.BB.canvas(this.width,this.height);r.width=this.width,r.height=this.height;for(var a=$eWjiX.BB.ctx(r),s=(0,$dZ59l.compose)((0,$kr2fR.translate)(r.width/2,r.height/2),(0,$kFecW.scale)(e?-1:1,t?-1:1),(0,$kr2fR.translate)(-r.width/2,-r.height/2)),o=0;o<this.layers.length;o++)(i||0===i)&&o!==i||(a.save(),a.clearRect(0,0,r.width,r.height),(n=a).setTransform.apply(n,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(s))),a.drawImage(this.layers[o].canvas,0,0),a.restore(),this.layers[o].context.clearRect(0,0,this.layers[o].canvas.width,this.layers[o].canvas.height),this.layers[o].context.drawImage(r,0,0));this.selection&&(this.selection=(0,$bbA6w.transformMultiPolygon)(this.selection,s));var l=void 0===i?void 0:this.layers[i];this.klHistory.push((0,$cL71g._)({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,l?{layerId:l.id,attributes:["tiles"]}:{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}}},{key:"drawOperation",value:function(e,t){var i=this.layers[e];t(i.context),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:i.id,layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"]})})}},{key:"layerFill",value:function(e,t,i,n){var r,a=this.layers[e].context;a.save();var s=!(n&&this.selection)&&void 0===i;if(i&&(a.globalCompositeOperation=i),n&&this.selection){var o=(0,$9b3eo.getSelectionPath2d)(this.selection);a.clip(o),r=(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection))}var l="rgba("+t.r+","+t.g+","+t.b+",1)";if(a.fillStyle=l,a.fillRect(0,0,this.layers[e].canvas.width,this.layers[e].canvas.height),a.restore(),a.save(),a.fillStyle="rgba(0,0,0,0.01)",a.fillRect(-.9999999,-.9999999,1,1),a.restore(),!this.klHistory.isPaused()){var h=this.layers[e];this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:h.id,attributes:["tiles"],tiles:s?$d031f92b803c75e5$export$9a1731baa7701cc7(this.width,this.height,l):void 0,bounds:r})})}}},{key:"floodFill",value:function(e,t,i,n,r,a,s,o,l){if(!(t<0)&&!(i<0)&&!(t>=this.width)&&!(i>=this.height)&&0!==r){if(a=Math.round(a),t=Math.round(t),i=Math.round(i),!["above","current","all"].includes(s))throw Error("invalid sampleStr");var h,c,u,d=this.selection?$bdef137f4147ecbc$export$820c5732ce56544(this.selection,this.width,this.height):void 0;if(!d||0!==d[i*this.width+t]){var p=this.layers[e];if("all"===s){var f=1===this.layers.length?this.layers[0].canvas:this.getCompleteCanvas(1);h=$7069db2f5e23d00f$export$13d50f258a8034f($eWjiX.BB.ctx(f).getImageData(0,0,this.width,this.height).data,d,this.width,this.height,t,i,a,Math.round(o),l),u=(c=p.context).getImageData(0,0,this.width,this.height)}else{var g="above"===s?e+1:e;if(g>=this.layers.length)return;var v=this.layers[g].context,m=v.getImageData(0,0,this.width,this.height);h=$7069db2f5e23d00f$export$13d50f258a8034f(m.data,d,this.width,this.height,t,i,a,Math.round(o),l),c=e===g?v:p.context,u=e===g?m:c.getImageData(0,0,this.width,this.height)}var y=u.data;if(n)if(1===r)for(var x=0;x<this.width*this.height;x++)255===h.data[x]&&(y[4*x]=n.r,y[4*x+1]=n.g,y[4*x+2]=n.b,y[4*x+3]=255);else for(var b=0;b<this.width*this.height;b++)255===h.data[b]&&(y[4*b]=$eWjiX.BB.mix(y[4*b],n.r,r),y[4*b+1]=$eWjiX.BB.mix(y[4*b+1],n.g,r),y[4*b+2]=$eWjiX.BB.mix(y[4*b+2],n.b,r),y[4*b+3]=$eWjiX.BB.mix(y[4*b+3],255,r));else if(1===r)for(var w=0;w<this.width*this.height;w++)255===h.data[w]&&(y[4*w+3]=0);else for(var k=0;k<this.width*this.height;k++)255===h.data[k]&&(y[4*k+3]=$eWjiX.BB.mix(y[4*k+3],0,r));c.putImageData(u,0,0),this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:p.id,attributes:["tiles"],bounds:h.bounds})})}}}},{key:"drawShape",value:function(e,t){if(t.x1!==t.x2||t.y1!==t.y2){var i=this.layers[e],n=this.selection?new Path2D((0,$9b3eo.getSelectionPath2d)(this.selection)):void 0,r=(0,$eg83P.integerBounds)($01d7180c5d1d0fdf$export$71b514a25c47df50(i.context,t,n));this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],bounds:r})})}}},{key:"drawGradient",value:function(e,t){var i=this.layers[e],n=this.selection?new Path2D((0,$9b3eo.getSelectionPath2d)(this.selection)):void 0;$5e45fa121ba5050f$export$b1f70a113e3b5c1b(i.context,t,n),this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"]})})}},{key:"text",value:function(e,t){var i=this.layers[e],n=$fdc12d72a3df9be9$export$482c90f94eb9717c(i.canvas,$eWjiX.BB.copyObj(t),this.selection?new Path2D((0,$9b3eo.getSelectionPath2d)(this.selection)):void 0),r=2+(t.stroke?t.stroke.lineWidth/2:0),a=$32a8ea052c2ead31$export$7efa1f930df882cc({x1:n.x,y1:n.y,x2:n.x+n.width,y2:n.y+n.height},(0,$dZ59l.compose)((0,$kr2fR.translate)(t.x,t.y),(0,$1RMPr.rotate)(-t.angleRad)));a=(0,$eg83P.integerBounds)({x1:a.x1-r,y1:a.y1-r,x2:a.x2+r,y2:a.y2+r}),this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],bounds:a})})}},{key:"eraseLayer",value:function(e){var t,i=this.layers[e.layerIndex],n=i.context;if(n.save(),e.useSelection&&this.selection){var r=(0,$9b3eo.getSelectionPath2d)(this.selection);n.clip(r),t=(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection))}e.useAlphaLock?n.globalCompositeOperation="source-in":n.globalCompositeOperation="destination-out",n.fillStyle=$eWjiX.BB.ColorConverter.toRgbStr($00f785a5ea9e210d$export$8627e24041b28589()),n.fillRect(0,0,this.width,this.height),n.restore();var a=!e.useAlphaLock&&!(e.useSelection&&this.selection);this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],tiles:a?$d031f92b803c75e5$export$9a1731baa7701cc7(this.width,this.height,"transparent"):void 0,bounds:t})})}},{key:"getKlHistory",value:function(){return this.klHistory}},{key:"getLayersRaw",value:function(){return this.layers}},{key:"getLayers",value:function(){return this.layers.map(function(e){return{id:e.id,canvas:e.canvas,context:e.context,isVisible:e.isVisible,opacity:e.opacity,name:e.name,mixModeStr:e.mixModeStr}})}},{key:"getLayersFast",value:function(){return this.layers.map(function(e){return(0,$cL71g._)({canvas:e.canvas,isVisible:e.isVisible,opacity:e.opacity,name:e.name,mixModeStr:e.mixModeStr},e.compositeObj?{compositeObj:e.compositeObj}:{})})}},{key:"getLayerIndex",value:function(e,t){for(var i=0;i<this.layers.length;i++)if(this.layers[i].canvas===e)return i;if(!t)throw Error("layer not found (in "+this.layers.length+" layers)");return null}},{key:"getLayerOld",value:function(e,t){if(this.layers[e])return{context:this.layers[e].context,isVisible:this.layers[e].isVisible,opacity:this.layers[e].opacity,name:this.layers[e].name,id:e};if(!t)throw Error("layer of index "+e+" not found (in "+this.layers.length+" layers)");return null}},{key:"getLayer",value:function(e){return this.layers[e]}},{key:"getColorAt",value:function(e,t){return this.eyedropper.getColorAt(e,t,this.klHistory.getComposed())}},{key:"getCompleteCanvas",value:function(e,t){return(0,$aSJRf.drawProject)(this.getProject(),e,t?this.selection:void 0)}},{key:"getProject",value:function(){return{projectId:this.klHistory.getComposed().projectId.value,width:this.width,height:this.height,layers:this.layers.map(function(e){return{name:e.name,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr,image:e.canvas}})}}},{key:"setMixMode",value:function(e,t){var i=this.layers[e];i.mixModeStr=t,this.klHistory.isPaused()||this.klHistory.push({layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["mixModeStr"]})})}},{key:"setComposite",value:function(e,t){if(!this.layers[e])throw Error("invalid layer");this.layers[e].compositeObj=t}},{key:"setSelection",value:function(e){(this.selection||e)&&(this.selection=e,this.klHistory.push({selection:{value:e}}))}},{key:"getSelection",value:function(){return this.selection}},{key:"getSelectionArea",value:function(e){var t=this.layers[e];return $4ae5c842364e8628$export$6be4733fa804854c(this.getSelectionOrFallback(),t.context)}},{key:"updateViaComposed",value:function(e,t){this.width=t.size.width,this.height=t.size.height,this.selection=t.selection.value,this.layers=$5d9e95126ab2b87f$export$cee5b735b1b9bad1(this.layers,e,t)}},{key:"destroy",value:function(){this.isDestroyed||(this.layers.forEach(function(e){$eWjiX.BB.freeCanvas(e.canvas),e.canvas={},e.context={}}),this.layers=[],this.isDestroyed=!0)}}]),e}();function $2f1281ced73ab1dc$export$6e1bedb2a6cdff30(e){if(!e)return $8d7403abedf7cefa$export$ce37e184d908d785("layers-blend-normal");var t={"source-over":"layers-blend-normal",darken:"layers-blend-darken",multiply:"layers-blend-multiply","color-burn":"layers-blend-color-burn",lighten:"layers-blend-lighten",screen:"layers-blend-screen","color-dodge":"layers-blend-color-dodge",overlay:"layers-blend-overlay","soft-light":"layers-blend-soft-light","hard-light":"layers-blend-hard-light",difference:"layers-blend-difference",exclusion:"layers-blend-exclusion",hue:"layers-blend-hue",saturation:"layers-blend-saturation",color:"layers-blend-color",luminosity:"layers-blend-luminosity"};if(!(e in t))throw Error("unknown blend mode");return $8d7403abedf7cefa$export$ce37e184d908d785(t[e])}var $eWjiX=parcelRequire("eWjiX");function $ac876b2e34c8d94f$export$28debfc111084e87(e,t,i){var n=$eWjiX.BB.el(),r=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-name")+":",css:{marginRight:"5px"}}),a=$eWjiX.BB.el({css:{display:"flex"}}),s=$eWjiX.BB.el({tagName:"input"});s.value=t,s.setAttribute("data-ignore-focus","true"),s.style.flexGrow="1";var o=$eWjiX.BB.el({tagName:"button",content:'<img src="'+$parcel$interopDefault($720ba2c010612610$exports)+'" height="20"/>',title:$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-clear"),css:{marginLeft:"10px"},onClick:function(){s.value="",s.focus()}}),l=[$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-sketch"),$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-colors"),$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-shading"),$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-lines"),$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-effects"),$8d7403abedf7cefa$export$ce37e184d908d785("background"),$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-foreground")],h=[],c=$eWjiX.BB.el({css:{display:"flex",flexWrap:"wrap",marginTop:"5px",marginLeft:"-5px"}});l.forEach(function(e){var t=$eWjiX.BB.el({parent:c,tagName:"button",content:e,onClick:function(){s.value=""+t.textContent},css:{margin:"5px 0 0 5px"}});h.push(t)}),n.append(r),r.append(a,c),a.append(s,o),setTimeout(function(){s.focus(),s.select()},10),$c902829f68f42bce$export$d7e8d4d4450c819c({target:e,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-title")}</b>`,div:n,buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename"),"Cancel"],primaries:[$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename")],callback:function(e){$eWjiX.BB.destroyEl(o),h.forEach(function(e){$eWjiX.BB.destroyEl(e)}),h.splice(0,h.length),e===$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename")?i(s.value):i(void 0)},clickOnEnter:$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename")})}var $eWjiX=parcelRequire("eWjiX");function $9eb64c51bad4097c$export$ee79aceabae6bb8a(e,t){var i=$eWjiX.BB.el();i.innerHTML=$8d7403abedf7cefa$export$ce37e184d908d785("layers-merge-description");var n=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:t.mixModeStr,label:$2f1281ced73ab1dc$export$6e1bedb2a6cdff30(t.mixModeStr)},{id:"source-in",label:"source-in"},{id:"source-out",label:"source-out"},{id:"source-atop",label:"source-atop"},{id:"destination-in",label:"destination-in"},{id:"destination-out",label:"destination-out"},{id:"destination-atop",label:"destination-atop"},{id:"xor",label:"xor"}],initId:t.mixModeStr,onChange:function(){l()},isSmall:!0,css:{marginTop:"5px"}});i.append(n.getElement());var r=$eWjiX.BB.fitInto(t.topCanvas.width,t.topCanvas.height,200,200,1),a=$eWjiX.BB.canvas(r.width,r.height);a.title=$8d7403abedf7cefa$export$ce37e184d908d785("preview"),a.className="kl-merge-preview";var s=$eWjiX.BB.el({content:"<br/>",css:{clear:"both"}});i.append(s,a);var o=$eWjiX.BB.copyCanvas(a);$eWjiX.BB.ctx(o).drawImage(t.topCanvas,0,0,o.width,o.height),$eWjiX.BB.convertToAlphaChannelCanvas(o);var l=function(){var e=$eWjiX.BB.ctx(a);e.save(),e.clearRect(0,0,a.width,a.height),a.width>t.topCanvas.width&&(e.imageSmoothingEnabled=!1),e.drawImage(t.bottomCanvas,0,0,a.width,a.height),"as-alpha"===n.getValue()?(e.globalCompositeOperation="destination-in",e.globalAlpha=t.topOpacity,e.drawImage(o,0,0,a.width,a.height)):(e.globalCompositeOperation=n.getValue(),e.globalAlpha=t.topOpacity,e.drawImage(t.topCanvas,0,0,a.width,a.height)),e.restore()};l();var h=new $eWjiX.BB.KeyListener({onDown:function(e){"right"===e&&n.next(),"left"===e&&n.previous()}});$c902829f68f42bce$export$d7e8d4d4450c819c({target:e,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("layers-merge-modal-title")}</b>`,div:i,buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(e){h.destroy(),n.destroy(),"Ok"===e&&t.callback(n.getValue())}})}var $7jh4K=parcelRequire("7jh4K"),$6J2My=parcelRequire("6J2My"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$72Jv0=parcelRequire("72Jv0"),$f65760a075b19ea7$export$e44a253a59704894=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.isExpanded=!1,this.onSetEnabled=function(){return 0};var n=$075b9fd415bad4ff$export$db3b6bfb95261072("button,w-full,h-full",[t.button]);n.onclick=function(){o(!i.isExpanded)},t.buttonTitle&&(n.title=t.buttonTitle),(0,$72Jv0.makeUnfocusable)(n);var r=[],a={};t.items.forEach(function(e){var i=$075b9fd415bad4ff$export$db3b6bfb95261072("button",e[1]);(0,$72Jv0.makeUnfocusable)(i),i.onclick=function(){o(!1),t.onItemClick(e[0])},r.push(i),a[e[0]]=i}),this.onSetEnabled=function(e,t){a[e].disabled=!t};var s=$075b9fd415bad4ff$export$db3b6bfb95261072(".kl-dropdown-menu,right-0,top-full,nowrap,hidden",r);this.rootElement=$075b9fd415bad4ff$export$db3b6bfb95261072(",pos-relative",[n,s]);var o=function(e){i.isExpanded=e,s.style.display=i.isExpanded?"":"none",i.isExpanded?(document.addEventListener("pointerdown",l,{passive:!1}),window.addEventListener("blur",h)):(document.removeEventListener("pointerdown",l),window.removeEventListener("blur",h))},l=function(e){var t=e.target;n.contains(t)||s.contains(t)||o(!1)},h=function(){return o(!1)}}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootElement}},{key:"setEnabled",value:function(e,t){this.onSetEnabled(e,t)}}]),e}(),$46a8fca82ef6ceef$exports={};$46a8fca82ef6ceef$exports=$parcel$resolve("1mb1v");var $ff6378202995f780$exports={};$ff6378202995f780$exports=$parcel$resolve("11KJK");var $61b1afb588560014$exports={};$61b1afb588560014$exports=$parcel$resolve("floUo");var $1d893fdc8bec1e3c$exports={};$1d893fdc8bec1e3c$exports=$parcel$resolve("hhQeq");var $6fd1f44a6252da08$exports={};$6fd1f44a6252da08$exports=$parcel$resolve("dz3mY");var $80fe9e104a165bce$exports={};$80fe9e104a165bce$exports=$parcel$resolve("iPQe1");var $72Jv0=parcelRequire("72Jv0"),$615843517fb18518$var$paddingLeft=25,$615843517fb18518$export$c3bf51e04f391d6d=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.lastpos=0,this.layerHeight=35,this.layerSpacing=0,this.klCanvas=t.klCanvas,this.onSelect=t.onSelect,this.parentEl=t.parentEl,this.uiState=t.uiState,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.onUpdateProject=t.onUpdateProject,this.onClearLayer=t.onClearLayer,this.layerElArr=[],this.layerHeight=35,this.layerSpacing=0;var r=270;this.largeThumbDiv=$eWjiX.BB.el({onClick:$eWjiX.BB.handleClick,css:{position:"absolute",top:"500px",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",pointerEvents:"none",padding:"0",border:"1px solid #aaa",transition:"opacity 0.3s ease-out",userSelect:"none",background:"var(--kl-checkerboard-background)"}}),this.setUiState(this.uiState),this.largeThumbCanvas=$eWjiX.BB.canvas(200,200),this.largeThumbCanvas.style.display="block",this.largeThumbDiv.append(this.largeThumbCanvas),this.largeThumbInDocument=!1,this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=this.klCanvasLayerArr.length-1,this.rootEl=$eWjiX.BB.el({css:{marginRight:"10px",marginBottom:"10px",marginLeft:"10px",marginTop:"10px",cursor:"default",position:"relative",zIndex:"0"}});var a=$eWjiX.BB.el({css:{width:r+"px",position:"relative",margin:"0 -10px",zIndex:"0"}});this.layerListEl=$eWjiX.BB.el({parent:a}),this.addBtn=$eWjiX.BB.el({tagName:"button"}),this.duplicateBtn=$eWjiX.BB.el({tagName:"button"}),this.mergeBtn=$eWjiX.BB.el({tagName:"button"}),this.removeBtn=$eWjiX.BB.el({tagName:"button"});var s=$eWjiX.BB.el({tagName:"button"});this.moreDropdown=new $f65760a075b19ea7$export$e44a253a59704894({button:$eWjiX.BB.el({content:`<img src="${$parcel$interopDefault($6fd1f44a6252da08$exports)}" width="13"/>`,css:{display:"flex",justifyContent:"center",opacity:"0.9"}}),buttonTitle:$8d7403abedf7cefa$export$ce37e184d908d785("more"),items:[["clear-layer",$8d7403abedf7cefa$export$ce37e184d908d785("layers-clear")],["advanced-merge",$8d7403abedf7cefa$export$ce37e184d908d785("layers-merge-advanced")],["merge-all",$8d7403abedf7cefa$export$ce37e184d908d785("layers-merge-all")]],onItemClick:function(e){if("clear-layer"===e&&(n.applyUncommitted(),n.onClearLayer()),"advanced-merge"===e){if(n.applyUncommitted(),n.selectedSpotIndex<=0)return;$9eb64c51bad4097c$export$ee79aceabae6bb8a(n.parentEl,{topCanvas:n.klCanvasLayerArr[n.selectedSpotIndex].context.canvas,bottomCanvas:n.klCanvasLayerArr[n.selectedSpotIndex-1].context.canvas,topOpacity:n.klCanvas.getLayerOld(n.selectedSpotIndex).opacity,mixModeStr:n.klCanvasLayerArr[n.selectedSpotIndex].mixModeStr,callback:function(e){n.klCanvas.mergeLayers(n.selectedSpotIndex,n.selectedSpotIndex-1,e),n.klCanvasLayerArr=n.klCanvas.getLayers(),n.selectedSpotIndex--,n.onSelect(n.selectedSpotIndex,!1),n.updateButtons()}})}if("merge-all"===e){n.applyUncommitted();var t=n.klCanvas.mergeAll();if(!1===t)return;n.klCanvasLayerArr=n.klCanvas.getLayers(),n.selectedSpotIndex=t,n.onSelect(n.selectedSpotIndex,!1),n.updateButtons()}}}),this.updateButtons();var o=function(){var e=$eWjiX.BB.el();return setTimeout(function(){(0,$72Jv0.makeUnfocusable)(n.addBtn),(0,$72Jv0.makeUnfocusable)(n.duplicateBtn),(0,$72Jv0.makeUnfocusable)(n.mergeBtn),(0,$72Jv0.makeUnfocusable)(n.removeBtn),(0,$72Jv0.makeUnfocusable)(s);var t={cssFloat:"left",paddingLeft:"5px",paddingRight:"3px"};(0,$7jh4K.css)(n.addBtn,t),(0,$7jh4K.css)(n.duplicateBtn,t),(0,$7jh4K.css)(n.mergeBtn,t),(0,$7jh4K.css)(n.removeBtn,t),(0,$7jh4K.css)(s,{cssFloat:"left",height:"30px",lineHeight:"20px"}),n.addBtn.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-new"),n.duplicateBtn.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-duplicate"),n.removeBtn.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-remove"),n.mergeBtn.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-merge"),s.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-rename-title"),n.addBtn.innerHTML="<img src='"+$parcel$interopDefault($46a8fca82ef6ceef$exports)+"' height='20'/>",n.duplicateBtn.innerHTML="<img src='"+$parcel$interopDefault($ff6378202995f780$exports)+"' height='20'/>",n.mergeBtn.innerHTML="<img src='"+$parcel$interopDefault($61b1afb588560014$exports)+"' height='20'/>",n.removeBtn.innerHTML="<img src='"+$parcel$interopDefault($720ba2c010612610$exports)+"' height='20'/>",s.innerHTML="<img src='"+$parcel$interopDefault($1d893fdc8bec1e3c$exports)+"' height='20'/>",e.append($075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-5,mb-10",[n.addBtn,n.removeBtn,n.duplicateBtn,n.mergeBtn,$075b9fd415bad4ff$export$db3b6bfb95261072({className:"kl-info-btn",onClick:function(){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:document.body,message:'Advanced merge dialog moved to: <br> More > Advanced Merge<br><br><img src="'+$parcel$interopDefault($80fe9e104a165bce$exports)+'">'})},noRef:!0,css:{marginTop:"5px",fontWeight:"normal"}},"i"),s,$075b9fd415bad4ff$export$db3b6bfb95261072(",grow-1"),n.moreDropdown.getElement()])),n.addBtn.onclick=function(){n.applyUncommitted(),!1!==n.klCanvas.addLayer(n.selectedSpotIndex)&&(n.klCanvasLayerArr=n.klCanvas.getLayers(),n.selectedSpotIndex=n.selectedSpotIndex+1,n.onSelect(n.selectedSpotIndex,!1),n.updateButtons())},n.duplicateBtn.onclick=function(){n.applyUncommitted(),!1!==n.klCanvas.duplicateLayer(n.selectedSpotIndex)&&(n.klCanvasLayerArr=n.klCanvas.getLayers(),n.selectedSpotIndex++,n.onSelect(n.selectedSpotIndex,!1),n.updateButtons())},n.removeBtn.onclick=function(){n.applyUncommitted(),n.layerElArr.length<=1||(n.klCanvas.removeLayer(n.selectedSpotIndex),n.selectedSpotIndex>0&&n.selectedSpotIndex--,n.klCanvasLayerArr=n.klCanvas.getLayers(),n.onSelect(n.selectedSpotIndex,!1),n.updateButtons())},n.mergeBtn.onclick=function(){n.applyUncommitted(),n.selectedSpotIndex<=0||(n.klCanvas.mergeLayers(n.selectedSpotIndex,n.selectedSpotIndex-1),n.klCanvasLayerArr=n.klCanvas.getLayers(),n.selectedSpotIndex--,n.onSelect(n.selectedSpotIndex,!1),n.updateButtons())},s.onclick=function(){n.applyUncommitted(),n.renameLayer(n.selectedSpotIndex)}},1),e};this.rootEl.append(o()),i=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("layers-blending")+"&nbsp;",css:{fontSize:"15px"}}),this.modeSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:["source-over",void 0,"darken","multiply","color-burn",void 0,"lighten","screen","color-dodge",void 0,"overlay","soft-light","hard-light",void 0,"difference","exclusion",void 0,"hue","saturation","color","luminosity"].map(function(e){return e?[e,$2f1281ced73ab1dc$export$6e1bedb2a6cdff30(e)]:void 0}),onChange:function(e){n.klCanvas.setMixMode(n.selectedSpotIndex,e),n.update(n.selectedSpotIndex)},css:{marginBottom:"10px"},name:"layer-blend-mode"}),i.append(this.modeSelect.getElement()),this.rootEl.append(i),this.rootEl.append(a),this.klHistory.addListener(function(){"block"===n.rootEl.style.display&&n.createLayerList()}),this.createLayerList()}return(0,$7h4XF._)(e,[{key:"move",value:function(e,t){var i=this;if(isNaN(e)||isNaN(t))throw"layers-ui - invalid move";for(var n=0;n<this.klCanvasLayerArr.length;n++)!function(n){var r=i.layerElArr[n].spot;i.layerElArr[n].spot===e?r=t:(i.layerElArr[n].spot>e&&r--,r>=t&&r++),i.layerElArr[n].spot=r,i.layerElArr[n].posY=(i.layerHeight+i.layerSpacing)*(i.klCanvasLayerArr.length-r-1),i.layerElArr[n].style.top=i.layerElArr[n].posY+"px"}(n);e!==t&&(this.applyUncommitted(),this.klCanvas.moveLayer(this.selectedSpotIndex,t-e),this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=t,this.mergeBtn.disabled=0===this.selectedSpotIndex)}},{key:"posToSpot",value:function(e){var t=parseInt(""+(e/(this.layerHeight+this.layerSpacing)+.5));return t=Math.min(this.klCanvasLayerArr.length-1,Math.max(0,t)),t=this.klCanvasLayerArr.length-t-1}},{key:"updateLayersVerticalPosition",value:function(e,t){if((t=Math.min(this.klCanvasLayerArr.length-1,Math.max(0,t)))!==this.lastpos){for(var i=0;i<this.klCanvasLayerArr.length;i++)if(this.layerElArr[i].spot!==e){var n=this.layerElArr[i].spot;this.layerElArr[i].spot>e&&n--,n>=t&&n++,this.layerElArr[i].posY=(this.layerHeight+this.layerSpacing)*(this.klCanvasLayerArr.length-n-1),this.layerElArr[i].style.top=this.layerElArr[i].posY+"px"}this.lastpos=t}}},{key:"renameLayer",value:function(e){var t=this;$ac876b2e34c8d94f$export$28debfc111084e87(this.parentEl,this.klCanvas.getLayerOld(e).name,function(i){void 0!==i&&i!==t.klCanvas.getLayerOld(e).name&&(t.klCanvas.renameLayer(e,i),t.onSelect(e,!1))})}},{key:"updateHeight",value:function(){this.layerListEl.style.height=35*this.layerElArr.length+"px"}},{key:"createLayerList",value:function(e){var t=this;if(this.klHistory.getChangeCount()!==this.oldHistoryState||e){this.oldHistoryState=this.klHistory.getChangeCount(),this.klCanvasLayerArr=this.klCanvas.getLayers();var i=function(e){var i,n=(0,$7jh4K.throwIfNull)(t.klCanvas.getLayerOld(e)),r=n.name,a=t.klCanvasLayerArr[e].opacity,s=n.isVisible,o=t.klCanvasLayerArr[e].context.canvas,l=$eWjiX.BB.el({className:"kl-layer"});t.layerElArr[e]=l,l.posY=(t.klCanvasLayerArr.length-1)*35-35*e,(0,$7jh4K.css)(l,{top:l.posY+"px"});var h=$eWjiX.BB.el();(0,$7jh4K.css)(h,{position:"relative"});var c=$eWjiX.BB.el();(0,$7jh4K.css)(c,{width:"270px",height:"34px"});var u=$eWjiX.BB.el();l.append(h),h.append(c,u),l.spot=e;var d=$eWjiX.BB.el({tagName:"label",parent:c,title:$8d7403abedf7cefa$export$ce37e184d908d785("layers-visibility-toggle"),css:{display:"flex",width:"25px",height:"100%",justifyContent:"right",alignItems:"center",cursor:"pointer"}}),p=$eWjiX.BB.el({tagName:"input",parent:d,custom:{type:"checkbox",tabindex:"-1",name:"layer-visibility"},css:{display:"block",cursor:"pointer",margin:"0",marginRight:"5px"}});p.checked=s,p.onchange=function(){t.klCanvas.setLayerIsVisible(l.spot,p.checked),l.spot===t.selectedSpotIndex&&t.onSelect(t.selectedSpotIndex,!1)};var f=function(e){e.preventDefault(),e.stopPropagation()};$6J2My.HAS_POINTER_EVENTS?d.onpointerdown=f:d.onmousedown=f;var g=$eWjiX.BB.fitInto(o.width,o.height,30,30,1);l.thumb=$eWjiX.BB.canvas(g.width,g.height);var v=$eWjiX.BB.ctx(l.thumb);v.save(),l.thumb.width>o.width&&(v.imageSmoothingEnabled=!1),v.drawImage(o,0,0,l.thumb.width,l.thumb.height),v.restore(),(0,$7jh4K.css)(l.thumb,{position:"absolute",left:(32-l.thumb.width)/2+$615843517fb18518$var$paddingLeft+"px",top:(32-l.thumb.height)/2+1+"px",background:"var(--kl-checkerboard-background)"}),l.label=$eWjiX.BB.el({className:"kl-layer__label"}),l.layerName=r,l.label.append(l.layerName),(0,$7jh4K.css)(l.label,{position:"absolute",left:38+$615843517fb18518$var$paddingLeft+"px",top:"1px",fontSize:"13px",width:"165px",height:"20px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),l.label.ondblclick=function(){t.applyUncommitted(),t.renameLayer(l.spot)},l.opacityLabel=$eWjiX.BB.el({className:"kl-layer__opacity-label"}),l.opacity=a,l.opacityLabel.append(parseInt(""+100*l.opacity)+"%"),(0,$7jh4K.css)(l.opacityLabel,{position:"absolute",left:189+$615843517fb18518$var$paddingLeft+"px",top:"1px",fontSize:"13px",textAlign:"right",width:"50px",transition:"color 0.2s ease-in-out",textDecoration:s?void 0:"line-through"});var m=new $5e81242a941997c7$export$ac00cea56cec3037({init:l.opacity,width:200,pointSize:14,callback:function(e,n,r){if(n){i=t.klCanvas.getLayerOld(l.spot).opacity,t.klHistory.pause(!0);return}if(r){t.klHistory.pause(!1),i!==e&&t.klCanvas.setOpacity(l.spot,e);return}l.opacityLabel.innerHTML=Math.round(100*e)+"%",t.klCanvas.setOpacity(l.spot,e),t.onUpdateProject()}});(0,$7jh4K.css)(m.getElement(),{position:"absolute",left:39+$615843517fb18518$var$paddingLeft+"px",top:"17px"}),l.opacitySlider=m,l.thumb.onpointerover=function(e){if(0===e.buttons||e.pointerType&&"touch"===e.pointerType){var i=$eWjiX.BB.fitInto(o.width,o.height,250,250,1);(t.largeThumbCanvas.width!==i.width||t.largeThumbCanvas.height!==i.height)&&(t.largeThumbCanvas.width=i.width,t.largeThumbCanvas.height=i.height);var n=$eWjiX.BB.ctx(t.largeThumbCanvas);n.save(),t.largeThumbCanvas.width>o.width&&(n.imageSmoothingEnabled=!1),n.imageSmoothingQuality="high",n.clearRect(0,0,t.largeThumbCanvas.width,t.largeThumbCanvas.height),n.drawImage(o,0,0,t.largeThumbCanvas.width,t.largeThumbCanvas.height),n.restore(),(0,$7jh4K.css)(t.largeThumbDiv,{top:e.clientY-t.largeThumbCanvas.height/2+"px",opacity:"0"}),t.largeThumbInDocument||(document.body.append(t.largeThumbDiv),t.largeThumbInDocument=!0),clearTimeout(t.largeThumbInTimeout),t.largeThumbInTimeout=setTimeout(function(){(0,$7jh4K.css)(t.largeThumbDiv,{opacity:"1"})},20),clearTimeout(t.largeThumbTimeout)}},l.thumb.onpointerout=function(){clearTimeout(t.largeThumbInTimeout),(0,$7jh4K.css)(t.largeThumbDiv,{opacity:"0"}),clearTimeout(t.largeThumbTimeout),t.largeThumbTimeout=setTimeout(function(){t.largeThumbInDocument&&(t.largeThumbDiv.remove(),t.largeThumbInDocument=!1)},300)},c.append(l.thumb,l.label,l.opacityLabel,m.getElement());var y=!1,x=!1,b=function(e){if("pointerdown"===e.type&&"left"===e.button)(0,$7jh4K.css)(l,{transition:"box-shadow 0.3s ease-in-out",zIndex:"1"}),t.lastpos=l.spot,x=!1,l.isSelected||(x=!0,t.activateLayer(l.spot)),y=!0;else if("pointermove"===e.type&&"left"===e.button){y&&(y=!1,(0,$7jh4K.css)(l,{boxShadow:"1px 3px 5px rgba(0,0,0,0.4)"})),l.posY+=e.dY;var i=Math.max(0,Math.min((t.klCanvasLayerArr.length-1)*35,l.posY));l.style.top=i+"px",t.updateLayersVerticalPosition(l.spot,t.posToSpot(l.posY))}if("pointerup"===e.type){(0,$7jh4K.css)(l,{transition:"all 0.1s linear"}),setTimeout(function(){(0,$7jh4K.css)(l,{boxShadow:""})},20),l.posY=Math.max(0,Math.min((t.klCanvasLayerArr.length-1)*35,l.posY)),l.style.zIndex="";var n=t.posToSpot(l.posY),r=l.spot;t.move(l.spot,n),r!=n&&t.onSelect(t.selectedSpotIndex,!1),r===n&&x&&(t.applyUncommitted(),t.onSelect(t.selectedSpotIndex,!0)),x=!1}};l.pointerListener=new $eWjiX.BB.PointerListener({target:c,onPointer:b}),t.layerListEl.append(l)};for(this.layerElArr=[];this.layerListEl.firstChild;){var n=this.layerListEl.firstChild;n.pointerListener.destroy(),n.opacitySlider.destroy(),n.remove()}for(var r=0;r<this.klCanvasLayerArr.length;r++)i(r);this.activateLayer(this.selectedSpotIndex),this.updateHeight()}}},{key:"updateButtons",value:function(){var e=this.klCanvasLayerArr.length===$0621fc8724f6bfac$export$9f4f73b1bd7c2f26,t=1===this.klCanvasLayerArr.length;this.addBtn.disabled=e,this.removeBtn.disabled=t,this.duplicateBtn.disabled=e,this.mergeBtn.disabled=0===this.selectedSpotIndex,this.moreDropdown.setEnabled("advanced-merge",!t),this.moreDropdown.setEnabled("merge-all",!t)}},{key:"update",value:function(e){var t=this;this.klCanvasLayerArr=this.klCanvas.getLayers(),(e||0===e)&&(this.selectedSpotIndex=e),this.updateButtons(),setTimeout(function(){return t.createLayerList()},1)}},{key:"getSelected",value:function(){return this.selectedSpotIndex}},{key:"activateLayer",value:function(e){if(e<0||e>this.layerElArr.length-1)throw"invalid spotIndex "+e+", layerElArr.length "+this.layerElArr.length;this.selectedSpotIndex=e,this.modeSelect.setValue(this.klCanvasLayerArr[this.selectedSpotIndex].mixModeStr);for(var t=0;t<this.layerElArr.length;t++){var i=this.layerElArr[t],n=this.selectedSpotIndex===i.spot;(0,$7jh4K.css)(i,{boxShadow:""}),i.classList.toggle("kl-layer--selected",n),i.opacitySlider.setActive(n),i.isSelected=n}this.mergeBtn.disabled=0===this.selectedSpotIndex}},{key:"setUiState",value:function(e){this.uiState=e,"left"===this.uiState?(0,$7jh4K.css)(this.largeThumbDiv,{left:"280px",right:""}):(0,$7jh4K.css)(this.largeThumbDiv,{left:"",right:"280px"})}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$e6889b231e436752$export$e258ade1648009b7=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.layers=t.layers;var n=t.width/t.layers[0].image.width,r=n>1?t.layers[0].image.width:t.width,a=n>1?t.layers[0].image.height:t.height;this.canvas=$eWjiX.BB.canvas(r,a),this.ctx=$eWjiX.BB.ctx(this.canvas),(0,$7jh4K.css)(this.canvas,{width:"100%",height:"100%",imageRendering:n>1?"pixelated":void 0,background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}),setTimeout(function(){return i.render()},0)}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.canvas}},{key:"render",value:function(){if(this.ctx){this.ctx.save(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var e=0;e<this.layers.length;e++){var t=this.layers[e];t.isVisible&&0!==t.opacity&&(this.ctx.globalAlpha=this.layers[e].opacity,this.ctx.globalCompositeOperation=this.layers[e].mixModeStr,this.canvas.width>this.layers[e].image.width&&(this.ctx.imageSmoothingEnabled=!1),this.ctx.drawImage(this.layers[e].image,0,0,this.canvas.width,this.canvas.height))}this.ctx.restore()}}},{key:"destroy",value:function(){}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$416711db5dd64cf1$exports={};$416711db5dd64cf1$exports=$parcel$resolve("045N6");var $eWjiX=parcelRequire("eWjiX");function $6c5cb3001c773523$export$958c2bfe8d7142a9(e){if(Math.abs(e.angleDeg)%90==0){e.width=Math.round(e.width),e.height=Math.round(e.height);var t=Math.abs(e.angleDeg-90)%180==0;e.x=(t?e.height:e.width)%2==0?Math.round(e.x):Math.round(e.x-.5)+.5,e.y=(t?e.width:e.height)%2==0?Math.round(e.y):Math.round(e.y-.5)+.5}}function $6c5cb3001c773523$export$6a4549ec4168874a(e,t,i){var n=e-i.x,r=t-i.y,a=$eWjiX.BB.rotateAround({x:0,y:0},{x:n,y:r},-i.angleDeg);return{x:n=a.x,y:r=a.y}}function $6c5cb3001c773523$export$3fba3b383c654cc6(e,t,i){var n=$eWjiX.BB.rotateAround({x:0,y:0},{x:e,y:t},i.angleDeg);return{x:n.x+i.x,y:n.y+i.y}}var $7jh4K=parcelRequire("7jh4K");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$eg83P=parcelRequire("eg83P"),$0370167ee97a20d9$var$gripSize=16,$0370167ee97a20d9$var$edgeSize=10;function $0370167ee97a20d9$var$angleDegToCursor(e){for(var t=["e","ne","n","nw","w","sw","s","se"];e<0;)e+=360;var i=Math.round(e/45)%t.length;return t[i]+"-resize"}var $0370167ee97a20d9$export$79a74567acf241b0=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e);var r=function(){s.x=0,s.y=0};this.rectInViewport={x:0,y:0,width:0,height:0,corners:[{x:0,y:0}]},this.minSnapDist=7,this.corners=[],this.edges=[],this.viewportTransform=(0,$cL71g._)({},t.viewportTransform),this.value={x:t.x,y:t.y,width:t.width,height:t.height,angleDeg:t.angleDeg},this.isConstrained=t.isConstrained,this.snapX=t.snapX,this.snapY=t.snapY,this.callback=t.callback,this.snappingEnabled=!0,this.ratio=this.value.width/this.value.height;var a=t.onWheel?function(e){if(t.onWheel&&t.wheelParent){var i=t.wheelParent.getBoundingClientRect();e.relX=e.pageX-i.left,e.relY=e.pageY-i.top,t.onWheel(e)}}:void 0;this.rootEl=$eWjiX.BB.el({className:"kl-free-transform",css:{userSelect:"none"}}),this.transEl=$eWjiX.BB.el({parent:this.rootEl,css:{position:"absolute"}}),this.boundsEl=$eWjiX.BB.el({css:{position:"absolute",cursor:"move",boxShadow:"rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px"}});var s={x:0,y:0};this.keyListener=new $eWjiX.BB.KeyListener({});var o={x:0,y:0};this.boundsPointerListener=new $eWjiX.BB.PointerListener({target:this.boundsEl,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointerdown"===e.type&&(o={x:n.value.x,y:n.value.y}),"pointermove"===e.type&&"left"===e.button){var t=$92816524e1b72be4$export$ad1d215dd03fe75a(n.viewportTransform),i=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(t),{x:e.downPageX,y:e.downPageY}),r=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(t),{x:e.pageX,y:e.pageY}),a={x:r.x-i.x,y:r.y-i.y};n.value.x=o.x+a.x,n.value.y=o.y+a.y;var s={distX:-1,distY:-1};if(n.snappingEnabled){for(h=0;h<n.snapX.length;h++)(l=Math.abs(n.value.x-n.snapX[h]))<n.minSnapDist/n.viewportTransform.scale&&(void 0===s.x||l<s.distX)&&(s.x=n.snapX[h],s.distX=l);for(h=0;h<n.snapY.length;h++)(l=Math.abs(n.value.y-n.snapY[h]))<n.minSnapDist/n.viewportTransform.scale&&(void 0===s.y||l<s.distY)&&(s.y=n.snapY[h],s.distY=l);for(h=0;h<4;h++){var l,h,c=$6c5cb3001c773523$export$3fba3b383c654cc6(n.corners[h].x,n.corners[h].y,n.value),u=void 0;for(u=0;u<n.snapX.length;u++)(l=Math.abs(c.x-n.snapX[u]))<n.minSnapDist/n.viewportTransform.scale&&(void 0===s.x||l<s.distX)&&(s.x=n.snapX[u]-(c.x-n.value.x),s.distX=l);for(u=0;u<n.snapY.length;u++)(l=Math.abs(c.y-n.snapY[u]))<n.minSnapDist/n.viewportTransform.scale&&(void 0===s.y||l<s.distY)&&(s.y=n.snapY[u]-(c.y-n.value.y),s.distY=l)}}if("shift"===n.keyListener.getComboStr()){var d=$eWjiX.BB.projectPointOnLine({x:0,y:o.y},{x:10,y:o.y},{x:n.value.x,y:n.value.y}),p=$eWjiX.BB.dist(d.x,d.y,n.value.x,n.value.y);s={x:d.x,y:d.y,distX:p,distY:p},d=$eWjiX.BB.projectPointOnLine({x:o.x,y:0},{x:o.x,y:10},{x:n.value.x,y:n.value.y}),(p=$eWjiX.BB.dist(d.x,d.y,n.value.x,n.value.y))<s.distX&&(s={x:d.x,y:d.y,distX:p,distY:p}),d=$eWjiX.BB.projectPointOnLine({x:o.x,y:o.y},{x:o.x+1,y:o.y+1},{x:n.value.x,y:n.value.y}),(p=$eWjiX.BB.dist(d.x,d.y,n.value.x,n.value.y))<s.distX&&(s={x:d.x,y:d.y,distX:p,distY:p}),d=$eWjiX.BB.projectPointOnLine({x:o.x,y:o.y},{x:o.x+1,y:o.y-1},{x:n.value.x,y:n.value.y}),(p=$eWjiX.BB.dist(d.x,d.y,n.value.x,n.value.y))<s.distX&&(s={x:d.x,y:d.y,distX:p,distY:p})}void 0!=s.x&&(n.value.x=s.x),void 0!=s.y&&(n.value.y=s.y),Math.abs(n.value.angleDeg)%90==0&&($6c5cb3001c773523$export$958c2bfe8d7142a9(n.value),n.updateCornerPositions()),n.updateDOM()}},useDirtyWheel:!0,onWheel:a});for(var l=0;l<4;l++)!function(e){var t=n.corners[e]={i:e,el:$eWjiX.BB.el({css:{width:$0370167ee97a20d9$var$gripSize+"px",height:$0370167ee97a20d9$var$gripSize+"px",background:"#fff",borderRadius:$0370167ee97a20d9$var$gripSize+"px",position:"absolute",border:"2px solid #000"}}),x:0,y:0,virtualPos:{x:0,y:0}};t.updateDOM=function(){var i=[[-1,-1],[1,-1],[1,1],[-1,1]].map(function(e){return e[0]*=n.value.width>0?1:-1,e[1]*=n.value.height>0?1:-1,e}),r=10*!!(20>Math.abs(n.rectInViewport.width)||20>Math.abs(n.rectInViewport.height));(0,$7jh4K.css)(t.el,{left:n.rectInViewport.corners[t.i].x-$0370167ee97a20d9$var$gripSize/2+i[e][0]*r+"px",top:n.rectInViewport.corners[t.i].y-$0370167ee97a20d9$var$gripSize/2+i[e][1]*r+"px"});var a=n.value.width<0?-1:1,s=n.value.height<0?-1:1,o=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],l={x:o[e].x*a,y:-(o[e].y*s*1)},h=(0,$eg83P.pointsToAngleDeg)({x:0,y:0},l)-n.value.angleDeg-n.viewportTransform.angleDeg;(0,$7jh4K.css)(t.el,{cursor:$0370167ee97a20d9$var$angleDegToCursor(h)})},t.pointerListener=new $eWjiX.BB.PointerListener({target:n.corners[e].el,fixScribble:!0,onPointer:function(t){if(t.eventPreventDefault(),"pointerdown"===t.type&&"left"===t.button)n.corners[e].virtualPos=$6c5cb3001c773523$export$3fba3b383c654cc6(n.corners[e].x,n.corners[e].y,n.value);else if("pointermove"===t.type&&"left"===t.button){var i=$92816524e1b72be4$export$ad1d215dd03fe75a(n.viewportTransform),r=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),{x:0,y:0}),a=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),{x:t.dX,y:t.dY}),s={x:a.x-r.x,y:a.y-r.y};n.corners[e].virtualPos.x+=s.x,n.corners[e].virtualPos.y+=s.y;var o={x:n.corners[e].virtualPos.x,y:n.corners[e].virtualPos.y};o=n.constrainCorner(e,o.x,o.y),n.isConstrained||(o=n.snapCorner(o.x,o.y)),Math.abs(n.value.angleDeg)%90==0&&(o.x=Math.round(o.x),o.y=Math.round(o.y));var l=$6c5cb3001c773523$export$6a4549ec4168874a(o.x,o.y,n.value),h=l.x-n.corners[e].x,c=l.y-n.corners[e].y;n.corners[e].x=l.x,n.corners[e].y=l.y;var u=[];0===e?u=[3,1,2]:1===e?u=[2,0,3]:2===e?u=[1,3,0]:3===e&&(u=[0,2,1]),n.corners[u[0]].x=n.corners[e].x,n.corners[u[1]].y=n.corners[e].y,n.keyListener.isPressed("shift")&&(n.corners[u[2]].x-=h,n.corners[u[2]].y-=c,n.corners[u[1]].x=n.corners[u[2]].x,n.corners[u[0]].y=n.corners[u[2]].y),n.updateTransformViaCorners()}},useDirtyWheel:!0,onWheel:a})}(l);this.updateCornerPositions(),this.updateScaled();for(var h=0;h<4;h++)!function(e){n.edges[e]={el:$eWjiX.BB.el({css:{width:$0370167ee97a20d9$var$edgeSize+"px",height:$0370167ee97a20d9$var$edgeSize+"px",position:"absolute"}})};var t=n.edges[e];t.updateDOM=function(){0===e?(0,$7jh4K.css)(t.el,{left:Math.min(n.rectInViewport.corners[0].x,n.rectInViewport.corners[1].x)+"px",top:Math.min(n.rectInViewport.corners[0].y,n.rectInViewport.corners[3].y)-$0370167ee97a20d9$var$edgeSize+"px",width:Math.abs(n.rectInViewport.width)+"px",height:$0370167ee97a20d9$var$edgeSize+"px"}):1===e?(0,$7jh4K.css)(t.el,{left:Math.max(n.rectInViewport.corners[0].x,n.rectInViewport.corners[1].x)+"px",top:Math.min(n.rectInViewport.corners[1].y,n.rectInViewport.corners[2].y)+"px",width:$0370167ee97a20d9$var$edgeSize+"px",height:Math.abs(n.rectInViewport.height)+"px"}):2===e?(0,$7jh4K.css)(t.el,{left:Math.min(n.rectInViewport.corners[3].x,n.rectInViewport.corners[2].x)+"px",top:Math.max(n.rectInViewport.corners[0].y,n.rectInViewport.corners[3].y)+"px",width:Math.abs(n.rectInViewport.width)+"px",height:$0370167ee97a20d9$var$edgeSize+"px"}):3===e&&(0,$7jh4K.css)(t.el,{left:Math.min(n.rectInViewport.corners[0].x,n.rectInViewport.corners[1].x)-$0370167ee97a20d9$var$edgeSize+"px",top:Math.min(n.rectInViewport.corners[0].y,n.rectInViewport.corners[3].y)+"px",width:$0370167ee97a20d9$var$edgeSize+"px",height:Math.abs(n.rectInViewport.height)+"px"});var i=n.value.width<0,r=n.value.height<0,a=[r?-90:90,180*!!i,r?90:-90,180*!i][e]-n.value.angleDeg-n.viewportTransform.angleDeg;(0,$7jh4K.css)(t.el,{cursor:$0370167ee97a20d9$var$angleDegToCursor(a)})};var o=[0,2].includes(e);t.pointerListener=new $eWjiX.BB.PointerListener({target:n.edges[e].el,fixScribble:!0,onPointer:function(t){if(t.eventPreventDefault(),"pointerdown"===t.type&&"left"===t.button&&(i=o?n.corners[0].y>=n.corners[3].y:n.corners[0].x>=n.corners[1].x,r()),"pointermove"===t.type&&"left"===t.button){var a=$92816524e1b72be4$export$ad1d215dd03fe75a(n.viewportTransform),l=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(a),{x:0,y:0}),h=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(a),{x:t.dX,y:t.dY}),c=$6c5cb3001c773523$export$6a4549ec4168874a(l.x,l.y,n.value),u=$6c5cb3001c773523$export$6a4549ec4168874a(h.x,h.y,n.value),d={x:u.x-c.x,y:u.y-c.y},p={dX:d.x,dY:d.y};Math.abs(n.value.angleDeg)%90==0&&(p=$eWjiX.BB.intDxy(s,d.x,d.y));var f=[];0===e?f=[2,3,0,1]:1===e?f=[0,3,1,2]:2===e?f=[0,1,2,3]:3===e&&(f=[1,2,0,3]);var g=o?"y":"x",v=o?p.dY:p.dX;i?(n.corners[f[0]][g]+=v,n.corners[f[1]][g]+=v):(n.corners[f[2]][g]+=v,n.corners[f[3]][g]+=v),n.keyListener.isPressed("shift")&&(i?(n.corners[f[2]][g]-=v,n.corners[f[3]][g]-=v):(n.corners[f[0]][g]-=v,n.corners[f[1]][g]-=v)),o?n.restoreRatio(!1,!0):n.restoreRatio(!0,!1),n.updateTransformViaCorners()}},useDirtyWheel:!0,onWheel:a})}(h);this.angleGrip={el:$eWjiX.BB.el({css:{cursor:"url("+$parcel$interopDefault($416711db5dd64cf1$exports)+") 10 10, move",width:$0370167ee97a20d9$var$gripSize+"px",height:$0370167ee97a20d9$var$gripSize+"px",background:"#0ff",borderRadius:$0370167ee97a20d9$var$gripSize+"px",position:"absolute",boxShadow:"inset 0 0 0 2px #000"}}),x:0,y:0,snap:!1,updateDOM:function(){(0,$7jh4K.css)(n.angleGrip.el,{left:n.angleGrip.x-$0370167ee97a20d9$var$gripSize/2+"px",top:n.angleGrip.y-$0370167ee97a20d9$var$gripSize/2+"px"})}},$eWjiX.BB.el({parent:this.angleGrip.el,css:{width:"2px",height:"13px",left:$0370167ee97a20d9$var$gripSize/2-1+"px",top:$0370167ee97a20d9$var$gripSize+"px",background:"#0ff",position:"absolute"}}),this.anglePointerListener=new $eWjiX.BB.PointerListener({target:this.angleGrip.el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$92816524e1b72be4$export$ad1d215dd03fe75a(n.viewportTransform),i=n.rootEl.getBoundingClientRect(),r={x:e.clientX-i.left,y:e.clientY-i.top},a=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(t),r),s=$eWjiX.BB.pointsToAngleDeg({x:n.value.x,y:n.value.y},a)+90;n.value.angleDeg=s;var o=45*Math.round(s/360*8);"shift"===n.keyListener.getComboStr()?n.value.angleDeg=o:n.snappingEnabled&&8>Math.abs(o-s)&&(n.value.angleDeg=o),n.updateDOM()}"pointerup"===e.type&&Math.abs(n.value.angleDeg)%90==0&&($6c5cb3001c773523$export$958c2bfe8d7142a9(n.value),n.updateCornerPositions(),n.updateDOM())},useDirtyWheel:!0,onWheel:a}),$6c5cb3001c773523$export$958c2bfe8d7142a9(this.value),this.updateDOM(!0),$eWjiX.BB.append(this.transEl,[this.boundsEl,this.edges[0].el,this.edges[1].el,this.edges[2].el,this.edges[3].el,this.corners[0].el,this.corners[1].el,this.corners[2].el,this.corners[3].el,this.angleGrip.el])}return(0,$7h4XF._)(e,[{key:"updateScaled",value:function(){var e=this,t=$92816524e1b72be4$export$ad1d215dd03fe75a(this.viewportTransform),i=(0,$cdZRx.applyToPoint)(t,{x:this.value.x,y:this.value.y});this.rectInViewport.x=i.x,this.rectInViewport.y=i.y,this.rectInViewport.width=this.value.width*this.viewportTransform.scale,this.rectInViewport.height=this.value.height*this.viewportTransform.scale,this.rectInViewport.corners=this.corners.map(function(t){return{x:t.x*e.viewportTransform.scale,y:t.y*e.viewportTransform.scale}})}},{key:"snapCorner",value:function(e,t){if(!this.snappingEnabled)return{x:e,y:t};for(var i,n,r,a={x:void 0,y:void 0,dist:{x:void 0,y:void 0}},s=0;s<this.snapX.length;s++)(i=Math.abs(e-this.snapX[s]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===a.x||i<a.dist.x)&&(a.x=this.snapX[s],a.dist.x=i);for(var o=0;o<this.snapY.length;o++)(i=Math.abs(t-this.snapY[o]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===a.y||i<a.dist.y)&&(a.y=this.snapY[o],a.dist.y=i);return void 0===a.x&&void 0===a.y?{x:e,y:t}:{x:null!=(n=a.x)?n:e,y:null!=(r=a.y)?r:t}}},{key:"constrainCorner",value:function(e,t,i){if(!this.isConstrained)return{x:t,y:i};var n=this.value.width*this.value.height<0?-1:1;return $eWjiX.BB.projectPointOnLine({x:this.value.x,y:this.value.y},$6c5cb3001c773523$export$3fba3b383c654cc6(this.ratio,n*([0,2].includes(e)?1:-1),this.value),{x:t,y:i})}},{key:"updateCornerPositions",value:function(){this.corners[0].x=-this.value.width/2,this.corners[0].y=-this.value.height/2,this.corners[1].x=this.value.width/2,this.corners[1].y=-this.value.height/2,this.corners[2].x=this.value.width/2,this.corners[2].y=this.value.height/2,this.corners[3].x=-this.value.width/2,this.corners[3].y=this.value.height/2}},{key:"restoreRatio",value:function(e,t){if(this.isConstrained){var i=Math.abs(this.value.angleDeg)%90==0,n=Math.abs(this.value.angleDeg-90)%180==0;if(t&&!e){var r=Math.abs(this.corners[3].y-this.corners[0].y),a=this.ratio*r;i&&(a=(n?this.value.y%1:this.value.x%1)==0?$eWjiX.BB.roundEven(a):$eWjiX.BB.roundUneven(a)),this.corners[1].x-this.corners[0].x<0&&(a*=-1),this.corners[0].x=-a/2,this.corners[3].x=-a/2,this.corners[1].x=a/2,this.corners[2].x=a/2}if(!t&&e){var s=Math.abs(this.corners[0].x-this.corners[1].x)/this.ratio;i&&(s=(n?this.value.x%1:this.value.y%1)==0?$eWjiX.BB.roundEven(s):$eWjiX.BB.roundUneven(s)),this.corners[3].y-this.corners[0].y<0&&(s*=-1),this.corners[0].y=-s/2,this.corners[1].y=-s/2,this.corners[2].y=s/2,this.corners[3].y=s/2}}}},{key:"updateTransformViaCorners",value:function(){var e=$eWjiX.BB.rotateAround({x:0,y:0},{x:(this.corners[0].x+this.corners[1].x)/2,y:(this.corners[0].y+this.corners[3].y)/2},this.value.angleDeg);this.value.x=e.x+this.value.x,this.value.y=e.y+this.value.y,this.value.width=this.corners[1].x-this.corners[0].x,this.value.height=this.corners[3].y-this.corners[0].y,this.updateCornerPositions(),this.updateDOM()}},{key:"updateDOM",value:function(e){this.updateScaled(),(0,$7jh4K.css)(this.transEl,{left:this.rectInViewport.x+"px",top:this.rectInViewport.y+"px",transformOrigin:"0 0",transform:"rotate("+(this.value.angleDeg+this.viewportTransform.angleDeg)+"deg)"}),(0,$7jh4K.css)(this.boundsEl,{width:Math.abs(this.rectInViewport.width)+"px",height:Math.abs(this.rectInViewport.height)+"px",left:Math.min(this.rectInViewport.corners[0].x,this.rectInViewport.corners[1].x)+"px",top:Math.min(this.rectInViewport.corners[0].y,this.rectInViewport.corners[3].y)+"px"}),this.corners[0].updateDOM(),this.corners[1].updateDOM(),this.corners[2].updateDOM(),this.corners[3].updateDOM(),this.edges[0].updateDOM(),this.edges[1].updateDOM(),this.edges[2].updateDOM(),this.edges[3].updateDOM(),this.angleGrip.x=0,this.angleGrip.y=-Math.abs(this.value.height*this.viewportTransform.scale)/2-20,this.angleGrip.updateDOM(),!e&&this.callback&&this.callback((0,$cL71g._)({},this.value))}},{key:"getValue",value:function(){return(0,$cL71g._)({},this.value)}},{key:"setIsConstrained",value:function(e){this.isConstrained=e,e&&0!==this.value.width&&0!==this.value.height&&(this.ratio=Math.abs(this.value.width/this.value.height))}},{key:"setSnapping",value:function(e){this.snappingEnabled=e}},{key:"setSnappingPoints",value:function(e,t){this.snapX=e,this.snapY=t}},{key:"setPos",value:function(e){this.value.x=e.x,this.value.y=e.y,this.updateDOM(!0)}},{key:"move",value:function(e,t){this.value.x+=e,this.value.y+=t,this.updateDOM(!1)}},{key:"setSize",value:function(e,t){this.value.width=e,this.value.height=t,Math.abs(this.value.angleDeg)%90==0&&$6c5cb3001c773523$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions(),this.updateDOM(!1)}},{key:"initialise",value:function(e){this.value.x=e.x,this.value.y=e.y,this.value.width=e.width,this.value.height=e.height,this.value.angleDeg=e.angleDeg,this.ratio=Math.abs(e.width/e.height),this.updateCornerPositions(),this.updateDOM(!0)}},{key:"setAngleDeg",value:function(e){this.value.angleDeg=e,Math.abs(this.value.angleDeg)%90==0&&($6c5cb3001c773523$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions()),this.updateDOM(!0)}},{key:"setViewportTransform",value:function(e){this.viewportTransform=(0,$cL71g._)({},e),this.updateScaled(),this.updateDOM()}},{key:"getElement",value:function(){return this.rootEl}},{key:"getRatio",value:function(){return this.ratio}},{key:"destroy",value:function(){this.keyListener.destroy(),this.boundsPointerListener.destroy(),this.corners.forEach(function(e){return e.pointerListener.destroy()}),this.edges.forEach(function(e){return e.pointerListener.destroy()}),this.anglePointerListener.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$48f5d87739d28bf9$export$205c2dd29f8a66b5=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.algorithm="smooth",this.imageWidth=t.imageWidth,this.imageHeight=t.imageHeight,this.rootEl=$eWjiX.BB.el({className:"kl-preview-wrapper",css:{width:t.elementWidth+"px",height:t.elementHeight+"px"}}),this.rootEl.oncontextmenu=function(){return!1},this.layers=t.layers,this.transformIndex=t.transformIndex,this.previewLayerArr=this.layers.map(function(e){var t;return{image:e.image,isVisible:e.isVisible,mixModeStr:null!=(t=e.mixModeStr)?t:"source-over",opacity:e.opacity,hasClipping:!1}}),this.previewCanvas=$eWjiX.BB.canvas(this.imageWidth,this.imageHeight),this.previewLayerArr[this.previewLayerArr.length-1].image=this.previewCanvas,this.preview=new $99362267c0b49949$export$133773870222880f({width:t.elementWidth,height:t.elementHeight,project:{width:t.imageWidth,height:t.imageHeight,layers:this.previewLayerArr},hasEditMode:!0,onModeChange:function(e){(0,$7jh4K.css)(i.freeTransform.getElement(),{pointerEvents:"edit"===e?"":"none",opacity:"edit"===e?"":"0.5"})},onTransformChange:function(e){i.freeTransform.setViewportTransform(e)},padding:30}),(0,$7jh4K.css)(this.preview.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),this.rootEl.append(this.preview.getElement()),this.initTransform={x:this.imageWidth/2,y:this.imageHeight/2,width:this.layers[this.transformIndex].image.width,height:this.layers[this.transformIndex].image.height},this.freeTransform=new $0370167ee97a20d9$export$79a74567acf241b0({x:this.initTransform.x,y:this.initTransform.y,width:this.initTransform.width,height:this.initTransform.height,angleDeg:0,isConstrained:!0,snapX:[0,this.imageWidth],snapY:[0,this.imageHeight],viewportTransform:this.preview.getTransform(),callback:function(){i.updatePreview()}}),this.preview.getElement().append(this.freeTransform.getElement()),(0,$7jh4K.css)(this.freeTransform.getElement(),{position:"absolute",left:"0",top:"0"}),setTimeout(function(){return i.updatePreview()},0)}return(0,$7h4XF._)(e,[{key:"updatePreview",value:function(){var e=this.freeTransform.getValue(),t=$eWjiX.BB.ctx(this.previewCanvas);t.save(),t.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),$eWjiX.BB.drawTransformedImageWithBounds(t,this.layers[this.transformIndex].image,e,void 0,"pixelated"===this.algorithm||$eWjiX.BB.testShouldPixelate(e,e.width/this.initTransform.width,e.height/this.initTransform.height)),t.restore(),this.preview.render()}},{key:"move",value:function(e,t){this.freeTransform.move(e,t)}},{key:"reset",value:function(){var e=this.layers[this.transformIndex].image.width,t=this.layers[this.transformIndex].image.height;this.freeTransform.setSize(e,t),this.freeTransform.setPos({x:e/2,y:t/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}},{key:"setTransformFit",value:function(){var e=$eWjiX.BB.fitInto(this.layers[this.transformIndex].image.width,this.layers[this.transformIndex].image.height,this.imageWidth,this.imageHeight,1);this.freeTransform.setSize(e.width,e.height),this.freeTransform.setPos({x:e.width/2,y:e.height/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}},{key:"setTransformCenter",value:function(){this.freeTransform.setPos({x:this.imageWidth/2,y:this.imageHeight/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}},{key:"setAlgorithm",value:function(e){this.algorithm=e,this.updatePreview()}},{key:"getTransformation",value:function(){return this.freeTransform.getValue()}},{key:"getIsPixelated",value:function(){var e=this.freeTransform.getValue();return"pixelated"===this.algorithm||$eWjiX.BB.testShouldPixelate(e,e.width/this.initTransform.width,e.height/this.initTransform.height)}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.freeTransform.destroy(),this.preview.destroy(),$eWjiX.BB.freeCanvas(this.previewCanvas)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$de496a1759b04ed9$export$71ed2b85d4ca43d3=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.scale=t.scale,this.callback=t.callback;var n=t.maxW,r=t.maxW;this.rootEl=$eWjiX.BB.el();var a=["nw","n","ne","e","se","s","sw","w"];this.keyListener=new $eWjiX.BB.KeyListener({}),(0,$7jh4K.css)(this.rootEl,{position:"absolute",left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.outline={el:$eWjiX.BB.el({css:{position:"absolute",border:"1px dashed #fff",cursor:"move"}}),update:function(){(0,$7jh4K.css)(i.outline.el,{left:i.grips[0].x*i.scale-1+"px",top:i.grips[0].y*i.scale-1+"px",width:(i.grips[2].x-i.grips[0].x)*i.scale+"px",height:(i.grips[2].y-i.grips[0].y)*i.scale+"px"})}},this.pointerRemainder={x:0,y:0},this.outlinePointerListener=new $eWjiX.BB.PointerListener({target:this.outline.el,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX,r=t.dY;i.grips[0].x+=n,i.grips[0].y+=r,i.grips[1].x+=n,i.grips[1].y+=r,i.grips[2].x+=n,i.grips[2].y+=r,i.grips[3].x+=n,i.grips[3].y+=r,i.update()}"pointerup"===e.type&&i.commit()}}),this.thirdsHorizontal={el:$eWjiX.BB.el({css:{position:"absolute",borderTop:"1px solid #0ff",borderBottom:"1px solid #0ff"}}),update:function(){(0,$7jh4K.css)(i.thirdsHorizontal.el,{left:i.grips[0].x*i.scale+"px",top:(i.grips[0].y+(i.grips[2].y-i.grips[0].y)/3)*i.scale+"px",width:(i.grips[2].x-i.grips[0].x)*i.scale+"px",height:(i.grips[2].y-i.grips[0].y)/3*i.scale+"px"})}},this.thirdsVertical={el:$eWjiX.BB.el({css:{position:"absolute",borderLeft:"1px solid #0ff",borderRight:"1px solid #0ff"}}),update:function(){(0,$7jh4K.css)(i.thirdsVertical.el,{left:(i.grips[0].x+(i.grips[2].x-i.grips[0].x)/3)*i.scale+"px",top:i.grips[0].y*i.scale+"px",width:(i.grips[2].x-i.grips[0].x)/3*i.scale+"px",height:(i.grips[2].y-i.grips[0].y)*i.scale+"px"})}};var s=40,o=10;t.init?this.grips=[{x:t.init.x1,y:t.init.y1},{x:t.init.x2,y:t.init.y1},{x:t.init.x2,y:t.init.y2},{x:t.init.x1,y:t.init.y2}]:this.grips=[{x:0,y:0},{x:this.width,y:0},{x:this.width,y:this.height},{x:0,y:this.height}];var l=function(e){i.grips[0].y+=e,i.grips[0].y=$eWjiX.BB.clamp(i.grips[0].y,i.grips[3].y-r,i.grips[3].y-1),i.grips[1].y=i.grips[0].y},h=function(e){i.grips[1].x+=e,i.grips[1].x=$eWjiX.BB.clamp(i.grips[1].x,i.grips[0].x+1,i.grips[0].x+n),i.grips[2].x=i.grips[1].x},c=function(e){i.grips[2].y+=e,i.grips[2].y=$eWjiX.BB.clamp(i.grips[2].y,i.grips[1].y+1,i.grips[1].y+r),i.grips[3].y=i.grips[2].y},u=function(e){i.grips[0].x+=e,i.grips[0].x=$eWjiX.BB.clamp(i.grips[0].x,i.grips[1].x-n,i.grips[1].x-1),i.grips[3].x=i.grips[0].x};this.edges=[];for(var d=0;d<4;d++)!function(e){var t=$eWjiX.BB.el({css:{width:s+"px",height:s+"px",position:"absolute"}}),n=function(){0===e?(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale+o+"px",top:i.grips[0].y*i.scale-2*s+o+"px",width:(i.grips[1].x-i.grips[0].x)*i.scale-2*o+"px",height:2*s+"px"}):1===e?(0,$7jh4K.css)(t,{left:i.grips[1].x*i.scale-o+"px",top:i.grips[1].y*i.scale+o+"px",width:2*s+"px",height:(i.grips[2].y-i.grips[1].y)*i.scale-2*o+"px"}):2===e?(0,$7jh4K.css)(t,{left:i.grips[3].x*i.scale+o+"px",top:i.grips[3].y*i.scale-o+"px",width:(i.grips[2].x-i.grips[3].x)*i.scale-2*o+"px",height:2*s+"px"}):3===e&&(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale-2*s+o+"px",top:i.grips[0].y*i.scale+o+"px",width:2*s+"px",height:(i.grips[3].y-i.grips[0].y)*i.scale-2*o+"px"});var n=2*e+1;t.style.cursor=a[n]+"-resize"};i.edges[e]={el:t,update:n}}(d);this.darken=[];for(var p=0;p<4;p++)!function(e){var t=$eWjiX.BB.el({css:{position:"absolute",background:"#000",opacity:"0.5"}}),n=function(){0===e?(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale+"px",top:i.grips[0].y*i.scale-8e3+"px",width:(i.grips[1].x-i.grips[0].x)*i.scale+"px",height:"8000px"}):1===e?(0,$7jh4K.css)(t,{left:i.grips[1].x*i.scale+"px",top:i.grips[1].y*i.scale-8e3+"px",width:"8000px",height:"16000px"}):2===e?(0,$7jh4K.css)(t,{left:i.grips[3].x*i.scale+"px",top:i.grips[3].y*i.scale+"px",width:(i.grips[2].x-i.grips[3].x)*i.scale+"px",height:"8000px"}):3===e&&(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale-8e3+"px",top:i.grips[0].y*i.scale-8e3+"px",width:"8000px",height:"16000px"})};i.darken[e]={el:t,update:n}}(p);this.edge0PointerListener=new $eWjiX.BB.PointerListener({target:this.edges[0].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale).dY;l(t),i.keyListener.isPressed("shift")&&c(-t),i.update()}"pointerup"===e.type&&i.commit()}}),this.edge1PointerListener=new $eWjiX.BB.PointerListener({target:this.edges[1].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX;t.dY,h(n),i.keyListener.isPressed("shift")&&u(-n),i.update()}"pointerup"===e.type&&i.commit()}}),this.edge2PointerListener=new $eWjiX.BB.PointerListener({target:this.edges[2].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=(t.dX,t.dY);c(n),i.keyListener.isPressed("shift")&&l(-n),i.update()}"pointerup"===e.type&&i.commit()}}),this.edge3PointerListener=new $eWjiX.BB.PointerListener({target:this.edges[3].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX;t.dY,u(n),i.keyListener.isPressed("shift")&&h(-n),i.update()}"pointerup"===e.type&&i.commit()}}),this.cornerElArr=[],function(){for(var e=0;e<4;e++)!function(e){var t=$eWjiX.BB.el({css:{width:2*s+"px",height:2*s+"px",position:"absolute",cursor:["nwse-resize","nesw-resize"][e%2]}}),n=function(){0===e?(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale-2*s+o+"px",top:i.grips[0].y*i.scale-2*s+o+"px"}):1===e?(0,$7jh4K.css)(t,{left:i.grips[1].x*i.scale-o+"px",top:i.grips[1].y*i.scale-2*s+o+"px"}):2===e?(0,$7jh4K.css)(t,{left:i.grips[1].x*i.scale-o+"px",top:i.grips[2].y*i.scale-o+"px"}):3===e&&(0,$7jh4K.css)(t,{left:i.grips[0].x*i.scale-2*s+o+"px",top:i.grips[2].y*i.scale-o+"px"})};i.cornerElArr[e]={el:t,update:n}}(e)}(),this.corner0PointerListener=new $eWjiX.BB.PointerListener({target:this.cornerElArr[0].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX,r=t.dY;u(n),l(r),i.keyListener.isPressed("shift")&&(h(-n),c(-r)),i.update()}"pointerup"===e.type&&i.commit()}}),this.corner1PointerListener=new $eWjiX.BB.PointerListener({target:this.cornerElArr[1].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX,r=t.dY;h(n),l(r),i.keyListener.isPressed("shift")&&(u(-n),c(-r)),i.update()}"pointerup"===e.type&&i.commit()}}),this.corner2PointerListener=new $eWjiX.BB.PointerListener({target:this.cornerElArr[2].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX,r=t.dY;h(n),c(r),i.keyListener.isPressed("shift")&&(u(-n),l(-r)),i.update()}"pointerup"===e.type&&i.commit()}}),this.corner3PointerListener=new $eWjiX.BB.PointerListener({target:this.cornerElArr[3].el,fixScribble:!0,onPointer:function(e){if(e.eventPreventDefault(),"pointermove"===e.type&&"left"===e.button){var t=$eWjiX.BB.intDxy(i.pointerRemainder,e.dX/i.scale,e.dY/i.scale),n=t.dX,r=t.dY;u(n),c(r),i.keyListener.isPressed("shift")&&(h(-n),l(-r)),i.update()}"pointerup"===e.type&&i.commit()}}),this.rootEl.append(this.darken[1].el,this.darken[0].el,this.darken[2].el,this.darken[3].el,this.thirdsHorizontal.el,this.thirdsVertical.el,this.outline.el,this.edges[1].el,this.edges[0].el,this.edges[2].el,this.edges[3].el,this.cornerElArr[0].el,this.cornerElArr[1].el,this.cornerElArr[2].el,this.cornerElArr[3].el),this.update()}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.edges[0].update(),this.edges[1].update(),this.edges[2].update(),this.edges[3].update(),this.cornerElArr[0].update(),this.cornerElArr[1].update(),this.cornerElArr[2].update(),this.cornerElArr[3].update(),this.darken[0].update(),this.darken[1].update(),this.darken[2].update(),this.darken[3].update(),this.outline.update(),this.thirdsHorizontal.update(),this.thirdsVertical.update()}},{key:"commit",value:function(){this.pointerRemainder.x=0,this.pointerRemainder.y=0,this.callback(this.getTransform())}},{key:"getTransform",value:function(){return this.grips[1].x-=this.grips[0].x,this.grips[1].y-=this.grips[0].y,this.grips[2].x-=this.grips[0].x,this.grips[2].y-=this.grips[0].y,this.grips[3].x-=this.grips[0].x,this.grips[3].y-=this.grips[0].y,this.x+=this.grips[0].x,this.y+=this.grips[0].y,this.grips[0].x=0,this.grips[0].y=0,{x:this.x,y:this.y,width:this.grips[1].x,height:this.grips[2].y}}},{key:"setTransform",value:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,(0,$7jh4K.css)(this.rootEl,{left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.grips[0].x=0,this.grips[0].y=0,this.grips[1].x=this.width,this.grips[1].y=0,this.grips[2].x=this.width,this.grips[2].y=this.height,this.grips[3].x=0,this.grips[3].y=this.height,this.update(),this.commit()}},{key:"setScale",value:function(e){this.scale=e,(0,$7jh4K.css)(this.rootEl,{left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.update()}},{key:"showThirds",value:function(e){this.thirdsHorizontal.el.style.display=e?"block":"none",this.thirdsVertical.el.style.display=e?"block":"none"}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.keyListener.destroy(),this.outlinePointerListener.destroy(),this.corner0PointerListener.destroy(),this.corner1PointerListener.destroy(),this.corner2PointerListener.destroy(),this.corner3PointerListener.destroy(),this.edge0PointerListener.destroy(),this.edge1PointerListener.destroy(),this.edge2PointerListener.destroy(),this.edge3PointerListener.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$18e69c7d4cb991e8$export$d25420b53e16716f=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.animationCanvasCheckerPattern={},this.largeCanvasCheckerPattern={},this.rootEl=$eWjiX.BB.el({className:"kl-layer-preview"}),this.klHistory=t.klHistory,this.isPreviewVisible=!0,this.height=40,this.canvasSize=this.height-10,this.largeCanvasSize=300,this.lastDrawnState=-2,this.lastDrawnSize={width:0,height:0},this.animationCanvas=$eWjiX.BB.canvas(),this.animationCanvasCtx=$eWjiX.BB.ctx(this.animationCanvas),this.animationLength=30,this.animationCount=0,this.largeCanvasIsVisible=!1;var r=300;this.uiState=t.uiState,this.contentWrapperEl=$eWjiX.BB.el({css:{display:"flex",alignItems:"center",height:this.height+"px"}});var a=$eWjiX.BB.el({css:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"23px",flexShrink:"0"}});this.checkEl=$eWjiX.BB.el({parent:a,tagName:"input",css:{pointerEvents:"none"},custom:{type:"checkbox",disabled:"true",name:"layer-visible"}});var s=$eWjiX.BB.el({css:{minWidth:this.height+"px",height:this.height+"px",display:"flex",justifyContent:"center",alignItems:"center"}});this.canvas=$eWjiX.BB.canvas(this.canvasSize,this.canvasSize),this.canvasCtx=$eWjiX.BB.ctx(this.canvas),this.canvas.title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-active-layer");var o=$eWjiX.BB.el({css:{flexGrow:"1",paddingLeft:"10px",fontSize:"13px",overflow:"hidden",position:"relative"}});this.nameLabelEl=$eWjiX.BB.el({content:"",css:{cssFloat:"left",whiteSpace:"nowrap"}});var l=$eWjiX.BB.el({css:{position:"absolute",left:"10px",top:"0",width:"90px",height:"100%"}});t.onClick&&(l.addEventListener("click",function(){return t.onClick()},{passive:!1}),this.canvas.addEventListener("click",function(){return t.onClick()},{passive:!1}),a.addEventListener("click",function(){return t.onClick()},{passive:!1})),this.opacityEl=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("opacity")+"<br>100%",css:{minWidth:"60px",fontSize:"12px",textAlign:"center"}}),this.largeCanvasWrapper=$eWjiX.BB.el({onClick:$eWjiX.BB.handleClick,css:{pointerEvents:"none",background:"#fff",position:"absolute",right:"280px",top:"10px",border:"1px solid #aaa",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",transition:"opacity "+r+"ms ease-in-out",userSelect:"none",display:"block",webkitTouchCallout:"none"}}),this.largeCanvas=$eWjiX.BB.canvas(this.largeCanvasSize,this.largeCanvasSize),this.largeCanvasWrapper.append(this.largeCanvas),this.largeCanvasCtx=$eWjiX.BB.ctx(this.largeCanvas),(0,$7jh4K.css)(this.largeCanvas,{display:"block"}),s.append(this.canvas),o.append(this.nameLabelEl,l),this.contentWrapperEl.append(a,s,o,this.opacityEl),this.rootEl.append(this.contentWrapperEl),this.updateCheckerPatterns(),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.addIsDarkListener(function(){n.updateCheckerPatterns(),n.draw(!0)}),this.klHistory.addListener(function(){n.updateLabel()}),setInterval(function(){n.layer&&n.klHistory.getChangeCount()!==n.lastDrawnState&&n.draw(!1)},2e3);var h=function(){n.largeCanvasWrapper.remove()},c=function(e){n.largeCanvasIsVisible!==e&&(clearTimeout(i),n.largeCanvasIsVisible=e,e?i=setTimeout(function(){n.drawLargeCanvas(),n.largeCanvasWrapper.style.opacity="0",t.klRootEl.append(n.largeCanvasWrapper),setTimeout(function(){n.largeCanvasWrapper.style.opacity="1"},20)},250):(n.largeCanvasWrapper.style.opacity="0",i=setTimeout(h,r+20)))};new $eWjiX.BB.PointerListener({target:this.canvas,onEnterLeave:function(e){c(e)}})}return(0,$7h4XF._)(e,[{key:"updateCheckerPatterns",value:function(){var e=$eWjiX.BB.createCheckerCanvas(4,$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark());this.animationCanvasCheckerPattern=(0,$7jh4K.throwIfNull)(this.animationCanvasCtx.createPattern(e,"repeat")),this.largeCanvasCheckerPattern=(0,$7jh4K.throwIfNull)(this.canvasCtx.createPattern(e,"repeat"))}},{key:"animate",value:function(){var e=this;0!==this.animationCount&&(this.animationCount--,this.canvasCtx.save(),this.canvasCtx.globalAlpha=Math.pow((this.animationLength-this.animationCount)/this.animationLength,2),this.canvasCtx.drawImage(this.animationCanvas,0,0),this.canvasCtx.restore(),this.animationCount>0&&requestAnimationFrame(function(){return e.animate()}))}},{key:"drawLargeCanvas",value:function(){if(this.largeCanvasIsVisible&&this.layer){var e=this.layer.canvas,t=$eWjiX.BB.fitInto(e.width,e.height,this.largeCanvasSize,this.largeCanvasSize,1);this.largeCanvas.width=Math.round(t.width),this.largeCanvas.height=Math.round(t.height),this.largeCanvasCtx.save(),this.largeCanvas.width>e.width?this.largeCanvasCtx.imageSmoothingEnabled=!1:(this.largeCanvasCtx.imageSmoothingEnabled=!0,this.largeCanvasCtx.imageSmoothingQuality="high"),this.largeCanvasCtx.fillStyle=this.largeCanvasCheckerPattern,this.largeCanvasCtx.fillRect(0,0,this.largeCanvas.width,this.largeCanvas.height),this.largeCanvasCtx.drawImage(e,0,0,this.largeCanvas.width,this.largeCanvas.height),this.largeCanvasCtx.restore();var i=this.rootEl.getBoundingClientRect();(0,$7jh4K.css)(this.largeCanvasWrapper,{top:Math.max(10,i.top+this.height/2-this.largeCanvas.height/2)+"px"})}}},{key:"updateLabel",value:function(){if(this.isPreviewVisible&&this.layer){var e=this.layer.isVisible;this.checkEl.parentElement.title=e?$8d7403abedf7cefa$export$ce37e184d908d785("layers-active-layer-visible"):$8d7403abedf7cefa$export$ce37e184d908d785("layers-active-layer-hidden"),this.checkEl.checked=e,this.checkEl.style.boxShadow=e?"":"0 0 0 1px red",this.nameLabelEl.textContent=this.layer.name,this.layer.isVisible?this.opacityEl.innerHTML=$8d7403abedf7cefa$export$ce37e184d908d785("opacity")+"<br>"+Math.round(100*this.layer.opacity)+"%":this.opacityEl.innerHTML=$8d7403abedf7cefa$export$ce37e184d908d785("opacity")+"<br><s>"+Math.round(100*this.layer.opacity)+"%</s>"}}},{key:"draw",value:function(e){if(this.isPreviewVisible&&this.layer){this.updateLabel();var t=this.layer.canvas;if(t.width!==this.lastDrawnSize.width||t.height!==this.lastDrawnSize.height){var i=$eWjiX.BB.fitInto(t.width,t.height,this.canvasSize,this.canvasSize,1);this.canvas.width=Math.round(i.width),this.canvas.height=Math.round(i.height),e=!0}this.animationCanvas.width=this.canvas.width,this.animationCanvas.height=this.canvas.height,this.animationCanvasCtx.save(),this.animationCanvasCtx.imageSmoothingEnabled=!1,this.animationCanvasCtx.fillStyle=this.animationCanvasCheckerPattern,this.animationCanvasCtx.fillRect(0,0,this.animationCanvas.width,this.animationCanvas.height),this.animationCanvasCtx.drawImage(t,0,0,this.animationCanvas.width,this.animationCanvas.height),this.animationCanvasCtx.restore(),e?(this.animationCount=0,this.canvasCtx.save(),this.canvasCtx.drawImage(this.animationCanvas,0,0),this.canvasCtx.restore()):(this.animationCount=this.animationLength,this.animate()),this.drawLargeCanvas(),this.lastDrawnState=this.klHistory.getChangeCount(),this.lastDrawnSize.width=t.width,this.lastDrawnSize.height=t.height}}},{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){if(this.isPreviewVisible!==e){this.isPreviewVisible=e,this.contentWrapperEl.style.display=this.isPreviewVisible?"flex":"none",this.rootEl.style.marginBottom=this.isPreviewVisible?"":"10px";var t=this.klHistory.getChangeCount();e&&this.lastDrawnState!==t&&this.draw(!0)}}},{key:"setLayer",value:function(e){this.layer=e,this.draw(!0)}},{key:"setUiState",value:function(e){this.uiState=e,"left"===this.uiState?(0,$7jh4K.css)(this.largeCanvasWrapper,{left:"280px",right:""}):(0,$7jh4K.css)(this.largeCanvasWrapper,{left:"",right:"280px"})}}]),e}(),$eWjiX=parcelRequire("eWjiX");function $042ba564475611dc$export$8f6817a932bf45cd(){return window.innerWidth<550}var $a433d11ad38d7c38$export$ec2d17c6d3ae0768={width:340,height:220},$a433d11ad38d7c38$export$3a4a74a7d8c44e62={width:540,height:300};function $a433d11ad38d7c38$export$8b9199c1f5e4be8(e){return e?$a433d11ad38d7c38$export$ec2d17c6d3ae0768.width:$a433d11ad38d7c38$export$3a4a74a7d8c44e62.width}function $a433d11ad38d7c38$export$94cffdbcf128864a(e){return e?$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height:$a433d11ad38d7c38$export$3a4a74a7d8c44e62.height}var $7jh4K=parcelRequire("7jh4K");function $e3dfa43019bc3f08$export$962af7e240721d88(e){var t=document.createElement("div");if($eWjiX.BB.appendTextDiv(t,$8d7403abedf7cefa$export$ce37e184d908d785("import-as-layer-description")),e.klCanvas.isLayerLimitReached()){var i=$eWjiX.BB.el({className:"kl-import-note",content:$8d7403abedf7cefa$export$ce37e184d908d785("import-as-layer-limit-reached")});t.append(i)}var n=$042ba564475611dc$export$8f6817a932bf45cd(),r=$eWjiX.BB.el({css:{display:"flex"}}),a=$eWjiX.BB.el({tagName:"button",content:"1:1",css:{marginRight:"10px"},onClick:function(){d.reset()}}),s=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("import-as-layer-fit"),css:{marginRight:"10px"},onClick:function(){d.setTransformFit()}}),o=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("center"),css:{marginRight:"10px"},onClick:function(){d.setTransformCenter()}}),l=new $7a3263857aacf58f$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",title:$8d7403abedf7cefa$export$ce37e184d908d785("scaling-algorithm"),onChange:function(e){d.setAlgorithm(e)},name:"interpolation-algorithm"});r.append(a,s,o,$eWjiX.BB.el({css:{flexGrow:"1"}}),l.getElement()),t.append(r);for(var h=[],c=e.klCanvas.getLayers(),u=0;u<c.length;u++)h.push({image:c[u].context.canvas,isVisible:c[u].isVisible,opacity:c[u].opacity,mixModeStr:c[u].mixModeStr});h.push({image:e.importImage,isVisible:!0,opacity:1,mixModeStr:"source-over"});var d=new $48f5d87739d28bf9$export$205c2dd29f8a66b5({elementWidth:$a433d11ad38d7c38$export$8b9199c1f5e4be8(n),elementHeight:$a433d11ad38d7c38$export$94cffdbcf128864a(n)+50,imageWidth:e.klCanvas.getLayerContext(0).canvas.width,imageHeight:e.klCanvas.getLayerContext(0).canvas.height,layers:h,transformIndex:h.length-1});function p(e,t){d.move(e,t)}(0,$7jh4K.css)(d.getElement(),{marginTop:"10px",marginLeft:"-20px"}),t.append(d.getElement());var f=new $eWjiX.BB.KeyListener({onDown:function(e){"left"===e&&p(-1,0),"right"===e&&p(1,0),"up"===e&&p(0,-1),"down"===e&&p(0,1)}});$c902829f68f42bce$export$d7e8d4d4450c819c({target:e.target,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("import-as-layer-title")}</b>`,div:t,style:n?void 0:{width:"540px"},buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(t){f.destroy(),d.destroy(),$eWjiX.BB.destroyEl(a),$eWjiX.BB.destroyEl(s),$eWjiX.BB.destroyEl(o),"Ok"===t?e.callback(d.getTransformation(),d.getIsPixelated()):e.callback()}})}var $cx0mh=parcelRequire("cx0mh"),$eWjiX=parcelRequire("eWjiX"),$01cb8095758db224$export$e789742143ba5b1=function e(t){"use strict";var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("dropper-drop"),css:{paddingTop:"100px",position:"fixed",left:"0",top:"0",width:"100%",height:"100%",background:"rgba(50, 50, 50, 0.7)",color:"#fff",textShadow:"2px 2px #000",textAlign:"center",fontSize:"25px"}});var n=$eWjiX.BB.el({css:{marginTop:"50px",display:"flex",justifyContent:"center"}}),r={width:"200px",padding:"50px",margin:"10px",borderRadius:"20px",border:"1px dashed #fff",background:"#00aefe",fontWeight:"bold"},a=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("dropper-as-layer"),css:r}),s=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("dropper-as-image"),css:r});this.rootEl.append(n),n.append(a,s);var o=0,l=0,h=0,c=function(){o=0,l=0,h=0,i.rootEl.remove()},u=function(e){return!!e.dataTransfer&&!e.dataTransfer.types.includes("text/plain")},d=function(){var e="0 0 20px 4px #fff";l>0?(a.style.boxShadow=e,s.style.boxShadow=""):h>0?(a.style.boxShadow="",s.style.boxShadow=e):(a.style.boxShadow="",s.style.boxShadow="")};a.addEventListener("dragenter",function(){l++,d()},{passive:!1}),a.addEventListener("dragleave",function(){l--,d()},{passive:!1}),s.addEventListener("dragenter",function(){h++,d()},{passive:!1}),s.addEventListener("dragleave",function(){h--,d()},{passive:!1});var p=function(e){u(e)&&(e.stopPropagation(),e.preventDefault())},f=function(e){t.enabledTest()&&u(e)&&(0===o&&t.target.append(i.rootEl),o++)},g=function(e){u(e)&&0!==o&&0===(o=Math.max(0,o-1))&&i.rootEl.remove()},v=function(e){if(!u(e)||!e.dataTransfer||0===e.dataTransfer.files.length)return void c();e.stopPropagation(),e.preventDefault();var n="default";l>0?n="layer":h>0&&(n="image"),t.onDrop(e.dataTransfer.files,n),o>0&&i.rootEl.remove(),o=0,l=0,h=0,d()};window.addEventListener("dragover",p,{passive:!1}),window.addEventListener("dragenter",f,{passive:!1}),window.addEventListener("dragleave",g,{passive:!1}),window.addEventListener("drop",v,{passive:!1}),this.rootEl.addEventListener("pointerdown",function(){c()},{passive:!1}),new $eWjiX.BB.KeyListener({onDown:function(e){o>0&&"esc"===e&&c()}})},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$d6fe881e8fc421ac$export$9f0da9b942594e99=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e);var n=150,r=90,a=20,s=25,o=!1;this.rootEl=$eWjiX.BB.el({className:"kl-overlay-toolspace"});var l={color:null,size:null,opacity:null},h=$eWjiX.BB.el({parent:this.rootEl,className:"kl-overlay-toolspace__color"}),c=new $3ce0af1e789f1ab4$export$66306bf21a9ff39e({width:n,heightSV:r,heightH:a,color:t.brushSettingService.getColor(),callback:function(e){u.style.backgroundColor="rgb("+e.r+","+e.g+","+e.b+")",t.brushSettingService.setColor(e,v)}}),u=$eWjiX.BB.el({css:{width:n+"px",height:a+"px",pointerEvents:"none"}}),d=t.brushSettingService.getColor();u.style.backgroundColor="rgb("+d.r+","+d.g+","+d.b+")",h.append(u,c.getElement());var p=function(e){c.setColor(e),u.style.backgroundColor="rgb("+e.r+","+e.g+","+e.b+")"},f=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:n,height:s,min:0,max:500,value:50,resolution:225,eventResMs:1e3/30,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){t.brushSettingService.setSize(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)}});(0,$7jh4K.css)(f.getElement(),{marginTop:"2px"});var g=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:n,height:s,min:0,max:1,value:1,resolution:225,eventResMs:1e3/30,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){t.brushSettingService.setOpacity(e)}});(0,$7jh4K.css)(g.getElement(),{margin:"2px 0"}),this.rootEl.append(f.getElement(),g.getElement());var v=function(e){"color"===e.type&&(o?p(e.value):l.color=e.value),"size"===e.type&&(o?f.setValue(e.value):l.size=e.value),"opacity"===e.type&&(o?g.setValue(e.value):l.opacity=e.value),"sliderConfig"===e.type&&(f.update(e.value.sizeSlider),g.update(e.value.opacitySlider))};t.brushSettingService.subscribe(v);var m=t.brushSettingService.getSliderConfig();f.update(m.sizeSlider),g.update(m.opacitySlider),f.setValue(t.brushSettingService.getSize()),g.setValue(t.brushSettingService.getOpacity());var y=function(){$eWjiX.BB.unfocusAnyInput(),i.rootEl.style.display=o?"block":"none",o&&x&&(0,$7jh4K.css)(i.rootEl,{left:x.x-Math.round(n/2)+"px",top:x.y-Math.round(r+3*a/2)+"px"})},x=null;document.addEventListener("pointermove",function(e){x={x:e.pageX,y:e.pageY}},{passive:!1}),new $eWjiX.BB.KeyListener({onDown:function(e,i,n,r){if(!r){if(o){o=!1,y();return}t.enabledTest()&&x&&["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(n)&&(i.preventDefault(),o=!0,null!==l.color&&(p(l.color),l.color=null),null!==l.size&&(f.setValue(l.size),l.size=null),null!==l.opacity&&(g.setValue(l.opacity),l.opacity=null),y())}},onUp:function(e,t,i){["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(i)&&o&&(o=!1,c.end(),y())},onBlur:function(){o&&(o=!1,c.end(),y())}})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$8f2db75412060fdc$exports={};$8f2db75412060fdc$exports=$parcel$resolve("eHdqz");var $74ce9fe92d58e953$exports={};$74ce9fe92d58e953$exports=$parcel$resolve("3x5dR");var $ea09e4c322d05e2e$exports={};$ea09e4c322d05e2e$exports=$parcel$resolve("hbDTd");var $7ba84df17a4098f2$exports={};$7ba84df17a4098f2$exports=$parcel$resolve("16iGk");var $680b545dae725a15$exports={};$680b545dae725a15$exports=$parcel$resolve("2ME3z");var $5f1a2e996d986b65$exports={};$5f1a2e996d986b65$exports=$parcel$resolve("hZnSk");var $7jh4K=parcelRequire("7jh4K"),$6003e73b8cbb69e2$export$665d2c76b1eb8459=function(){"use strict";function e(t){(0,$cx0mh._)(this,e);var i=function(e){var t=6+(e.extraPadding?e.extraPadding:0),i=$eWjiX.BB.el({className:"toolspace-row-button nohighlight",title:e.title,onClick:e.onClick,css:{padding:e.contain?t+"px 0":""}}),n=$eWjiX.BB.el({className:e.darkInvert?"dark-invert":void 0,css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%"}});n.style.pointerEvents="none",i.append(n);var r=new $eWjiX.BB.PointerListener({target:i,onEnterLeave:function(e){i.classList.toggle("toolspace-row-button-hover",e)}});return{el:i,pointerListener:r}};this.rootEl=$eWjiX.BB.el({className:"kl-toolspace-row",css:{height:"36px",display:"flex"}});var n=i({onClick:t.onLogo,title:$8d7403abedf7cefa$export$ce37e184d908d785("home"),image:t.logoImg?t.logoImg:$parcel$interopDefault($8f2db75412060fdc$exports),contain:!0,darkInvert:!0});n.el.classList.add("kl-tool-row-border-right"),(0,$7jh4K.css)(n.el,{width:"46px"});var r=i({onClick:t.onNew,title:$8d7403abedf7cefa$export$ce37e184d908d785("file-new"),image:$parcel$interopDefault($74ce9fe92d58e953$exports),extraPadding:1,contain:!0}),a=i({onClick:t.onImport,title:$8d7403abedf7cefa$export$ce37e184d908d785("file-import"),image:$parcel$interopDefault($ea09e4c322d05e2e$exports),extraPadding:1,contain:!0}),s=i({onClick:t.onSave,title:$8d7403abedf7cefa$export$ce37e184d908d785("file-save"),image:$parcel$interopDefault($7ba84df17a4098f2$exports),extraPadding:1,contain:!0}),o=null;$eWjiX.BB.canShareFiles()&&(o=i({onClick:t.onShare,title:$8d7403abedf7cefa$export$ce37e184d908d785("file-share"),image:$parcel$interopDefault($680b545dae725a15$exports),contain:!0,darkInvert:!0}));var l=i({onClick:t.onHelp,title:$8d7403abedf7cefa$export$ce37e184d908d785("help"),image:$parcel$interopDefault($5f1a2e996d986b65$exports),contain:!0,darkInvert:!0});$eWjiX.BB.append(this.rootEl,[n.el,r.el,a.el,s.el,o?o.el:void 0,l.el])}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$1813762111ff3b93$exports={};$1813762111ff3b93$exports=$parcel$resolve("6mHrC");var $09067d6182ed3b8e$exports={};$09067d6182ed3b8e$exports=$parcel$resolve("hS5Hj");var $493fdfa42d027406$exports={};$493fdfa42d027406$exports=$parcel$resolve("4KGfM");var $7bad8de727b6761d$exports={};$7bad8de727b6761d$exports=$parcel$resolve("doX4v");var $a931fbdaeae5b97a$exports={};$a931fbdaeae5b97a$exports=$parcel$resolve("7NqHO");var $b8ba25f8f8b8d477$exports={};$b8ba25f8f8b8d477$exports=$parcel$resolve("kOuYd");var $04lDo=parcelRequire("04lDo"),$7jh4K=parcelRequire("7jh4K"),$18c597dee53260ff$export$a0a40f8a0b8fee15=function(){"use strict";function e(t){var i,n,r,a,s=this;(0,$cx0mh._)(this,e),this.smallMargin="6px 0",this.optionArr=["brush","paintBucket","gradient","text","shape","select"],this.imArr=[$parcel$interopDefault($1813762111ff3b93$exports),$parcel$interopDefault($09067d6182ed3b8e$exports),$parcel$interopDefault($493fdfa42d027406$exports),$parcel$interopDefault($7bad8de727b6761d$exports),$parcel$interopDefault($a931fbdaeae5b97a$exports),$parcel$interopDefault($b8ba25f8f8b8d477$exports)],this.titleArr=[`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-brush")} [B]`,`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-paint-bucket")} [G]`,`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-gradient")} [G]`,`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-text")} [T]`,`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-shape")} [U]`,`${$8d7403abedf7cefa$export$ce37e184d908d785("tool-select")} [L]`],this.currentActiveIndex=0,this.isActive=!0;var o=!1;setTimeout(function(){for(var e=1;e<s.imArr.length;e++)new Image().src=s.imArr[e]},100),this.rootEl=$eWjiX.BB.el({css:{position:"relative",flexGrow:"1"}});var l=!1;$eWjiX.BB.hasPointerEvents&&(a=new $eWjiX.BB.PointerListener({target:this.rootEl,onPointer:function(e){if("pointerdown"===e.type)o||(i=setTimeout(function(){f()},400),l=!0,n=e.pageX,r=e.pageY);else if("pointermove"===e.type&&l)!o&&$eWjiX.BB.dist(n,r,e.pageX,e.pageY)>5&&(clearTimeout(i),f());else if("pointerup"===e.type&&l&&(clearTimeout(i),l=!1,o)){for(var a=document.elementFromPoint(e.pageX,e.pageY),h=0;h<s.dropdownBtnArr.length;h++)if(a===s.dropdownBtnArr[h].wrapper){g(),s.isActive=!0,s.currentActiveIndex=h,s.updateButton(),t.onChange(s.optionArr[s.currentActiveIndex]);break}}}})),this.activeButton=$eWjiX.BB.el({parent:this.rootEl,className:"toolspace-row-button nohighlight toolspace-row-button-activated",title:this.titleArr[this.currentActiveIndex],onClick:function(e){if(s.isActive&&!o){e.preventDefault(),e.stopPropagation(),f();return}s.isActive=!0,t.onChange(s.optionArr[s.currentActiveIndex]),o&&g()},css:{padding:"10px 0",pointerEvents:"auto",height:"100%",boxSizing:"border-box",zIndex:"1"}}),new(0,$04lDo.PointerListener)({target:this.activeButton,onEnterLeave:function(e){s.activeButton.classList.toggle("kl-tool-button--hover",e)}}),this.activeButtonIm=$eWjiX.BB.el({parent:this.activeButton,className:"dark-invert",css:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",width:"calc(100% - 7px)",height:"100%",pointerEvents:"none",opacity:"0.75"}}),this.arrowButton=$eWjiX.BB.el({parent:this.activeButton,className:"kl-tooldropdown-caret",content:$075b9fd415bad4ff$export$db3b6bfb95261072(".dark-invert"),title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-more-tools"),onClick:function(e){e.preventDefault(),e.stopPropagation(),f()}});var h=$eWjiX.BB.el({css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"}});new $eWjiX.BB.PointerListener({target:h,onPointer:function(e){"pointerdown"===e.type&&(e.eventPreventDefault(),g())}});var c=$eWjiX.BB.el({className:"tool-dropdown-wrapper",css:{position:"absolute",width:"100%",height:100*(this.optionArr.length-1)+"%",top:"100%",left:"0",zIndex:"-1",boxSizing:"border-box",cursor:"pointer",transition:"height 0.1s ease-in-out, opacity 0.1s ease-in-out",borderBottomLeftRadius:"5px",borderBottomRightRadius:"5px",overflow:"hidden"}});this.dropdownBtnArr=[];for(var u=function(e){var t=$eWjiX.BB.el({parent:c,className:"tool-dropdown-button",title:e.title,css:{padding:"10px 0",height:100/(s.optionArr.length-1)+"%",boxSizing:"border-box"},onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onClick(e.index)}});$eWjiX.BB.el({parent:t,className:"dark-invert",css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",height:"100%",pointerEvents:"none",opacity:"0.75"}});var i=function(e){t.style.display=e?"block":"none"},n=function(e){t.style.padding=e?s.smallMargin:"10px 0"};return{wrapper:t,show:i,setIsSmall:n}},d=function(e){g(),s.isActive=!0,s.currentActiveIndex=e,s.updateButton(),t.onChange(s.optionArr[s.currentActiveIndex])},p=0;p<this.optionArr.length;p++)this.dropdownBtnArr.push(u({index:p,id:this.optionArr[p],image:this.imArr[p],title:this.titleArr[p],onClick:d}));var f=function(){if(!($dd0d395ff14a3e11$export$d3d1650bc39c4419.get()>0)){$dd0d395ff14a3e11$export$d3d1650bc39c4419.increase(.5),o=!0;for(var e=0;e<s.optionArr.length;e++)s.dropdownBtnArr[e].show(s.currentActiveIndex!==e);s.arrowButton.style.setProperty("opacity","0"),s.arrowButton.style.setProperty("pointer-events","none"),s.rootEl.style.zIndex="1",document.body.append(h),s.rootEl.append(c)}},g=function(){$dd0d395ff14a3e11$export$d3d1650bc39c4419.decrease(.5),o=!1,s.arrowButton.style.removeProperty("opacity"),s.arrowButton.style.removeProperty("pointer-events"),s.rootEl.style.removeProperty("z-index"),h.remove(),c.remove()};this.updateButton()}return(0,$7h4XF._)(e,[{key:"updateButton",value:function(){this.activeButton.title=this.titleArr[this.currentActiveIndex]+(this.isActive?" ("+$8d7403abedf7cefa$export$ce37e184d908d785("tool-more-tools-click-again")+")":""),this.activeButtonIm.style.backgroundImage="url('"+this.imArr[this.currentActiveIndex]+"')"}},{key:"setIsSmall",value:function(e){this.activeButton.style.padding=e?this.smallMargin:"10px 0";for(var t=0;t<this.optionArr.length;t++)this.dropdownBtnArr[t].setIsSmall(e);(0,$7jh4K.css)(this.arrowButton,{width:e?"14px":"18px",height:e?"14px":"18px"})}},{key:"setActive",value:function(e){if(this.optionArr.includes(e)){this.isActive=!0;for(var t=0;t<this.optionArr.length;t++)if(this.optionArr[t]===e){this.currentActiveIndex=t;break}this.activeButton.classList.add("toolspace-row-button-activated"),this.updateButton()}else this.isActive=!1,this.activeButton.classList.remove("toolspace-row-button-activated"),this.updateButton()}},{key:"getActive",value:function(){return this.optionArr[this.currentActiveIndex]}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$33d76dcc22e5d968$exports={};$33d76dcc22e5d968$exports=$parcel$resolve("AnO0a");var $7jh4K=parcelRequire("7jh4K"),$a372d78c806cd0cc$export$c744a22bef9e0b97=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({className:"kl-toolspace-row",css:{height:"54px",display:"flex"}}),this.onActivate=t.onActivate,this.currentActiveStr="brush";var n=function(e){var t=e.doLighten?"6px 0":"8px 0",i=$eWjiX.BB.el({className:"toolspace-row-button nohighlight",onClick:e.onClick,css:{padding:e.contain?"10px 0":""}}),n=$eWjiX.BB.el({className:"dark-invert",css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%",transform:e.doMirror?"scale(-1, 1)":"",pointerEvents:"none",opacity:e.doLighten?"0.75":"1"}});i.append(n);var r=new $eWjiX.BB.PointerListener({target:i,onEnterLeave:function(e){i.classList.toggle("toolspace-row-button-hover",e)}}),a=function(n){i.style.padding=e.contain?n?t:"10px 0":""};return{el:i,pointerListener:r,setIsSmall:a}},r=function(e){var t=$eWjiX.BB.el({css:{flexGrow:"1",position:"relative"}}),i=$eWjiX.BB.createSvg({elementType:"svg",width:"67px",height:"54px",viewBox:"0 0 100 100",preserveAspectRatio:"none"});(0,$7jh4K.css)(i,{position:"absolute",left:"0",top:"0"});var n=10,r=2,a=2,s=$eWjiX.BB.createSvg({elementType:"defs",childrenArr:[{elementType:"filter",id:"innershadow",x0:"-50%",y0:"-50%",width:"200%",height:"200%",childrenArr:[{elementType:"feGaussianBlur",in:"SourceAlpha",stdDeviation:""+n,result:"blur"},{elementType:"feOffset",dx:""+r,dy:""+a},{elementType:"feComposite",in2:"SourceAlpha",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"SourceGraphic",operator:"over",result:"firstfilter"},{elementType:"feGaussianBlur",in:"firstfilter",stdDeviation:""+n,result:"blur2"},{elementType:"feOffset",dx:""+r,dy:""+a},{elementType:"feComposite",in2:"firstfilter",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"firstfilter",operator:"over"}]}]}),o=$eWjiX.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M0,0 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});o.onclick=function(){e.onLeft(),o.classList.remove("toolspace-svg-triangle-button-hover")};var l=$eWjiX.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M100,100 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});l.onclick=function(){e.onRight(),l.classList.remove("toolspace-svg-triangle-button-hover")};var h=new $eWjiX.BB.PointerListener({target:o,onEnterLeave:function(e){o.classList.toggle("toolspace-svg-triangle-button-hover",e)}}),c=new $eWjiX.BB.PointerListener({target:l,onEnterLeave:function(e){l.classList.toggle("toolspace-svg-triangle-button-hover",e)}});i.append(s,o,l),t.append(i);var u=$eWjiX.BB.el({parent:t,className:"dark-invert",css:{backgroundImage:"url('"+e.leftImage+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",left:"10px",top:"8px",pointerEvents:"none"}});t.append(u);var d=$eWjiX.BB.el({parent:t,className:"dark-invert",css:{backgroundImage:"url('"+(e.rightImage?e.rightImage:e.leftImage)+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",right:"10px",bottom:"8px",transform:e.rightImage?"":"scale(-1, 1)",pointerEvents:"none"}});return{el:t,setIsEnabledLeft:function(e){o.classList.toggle("toolspace-row-button-disabled",!e),u.classList.toggle("toolspace-row-button-disabled",!e)},setIsEnabledRight:function(e){l.classList.toggle("toolspace-row-button-disabled",!e),d.classList.toggle("toolspace-row-button-disabled",!e)},leftPointerListener:h,rightPointerListener:c}};this.toolDropdown=new $18c597dee53260ff$export$a0a40f8a0b8fee15({onChange:function(e){i.setActive(e,!0)}}),this.rootEl.append(this.toolDropdown.getElement()),this.handButton=n({onClick:function(){i.setActive("hand",!0)},image:$parcel$interopDefault($ec1da9254c8485a7$exports),contain:!0,doLighten:!0}),this.handButton.el.classList.add("kl-tool-row-border-right"),this.handButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("tool-hand"),this.rootEl.append(this.handButton.el),this.zoomInNOutButton=r({onLeft:t.onZoomIn,onRight:t.onZoomOut,leftImage:$parcel$interopDefault($c88da6b7fdef67e7$exports),rightImage:$parcel$interopDefault($e503dd0072d83d49$exports)}),this.zoomInNOutButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("tool-zoom"),this.rootEl.append(this.zoomInNOutButton.el),this.zoomInButton=n({onClick:t.onZoomIn,image:$parcel$interopDefault($c88da6b7fdef67e7$exports),contain:!0}),this.zoomInButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("zoom-in"),this.rootEl.append(this.zoomInButton.el),this.zoomOutButton=n({onClick:t.onZoomOut,image:$parcel$interopDefault($e503dd0072d83d49$exports),contain:!0}),this.zoomOutButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("zoom-out"),this.rootEl.append(this.zoomOutButton.el),this.undoNRedoButton=r({onLeft:t.onUndo,onRight:t.onRedo,leftImage:$parcel$interopDefault($33d76dcc22e5d968$exports),rightImage:null}),this.undoNRedoButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("undo")+"/"+$8d7403abedf7cefa$export$ce37e184d908d785("redo"),this.undoNRedoButton.setIsEnabledLeft(!1),this.undoNRedoButton.setIsEnabledRight(!1),this.rootEl.append(this.undoNRedoButton.el),this.undoButton=n({onClick:t.onUndo,image:$parcel$interopDefault($33d76dcc22e5d968$exports),contain:!0}),this.undoButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("undo"),this.undoButton.el.classList.add("toolspace-row-button-disabled"),this.rootEl.append(this.undoButton.el),this.redoButton=n({onClick:t.onRedo,image:$parcel$interopDefault($33d76dcc22e5d968$exports),contain:!0,doMirror:!0}),this.redoButton.el.title=$8d7403abedf7cefa$export$ce37e184d908d785("redo"),this.redoButton.el.classList.add("toolspace-row-button-disabled"),this.rootEl.append(this.redoButton.el),this.zoomInButton.el.style.display="none",this.zoomOutButton.el.style.display="none",this.undoButton.el.style.display="none",this.redoButton.el.style.display="none"}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"setIsSmall",value:function(e){(0,$7jh4K.css)(this.rootEl,{height:e?"36px":"54px"}),this.toolDropdown.setIsSmall(e),this.handButton.setIsSmall(e),this.zoomInButton.setIsSmall(e),this.zoomOutButton.setIsSmall(e),this.undoButton.setIsSmall(e),this.redoButton.setIsSmall(e),e?(this.zoomInNOutButton.el.style.display="none",this.undoNRedoButton.el.style.display="none",this.zoomInButton.el.style.display="block",this.zoomOutButton.el.style.display="block",this.undoButton.el.style.display="block",this.redoButton.el.style.display="block"):(this.zoomInNOutButton.el.style.display="block",this.undoNRedoButton.el.style.display="block",this.zoomInButton.el.style.display="none",this.zoomOutButton.el.style.display="none",this.undoButton.el.style.display="none",this.redoButton.el.style.display="none")}},{key:"setEnableZoomIn",value:function(e){this.zoomInButton.el.classList.toggle("toolspace-row-button-disabled",!e),this.zoomInNOutButton.setIsEnabledLeft(e)}},{key:"setEnableZoomOut",value:function(e){this.zoomOutButton.el.classList.toggle("toolspace-row-button-disabled",!e),this.zoomInNOutButton.setIsEnabledRight(e)}},{key:"setEnableUndo",value:function(e){this.undoButton.el.classList.toggle("toolspace-row-button-disabled",!e),this.undoNRedoButton.setIsEnabledLeft(e)}},{key:"setEnableRedo",value:function(e){this.redoButton.el.classList.toggle("toolspace-row-button-disabled",!e),this.undoNRedoButton.setIsEnabledRight(e)}},{key:"setActive",value:function(e,t){this.currentActiveStr!==e&&(this.currentActiveStr=e,this.toolDropdown.setActive(this.currentActiveStr),this.handButton.el.classList.toggle("toolspace-row-button-activated","hand"===this.currentActiveStr),t&&this.onActivate(this.currentActiveStr))}},{key:"getActive",value:function(){return this.currentActiveStr}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$90c04b5ac185bf3d$export$8162a66cd18867a7=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({tagName:"label",className:"kl-stabilizer",content:$8d7403abedf7cefa$export$ce37e184d908d785("stabilizer")+"&nbsp;",title:$8d7403abedf7cefa$export$ce37e184d908d785("stabilizer-title")});var i=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"]],initValue:""+t.smoothing,onChange:function(e){t.onSelect(parseInt(e))},name:"stabilizer-strength"});this.rootEl.append(i.getElement()),this.pointerListener=new $eWjiX.BB.PointerListener({target:this.rootEl,onWheel:function(e){i.setDeltaValue(e.deltaY)}})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$d04d72b97d637d65$export$3c6d17ed0106bfb9=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e);var r=null!=(i=t.height)?i:35;this.rootEl=$eWjiX.BB.el({className:"tabrow",css:{height:r+1+"px"}}),this.tabArr=[],this.roundRight=$eWjiX.BB.el({className:"tabrow__tab__rounding-left"}),this.roundLeft=$eWjiX.BB.el({className:"tabrow__tab__rounding-right"});for(var a=function(e,t,i){var a=!("isVisible"in e)||void 0===e.isVisible||e.isVisible,s={id:e.id,isVisible:a,onOpen:e.onOpen,onClose:e.onClose,update:function(e){s.el.className=e===s?i?"tabrow__tab tabrow__tab--opened-accented":"tabrow__tab tabrow__tab--opened":"tabrow__tab",s.el.style.display=s.isVisible?"block":"none"},el:$eWjiX.BB.el({parent:n.rootEl,content:"label"in e?e.label:"",title:"title"in e?e.title:void 0,className:t===e.id?i?"tabrow__tab tabrow__tab--opened-accented":"tabrow__tab tabrow__tab--opened":"tabrow__tab",css:{lineHeight:r+"px",display:a?"block":"none"},onClick:function(){n.activeTab!==s&&n.open(s.id)}}),pointerListener:{}};return"image"in e&&$eWjiX.BB.el({tagName:"span",parent:s.el,className:"dark-invert",css:{backgroundImage:`url("${e.image}")`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",display:"flex",height:r-7+"px",justifyContent:"center",margin:"4px auto"}}),"css"in e&&void 0!==e.css&&(0,$7jh4K.css)(s.el,e.css),s.pointerListener=new $eWjiX.BB.PointerListener({target:s.el,onEnterLeave:function(e){s.el.classList.toggle("tabrow__tab-hover",e)}}),t===s.id?(s.onOpen(),s.el.append(n.roundRight,n.roundLeft)):s.onClose(),s},s=null,o=0;o<t.tabArr.length;o++){var l=a(t.tabArr[o],t.initialId,t.useAccent||!1);l.id===t.initialId&&(s=l),this.tabArr.push(l)}if(!s)throw"invalid initialId";this.activeTab=s}return(0,$7h4XF._)(e,[{key:"update",value:function(){for(var e=0;e<this.tabArr.length;e++)this.tabArr[e].update(this.activeTab)}},{key:"getElement",value:function(){return this.rootEl}},{key:"open",value:function(e){for(var t=0;t<this.tabArr.length;t++)if(this.tabArr[t].id===e){if(this.activeTab===this.tabArr[t])return;this.activeTab.onClose(),this.activeTab=this.tabArr[t],this.activeTab.onOpen(),this.activeTab.el.append(this.roundRight,this.roundLeft),this.update();return}throw"TabRow.open - invalid tabId"}},{key:"getOpenedTabId",value:function(){return""+this.activeTab.id}},{key:"setIsVisible",value:function(e,t){for(var i=0;i<this.tabArr.length;i++)if(this.tabArr[i].id===e){this.tabArr[i].isVisible=t,this.update();return}throw"TabRow.setIsVisible - invalid tabId"}},{key:"destroy",value:function(){this.tabArr.forEach(function(e){$eWjiX.BB.destroyEl(e.el),e.pointerListener.destroy()})}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$4acb6b8f0d0d377a$exports={};$4acb6b8f0d0d377a$exports=$parcel$resolve("6toXQ");var $6l0gQ=parcelRequire("6l0gQ"),$7jh4K=parcelRequire("7jh4K"),$72Jv0=parcelRequire("72Jv0"),$9934467c988b088a$var$LS_INERTIA_KEY="kl-inertia-scroll",$9934467c988b088a$export$cf20160367bae46c=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.isVisible=!0,this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}}),this.scale=t.scale,this.angleDeg=t.angleDeg,this.onAngleChange=t.onAngleChange;var i=$eWjiX.BB.el({css:{marginBottom:"10px",display:"flex"}}),n=$eWjiX.BB.el({css:{display:"flex",marginBottom:"10px"}}),r=$eWjiX.BB.el({css:{display:"flex"}});this.rootEl.append(i,n,r),this.scaleEl=$eWjiX.BB.el({css:{width:"65px",userSelect:"none",fontFamily:"monospace"}}),i.append(this.scaleEl),this.angleIm=new Image,this.angleIm.src=$parcel$interopDefault($ad47d2e0edfb40c7$exports),(0,$7jh4K.css)(this.angleIm,{verticalAlign:"bottom",width:"20px",height:"20px",marginRight:"5px",borderRadius:"10px",background:"rgba(0,0,0,0.2)",userSelect:"none"}),i.append(this.angleIm),this.angleEl=$eWjiX.BB.el({parent:i,css:{userSelect:"none"}}),this.updateUi();var a=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("hand-reset"),onClick:t.onReset});(0,$72Jv0.makeUnfocusable)(a);var s=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("hand-fit"),css:{marginLeft:"10px"},onClick:t.onFit});(0,$72Jv0.makeUnfocusable)(s),n.append(a,s);var o=new Image;o.height=20,o.src=$parcel$interopDefault($4acb6b8f0d0d377a$exports),o.alt="Rotate",(0,$7jh4K.css)(o,{transform:"scale(-1, 1)"});var l=$eWjiX.BB.el({tagName:"button",content:o,onClick:function(){t.onAngleChange(-15,!0)}});(0,$72Jv0.makeUnfocusable)(l);var h=$eWjiX.BB.el({tagName:"button",content:"0",css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(0)}});(0,$72Jv0.makeUnfocusable)(h);var c=$eWjiX.BB.el({tagName:"button",content:'<img height="20" src="'+$parcel$interopDefault($4acb6b8f0d0d377a$exports)+'" alt="Rotate"/>',css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(15,!0)}});(0,$72Jv0.makeUnfocusable)(c),r.append(l,h,c);var u=new $365a915dfb503274$export$48513f6b9f8ce62d({label:$8d7403abedf7cefa$export$ce37e184d908d785("hand-inertia-scrolling"),init:"true"===$6l0gQ.LocalStorage.getItem($9934467c988b088a$var$LS_INERTIA_KEY),callback:function(e){$6l0gQ.LocalStorage.setItem($9934467c988b088a$var$LS_INERTIA_KEY,""+e),t.onChangeUseInertiaScrolling(e)},name:"enable-inertia-scrolling"});setTimeout(function(){t.onChangeUseInertiaScrolling(u.getValue())},500),(0,$7jh4K.css)(u.getElement(),{marginTop:"10px",display:"inline-block"}),this.rootEl.append(u.getElement())}return(0,$7h4XF._)(e,[{key:"updateUi",value:function(){this.scaleEl.innerHTML=Math.round(100*this.scale)+"%",this.angleEl.innerHTML=Math.round(this.angleDeg)+"",(0,$7jh4K.css)(this.angleIm,{transform:"rotate("+this.angleDeg+"deg)",boxShadow:this.angleDeg%90==0?"inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)":""})}},{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.updateUi()}},{key:"update",value:function(e,t){this.scale=e,this.angleDeg=t,this.isVisible&&this.updateUi()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$51d47356d698ffec$export$1e63e3b0645421a2=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$eWjiX.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.colorSlider=t.colorSlider,this.opacitySlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:1,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e}}),this.rootEl.append(this.opacitySlider.getElement()),this.toleranceSlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-tolerance"),width:250,height:30,min:0,max:255,value:51,toValue:function(e){return 2.55*e},toDisplayValue:function(e){return e/2.55}}),(0,$7jh4K.css)(this.toleranceSlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.toleranceSlider.getElement());var n=$eWjiX.BB.el({parent:this.rootEl,css:{display:"flex",marginTop:"10px"}}),r=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-sample")+"&nbsp;",title:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-sample-title"),css:{fontSize:"15px"}});this.modeSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:[["all",$8d7403abedf7cefa$export$ce37e184d908d785("bucket-sample-all")],["current",$8d7403abedf7cefa$export$ce37e184d908d785("bucket-sample-active")],["above",$8d7403abedf7cefa$export$ce37e184d908d785("bucket-sample-above")]],initValue:"all",name:"sampling-mode"}),new $eWjiX.BB.PointerListener({target:this.modeSelect.getElement(),onWheel:function(e){i.modeSelect.setDeltaValue(e.deltaY)}}),r.append(this.modeSelect.getElement()),n.append(r);var a=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-grow")+"&nbsp;",title:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-grow-title"),css:{fontSize:"15px",marginLeft:"10px"}});this.growSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"]],initValue:"0",name:"fill-growth"}),new $eWjiX.BB.PointerListener({target:this.growSelect.getElement(),onWheel:function(e){i.growSelect.setDeltaValue(e.deltaY)}}),a.append(this.growSelect.getElement()),n.append(a),this.isContiguous=!0;var s=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-contiguous"),title:$8d7403abedf7cefa$export$ce37e184d908d785("bucket-contiguous-title"),callback:function(e){i.isContiguous=e},name:"is-contiguous"});this.eraserToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("eraser"),name:"eraser-toggle"}),this.rootEl.append($eWjiX.BB.el({content:[s.getElement(),this.eraserToggle.getElement()],css:{display:"flex",marginTop:"10px",gap:"10px"}}))}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}},{key:"getTolerance",value:function(){return 0===Math.round(this.toleranceSlider.getDisplayValue())?0:this.toleranceSlider.getValue()}},{key:"getOpacity",value:function(){return this.opacitySlider.getValue()}},{key:"getSample",value:function(){return this.modeSelect.getValue()}},{key:"getGrow",value:function(){return parseInt(this.growSelect.getValue(),10)}},{key:"getContiguous",value:function(){return this.isContiguous}},{key:"getIsEraser",value:function(){return this.eraserToggle.getValue()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$d06987f550ff485e$export$32a22540e4b2f123=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.isVisible=!0,this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}}),this.colorSlider=t.colorSlider,this.colorDiv=$eWjiX.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),$eWjiX.BB.el({parent:this.rootEl,content:$8d7403abedf7cefa$export$ce37e184d908d785("text-instruction")})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$45c003c723de07b5$export$a9387b1d4260d39c=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.shape="rect",this.mode="stroke",this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$eWjiX.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.colorSlider=t.colorSlider;var n=35,r=8,a=$eWjiX.BB.createSvg({elementType:"rect",x:""+r,width:""+(n-2*r)}),s=$eWjiX.BB.createSvg({elementType:"svg",width:""+n,height:""+n});s.classList.add("dark-invert"),s.append(a),(0,$7jh4K.css)(s,{display:"block"});var o=$eWjiX.BB.createSvg({elementType:"rect",x:""+r,width:""+(n-2*r)}),l=$eWjiX.BB.createSvg({elementType:"svg",width:""+n,height:""+n});l.classList.add("dark-invert"),l.append(o),(0,$7jh4K.css)(l,{display:"block"});var h=$eWjiX.BB.createSvg({elementType:"ellipse",cx:""+n/2,cy:""+n/2,rx:""+(n/2-r)}),c=$eWjiX.BB.createSvg({elementType:"svg",width:""+n,height:""+n});c.classList.add("dark-invert"),c.append(h),(0,$7jh4K.css)(c,{display:"block"});var u=$eWjiX.BB.createSvg({elementType:"ellipse",cx:""+n/2,cy:""+n/2,rx:""+(n/2-r)}),d=$eWjiX.BB.createSvg({elementType:"svg",width:""+n,height:""+n});d.classList.add("dark-invert"),d.append(u),(0,$7jh4K.css)(d,{display:"block"});var p=$eWjiX.BB.createSvg({elementType:"line",x1:""+r,x2:""+(n-r)}),f=$eWjiX.BB.createSvg({elementType:"svg",width:""+n,height:""+n});f.classList.add("dark-invert"),f.append(p),(0,$7jh4K.css)(f,{display:"block"});var g=function(){var e=$eWjiX.BB.clamp(Math.round(i.lineWidthSlider.getValue()/10),1,10)+"px",t=1.35;(0,$7jh4K.css)(a,{fill:"none",stroke:"black",strokeWidth:e}),(0,$7jh4K.css)(o,{fill:"black",stroke:"none"}),(0,$7jh4K.css)(h,{fill:"none",stroke:"black",strokeWidth:e}),(0,$7jh4K.css)(u,{fill:"black",stroke:"none"}),(0,$7jh4K.css)(p,{fill:"none",stroke:"black",strokeWidth:e}),i.fixedToggle.getValue()?(a.setAttribute("y",""+r),a.setAttribute("height",""+(n-2*r)),o.setAttribute("y",""+r),o.setAttribute("height",""+(n-2*r)),h.setAttribute("ry",""+(n/2-r)),u.setAttribute("ry",""+(n/2-r))):(a.setAttribute("y",""+r*t),a.setAttribute("height",""+(n-r*t*2)),o.setAttribute("y",""+r*t),o.setAttribute("height",""+(n-r*t*2)),h.setAttribute("ry",""+(n/2-r*t)),u.setAttribute("ry",""+(n/2-r*t))),i.snapToggle.getValue()?(p.setAttribute("y1",""+(n-r)),p.setAttribute("y2",""+r)):(p.setAttribute("y1",""+(n-r*t)),p.setAttribute("y2",""+r*t))},v=$eWjiX.BB.el({parent:this.rootEl,css:{display:"flex",justifyContent:"space-between",alignItems:"start"}}),m=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"rect-stroke",label:s,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-rect")+" "+$8d7403abedf7cefa$export$ce37e184d908d785("shape-stroke")},{id:"ellipse-stroke",label:c,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-ellipse")+" "+$8d7403abedf7cefa$export$ce37e184d908d785("shape-stroke")},{id:"line",label:f,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-line")},{id:"rect-fill",label:l,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-rect")+" "+$8d7403abedf7cefa$export$ce37e184d908d785("shape-fill")},{id:"ellipse-fill",label:d,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-ellipse")+" "+$8d7403abedf7cefa$export$ce37e184d908d785("shape-fill")}],initId:this.shape+" "+this.mode,onChange:function(e){var t=e.split("-");i.shape=t[0],i.mode=t[1],(0,$7jh4K.css)(i.fixedToggle.getElement(),{display:"line"===i.shape?"none":""}),(0,$7jh4K.css)(i.snapToggle.getElement(),{display:"line"===i.shape?"":"none"}),(0,$7jh4K.css)(i.lineWidthSlider.getElement(),{display:"line"!==i.shape&&"fill"===i.mode?"none":""})},changeOnInit:!0,css:{width:"120px"}});v.append(m.getElement()),this.eraserToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("eraser"),callback:function(){g()},name:"enable-eraser"}),this.lockAlphaToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),doHighlight:!0,name:"enable-alpha-lock"}),this.lockAlphaToggle.getElement().style.marginTop="10px",this.panningToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-auto-pan"),title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-auto-pan-title"),callback:function(e){return t.onChangePanning(e)},name:"enable-auto-pan"}),this.panningToggle.getElement().style.marginTop="10px",v.append($eWjiX.BB.el({content:[this.eraserToggle.getElement(),this.lockAlphaToggle.getElement(),this.panningToggle.getElement()]})),this.lineWidthSlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-line-width"),width:250,height:30,min:1,max:200,value:4,curve:"quadratic",onChange:function(){g()}}),(0,$7jh4K.css)(this.lineWidthSlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.lineWidthSlider.getElement()),this.opacitySlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:1,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e}}),(0,$7jh4K.css)(this.opacitySlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.opacitySlider.getElement());var y=$eWjiX.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px",gap:"10px"}});this.outwardsToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-outwards"),name:"enable-outwards"}),y.append(this.outwardsToggle.getElement()),this.fixedToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-fixed"),callback:function(){g()},name:"enable-fixed-proportions"}),y.append(this.fixedToggle.getElement()),this.snapToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("angle-snap"),title:$8d7403abedf7cefa$export$ce37e184d908d785("angle-snap-title"),callback:function(){g()},name:"enable-angle-snapping"}),y.append(this.snapToggle.getElement()),g()}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&(this.colorDiv.append(this.colorSlider.getElement()),this.colorDiv.append(this.colorSlider.getOutputElement()))}},{key:"getShape",value:function(){return this.shape}},{key:"getMode",value:function(){return this.mode}},{key:"getIsEraser",value:function(){return this.eraserToggle.getValue()}},{key:"getOpacity",value:function(){return this.opacitySlider.getValue()}},{key:"getLineWidth",value:function(){return this.lineWidthSlider.getValue()}},{key:"getIsOutwards",value:function(){return this.outwardsToggle.getValue()}},{key:"getIsFixed",value:function(){return this.fixedToggle.getValue()}},{key:"getIsSnap",value:function(){return this.snapToggle.getValue()}},{key:"getDoLockAlpha",value:function(){return this.lockAlphaToggle.getValue()}}]),e}(),$eWjiX=parcelRequire("eWjiX"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX");function $96366ef7b36c82a7$export$9852986a3ec5f6a0(e,t){var i=$eWjiX.BB.el({tagName:"table",className:"kl-table"});return e.forEach(function(e,n){var r,a=$eWjiX.BB.el({tagName:"tr"});(r=a).append.apply(r,(0,$bX4ja._)(e.map(function(e,i){var r=$eWjiX.BB.el({tagName:"td",content:e}),a=n+"."+i;return void 0!==t&&a in t&&(r.rowSpan=t[a].rowspan),r}))),i.append(a)}),i}var $7jh4K=parcelRequire("7jh4K");function $4fb68589de8a8c9a$export$f77a89101d7d6586(e){var t=e.currentColor,i=e.secondaryColor,n=e.maxCanvasSize,r=e.canvasWidth,a=e.canvasHeight,s=e.workspaceWidth,o=e.workspaceHeight,l=e.onConfirm,h=e.onCancel;function c(e,t,i,r,a){return $eWjiX.BB.fitInto(e,t,Math.min(n,i-a),Math.min(n,r-a),1)}var u=$eWjiX.BB.el(),d=$eWjiX.BB.el({tagName:"input",custom:{name:"image-width"}}),p={color:"#888",fontSize:"12px",marginLeft:"5px"},f=$eWjiX.BB.el({textContent:$8d7403abedf7cefa$export$ce37e184d908d785("new-px"),css:p}),g=$eWjiX.BB.el({tagName:"input",custom:{name:"image-height"}}),v=$eWjiX.BB.el({textContent:$8d7403abedf7cefa$export$ce37e184d908d785("new-px"),css:p});d.setAttribute("data-ignore-focus","true"),g.setAttribute("data-ignore-focus","true"),d.type="number",d.min="1",d.max=""+n,(0,$7jh4K.css)(d,{width:"70px"}),g.type="number",g.min="1",g.max=""+n,g.style.width="70px",d.value=""+r,g.value=""+a,d.onclick=function(){d.focus(),P()},g.onclick=function(){g.focus(),P()};var m=$96366ef7b36c82a7$export$9852986a3ec5f6a0([[$8d7403abedf7cefa$export$ce37e184d908d785("width")+":&nbsp;",d,f],[$eWjiX.BB.el({css:{height:"5px"}}),"",""],[$8d7403abedf7cefa$export$ce37e184d908d785("height")+":&nbsp;",g,v]]);(0,$7jh4K.css)(m,{marginBottom:"10px"});var y=$eWjiX.BB.el({css:{marginTop:"5px",color:"#888"}}),x=$eWjiX.BB.el({css:{display:"flex",flexWrap:"wrap",gap:"5px",marginBottom:"10px"}}),b={tagName:"button",css:{flexGrow:"1"}},w=$eWjiX.BB.el(b),k=$eWjiX.BB.el(b),B=$eWjiX.BB.el(b),S=$eWjiX.BB.el(b),C=$eWjiX.BB.el(b),E=$eWjiX.BB.el(b);k.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-current"),w.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-fit"),E.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-oversize"),S.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-landscape"),C.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-portrait"),B.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("new-square"),x.append(k,w,E,B,S,C);var _=0;k.onclick=function(){d.value=""+r,g.value=""+a,P()},w.onclick=function(){d.value=""+s,g.value=""+o,P()},E.onclick=function(){d.value=""+(s+500),g.value=""+(o+500),P()},B.onclick=function(){var e=c(1,1,s,o,_);d.value=""+Math.round(e.width),g.value=""+Math.round(e.height),P()},S.onclick=function(){var e=c(4,3,s,o,_);d.value=""+Math.round(e.width),g.value=""+Math.round(e.height),P()},C.onclick=function(){var e=c(3,4,s,o,_);d.value=""+Math.round(e.width),g.value=""+Math.round(e.height),P()};var I=new $7a3263857aacf58f$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["screen",$8d7403abedf7cefa$export$ce37e184d908d785("new-screen")],["16 9",$8d7403abedf7cefa$export$ce37e184d908d785("new-video")+" 16:9"],["3 2","3:2"],["5 3","5:3"],["2 1","2:1"],["paper",$8d7403abedf7cefa$export$ce37e184d908d785("new-din-paper")+" 2:1"],["9 16","9:16"],["2 3","2:3"],["3 5","3:5"],["1 2","1:2"],["1 1.4142135623730951","1:2"]],onChange:function(e){if("screen"===e)d.value=""+window.screen.width,g.value=""+window.screen.height;else if("paper"===e){var t=c(Math.sqrt(2),1,s,o,_);d.value=""+Math.round(t.width),g.value=""+Math.round(t.height)}else{var i=e.split(" "),n=c(parseFloat(i[0]),parseFloat(i[1]),s,o,_);d.value=""+Math.round(n.width),g.value=""+Math.round(n.height)}P(),I.setValue(void 0)},name:"image-format"});setTimeout(function(){I.setValue(void 0)},0),(0,$7jh4K.css)(I.getElement(),{width:"80px",flexGrow:"1"}),x.append(I.getElement());var T={r:255,g:255,b:255,a:1},M=new $4db8cbbb01889095$export$24ba9b81662d4366({colorArr:[{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1},{r:0,g:0,b:0,a:0},{r:t.r,g:t.g,b:t.b,a:1},{r:i.r,g:i.g,b:i.b,a:1}],initialIndex:0,onChange:function(e){T=e,R.style.backgroundColor="rgba("+e.r+","+e.g+","+e.b+", "+e.a+")"}}),L=$eWjiX.BB.el({className:"kl-transparent-preview",css:{boxSizing:"border-box",width:"340px",height:"140px",display:"table",padding:"10px",marginTop:"10px",marginLeft:"-20px",background:"var(--kl-checkerboard-background)"}}),R=$eWjiX.BB.el({className:"kl-transparent-preview__canvas",css:{width:"200px",height:"100px",backgroundColor:"rgba("+T.r+","+T.g+","+T.b+", "+T.a+")",marginLeft:"auto",marginRight:"auto",color:"#aaa",fontSize:"16px",fontWeight:"bold",textAlign:"center",verticalAlign:"center",display:"table",overflow:"hidden"}});function P(){function e(e,t){for(var i=e,n=t;;){if(!(i%=n))return n;if(!(n%=i))return i}}d.value=""+Math.min(n,parseInt(d.value)),g.value=""+Math.min(n,parseInt(g.value));var t=parseInt(d.value),i=parseInt(g.value);(t<1||t>n||i<1||i>n)&&(t>n?t=n:i>n&&(i=n),d.value=""+t,g.value=""+i);for(var r=[[1,2],[2,1],[2,3],[3,2],[3,4],[4,3],[4,5],[5,4],[16,9],[9,16],[3,2],[2,3],[5,3],[3,5],[2,1],[1,2],[1.414,1],[1,1.414]],a=$eWjiX.BB.reduce(t,i),s=r[0],o=Math.abs(r[0][0]/r[0][1]-a[0]/a[1]),l=0;l<r.length;l++)Math.abs(r[l][0]/r[l][1]-a[0]/a[1])<o&&(s=r[l],o=Math.abs(r[l][0]/r[l][1]-a[0]/a[1]));o>0&&o<.005?y.innerText=$8d7403abedf7cefa$export$ce37e184d908d785("new-ratio")+": ~"+s[0]+":"+s[1]:y.innerText=$8d7403abedf7cefa$export$ce37e184d908d785("new-ratio")+": "+a[0]+":"+a[1];var h=t,c=e(t,i);t/=c,i/=c,i*=260,(t*=260)>260&&(i=260/t*i,t=260),i>100&&(t=100/i*t,i=100),R.style.width=t+"px",R.style.height=i+"px",L.style.backgroundSize=Math.round(Math.max(4,t/h*60))+"px"}$eWjiX.BB.el({parent:L,content:R,css:{display:"table-cell",verticalAlign:"middle"}}),$eWjiX.BB.el({parent:R,css:{display:"table-cell",verticalAlign:"middle"}}),d.onchange=function(){(""===d.value||0>parseInt(d.value))&&(d.value="1"),P()},d.onkeyup=function(){P()},g.onchange=function(){(""===g.value||0>parseFloat(g.value))&&(g.value="1"),P()},g.onkeyup=function(){P()},P(),u.append(x);var A=$eWjiX.BB.el({parent:u,css:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}});$eWjiX.BB.el({parent:A}).append(m,y),A.append(M.getElement()),u.append(L),$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("new-title")}</b>`,div:u,buttons:["Ok","Cancel"],callback:function(e){($eWjiX.BB.unsetEventHandler(d,"onclick","onchange","onkeyup"),$eWjiX.BB.unsetEventHandler(d,"onclick","onchange","onkeyup"),$eWjiX.BB.unsetEventHandler(k,"onclick"),$eWjiX.BB.unsetEventHandler(w,"onclick"),$eWjiX.BB.unsetEventHandler(E,"onclick"),$eWjiX.BB.unsetEventHandler(B,"onclick"),$eWjiX.BB.unsetEventHandler(S,"onclick"),$eWjiX.BB.unsetEventHandler(C,"onclick"),I.destroy(),M.destroy(),"Cancel"===e||0>=parseInt(d.value)||0>=parseInt(g.value)||isNaN(parseInt(d.value))||isNaN(parseInt(g.value)))?h():l(parseInt(d.value),parseInt(g.value),T)},clickOnEnter:"Ok"})}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$28683410117398a3$exports={};$28683410117398a3$exports=$parcel$resolve("b1UMP");var $9091fb5691a677d9$export$5b91f641162972fc=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.stateIsOpen=!0,this.orientation="right",this.rootEl=$eWjiX.BB.el({className:"kl-toolspace-toggle",css:{width:"36px",height:"36px",background:"rgba(100, 100, 100, 0.9)",color:"#fff",textAlign:"center",lineHeight:"36px",cursor:"pointer",userSelect:"none",padding:"6px",boxSizing:"border-box"},title:$8d7403abedf7cefa$export$ce37e184d908d785("toggle-show-tools"),onClick:function(e){e.preventDefault(),i.stateIsOpen=!i.stateIsOpen,i.update(),t.onChange()}}),this.icon=$eWjiX.BB.el({parent:this.rootEl,css:{backgroundImage:`url(${$parcel$interopDefault($28683410117398a3$exports)})`,width:"100%",height:"100%",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",userSelect:"none"}}),this.update(),this.rootEl.oncontextmenu=function(){return!1}}return(0,$7h4XF._)(e,[{key:"update",value:function(){"left"===this.orientation?this.icon.style.transform=this.stateIsOpen?"rotate(180deg)":"":this.icon.style.transform=this.stateIsOpen?"":"rotate(180deg)"}},{key:"isOpen",value:function(){return this.stateIsOpen}},{key:"setIsOpen",value:function(e){this.stateIsOpen=e,this.update()}},{key:"setOrientation",value:function(e){this.orientation=e,this.update()}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$7jh4K=parcelRequire("7jh4K"),$0c994c56e6434e84$export$5cdfb22682d2a5dd=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e);var n=function(){t.onUpdate(i.getValues())},r=[null,t.fill?(0,$4EWN2._)((0,$cL71g._)({},t.fill.color),{a:1}):null,(0,$4EWN2._)((0,$cL71g._)({},t.primaryColor),{a:1}),(0,$4EWN2._)((0,$cL71g._)({},t.secondaryColor),{a:1}),{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];this.colorOptions=new $4db8cbbb01889095$export$24ba9b81662d4366({colorArr:r,initialIndex:+!!t.fill,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-fill"),onChange:function(e){i.opacitySlider.getElement().style.display=null!==e?"":"none",n()}}),this.opacitySlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:150,height:30,min:.01,max:1,value:t.fill?t.fill.color.a:1,resolution:225,eventResMs:1e3/30,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e},onChange:function(){return n()}}),this.opacitySlider.getElement().style.display=t.fill?"":"none";var a=(0,$7jh4K.createSvg)({elementType:"svg",class:"dark-invert",width:"25px",height:"25px",viewBox:"0 0 30 30",childrenArr:[{elementType:"polyline",points:"0,0 30,0 30,8 19,8 19,30 11,30 11,8 0,8 0,0 1,0","transform-origin":"15px 15px",transform:"scale(0.8)",fill:"#000c"}]});this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-10,items-center,flexWrap,minh-30",[a,this.colorOptions.getElement(),this.opacitySlider.getElement()])}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getValues",value:function(){var e=this.colorOptions.getValue();return null===e||(null==e?void 0:e.a)===0?{fill:void 0}:{fill:{color:(0,$4EWN2._)((0,$cL71g._)({},e),{a:this.opacitySlider.getValue()})}}}},{key:"destroy",value:function(){this.colorOptions.destroy(),this.opacitySlider.destroy()}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$e4604b9a1ac0f4ee$exports={};$e4604b9a1ac0f4ee$exports=$parcel$resolve("lvwQ5");var $8ba3eefd70721d3b$exports={};$8ba3eefd70721d3b$exports=$parcel$resolve("imAvm");var $eb31f16926e61810$exports={};$eb31f16926e61810$exports=$parcel$resolve("dC0sF");var $5cf1958d54bfd5f4$exports={};$5cf1958d54bfd5f4$exports=$parcel$resolve("h3hPo");var $3b43acef7d252779$exports={};$3b43acef7d252779$exports=$parcel$resolve("1pAeY");var $8ef7ad4f80179365$exports={};$8ef7ad4f80179365$exports=$parcel$resolve("hapKl");var $e69f3582668abc99$exports={};$e69f3582668abc99$exports=$parcel$resolve("dqzux");var $cbca1f58563f9d40$exports={};$cbca1f58563f9d40$exports=$parcel$resolve("l7VGL");var $1ac64d6c82edfb95$exports={};$1ac64d6c82edfb95$exports=$parcel$resolve("dm0T7");var $fd0420aef18e587e$exports={};$fd0420aef18e587e$exports=$parcel$resolve("2U3dq");var $e776cdfd0b179eef$exports={};$e776cdfd0b179eef$exports=$parcel$resolve("axzlU");var $64c854750c49b505$exports={};$64c854750c49b505$exports=$parcel$resolve("avgh6");var $eddaaaf7f794edf8$exports={};$eddaaaf7f794edf8$exports=$parcel$resolve("H9bSu");var $39d6a48ea0add86d$exports={};$39d6a48ea0add86d$exports=$parcel$resolve("emBfm");var $e422de72b0c425e5$exports={};$e422de72b0c425e5$exports=$parcel$resolve("kjRvm");var $821093f4bf7188d6$exports={};$821093f4bf7188d6$exports=$parcel$resolve("c79R0");var $eadfb8deb432b851$exports={};$eadfb8deb432b851$exports=$parcel$resolve("fndWQ");var $aeae5535c3cfaf38$exports={};$aeae5535c3cfaf38$exports=$parcel$resolve("iAFmc");var $3746e82f71e0d2e4$exports={};$3746e82f71e0d2e4$exports=$parcel$resolve("2Bq6W");var $ddf5e76f74932ce0$exports={};$ddf5e76f74932ce0$exports=$parcel$resolve("hmfbp");var $73473d030b493ccd$exports={};$73473d030b493ccd$exports=$parcel$resolve("iItsG");var $4830416abb0c56c9$export$826128ff895ed268=[{name:"Caveat",url:$parcel$interopDefault($8ef7ad4f80179365$exports)},{name:"ClimateCrisis",url:$parcel$interopDefault($e69f3582668abc99$exports)},{name:"CorrectionBrush",url:$parcel$interopDefault($cbca1f58563f9d40$exports)},{name:"DancingScript",url:$parcel$interopDefault($1ac64d6c82edfb95$exports)},{name:"Diabolik",url:$parcel$interopDefault($fd0420aef18e587e$exports)},{name:"FreckleFace",url:$parcel$interopDefault($e776cdfd0b179eef$exports)},{name:"Gloock",url:$parcel$interopDefault($64c854750c49b505$exports)},{name:"GochiHand",url:$parcel$interopDefault($39d6a48ea0add86d$exports)},{name:"Pacha",url:$parcel$interopDefault($eddaaaf7f794edf8$exports)},{name:"PassionOne",url:$parcel$interopDefault($e422de72b0c425e5$exports)},{name:"PixeloidSans",url:$parcel$interopDefault($821093f4bf7188d6$exports)},{name:"PlaypenSans",url:$parcel$interopDefault($eadfb8deb432b851$exports)},{name:"Quicksand",url:$parcel$interopDefault($aeae5535c3cfaf38$exports)},{name:"Silkscreen",url:$parcel$interopDefault($3746e82f71e0d2e4$exports)},{name:"Tehroc",url:$parcel$interopDefault($ddf5e76f74932ce0$exports)},{name:"YUNGA",url:$parcel$interopDefault($73473d030b493ccd$exports)}],$d84067eeb22a523d$var$importedFonts=[{fontFamily:"sans-serif",fontName:"Sans-serif"},{fontFamily:"serif",fontName:"Serif"},{fontFamily:"monospace",fontName:"Monospace"},{fontFamily:"cursive",fontName:"Cursive"},{fontFamily:"fantasy",fontName:"Fantasy"}].concat((0,$bX4ja._)($4830416abb0c56c9$export$826128ff895ed268.map(function(e){return{fontFamily:e.name,fontName:e.name}}))),$d84067eeb22a523d$var$didLoadBundledFonts=!1;function $d84067eeb22a523d$var$loadBundledFonts(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:if($d84067eeb22a523d$var$didLoadBundledFonts)return[2];return $d84067eeb22a523d$var$didLoadBundledFonts=!0,[4,Promise.all($4830416abb0c56c9$export$826128ff895ed268.map(function(e){return(0,$1LaJZ._)(function(){var t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return[4,fetch(e.url)];case 1:return[4,n.sent().arrayBuffer()];case 2:return t=n.sent(),i=new FontFace(e.name,t),document.fonts.add(i),[2]}})})()}))];case 1:return e.sent(),[2]}})})()}var $d84067eeb22a523d$export$2e7faedafda1fc85=function(){"use strict";function e(t){var i,n,r=this;(0,$cx0mh._)(this,e),this.onUpdate=t.onUpdate,this.fontSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({initValue:t.font,optionArr:$d84067eeb22a523d$var$importedFonts.map(function(e){return[e.fontFamily,e.fontName,{css:{fontFamily:e.fontFamily,fontSize:"1.2em"}}]}),isFocusable:!0,css:{width:"180px"},onChange:function(e){r.loadBundledFonts(),t.onUpdate({font:e})},name:"font"}),this.onFocus=function(){return r.loadBundledFonts()},this.fontSelect.getElement().addEventListener("focus",this.onFocus),this.fontPointerListener=new $eWjiX.BB.PointerListener({target:this.fontSelect.getElement(),onWheel:function(e){return r.fontSelect.setDeltaValue(e.deltaY)}}),this.importButton=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("file-import"),onClick:function(){r.importFont()}});var a=$eWjiX.BB.el({content:[$eWjiX.BB.el({tagName:"span",content:"A",css:{fontSize:"0.6em"}}),"A"],css:{width:"25px",height:"25px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2em",userSelect:"none"}});this.sizeInput=new(0,$dJPtW.Input)({title:$8d7403abedf7cefa$export$ce37e184d908d785("text-size"),type:"number",min:0,max:1e3,init:t.size,onChange:function(e){t.onUpdate({size:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"70px"},name:"font-size"}),this.lineHeightInput=new(0,$dJPtW.Input)({label:$8d7403abedf7cefa$export$ce37e184d908d785("text-line-height"),type:"number",min:0,max:10,step:.1,init:null!=(i=t.lineHeight)?i:1,onChange:function(e){t.onUpdate({lineHeight:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"60px"},name:"line-height"}),this.letterSpacingInput=new(0,$dJPtW.Input)({label:$8d7403abedf7cefa$export$ce37e184d908d785("text-letter-spacing"),type:"number",min:-100,max:100,init:null!=(n=t.letterSpacing)?n:0,onChange:function(e){t.onUpdate({letterSpacing:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"60px"},name:"letter-spacing"}),this.alignRadioList=new $8cb981a3c9e5b15b$export$7cc1012a658e6ad8({optionArr:[{id:"left",title:$8d7403abedf7cefa$export$ce37e184d908d785("text-left"),image:$parcel$interopDefault($e4604b9a1ac0f4ee$exports),darkInvert:!0},{id:"center",title:$8d7403abedf7cefa$export$ce37e184d908d785("text-center"),image:$parcel$interopDefault($8ba3eefd70721d3b$exports),darkInvert:!0},{id:"right",title:$8d7403abedf7cefa$export$ce37e184d908d785("text-right"),image:$parcel$interopDefault($eb31f16926e61810$exports),darkInvert:!0}],initId:t.align,onChange:function(e){return t.onUpdate({align:e})}}),this.italicToggle=new $8fa94d142febb502$export$b6d053cded550773({image:$parcel$interopDefault($5cf1958d54bfd5f4$exports),title:$8d7403abedf7cefa$export$ce37e184d908d785("text-italic"),initValue:t.isItalic,onChange:function(e){return t.onUpdate({isItalic:e})},darkInvert:!0}),this.boldToggle=new $8fa94d142febb502$export$b6d053cded550773({image:$parcel$interopDefault($3b43acef7d252779$exports),title:$8d7403abedf7cefa$export$ce37e184d908d785("text-bold"),initValue:t.isBold,onChange:function(e){return t.onUpdate({isBold:e})},darkInvert:!0}),this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,flexWrap,gap-10-15,items-center",[$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-5,items-center",[a,this.sizeInput.getElement()]),$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-5",[this.fontSelect.getElement(),this.importButton]),$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-7",[this.alignRadioList.getElement(),this.italicToggle.getElement(),this.boldToggle.getElement()]),this.letterSpacingInput.getElement(),this.lineHeightInput.getElement()])}return(0,$7h4XF._)(e,[{key:"loadBundledFonts",value:function(){var e=this;$d84067eeb22a523d$var$didLoadBundledFonts||$d84067eeb22a523d$var$loadBundledFonts().then(function(){e.onUpdate({font:e.fontSelect.getValue()})})}},{key:"importFont",value:function(){var e=this,t=["ttf","otf","woff","woff2","eot"],i=document.createElement("input");i.type="file",i.multiple=!0,i.accept=t.map(function(e){return"."+e}).join(", "),i.focus(),i.click(),i.onchange=function(){return(0,$1LaJZ._)(function(){var e,n,r,a,s,o,l,h,c,u,d,p,f;return(0,$2gUX3.__generator)(this,function(g){switch(g.label){case 0:if(e=this,!i.files||0===i.files.length)return[2];n=void 0,r=[],a=!1,s=$d84067eeb22a523d$var$importedFonts.map(function(e){return e.fontFamily}),o=0,g.label=1;case 1:if(!(o<i.files.length))return[3,7];if(l=i.files[o],h="kl-"+$d84067eeb22a523d$var$importedFonts.length,s.includes(h))return[3,6];return n||(n=h,this.importButton.disabled=!0,this.importButton.innerText=$8d7403abedf7cefa$export$ce37e184d908d785("loading")),(c=l.name.split(".")).pop(),$d84067eeb22a523d$var$importedFonts.push({fontFamily:h,fontName:c.join(".")}),d=FontFace.bind,p=[void 0,h],[4,l.arrayBuffer()];case 2:u=new(d.apply(FontFace,p.concat([g.sent()]))),g.label=3;case 3:return g.trys.push([3,5,,6]),[4,u.load()];case 4:return g.sent(),document.fonts.add(u),a=!0,[3,6];case 5:return f=g.sent(),r.push(l.name),[3,6];case 6:return o++,[3,1];case 7:if(r.length>0&&$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("text-failed-import"),$075b9fd415bad4ff$export$db3b6bfb95261072("br"),r.join(", "),$075b9fd415bad4ff$export$db3b6bfb95261072("br"),$075b9fd415bad4ff$export$db3b6bfb95261072("br"),$8d7403abedf7cefa$export$ce37e184d908d785("text-supported-formats"),$075b9fd415bad4ff$export$db3b6bfb95261072("br"),t.join(", ")]}),type:"error"}),!a)return this.importButton.disabled=!1,this.importButton.innerText=$8d7403abedf7cefa$export$ce37e184d908d785("file-import"),[2];return setTimeout(function(){e.fontSelect.setOptionArr($d84067eeb22a523d$var$importedFonts.map(function(e){return[e.fontFamily,e.fontName,{css:{fontFamily:e.fontFamily,fontSize:"1.2em"}}]})),e.fontSelect.setValue(n),e.onUpdate({font:n}),e.importButton.disabled=!1,e.importButton.innerText=$8d7403abedf7cefa$export$ce37e184d908d785("file-import")}),[2]}})}).call(e)}}},{key:"getElement",value:function(){return this.rootEl}},{key:"getValues",value:function(){return{font:this.fontSelect.getValue(),size:+this.sizeInput.getValue(),letterSpacing:+this.letterSpacingInput.getValue(),lineHeight:+this.lineHeightInput.getValue(),align:this.alignRadioList.getValue(),isItalic:this.italicToggle.getValue(),isBold:this.boldToggle.getValue()}}},{key:"destroy",value:function(){this.fontPointerListener.destroy(),this.fontSelect.getElement().removeEventListener("focus",this.onFocus),this.fontSelect.destroy(),$eWjiX.BB.destroyEl(this.importButton),this.sizeInput.destroy(),this.lineHeightInput.destroy(),this.letterSpacingInput.destroy(),this.alignRadioList.destroy(),this.italicToggle.destroy(),this.boldToggle.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$1d4a3fd6cf6c0a9d$export$42bb0e3b48d549f6=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:{boxShadow:"0 0 0 1px #aaa"}});var n=function(){t.onUpdate(i.getValues())},r=[null,t.stroke?(0,$4EWN2._)((0,$cL71g._)({},t.stroke.color),{a:1}):null,(0,$4EWN2._)((0,$cL71g._)({},t.secondaryColor),{a:1}),(0,$4EWN2._)((0,$cL71g._)({},t.primaryColor),{a:1}),{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1}];this.colorOptions=new $4db8cbbb01889095$export$24ba9b81662d4366({colorArr:r,initialIndex:+!!t.stroke,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-stroke"),onChange:function(e){i.opacitySlider.getElement().style.display=null!==e?"":"none",i.lineWidthSlider.getElement().style.display=null!==e?"":"none",n()}}),this.opacitySlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:150,height:30,min:.01,max:1,value:t.stroke?t.stroke.color.a:1,resolution:225,eventResMs:1e3/30,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e},onChange:function(){return n()}}),this.lineWidthSlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-line-width"),width:150,height:30,min:.5,max:100,value:t.stroke?t.stroke.lineWidth:2,eventResMs:1e3/30,curve:"quadratic",onChange:function(){return n()}}),this.opacitySlider.getElement().style.display=t.stroke?"":"none",this.lineWidthSlider.getElement().style.display=t.stroke?"":"none";var a=(0,$7jh4K.createSvg)({elementType:"svg",class:"dark-invert",width:"25px",height:"25px",viewBox:"0 0 30 30",childrenArr:[{elementType:"polyline",points:"0,0 30,0 30,8 19,8 19,30 11,30 11,8 0,8 0,0 1,0",fill:"none",stroke:"#000c","stroke-width":"3","transform-origin":"15px 15px",transform:"scale(0.8)"}]});this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-10,items-center,flexWrap,minh-30",[a,this.colorOptions.getElement(),this.opacitySlider.getElement(),this.lineWidthSlider.getElement()])}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getValues",value:function(){var e=this.colorOptions.getValue();return null===e||(null==e?void 0:e.a)===0?{stroke:void 0}:{stroke:{color:(0,$4EWN2._)((0,$cL71g._)({},e),{a:this.opacitySlider.getValue()}),lineWidth:this.lineWidthSlider.getValue()}}}},{key:"destroy",value:function(){this.colorOptions.destroy(),this.opacitySlider.destroy(),this.lineWidthSlider.destroy()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$c85fd0de8751b6a0$export$c6656360602b35c2=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.onInput=function(){i.emit()},this.lastEmittedText=t.text,this.onUpdate=t.onUpdate,this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(""),this.textInput=$eWjiX.BB.el({tagName:"textarea",parent:this.rootEl,content:t.text,custom:{placeholder:$8d7403abedf7cefa$export$ce37e184d908d785("text-placeholder")},css:{whiteSpace:"pre",overflow:"auto",width:"100%",height:"70px",resize:"vertical"},onChange:function(){i.emit()}}),this.textInput.addEventListener("input",this.onInput)}return(0,$7h4XF._)(e,[{key:"emit",value:function(){var e=this.textInput.value;e!==this.lastEmittedText&&(this.lastEmittedText=e,this.onUpdate({text:e}))}},{key:"getElement",value:function(){return this.rootEl}},{key:"getValues",value:function(){return{text:this.textInput.value}}},{key:"focus",value:function(){this.textInput.focus()}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.textInput),this.textInput.removeEventListener("input",this.onInput)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$9b3eo=parcelRequire("9b3eo"),$5ffe4a6cd7b98bc8$export$1d311696e0fb2158=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.offset={x:0,y:0},this.zoomFac=0,this.scale=1,this.layerArr=[],this.onDarkChange=function(){i.checkerPattern=(0,$7jh4K.throwIfNull)(i.previewCtx.createPattern($eWjiX.BB.createCheckerCanvas(8,$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark()),"repeat")),i.render()},this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(),this.text=t.text,this.layerIndex=t.layerIndex;var n=t.klCanvas.getSelection();this.selectionPath=n?new Path2D((0,$9b3eo.getSelectionPath2d)(n)):void 0;var r=window.innerWidth<550,a=window.innerHeight<630;this.width=r?340:540,this.height=r?a?210:260:a?230:350,this.layerArr=t.klCanvas.getLayersFast(),this.textCanvas=$eWjiX.BB.canvas(t.klCanvas.getWidth(),t.klCanvas.getHeight()),this.textCtx=$eWjiX.BB.ctx(this.textCanvas),this.targetCanvas=$eWjiX.BB.canvas(this.width,this.height),this.targetCtx=$eWjiX.BB.ctx(this.targetCanvas),this.layersCanvas=$eWjiX.BB.canvas(this.width,this.height),this.layersCtx=$eWjiX.BB.ctx(this.layersCanvas),this.previewCanvas=$eWjiX.BB.canvas(this.width,this.height),this.previewCtx=$eWjiX.BB.ctx(this.previewCanvas),(0,$7jh4K.css)(this.previewCanvas,{display:"block"}),this.previewWrapper=$eWjiX.BB.el({parent:this.rootEl,css:{position:"relative",width:this.width+"px",cursor:"move",touchAction:"none"}}),$eWjiX.BB.el({parent:this.previewWrapper,className:"kl-text-preview-wrapper"}),this.previewWrapper.append(this.previewCanvas),this.checkerPattern=(0,$7jh4K.throwIfNull)(this.previewCtx.createPattern($eWjiX.BB.createCheckerCanvas(8,$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark()),"repeat")),this.emptyCanvas=$eWjiX.BB.canvas(1,1),this.emptyCanvasLight=$eWjiX.BB.canvas(1,1);var s=$eWjiX.BB.ctx(this.emptyCanvas);s.fillRect(0,0,1,1),(s=$eWjiX.BB.ctx(this.emptyCanvasLight)).fillStyle="#fff",s.fillRect(0,0,1,1),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.addIsDarkListener(this.onDarkChange),this.previewCanvas.oncontextmenu=function(e){return e.preventDefault()};var o=!1,l=!1,h=!1;this.previewPointerListener=new $eWjiX.BB.PointerListener({target:this.previewCanvas,onPointer:function(e){if("pointerdown"===e.type&&(o=!1,l=!0),"pointermove"===e.type&&l&&(o=!0),"pointerup"===e.type&&(l&&o&&"mouse"===e.pointerType&&t.onDragEnd(),o=!1,l=!1),"pointermove"===e.type&&"left"===e.button&&(e.eventPreventDefault(),i.offset={x:0,y:0},i.move(-e.dX,-e.dY)),"pointerdown"===e.type&&"right"===e.button&&document.body.append(i.eventCapture),"pointerup"===e.type&&setTimeout(function(){return i.eventCapture.remove()},20),"pointermove"===e.type&&"right"===e.button&&(h=!0,e.eventPreventDefault(),i.offset.x-=e.dX,i.offset.y-=e.dY,i.render()),"pointerup"===e.type&&h){var n=0;i.interval=setInterval(function(){n>8&&(clearInterval(i.interval),i.offset={x:0,y:0},i.render()),i.offset={x:.6*i.offset.x,y:.6*i.offset.y},i.render(),n++},10),i.offset={x:.6*i.offset.x,y:.6*i.offset.y},i.render()}},onWheel:function(e){i.changeZoomFac(-e.deltaY)}});var c=function(e){return e.preventDefault()};this.previewCanvas.addEventListener("wheel",c,{passive:!1}),this.rotationSlider=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-rotation"),width:150,height:30,min:-Math.PI,max:Math.PI,value:t.text.angleRad,resolution:225,toValue:function(e){return e*Math.PI/180},toDisplayValue:function(e){return e/Math.PI*180},onChange:function(){i.offset={x:0,y:0},i.render()},unit:""}),this.zoomInBtn=$eWjiX.BB.el({tagName:"button",content:`<img height="20" src="${$parcel$interopDefault($c88da6b7fdef67e7$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("zoom-in"),onClick:function(){return i.changeZoomFac(1)},css:{fontWeight:"bold"}}),this.zoomOutBtn=$eWjiX.BB.el({tagName:"button",content:`<img height="20" src="${$parcel$interopDefault($e503dd0072d83d49$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("zoom-out"),onClick:function(){return i.changeZoomFac(-1)},css:{fontWeight:"bold"}}),this.eventCapture=$eWjiX.BB.el({css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",zIndex:"999",cursor:"move"}}),this.eventCapture.oncontextmenu=function(e){return e.preventDefault()},this.keyListener=new $eWjiX.BB.KeyListener({onDown:function(e){if(!$eWjiX.BB.isInputFocused(!0)){var t=i.keyListener.isPressed("shift")?4:1;"left"===e&&i.move(-t,0),"right"===e&&i.move(t,0),"up"===e&&i.move(0,-t),"down"===e&&i.move(0,t)}}}),this.inputsRootEl=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-5",[this.rotationSlider.getElement(),$075b9fd415bad4ff$export$db3b6bfb95261072(),this.zoomInBtn,this.zoomOutBtn])}return(0,$7h4XF._)(e,[{key:"canZoom",value:function(e){return this.zoomFac!==Math.min(2,Math.max(-2,this.zoomFac+e))}},{key:"changeZoomFac",value:function(e){this.zoomFac=Math.min(2,Math.max(-2,this.zoomFac+e)),this.render(),this.zoomInBtn.disabled=!this.canZoom(1),this.zoomOutBtn.disabled=!this.canZoom(-1)}},{key:"move",value:function(e,t){var i=$eWjiX.BB.rotate(e,t,-this.rotationSlider.getValue()/Math.PI*180);this.text.x+=i.x/this.scale,this.text.y+=i.y/this.scale,this.render()}},{key:"render",value:function(){var e=this.rotationSlider.getValue();this.textCtx.clearRect(0,0,this.textCanvas.width,this.textCanvas.height);var t=$fdc12d72a3df9be9$export$482c90f94eb9717c(this.textCanvas,(0,$4EWN2._)((0,$cL71g._)({},this.text),{x:this.text.x,y:this.text.y,angleRad:this.rotationSlider.getValue()}),this.selectionPath);this.selectionPath&&(this.textCtx.save(),this.textCtx.setLineDash([4]),this.textCtx.strokeStyle="#000",this.textCtx.stroke(this.selectionPath),this.textCtx.lineDashOffset=4,this.textCtx.strokeStyle="#fff",this.textCtx.stroke(this.selectionPath),this.textCtx.restore());var i=$eWjiX.BB.Vec2.mul($eWjiX.BB.rotate(this.offset.x,this.offset.y,-e/Math.PI*180),1/this.scale);t.x-=3,t.y-=3,t.width+=6,t.height+=6;var n=$eWjiX.BB.rotate(t.x,t.y,-e/Math.PI*180),r=$eWjiX.BB.rotate(t.width,t.height,-e/Math.PI*180),a=this.text.x+n.x+r.x/2+i.x,s=this.text.y+n.y+r.y/2+i.y,o=100,l=$eWjiX.BB.fitInto(t.width,t.height,this.width-o,this.height-o);this.scale=Math.min(1,l.width/t.width),this.scale=Math.min(4,this.scale*Math.pow(2,this.zoomFac)),this.targetCtx.save(),this.scale>=4?this.targetCtx.imageSmoothingEnabled=!1:(this.targetCtx.imageSmoothingEnabled=!0,this.targetCtx.imageSmoothingQuality=this.scale>=1?"low":"medium"),this.targetCtx.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.targetCtx.translate(this.width/2,this.height/2),this.targetCtx.scale(this.scale,this.scale),this.targetCtx.rotate(e),this.targetCtx.drawImage(this.layerArr[this.layerIndex].canvas,-a,-s),this.targetCtx.drawImage(this.textCanvas,-a,-s),this.targetCtx.restore();var h=$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.isDark();this.layersCtx.save(),this.layersCtx.fillStyle=h?"rgb(33,33,33)":"rgb(158,158,158)",this.layersCtx.fillRect(0,0,this.width,this.height),this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(e),this.layersCtx.imageSmoothingEnabled=!1;var c=1/this.scale;this.layersCtx.globalAlpha=h?.25:.2,this.layersCtx.drawImage(h?this.emptyCanvasLight:this.emptyCanvas,-a-c,-s-c,this.textCanvas.width+2*c,this.textCanvas.height+2*c),this.layersCtx.globalAlpha=1,this.layersCtx.globalCompositeOperation="destination-out",this.layersCtx.drawImage(this.emptyCanvas,-a,-s,this.textCanvas.width,this.textCanvas.height),this.layersCtx.restore(),this.scale>=4?this.layersCtx.imageSmoothingEnabled=!1:(this.layersCtx.imageSmoothingEnabled=!0,this.layersCtx.imageSmoothingQuality=this.scale>=1?"low":"medium"),this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(e);for(var u=0;u<this.layerIndex;u++)this.layerArr[u].isVisible&&this.layerArr[u].opacity>0&&(this.layersCtx.globalAlpha=this.layerArr[u].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[u].mixModeStr,this.layersCtx.drawImage(this.layerArr[u].canvas,-a,-s));this.layersCtx.restore(),this.layersCtx.globalAlpha=!!this.layerArr[this.layerIndex].isVisible*this.layerArr[this.layerIndex].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[this.layerIndex].mixModeStr,this.layersCtx.drawImage(this.targetCanvas,0,0),this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(e);for(var d=this.layerIndex+1;d<this.layerArr.length;d++)this.layerArr[d].isVisible&&this.layerArr[d].opacity>0&&(this.layersCtx.globalAlpha=this.layerArr[d].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[d].mixModeStr,this.layersCtx.drawImage(this.layerArr[d].canvas,-a,-s));this.layersCtx.restore(),this.layersCtx.restore(),this.previewCtx.save(),this.previewCtx.fillStyle=this.checkerPattern,this.previewCtx.fillRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.previewCtx.drawImage(this.layersCanvas,0,0),this.previewCtx.restore(),this.previewCtx.save(),this.previewCtx.globalCompositeOperation="difference",this.previewCtx.strokeStyle="#fff",this.previewCtx.lineWidth=.5,this.previewCtx.translate(-this.offset.x,-this.offset.y),this.previewCtx.strokeRect(Math.round(this.width/2-t.width/2*this.scale)+.5,Math.round(this.height/2-t.height/2*this.scale)+.5,Math.round(t.width*this.scale),Math.round(t.height*this.scale)),this.previewCtx.restore()}},{key:"getElement",value:function(){return this.rootEl}},{key:"getInputsElement",value:function(){return this.inputsRootEl}},{key:"getValues",value:function(){return{x:this.text.x,y:this.text.y,angleRad:this.rotationSlider.getValue()}}},{key:"setText",value:function(e){var t=this.text.x,i=this.text.y,n=this.text.angleRad;this.text=(0,$4EWN2._)((0,$cL71g._)({},e),{x:t,y:i,angleRad:n}),this.render()}},{key:"setSize",value:function(e,t){e=Math.max(1,e),t=Math.max(1,t),(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.targetCanvas.width=this.width,this.targetCanvas.height=this.height,this.layersCanvas.width=this.width,this.layersCanvas.height=this.height,this.previewCanvas.width=this.width,this.previewCanvas.height=this.height,this.previewWrapper.style.width=this.width+"px",this.render())}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.rootEl),$eWjiX.BB.destroyEl(this.inputsRootEl),$eWjiX.BB.destroyEl(this.previewWrapper),clearInterval(this.interval),this.rotationSlider.destroy(),$eWjiX.BB.destroyEl(this.zoomInBtn),$eWjiX.BB.destroyEl(this.zoomOutBtn),this.eventCapture.remove(),this.previewPointerListener.destroy(),this.keyListener.destroy(),$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.removeIsDarkListener(this.onDarkChange)}}]),e}();function $7a7111f71abacc0a$export$e263e067d6140649(e){var t=$eWjiX.BB.el({}),i=$eWjiX.BB.copyObj(e.text),n=$eWjiX.BB.el({className:$5043c756765ef749$export$e114d13b1a258938}),r=new $5ffe4a6cd7b98bc8$export$1d311696e0fb2158({text:i,klCanvas:e.klCanvas,layerIndex:e.layerIndex,onDragEnd:function(){return"text"===u.getOpenedTabId()?c.focus():0}});function a(e){i=(0,$cL71g._)({},i,e),r.setText(i)}r.render();var s=new $d84067eeb22a523d$export$2e7faedafda1fc85((0,$4EWN2._)((0,$cL71g._)({},i),{onUpdate:function(e){a(e)}})),o=$eWjiX.BB.el({css:{display:"flex",gap:"10px",flexDirection:"column"}}),l=new $0c994c56e6434e84$export$5cdfb22682d2a5dd({fill:i.fill,primaryColor:e.primaryColor,secondaryColor:e.secondaryColor,onUpdate:function(e){a(e)}}),h=new $1d4a3fd6cf6c0a9d$export$42bb0e3b48d549f6({stroke:i.stroke,primaryColor:e.primaryColor,secondaryColor:e.secondaryColor,onUpdate:function(e){a(e)}}),c=new $c85fd0de8751b6a0$export$c6656360602b35c2({text:i.text,onUpdate:function(e){void 0!==e.text&&g.setIgnoreBackground(e.text.length>0),a(e)}}),u=new $d04d72b97d637d65$export$3c6d17ed0106bfb9({initialId:"text",height:40,tabArr:[{id:"text",label:$8d7403abedf7cefa$export$ce37e184d908d785("text-text"),onOpen:function(){c.getElement().style.display="",c.focus()},onClose:function(){c.getElement().style.display="none"}},{id:"font",label:$8d7403abedf7cefa$export$ce37e184d908d785("text-font"),onOpen:function(){s.getElement().style.display="flex"},onClose:function(){s.getElement().style.display="none"}},{id:"color",label:$8d7403abedf7cefa$export$ce37e184d908d785("text-color"),onOpen:function(){o.style.display="flex"},onClose:function(){o.style.display="none"}}]});u.getElement().classList.add($5043c756765ef749$export$62d58b1c91e8e902),t.append($075b9fd415bad4ff$export$db3b6bfb95261072("",[$075b9fd415bad4ff$export$db3b6bfb95261072(n,[r.getElement()]),$075b9fd415bad4ff$export$db3b6bfb95261072("."+$5043c756765ef749$export$ee483a02838ec162,[r.getInputsElement()]),$075b9fd415bad4ff$export$db3b6bfb95261072(".tabrow."+$5043c756765ef749$export$84aa927130f1a919,[$075b9fd415bad4ff$export$db3b6bfb95261072(",w-240,h-40"),u.getElement()]),$075b9fd415bad4ff$export$db3b6bfb95261072("."+$5043c756765ef749$export$7b388ca536128c6d,[$075b9fd415bad4ff$export$db3b6bfb95261072(o,[l.getElement(),h.getElement()]),s.getElement(),c.getElement()])]));var d=function(){var e=n.getBoundingClientRect(),t=Math.ceil(e.width),i=Math.ceil(e.height);r.setSize(t,i)};function p(){window.scrollTo(0,0)}window.addEventListener("resize",d),setTimeout(function(){d()}),setTimeout(function(){c.focus()},100),window.addEventListener("scroll",p,{passive:!1});var f=function(t){window.removeEventListener("resize",d),window.removeEventListener("scroll",p),r.destroy(),s.destroy(),l.destroy(),h.destroy(),c.destroy(),u.destroy(),"Ok"===t&&e.onConfirm((0,$cL71g._)({},r.getValues(),s.getValues(),l.getValues(),h.getValues(),c.getValues()))},g=$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("text-title")}</b>`,div:t,buttons:["Ok","Cancel"],ignoreBackground:e.text.text.length>0,callback:f,style:{width:"calc(100% - 50px)",maxWidth:"1000px",minWidth:"300px",boxSizing:"border-box"},clickOnEnter:"Ok"})}$5043c756765ef749$export$7b388ca536128c6d="_5vlQAW_inputs",$5043c756765ef749$export$62d58b1c91e8e902="_5vlQAW_tab",$5043c756765ef749$export$84aa927130f1a919="_5vlQAW_tabWrapper",$5043c756765ef749$export$ee483a02838ec162="_5vlQAW_viewportInputs",$5043c756765ef749$export$e114d13b1a258938="_5vlQAW_viewportWrapper";var $eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");function $c8d2eb7d799b314c$export$1bf16d9bd59fd8f9(e){var t,i,n=$eWjiX.BB.el(),r=window.innerWidth<550||window.innerHeight<550,a=r?{}:{width:"540px"},s=$eWjiX.BB.el({css:{marginTop:"10px",textAlign:"center",color:"#888",lineHeight:"20px"}}),o=new $01fcd0ed15aa4018$export$40175a5948a88a57({width:r?340:540,height:r?300:400,canvas:e.image.canvas,enableRightClickCopy:!1,onChange:function(e,t){s&&l(e,t)}});function l(t,i){var n=$eWjiX.BB.fitInto(t,i,e.maxSize,e.maxSize);n.width<t?(s.innerHTML=`<span class="kl-text-error">${t} X ${i}</span> \u{27F6} ${Math.round(n.width)} X ${Math.round(n.height)}`,s.title=$8d7403abedf7cefa$export$ce37e184d908d785("import-too-large")):(s.innerHTML=`${t} X ${i}`,s.title="")}(0,$7jh4K.css)(o.getElement(),{marginLeft:"-20px"}),o.getElement().title=$8d7403abedf7cefa$export$ce37e184d908d785("crop-drag-to-crop"),n.append(o.getElement(),s),l(e.image.width,e.image.height);var h=!1;function c(e){for(var t=[],i={mask:"Masks not supported. Mask was applied.",clipping:"Clipping not supported. Clipping layers were merged.",group:"Groups not supported. Layers were ungrouped.",adjustment:"Adjustment layers not supported.","layer-effect":"Layer effects not supported.","smart-object":"Smart objects not supported.","blend-mode":"Unsupported layer blend mode.","bits-per-channel":"Unsupported color depth. Only 8bit per channel supported."},n=0;n<e.length;n++)t.push("- "+i[e[n]]);alert(t.join("\n"))}if("psd"===e.image.type)if(e.image.layers){if(t=new $365a915dfb503274$export$48513f6b9f8ce62d({init:h,label:$8d7403abedf7cefa$export$ce37e184d908d785("import-flatten"),callback:function(e){h=e},name:"flatten-image"}),n.append(t.getElement()),e.image.warningArr){var u=$eWjiX.BB.el({className:"kl-import-note",content:$8d7403abedf7cefa$export$ce37e184d908d785("import-psd-limited-support")}),d=e.image.warningArr;i=$eWjiX.BB.el({parent:u,tagName:"a",content:"Details",css:{marginLeft:"5px"},onClick:function(){return c(d)}}),n.append(u)}}else{var p=$eWjiX.BB.el({className:"kl-import-note",content:$8d7403abedf7cefa$export$ce37e184d908d785("import-psd-unsupported")});n.append(p)}function f(n){var r=o.getCroppedCanvas(),a=o.getCropRect(),s=e.image.width!==a.width||e.image.height!==a.height;o.destroy(),$eWjiX.BB.destroyEl(i),t&&t.destroy(),n===$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-layer")?(e.callback({type:"as-layer",image:s?r:e.image.canvas}),s||$eWjiX.BB.freeCanvas(r)):n===$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-image")?"psd"===e.image.type?(h&&delete e.image.layers,e.callback({type:"as-image-psd",image:e.image,cropObj:a}),$eWjiX.BB.freeCanvas(r)):"image"===e.image.type&&e.callback({type:"as-image",image:r}):(e.callback({type:"cancel"}),$eWjiX.BB.freeCanvas(r))}$c902829f68f42bce$export$d7e8d4d4450c819c({target:e.target,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("import-title")}</b>`,div:n,style:a,buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-layer"),$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-image"),"Cancel"],primaries:[$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-layer"),$8d7403abedf7cefa$export$ce37e184d908d785("import-btn-as-image")],callback:f,autoFocus:"As Image"})}var $4c230b0de5e1a470$exports={};$parcel$export($4c230b0de5e1a470$exports,"blendPsdToKl",function(){return $4c230b0de5e1a470$export$6df36f0c42d2440f}),$parcel$export($4c230b0de5e1a470$exports,"blendKlToPsd",function(){return $4c230b0de5e1a470$export$4e3b1f7d3ad623b4}),$parcel$export($4c230b0de5e1a470$exports,"readPsd",function(){return $4c230b0de5e1a470$export$3d649861c4b13fa2}),$parcel$export($4c230b0de5e1a470$exports,"klPsdToKlProject",function(){return $4c230b0de5e1a470$export$56493bf279c387b3});var $eelgW=parcelRequire("eelgW"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");function $4c230b0de5e1a470$var$init(){$4c230b0de5e1a470$var$kl2PsdMap||($4c230b0de5e1a470$var$psd2KlMap=Object.fromEntries(Object.entries($4c230b0de5e1a470$var$kl2PsdMap={"source-over":"normal",darken:"darken",multiply:"multiply","color-burn":"color burn",lighten:"lighten",screen:"screen","color-dodge":"color dodge",overlay:"overlay","soft-light":"soft light","hard-light":"hard light",difference:"difference",exclusion:"exclusion",hue:"hue",saturation:"saturation",color:"color",luminosity:"luminosity"}).map(function(e){return e.reverse()})))}function $4c230b0de5e1a470$export$6df36f0c42d2440f(e){return $4c230b0de5e1a470$var$init(),$4c230b0de5e1a470$var$psd2KlMap[e]}function $4c230b0de5e1a470$export$4e3b1f7d3ad623b4(e){return $4c230b0de5e1a470$var$init(),$4c230b0de5e1a470$var$kl2PsdMap[e]}function $4c230b0de5e1a470$export$3d649861c4b13fa2(e){if(!e.canvas)throw Error("psdObj.canvas undefined");var t,i={type:"psd",canvas:e.canvas,width:e.width,height:e.height};function n(e){i.warningArr||(i.warningArr=[]),i.warningArr.includes(e)||i.warningArr.push(e)}function r(e){var t=$4c230b0de5e1a470$export$6df36f0c42d2440f(e);return t||(n("blend-mode"),t="source-over"),t}if(8!==e.bitsPerChannel&&n("bits-per-channel"),!e.children)return i.error=!0,i;var a=$0621fc8724f6bfac$export$9f4f73b1bd7c2f26;function s(e){var t=0;if(e.blendMode){var i=$4c230b0de5e1a470$export$6df36f0c42d2440f(e.blendMode);if(i&&"source-over"!==i)return 1}if(e.children)for(var r=0;r<e.children.length;r++){var a=e.children[r];!a.clipping&&!a.adjustment&&(a.children?(n("group"),t+=s(a)):t++)}return t}if((t=0+s(e))>a)return i.error=!0,i;function o(e,t){var i=$eWjiX.BB.ctx(e),n=i.getImageData(0,0,e.width,e.height);if(0===t)for(var r=0;r<n.data.length;r+=4)n.data[r+3]=n.data[r];else for(var a=0;a<n.data.length;a+=4)n.data[a+3]=255-n.data[a];i.putImageData(n,0,0)}function l(e){var t,a,s=[],h=!e.hidden,c=(0,$7jh4K.throwIfUndefined)(e.opacity,"groupOpacity is undefined"),u=r(e.blendMode);if("source-over"!==u&&(t=(0,$eelgW.createCanvas)(i.width,i.height),a=$eWjiX.BB.ctx(t)),e.mask&&(n("mask"),o(e.mask.canvas,e.mask.defaultColor)),e.children)for(var d=0;d<e.children.length;d++){var p=e.children[d];if(!p.clipping){if(p.adjustment){n("adjustment");continue}var f=(p.children||p.canvas)&&e.children[d+1]&&e.children[d+1].clipping;if(f&&n("clipping"),p.children){for(var g=l(p),v=0;v<g.length;v++){var m=g[v],y=$eWjiX.BB.ctx(m.image);if(f){var x=(0,$eelgW.createCanvas)(i.width,i.height),b=$eWjiX.BB.ctx(x);b.drawImage(m.image,0,0);for(var w=d+1;w<e.children.length&&e.children[w].clipping;w++){var k=e.children[w];if(0!==k.opacity&&!k.hidden){if(void 0===k.blendMode)throw Error("clippingItem.blendMode undefined");if(void 0===k.opacity)throw Error("clippingItem.opacity undefined");if(void 0===k.canvas)throw Error("clippingItem.canvas undefined");if(void 0===k.left)throw Error("clippingItem.left undefined");if(void 0===k.top)throw Error("clippingItem.top undefined");b.globalCompositeOperation=r(k.blendMode),b.globalAlpha=k.opacity,b.drawImage(k.canvas,k.left,k.top)}}y.globalCompositeOperation="source-atop",y.drawImage(x,0,0)}if(e.mask){if(y.globalCompositeOperation=0===e.mask.defaultColor?"destination-in":"destination-out",void 0===e.mask.canvas)throw Error("psdGroupObj.mask.canvas undefined");if(void 0===e.mask.left)throw Error("psdGroupObj.mask.left undefined");if(void 0===e.mask.top)throw Error("psdGroupObj.mask.top undefined");y.drawImage(e.mask.canvas,e.mask.left,e.mask.top)}if(t){if(void 0===a)throw Error("groupCtx undefined");a.globalCompositeOperation=m.mixModeStr,a.globalAlpha=m.opacity,a.drawImage(m.image,0,0)}else m.opacity=m.opacity*c,s.push(m)}continue}var B=(0,$eelgW.createCanvas)(i.width,i.height),S=$eWjiX.BB.ctx(B);if(p.canvas){if(void 0===p.top)throw Error("item.top undefined");if(void 0===p.left)throw Error("item.left undefined");S.drawImage(p.canvas,p.left,p.top)}if(p.effects&&n("layer-effect"),p.mask){if(n("mask"),void 0===p.mask.canvas)throw Error("item.mask.canvas undefined");if(void 0===p.mask.defaultColor)throw Error("item.mask.defaultColor undefined");if(void 0===p.mask.left)throw Error("item.mask.left undefined");if(void 0===p.mask.top)throw Error("item.mask.top undefined");o(p.mask.canvas,p.mask.defaultColor),S.globalCompositeOperation=0===p.mask.defaultColor?"destination-in":"destination-out",S.drawImage(p.mask.canvas,p.mask.left,p.mask.top)}if(f){if(void 0===p.right)throw Error("item.right undefined");if(void 0===p.left)throw Error("item.left undefined");if(void 0===p.bottom)throw Error("item.bottom undefined");if(void 0===p.top)throw Error("item.top undefined");if(void 0===p.canvas)throw Error("item.canvas undefined");var C=(0,$eelgW.createCanvas)(p.right-p.left,p.bottom-p.top),E=$eWjiX.BB.ctx(C);E.drawImage(p.canvas,0,0);for(var _=d+1;_<e.children.length&&e.children[_].clipping;_++){var I=e.children[_];if(0!==I.opacity&&!I.hidden){if(void 0===I.blendMode)throw Error("clippingItem.blendMode undefined");if(void 0===I.opacity)throw Error("clippingItem.opacity undefined");if(void 0===I.canvas)throw Error("clippingItem.canvas undefined");if(void 0===I.left)throw Error("clippingItem.left undefined");if(void 0===I.top)throw Error("clippingItem.top undefined");E.globalCompositeOperation=r(I.blendMode),E.globalAlpha=I.opacity,E.drawImage(I.canvas,I.left-p.left,I.top-p.top)}}S.globalCompositeOperation="source-atop",S.drawImage(C,p.left,p.top)}if(e.mask){if(S.globalCompositeOperation=0===e.mask.defaultColor?"destination-in":"destination-out",void 0===e.mask.canvas)throw Error("psdGroupObj.mask.canvas undefined");if(void 0===e.mask.left)throw Error("psdGroupObj.mask.left undefined");if(void 0===e.mask.top)throw Error("psdGroupObj.mask.top undefined");S.drawImage(e.mask.canvas,e.mask.left,e.mask.top)}if(void 0===p.blendMode)throw Error("item.blendMode undefined");if(void 0===p.hidden)throw Error("item.hidden  undefined");if(void 0===p.opacity)throw Error("item.opacity undefined");if(t&&a)c>0&&(a.globalCompositeOperation=r(p.blendMode),a.globalAlpha=p.hidden?0:p.opacity,a.drawImage(B,0,0));else{if(void 0===p.name)throw Error("item.name undefined");s.push({name:p.name,isVisible:!p.hidden&&h,opacity:p.opacity*c,mixModeStr:r(p.blendMode),image:B})}}}if(t){if(void 0===e.name)throw Error("psdGroupObj.name undefined");s=[{name:e.name,isVisible:h,opacity:c,mixModeStr:u,image:t}]}return s}return i.layers=[],i.layers=l({name:"root",opacity:1,blendMode:"normal",children:e.children}),i}function $4c230b0de5e1a470$export$56493bf279c387b3(e){var t={projectId:(0,$7jh4K.randomUuid)(),width:e.width,height:e.height,layers:[]};return e.layers?t.layers=e.layers.map(function(e){return{name:e.name,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr,image:e.image}}):t.layers=[{name:$8d7403abedf7cefa$export$ce37e184d908d785("background"),isVisible:!0,opacity:1,mixModeStr:"source-over",image:e.canvas}],t}var $265ee43f4530dfdd$exports={};$265ee43f4530dfdd$exports=$parcel$resolve("5tPq3");var $46f219e0a1cc1280$exports={};$46f219e0a1cc1280$exports=$parcel$resolve("245NA");var $315a989e9c802914$exports={};$315a989e9c802914$exports=$parcel$resolve("1hkCG");var $8a7fd2e695a7a526$exports={};$8a7fd2e695a7a526$exports=$parcel$resolve("k2eFf");var $59220e55090c6477$exports={};$59220e55090c6477$exports=$parcel$resolve("krKGd");var $f2352131ea231846$exports={};$f2352131ea231846$exports=$parcel$resolve("ehfxY");var $5bdc34b3a28d8c4f$exports={};$5bdc34b3a28d8c4f$exports=$parcel$resolve("beOjS");var $5e7602aa944597cf$exports={};$5e7602aa944597cf$exports=$parcel$resolve("Gk9bV");var $f1177b20ba8f372a$exports={};$f1177b20ba8f372a$exports=$parcel$resolve("csed7");var $58b7d5e146b5b789$exports={};$58b7d5e146b5b789$exports=$parcel$resolve("equSE");var $57af312447b22316$exports={};$57af312447b22316$exports=$parcel$resolve("h1dN3");var $112696c449310458$exports={};$112696c449310458$exports=$parcel$resolve("LfAXI");var $2ceb6fbc21a0912d$exports={};$2ceb6fbc21a0912d$exports=$parcel$resolve("cB6q6");var $7c1d057215a9f0a8$exports={};$7c1d057215a9f0a8$exports=$parcel$resolve("S9ano");var $54abf2b24b46f3e1$exports={};$54abf2b24b46f3e1$exports=$parcel$resolve("4eqRj");var $e679ececcabe94c9$exports={};$e679ececcabe94c9$exports=$parcel$resolve("8mvSV");var $524973ee3882f42f$exports={};$524973ee3882f42f$exports=$parcel$resolve("kbc0v");var $805be15a1e91c0ee$export$24724bc1f91cba3={isLoaded:!1},$805be15a1e91c0ee$export$bac24f240bb7727d={brightnessContrast:{lang:{name:"filter-bright-contrast-title",button:"filter-bright-contrast",description:"filter-bright-contrast-description"},icon:$parcel$interopDefault($265ee43f4530dfdd$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},cropExtend:{lang:{name:"filter-crop-title",button:"filter-crop-extend",description:"filter-crop-description"},icon:$parcel$interopDefault($96cbdba315fc6e81$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},curves:{lang:{name:"filter-curves-title",button:"filter-curves",description:"filter-curves-description"},icon:$parcel$interopDefault($46f219e0a1cc1280$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},distort:{lang:{name:"filter-distort",button:"filter-distort",description:"filter-distort-description"},icon:$parcel$interopDefault($524973ee3882f42f$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},flip:{lang:{name:"filter-flip-title",button:"filter-flip",description:"filter-flip-description"},icon:$parcel$interopDefault($315a989e9c802914$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},hueSaturation:{lang:{name:"filter-hue-sat-title",button:"filter-hue-sat",description:"filter-hue-sat-description"},icon:$parcel$interopDefault($8a7fd2e695a7a526$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},invert:{lang:{name:"filter-invert",button:"filter-invert"},icon:$parcel$interopDefault($59220e55090c6477$exports),updatePos:!1,isInstant:!0,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},perspective:{lang:{name:"filter-perspective-title",button:"filter-perspective",description:"filter-perspective-description"},icon:$parcel$interopDefault($f2352131ea231846$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},resize:{lang:{name:"filter-resize-title",button:"filter-resize",description:"filter-resize-description"},icon:$parcel$interopDefault($5bdc34b3a28d8c4f$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},rotate:{lang:{name:"filter-rotate-title",button:"filter-rotate",description:"filter-rotate-description"},icon:$parcel$interopDefault($4acb6b8f0d0d377a$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},tiltShift:{lang:{name:"filter-tilt-shift-title",button:"filter-tilt-shift",description:"filter-tilt-shift-description"},icon:$parcel$interopDefault($5e7602aa944597cf$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},toAlpha:{lang:{name:"filter-to-alpha-title",button:"filter-to-alpha",description:"filter-to-alpha-description"},icon:$parcel$interopDefault($f1177b20ba8f372a$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},transform:{lang:{name:"filter-transform-title",button:"filter-transform",description:"filter-transform-description"},icon:$parcel$interopDefault($58b7d5e146b5b789$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},blur:{lang:{name:"filter-triangle-blur-title",button:"filter-triangle-blur",description:"filter-triangle-blur-description"},icon:$parcel$interopDefault($57af312447b22316$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},unsharpMask:{lang:{name:"filter-unsharp-mask-title",button:"filter-unsharp-mask",description:"filter-unsharp-mask-description"},icon:$parcel$interopDefault($112696c449310458$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},grid:{lang:{name:"filter-grid",button:"filter-grid",description:"filter-grid-description"},icon:$parcel$interopDefault($2ceb6fbc21a0912d$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},noise:{lang:{name:"filter-noise",button:"filter-noise",description:"filter-noise-description"},icon:$parcel$interopDefault($7c1d057215a9f0a8$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},pattern:{lang:{name:"filter-pattern",button:"filter-pattern",description:"filter-pattern-description"},icon:$parcel$interopDefault($54abf2b24b46f3e1$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},vanishPoint:{lang:{name:"filter-vanish-point-title",button:"filter-vanish-point",description:"filter-vanish-point-description"},icon:$parcel$interopDefault($e679ececcabe94c9$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0}},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$dfc47a34ad9bc378$var$myModule={},$dfc47a34ad9bc378$var$Grad=function(){"use strict";function e(t,i,n){(0,$cx0mh._)(this,e),this.x=t,this.y=i,this.z=n}return(0,$7h4XF._)(e,[{key:"dot2",value:function(e,t){return this.x*e+this.y*t}}]),e}(),$dfc47a34ad9bc378$var$grad3=[new $dfc47a34ad9bc378$var$Grad(1,1,0),new $dfc47a34ad9bc378$var$Grad(-1,1,0),new $dfc47a34ad9bc378$var$Grad(1,-1,0),new $dfc47a34ad9bc378$var$Grad(-1,-1,0),new $dfc47a34ad9bc378$var$Grad(1,0,1),new $dfc47a34ad9bc378$var$Grad(-1,0,1),new $dfc47a34ad9bc378$var$Grad(1,0,-1),new $dfc47a34ad9bc378$var$Grad(-1,0,-1),new $dfc47a34ad9bc378$var$Grad(0,1,1),new $dfc47a34ad9bc378$var$Grad(0,-1,1),new $dfc47a34ad9bc378$var$Grad(0,1,-1),new $dfc47a34ad9bc378$var$Grad(0,-1,-1)],$dfc47a34ad9bc378$var$p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],$dfc47a34ad9bc378$var$perm=Array(512),$dfc47a34ad9bc378$var$gradP=Array(512);$dfc47a34ad9bc378$var$myModule.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var i=void 0;i=1&t?$dfc47a34ad9bc378$var$p[t]^255&e:$dfc47a34ad9bc378$var$p[t]^e>>8&255,$dfc47a34ad9bc378$var$perm[t]=$dfc47a34ad9bc378$var$perm[t+256]=i,$dfc47a34ad9bc378$var$gradP[t]=$dfc47a34ad9bc378$var$gradP[t+256]=$dfc47a34ad9bc378$var$grad3[i%12]}},$dfc47a34ad9bc378$var$myModule.seed(0);var $dfc47a34ad9bc378$var$F2=.5*(Math.sqrt(3)-1),$dfc47a34ad9bc378$var$G2=(3-Math.sqrt(3))/6;$dfc47a34ad9bc378$var$myModule.simplex2=function(e,t){var i,n,r,a,s,o=(e+t)*$dfc47a34ad9bc378$var$F2,l=Math.floor(e+o),h=Math.floor(t+o),c=(l+h)*$dfc47a34ad9bc378$var$G2,u=e-l+c,d=t-h+c;u>d?(a=1,s=0):(a=0,s=1);var p=u-a+$dfc47a34ad9bc378$var$G2,f=d-s+$dfc47a34ad9bc378$var$G2,g=u-1+2*$dfc47a34ad9bc378$var$G2,v=d-1+2*$dfc47a34ad9bc378$var$G2,m=$dfc47a34ad9bc378$var$gradP[(l&=255)+$dfc47a34ad9bc378$var$perm[h&=255]],y=$dfc47a34ad9bc378$var$gradP[l+a+$dfc47a34ad9bc378$var$perm[h+s]],x=$dfc47a34ad9bc378$var$gradP[l+1+$dfc47a34ad9bc378$var$perm[h+1]],b=.5-u*u-d*d;b<0?i=0:(b*=b,i=b*b*m.dot2(u,d));var w=.5-p*p-f*f;w<0?n=0:(w*=w,n=w*w*y.dot2(p,f));var k=.5-g*g-v*v;return k<0?r=0:(k*=k,r=k*k*x.dot2(g,v)),70*(i+n+r)};var $dfc47a34ad9bc378$export$d3022aad56692482=$dfc47a34ad9bc378$var$myModule;function $f875015ce1aeb4d3$export$74a44bbc21d06a28(e){for(var t=e/500,i=e,n=$eWjiX.BB.canvas(e,i),r=$eWjiX.BB.ctx(n),a=r.createImageData(e,i),s=0;s<e;s++)for(var o=0;o<i;o++){var l=(o*e+s)*4,h=t+.04*$dfc47a34ad9bc378$export$d3022aad56692482.simplex2(s/50/t,o/50/t),c=100+($dfc47a34ad9bc378$export$d3022aad56692482.simplex2(s/50/h,o/50/h)+1)/2*100;c-=($dfc47a34ad9bc378$export$d3022aad56692482.simplex2(s/10/t,o/10/t)+1)/2*100;var u=$eWjiX.BB.dist(e/2,i/2,s,o);c*=$eWjiX.BB.clamp(1-((u-e/2.5)/(e/14)+$dfc47a34ad9bc378$export$d3022aad56692482.simplex2(s/22/h,o/22/h)),0,1)*(2*$eWjiX.BB.clamp(1-u/e,0,1)),a.data[l]=0,a.data[l+1]=0,a.data[l+2]=0,a.data[l+3]=$eWjiX.BB.clamp(c,0,255)}return r.putImageData(a,0,0),n}function $f875015ce1aeb4d3$var$udSegment(e,t,i){var n=$eWjiX.BB.Vec2.sub(i,t),r=$eWjiX.BB.Vec2.sub(e,t),a=$eWjiX.BB.clamp($eWjiX.BB.Vec2.dot(r,n)/$eWjiX.BB.Vec2.dot(n,n),0,1);return $eWjiX.BB.Vec2.len($eWjiX.BB.Vec2.sub(r,$eWjiX.BB.Vec2.mul(n,a)))}function $f875015ce1aeb4d3$export$eaa218d5d17c8f1c(e){var t,i;t=2/3*(1/4),i=1/3*(1/4);for(var n={x:1/4*e,y:e-1/4*e},r={x:e-1/4*e,y:1/4*e},a=e,s=$eWjiX.BB.canvas(e,a),o=$eWjiX.BB.ctx(s),l=o.createImageData(e,a),h=0;h<e;h++)for(var c=0;c<a;c++){var u=(c*e+h)*4,d=$f875015ce1aeb4d3$var$udSegment({x:h,y:c},n,r);d=$eWjiX.BB.clamp(255-(d-e*t)/(e*i)*255,0,255),l.data[u]=0,l.data[u+1]=0,l.data[u+2]=0,l.data[u+3]=d}return o.putImageData(l,0,0),s}var $ff6c1f784f50f5d5$export$67a3081d7cc6182d=[];$ff6c1f784f50f5d5$export$67a3081d7cc6182d[1]=$f875015ce1aeb4d3$export$74a44bbc21d06a28(128),$ff6c1f784f50f5d5$export$67a3081d7cc6182d[2]=$f875015ce1aeb4d3$export$eaa218d5d17c8f1c(128);var $8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja");function $5bc59effccf14376$export$263fa670dc037098(e,t){var i=e.activeLayerId;return{layerMap:Object.fromEntries(Object.entries(e.layerMap).map(function(e){var n=(0,$8N5YG._)(e,2),r=n[0];return(n[1],r===i)?[r,{tiles:t instanceof HTMLCanvasElement?$1a6c9997bc8182ff$export$7b1ba44282f9a519(t):(0,$bX4ja._)(t)}]:[r,{}]}))}}var $9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$3f0923cd3c55ea92$var$ALPHA_CIRCLE=0,$3f0923cd3c55ea92$var$ALPHA_CHALK=1,$3f0923cd3c55ea92$var$ALPHA_CAL=2,$3f0923cd3c55ea92$var$ALPHA_SQUARE=3,$3f0923cd3c55ea92$var$TWO_PI=2*Math.PI,$3f0923cd3c55ea92$export$6f96c8f9e6ae7341=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.context={},this.klHistory={},this.settingHasOpacityPressure=!1,this.settingHasScatterPressure=!1,this.settingHasSizePressure=!0,this.settingSize=2,this.settingSpacing=.8489,this.settingOpacity=1,this.settingScatter=0,this.settingColor={},this.settingColorStr="",this.settingAlphaId=$3f0923cd3c55ea92$var$ALPHA_CIRCLE,this.settingLockLayerAlpha=!1,this.hasDrawnDot=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.inputArr=[],this.inputIsDrawing=!1,this.bezierLine=null,this.alphaCanvas128=$eWjiX.BB.canvas(128,128),this.alphaCanvas64=$eWjiX.BB.canvas(64,64),this.alphaCanvas32=$eWjiX.BB.canvas(32,32),this.alphaOpacityArr=[1,.9,1,1],this.changedTiles=[]}return(0,$7h4XF._)(e,[{key:"updateChangedTiles",value:function(e){var t=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);t&&(this.changedTiles=$3798530d3967d87a$export$1774f90c6da5013c(this.changedTiles,$3798530d3967d87a$export$2098fe43203ddd32(t,this.context.canvas.width,this.context.canvas.height)))}},{key:"updateAlphaCanvas",value:function(){if(this.settingAlphaId!==$3f0923cd3c55ea92$var$ALPHA_CIRCLE&&this.settingAlphaId!==$3f0923cd3c55ea92$var$ALPHA_SQUARE)for(var e,t=[[this.alphaCanvas128,128],[this.alphaCanvas64,64],[this.alphaCanvas32,32]],i=0;i<t.length;i++)(e=$eWjiX.BB.ctx(t[i][0])).save(),e.clearRect(0,0,t[i][1],t[i][1]),e.fillStyle="rgba("+this.settingColor.r+", "+this.settingColor.g+", "+this.settingColor.b+", "+this.alphaOpacityArr[this.settingAlphaId]+")",e.fillRect(0,0,t[i][1],t[i][1]),e.globalCompositeOperation="destination-in",e.imageSmoothingQuality="high",e.drawImage($ff6c1f784f50f5d5$export$67a3081d7cc6182d[this.settingAlphaId],0,0,t[i][1],t[i][1]),e.restore()}},{key:"calcOpacity",value:function(e){return this.settingOpacity*(this.settingHasOpacityPressure?e*e:1)}},{key:"calcScatter",value:function(e){return this.settingScatter*this.settingSize*(this.settingHasScatterPressure?e:1)}},{key:"drawDot",value:function(e,t,i,n,r,a,s){if(!(i<=0)){if(this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),s&&s[3]===n||(this.context.globalAlpha=n),s||this.settingAlphaId!==$3f0923cd3c55ea92$var$ALPHA_CIRCLE&&this.settingAlphaId!==$3f0923cd3c55ea92$var$ALPHA_SQUARE||(this.context.fillStyle=this.settingColorStr),r>0){var o=2*Math.random()*Math.PI,l=Math.sqrt(Math.random())*r;e+=Math.cos(o)*l,t+=Math.sin(o)*l}var h=this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_CIRCLE||this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_CAL?i:i*Math.sqrt(2);if(this.updateChangedTiles({x1:Math.floor(e-h),y1:Math.floor(t-h),x2:Math.ceil(e+h),y2:Math.ceil(t+h)}),this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_CIRCLE)this.context.beginPath(),this.context.arc(e,t,i,0,$3f0923cd3c55ea92$var$TWO_PI),this.context.closePath(),this.context.fill(),this.hasDrawnDot=!0;else if(this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_SQUARE)void 0!==a&&(this.context.save(),this.context.translate(e,t),this.context.rotate(a/180*Math.PI),this.context.fillRect(-i,-i,2*i,2*i),this.context.restore(),this.hasDrawnDot=!0);else{this.context.save(),this.context.translate(e,t);var c=this.alphaCanvas128;i<=32&&i>16?c=this.alphaCanvas64:i<=16&&(c=this.alphaCanvas32),this.context.scale(i,i),this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_CHALK&&this.context.rotate((e+t)*53123%$3f0923cd3c55ea92$var$TWO_PI),this.context.drawImage(c,-1,-1,2,2),this.context.restore(),this.hasDrawnDot=!0}}}},{key:"continueLine",value:function(e,t,i,n){var r=this;null===this.bezierLine&&(this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,function(){}));var a=[],s=function(e){var t=$eWjiX.BB.mix(r.lastInput2.pressure,n,e.t),i=r.calcOpacity(t),s=Math.max(.1,r.settingSize*(r.settingHasSizePressure?t:1)),o=r.calcScatter(t);a.push([e.x,e.y,s,i,o,e.angle])},o=i*this.settingSpacing;null===e||null===t?this.bezierLine.addFinal(o,s):this.bezierLine.add(e,t,o,s),this.context.save();for(var l=void 0,h=0;h<a.length;h++){var c=a[h];this.drawDot(c[0],c[1],c[2],c[3],c[4],c[5],l),l=c}this.context.restore()}},{key:"startLine",value:function(e,t,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],i=$eWjiX.BB.clamp(i,0,1);var n=this.calcOpacity(i),r=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize),a=this.calcScatter(i);this.hasDrawnDot=!1,this.inputIsDrawing=!0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(e,t,r,n,a),this.context.restore(),this.lineToolLastDot=r*this.settingSpacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.inputArr=[{x:e,y:t,pressure:i}]}},{key:"goLine",value:function(e,t,i){if(this.inputIsDrawing){var n=$eWjiX.BB.clamp(i,0,1),r=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(e,t,r,this.lastInput.pressure),this.context.restore(),this.lastInput.x=e,this.lastInput.y=t,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=n,this.inputArr.push({x:e,y:t,pressure:i})}}},{key:"endLine",value:function(){var e=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);if(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(null,null,e,this.lastInput.pressure),this.context.restore(),this.inputIsDrawing=!1,this.settingAlphaId===$3f0923cd3c55ea92$var$ALPHA_SQUARE&&!this.hasDrawnDot){var t=this.inputArr[0];this.inputArr.forEach(function(e){e.pressure>t.pressure&&(t=e)}),this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);var i=$eWjiX.BB.clamp(t.pressure,0,1),n=this.calcOpacity(i),r=this.calcScatter(i);this.drawDot(t.x,t.y,e,n,r,0),this.context.restore()}this.bezierLine=null,this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles))),this.hasDrawnDot=!1,this.inputArr=[]}},{key:"drawLineSegment",value:function(e,t,i,n){if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.lastInput.x=i,this.lastInput.y=n,this.lastInput.pressure=1,!this.inputIsDrawing&&void 0!==e){var r,a=$eWjiX.BB.pointsToAngleDeg({x:e,y:t},{x:i,y:n}),s=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),o=(i-e)/s,l=(n-t)/s,h=this.settingSize*this.settingSpacing;this.lineToolLastDot=this.settingSize*this.settingSpacing,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);var c=this.calcScatter(1);for(r=this.lineToolLastDot;r<=s;r+=h)this.drawDot(e+o*r,t+l*r,this.settingSize,this.settingOpacity,c,a);this.context.restore(),this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}}},{key:"isDrawing",value:function(){return this.inputIsDrawing}},{key:"setAlpha",value:function(e){this.settingAlphaId!==e&&(this.settingAlphaId=e,this.updateAlphaCanvas())}},{key:"setColor",value:function(e){this.settingColor!==e&&(this.settingColor={r:e.r,g:e.g,b:e.b},this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")",this.updateAlphaCanvas())}},{key:"setContext",value:function(e){this.context=e}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setScatter",value:function(e){this.settingScatter=e}},{key:"setSpacing",value:function(e){this.settingSpacing=e}},{key:"sizePressure",value:function(e){this.settingHasSizePressure=e}},{key:"opacityPressure",value:function(e){this.settingHasOpacityPressure=e}},{key:"scatterPressure",value:function(e){this.settingHasScatterPressure=e}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"getSpacing",value:function(){return this.settingSpacing}},{key:"getSize",value:function(){return this.settingSize}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"getScatter",value:function(){return this.settingScatter}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$esGm2=parcelRequire("esGm2"),$eg83P=parcelRequire("eg83P"),$gWfkn=parcelRequire("gWfkn"),$7jh4K=parcelRequire("7jh4K"),$02d77b8dd5755328$export$9659db8d01dd5313=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.isTesting=!1,this.context={},this.layerId="NOT_SET",this.color={},this.size=29,this.opacity=.6,this.blending=.65,this.settingLockLayerAlpha=!1,this.settingSizePressure=!0,this.settingOpacityPressure=!1,this.blendCol={r:0,g:0,b:0,a:1},this.blendMix=.45,this.mixCol={r:0,g:0,b:0},this.localColOld={},this.isDrawing=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.klHistory={},this.cells=[],this.drawBuffer=[]}return(0,$7h4XF._)(e,[{key:"updateRedrawBounds",value:function(e){var t=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);t&&(this.redrawBounds=$eWjiX.BB.updateBounds(this.redrawBounds,t))}},{key:"getCellsWidth",value:function(){return Math.ceil(this.context.canvas.width/$gWfkn.HISTORY_TILE_SIZE)}},{key:"drawCells",value:function(e){var t=this,i=this.getCellsWidth();e.forEach(function(e,n){if(e){var r=n%i*$gWfkn.HISTORY_TILE_SIZE,a=Math.floor(n/i)*$gWfkn.HISTORY_TILE_SIZE;t.context.putImageData(e,r,a)}})}},{key:"drawChangedCells",value:function(){var e=this;if(this.redrawBounds){var t=this.cells.map(function(){}),i=this.getTouchedCells(this.redrawBounds);i.forEach(function(i,n){i&&(t[n]=e.cells[n])}),this.drawCells(t),this.redrawBounds=void 0}}},{key:"getTouchedCells",value:function(e){var t=this.cells.map(function(){return!1}),i=this.getCellsWidth();e={x1:Math.floor(e.x1/$gWfkn.HISTORY_TILE_SIZE),y1:Math.floor(e.y1/$gWfkn.HISTORY_TILE_SIZE),x2:Math.floor(e.x2/$gWfkn.HISTORY_TILE_SIZE),y2:Math.floor(e.y2/$gWfkn.HISTORY_TILE_SIZE)};for(var n=e.x1;n<=e.x2;n++)for(var r=e.y1;r<=e.y2;r++)t[r*i+n]=!0;return t}},{key:"sliceBounds",value:function(e){var t=this,i=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);if(!i)return[];var n=this.getCellsWidth(),r=[];return this.getTouchedCells(i).forEach(function(e,a){if(e){var s=a%n*$gWfkn.HISTORY_TILE_SIZE,o=Math.floor(a/n)*$gWfkn.HISTORY_TILE_SIZE,l=t.cells[a].width,h=t.cells[a].height,c={x1:Math.max(0,i.x1-s),y1:Math.max(0,i.y1-o),x2:Math.min(l-1,i.x2-s),y2:Math.min(h-1,i.y2-o)};c.x1>c.x2||c.y1>c.y2||r.push({index:a,bounds:c})}}),r}},{key:"copyFromCanvas",value:function(e){var t=this;if(e){var i=this.getTouchedCells(e),n=this.klHistory.getComposed().layerMap[this.layerId];i.forEach(function(e,i){if(e&&!t.cells[i]){var r=n.tiles[i];if((0,$esGm2.isLayerFill)(r)){var a=$eWjiX.BB.canvas($gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE),s=$eWjiX.BB.ctx(a);s.fillStyle=r.fill,s.fillRect(0,0,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE),t.cells[i]=s.getImageData(0,0,$gWfkn.HISTORY_TILE_SIZE,$gWfkn.HISTORY_TILE_SIZE)}else t.cells[i]=$871c020f286838cc$export$3d7bd55e322555b1(r.data)}})}}},{key:"getAverage",value:function(e,t,i){var n=this,r=Math.max(0,Math.floor(e-(i=Math.max(.5,.75*i)))),a=Math.max(0,Math.floor(t-i)),s=Math.min(this.context.canvas.width-1,Math.ceil(e+i)),o=Math.min(this.context.canvas.height-1,Math.ceil(t+i));if(r>s||a>o)return{r:0,g:0,b:0,a:0};var l=0,h=0,c=0,u=0,d=this.sliceBounds({x1:r,y1:a,x2:s,y2:o}),p=this.getCellsWidth();return d.forEach(function(e){for(var t=e.index%p*$gWfkn.HISTORY_TILE_SIZE,i=Math.floor(e.index/p)*$gWfkn.HISTORY_TILE_SIZE,r=n.cells[e.index].width,a=n.cells[e.index].data,s=e.bounds,o=s.y1,d=o+i;o<=s.y2;o++,d++)for(var f=s.x1,g=f+t,v=(o*r+s.x1)*4;f<=s.x2;f++,g++,v+=4)if(!n.mask||0!==n.mask[d*n.context.canvas.width+g]){var m=a[v+3]/255;0!==m&&(l+=a[v]*m,h+=a[v+1]*m,c+=a[v+2]*m,u+=m)}}),0!==u&&(l/=u,h/=u,c/=u,u=Math.min(1,u)),{r:l,g:h,b:c,a:u}}},{key:"getDotBounds",value:function(e,t,i){var n=Math.max(0,Math.floor(e-(i=Math.max(.5,i)))),r=Math.max(0,Math.floor(t-i)),a=Math.min(this.context.canvas.width-1,Math.ceil(e+i)),s=Math.min(this.context.canvas.height-1,Math.ceil(t+i));if(!(n>a)&&!(r>s))return{x1:n,y1:r,x2:a,y2:s}}},{key:"drawDot",value:function(e){for(var t=this,i=0,n=e.size>30?1024:512,r=[],a=0;a<n;a++)r[a]=(Math.random()-.5)/1.001+.5;var s=[8,4,4,4,2,2,2,2,2,2][Math.floor(2*e.size)],o=s?s*s:0,l=[];if(s)for(var h=0,c=0;c<s;c++)for(var u=0;u<s;u++,h+=2)l[h]=(c+1)/s,l[h+1]=(u+1)/s;var d=.8*Math.pow(e.opacity,2),p=1-d,f=d/p,g=e.size*e.size,v=g*p/e.opacity,m=(1+f)*e.opacity,y=this.sliceBounds({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),x=this.getCellsWidth();y.forEach(function(a){for(var s=a.index%x*$gWfkn.HISTORY_TILE_SIZE,h=Math.floor(a.index/x)*$gWfkn.HISTORY_TILE_SIZE,c=t.cells[a.index].width,u=t.cells[a.index].data,d=a.bounds.y1,p=d+h-e.y;d<=a.bounds.y2;d++,p++)for(var f=a.bounds.x1,y=(d+h)*t.context.canvas.width+(a.bounds.x1+s),b=(d*c+a.bounds.x1)*4,w=f+s-e.x;f<=a.bounds.x2;f++,y++,b+=4,w++)if(!t.mask||0!==t.mask[y]){var k=0;if(o){for(var B=0;B<l.length;B+=2){var S=$eWjiX.BB.lenSquared(w+l[B],p+l[B+1]);S>=g||(k+=(0,$eg83P.clamp)(m-S/v,0,e.opacity))}if(!k)continue;k/=o}else{var C=Math.pow(w,2)+Math.pow(p,2);if(C>=g)continue;k=(0,$eg83P.clamp)(m-C/v,0,e.opacity)}var E=1-k,_=u[b+3]/255;if(t.settingLockLayerAlpha){var I=e.r*k+u[b]*E,T=e.g*k+u[b+1]*E,M=e.b*k+u[b+2]*E;_&&(u[b]=Math.floor(I+r[i]),u[b+1]=Math.floor(T+r[i]),u[b+2]=Math.floor(M+r[i]))}else{var L=e.r*k+u[b]*_*E,R=e.g*k+u[b+1]*_*E,P=e.b*k+u[b+2]*_*E,A=1-E*(1-_);u[b+3]=Math.floor(Math.min(255,255*A)+.5),A&&(u[b]=Math.floor(L/A+r[i]),u[b+1]=Math.floor(R/A+r[i]),u[b+2]=Math.floor(P/A+r[i]))}i=(i+1)%n}})}},{key:"calcSpacing",value:function(e){return $eWjiX.BB.mix(2*e/2,2*e/9,(0,$eg83P.clamp)((e-2.7)/9.3,0,1))}},{key:"continueLine",value:function(e,t,i,n){var r,a,s,o,l=this;this.drawBuffer=[];var h=this.settingSizePressure?Math.max(1,i*this.size):Math.max(1,this.size),c=this.calcSpacing(h),u=void 0===e?this.lastInput.x:e,d=void 0===t?this.lastInput.y:t;if(0===this.blending)this.mixCol.r=this.color.r,this.mixCol.g=this.color.g,this.mixCol.b=this.color.b;else{if(n)o={r:this.localColOld.r,g:this.localColOld.g,b:this.localColOld.b,a:0};else{var p=[u,d,this.settingSizePressure?Math.max(.5,i*this.size):Math.max(.5,this.size)],f=this.getDotBounds(p[0],p[1],p[2]);f&&this.copyFromCanvas(f),o=this.getAverage(p[0],p[1],p[2])}s={r:0,g:0,b:0,a:0},o.a>0&&0===this.blendCol.a?(this.blendCol.r=o.r,this.blendCol.g=o.g,this.blendCol.b=o.b,this.blendCol.a=o.a):(0===o.a&&(o.r=this.color.r,o.g=this.color.g,o.b=this.color.b,o.a=1-this.blending),this.blendCol.r=$eWjiX.BB.mix(this.blendCol.r,$eWjiX.BB.mix(this.blendCol.r,o.r,this.blendMix),o.a),this.blendCol.g=$eWjiX.BB.mix(this.blendCol.g,$eWjiX.BB.mix(this.blendCol.g,o.g,this.blendMix),o.a),this.blendCol.b=$eWjiX.BB.mix(this.blendCol.b,$eWjiX.BB.mix(this.blendCol.b,o.b,this.blendMix),o.a),this.blendCol.a=Math.min(1,this.blendCol.a+o.a)),s.r=this.blendCol.r,s.g=this.blendCol.g,s.b=this.blendCol.b,s.a=this.blendCol.a}var g=function(e){if(!(l.blending>=1)||!(l.blendCol.a<=0)){var t=e.t;r=l.lastInput2.pressure*(1-t)+i*t,a=l.settingOpacityPressure?l.opacity*r*r:l.opacity,h=l.settingSizePressure?Math.max(.1,r*l.size):Math.max(.1,l.size),0!=l.blending&&(l.mixCol.r=$eWjiX.BB.mix(l.localColOld.r,s.r,t),l.mixCol.g=$eWjiX.BB.mix(l.localColOld.g,s.g,t),l.mixCol.b=$eWjiX.BB.mix(l.localColOld.b,s.b,t)),1===l.blending&&0===l.localColOld.a&&(l.mixCol.r=s.r,l.mixCol.g=s.g,l.mixCol.b=s.b);var n=l.getDotBounds(e.x,e.y,h);n&&(l.updateRedrawBounds(n),l.drawBuffer.push({x:e.x,y:e.y,size:h,opacity:a,x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,r:$eWjiX.BB.mix(l.color.r,l.mixCol.r,l.blending),g:$eWjiX.BB.mix(l.color.g,l.mixCol.g,l.blending),b:$eWjiX.BB.mix(l.color.b,l.mixCol.b,l.blending)}))}};void 0===e||void 0===t?this.bezierLine.addFinal(c,g):this.bezierLine.add(e,t,c,g),this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach(function(e){l.drawDot(e)}),this.drawBuffer=[],this.localColOld=s}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"getSize",value:function(){return this.size}},{key:"setSize",value:function(e){this.size=e}},{key:"getOpacity",value:function(){return this.opacity}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"getBlending",value:function(){return this.blending}},{key:"setBlending",value:function(e){this.blending=e}},{key:"setColor",value:function(e){this.color=$eWjiX.BB.copyObj(e)}},{key:"setContext",value:function(e,t){this.context=e,this.layerId=t}},{key:"setSizePressure",value:function(e){this.settingSizePressure=e}},{key:"setOpacityPressure",value:function(e){this.settingOpacityPressure=e}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"setIsTesting",value:function(e){this.isTesting=e}},{key:"startLine",value:function(e,t,i){var n=this,r=this.klHistory.getComposed().selection.value;this.selectionBounds=r?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(r)):void 0,this.mask=r?$bdef137f4147ecbc$export$820c5732ce56544(r,this.context.canvas.width,this.context.canvas.height):void 0;var a=Math.ceil(this.context.canvas.width/$gWfkn.HISTORY_TILE_SIZE)*Math.ceil(this.context.canvas.height/$gWfkn.HISTORY_TILE_SIZE);this.cells=(0,$7jh4K.createArray)(a,void 0),this.isDrawing=!0,i=Math.max(0,Math.min(1,i));var s=this.settingOpacityPressure?this.opacity*i*i:this.opacity,o=this.settingSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size);if(0===this.blending)this.mixCol.r=this.color.r,this.mixCol.g=this.color.g,this.mixCol.b=this.color.b;else{this.copyFromCanvas(this.getDotBounds(e,t,o));var l=this.getAverage(e,t,this.settingSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size));0===l.a?this.blendCol={r:this.color.r,g:this.color.g,b:this.color.b,a:1-this.blending}:this.blendCol={r:l.r,g:l.g,b:l.b,a:l.a},this.mixCol.r=this.blendCol.r,this.mixCol.g=this.blendCol.g,this.mixCol.b=this.blendCol.b}if(this.localColOld={r:this.mixCol.r,g:this.mixCol.g,b:this.mixCol.b,a:this.blendCol.a},this.redrawBounds=void 0,this.drawBuffer=[],this.blending<1||this.blendCol.a>0){var h=this.getDotBounds(e,t,o);h&&(this.updateRedrawBounds(h),this.drawBuffer.push({x:e,y:t,size:o,opacity:s,x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,r:$eWjiX.BB.mix(this.color.r,this.mixCol.r,this.blending),g:$eWjiX.BB.mix(this.color.g,this.mixCol.g,this.blending),b:$eWjiX.BB.mix(this.color.b,this.mixCol.b,this.blending)}))}this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach(function(e){n.drawDot(e)}),this.drawBuffer=[],this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(e,t,0,function(){}),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.isTesting||this.drawChangedCells()}},{key:"goLine",value:function(e,t,i,n){this.isDrawing&&(this.continueLine(e,t,this.lastInput.pressure,n),this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.isTesting||this.drawChangedCells())}},{key:"endLine",value:function(){if(this.bezierLine&&this.continueLine(void 0,void 0,this.lastInput.pressure,!1),this.isDrawing=!1,this.bezierLine=void 0,this.drawChangedCells(),this.cells.some(function(e){return e})){var e=this.cells;if(this.selectionBounds){var t=$3798530d3967d87a$export$2098fe43203ddd32(this.selectionBounds,this.context.canvas.width,this.context.canvas.height);e=e.map(function(e,i){return t[i]?e:void 0})}this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),e.map(function(e){return e?$90d1e8bd87cfe19c$export$55941c74c8f934(e):void 0})))}this.cells=[]}},{key:"drawLineSegment",value:function(e,t,i,n){var r=i-e,a=n-t,s=Math.ceil(Math.sqrt(r*r+a*a)/10);this.startLine(e,t,1);for(var o=1;o<=s;o++){var l=o/s,h=e+r*l,c=t+a*l;this.goLine(h,c,1,!1)}this.endLine()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$c214fbe9e4fc15b0$var$sampleCanvas=$eWjiX.BB.canvas(32,32),$c214fbe9e4fc15b0$var$sampleCtx=$eWjiX.BB.ctx($c214fbe9e4fc15b0$var$sampleCanvas),$c214fbe9e4fc15b0$export$566f9061f0f5ba33=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.context={},this.settingColor={},this.settingSize=1,this.settingOpacity=.2,this.settingBlending=.5,this.settingScale=1,this.lastX=0,this.lastY=0,this.inputIsDrawing=!1,this.lastInput={x:0,y:0,pressure:0},this.klHistory={},this.sketchySeed=0,this.points=[],this.count=0,this.mixMode=[function(e){return e},function(e,t){var i=new $eWjiX.BB.RGB(e.r,e.g,e.b);return i.r*=t.r/255,i.g*=t.g/255,i.b*=t.b/255,i}]}return(0,$7h4XF._)(e,[{key:"rand",value:function(){return this.sketchySeed++,.5*Math.sin(6324634.2345*Math.cos(5342.3423*this.sketchySeed))+.5}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSeed",value:function(e){this.sketchySeed=parseInt(""+e)}},{key:"getSeed",value:function(){return parseInt(""+this.sketchySeed)}},{key:"getSize",value:function(){return this.settingSize/2}},{key:"setColor",value:function(e){this.settingColor=e}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"getBlending",value:function(){return this.settingBlending}},{key:"setBlending",value:function(e){this.settingBlending=e}},{key:"setSize",value:function(e){this.settingSize=2*e}},{key:"getScale",value:function(){return this.settingScale}},{key:"setScale",value:function(e){this.settingScale=e}},{key:"setContext",value:function(e){this.context=e}},{key:"startLine",value:function(e,t,i,n){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedBounds=void 0,n&&this.lastInput.x?(this.inputIsDrawing=!0,this.endLine()):(this.inputIsDrawing=!0,this.lastX=e,this.lastY=t,this.lastInput.x=e,this.lastInput.y=t)}},{key:"goLine",value:function(e,t,i,n){if(this.inputIsDrawing&&(e!==this.lastInput.x||t!==this.lastInput.y)){var r,a,s,o,l=parseInt(""+e),h=parseInt(""+t);this.points.push([l,h]);var c=this.settingColor.r,u=this.settingColor.g,d=this.settingColor.b;if(n)c=n.r,u=n.g,d=n.b;else if(0!==this.settingBlending&&l+5>=0&&h+5>=0&&l-5<this.context.canvas.width-1&&h-5<this.context.canvas.height-1){c=0,u=0,d=0;var p=Math.min(this.context.canvas.width-1,Math.max(0,l-5)),f=Math.min(this.context.canvas.height-1,Math.max(0,h-5)),g=Math.min(this.context.canvas.width-1,Math.max(0,l+5)),v=Math.min(this.context.canvas.height-1,Math.max(0,h+5));if(g-=p,v-=f,g>0&&v>0){for(var m=this.context.getImageData(p,f,g,v),y=0,x=0;x<m.data.length;x+=4)c+=m.data[x+0],u+=m.data[x+1],d+=m.data[x+2],y++;c/=y,u/=y,d/=y}var b=this.mixMode[0](new $eWjiX.BB.RGB(c,u,d),this.settingColor);c=parseInt(""+$eWjiX.BB.mix(this.settingColor.r,b.r,this.settingBlending)),u=parseInt(""+$eWjiX.BB.mix(this.settingColor.g,b.g,this.settingBlending)),d=parseInt(""+$eWjiX.BB.mix(this.settingColor.b,b.b,this.settingBlending))}for(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.context.strokeStyle="rgba("+c+", "+u+", "+d+", "+this.settingOpacity+")",this.context.lineWidth=this.settingSize,this.context.beginPath(),this.context.moveTo(this.lastX,this.lastY),this.context.lineTo(l,h),r=0;r<this.points.length;r++)a=this.points[r][0]-this.points[this.count][0],(o=a*a+(s=this.points[r][1]-this.points[this.count][1])*s)<4e3*this.settingScale*this.settingScale&&this.rand()>o/2e3/this.settingScale/this.settingScale&&(this.context.moveTo(this.points[this.count][0]+.3*a,this.points[this.count][1]+.3*s),this.context.lineTo(this.points[r][0]-.3*a,this.points[r][1]-.3*s));this.context.stroke(),this.context.restore(),this.count++,this.lastX=l,this.lastY=h,this.lastInput.x=l,this.lastInput.y=h,this.changedBounds=$eWjiX.BB.updateBounds(this.changedBounds,{x1:Math.floor(l-this.settingSize/2),y1:Math.floor(h-this.settingSize/2),x2:Math.ceil(l+this.settingSize/2),y2:Math.ceil(h+this.settingSize/2)})}}},{key:"endLine",value:function(){if(this.inputIsDrawing=!1,this.count=0,this.points=[],this.changedBounds){var e=(0,$eg83P.boundsOverlap)(this.changedBounds,this.selectionBounds),t=$1a6c9997bc8182ff$export$7b1ba44282f9a519(this.context.canvas,e);t.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),t))}}},{key:"drawLineSegment",value:function(e,t,i,n){if(this.changedBounds=void 0,this.lastInput.x=i,this.lastInput.y=n,!this.inputIsDrawing&&void 0!==e){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.context.lineWidth=this.settingSize;var r={r:this.settingColor.r,g:this.settingColor.g,b:this.settingColor.b};if(e+5>=0&&t+5>=0&&e-5<this.context.canvas.width-1&&t-5<this.context.canvas.height-1){r.r=0,r.g=0,r.b=0;var a=Math.min(this.context.canvas.width-1,Math.max(0,e-5)),s=Math.min(this.context.canvas.height-1,Math.max(0,t-5)),o=Math.min(this.context.canvas.width-1,Math.max(0,e+5)),l=Math.min(this.context.canvas.height-1,Math.max(0,t+5));if(o-=a,l-=s,o>0&&l>0){var h=Math.min($c214fbe9e4fc15b0$var$sampleCanvas.width,o),c=Math.min($c214fbe9e4fc15b0$var$sampleCanvas.height,l);$c214fbe9e4fc15b0$var$sampleCtx.save(),$c214fbe9e4fc15b0$var$sampleCtx.globalCompositeOperation="copy",$c214fbe9e4fc15b0$var$sampleCtx.drawImage(this.context.canvas,a,s,o,l,0,0,h,c),$c214fbe9e4fc15b0$var$sampleCtx.restore();for(var u=$c214fbe9e4fc15b0$var$sampleCtx.getImageData(a,s,o,l),d=0,p=0;p<u.data.length;p+=4)r.r+=u.data[p+0],r.g+=u.data[p+1],r.b+=u.data[p+2],d++;r.r/=d,r.g/=d,r.b/=d}}var f=this.mixMode[0](new $eWjiX.BB.RGB(r.r,r.g,r.b),this.settingColor);if(r.r=parseInt(""+(this.settingBlending*f.r+this.settingColor.r*(1-this.settingBlending))),r.g=parseInt(""+(this.settingBlending*f.g+this.settingColor.g*(1-this.settingBlending))),r.b=parseInt(""+(this.settingBlending*f.b+this.settingColor.b*(1-this.settingBlending))),this.context.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+this.settingOpacity+")",this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(i,n),this.context.stroke(),this.context.strokeStyle="rgba("+r.r+", "+r.g+", "+r.b+", "+this.settingOpacity+")",this.context.restore(),this.changedBounds=$eWjiX.BB.updateBounds(this.changedBounds,{x1:Math.floor(e-this.settingSize/2),y1:Math.floor(t-this.settingSize/2),x2:Math.ceil(e+this.settingSize/2),y2:Math.ceil(t+this.settingSize/2)}),this.changedBounds=$eWjiX.BB.updateBounds(this.changedBounds,{x1:Math.floor(i-this.settingSize/2),y1:Math.floor(n-this.settingSize/2),x2:Math.ceil(i+this.settingSize/2),y2:Math.ceil(n+this.settingSize/2)}),this.changedBounds){var g=(0,$eg83P.boundsOverlap)(this.changedBounds,this.selectionBounds),v=$1a6c9997bc8182ff$export$7b1ba44282f9a519(this.context.canvas,g);v.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),v))}}}},{key:"isDrawing",value:function(){return this.inputIsDrawing}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$58b45953679baa4a$export$4de5ef8eecde6f12=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.klHistory={},this.context={},this.settingHasSizePressure=!0,this.settingHasOpacityPressure=!1,this.settingSize=.5,this.settingSpacing=.9,this.settingOpacity=1,this.settingColor={},this.settingColorStr="",this.settingLockLayerAlpha=!1,this.settingIsEraser=!1,this.settingUseDither=!0,this.inputIsDrawing=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.bezierLine=null,this.ditherArr=[[3,2],[1,0],[3,0],[1,2],[2,1],[0,3],[0,1],[2,3],[2,0],[0,2],[0,0],[2,2],[1,1],[3,3],[3,1],[1,3]],this.ditherPattern={},this.canvasClone={},this.ctxClone={},this.historyTiles=[],this.ditherCanvas=$eWjiX.BB.canvas(4,4),this.ditherCtx=$eWjiX.BB.ctx(this.ditherCanvas)}return(0,$7h4XF._)(e,[{key:"updateChangedTiles",value:function(e){e={x1:Math.min(e.x1,e.x2),y1:Math.min(e.y1,e.y2),x2:Math.max(e.x1,e.x2),y2:Math.max(e.y1,e.y2)};var t=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);if(t){var i=$3798530d3967d87a$export$2098fe43203ddd32(t,this.context.canvas.width,this.context.canvas.height);this.redrawBounds=this.redrawBounds?(0,$eg83P.updateBounds)(this.redrawBounds,t):t,this.historyTiles=$3798530d3967d87a$export$1774f90c6da5013c(this.historyTiles,i)}}},{key:"initClone",value:function(){this.canvasClone=$eWjiX.BB.canvas(this.context.canvas.width,this.context.canvas.height),this.ctxClone=$eWjiX.BB.ctx(this.canvasClone),this.ctxClone.drawImage(this.context.canvas,0,0)}},{key:"freeClone",value:function(){$eWjiX.BB.freeCanvas(this.canvasClone),this.ctxClone={}}},{key:"redrawToCanvas",value:function(){if(this.redrawBounds){var e=(0,$eg83P.boundsToRect)(this.redrawBounds,!0);this.context.save(),this.context.clearRect(e.x,e.y,e.width,e.height),this.context.drawImage(this.canvasClone,e.x,e.y,e.width,e.height,e.x,e.y,e.width,e.height),this.context.restore(),this.redrawBounds=void 0}}},{key:"updateDither",value:function(){this.ditherCtx.clearRect(0,0,4,4),this.ditherCtx.fillStyle=this.settingIsEraser?`rgb(${$00f785a5ea9e210d$export$e4203cb02d5e5b28},${$00f785a5ea9e210d$export$e4203cb02d5e5b28},${$00f785a5ea9e210d$export$e4203cb02d5e5b28})`:this.settingColorStr;for(var e=0;e<Math.max(1,Math.round(this.settingOpacity*this.ditherArr.length));e++)this.ditherCtx.fillRect(this.ditherArr[e][0],this.ditherArr[e][1],1,1);this.ditherPattern=(0,$7jh4K.throwIfNull)(this.context.createPattern(this.ditherCanvas,"repeat"))}},{key:"cubicCurveOverThreshold",value:function(e,t,i,n,r){var a=$eWjiX.BB.Vec2.nor({x:n.x-e.x,y:n.y-e.y}),s=$eWjiX.BB.Vec2.nor({x:t.x-e.x,y:t.y-e.y}),o=$eWjiX.BB.Vec2.nor({x:n.x-i.x,y:n.y-i.y});return Math.max($eWjiX.BB.Vec2.dist(a,s),$eWjiX.BB.Vec2.dist(a,o))>r}},{key:"plotCubicBezierLine",value:function(e,t,i,n){var r=this.cubicCurveOverThreshold(e,t,i,n,.1);e.x=Math.floor(e.x),e.y=Math.floor(e.y),n.x=Math.floor(n.x),n.y=Math.floor(n.y);var a=$eWjiX.BB.dist(e.x,e.y,n.x,n.y);if(!r||a<7){this.updateChangedTiles({x1:e.x,y1:e.y,x2:n.x,y2:n.y}),this.plotLine(e.x,e.y,n.x,n.y,!0);return}for(var s=Math.max(2,Math.round(a/4)),o=[],l=0;l<=s;l++){var h=l/s,c=Math.pow(1-h,3),u=3*h*Math.pow(1-h,2),d=3*Math.pow(h,2)*(1-h),p=Math.pow(h,3);o.push({x:c*e.x+u*t.x+d*i.x+p*n.x,y:c*e.y+u*t.y+d*i.y+p*n.y})}for(var f=0;f<s;f++)this.updateChangedTiles({x1:Math.round(o[f].x),y1:Math.round(o[f].y),x2:Math.round(o[f+1].x),y2:Math.round(o[f+1].y)}),this.plotLine(Math.round(o[f].x),Math.round(o[f].y),Math.round(o[f+1].x),Math.round(o[f+1].y),!0)}},{key:"drawDot",value:function(e,t,i,n){var r={x:Math.round(e+-i),y:Math.round(t+-i),width:Math.round(2*i),height:Math.round(2*i)};this.updateChangedTiles({x1:r.x,y1:r.y,x2:r.x+r.width,y2:r.y+r.height}),this.ctxClone.save(),this.settingIsEraser?(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:"#fff",this.settingLockLayerAlpha?this.ctxClone.globalCompositeOperation="source-atop":this.ctxClone.globalCompositeOperation="destination-out"):(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:this.settingColorStr,this.settingLockLayerAlpha&&(this.ctxClone.globalCompositeOperation="source-atop")),this.ctxClone.globalAlpha=this.settingUseDither?1:n,this.ctxClone.fillRect(r.x,r.y,r.width,r.height),this.ctxClone.restore()}},{key:"continueLine",value:function(e,t,i,n){var r=this;null===this.bezierLine&&(this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,function(){})),this.ctxClone.save(),this.selectionPath&&this.ctxClone.clip(this.selectionPath);var a=function(e){var t=$eWjiX.BB.mix(r.lastInput2.pressure,n,e.t),i=r.settingOpacity*(r.settingHasOpacityPressure?t*t:1),a=Math.max(.5,r.settingSize*(r.settingHasSizePressure?t:1));r.drawDot(e.x,e.y,a,i)},s=function(e){r.plotCubicBezierLine(e.p1,e.p2,e.p3,e.p4)};if(1===Math.round(2*this.settingSize))this.bresenheimPath=new Path2D,null===e||null===t?this.bezierLine.addFinal(4,void 0,s):this.bezierLine.add(e,t,4,void 0,s),this.settingIsEraser?(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:"#fff",this.settingLockLayerAlpha?this.ctxClone.globalCompositeOperation="source-atop":this.ctxClone.globalCompositeOperation="destination-out"):(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:this.settingColorStr,this.settingLockLayerAlpha&&(this.ctxClone.globalCompositeOperation="source-atop")),this.ctxClone.globalAlpha=this.settingUseDither?1:this.settingOpacity,this.ctxClone.fill(this.bresenheimPath),this.bresenheimPath=void 0;else{var o=i*this.settingSpacing;null===e||null===t?this.bezierLine.addFinal(o,a):this.bezierLine.add(e,t,o,a)}this.ctxClone.restore()}},{key:"plotLine",value:function(e,t,i,n,r){e=Math.floor(e),t=Math.floor(t);for(var a=Math.abs((i=Math.floor(i))-e),s=e<i?1:-1,o=-Math.abs((n=Math.floor(n))-t),l=t<n?1:-1,h=a+o;r?r=!1:null==(c=this.bresenheimPath)||c.rect(e,t,1,1),e!==i||t!==n;){var c,u=2*h;u>=o&&(h+=o,e+=s),u<=a&&(h+=a,t+=l)}}},{key:"startLine",value:function(e,t,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.historyTiles=[],this.redrawBounds=void 0,this.settingUseDither&&this.updateDither(),this.initClone(),i=Math.max(0,Math.min(1,i));var n=this.settingHasOpacityPressure?this.settingOpacity*i*i:this.settingOpacity,r=this.settingHasSizePressure?Math.max(.5,i*this.settingSize):Math.max(.5,this.settingSize);this.inputIsDrawing=!0,this.ctxClone.save(),this.selectionPath&&this.ctxClone.clip(this.selectionPath),this.drawDot(e,t,r,n),this.ctxClone.restore(),this.lineToolLastDot=r*this.settingSpacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.redrawToCanvas()}},{key:"goLine",value:function(e,t,i){if(this.inputIsDrawing){var n=$eWjiX.BB.clamp(i,0,1),r=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(e,t,r,this.lastInput.pressure),this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=n,this.redrawToCanvas()}}},{key:"endLine",value:function(){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0;var e=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(null,null,e,this.lastInput.pressure),this.inputIsDrawing=!1,this.bezierLine=null,this.redrawToCanvas(),this.historyTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.canvasClone,this.historyTiles))),this.freeClone()}},{key:"drawLineSegment",value:function(e,t,i,n){this.startLine(e,t,1),this.goLine(i,n,1),this.endLine()}},{key:"isDrawing",value:function(){return this.inputIsDrawing}},{key:"setColor",value:function(e){this.settingColor!==e&&(this.settingColor=e,this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")")}},{key:"setContext",value:function(e){this.context=e}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSize",value:function(e){this.settingSize=Math.round(2*e)/2}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setSpacing",value:function(e){this.settingSpacing=e}},{key:"sizePressure",value:function(e){this.settingHasSizePressure=e}},{key:"opacityPressure",value:function(e){this.settingHasOpacityPressure=e}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"setIsEraser",value:function(e){this.settingIsEraser=e}},{key:"setUseDither",value:function(e){this.settingUseDither=e}},{key:"getSpacing",value:function(){return this.settingSpacing}},{key:"getSize",value:function(){return this.settingSize}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"getIsEraser",value:function(){return this.settingIsEraser}},{key:"getUseDither",value:function(){return this.settingUseDither}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$fc1a683099fb2d61$export$fe52c90afd1cf5ba=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.size=30,this.spacing=.4,this.opacity=1,this.useSizePressure=!0,this.useOpacityPressure=!1,this.isTransparentBG=!1,this.klHistory={},this.isBaseLayer=!1,this.layer={},this.context={},this.started=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.changedTiles=[]}return(0,$7h4XF._)(e,[{key:"updateChangedTiles",value:function(e){(0,$eg83P.boundsOverlap)(e,this.selectionBounds)&&(this.changedTiles=$3798530d3967d87a$export$1774f90c6da5013c(this.changedTiles,$3798530d3967d87a$export$2098fe43203ddd32(e,this.context.canvas.width,this.context.canvas.height)))}},{key:"drawDot",value:function(e,t,i,n){this.context.save(),this.isBaseLayer?this.isTransparentBG?this.context.globalCompositeOperation="destination-out":this.context.globalCompositeOperation="source-atop":this.context.globalCompositeOperation="destination-out";var r=this.context.createRadialGradient(i,i,0,i,i,i),a=Math.pow(n,2);a=Math.max(0,Math.min((i-1)/i,a));var s=Math.max(0,Math.min(1,n)),o=2*s-s*s;r.addColorStop(a,`rgba(${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, ${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, ${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, `+o+")"),r.addColorStop(1,`rgba(${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, ${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, ${$00f785a5ea9e210d$export$e4203cb02d5e5b28}, 0)`),this.context.fillStyle=r,this.context.translate(e-i,t-i),this.context.fillRect(0,0,2*i,2*i),this.context.restore(),this.updateChangedTiles({x1:Math.floor(e-i),y1:Math.floor(t-i),x2:Math.ceil(e+i),y2:Math.ceil(t+i)})}},{key:"continueLine",value:function(e,t,i){var n,r,a=this;i=Math.max(0,Math.min(1,i));var s=this.useSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size),o=Math.max(1,Math.max(.5,1-this.opacity)*s*this.spacing),l=function(e){var t=e.t;n=a.lastInput2.pressure*(1-t)+i*t,r=a.useOpacityPressure?a.opacity*n*n:a.opacity,s=a.useSizePressure?Math.max(.1,n*a.size):Math.max(.1,a.size),a.drawDot(e.x,e.y,s,r)};this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),void 0===e||void 0===t?this.bezierLine.addFinal(o,l):this.bezierLine.add(e,t,o,l),this.context.restore()}},{key:"startLine",value:function(e,t,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.isBaseLayer=0===this.layer.index,i=Math.max(0,Math.min(1,i));var n=this.useOpacityPressure?this.opacity*i*i:this.opacity,r=this.useSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size);this.started=!0,r>1&&(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(e,t,r,n),this.context.restore()),this.lastDot=r*this.spacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(e,t,0,function(){})}},{key:"goLine",value:function(e,t,i){this.started&&(this.continueLine(e,t,this.lastInput.pressure),this.lastInput2=$eWjiX.BB.copyObj(this.lastInput),this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i)}},{key:"endLine",value:function(){this.bezierLine&&this.continueLine(void 0,void 0,this.lastInput.pressure),this.started=!1,this.bezierLine=void 0,this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}},{key:"drawLineSegment",value:function(e,t,i,n){if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.isBaseLayer=0===this.layer.index,this.lastInput.x=i,this.lastInput.y=n,!this.started&&void 0!==e){var r,a=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),s=(i-e)/a,o=(n-t)/a,l=Math.max(1,Math.max(.5,1-this.opacity)*this.size*this.spacing);for(this.lastDot=0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),r=this.lastDot;r<=a;r+=l)this.drawDot(e+s*r,t+o*r,this.size,this.opacity);this.context.restore(),this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}}},{key:"isDrawing",value:function(){return this.started}},{key:"setLayer",value:function(e){this.layer=e,this.context=e.context}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"sizePressure",value:function(e){this.useSizePressure=e}},{key:"opacityPressure",value:function(e){this.useOpacityPressure=e}},{key:"setTransparentBG",value:function(e){this.isTransparentBG=e}},{key:"getSize",value:function(){return this.size}},{key:"getOpacity",value:function(){return this.opacity}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$eg83P=parcelRequire("eg83P"),$7jh4K=parcelRequire("7jh4K"),$78ad817c60f81b7c$var$CELL_SIZE=256;function $78ad817c60f81b7c$var$prepSmudge(e,t,i,n,r){if(i.x===n.x&&i.y===n.y)return null;i=$eWjiX.BB.copyObj(i),n=$eWjiX.BB.copyObj(n),r=$eWjiX.BB.copyObj(r);var a=0,s=0,o=0,l=0;return(i.x<0&&(l=-i.x),i.y<0&&(a=-i.y),n.x<0&&(l=Math.max(l,-n.x)),n.y<0&&(a=Math.max(a,-n.y)),i.x+r.w>e&&(s=i.x+r.w-e),i.y+r.h>t&&(o=i.y+r.h-t),n.x+r.w>e&&(s=Math.max(s,n.x+r.w-e)),n.y+r.h>t&&(o=Math.max(o,n.y+r.h-t)),i.x+=l,n.x+=l,i.y+=a,n.y+=a,r.w=r.w-l-s,r.h=r.h-a-o,r.w<=0||r.h<=0)?null:{aP:{x:i.x,y:i.y},bP:{x:n.x,y:n.y},size:{w:r.w,h:r.h}}}function $78ad817c60f81b7c$var$smudge(e,t,i){for(var n=(i=$eWjiX.BB.copyObj(i)).brush.size,r=i.brush.center.x,a=i.brush.center.y,s=i.aP.y*e.width+i.aP.x,o=(i.bP.y*e.width+i.bP.x-s)*4,l=0,h=n>30?1024:512,c=[],u=0;u<h;u++)c[u]=(Math.random()-.5)/1.001+.5;var d=Math.max(3,Math.min(8,i.brush.size-8)),p=function(s,o,u,p){var f,g=$eWjiX.BB.dist(r,a,u,p),v=1-i.brush.opacity*(1-(0,$eg83P.clamp)((g-(n-d))/d,0,1));1!==v&&(!t||0!==t[s/4]&&0!==t[o/4])&&(e.data[s+3]&&(e.data[o+3]?(f=e.data[s+3]<e.data[o+3]?1-e.data[s+3]/e.data[o+3]*(1-v):e.data[o+3]/e.data[s+3]*v,e.data[o]=Math.floor($eWjiX.BB.mix(e.data[s],e.data[o+0],f)+c[l]),e.data[o+1]=Math.floor($eWjiX.BB.mix(e.data[s+1],e.data[o+1],f)+c[l]),e.data[o+2]=Math.floor($eWjiX.BB.mix(e.data[s+2],e.data[o+2],f)+c[l]),l=(l+1)%h):(e.data[o]=e.data[s],e.data[o+1]=e.data[s+1],e.data[o+2]=e.data[s+2])),i.brush.alphaLock||(e.data[o+3]=Math.floor($eWjiX.BB.mix(e.data[s+3],e.data[o+3],v)+.5)))},f=4*i.bP.x,g=f+(i.size.w-1)*4;if(i.aP.y<i.bP.y)for(var v=i.size.h-1,m=i.bP.y+i.size.h-1;v>=0;v--,m--)for(var y=(v+i.bP.y)*e.width*4,x=g+y,b=g+y-o,w=i.bP.x+i.size.w-1;x>=f+y;x-=4,b-=4,w--)p(b,x,w,m);else if(i.aP.y>i.bP.y)for(var k=0,B=i.bP.y;k<i.size.h;k++,B++)for(var S=(k+i.bP.y)*e.width*4,C=g+S,E=g+S-o,_=i.bP.x+i.size.w-1;C>=f+S;C-=4,E-=4,_--)p(E,C,_,B);else if(i.aP.x<i.bP.x)for(var I=i.size.h-1,T=i.bP.y+i.size.h-1;I>=0;I--,T--)for(var M=(I+i.bP.y)*e.width*4,L=g+M,R=g+M-o,P=i.bP.x+i.size.w-1;L>=f+M;L-=4,R-=4,P--)p(R,L,P,T);else for(var A=0,D=i.bP.y;A<i.size.h;A++,D++)for(var O=(A+i.bP.y)*e.width*4,z=f+O,H=f+O-o,j=i.bP.x;z<g+O;z+=4,H+=4,j++)p(H,z,j,D)}var $78ad817c60f81b7c$export$c9f800961903deab=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.context={},this.klHistory={},this.settingColor={r:0,g:0,b:0},this.settingSize=35,this.settingSpacing=.20446882736951905,this.settingOpacity=.8,this.settingHasSizePressure=!1,this.settingHasOpacityPressure=!1,this.settingLockLayerAlpha=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.isDrawing=!1,this.copyImageData={},this.drawBuffer=[],this.copiedCells=[]}return(0,$7h4XF._)(e,[{key:"resetRedrawBounds",value:function(){this.redrawBounds=void 0}},{key:"updateRedrawBounds",value:function(e){var t=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);t&&(this.redrawBounds=$eWjiX.BB.updateBounds(this.redrawBounds,t))}},{key:"updateCompleteRedrawBounds",value:function(e,t,i,n){this.completeRedrawBounds=$eWjiX.BB.updateBounds(this.completeRedrawBounds,{x1:e,y1:t,x2:i,y2:n})}},{key:"copyFromCanvas",value:function(){var e=this,t=this.copiedCells.map(function(){return!1}),i=[],n=Math.ceil(this.copyImageData.width/$78ad817c60f81b7c$var$CELL_SIZE);this.redrawBounds&&(i.push({x1:Math.floor(this.redrawBounds.x1/$78ad817c60f81b7c$var$CELL_SIZE),y1:Math.floor(this.redrawBounds.y1/$78ad817c60f81b7c$var$CELL_SIZE),x2:Math.floor(this.redrawBounds.x2/$78ad817c60f81b7c$var$CELL_SIZE),y2:Math.floor(this.redrawBounds.y2/$78ad817c60f81b7c$var$CELL_SIZE)}),i.forEach(function(e){for(var i=e.x1;i<=e.x2;i++)for(var r=e.y1;r<=e.y2;r++)t[r*n+i]=!0}),t.forEach(function(t,i){if(t&&!e.copiedCells[i]){e.copiedCells[i]=!0;var r=i%n,a=Math.floor(i/n),s=(Math.min(r*$78ad817c60f81b7c$var$CELL_SIZE+$78ad817c60f81b7c$var$CELL_SIZE,e.copyImageData.width)-1)%$78ad817c60f81b7c$var$CELL_SIZE+1,o=(Math.min(a*$78ad817c60f81b7c$var$CELL_SIZE+$78ad817c60f81b7c$var$CELL_SIZE,e.copyImageData.height)-1)%$78ad817c60f81b7c$var$CELL_SIZE+1,l=$eWjiX.BB.canvas(s,o),h=$eWjiX.BB.ctx(l);h.drawImage(e.context.canvas,-r*$78ad817c60f81b7c$var$CELL_SIZE,-a*$78ad817c60f81b7c$var$CELL_SIZE);for(var c=h.getImageData(0,0,s,o),u=0;u<o;u++)for(var d=0,p=u*s*4,f=((a*$78ad817c60f81b7c$var$CELL_SIZE+u)*e.copyImageData.width+r*$78ad817c60f81b7c$var$CELL_SIZE)*4;d<s;d++,p+=4,f+=4)e.copyImageData.data[f]=c.data[p],e.copyImageData.data[f+1]=c.data[p+1],e.copyImageData.data[f+2]=c.data[p+2],e.copyImageData.data[f+3]=c.data[p+3]}}))}},{key:"prepDot",value:function(e,t,i,n){if(!this.lastDot){this.lastDot={x:e,y:t};return}var r=Math.round(2*(i=Math.round(i))),a=Math.round(2*i),s=$78ad817c60f81b7c$var$prepSmudge(this.copyImageData.width,this.copyImageData.height,{x:Math.round(this.lastDot.x-i),y:Math.round(this.lastDot.y-i)},{x:Math.round(e-i),y:Math.round(t-i)},{w:r,h:a});if(s){var o={aP:s.aP,bP:s.bP,size:s.size,brush:{center:{x:e,y:t},size:i,opacity:n,alphaLock:this.settingLockLayerAlpha}};this.updateRedrawBounds({x1:o.bP.x,y1:o.bP.y,x2:o.bP.x+2*o.brush.size,y2:o.bP.y+2*o.brush.size}),this.drawBuffer.push(o)}this.lastDot={x:e,y:t}}},{key:"continueLine",value:function(e,t,i,n){var r=this;this.drawBuffer=[],this.bezierLine||(this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,function(){}));var a=[],s=function(e){var t=$eWjiX.BB.mix(r.lastInput2.pressure,n,e.t),i=r.settingOpacity*(r.settingHasOpacityPressure?t*t:1),s=Math.max(.1,r.settingSize*(r.settingHasSizePressure?t:1));a.push([e.x,e.y,s,i])},o=i*this.settingSpacing/3;void 0===e||void 0===t?this.bezierLine.addFinal(o,s):this.bezierLine.add(e,t,o,s);for(var l=0;l<a.length;l++){var h=a[l];this.prepDot(h[0],h[1],h[2],h[3])}this.copyFromCanvas();for(var c=0;c<this.drawBuffer.length;c++)$78ad817c60f81b7c$var$smudge(this.copyImageData,this.mask,this.drawBuffer[c])}},{key:"startLine",value:function(e,t,i){var n=this.klHistory.getComposed().selection.value;this.selectionBounds=n?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(n)):void 0,this.mask=n?$bdef137f4147ecbc$export$820c5732ce56544(n,this.context.canvas.width,this.context.canvas.height):void 0,i=$eWjiX.BB.clamp(i,0,1);var r=this.settingHasOpacityPressure?this.settingOpacity*i*i:this.settingOpacity,a=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize);this.lastDot=void 0,this.isDrawing=!0,this.copyImageData=new ImageData(this.context.canvas.width,this.context.canvas.height);var s=Math.ceil(this.context.canvas.width/$78ad817c60f81b7c$var$CELL_SIZE)*Math.ceil(this.context.canvas.height/$78ad817c60f81b7c$var$CELL_SIZE);this.copiedCells=(0,$7jh4K.createArray)(s,!1),this.prepDot(e,t,a,r),this.lineToolLastDot=a*this.settingSpacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.completeRedrawBounds=void 0}},{key:"goLine",value:function(e,t,i){if(this.isDrawing){this.resetRedrawBounds();var n=$eWjiX.BB.clamp(i,0,1),r=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(e,t,r,this.lastInput.pressure),this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1,this.redrawBounds.y2-this.redrawBounds.y1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.lastInput.x=e,this.lastInput.y=t,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=n}}},{key:"endLine",value:function(){this.resetRedrawBounds();var e=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.continueLine(void 0,void 0,e,this.lastInput.pressure),this.context.restore(),this.isDrawing=!1,this.bezierLine=void 0,this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1,this.redrawBounds.y2-this.redrawBounds.y1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.completeRedrawBounds&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$7b1ba44282f9a519(this.context.canvas,this.completeRedrawBounds))),this.copyImageData={}}},{key:"drawImage",value:function(e,t,i){e instanceof ImageData?this.context.putImageData(e,t,i):(this.context.clearRect(t,i,e.width,e.height),this.context.drawImage(e,t,i))}},{key:"drawLineSegment",value:function(e,t,i,n){}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"setColor",value:function(e){(this.settingColor.r!==e.r||this.settingColor.g!==e.g||this.settingColor.b!==e.b)&&(this.settingColor={r:e.r,g:e.g,b:e.b})}},{key:"setContext",value:function(e){this.context=e}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setSpacing",value:function(e){this.settingSpacing=e}},{key:"sizePressure",value:function(e){this.settingHasSizePressure=e}},{key:"opacityPressure",value:function(e){this.settingHasOpacityPressure=e}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"getSpacing",value:function(){return this.settingSpacing}},{key:"getSize",value:function(){return this.settingSize}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$348fcce123898af9$export$38b08aa4ea8f61c6=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.context={},this.settingColor={},this.settingSize=.25,this.settingOpacity=1,this.settingLockLayerAlpha=!1,this.settingIsEraser=!1,this.settingMode="fill",this.settingDistort=0,this.settingXSymmetry=!1,this.settingYSymmetry=!1,this.settingGradient=!1,this.isDrawing=!1,this.klHistory={},this.copyCanvas={},this.path=[],this.minY=0,this.maxY=0}return(0,$7h4XF._)(e,[{key:"updateCompleteRedrawBounds",value:function(e,t){var i={x1:e,y1:t,x2:e,y2:t};this.settingXSymmetry&&(i=$eWjiX.BB.updateBounds(i,{x1:-e+this.copyCanvas.width,y1:t,x2:-e+this.copyCanvas.width,y2:t})),this.settingYSymmetry&&(i=$eWjiX.BB.updateBounds(i,{x1:e,y1:-t+this.copyCanvas.height,x2:e,y2:-t+this.copyCanvas.height}));var n="stroke"===this.settingMode?this.settingSize+1:1;i.x1=Math.floor(i.x1-n),i.y1=Math.floor(i.y1-n),i.x2=Math.ceil(i.x2+n),i.y2=Math.ceil(i.y2+n),this.completeRedrawBounds=$eWjiX.BB.updateBounds(this.completeRedrawBounds,i)}},{key:"drawShape",value:function(){var e=this;this.context.save(),this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.drawImage(this.copyCanvas,0,0),this.selectionPath&&this.context.clip(this.selectionPath);var t=(0,$cL71g._)({},this.settingColor);if(this.settingIsEraser?(t.r=$00f785a5ea9e210d$export$e4203cb02d5e5b28,t.g=$00f785a5ea9e210d$export$e4203cb02d5e5b28,t.b=$00f785a5ea9e210d$export$e4203cb02d5e5b28,this.settingLockLayerAlpha?this.context.globalCompositeOperation="source-atop":this.context.globalCompositeOperation="destination-out"):this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),this.path.length>1){var i=new Path2D;this.path.forEach(function(e,t){0===t?i.moveTo(e.x,e.y):i.lineTo(e.x,e.y)});var n=$eWjiX.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:this.settingOpacity});if(this.settingGradient){var r=this.path[0].x>this.path[this.path.length-1].x,a=this.context.createLinearGradient(0,r?this.minY:this.maxY,0,r?this.maxY:this.minY);a.addColorStop(0,$eWjiX.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:this.settingOpacity})),a.addColorStop(1,$eWjiX.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:0})),n=a}"fill"===this.settingMode?this.context.fillStyle=n:(this.context.lineWidth=2*this.settingSize,this.context.lineJoin="bevel",this.context.strokeStyle=n);var s=function(){"fill"===e.settingMode?e.context.fill(i):e.context.stroke(i)};s(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,0),this.context.scale(-1,1),this.context.translate(-this.context.canvas.width/2,0),s(),this.context.restore()),this.settingYSymmetry&&(this.context.save(),this.context.translate(0,this.context.canvas.height/2),this.context.scale(1,-1),this.context.translate(0,-this.context.canvas.height/2),s(),this.context.restore(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,this.context.canvas.height/2),this.context.scale(-1,-1),this.context.translate(-this.context.canvas.width/2,-this.context.canvas.height/2),s(),this.context.restore()))}this.context.restore()}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"getSize",value:function(){return"stroke"===this.settingMode?this.settingSize:0}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setColor",value:function(e){this.settingColor=$eWjiX.BB.copyObj(e)}},{key:"setContext",value:function(e){this.context=e}},{key:"setMode",value:function(e){this.settingMode=e}},{key:"getMode",value:function(){return this.settingMode}},{key:"setDistort",value:function(e){this.settingDistort=$eWjiX.BB.clamp(e,0,1)}},{key:"getDistort",value:function(){return this.settingDistort}},{key:"setXSymmetry",value:function(e){this.settingXSymmetry=e}},{key:"getXSymmetry",value:function(){return this.settingXSymmetry}},{key:"setYSymmetry",value:function(e){this.settingYSymmetry=e}},{key:"getYSymmetry",value:function(){return this.settingYSymmetry}},{key:"setGradient",value:function(e){this.settingGradient=e}},{key:"getGradient",value:function(){return this.settingGradient}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"getIsEraser",value:function(){return this.settingIsEraser}},{key:"setIsEraser",value:function(e){this.settingIsEraser=e}},{key:"getIsDrawing",value:function(){return this.isDrawing}},{key:"startLine",value:function(e,t){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.isDrawing=!0,this.path=[{x:e,y:t}],this.minY=t,this.maxY=t,this.copyCanvas=$eWjiX.BB.canvas(this.context.canvas.width,this.context.canvas.height),$eWjiX.BB.ctx(this.copyCanvas).drawImage(this.context.canvas,0,0),this.completeRedrawBounds=void 0,this.updateCompleteRedrawBounds(e,t)}},{key:"goLine",value:function(e,t){if(this.isDrawing){var i={x:e,y:t};this.settingDistort>0&&(i.x+=(Math.random()-.5)*this.settingDistort*80,i.y+=(Math.random()-.5)*this.settingDistort*80),this.minY=Math.min(this.minY,i.y),this.maxY=Math.max(this.maxY,i.y),this.path.push(i),this.updateCompleteRedrawBounds(e,t),this.drawShape()}}},{key:"endLine",value:function(){if(this.isDrawing=!1,this.completeRedrawBounds=$eWjiX.BB.boundsInArea(this.completeRedrawBounds,this.copyCanvas.width,this.copyCanvas.height),this.selectionBounds&&(this.completeRedrawBounds=(0,$eg83P.boundsOverlap)(this.completeRedrawBounds,this.selectionBounds)),this.path.length>1&&this.completeRedrawBounds){var e=$1a6c9997bc8182ff$export$7b1ba44282f9a519(this.context.canvas,this.completeRedrawBounds);this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),e))}this.path=[],this.copyCanvas={}}},{key:"drawLineSegment",value:function(e,t,i,n){}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$9b3eo=parcelRequire("9b3eo"),$eg83P=parcelRequire("eg83P"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$6dc45f7ab9b94c34$export$4a278486528d5cfb="generated",$6dc45f7ab9b94c34$export$9ffd73c9a0e32c34="pointerdown",$6dc45f7ab9b94c34$export$9fb0268ce1bdbca0="pointerup",$6dc45f7ab9b94c34$export$f4b184a85a586f8a="pointerleave",$6dc45f7ab9b94c34$export$55cc1d6a692feb2b="pointerout",$6dc45f7ab9b94c34$export$1ffe551d7d33cd33="pointermove",$6dc45f7ab9b94c34$export$d5353b6c79bbcc70="touchstart",$6dc45f7ab9b94c34$export$11164630b85c192d="touchend",$6dc45f7ab9b94c34$export$d28a82874c0e6212="touchmove",$6dc45f7ab9b94c34$export$65db1c69591947a7="touchcancel",$6dc45f7ab9b94c34$export$8b3d73c91cd7cc65="resize",$6dc45f7ab9b94c34$export$73536144dc68dd0f="visibilitychange",$6dc45f7ab9b94c34$export$adea4917e02d93dc="tsParticles - Error",$6dc45f7ab9b94c34$export$9519bca7a9fbeccd=100,$6dc45f7ab9b94c34$export$3ced024fb15e6103=.5,$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f=1e3,$6dc45f7ab9b94c34$export$8a573f14667e8170={x:0,y:0,z:0},$6dc45f7ab9b94c34$export$d8a7bebef127c134={a:1,b:0,c:0,d:1},$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb="random",$6dc45f7ab9b94c34$export$7b5f45763ca224ae="mid",$6dc45f7ab9b94c34$export$7b3cbda67be88f5f=2,$6dc45f7ab9b94c34$export$99aad4f300723eb5=Math.PI*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f,$6dc45f7ab9b94c34$export$a58a85a1d96b5da5=60,$6dc45f7ab9b94c34$export$f13166301dffe8fb=1,$6dc45f7ab9b94c34$export$f4379e05d59339d2="true",$6dc45f7ab9b94c34$export$c392cf7a2bd47e88="false",$6dc45f7ab9b94c34$export$af8f840c6caca708="canvas",$6dc45f7ab9b94c34$export$b0d937bb246b1db5=0,$6dc45f7ab9b94c34$export$69af1894d00750e2=2,$6dc45f7ab9b94c34$export$ff9931f04b025271=4,$6dc45f7ab9b94c34$export$1f93977e73a42602=1,$6dc45f7ab9b94c34$export$728175ae61348876=1,$6dc45f7ab9b94c34$export$7e2d520c66b9f331=1,$6dc45f7ab9b94c34$export$857680dbc0592f23=4,$6dc45f7ab9b94c34$export$6a43a0894b8f8dd4=1,$6dc45f7ab9b94c34$export$7bf8bd2b1c3673be=255,$6dc45f7ab9b94c34$export$80d6dd9687da66fc=360,$6dc45f7ab9b94c34$export$d6110320394e154a=100,$6dc45f7ab9b94c34$export$9f8a886f88503d81=100,$6dc45f7ab9b94c34$export$59af4a43228d42f9=0,$6dc45f7ab9b94c34$export$6d036dc8238eb540=0,$6dc45f7ab9b94c34$export$4639db465b79e483=60,$6dc45f7ab9b94c34$export$6e22c362a0406a2c=0,$6dc45f7ab9b94c34$export$813f5834b9d5379d=.25,$6dc45f7ab9b94c34$export$9f9801c27507097c=$6dc45f7ab9b94c34$export$3ced024fb15e6103+$6dc45f7ab9b94c34$export$813f5834b9d5379d,$6dc45f7ab9b94c34$export$82701eab16caadaa=0,$6dc45f7ab9b94c34$export$1f10c01143b9f089=1,$6dc45f7ab9b94c34$export$4b0ea52aa81e1ca2=0,$6dc45f7ab9b94c34$export$920ec94752436dad=0,$6dc45f7ab9b94c34$export$6ca59ab71c007a1b=1,$6dc45f7ab9b94c34$export$7395e4cb572e863b=1,$6dc45f7ab9b94c34$export$ed597c6eb324bc8f=1,$6dc45f7ab9b94c34$export$7a917036bd0c18e0=1,$6dc45f7ab9b94c34$export$17c6bab6aae4c3d=0,$6dc45f7ab9b94c34$export$310c6557edf6330f=1,$6dc45f7ab9b94c34$export$6347387141f4c7b9=0,$6dc45f7ab9b94c34$export$a1db07711c3c21cf=120,$6dc45f7ab9b94c34$export$1f9ec247b9f4a442=0,$6dc45f7ab9b94c34$export$878d5c9fc03f6a6f=0,$6dc45f7ab9b94c34$export$d20f7c11146fd35=1e4,$6dc45f7ab9b94c34$export$a0a8145c86a935c7=0,$6dc45f7ab9b94c34$export$80bf7733f1207381=1,$6dc45f7ab9b94c34$export$f883a24d5edde77c=0,$6dc45f7ab9b94c34$export$a05b467d53228ab9=1,$6dc45f7ab9b94c34$export$c6a00718c1294b26=1,$6dc45f7ab9b94c34$export$9ad4c81d91619fd0=0,$6dc45f7ab9b94c34$export$40d4bf4da5fab6a3=1,$6dc45f7ab9b94c34$export$ce94e349d95a214c=0,$6dc45f7ab9b94c34$export$7dab3a147ef97e31=0,$6dc45f7ab9b94c34$export$3824525d016aa873=-$6dc45f7ab9b94c34$export$813f5834b9d5379d,$6dc45f7ab9b94c34$export$59892a8b616aa484=1.5,$6dc45f7ab9b94c34$export$e82fde291e144b99=0,$6dc45f7ab9b94c34$export$1fe1264f46963094=1,$6dc45f7ab9b94c34$export$da4e5697b3441fa1=0,$6dc45f7ab9b94c34$export$e410eba367ce792b=0,$6dc45f7ab9b94c34$export$1d2b1c0c1b891aba=0,$6dc45f7ab9b94c34$export$4a5b9680be542cf8=1,$6dc45f7ab9b94c34$export$9b262e3383f198e7=1,$6dc45f7ab9b94c34$export$346cdd8493ece6c8=1,$6dc45f7ab9b94c34$export$a31a053ae1bfc10e=500,$6dc45f7ab9b94c34$export$d4e77d4b7e9933c7=50,$6dc45f7ab9b94c34$export$573f1d3d887db8cc=0,$6dc45f7ab9b94c34$export$f0954fd7d5368655=1,$6dc45f7ab9b94c34$export$1f010363d1c40031=0,$6dc45f7ab9b94c34$export$6438bad23c977d39=1,$6dc45f7ab9b94c34$export$42fd2de68d60a133=0,$6dc45f7ab9b94c34$export$15b8ea3279320e86=255,$6dc45f7ab9b94c34$export$515818ff8d37c07d=3,$6dc45f7ab9b94c34$export$7a7038229fab314f=6,$6dc45f7ab9b94c34$export$43104ff2632aa202=1,$6dc45f7ab9b94c34$export$af5f0fbc6d135058=1,$6dc45f7ab9b94c34$export$d13fc714138cfb02=0,$6dc45f7ab9b94c34$export$2d575d8dbe8cd673=0,$6dc45f7ab9b94c34$export$ac39eb160969ecba=0,$6dc45f7ab9b94c34$export$7c140f4e42af7fd8=0,$1LaJZ=parcelRequire("1LaJZ");function $6fba4c4f31406386$export$71511d61b312f219(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}function $77128dc31437e3a5$export$71511d61b312f219(e,t){if(null==e)return{};var i,n,r=$6fba4c4f31406386$export$71511d61b312f219(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var $bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3");!function(e){e.bottom="bottom",e.bottomLeft="bottom-left",e.bottomRight="bottom-right",e.left="left",e.none="none",e.right="right",e.top="top",e.topLeft="top-left",e.topRight="top-right",e.outside="outside",e.inside="inside"}($e304e157140fab16$export$cc1a246adca07dd4||($e304e157140fab16$export$cc1a246adca07dd4={}));var $fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$9xmuV=parcelRequire("9xmuV");function $e55b0963af399424$export$f9ce7b637dfbe238(e){return"boolean"==typeof e}function $e55b0963af399424$export$844ec244b1367d54(e){return"string"==typeof e}function $e55b0963af399424$export$7e4aa119212bc614(e){return"number"==typeof e}function $e55b0963af399424$export$f6e2535fb5126e54(e){return"function"==typeof e}function $e55b0963af399424$export$a6cdc56e425d0d0a(e){return"object"==typeof e&&null!==e}function $e55b0963af399424$export$43bee75e5e14138e(e){return Array.isArray(e)}function $e55b0963af399424$export$630801d484da15df(e){return null==e}var $608fa043a85a8aae$export$ece015703618ce3d=function(){"use strict";function e(t,i,n){var r=this;if((0,$cx0mh._)(this,e),this._updateFromAngle=function(e,t){r.x=Math.cos(e)*t,r.y=Math.sin(e)*t},!$e55b0963af399424$export$7e4aa119212bc614(t)&&t){this.x=t.x,this.y=t.y;var a=t;this.z=a.z?a.z:$6dc45f7ab9b94c34$export$8a573f14667e8170.z}else if(void 0!==t&&void 0!==i)this.x=t,this.y=i,this.z=null!=n?n:$6dc45f7ab9b94c34$export$8a573f14667e8170.z;else throw Error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} Vector3d not initialized correctly`)}return(0,$7h4XF._)(e,[{key:"angle",get:function(){return Math.atan2(this.y,this.x)},set:function(e){this._updateFromAngle(e,this.length)}},{key:"length",get:function(){return Math.sqrt(this.getLengthSq())},set:function(e){this._updateFromAngle(this.angle,e)}},{key:"add",value:function(t){return e.create(this.x+t.x,this.y+t.y,this.z+t.z)}},{key:"addTo",value:function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}},{key:"copy",value:function(){return e.clone(this)}},{key:"distanceTo",value:function(e){return this.sub(e).length}},{key:"distanceToSq",value:function(e){return this.sub(e).getLengthSq()}},{key:"div",value:function(t){return e.create(this.x/t,this.y/t,this.z/t)}},{key:"divTo",value:function(e){this.x/=e,this.y/=e,this.z/=e}},{key:"getLengthSq",value:function(){return Math.pow(this.x,$6dc45f7ab9b94c34$export$69af1894d00750e2)+Math.pow(this.y,$6dc45f7ab9b94c34$export$69af1894d00750e2)}},{key:"mult",value:function(t){return e.create(this.x*t,this.y*t,this.z*t)}},{key:"multTo",value:function(e){this.x*=e,this.y*=e,this.z*=e}},{key:"normalize",value:function(){var e=this.length;e!=$6dc45f7ab9b94c34$export$f883a24d5edde77c&&this.multTo($6dc45f7ab9b94c34$export$6a43a0894b8f8dd4/e)}},{key:"rotate",value:function(t){return e.create(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t),$6dc45f7ab9b94c34$export$8a573f14667e8170.z)}},{key:"setTo",value:function(e){this.x=e.x,this.y=e.y;var t=e;this.z=t.z?t.z:$6dc45f7ab9b94c34$export$8a573f14667e8170.z}},{key:"sub",value:function(t){return e.create(this.x-t.x,this.y-t.y,this.z-t.z)}},{key:"subFrom",value:function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}],[{key:"origin",get:function(){return e.create($6dc45f7ab9b94c34$export$8a573f14667e8170.x,$6dc45f7ab9b94c34$export$8a573f14667e8170.y,$6dc45f7ab9b94c34$export$8a573f14667e8170.z)}},{key:"clone",value:function(t){return e.create(t.x,t.y,t.z)}},{key:"create",value:function(t,i,n){return new e(t,i,n)}}]),e}(),$608fa043a85a8aae$export$9b781de7bf37bf48=function(e){"use strict";function t(e,i){return(0,$cx0mh._)(this,t),(0,$fFwUa._)(this,t,[e,i,$6dc45f7ab9b94c34$export$8a573f14667e8170.z])}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,null,[{key:"origin",get:function(){return t.create($6dc45f7ab9b94c34$export$8a573f14667e8170.x,$6dc45f7ab9b94c34$export$8a573f14667e8170.y)}},{key:"clone",value:function(e){return t.create(e.x,e.y)}},{key:"create",value:function(e,i){return new t(e,i)}}]),t}($608fa043a85a8aae$export$ece015703618ce3d),$e8499b8b34df9b2a$var$_random=Math.random,$e8499b8b34df9b2a$var$_animationLoop={nextFrame:function(e){return requestAnimationFrame(e)},cancel:function(e){return cancelAnimationFrame(e)}};function $e8499b8b34df9b2a$export$3ba5cb2c014ef7d5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;$e8499b8b34df9b2a$var$_random=e}function $e8499b8b34df9b2a$export$1a76347094524b3b(){var e=0,t=1;return $e8499b8b34df9b2a$export$7d15b64cf5a3a4c4($e8499b8b34df9b2a$var$_random(),e,t-Number.EPSILON)}function $e8499b8b34df9b2a$export$f39283481a75bc14(e,t){$e8499b8b34df9b2a$var$_animationLoop.nextFrame=function(t){return e(t)},$e8499b8b34df9b2a$var$_animationLoop.cancel=function(e){return t(e)}}function $e8499b8b34df9b2a$export$e3607ec2d7a891c4(e){return $e8499b8b34df9b2a$var$_animationLoop.nextFrame(e)}function $e8499b8b34df9b2a$export$623ab1da75e685de(e){$e8499b8b34df9b2a$var$_animationLoop.cancel(e)}function $e8499b8b34df9b2a$export$7d15b64cf5a3a4c4(e,t,i){return Math.min(Math.max(e,t),i)}function $e8499b8b34df9b2a$export$2c9e8a9632a706b2(e,t,i,n){return Math.floor((e*i+t*n)/(i+n))}function $e8499b8b34df9b2a$export$8b958c8ecd94a804(e){var t=$e8499b8b34df9b2a$export$27d2c76f835d583d(e),i=0,n=$e8499b8b34df9b2a$export$71c94d28c0fa4bfe(e);return t===n&&(n=i),$e8499b8b34df9b2a$export$1a76347094524b3b()*(t-n)+n}function $e8499b8b34df9b2a$export$e70c64b68236cb4e(e){return $e55b0963af399424$export$7e4aa119212bc614(e)?e:$e8499b8b34df9b2a$export$8b958c8ecd94a804(e)}function $e8499b8b34df9b2a$export$71c94d28c0fa4bfe(e){return $e55b0963af399424$export$7e4aa119212bc614(e)?e:e.min}function $e8499b8b34df9b2a$export$27d2c76f835d583d(e){return $e55b0963af399424$export$7e4aa119212bc614(e)?e:e.max}function $e8499b8b34df9b2a$export$6dcd5a07b989db7(e,t){if(e===t||void 0===t&&$e55b0963af399424$export$7e4aa119212bc614(e))return e;var i=$e8499b8b34df9b2a$export$71c94d28c0fa4bfe(e),n=$e8499b8b34df9b2a$export$27d2c76f835d583d(e);return void 0!==t?{min:Math.min(i,t),max:Math.max(n,t)}:$e8499b8b34df9b2a$export$6dcd5a07b989db7(i,n)}function $e8499b8b34df9b2a$export$c76b58cfe053f228(e,t){var i=e.x-t.x,n=e.y-t.y;return{dx:i,dy:n,distance:Math.sqrt(Math.pow(i,2)+Math.pow(n,2))}}function $e8499b8b34df9b2a$export$79376507b09a66f(e,t){return $e8499b8b34df9b2a$export$c76b58cfe053f228(e,t).distance}function $e8499b8b34df9b2a$export$e6bfdeff8bfc94f9(e){return e*Math.PI/180}function $e8499b8b34df9b2a$export$2045f76df51d18c4(e,t,i){if($e55b0963af399424$export$7e4aa119212bc614(e))return $e8499b8b34df9b2a$export$e6bfdeff8bfc94f9(e);switch(e){case $e304e157140fab16$export$cc1a246adca07dd4.top:return-Math.PI*$6dc45f7ab9b94c34$export$3ced024fb15e6103;case $e304e157140fab16$export$cc1a246adca07dd4.topRight:return-Math.PI*$6dc45f7ab9b94c34$export$813f5834b9d5379d;case $e304e157140fab16$export$cc1a246adca07dd4.right:return $6dc45f7ab9b94c34$export$6e22c362a0406a2c;case $e304e157140fab16$export$cc1a246adca07dd4.bottomRight:return Math.PI*$6dc45f7ab9b94c34$export$813f5834b9d5379d;case $e304e157140fab16$export$cc1a246adca07dd4.bottom:return Math.PI*$6dc45f7ab9b94c34$export$3ced024fb15e6103;case $e304e157140fab16$export$cc1a246adca07dd4.bottomLeft:return Math.PI*$6dc45f7ab9b94c34$export$9f9801c27507097c;case $e304e157140fab16$export$cc1a246adca07dd4.left:return Math.PI;case $e304e157140fab16$export$cc1a246adca07dd4.topLeft:return-Math.PI*$6dc45f7ab9b94c34$export$9f9801c27507097c;case $e304e157140fab16$export$cc1a246adca07dd4.inside:return Math.atan2(i.y-t.y,i.x-t.x);case $e304e157140fab16$export$cc1a246adca07dd4.outside:return Math.atan2(t.y-i.y,t.x-i.x);default:return $e8499b8b34df9b2a$export$1a76347094524b3b()*$6dc45f7ab9b94c34$export$99aad4f300723eb5}}function $e8499b8b34df9b2a$export$cce6f12debc4024a(e){var t=$608fa043a85a8aae$export$9b781de7bf37bf48.origin;return t.length=1,t.angle=e,t}function $e8499b8b34df9b2a$export$ee2fb97c67882d88(e,t,i,n){return $608fa043a85a8aae$export$9b781de7bf37bf48.create(e.x*(i-n)/(i+n)+t.x*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*n/(i+n),e.y)}function $e8499b8b34df9b2a$export$3cb8a699840fed18(e){var t;return(null==(t=e.position)?void 0:t.x)!==void 0&&void 0!==e.position.y?{x:e.position.x*e.size.width/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd,y:e.position.y*e.size.height/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd}:void 0}function $e8499b8b34df9b2a$export$b19bedb83d642783(e){var t,i,n,r;return{x:(null!=(n=null==(t=e.position)?void 0:t.x)?n:$e8499b8b34df9b2a$export$1a76347094524b3b()*$6dc45f7ab9b94c34$export$9519bca7a9fbeccd)*e.size.width/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd,y:(null!=(r=null==(i=e.position)?void 0:i.y)?r:$e8499b8b34df9b2a$export$1a76347094524b3b()*$6dc45f7ab9b94c34$export$9519bca7a9fbeccd)*e.size.height/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd}}function $e8499b8b34df9b2a$export$b6e437e0d75e3d2c(e){var t,i,n={x:(null==(t=e.position)?void 0:t.x)!==void 0?$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.position.x):void 0,y:(null==(i=e.position)?void 0:i.y)!==void 0?$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.position.y):void 0};return $e8499b8b34df9b2a$export$b19bedb83d642783({size:e.size,position:n})}function $e8499b8b34df9b2a$export$a3c87c98a736c457(e){var t,i,n,r;return{x:null!=(n=null==(t=e.position)?void 0:t.x)?n:$e8499b8b34df9b2a$export$1a76347094524b3b()*e.size.width,y:null!=(r=null==(i=e.position)?void 0:i.y)?r:$e8499b8b34df9b2a$export$1a76347094524b3b()*e.size.height}}function $e8499b8b34df9b2a$export$30970e96ab2e23ee(e){var t,i,n={x:(null==(t=e.position)?void 0:t.x)!==void 0?$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.position.x):void 0,y:(null==(i=e.position)?void 0:i.y)!==void 0?$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.position.y):void 0};return $e8499b8b34df9b2a$export$a3c87c98a736c457({size:e.size,position:n})}function $e8499b8b34df9b2a$export$988633967de92230(e){var t=1;return e?e.endsWith("%")?parseFloat(e)/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd:parseFloat(e):t}!function(e){e.auto="auto",e.increase="increase",e.decrease="decrease",e.random="random"}($6d7e036695a5135c$export$6bf57c7f0219f07d||($6d7e036695a5135c$export$6bf57c7f0219f07d={})),function(e){e.increasing="increasing",e.decreasing="decreasing"}($d0eaf415184a9ac7$export$a2d3d93c57d16a1a||($d0eaf415184a9ac7$export$a2d3d93c57d16a1a={})),function(e){e.none="none",e.max="max",e.min="min"}($1f208ea7a7967b27$export$41a461248611663e||($1f208ea7a7967b27$export$41a461248611663e={})),function(e){e.bottom="bottom",e.left="left",e.right="right",e.top="top"}($d23dd65cd1a3f1f7$export$56c1e4693edf08f9||($d23dd65cd1a3f1f7$export$56c1e4693edf08f9={})),function(e){e.precise="precise",e.percent="percent"}($e2421ddcce10c8e2$export$1009f0178778a981||($e2421ddcce10c8e2$export$1009f0178778a981={})),function(e){e.max="max",e.min="min",e.random="random"}($a78ee5b112786af3$export$5385b9a82993d2c8||($a78ee5b112786af3$export$5385b9a82993d2c8={}));var $45e196d141848e3a$var$_logger={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function $45e196d141848e3a$export$3abbd92f765bee58(e){$45e196d141848e3a$var$_logger.debug=e.debug||$45e196d141848e3a$var$_logger.debug,$45e196d141848e3a$var$_logger.error=e.error||$45e196d141848e3a$var$_logger.error,$45e196d141848e3a$var$_logger.info=e.info||$45e196d141848e3a$var$_logger.info,$45e196d141848e3a$var$_logger.log=e.log||$45e196d141848e3a$var$_logger.log,$45e196d141848e3a$var$_logger.verbose=e.verbose||$45e196d141848e3a$var$_logger.verbose,$45e196d141848e3a$var$_logger.warning=e.warning||$45e196d141848e3a$var$_logger.warning}function $45e196d141848e3a$export$2b1d391cd05230fd(){return $45e196d141848e3a$var$_logger}function $45e196d141848e3a$var$memoize(e){var t=new Map;return function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var a=JSON.stringify(n);if(t.has(a))return t.get(a);var s=e.apply(void 0,(0,$bX4ja._)(n));return t.set(a,s),s}}function $45e196d141848e3a$var$rectSideBounce(e){var t={bounced:!1},i=e.pSide,n=e.pOtherSide,r=e.rectSide,a=e.rectOtherSide,s=e.velocity,o=e.factor;return n.min<a.min||n.min>a.max||n.max<a.min||n.max>a.max||(i.max>=r.min&&i.max<=(r.max+r.min)*$6dc45f7ab9b94c34$export$3ced024fb15e6103&&s>$6dc45f7ab9b94c34$export$82701eab16caadaa||i.min<=r.max&&i.min>(r.max+r.min)*$6dc45f7ab9b94c34$export$3ced024fb15e6103&&s<$6dc45f7ab9b94c34$export$82701eab16caadaa)&&(t.velocity=-(s*o),t.bounced=!0),t}function $45e196d141848e3a$var$checkSelector(e,t){var i=$45e196d141848e3a$export$8e5dc47097396754(t,function(t){return e.matches(t)});return $e55b0963af399424$export$43bee75e5e14138e(i)?i.some(function(e){return e}):i}function $45e196d141848e3a$export$460b6777813d3d86(){return"undefined"==typeof window||!window||void 0===window.document||!window.document}function $45e196d141848e3a$export$c242851ed0beda6c(){return!$45e196d141848e3a$export$460b6777813d3d86()&&"undefined"!=typeof matchMedia}function $45e196d141848e3a$export$db32b9574e21e00f(e){if($45e196d141848e3a$export$c242851ed0beda6c())return matchMedia(e)}function $45e196d141848e3a$export$d97d2a93dce76cc2(e){if(!$45e196d141848e3a$export$460b6777813d3d86()&&"undefined"!=typeof IntersectionObserver)return new IntersectionObserver(e)}function $45e196d141848e3a$export$c2f9084a48da0641(e){if(!$45e196d141848e3a$export$460b6777813d3d86()&&"undefined"!=typeof MutationObserver)return new MutationObserver(e)}function $45e196d141848e3a$export$5e9bb4359042e24b(e,t){var i=-1;return e===t||$e55b0963af399424$export$43bee75e5e14138e(t)&&t.indexOf(e)>i}function $45e196d141848e3a$export$672089c3debc1182(e,t){return(0,$1LaJZ._)(function(){var i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,document.fonts.load(`${null!=t?t:"400"} 36px '${null!=e?e:"Verdana"}'`)];case 1:return n.sent(),[3,3];case 2:return i=n.sent(),[3,3];case 3:return[2]}})})()}function $45e196d141848e3a$export$aab6d48e027939d7(e){return Math.floor($e8499b8b34df9b2a$export$1a76347094524b3b()*e.length)}function $45e196d141848e3a$export$3a5d12ca7137122f(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return e[void 0!==t&&i?t%e.length:$45e196d141848e3a$export$aab6d48e027939d7(e)]}function $45e196d141848e3a$export$2ea42ef493c7076c(e,t,i,n,r){var a=0;return $45e196d141848e3a$export$bb47d4799bdb9a4d($45e196d141848e3a$export$b0a2169b5f9d18d8(e,null!=n?n:a),t,i,r)}function $45e196d141848e3a$export$bb47d4799bdb9a4d(e,t,i,n){var r=!0;return n&&n!==$d23dd65cd1a3f1f7$export$56c1e4693edf08f9.bottom||(r=e.top<t.height+i.x),r&&(!n||n===$d23dd65cd1a3f1f7$export$56c1e4693edf08f9.left)&&(r=e.right>i.x),r&&(!n||n===$d23dd65cd1a3f1f7$export$56c1e4693edf08f9.right)&&(r=e.left<t.width+i.y),r&&(!n||n===$d23dd65cd1a3f1f7$export$56c1e4693edf08f9.top)&&(r=e.bottom>i.y),r}function $45e196d141848e3a$export$b0a2169b5f9d18d8(e,t){return{bottom:e.y+t,left:e.x-t,right:e.x+t,top:e.y-t}}function $45e196d141848e3a$export$54e9fb29908872fa(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=!0,a=!1,s=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=function(t){if("__proto__"===t)return"continue";var i=c[t],n=e;n[t]=$e55b0963af399424$export$a6cdc56e425d0d0a(i)&&Array.isArray(i)?i.map(function(e){return $45e196d141848e3a$export$54e9fb29908872fa(n[t],e)}):$45e196d141848e3a$export$54e9fb29908872fa(n[t],i)},c=o.value;if(null!=c){if(!$e55b0963af399424$export$a6cdc56e425d0d0a(c)){e=c;continue}var u=Array.isArray(c);for(var d in u&&($e55b0963af399424$export$a6cdc56e425d0d0a(e)||!e||!Array.isArray(e))?e=[]:!u&&($e55b0963af399424$export$a6cdc56e425d0d0a(e)||!e||Array.isArray(e))&&(e={}),c)h(d)}}}catch(e){a=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}return e}function $45e196d141848e3a$export$5d1f020956707f4(e,t){return!!$45e196d141848e3a$export$bfd133b0f67a5a3a(t,function(t){return t.enable&&$45e196d141848e3a$export$5e9bb4359042e24b(e,t.mode)})}function $45e196d141848e3a$export$194f9554360903fd(e,t,i){$45e196d141848e3a$export$8e5dc47097396754(t,function(t){var n=t.mode;t.enable&&$45e196d141848e3a$export$5e9bb4359042e24b(e,n)&&$45e196d141848e3a$export$921eaa53ee8b79db(t,i)})}function $45e196d141848e3a$export$921eaa53ee8b79db(e,t){$45e196d141848e3a$export$8e5dc47097396754(e.selectors,function(i){t(i,e)})}function $45e196d141848e3a$export$f7c2b83aad443adb(e,t){if(t&&e)return $45e196d141848e3a$export$bfd133b0f67a5a3a(e,function(e){return $45e196d141848e3a$var$checkSelector(t,e.selectors)})}function $45e196d141848e3a$export$11ae16f2acc5c3ba(e){return{position:e.getPosition(),radius:e.getRadius(),mass:e.getMass(),velocity:e.velocity,factor:$608fa043a85a8aae$export$9b781de7bf37bf48.create($e8499b8b34df9b2a$export$e70c64b68236cb4e(e.options.bounce.horizontal.value),$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.options.bounce.vertical.value))}}function $45e196d141848e3a$export$c6e9f28fb57ea828(e,t){var i=e.velocity.sub(t.velocity),n=i.x,r=i.y,a=[e.position,t.position],s=a[0],o=$e8499b8b34df9b2a$export$c76b58cfe053f228(a[1],s),l=o.dx,h=o.dy;if(!(n*l+r*h<0)){var c=-Math.atan2(h,l),u=e.mass,d=t.mass,p=e.velocity.rotate(c),f=t.velocity.rotate(c),g=$e8499b8b34df9b2a$export$ee2fb97c67882d88(p,f,u,d),v=$e8499b8b34df9b2a$export$ee2fb97c67882d88(f,p,u,d),m=g.rotate(-c),y=v.rotate(-c);e.velocity.x=m.x*e.factor.x,e.velocity.y=m.y*e.factor.y,t.velocity.x=y.x*t.factor.x,t.velocity.y=y.y*t.factor.y}}function $45e196d141848e3a$export$e83851ba31840182(e,t){var i=$45e196d141848e3a$export$b0a2169b5f9d18d8(e.getPosition(),e.getRadius()),n=e.options.bounce,r=$45e196d141848e3a$var$rectSideBounce({pSide:{min:i.left,max:i.right},pOtherSide:{min:i.top,max:i.bottom},rectSide:{min:t.left,max:t.right},rectOtherSide:{min:t.top,max:t.bottom},velocity:e.velocity.x,factor:$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.horizontal.value)});r.bounced&&(void 0!==r.velocity&&(e.velocity.x=r.velocity),void 0!==r.position&&(e.position.x=r.position));var a=$45e196d141848e3a$var$rectSideBounce({pSide:{min:i.top,max:i.bottom},pOtherSide:{min:i.left,max:i.right},rectSide:{min:t.top,max:t.bottom},rectOtherSide:{min:t.left,max:t.right},velocity:e.velocity.y,factor:$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.vertical.value)});a.bounced&&(void 0!==a.velocity&&(e.velocity.y=a.velocity),void 0!==a.position&&(e.position.y=a.position))}function $45e196d141848e3a$export$8e5dc47097396754(e,t){var i=0;return $e55b0963af399424$export$43bee75e5e14138e(e)?e.map(function(e,i){return t(e,i)}):t(e,i)}function $45e196d141848e3a$export$3fbf39566d3ee62e(e,t,i){return $e55b0963af399424$export$43bee75e5e14138e(e)?$45e196d141848e3a$export$3a5d12ca7137122f(e,t,i):e}function $45e196d141848e3a$export$bfd133b0f67a5a3a(e,t){return $e55b0963af399424$export$43bee75e5e14138e(e)?e.find(function(e,i){return t(e,i)}):t(e,0)?e:void 0}function $45e196d141848e3a$export$bebd78259cce4fd(e,t){var i=e.value,n=e.animation,r={delayTime:$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.delay)*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f,enable:n.enable,value:$e8499b8b34df9b2a$export$e70c64b68236cb4e(e.value)*t,max:$e8499b8b34df9b2a$export$27d2c76f835d583d(i)*t,min:$e8499b8b34df9b2a$export$71c94d28c0fa4bfe(i)*t,loops:0,maxLoops:$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.count),time:0},a=1;if(n.enable){switch(r.decay=a-$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.decay),n.mode){case $6d7e036695a5135c$export$6bf57c7f0219f07d.increase:r.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing;break;case $6d7e036695a5135c$export$6bf57c7f0219f07d.decrease:r.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing;break;case $6d7e036695a5135c$export$6bf57c7f0219f07d.random:r.status=$e8499b8b34df9b2a$export$1a76347094524b3b()>=$6dc45f7ab9b94c34$export$3ced024fb15e6103?$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing:$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing}var s=n.mode===$6d7e036695a5135c$export$6bf57c7f0219f07d.auto;switch(n.startValue){case $a78ee5b112786af3$export$5385b9a82993d2c8.min:r.value=r.min,s&&(r.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing);break;case $a78ee5b112786af3$export$5385b9a82993d2c8.max:r.value=r.max,s&&(r.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing);break;case $a78ee5b112786af3$export$5385b9a82993d2c8.random:default:r.value=$e8499b8b34df9b2a$export$8b958c8ecd94a804(r),s&&(r.status=$e8499b8b34df9b2a$export$1a76347094524b3b()>=$6dc45f7ab9b94c34$export$3ced024fb15e6103?$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing:$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing)}}return r.initialValue=r.value,r}function $45e196d141848e3a$var$getPositionOrSize(e,t){return e.mode!==$e2421ddcce10c8e2$export$1009f0178778a981.percent?(e.mode,$77128dc31437e3a5$export$71511d61b312f219(e,["mode"])):"x"in e?{x:e.x/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd*t.width,y:e.y/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd*t.height}:{width:e.width/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd*t.width,height:e.height/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd*t.height}}function $45e196d141848e3a$export$1690e12b840569b9(e,t){return $45e196d141848e3a$var$getPositionOrSize(e,t)}function $45e196d141848e3a$export$31b21d0167753bb4(e,t){return $45e196d141848e3a$var$getPositionOrSize(e,t)}function $45e196d141848e3a$var$checkDestroy(e,t,i,n,r){switch(t){case $1f208ea7a7967b27$export$41a461248611663e.max:i>=r&&e.destroy();break;case $1f208ea7a7967b27$export$41a461248611663e.min:i<=n&&e.destroy()}}function $45e196d141848e3a$export$efead17ed5dcfd2(e,t,i,n,r){var a,s,o,l,h,c,u,d,p,f=0,g=0,v=1,m=0,y=1;if(!e.destroyed&&t&&t.enable&&(!((null!=(a=t.maxLoops)?a:f)>f)||!((null!=(s=t.loops)?s:f)>(null!=(o=t.maxLoops)?o:f)))){var x=(null!=(l=t.velocity)?l:m)*r.factor,b=t.min,w=t.max,k=null!=(h=t.decay)?h:y;if(t.time||(t.time=0),(null!=(c=t.delayTime)?c:g)>g&&t.time<(null!=(u=t.delayTime)?u:g)&&(t.time+=r.value),!((null!=(d=t.delayTime)?d:g)>g)||!(t.time<(null!=(p=t.delayTime)?p:g))){switch(t.status){case $d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing:t.value>=w?(i?t.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing:t.value-=w,t.loops||(t.loops=f),t.loops++):t.value+=x;break;case $d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing:t.value<=b?(i?t.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing:t.value+=w,t.loops||(t.loops=f),t.loops++):t.value-=x}t.velocity&&k!==v&&(t.velocity*=k),$45e196d141848e3a$var$checkDestroy(e,n,t.value,b,w),e.destroyed||(t.value=$e8499b8b34df9b2a$export$7d15b64cf5a3a4c4(t.value,b,w))}}}function $45e196d141848e3a$export$667e8f3bfe6278b7(e){var t=document.createElement("div").style;if(!e)return t;for(var i in e){var n,r,a,s,o=e[i];if(!(!Object.prototype.hasOwnProperty.call(e,i)||$e55b0963af399424$export$630801d484da15df(o))){var l=null==(n=e.getPropertyValue)?void 0:n.call(e,o);if(l){var h=null==(r=e.getPropertyPriority)?void 0:r.call(e,o);h?null==(s=t.setProperty)||s.call(t,o,l,h):null==(a=t.setProperty)||a.call(t,o,l)}}}return t}function $45e196d141848e3a$var$computeFullScreenStyle(e){var t=document.createElement("div").style,i=10,n={width:"100%",height:"100%",margin:"0",padding:"0",borderWidth:"0",position:"fixed",zIndex:e.toString(i),"z-index":e.toString(i),top:"0",left:"0"};for(var r in n){var a=n[r];t.setProperty(r,a)}return t}var $45e196d141848e3a$export$10d1829d88c10e6a=$45e196d141848e3a$var$memoize($45e196d141848e3a$var$computeFullScreenStyle),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$8N5YG=parcelRequire("8N5YG"),$2gUX3=parcelRequire("2gUX3"),$cL71g=parcelRequire("cL71g");function $7221c4a44f814a20$var$stringToRgba(e,t){if(t){var i=!0,n=!1,r=void 0;try{for(var a,s=e.colorManagers.values()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;if(t.startsWith(o.stringPrefix))return o.parseString(t)}}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}function $7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(e,t,i){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(t){var r=$e55b0963af399424$export$844ec244b1367d54(t)?{value:t}:t;if($e55b0963af399424$export$844ec244b1367d54(r.value))return $7221c4a44f814a20$export$170d64abcc52d97a(e,r.value,i,n);if($e55b0963af399424$export$43bee75e5e14138e(r.value))return $7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(e,{value:$45e196d141848e3a$export$3a5d12ca7137122f(r.value,i,n)});var a=!0,s=!1,o=void 0;try{for(var l,h=e.colorManagers.values()[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var c=l.value.handleRangeColor(r);if(c)return c}}catch(e){s=!0,o=e}finally{try{a||null==h.return||h.return()}finally{if(s)throw o}}}}function $7221c4a44f814a20$export$170d64abcc52d97a(e,t,i){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(t){var r=$e55b0963af399424$export$844ec244b1367d54(t)?{value:t}:t;if($e55b0963af399424$export$844ec244b1367d54(r.value))return r.value===$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb?$7221c4a44f814a20$export$ac4fc8e9144a1018():$7221c4a44f814a20$export$d2c5ec93815c4391(e,r.value);if($e55b0963af399424$export$43bee75e5e14138e(r.value))return $7221c4a44f814a20$export$170d64abcc52d97a(e,{value:$45e196d141848e3a$export$3a5d12ca7137122f(r.value,i,n)});var a=!0,s=!1,o=void 0;try{for(var l,h=e.colorManagers.values()[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var c=l.value.handleColor(r);if(c)return c}}catch(e){s=!0,o=e}finally{try{a||null==h.return||h.return()}finally{if(s)throw o}}}}function $7221c4a44f814a20$export$5e49d166a305dfce(e,t,i){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=$7221c4a44f814a20$export$170d64abcc52d97a(e,t,i,n);return r?$7221c4a44f814a20$export$c85ca4f4753af384(r):void 0}function $7221c4a44f814a20$export$79a89086521c0f12(e,t,i){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(e,t,i,n);return r?$7221c4a44f814a20$export$c85ca4f4753af384(r):void 0}function $7221c4a44f814a20$export$c85ca4f4753af384(e){var t=e.r/$6dc45f7ab9b94c34$export$7bf8bd2b1c3673be,i=e.g/$6dc45f7ab9b94c34$export$7bf8bd2b1c3673be,n=e.b/$6dc45f7ab9b94c34$export$7bf8bd2b1c3673be,r=Math.max(t,i,n),a=Math.min(t,i,n),s={h:$6dc45f7ab9b94c34$export$59af4a43228d42f9,l:(r+a)*$6dc45f7ab9b94c34$export$3ced024fb15e6103,s:$6dc45f7ab9b94c34$export$6d036dc8238eb540};return r!==a&&(s.s=s.l<$6dc45f7ab9b94c34$export$3ced024fb15e6103?(r-a)/(r+a):(r-a)/($6dc45f7ab9b94c34$export$7b3cbda67be88f5f-r-a),s.h=t===r?(i-n)/(r-a):s.h=i===r?$6dc45f7ab9b94c34$export$7b3cbda67be88f5f+(n-t)/(r-a):$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f+(t-i)/(r-a)),s.l*=$6dc45f7ab9b94c34$export$9f8a886f88503d81,s.s*=$6dc45f7ab9b94c34$export$d6110320394e154a,s.h*=$6dc45f7ab9b94c34$export$4639db465b79e483,s.h<$6dc45f7ab9b94c34$export$59af4a43228d42f9&&(s.h+=$6dc45f7ab9b94c34$export$80d6dd9687da66fc),s.h>=$6dc45f7ab9b94c34$export$80d6dd9687da66fc&&(s.h-=$6dc45f7ab9b94c34$export$80d6dd9687da66fc),s}function $7221c4a44f814a20$export$143dda7722fd213d(e,t){var i;return null==(i=$7221c4a44f814a20$var$stringToRgba(e,t))?void 0:i.a}function $7221c4a44f814a20$export$d2c5ec93815c4391(e,t){return $7221c4a44f814a20$var$stringToRgba(e,t)}function $7221c4a44f814a20$export$29fb7152bd3f781a(e){var t=(e.h%$6dc45f7ab9b94c34$export$80d6dd9687da66fc+$6dc45f7ab9b94c34$export$80d6dd9687da66fc)%$6dc45f7ab9b94c34$export$80d6dd9687da66fc,i=Math.max($6dc45f7ab9b94c34$export$6d036dc8238eb540,Math.min($6dc45f7ab9b94c34$export$d6110320394e154a,e.s)),n=Math.max($6dc45f7ab9b94c34$export$42fd2de68d60a133,Math.min($6dc45f7ab9b94c34$export$9f8a886f88503d81,e.l)),r=t/$6dc45f7ab9b94c34$export$80d6dd9687da66fc,a=i/$6dc45f7ab9b94c34$export$d6110320394e154a,s=n/$6dc45f7ab9b94c34$export$9f8a886f88503d81;if(i===$6dc45f7ab9b94c34$export$6d036dc8238eb540){var o=Math.round(s*$6dc45f7ab9b94c34$export$15b8ea3279320e86);return{r:o,g:o,b:o}}var l=function(e,t,i){var n=1;return(i<0&&i++,i>n&&i--,i*$6dc45f7ab9b94c34$export$7a7038229fab314f<n)?e+(t-e)*$6dc45f7ab9b94c34$export$7a7038229fab314f*i:i*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f<n?t:i*$6dc45f7ab9b94c34$export$515818ff8d37c07d<n*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f?e+(t-e)*($6dc45f7ab9b94c34$export$7b3cbda67be88f5f/$6dc45f7ab9b94c34$export$515818ff8d37c07d-i)*$6dc45f7ab9b94c34$export$7a7038229fab314f:e},h=s<$6dc45f7ab9b94c34$export$3ced024fb15e6103?s*($6dc45f7ab9b94c34$export$43104ff2632aa202+a):s+a-s*a,c=$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*s-h,u=$6dc45f7ab9b94c34$export$af5f0fbc6d135058/$6dc45f7ab9b94c34$export$515818ff8d37c07d;return{r:Math.round(Math.min($6dc45f7ab9b94c34$export$15b8ea3279320e86,$6dc45f7ab9b94c34$export$15b8ea3279320e86*l(c,h,r+u))),g:Math.round(Math.min($6dc45f7ab9b94c34$export$15b8ea3279320e86,$6dc45f7ab9b94c34$export$15b8ea3279320e86*l(c,h,r))),b:Math.round(Math.min($6dc45f7ab9b94c34$export$15b8ea3279320e86,$6dc45f7ab9b94c34$export$15b8ea3279320e86*l(c,h,r-u)))}}function $7221c4a44f814a20$export$6ae64dbcd6bfc33e(e){var t=$7221c4a44f814a20$export$29fb7152bd3f781a(e);return{a:e.a,b:t.b,g:t.g,r:t.r}}function $7221c4a44f814a20$export$ac4fc8e9144a1018(e){var t=null!=e?e:$6dc45f7ab9b94c34$export$d13fc714138cfb02,i=$6dc45f7ab9b94c34$export$7bf8bd2b1c3673be+$6dc45f7ab9b94c34$export$f0954fd7d5368655;return{b:Math.floor($e8499b8b34df9b2a$export$8b958c8ecd94a804($e8499b8b34df9b2a$export$6dcd5a07b989db7(t,i))),g:Math.floor($e8499b8b34df9b2a$export$8b958c8ecd94a804($e8499b8b34df9b2a$export$6dcd5a07b989db7(t,i))),r:Math.floor($e8499b8b34df9b2a$export$8b958c8ecd94a804($e8499b8b34df9b2a$export$6dcd5a07b989db7(t,i)))}}function $7221c4a44f814a20$export$2476af37e47fcae2(e,t){return`rgba(${e.r}, ${e.g}, ${e.b}, ${null!=t?t:$6dc45f7ab9b94c34$export$7395e4cb572e863b})`}function $7221c4a44f814a20$export$9d057e59c7b0a82d(e,t){return`hsla(${e.h}, ${e.s}%, ${e.l}%, ${null!=t?t:$6dc45f7ab9b94c34$export$7395e4cb572e863b})`}function $7221c4a44f814a20$export$9b476054b78b89cd(e,t,i,n){var r=e,a=t;return void 0===r.r&&(r=$7221c4a44f814a20$export$29fb7152bd3f781a(e)),void 0===a.r&&(a=$7221c4a44f814a20$export$29fb7152bd3f781a(t)),{b:$e8499b8b34df9b2a$export$2c9e8a9632a706b2(r.b,a.b,i,n),g:$e8499b8b34df9b2a$export$2c9e8a9632a706b2(r.g,a.g,i,n),r:$e8499b8b34df9b2a$export$2c9e8a9632a706b2(r.r,a.r,i,n)}}function $7221c4a44f814a20$export$b676eb46c472d7df(e,t,i){if(i===$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb)return $7221c4a44f814a20$export$ac4fc8e9144a1018();if(i!==$6dc45f7ab9b94c34$export$7b5f45763ca224ae)return i;var n,r,a=null!=(n=e.getFillColor())?n:e.getStrokeColor(),s=null!=(r=null==t?void 0:t.getFillColor())?r:null==t?void 0:t.getStrokeColor();if(a&&s&&t)return $7221c4a44f814a20$export$9b476054b78b89cd(a,s,e.getRadius(),t.getRadius());var o=null!=a?a:s;if(o)return $7221c4a44f814a20$export$29fb7152bd3f781a(o)}function $7221c4a44f814a20$export$cf0e5a4ae26bdcdc(e,t,i,n){var r=$e55b0963af399424$export$844ec244b1367d54(t)?t:t.value;return r===$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb?n?$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(e,{value:r}):i?$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb:$6dc45f7ab9b94c34$export$7b5f45763ca224ae:r===$6dc45f7ab9b94c34$export$7b5f45763ca224ae?$6dc45f7ab9b94c34$export$7b5f45763ca224ae:$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(e,{value:r})}function $7221c4a44f814a20$export$c90768c73bc1d7ab(e){return void 0!==e?{h:e.h.value,s:e.s.value,l:e.l.value}:void 0}function $7221c4a44f814a20$export$6e8a573710bea117(e,t,i){var n={h:{enable:!1,value:e.h},s:{enable:!1,value:e.s},l:{enable:!1,value:e.l}};return t&&($7221c4a44f814a20$var$setColorAnimation(n.h,t.h,i),$7221c4a44f814a20$var$setColorAnimation(n.s,t.s,i),$7221c4a44f814a20$var$setColorAnimation(n.l,t.l,i)),n}function $7221c4a44f814a20$var$setColorAnimation(e,t,i){e.enable=t.enable,e.enable?(e.velocity=$e8499b8b34df9b2a$export$e70c64b68236cb4e(t.speed)/$6dc45f7ab9b94c34$export$9519bca7a9fbeccd*i,e.decay=$6dc45f7ab9b94c34$export$a05b467d53228ab9-$e8499b8b34df9b2a$export$e70c64b68236cb4e(t.decay),e.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing,e.loops=$6dc45f7ab9b94c34$export$ac39eb160969ecba,e.maxLoops=$e8499b8b34df9b2a$export$e70c64b68236cb4e(t.count),e.time=$6dc45f7ab9b94c34$export$7c140f4e42af7fd8,e.delayTime=$e8499b8b34df9b2a$export$e70c64b68236cb4e(t.delay)*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f,t.sync||(e.velocity*=$e8499b8b34df9b2a$export$1a76347094524b3b(),e.value*=$e8499b8b34df9b2a$export$1a76347094524b3b()),e.initialValue=e.value,e.offset=$e8499b8b34df9b2a$export$6dcd5a07b989db7(t.offset)):e.velocity=$6dc45f7ab9b94c34$export$2d575d8dbe8cd673}function $7221c4a44f814a20$export$a151177c20377190(e,t,i,n){var r,a,s,o,l,h,c,u,d,p=0,f=0,g=1,v=0,m=0,y=3.6;if(e&&e.enable&&(!((null!=(r=e.maxLoops)?r:p)>p)||!((null!=(a=e.loops)?a:p)>(null!=(s=e.maxLoops)?s:p)))&&(e.time||(e.time=0),(null!=(o=e.delayTime)?o:f)>f&&e.time<(null!=(l=e.delayTime)?l:f)&&(e.time+=n.value),!((null!=(h=e.delayTime)?h:f)>f)||!(e.time<(null!=(c=e.delayTime)?c:f)))){var x=e.offset?$e8499b8b34df9b2a$export$8b958c8ecd94a804(e.offset):m,b=(null!=(u=e.velocity)?u:v)*n.factor+x*y,w=null!=(d=e.decay)?d:g,k=$e8499b8b34df9b2a$export$27d2c76f835d583d(t),B=$e8499b8b34df9b2a$export$71c94d28c0fa4bfe(t);if(i&&e.status!==$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing){e.value-=b;var S=0;e.value<S&&(e.loops||(e.loops=0),e.loops++,e.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.increasing)}else e.value+=b,e.value>k&&(e.loops||(e.loops=0),e.loops++,i?e.status=$d0eaf415184a9ac7$export$a2d3d93c57d16a1a.decreasing:e.value-=k);e.velocity&&w!==g&&(e.velocity*=w),e.value=$e8499b8b34df9b2a$export$7d15b64cf5a3a4c4(e.value,B,k)}}function $7221c4a44f814a20$export$649b44ac750da8e(e,t){if(e){var i=e.h,n=e.s,r=e.l,a={h:{min:0,max:360},s:{min:0,max:100},l:{min:0,max:100}};i&&$7221c4a44f814a20$export$a151177c20377190(i,a.h,!1,t),n&&$7221c4a44f814a20$export$a151177c20377190(n,a.s,!0,t),r&&$7221c4a44f814a20$export$a151177c20377190(r,a.l,!0,t)}}function $22b29924e93d96ee$export$819db45aec5fcbe5(e,t,i){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.closePath()}function $22b29924e93d96ee$export$2837cdf5427f767e(e,t,i){e.fillStyle=null!=i?i:"rgba(0,0,0,0)",e.fillRect($6dc45f7ab9b94c34$export$8a573f14667e8170.x,$6dc45f7ab9b94c34$export$8a573f14667e8170.y,t.width,t.height)}function $22b29924e93d96ee$export$a17334b9431a8cb2(e,t,i,n){i&&(e.globalAlpha=n,e.drawImage(i,$6dc45f7ab9b94c34$export$8a573f14667e8170.x,$6dc45f7ab9b94c34$export$8a573f14667e8170.y,t.width,t.height),e.globalAlpha=1)}function $22b29924e93d96ee$export$42ffd38884aecdac(e,t){e.clearRect($6dc45f7ab9b94c34$export$8a573f14667e8170.x,$6dc45f7ab9b94c34$export$8a573f14667e8170.y,t.width,t.height)}function $22b29924e93d96ee$export$fca8f175741ef351(e){var t,i,n,r,a,s,o,l=e.container,h=e.context,c=e.particle,u=e.delta,d=e.colorStyles,p=e.backgroundMask,f=e.composite,g=e.radius,v=e.opacity,m=e.shadow,y=e.transform,x=c.getPosition(),b=c.rotation+(c.pathRotation?c.velocity.angle:$6dc45f7ab9b94c34$export$573f1d3d887db8cc),w={sin:Math.sin(b),cos:Math.cos(b)},k=!!b,B={a:w.cos*(null!=(t=y.a)?t:$6dc45f7ab9b94c34$export$d8a7bebef127c134.a),b:k?w.sin*(null!=(i=y.b)?i:$6dc45f7ab9b94c34$export$f0954fd7d5368655):null!=(n=y.b)?n:$6dc45f7ab9b94c34$export$d8a7bebef127c134.b,c:k?-w.sin*(null!=(r=y.c)?r:$6dc45f7ab9b94c34$export$f0954fd7d5368655):null!=(a=y.c)?a:$6dc45f7ab9b94c34$export$d8a7bebef127c134.c,d:w.cos*(null!=(s=y.d)?s:$6dc45f7ab9b94c34$export$d8a7bebef127c134.d)};h.setTransform(B.a,B.b,B.c,B.d,x.x,x.y),p&&(h.globalCompositeOperation=f);var S=c.shadowColor;m.enable&&S&&(h.shadowBlur=m.blur,h.shadowColor=$7221c4a44f814a20$export$2476af37e47fcae2(S),h.shadowOffsetX=m.offset.x,h.shadowOffsetY=m.offset.y),d.fill&&(h.fillStyle=d.fill);var C=null!=(o=c.strokeWidth)?o:$6dc45f7ab9b94c34$export$1f010363d1c40031;h.lineWidth=C,d.stroke&&(h.strokeStyle=d.stroke);var E={container:l,context:h,particle:c,radius:g,opacity:v,delta:u,transformData:B,strokeWidth:C};$22b29924e93d96ee$export$71b514a25c47df50(E),$22b29924e93d96ee$export$2808702213c51f09(E),$22b29924e93d96ee$export$27b58ff3abda0f8e(E),h.globalCompositeOperation="source-over",h.resetTransform()}function $22b29924e93d96ee$export$27b58ff3abda0f8e(e){var t=e.container,i=e.context,n=e.particle,r=e.radius,a=e.opacity,s=e.delta,o=e.transformData;if(n.effect){var l=t.effectDrawers.get(n.effect);l&&l.draw({context:i,particle:n,radius:r,opacity:a,delta:s,pixelRatio:t.retina.pixelRatio,transformData:(0,$cL71g._)({},o)})}}function $22b29924e93d96ee$export$71b514a25c47df50(e){var t=e.container,i=e.context,n=e.particle,r=e.radius,a=e.opacity,s=e.delta,o=e.strokeWidth,l=e.transformData;if(n.shape){var h=t.shapeDrawers.get(n.shape);h&&(i.beginPath(),h.draw({context:i,particle:n,radius:r,opacity:a,delta:s,pixelRatio:t.retina.pixelRatio,transformData:(0,$cL71g._)({},l)}),n.shapeClose&&i.closePath(),o>$6dc45f7ab9b94c34$export$1f010363d1c40031&&i.stroke(),n.shapeFill&&i.fill())}}function $22b29924e93d96ee$export$2808702213c51f09(e){var t=e.container,i=e.context,n=e.particle,r=e.radius,a=e.opacity,s=e.delta,o=e.transformData;if(n.shape){var l=t.shapeDrawers.get(n.shape);(null==l?void 0:l.afterDraw)&&l.afterDraw({context:i,particle:n,radius:r,opacity:a,delta:s,pixelRatio:t.retina.pixelRatio,transformData:(0,$cL71g._)({},o)})}}function $22b29924e93d96ee$export$ee9933e1bf4ba142(e,t,i){t.draw&&t.draw(e,i)}function $22b29924e93d96ee$export$3493f6d6277d918a(e,t,i,n){t.drawParticle&&t.drawParticle(e,i,n)}function $22b29924e93d96ee$export$fe1d034b0e82666(e,t,i){return{h:e.h,s:e.s,l:e.l+(t===$b4cbc69301f7091d$export$d3c0448523aecc2e.darken?-$6dc45f7ab9b94c34$export$6438bad23c977d39:$6dc45f7ab9b94c34$export$6438bad23c977d39)*i}}function $5c8dba58fca6e9bb$var$setTransformValue(e,t,i){var n,r=t[i];void 0!==r&&(e[i]=(null!=(n=e[i])?n:$6dc45f7ab9b94c34$export$1f10c01143b9f089)*r)}function $5c8dba58fca6e9bb$var$setStyle(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){var n=e;if(n){var r=n.style;if(r){var a=new Set;for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&a.add(r[s]);for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&a.add(t[o]);var l=!0,h=!1,c=void 0;try{for(var u,d=a[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var p=u.value,f=t.getPropertyValue(p);f?r.setProperty(p,f,i?"important":""):r.removeProperty(p)}}catch(e){h=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(h)throw c}}}}}}!function(e){e.darken="darken",e.enlighten="enlighten"}($b4cbc69301f7091d$export$d3c0448523aecc2e||($b4cbc69301f7091d$export$d3c0448523aecc2e={}));var $5c8dba58fca6e9bb$export$8d01c972ee8b14a9=function(){"use strict";function e(t,i){var n=this;(0,$cx0mh._)(this,e),this.container=t,this._applyPostDrawUpdaters=function(e){var t=!0,i=!1,r=void 0;try{for(var a,s,o=n._postDrawUpdaters[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var l=s.value;null==(a=l.afterDraw)||a.call(l,e)}}catch(e){i=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw r}}},this._applyPreDrawUpdaters=function(e,t,i,r,a,s){var o=!0,l=!1,h=void 0;try{for(var c,u=n._preDrawUpdaters[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d,p=c.value;if(p.getColorStyles){var f=p.getColorStyles(t,e,i,r),g=f.fill,v=f.stroke;g&&(a.fill=g),v&&(a.stroke=v)}if(p.getTransformValues){var m=p.getTransformValues(t);for(var y in m)$5c8dba58fca6e9bb$var$setTransformValue(s,m,y)}null==(d=p.beforeDraw)||d.call(p,t)}}catch(e){l=!0,h=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw h}}},this._applyResizePlugins=function(){var e=!0,t=!1,i=void 0;try{for(var r,a,s=n._resizePlugins[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var o=a.value;null==(r=o.resize)||r.call(o)}}catch(e){t=!0,i=e}finally{try{e||null==s.return||s.return()}finally{if(t)throw i}}},this._getPluginParticleColors=function(e){var t=!0,i=!1,r=void 0;try{for(var a,s,o,l=n._colorPlugins[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var h=o.value;if(!a&&h.particleFillColor&&(a=$7221c4a44f814a20$export$79a89086521c0f12(n._engine,h.particleFillColor(e))),!s&&h.particleStrokeColor&&(s=$7221c4a44f814a20$export$79a89086521c0f12(n._engine,h.particleStrokeColor(e))),a&&s)break}}catch(e){i=!0,r=e}finally{try{t||null==l.return||l.return()}finally{if(i)throw r}}return[a,s]},this._initCover=function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(e=this,!(i=(t=this.container.actualOptions.backgroundMask.cover).color))return[3,1];return(n=$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(this._engine,i))&&(r=(0,$4EWN2._)((0,$cL71g._)({},n),{a:t.opacity}),this._coverColorStyle=$7221c4a44f814a20$export$2476af37e47fcae2(r,r.a)),[3,3];case 1:return[4,new Promise(function(i,n){if(t.image){var r=document.createElement("img");r.addEventListener("load",function(){e._coverImage={image:r,opacity:t.opacity},i()}),r.addEventListener("error",function(e){n(e.error)}),r.src=t.image}})];case 2:a.sent(),a.label=3;case 3:return[2]}})}).call(n)},this._initStyle=function(){var e=n.element,t=n.container.actualOptions;if(e){for(var i in n._fullScreen?n._setFullScreenStyle():n._resetOriginalStyle(),t.style)if(i&&t.style&&Object.prototype.hasOwnProperty.call(t.style,i)){var r=t.style[i];r&&e.style.setProperty(i,r,"important")}}},this._initTrail=function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(e=this,i=(t=this.container.actualOptions.particles.move.trail).fill,!t.enable)return[2];if(n=$6dc45f7ab9b94c34$export$6a43a0894b8f8dd4/t.length,!i.color)return[3,1];if(!(r=$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(this._engine,i.color)))return[2];return this._trailFill={color:(0,$cL71g._)({},r),opacity:n},[3,3];case 1:return[4,new Promise(function(t,r){if(i.image){var a=document.createElement("img");a.addEventListener("load",function(){e._trailFill={image:a,opacity:n},t()}),a.addEventListener("error",function(e){r(e.error)}),a.src=i.image}})];case 2:a.sent(),a.label=3;case 3:return[2]}})}).call(n)},this._paintBase=function(e){n.draw(function(t){return $22b29924e93d96ee$export$2837cdf5427f767e(t,n.size,e)})},this._paintImage=function(e,t){n.draw(function(i){return $22b29924e93d96ee$export$a17334b9431a8cb2(i,n.size,e,t)})},this._repairStyle=function(){var e=n.element;if(e){n._safeMutationObserver(function(e){return e.disconnect()}),n._initStyle(),n.initBackground();var t=n._pointerEvents;e.style.pointerEvents=t,e.setAttribute("pointer-events",t),n._safeMutationObserver(function(t){e&&e instanceof Node&&t.observe(e,{attributes:!0})})}},this._resetOriginalStyle=function(){var e=n.element,t=n._originalStyle;e&&t&&$5c8dba58fca6e9bb$var$setStyle(e,t,!0)},this._safeMutationObserver=function(e){n._mutationObserver&&e(n._mutationObserver)},this._setFullScreenStyle=function(){var e=n.element;e&&$5c8dba58fca6e9bb$var$setStyle(e,$45e196d141848e3a$export$10d1829d88c10e6a(n.container.actualOptions.fullScreen.zIndex),!0)},this._engine=i,this._standardSize={height:0,width:0};var r=t.retina.pixelRatio,a=this._standardSize;this.size={height:a.height*r,width:a.width*r},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[],this._pointerEvents="none"}return(0,$7h4XF._)(e,[{key:"_fullScreen",get:function(){return this.container.actualOptions.fullScreen.enable}},{key:"clear",value:function(){var e=this,t=this.container.actualOptions,i=t.particles.move.trail,n=this._trailFill;t.backgroundMask.enable?this.paint():i.enable&&i.length>$6dc45f7ab9b94c34$export$920ec94752436dad&&n?n.color?this._paintBase($7221c4a44f814a20$export$2476af37e47fcae2(n.color,n.opacity)):n.image&&this._paintImage(n.image,n.opacity):t.clear&&this.draw(function(t){$22b29924e93d96ee$export$42ffd38884aecdac(t,e.size)})}},{key:"destroy",value:function(){if(this.stop(),this._generated){var e=this.element;null==e||e.remove(),this.element=void 0}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}},{key:"draw",value:function(e){var t=this._context;if(t)return e(t)}},{key:"drawAsync",value:function(e){var t=this._context;if(t)return e(t)}},{key:"drawParticle",value:function(e,t){var i,n=this;if(!e.spawning&&!e.destroyed){var r=e.getRadius();if(!(r<=$6dc45f7ab9b94c34$export$4b0ea52aa81e1ca2)){var a=e.getFillColor(),s=null!=(i=e.getStrokeColor())?i:a,o=(0,$8N5YG._)(this._getPluginParticleColors(e),2),l=o[0],h=o[1];l||(l=a),h||(h=s),(l||h)&&this.draw(function(i){var a,s,o,c,u=n.container,d=u.actualOptions,p=e.options.zIndex,f=$6dc45f7ab9b94c34$export$6ca59ab71c007a1b-e.zIndexFactor,g=Math.pow(f,p.opacityRate),v=null!=(o=null!=(s=e.bubble.opacity)?s:null==(a=e.opacity)?void 0:a.value)?o:$6dc45f7ab9b94c34$export$7395e4cb572e863b,m=null!=(c=e.strokeOpacity)?c:v,y=v*g,x=m*g,b={},w={fill:l?$7221c4a44f814a20$export$9d057e59c7b0a82d(l,y):void 0};w.stroke=h?$7221c4a44f814a20$export$9d057e59c7b0a82d(h,x):w.fill,n._applyPreDrawUpdaters(i,e,r,y,w,b),$22b29924e93d96ee$export$fca8f175741ef351({container:u,context:i,particle:e,delta:t,colorStyles:w,backgroundMask:d.backgroundMask.enable,composite:d.backgroundMask.composite,radius:r*Math.pow(f,p.sizeRate),opacity:y,shadow:e.options.shadow,transform:b}),n._applyPostDrawUpdaters(e)})}}}},{key:"drawParticlePlugin",value:function(e,t,i){this.draw(function(n){return $22b29924e93d96ee$export$3493f6d6277d918a(n,e,t,i)})}},{key:"drawPlugin",value:function(e,t){this.draw(function(i){return $22b29924e93d96ee$export$ee9933e1bf4ba142(i,e,t)})}},{key:"init",value:function(){return(0,$1LaJZ._)(function(){var e,t;return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return e=this,this._safeMutationObserver(function(e){return e.disconnect()}),this._mutationObserver=$45e196d141848e3a$export$c2f9084a48da0641(function(t){var i=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;"attributes"===o.type&&"style"===o.attributeName&&e._repairStyle()}}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}),this.resize(),this._initStyle(),[4,this._initCover()];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._initTrail()];case 3:return i.sent(),[3,5];case 4:return t=i.sent(),$45e196d141848e3a$export$2b1d391cd05230fd().error(t),[3,5];case 5:return this.initBackground(),this._safeMutationObserver(function(t){e.element&&e.element instanceof Node&&t.observe(e.element,{attributes:!0})}),this.initUpdaters(),this.initPlugins(),this.paint(),[2]}})}).call(this)}},{key:"initBackground",value:function(){var e=this.container.actualOptions.background,t=this.element;if(t){var i=t.style;if(i){if(e.color){var n=$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(this._engine,e.color);i.backgroundColor=n?$7221c4a44f814a20$export$2476af37e47fcae2(n,e.opacity):""}else i.backgroundColor="";i.backgroundImage=e.image||"",i.backgroundPosition=e.position||"",i.backgroundRepeat=e.repeat||"",i.backgroundSize=e.size||""}}}},{key:"initPlugins",value:function(){this._resizePlugins=[];var e=!0,t=!1,i=void 0;try{for(var n,r=this.container.plugins.values()[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a,s=n.value;s.resize&&this._resizePlugins.push(s),(null!=(a=s.particleFillColor)?a:s.particleStrokeColor)&&this._colorPlugins.push(s)}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}}},{key:"initUpdaters",value:function(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];var e=!0,t=!1,i=void 0;try{for(var n,r=this.container.particles.updaters[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var a,s,o=n.value;o.afterDraw&&this._postDrawUpdaters.push(o),(null!=(s=null!=(a=o.getColorStyles)?a:o.getTransformValues)?s:o.beforeDraw)&&this._preDrawUpdaters.push(o)}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}}},{key:"loadCanvas",value:function(e){var t=this;this._generated&&this.element&&this.element.remove(),this._generated=e.dataset&&$6dc45f7ab9b94c34$export$4a278486528d5cfb in e.dataset?"true"===e.dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]:this._generated,this.element=e,this.element.ariaHidden="true",this._originalStyle=$45e196d141848e3a$export$667e8f3bfe6278b7(this.element.style);var i=this._standardSize;i.height=e.offsetHeight,i.width=e.offsetWidth;var n=this.container.retina.pixelRatio,r=this.size;e.height=r.height=i.height*n,e.width=r.width=i.width*n,this._context=this.element.getContext("2d"),this._safeMutationObserver(function(e){return e.disconnect()}),this.container.retina.init(),this.initBackground(),this._safeMutationObserver(function(e){t.element&&t.element instanceof Node&&e.observe(t.element,{attributes:!0})})}},{key:"paint",value:function(){var e=this,t=this.container.actualOptions;this.draw(function(i){t.backgroundMask.enable&&t.backgroundMask.cover?($22b29924e93d96ee$export$42ffd38884aecdac(i,e.size),e._coverImage?e._paintImage(e._coverImage.image,e._coverImage.opacity):e._coverColorStyle?e._paintBase(e._coverColorStyle):e._paintBase()):e._paintBase()})}},{key:"resize",value:function(){if(!this.element)return!1;var e=this.container,t=e.canvas._standardSize,i={width:this.element.offsetWidth,height:this.element.offsetHeight},n=e.retina.pixelRatio,r={width:i.width*n,height:i.height*n};if(i.height===t.height&&i.width===t.width&&r.height===this.element.height&&r.width===this.element.width)return!1;var a=(0,$cL71g._)({},t);t.height=i.height,t.width=i.width;var s=this.size;return this.element.width=s.width=r.width,this.element.height=s.height=r.height,this.container.started&&e.particles.setResizeFactor({width:t.width/a.width,height:t.height/a.height}),!0}},{key:"setPointerEvents",value:function(e){this.element&&(this._pointerEvents=e,this._repairStyle())}},{key:"stop",value:function(){var e=this;this._safeMutationObserver(function(e){return e.disconnect()}),this._mutationObserver=void 0,this.draw(function(t){return $22b29924e93d96ee$export$42ffd38884aecdac(t,e.size)})}},{key:"windowResize",value:function(){return(0,$1LaJZ._)(function(){var e,t;return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:if(!this.element||!this.resize())return[2];if(t=(e=this.container).updateActualOptions(),e.particles.setDensity(),this._applyResizePlugins(),!t)return[3,2];return[4,e.refresh()];case 1:i.sent(),i.label=2;case 2:return[2]}})}).call(this)}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$2gUX3=parcelRequire("2gUX3");function $41fd8665fa436cdd$var$manageListener(e,t,i,n,r){if(n){var a={passive:!0};$e55b0963af399424$export$f9ce7b637dfbe238(r)?a.capture=r:void 0!==r&&(a=r),e.addEventListener(t,i,a)}else{var s=r;e.removeEventListener(t,i,s)}}!function(e){e.canvas="canvas",e.parent="parent",e.window="window"}($830938a01a5571f6$export$a061a4a5d124ecc0||($830938a01a5571f6$export$a061a4a5d124ecc0={}));var $41fd8665fa436cdd$export$b20b719ec758a20f=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.container=t,this._doMouseTouchClick=function(e){var t=i.container,n=t.actualOptions;if(i._canPush){var r=t.interactivity.mouse,a=r.position;if(!a)return;r.clickPosition=(0,$cL71g._)({},a),r.clickTime=new Date().getTime(),$45e196d141848e3a$export$8e5dc47097396754(n.interactivity.events.onClick.mode,function(e){return i.container.handleClickMode(e)})}"touchend"===e.type&&setTimeout(function(){return i._mouseTouchFinish()},$6dc45f7ab9b94c34$export$a31a053ae1bfc10e)},this._handleThemeChange=function(e){var t=e,n=i.container,r=n.options,a=r.defaultThemes,s=t.matches?a.dark:a.light,o=r.themes.find(function(e){return e.name===s});(null==o?void 0:o.default.auto)&&n.loadTheme(s)},this._handleVisibilityChange=function(){var e,t=i.container,n=t.actualOptions;i._mouseTouchFinish(),n.pauseOnBlur&&((null==(e=document)?void 0:e.hidden)?(t.pageHidden=!0,t.pause()):(t.pageHidden=!1,t.animationStatus?t.play(!0):t.draw(!0)))},this._handleWindowResize=function(){i._resizeTimeout&&(clearTimeout(i._resizeTimeout),delete i._resizeTimeout);var e=function(){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:return[4,null==(e=this.container.canvas)?void 0:e.windowResize()];case 1:return t.sent(),[2]}})}).call(i)};i._resizeTimeout=setTimeout(function(){e()},i.container.actualOptions.interactivity.events.resize.delay*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f)},this._manageInteractivityListeners=function(e,t){var n=i._handlers,r=i.container,a=r.actualOptions,s=r.interactivity.element;if(s){var o=s,l=r.canvas;l.setPointerEvents(o===l.element?"initial":"none"),(a.interactivity.events.onHover.enable||a.interactivity.events.onClick.enable)&&($41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$1ffe551d7d33cd33,n.mouseMove,t),$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$d5353b6c79bbcc70,n.touchStart,t),$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$d28a82874c0e6212,n.touchMove,t),a.interactivity.events.onClick.enable?($41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$11164630b85c192d,n.touchEndClick,t),$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$9fb0268ce1bdbca0,n.mouseUp,t),$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$9ffd73c9a0e32c34,n.mouseDown,t)):$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$11164630b85c192d,n.touchEnd,t),$41fd8665fa436cdd$var$manageListener(s,e,n.mouseLeave,t),$41fd8665fa436cdd$var$manageListener(s,$6dc45f7ab9b94c34$export$65db1c69591947a7,n.touchCancel,t))}},this._manageListeners=function(e){var t,n=i._handlers,r=i.container,a=r.actualOptions.interactivity.detectsOn,s=r.canvas.element,o=$6dc45f7ab9b94c34$export$f4b184a85a586f8a;a===$830938a01a5571f6$export$a061a4a5d124ecc0.window?(r.interactivity.element=window,o=$6dc45f7ab9b94c34$export$55cc1d6a692feb2b):a===$830938a01a5571f6$export$a061a4a5d124ecc0.parent&&s?r.interactivity.element=null!=(t=s.parentElement)?t:s.parentNode:r.interactivity.element=s,i._manageMediaMatch(e),i._manageResize(e),i._manageInteractivityListeners(o,e),document&&$41fd8665fa436cdd$var$manageListener(document,$6dc45f7ab9b94c34$export$73536144dc68dd0f,n.visibilityChange,e,!1)},this._manageMediaMatch=function(e){var t=i._handlers,n=$45e196d141848e3a$export$db32b9574e21e00f("(prefers-color-scheme: dark)");n&&(void 0!==n.addEventListener?$41fd8665fa436cdd$var$manageListener(n,"change",t.themeChange,e):void 0!==n.addListener&&(e?n.addListener(t.oldThemeChange):n.removeListener(t.oldThemeChange)))},this._manageResize=function(e){var t=i._handlers,n=i.container;if(n.actualOptions.interactivity.events.resize){if("undefined"==typeof ResizeObserver)return void $41fd8665fa436cdd$var$manageListener(window,$6dc45f7ab9b94c34$export$8b3d73c91cd7cc65,t.resize,e);var r=n.canvas.element;i._resizeObserver&&!e?(r&&i._resizeObserver.unobserve(r),i._resizeObserver.disconnect(),delete i._resizeObserver):!i._resizeObserver&&e&&r&&(i._resizeObserver=new ResizeObserver(function(e){e.find(function(e){return e.target===r})&&i._handleWindowResize()}),i._resizeObserver.observe(r))}},this._mouseDown=function(){var e=i.container.interactivity;if(e){var t=e.mouse;t.clicking=!0,t.downPosition=t.position}},this._mouseTouchClick=function(e){var t=i.container,n=t.actualOptions,r=t.interactivity.mouse;r.inside=!0;var a=!1,s=r.position;if(s&&n.interactivity.events.onClick.enable){var o=!0,l=!1,h=void 0;try{for(var c,u=t.plugins.values()[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;if(d.clickPositionValid&&(a=d.clickPositionValid(s)))break}}catch(e){l=!0,h=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw h}}a||i._doMouseTouchClick(e),r.clicking=!1}},this._mouseTouchFinish=function(){var e=i.container.interactivity;if(e){var t=e.mouse;delete t.position,delete t.clickPosition,delete t.downPosition,e.status=$6dc45f7ab9b94c34$export$f4b184a85a586f8a,t.inside=!1,t.clicking=!1}},this._mouseTouchMove=function(e){var t=i.container,n=t.actualOptions,r=t.interactivity,a=t.canvas.element;if(null==r?void 0:r.element){if(r.mouse.inside=!0,e.type.startsWith("pointer")){i._canPush=!0;var s=e;if(r.element===window){if(a){var o=a.getBoundingClientRect();l={x:s.clientX-o.left,y:s.clientY-o.top}}}else if(n.interactivity.detectsOn===$830938a01a5571f6$export$a061a4a5d124ecc0.parent){var l,h,c,u,d,p=s.target,f=s.currentTarget;if(p&&f&&a){var g=p.getBoundingClientRect(),v=f.getBoundingClientRect(),m=a.getBoundingClientRect();l={x:s.offsetX+$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*g.left-(v.left+m.left),y:s.offsetY+$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*g.top-(v.top+m.top)}}else l={x:null!=(u=s.offsetX)?u:s.clientX,y:null!=(d=s.offsetY)?d:s.clientY}}else s.target===a&&(l={x:null!=(h=s.offsetX)?h:s.clientX,y:null!=(c=s.offsetY)?c:s.clientY})}else if(i._canPush="touchmove"!==e.type,a){var y,x,b=e,w=b.touches[b.touches.length-$6dc45f7ab9b94c34$export$4a5b9680be542cf8],k=a.getBoundingClientRect();l={x:w.clientX-(null!=(y=k.left)?y:$6dc45f7ab9b94c34$export$17c6bab6aae4c3d),y:w.clientY-(null!=(x=k.top)?x:$6dc45f7ab9b94c34$export$17c6bab6aae4c3d)}}var B=t.retina.pixelRatio;l&&(l.x*=B,l.y*=B),r.mouse.position=l,r.status=$6dc45f7ab9b94c34$export$1ffe551d7d33cd33}},this._touchEnd=function(e){var t=Array.from(e.changedTouches),n=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;i._touches.delete(l.identifier)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i._mouseTouchFinish()},this._touchEndClick=function(e){var t=Array.from(e.changedTouches),n=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;i._touches.delete(l.identifier)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i._mouseTouchClick(e)},this._touchStart=function(e){var t=Array.from(e.changedTouches),n=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;i._touches.set(l.identifier,performance.now())}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i._mouseTouchMove(e)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:function(){return i._mouseDown()},mouseLeave:function(){return i._mouseTouchFinish()},mouseMove:function(e){return i._mouseTouchMove(e)},mouseUp:function(e){return i._mouseTouchClick(e)},touchStart:function(e){return i._touchStart(e)},touchMove:function(e){return i._mouseTouchMove(e)},touchEnd:function(e){return i._touchEnd(e)},touchCancel:function(e){return i._touchEnd(e)},touchEndClick:function(e){return i._touchEndClick(e)},visibilityChange:function(){return i._handleVisibilityChange()},themeChange:function(e){return i._handleThemeChange(e)},oldThemeChange:function(e){return i._handleThemeChange(e)},resize:function(){i._handleWindowResize()}}}return(0,$7h4XF._)(e,[{key:"addListeners",value:function(){this._manageListeners(!0)}},{key:"removeListeners",value:function(){this._manageListeners(!1)}}]),e}();!function(e){e.configAdded="configAdded",e.containerInit="containerInit",e.particlesSetup="particlesSetup",e.containerStarted="containerStarted",e.containerStopped="containerStopped",e.containerDestroyed="containerDestroyed",e.containerPaused="containerPaused",e.containerPlay="containerPlay",e.containerBuilt="containerBuilt",e.particleAdded="particleAdded",e.particleDestroyed="particleDestroyed",e.particleRemoved="particleRemoved"}($faa26ded1880cb9a$export$3d7865934588d77e||($faa26ded1880cb9a$export$3d7865934588d77e={}));var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$30faee5cc856d563$export$c2b08aa25660fcaa=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.value=""}return(0,$7h4XF._)(e,[{key:"load",value:function(e){!$e55b0963af399424$export$630801d484da15df(e)&&($e55b0963af399424$export$630801d484da15df(e.value)||(this.value=e.value))}}],[{key:"create",value:function(t,i){var n=new e;return n.load(t),void 0!==i&&($e55b0963af399424$export$844ec244b1367d54(i)||$e55b0963af399424$export$43bee75e5e14138e(i)?n.load({value:i}):n.load(i)),n}}]),e}(),$ff26e11914e51559$export$668799e4797757a8=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.color=new $30faee5cc856d563$export$c2b08aa25660fcaa,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.color&&(this.color=$30faee5cc856d563$export$c2b08aa25660fcaa.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.position&&(this.position=e.position),void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.size&&(this.size=e.size),void 0!==e.opacity&&(this.opacity=e.opacity))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$a77fb00d66bab6b8$export$83d45d4584162ec0=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.opacity=1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.color&&(this.color=$30faee5cc856d563$export$c2b08aa25660fcaa.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.opacity&&(this.opacity=e.opacity))}}]),e}(),$e2a7c1670e29030a$export$36a2fa1e47ffeebc=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.composite="destination-out",this.cover=new $a77fb00d66bab6b8$export$83d45d4584162ec0,this.enable=!1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){if(void 0!==e.composite&&(this.composite=e.composite),void 0!==e.cover){var t=e.cover,i=$e55b0963af399424$export$844ec244b1367d54(e.cover)?{color:e.cover}:e.cover;this.cover.load(void 0!==t.color||void 0!==t.image?t:{color:i})}void 0!==e.enable&&(this.enable=e.enable)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$fe0fe246206b14eb$export$f885b95b3f0be76d=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!0,this.zIndex=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.zIndex&&(this.zIndex=e.zIndex))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$6409b37c0df512d7$export$8d82f6df2d02cd91=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!1,this.mode=[]}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.circle="circle",e.rectangle="rectangle"}($adc6fc25ebf8fc6e$export$9e83d65c7ba90739||($adc6fc25ebf8fc6e$export$9e83d65c7ba90739={}));var $66afc045a6454673$export$54136f11f358067a=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.selectors=[],this.enable=!1,this.mode=[],this.type=$adc6fc25ebf8fc6e$export$9e83d65c7ba90739.circle}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.selectors&&(this.selectors=e.selectors),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.type&&(this.type=e.type))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$7bec0699a9050c46$export$1bc430945f060dd1=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!1,this.force=2,this.smooth=10}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.force&&(this.force=e.force),void 0!==e.smooth&&(this.smooth=e.smooth))}}]),e}(),$4839f965e53f7355$export$2f13ede603111372=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!1,this.mode=[],this.parallax=new $7bec0699a9050c46$export$1bc430945f060dd1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),this.parallax.load(e.parallax))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$5340c98bafa4a0dc$export$4a407cdeed472cd5=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.delay=.5,this.enable=!0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.delay&&(this.delay=e.delay),void 0!==e.enable&&(this.enable=e.enable))}}]),e}(),$7bf775e075c446c3$export$ada873a34909da65=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.onClick=new $6409b37c0df512d7$export$8d82f6df2d02cd91,this.onDiv=new $66afc045a6454673$export$54136f11f358067a,this.onHover=new $4839f965e53f7355$export$2f13ede603111372,this.resize=new $5340c98bafa4a0dc$export$4a407cdeed472cd5}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){this.onClick.load(e.onClick);var t=e.onDiv;void 0!==t&&(this.onDiv=$45e196d141848e3a$export$8e5dc47097396754(t,function(e){var t=new $66afc045a6454673$export$54136f11f358067a;return t.load(e),t})),this.onHover.load(e.onHover),this.resize.load(e.resize)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2a948082fd8a0498$export$43660d87cb080eb=function(){"use strict";function e(t,i){(0,$cx0mh._)(this,e),this._engine=t,this._container=i}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)&&this._container){var t=this._engine.interactors.get(this._container);if(t){var i=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;o.loadModeOptions&&o.loadModeOptions(this,e)}}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}}}]),e}(),$4d745957d593b972$export$865458a3ba269c4a=function(){"use strict";function e(t,i){(0,$cx0mh._)(this,e),this.detectsOn=$830938a01a5571f6$export$a061a4a5d124ecc0.window,this.events=new $7bf775e075c446c3$export$ada873a34909da65,this.modes=new $2a948082fd8a0498$export$43660d87cb080eb(t,i)}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){var t=e.detectsOn;void 0!==t&&(this.detectsOn=t),this.events.load(e.events),this.modes.load(e.modes)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$6a36af2d3cdfeab1$export$4f41a3ab9fa8cdf=function(){"use strict";function e(){(0,$cx0mh._)(this,e)}return(0,$7h4XF._)(e,[{key:"load",value:function(e){var t,i,n;!$e55b0963af399424$export$630801d484da15df(e)&&(e.position&&(this.position={x:null!=(t=e.position.x)?t:$6dc45f7ab9b94c34$export$d4e77d4b7e9933c7,y:null!=(i=e.position.y)?i:$6dc45f7ab9b94c34$export$d4e77d4b7e9933c7,mode:null!=(n=e.position.mode)?n:$e2421ddcce10c8e2$export$1009f0178778a981.percent}),e.options&&(this.options=$45e196d141848e3a$export$54e9fb29908872fa({},e.options)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.screen="screen",e.canvas="canvas"}($7d7aa6fd00f3e48f$export$73c2705cb2da08ab||($7d7aa6fd00f3e48f$export$73c2705cb2da08ab={}));var $996b087d4a7a13e8$export$49b67f1c7ac91d9b=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.maxWidth=1/0,this.options={},this.mode=$7d7aa6fd00f3e48f$export$73c2705cb2da08ab.canvas}return(0,$7h4XF._)(e,[{key:"load",value:function(e){!$e55b0963af399424$export$630801d484da15df(e)&&($e55b0963af399424$export$630801d484da15df(e.maxWidth)||(this.maxWidth=e.maxWidth),$e55b0963af399424$export$630801d484da15df(e.mode)||(e.mode===$7d7aa6fd00f3e48f$export$73c2705cb2da08ab.screen?this.mode=$7d7aa6fd00f3e48f$export$73c2705cb2da08ab.screen:this.mode=$7d7aa6fd00f3e48f$export$73c2705cb2da08ab.canvas),$e55b0963af399424$export$630801d484da15df(e.options)||(this.options=$45e196d141848e3a$export$54e9fb29908872fa({},e.options)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.any="any",e.dark="dark",e.light="light"}($cb51e19a22472144$export$cd01a11ba097c64c||($cb51e19a22472144$export$cd01a11ba097c64c={}));var $e43093aafc11187d$export$4bc81bcab6354024=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.auto=!1,this.mode=$cb51e19a22472144$export$cd01a11ba097c64c.any,this.value=!1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.auto&&(this.auto=e.auto),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}]),e}(),$97e7d8bd53e27a1d$export$14faa19a0f3bbeb2=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.name="",this.default=new $e43093aafc11187d$export$4bc81bcab6354024}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.name&&(this.name=e.name),this.default.load(e.default),void 0!==e.options&&(this.options=$45e196d141848e3a$export$54e9fb29908872fa({},e.options)))}}]),e}(),$bX4ja=parcelRequire("bX4ja"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy");function $251f07d54d321472$export$71511d61b312f219(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,$2JCCy._)(e)););return e}function $4391a308ec80562d$export$71511d61b312f219(e,t,i){return($4391a308ec80562d$export$71511d61b312f219="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=$251f07d54d321472$export$71511d61b312f219(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i||e):r.value}})(e,t,i||e)}var $2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$31a4d6c663f5d47b$export$e293c31e7176ae39=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.count&&(this.count=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.count)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.speed)),void 0!==e.decay&&(this.decay=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.decay)),void 0!==e.delay&&(this.delay=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.delay)),void 0!==e.sync&&(this.sync=e.sync))}}]),e}(),$31a4d6c663f5d47b$export$664e182a9c83d6f5=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).mode=$6d7e036695a5135c$export$6bf57c7f0219f07d.auto,e.startValue=$a78ee5b112786af3$export$5385b9a82993d2c8.random,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.startValue&&(this.startValue=e.startValue))}}]),t}($31a4d6c663f5d47b$export$e293c31e7176ae39),$152bb4f61c3f552e$export$3cc8aa7a0c621de0=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).offset=0,e.sync=!0,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),$e55b0963af399424$export$630801d484da15df(e)||void 0!==e.offset&&(this.offset=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.offset))}}]),t}($31a4d6c663f5d47b$export$e293c31e7176ae39),$3a90063458d40eda$export$b4c56f18acc5f2f4=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.h=new $152bb4f61c3f552e$export$3cc8aa7a0c621de0,this.s=new $152bb4f61c3f552e$export$3cc8aa7a0c621de0,this.l=new $152bb4f61c3f552e$export$3cc8aa7a0c621de0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(this.h.load(e.h),this.s.load(e.s),this.l.load(e.l))}}]),e}(),$b87181e28955b8a0$export$6f79b6ff75533155=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).animation=new $3a90063458d40eda$export$b4c56f18acc5f2f4,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){if($4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),!$e55b0963af399424$export$630801d484da15df(e)){var i=e.animation;void 0!==i&&(void 0!==i.enable?this.animation.h.load(i):this.animation.load(e.animation))}}}],[{key:"create",value:function(e,i){var n=new t;return n.load(e),void 0!==i&&($e55b0963af399424$export$844ec244b1367d54(i)||$e55b0963af399424$export$43bee75e5e14138e(i)?n.load({value:i}):n.load(i)),n}}]),t}($30faee5cc856d563$export$c2b08aa25660fcaa),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.absorb="absorb",e.bounce="bounce",e.destroy="destroy"}($5ac773a3339b2d5e$export$c17cb29bf4746ec8||($5ac773a3339b2d5e$export$c17cb29bf4746ec8={}));var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$224d6643803a308f$export$dbafb70800ee3f9b=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.speed=2}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||void 0!==e.speed&&(this.speed=e.speed)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$35b9e74d6030da8b$export$7dac291125fc16da=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!0,this.retries=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.retries&&(this.retries=e.retries))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$9xmuV=parcelRequire("9xmuV"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$8ac1d20a0becf385$export$2f74c042fca0b66d=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.value=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){!$e55b0963af399424$export$630801d484da15df(e)&&($e55b0963af399424$export$630801d484da15df(e.value)||(this.value=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.value)))}}]),e}(),$8ac1d20a0becf385$export$a0fda83b6e14e586=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).animation=new $31a4d6c663f5d47b$export$e293c31e7176ae39,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){if($4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),!$e55b0963af399424$export$630801d484da15df(e)){var i=e.animation;void 0!==i&&this.animation.load(i)}}}]),t}($8ac1d20a0becf385$export$2f74c042fca0b66d),$8ac1d20a0becf385$export$8d0da1142c209427=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).animation=new $31a4d6c663f5d47b$export$664e182a9c83d6f5,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e)}}]),t}($8ac1d20a0becf385$export$a0fda83b6e14e586),$79d1cb68e27a0fd1$export$855823db9a0085c=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).value=1,e}return(0,$9xmuV._)(t,e),t}($8ac1d20a0becf385$export$2f74c042fca0b66d),$1dce2fe8607e722d$export$e6dd54c89cd6ac88=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.horizontal=new $79d1cb68e27a0fd1$export$855823db9a0085c,this.vertical=new $79d1cb68e27a0fd1$export$855823db9a0085c}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(this.horizontal.load(e.horizontal),this.vertical.load(e.vertical))}}]),e}(),$6b4b5a58c6bdf2c1$export$97ff58b0eb9a5ed0=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.absorb=new $224d6643803a308f$export$dbafb70800ee3f9b,this.bounce=new $1dce2fe8607e722d$export$e6dd54c89cd6ac88,this.enable=!1,this.maxSpeed=50,this.mode=$5ac773a3339b2d5e$export$c17cb29bf4746ec8.bounce,this.overlap=new $35b9e74d6030da8b$export$7dac291125fc16da}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(this.absorb.load(e.absorb),this.bounce.load(e.bounce),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.maxSpeed&&(this.maxSpeed=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.maxSpeed)),void 0!==e.mode&&(this.mode=e.mode),this.overlap.load(e.overlap))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$5d42e3025e57c75b$export$a32b0b1c1ac59d04=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.close=!0,this.fill=!0,this.options={},this.type=[]}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){var t=e.options;if(void 0!==t)for(var i in t){var n,r=t[i];r&&(this.options[i]=$45e196d141848e3a$export$54e9fb29908872fa(null!=(n=this.options[i])?n:{},r))}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$b18a2b65150b428f$export$128f6c8d329dc399=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.offset=0,this.value=90}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.offset&&(this.offset=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.offset)),void 0!==e.value&&(this.value=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.value)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$173db7193d96d667$export$6c54633883102b4b=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)&&(void 0!==e.distance&&(this.distance=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.distance)),void 0!==e.enable&&(this.enable=e.enable),e.rotate)){var t=e.rotate.x;void 0!==t&&(this.rotate.x=t);var i=e.rotate.y;void 0!==i&&(this.rotate.y=i)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$f79fc4e58dd698f7$export$7b60622f06eeec06=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.x=50,this.y=50,this.mode=$e2421ddcce10c8e2$export$1009f0178778a981.percent,this.radius=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.x&&(this.x=e.x),void 0!==e.y&&(this.y=e.y),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.radius&&(this.radius=e.radius))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$1a6091fdfb872abf$export$c6d1f1b3593b164c=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.acceleration&&(this.acceleration=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.inverse&&(this.inverse=e.inverse),void 0!==e.maxSpeed&&(this.maxSpeed=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.maxSpeed)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$ef87374c1a36c343$export$bcc70636a6a97e73=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.clamp=!0,this.delay=new $8ac1d20a0becf385$export$2f74c042fca0b66d,this.enable=!1,this.options={}}return(0,$7h4XF._)(e,[{key:"load",value:function(e){!$e55b0963af399424$export$630801d484da15df(e)&&(void 0!==e.clamp&&(this.clamp=e.clamp),this.delay.load(e.delay),void 0!==e.enable&&(this.enable=e.enable),this.generator=e.generator,e.options&&(this.options=$45e196d141848e3a$export$54e9fb29908872fa(this.options,e.options)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$a05ae3b44d9701b0$export$7518c5bd39f0f31a=function(){"use strict";function e(){(0,$cx0mh._)(this,e)}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.color&&(this.color=$30faee5cc856d563$export$c2b08aa25660fcaa.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image))}}]),e}(),$e0bd0ac657aed626$export$e428bb3fcf53809d=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!1,this.length=10,this.fill=new $a05ae3b44d9701b0$export$7518c5bd39f0f31a}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.fill&&this.fill.load(e.fill),void 0!==e.length&&(this.length=e.length))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.bounce="bounce",e.none="none",e.out="out",e.destroy="destroy",e.split="split"}($ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2||($ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2={}));var $764c42fb04621ec2$export$647cf31ffff2d3=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.default=$ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2.out}return(0,$7h4XF._)(e,[{key:"load",value:function(e){var t,i,n,r;$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.default&&(this.default=e.default),this.bottom=null!=(t=e.bottom)?t:e.default,this.left=null!=(i=e.left)?i:e.default,this.right=null!=(n=e.right)?n:e.default,this.top=null!=(r=e.top)?r:e.default)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$d548c0e389c364aa$export$fcd783eeafc305c0=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.acceleration=0,this.enable=!1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){!$e55b0963af399424$export$630801d484da15df(e)&&(void 0!==e.acceleration&&(this.acceleration=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),e.position&&(this.position=$45e196d141848e3a$export$54e9fb29908872fa({},e.position)))}}]),e}(),$b3395b9cd4f2649a$export$e49a5ad3dd6df925=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.angle=new $b18a2b65150b428f$export$128f6c8d329dc399,this.attract=new $173db7193d96d667$export$6c54633883102b4b,this.center=new $f79fc4e58dd698f7$export$7b60622f06eeec06,this.decay=0,this.distance={},this.direction=$e304e157140fab16$export$cc1a246adca07dd4.none,this.drift=0,this.enable=!1,this.gravity=new $1a6091fdfb872abf$export$c6d1f1b3593b164c,this.path=new $ef87374c1a36c343$export$bcc70636a6a97e73,this.outModes=new $764c42fb04621ec2$export$647cf31ffff2d3,this.random=!1,this.size=!1,this.speed=2,this.spin=new $d548c0e389c364aa$export$fcd783eeafc305c0,this.straight=!1,this.trail=new $e0bd0ac657aed626$export$e428bb3fcf53809d,this.vibrate=!1,this.warp=!1}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){this.angle.load($e55b0963af399424$export$7e4aa119212bc614(e.angle)?{value:e.angle}:e.angle),this.attract.load(e.attract),this.center.load(e.center),void 0!==e.decay&&(this.decay=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.decay)),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.distance&&(this.distance=$e55b0963af399424$export$7e4aa119212bc614(e.distance)?{horizontal:e.distance,vertical:e.distance}:(0,$cL71g._)({},e.distance)),void 0!==e.drift&&(this.drift=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.drift)),void 0!==e.enable&&(this.enable=e.enable),this.gravity.load(e.gravity);var t=e.outModes;void 0!==t&&($e55b0963af399424$export$a6cdc56e425d0d0a(t)?this.outModes.load(t):this.outModes.load({default:t})),this.path.load(e.path),void 0!==e.random&&(this.random=e.random),void 0!==e.size&&(this.size=e.size),void 0!==e.speed&&(this.speed=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.speed)),this.spin.load(e.spin),void 0!==e.straight&&(this.straight=e.straight),this.trail.load(e.trail),void 0!==e.vibrate&&(this.vibrate=e.vibrate),void 0!==e.warp&&(this.warp=e.warp)}}}]),e}(),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$2dabeaa69b1cb814$export$3e55dc49e2356209=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).destroy=$1f208ea7a7967b27$export$41a461248611663e.none,e.speed=2,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),$e55b0963af399424$export$630801d484da15df(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}]),t}($31a4d6c663f5d47b$export$664e182a9c83d6f5),$e511cd0c40ea957b$export$588760baa0f6108e=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).animation=new $2dabeaa69b1cb814$export$3e55dc49e2356209,e.value=1,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e);var i=e.animation;void 0!==i&&this.animation.load(i)}}}]),t}($8ac1d20a0becf385$export$8d0da1142c209427),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$126b00bdef46c963$export$c11b1f56b7022ac8=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.enable=!1,this.width=1920,this.height=1080}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){void 0!==e.enable&&(this.enable=e.enable);var t=e.width;void 0!==t&&(this.width=t);var i=e.height;void 0!==i&&(this.height=i)}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF");!function(e){e.delete="delete",e.wait="wait"}($5c76476020892ee7$export$e9c6a0495dc4055f||($5c76476020892ee7$export$e9c6a0495dc4055f={}));var $d1d4db4ecb293ecf$export$924e931bcf950072=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.mode=$5c76476020892ee7$export$e9c6a0495dc4055f.delete,this.value=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}]),e}(),$393e2701b070d76d$export$2335cf7e85f36cfd=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.density=new $126b00bdef46c963$export$c11b1f56b7022ac8,this.limit=new $d1d4db4ecb293ecf$export$924e931bcf950072,this.value=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(this.density.load(e.density),this.limit.load(e.limit),void 0!==e.value&&(this.value=e.value))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$6246114ee87f05a1$export$a24c14443968327c=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.blur=0,this.color=new $30faee5cc856d563$export$c2b08aa25660fcaa,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.blur&&(this.blur=e.blur),this.color=$30faee5cc856d563$export$c2b08aa25660fcaa.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.offset&&(void 0!==e.offset.x&&(this.offset.x=e.offset.x),void 0!==e.offset.y&&(this.offset.y=e.offset.y)))}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$a4aa429be22481a5$export$6428a7f2611ef1fa=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.close=!0,this.fill=!0,this.options={},this.type="circle"}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){var t=e.options;if(void 0!==t)for(var i in t){var n,r=t[i];r&&(this.options[i]=$45e196d141848e3a$export$54e9fb29908872fa(null!=(n=this.options[i])?n:{},r))}void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}}]),e}(),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$5b0ce7cd4f8d8f55$export$231e08f1693c0669=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).destroy=$1f208ea7a7967b27$export$41a461248611663e.none,e.speed=5,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),$e55b0963af399424$export$630801d484da15df(e)||void 0!==e.destroy&&(this.destroy=e.destroy)}}]),t}($31a4d6c663f5d47b$export$664e182a9c83d6f5),$a2a7661aabcf977b$export$cb6da89c6af1a8ec=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).animation=new $5b0ce7cd4f8d8f55$export$231e08f1693c0669,e.value=3,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){if($4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),!$e55b0963af399424$export$630801d484da15df(e)){var i=e.animation;void 0!==i&&this.animation.load(i)}}}]),t}($8ac1d20a0becf385$export$8d0da1142c209427),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2037a4d1f80ca839$export$18d19c7a3aa33064=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.width=0}return(0,$7h4XF._)(e,[{key:"load",value:function(e){$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.color&&(this.color=$b87181e28955b8a0$export$6f79b6ff75533155.create(this.color,e.color)),void 0!==e.width&&(this.width=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.width)),void 0!==e.opacity&&(this.opacity=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.opacity)))}}]),e}(),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2JCCy=parcelRequire("2JCCy"),$9xmuV=parcelRequire("9xmuV"),$918b0203b3a73fc8$export$ccb31788083e2069=function(e){"use strict";function t(){var e;return(0,$cx0mh._)(this,t),(e=(0,$fFwUa._)(this,t)).opacityRate=1,e.sizeRate=1,e.velocityRate=1,e}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"load",value:function(e){$4391a308ec80562d$export$71511d61b312f219((0,$2JCCy._)(t.prototype),"load",this).call(this,e),$e55b0963af399424$export$630801d484da15df(e)||(void 0!==e.opacityRate&&(this.opacityRate=e.opacityRate),void 0!==e.sizeRate&&(this.sizeRate=e.sizeRate),void 0!==e.velocityRate&&(this.velocityRate=e.velocityRate))}}]),t}($8ac1d20a0becf385$export$2f74c042fca0b66d),$cc599a2060bf1b18$export$b4f1619131f0bce9=function(){"use strict";function e(t,i){(0,$cx0mh._)(this,e),this._engine=t,this._container=i,this.bounce=new $1dce2fe8607e722d$export$e6dd54c89cd6ac88,this.collisions=new $6b4b5a58c6bdf2c1$export$97ff58b0eb9a5ed0,this.color=new $b87181e28955b8a0$export$6f79b6ff75533155,this.color.value="#fff",this.effect=new $5d42e3025e57c75b$export$a32b0b1c1ac59d04,this.groups={},this.move=new $b3395b9cd4f2649a$export$e49a5ad3dd6df925,this.number=new $393e2701b070d76d$export$2335cf7e85f36cfd,this.opacity=new $e511cd0c40ea957b$export$588760baa0f6108e,this.reduceDuplicates=!1,this.shadow=new $6246114ee87f05a1$export$a24c14443968327c,this.shape=new $a4aa429be22481a5$export$6428a7f2611ef1fa,this.size=new $a2a7661aabcf977b$export$cb6da89c6af1a8ec,this.stroke=new $2037a4d1f80ca839$export$18d19c7a3aa33064,this.zIndex=new $918b0203b3a73fc8$export$ccb31788083e2069}return(0,$7h4XF._)(e,[{key:"load",value:function(e){if(!$e55b0963af399424$export$630801d484da15df(e)){var t=!0,i=!1,n=void 0;if(void 0!==e.groups)try{for(var r,a=Object.keys(e.groups)[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s,o=r.value;if(Object.hasOwn(e.groups,o)){var l=e.groups[o];void 0!==l&&(this.groups[o]=$45e196d141848e3a$export$54e9fb29908872fa(null!=(s=this.groups[o])?s:{},l))}}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}void 0!==e.reduceDuplicates&&(this.reduceDuplicates=e.reduceDuplicates),this.bounce.load(e.bounce),this.color.load($b87181e28955b8a0$export$6f79b6ff75533155.create(this.color,e.color)),this.effect.load(e.effect),this.move.load(e.move),this.number.load(e.number),this.opacity.load(e.opacity),this.shape.load(e.shape),this.size.load(e.size),this.shadow.load(e.shadow),this.zIndex.load(e.zIndex),this.collisions.load(e.collisions),void 0!==e.interactivity&&(this.interactivity=$45e196d141848e3a$export$54e9fb29908872fa({},e.interactivity));var h=e.stroke;if(h&&(this.stroke=$45e196d141848e3a$export$8e5dc47097396754(h,function(e){var t=new $2037a4d1f80ca839$export$18d19c7a3aa33064;return t.load(e),t})),this._container){var c=this._engine.updaters.get(this._container);if(c){var u=!0,d=!1,p=void 0;try{for(var f,g=c[Symbol.iterator]();!(u=(f=g.next()).done);u=!0){var v=f.value;v.loadOptions&&v.loadOptions(this,e)}}catch(e){d=!0,p=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw p}}}var m=this._engine.interactors.get(this._container);if(m){var y=!0,x=!1,b=void 0;try{for(var w,k=m[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var B=w.value;B.loadParticlesOptions&&B.loadParticlesOptions(this,e)}}catch(e){x=!0,b=e}finally{try{y||null==k.return||k.return()}finally{if(x)throw b}}}}}}}]),e}();function $5b39c3e502bab1cd$export$cad72087bded938(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=!0,a=!1,s=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;e.load(h)}}catch(e){a=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}}function $5b39c3e502bab1cd$export$3e14721506027822(e,t){for(var i=arguments.length,n=Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var a=new $cc599a2060bf1b18$export$b4f1619131f0bce9(e,t);return $5b39c3e502bab1cd$export$cad72087bded938.apply(void 0,[a].concat((0,$bX4ja._)(n))),a}var $44a825250a5b45c8$export$c019608e5b5bb4cb=function(){"use strict";function e(t,i){var n=this;(0,$cx0mh._)(this,e),this._findDefaultTheme=function(e){var t;return null!=(t=n.themes.find(function(t){return t.default.value&&t.default.mode===e}))?t:n.themes.find(function(e){return e.default.value&&e.default.mode===$cb51e19a22472144$export$cd01a11ba097c64c.any})},this._importPreset=function(e){n.load(n._engine.getPreset(e))},this._engine=t,this._container=i,this.autoPlay=!0,this.background=new $ff26e11914e51559$export$668799e4797757a8,this.backgroundMask=new $e2a7c1670e29030a$export$36a2fa1e47ffeebc,this.clear=!0,this.defaultThemes={},this.delay=0,this.fullScreen=new $fe0fe246206b14eb$export$f885b95b3f0be76d,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new $4d745957d593b972$export$865458a3ba269c4a(t,i),this.manualParticles=[],this.particles=$5b39c3e502bab1cd$export$3e14721506027822(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}return(0,$7h4XF._)(e,[{key:"load",value:function(e){var t=this;if(!$e55b0963af399424$export$630801d484da15df(e)){void 0!==e.preset&&$45e196d141848e3a$export$8e5dc47097396754(e.preset,function(e){return t._importPreset(e)}),void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.clear&&(this.clear=e.clear),void 0!==e.key&&(this.key=e.key),void 0!==e.name&&(this.name=e.name),void 0!==e.delay&&(this.delay=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.delay));var i=e.detectRetina;void 0!==i&&(this.detectRetina=i),void 0!==e.duration&&(this.duration=$e8499b8b34df9b2a$export$6dcd5a07b989db7(e.duration));var n=e.fpsLimit;void 0!==n&&(this.fpsLimit=n),void 0!==e.pauseOnBlur&&(this.pauseOnBlur=e.pauseOnBlur),void 0!==e.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=e.pauseOnOutsideViewport),void 0!==e.zLayers&&(this.zLayers=e.zLayers),this.background.load(e.background);var r=e.fullScreen;$e55b0963af399424$export$f9ce7b637dfbe238(r)?this.fullScreen.enable=r:this.fullScreen.load(r),this.backgroundMask.load(e.backgroundMask),this.interactivity.load(e.interactivity),e.manualParticles&&(this.manualParticles=e.manualParticles.map(function(e){var t=new $6a36af2d3cdfeab1$export$4f41a3ab9fa8cdf;return t.load(e),t})),this.particles.load(e.particles),this.style=$45e196d141848e3a$export$54e9fb29908872fa(this.style,e.style),this._engine.loadOptions(this,e),void 0!==e.smooth&&(this.smooth=e.smooth);var a=this._engine.interactors.get(this._container);if(a){var s=!0,o=!1,l=void 0;try{for(var h,c,u,d=a[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value;p.loadOptions&&p.loadOptions(this,e)}}catch(e){o=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(o)throw l}}}var f=!0,g=!1,v=void 0;if(void 0!==e.responsive)try{for(var m,y=e.responsive[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var x=m.value,b=new $996b087d4a7a13e8$export$49b67f1c7ac91d9b;b.load(x),this.responsive.push(b)}}catch(e){g=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(g)throw v}}this.responsive.sort(function(e,t){return e.maxWidth-t.maxWidth});var w=!0,k=!1,B=void 0;if(void 0!==e.themes)try{for(var S,C,E=function(){var e=C.value,t=S.themes.find(function(t){return t.name===e.name});if(t)t.load(e);else{var i=new $97e7d8bd53e27a1d$export$14faa19a0f3bbeb2;i.load(e),S.themes.push(i)}},_=e.themes[Symbol.iterator]();!(w=(C=_.next()).done);w=!0)S=this,E()}catch(e){k=!0,B=e}finally{try{w||null==_.return||_.return()}finally{if(k)throw B}}this.defaultThemes.dark=null==(h=this._findDefaultTheme($cb51e19a22472144$export$cd01a11ba097c64c.dark))?void 0:h.name,this.defaultThemes.light=null==(c=this._findDefaultTheme($cb51e19a22472144$export$cd01a11ba097c64c.light))?void 0:c.name}}},{key:"setResponsive",value:function(e,t,i){this.load(i);var n=this.responsive.find(function(i){return i.mode===$7d7aa6fd00f3e48f$export$73c2705cb2da08ab.screen&&screen?i.maxWidth>screen.availWidth:i.maxWidth*t>e});return this.load(null==n?void 0:n.options),null==n?void 0:n.maxWidth}},{key:"setTheme",value:function(e){if(e){var t=this.themes.find(function(t){return t.name===e});t&&this.load(t.options)}else{var i=$45e196d141848e3a$export$db32b9574e21e00f("(prefers-color-scheme: dark)"),n=null==i?void 0:i.matches,r=this._findDefaultTheme(n?$cb51e19a22472144$export$cd01a11ba097c64c.dark:$cb51e19a22472144$export$cd01a11ba097c64c.light);r&&this.load(r.options)}}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2gUX3=parcelRequire("2gUX3");!function(e){e.external="external",e.particles="particles"}($35f0e6a9a0aa9be9$export$143a800d561d28fd||($35f0e6a9a0aa9be9$export$143a800d561d28fd={}));var $071291eba7a28b39$export$aaa80641d584351c=function(){"use strict";function e(t,i){(0,$cx0mh._)(this,e),this.container=i,this._engine=t,this._interactors=[],this._externalInteractors=[],this._particleInteractors=[]}return(0,$7h4XF._)(e,[{key:"externalInteract",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=this._externalInteractors[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;s.isEnabled()&&s.interact(e)}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"handleClickMode",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a,s=this._externalInteractors[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value;null==(r=o.handleClickMode)||r.call(o,e)}}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}}},{key:"init",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s;return(0,$2gUX3.__generator)(this,function(o){switch(o.label){case 0:return e=this,[4,this._engine.getInteractors(this.container,!0)];case 1:e._interactors=o.sent(),this._externalInteractors=[],this._particleInteractors=[],t=!0,i=!1,n=void 0;try{for(r=this._interactors[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){switch((s=a.value).type){case $35f0e6a9a0aa9be9$export$143a800d561d28fd.external:this._externalInteractors.push(s);break;case $35f0e6a9a0aa9be9$export$143a800d561d28fd.particles:this._particleInteractors.push(s)}s.init()}}catch(e){i=!0,n=e}finally{try{t||null==r.return||r.return()}finally{if(i)throw n}}return[2]}})}).call(this)}},{key:"particlesInteract",value:function(e,t){var i=!0,n=!1,r=void 0;try{for(var a,s=this._externalInteractors[Symbol.iterator]();!(i=(a=s.next()).done);i=!0)a.value.clear(e,t)}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}var o=!0,l=!1,h=void 0;try{for(var c,u=this._particleInteractors[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;d.isEnabled(e)&&d.interact(e,t)}}catch(e){l=!0,h=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw h}}}},{key:"reset",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=this._externalInteractors[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;s.isEnabled()&&s.reset(e)}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}var o=!0,l=!1,h=void 0;try{for(var c,u=this._particleInteractors[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;d.isEnabled(e)&&d.reset(e)}}catch(e){l=!0,h=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw h}}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$bX4ja=parcelRequire("bX4ja");function $42aa3bbd561591dd$var$loadEffectData(e,t,i,n){var r=t.options[e];if(r)return $45e196d141848e3a$export$54e9fb29908872fa({close:t.close,fill:t.fill},$45e196d141848e3a$export$3fbf39566d3ee62e(r,i,n))}function $42aa3bbd561591dd$var$loadShapeData(e,t,i,n){var r=t.options[e];if(r)return $45e196d141848e3a$export$54e9fb29908872fa({close:t.close,fill:t.fill},$45e196d141848e3a$export$3fbf39566d3ee62e(r,i,n))}function $42aa3bbd561591dd$var$fixOutMode(e){if($45e196d141848e3a$export$5e9bb4359042e24b(e.outMode,e.checkModes)){var t=e.radius*$6dc45f7ab9b94c34$export$7b3cbda67be88f5f;e.coord>e.maxCoord-t?e.setCb(-e.radius):e.coord<t&&e.setCb(e.radius)}}!function(e){e.normal="normal",e.inside="inside",e.outside="outside"}($a49f5cd2bf596e66$export$2e559b10bdb6bb80||($a49f5cd2bf596e66$export$2e559b10bdb6bb80={}));var $42aa3bbd561591dd$export$c36c68baa13912a5=function(){"use strict";function e(t,i){var n=this,r=this;(0,$cx0mh._)(this,e),this.container=i,this._calcPosition=function(e,t,i){var n,a,s,o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$6dc45f7ab9b94c34$export$b0d937bb246b1db5,h=!0,c=!1,u=void 0;try{for(var d,p=e.plugins.values()[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var f=d.value,g=void 0!==f.particlePosition?f.particlePosition(t,r):void 0;if(g)return $608fa043a85a8aae$export$ece015703618ce3d.create(g.x,g.y,i)}}catch(e){c=!0,u=e}finally{try{h||null==p.return||p.return()}finally{if(c)throw u}}var v=$e8499b8b34df9b2a$export$a3c87c98a736c457({size:e.canvas.size,position:t}),m=$608fa043a85a8aae$export$ece015703618ce3d.create(v.x,v.y,i),y=r.getRadius(),x=r.options.move.outModes,b=function(t){$42aa3bbd561591dd$var$fixOutMode({outMode:t,checkModes:[$ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2.bounce],coord:m.x,maxCoord:e.canvas.size.width,setCb:function(e){return m.x+=e},radius:y})},w=function(t){$42aa3bbd561591dd$var$fixOutMode({outMode:t,checkModes:[$ac1bd52e36ba7f8c$export$cf5942d9a76b7ae2.bounce],coord:m.y,maxCoord:e.canvas.size.height,setCb:function(e){return m.y+=e},radius:y})};return(b(null!=(n=x.left)?n:x.default),b(null!=(a=x.right)?a:x.default),w(null!=(s=x.top)?s:x.default),w(null!=(o=x.bottom)?o:x.default),r._checkOverlap(m,l))?r._calcPosition(e,void 0,i,l+$6dc45f7ab9b94c34$export$c6a00718c1294b26):m},this._calculateVelocity=function(){var e=$e8499b8b34df9b2a$export$cce6f12debc4024a(n.direction).copy(),t=n.options.move;if(t.direction===$e304e157140fab16$export$cc1a246adca07dd4.inside||t.direction===$e304e157140fab16$export$cc1a246adca07dd4.outside)return e;var i=$e8499b8b34df9b2a$export$e6bfdeff8bfc94f9($e8499b8b34df9b2a$export$e70c64b68236cb4e(t.angle.value)),r=$e8499b8b34df9b2a$export$e6bfdeff8bfc94f9($e8499b8b34df9b2a$export$e70c64b68236cb4e(t.angle.offset)),a={left:r-i*$6dc45f7ab9b94c34$export$3ced024fb15e6103,right:r+i*$6dc45f7ab9b94c34$export$3ced024fb15e6103};return t.straight||(e.angle+=$e8499b8b34df9b2a$export$8b958c8ecd94a804($e8499b8b34df9b2a$export$6dcd5a07b989db7(a.left,a.right))),t.random&&"number"==typeof t.speed&&(e.length*=$e8499b8b34df9b2a$export$1a76347094524b3b()),e},this._checkOverlap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$6dc45f7ab9b94c34$export$b0d937bb246b1db5,i=r.options.collisions,n=r.getRadius();if(!i.enable)return!1;var a=i.overlap;if(a.enable)return!1;var s=a.retries;if(s>=$6dc45f7ab9b94c34$export$9ad4c81d91619fd0&&t>s)throw Error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} particle is overlapping and can't be placed`);return!!r.container.particles.find(function(t){return $e8499b8b34df9b2a$export$79376507b09a66f(e,t.position)<n+t.getRadius()})},this._getRollColor=function(e){if(!e||!n.roll||!n.backColor&&!n.roll.alter)return e;var t,i=n.roll.horizontal&&n.roll.vertical?$6dc45f7ab9b94c34$export$7b3cbda67be88f5f*$6dc45f7ab9b94c34$export$40d4bf4da5fab6a3:$6dc45f7ab9b94c34$export$40d4bf4da5fab6a3,r=n.roll.horizontal?Math.PI*$6dc45f7ab9b94c34$export$3ced024fb15e6103:$6dc45f7ab9b94c34$export$f883a24d5edde77c;return Math.floor(((null!=(t=n.roll.angle)?t:$6dc45f7ab9b94c34$export$f883a24d5edde77c)+r)/(Math.PI/i))%$6dc45f7ab9b94c34$export$7b3cbda67be88f5f?n.backColor?n.backColor:n.roll.alter?$22b29924e93d96ee$export$fe1d034b0e82666(e,n.roll.alter.type,n.roll.alter.value):e:e},this._initPosition=function(e){var t,i,r=n.container,a=$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.options.zIndex.value);n.position=n._calcPosition(r,e,$e8499b8b34df9b2a$export$7d15b64cf5a3a4c4(a,$6dc45f7ab9b94c34$export$ce94e349d95a214c,r.zLayers)),n.initialPosition=n.position.copy();var s=r.canvas.size;switch(n.moveCenter=(0,$4EWN2._)((0,$cL71g._)({},$45e196d141848e3a$export$1690e12b840569b9(n.options.move.center,s)),{radius:null!=(t=n.options.move.center.radius)?t:$6dc45f7ab9b94c34$export$7dab3a147ef97e31,mode:null!=(i=n.options.move.center.mode)?i:$e2421ddcce10c8e2$export$1009f0178778a981.percent}),n.direction=$e8499b8b34df9b2a$export$2045f76df51d18c4(n.options.move.direction,n.position,n.moveCenter),n.options.move.direction){case $e304e157140fab16$export$cc1a246adca07dd4.inside:n.outType=$a49f5cd2bf596e66$export$2e559b10bdb6bb80.inside;break;case $e304e157140fab16$export$cc1a246adca07dd4.outside:n.outType=$a49f5cd2bf596e66$export$2e559b10bdb6bb80.outside}n.offset=$608fa043a85a8aae$export$9b781de7bf37bf48.origin},this._engine=t}return(0,$7h4XF._)(e,[{key:"destroy",value:function(e){if(!this.unbreakable&&!this.destroyed){this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;var t=this.container,i=this.pathGenerator,n=t.shapeDrawers.get(this.shape);null==n||null==(o=n.particleDestroy)||o.call(n,this);var r=!0,a=!1,s=void 0;try{for(var o,l,h,c,u=t.plugins.values()[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var d=c.value;null==(l=d.particleDestroyed)||l.call(d,this,e)}}catch(e){a=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}var p=!0,f=!1,g=void 0;try{for(var v,m=t.particles.updaters[Symbol.iterator]();!(p=(v=m.next()).done);p=!0){var y=v.value;null==(h=y.particleDestroyed)||h.call(y,this,e)}}catch(e){f=!0,g=e}finally{try{p||null==m.return||m.return()}finally{if(f)throw g}}null==i||i.reset(this),this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.particleDestroyed,{container:this.container,data:{particle:this}})}}},{key:"draw",value:function(e){var t=this.container,i=t.canvas,n=!0,r=!1,a=void 0;try{for(var s,o=t.plugins.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;i.drawParticlePlugin(l,this,e)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i.drawParticle(this,e)}},{key:"getFillColor",value:function(){var e;return this._getRollColor(null!=(e=this.bubble.color)?e:$7221c4a44f814a20$export$c90768c73bc1d7ab(this.color))}},{key:"getMass",value:function(){return Math.pow(this.getRadius(),$6dc45f7ab9b94c34$export$69af1894d00750e2)*Math.PI*$6dc45f7ab9b94c34$export$3ced024fb15e6103}},{key:"getPosition",value:function(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}},{key:"getRadius",value:function(){var e;return null!=(e=this.bubble.radius)?e:this.size.value}},{key:"getStrokeColor",value:function(){var e;return this._getRollColor(null!=(e=this.bubble.color)?e:$7221c4a44f814a20$export$c90768c73bc1d7ab(this.strokeColor))}},{key:"init",value:function(e,t,i,n){var r=this.container,a=this._engine;this.id=e,this.group=n,this.effectClose=!0,this.effectFill=!0,this.shapeClose=!0,this.shapeFill=!0,this.pathRotation=!1,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.isRotating=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType=$a49f5cd2bf596e66$export$2e559b10bdb6bb80.normal,this.ignoresResizeRatio=!0;var s=r.retina.pixelRatio,o=r.actualOptions,l=$5b39c3e502bab1cd$export$3e14721506027822(this._engine,r,o.particles),h=l.reduceDuplicates,c=l.effect.type,u=l.shape.type;this.effect=$45e196d141848e3a$export$3fbf39566d3ee62e(c,this.id,h),this.shape=$45e196d141848e3a$export$3fbf39566d3ee62e(u,this.id,h);var d=l.effect,p=l.shape;if(i){if(null==(P=i.effect)?void 0:P.type){var f=$45e196d141848e3a$export$3fbf39566d3ee62e(i.effect.type,this.id,h);f&&(this.effect=f,d.load(i.effect))}if(null==(A=i.shape)?void 0:A.type){var g=$45e196d141848e3a$export$3fbf39566d3ee62e(i.shape.type,this.id,h);g&&(this.shape=g,p.load(i.shape))}}if(this.effect===$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb){var v=(0,$bX4ja._)(this.container.effectDrawers.keys());this.effect=v[Math.floor($e8499b8b34df9b2a$export$1a76347094524b3b()*v.length)]}if(this.shape===$6dc45f7ab9b94c34$export$2f8238aef5a0a8eb){var m=(0,$bX4ja._)(this.container.shapeDrawers.keys());this.shape=m[Math.floor($e8499b8b34df9b2a$export$1a76347094524b3b()*m.length)]}this.effectData=$42aa3bbd561591dd$var$loadEffectData(this.effect,d,this.id,h),this.shapeData=$42aa3bbd561591dd$var$loadShapeData(this.shape,p,this.id,h),l.load(i);var y=this.effectData;y&&l.load(y.particles);var x=this.shapeData;x&&l.load(x.particles);var b=new $4d745957d593b972$export$865458a3ba269c4a(a,r);b.load(r.actualOptions.interactivity),b.load(l.interactivity),this.interactivity=b,this.effectFill=null!=(D=null==y?void 0:y.fill)?D:l.effect.fill,this.effectClose=null!=(O=null==y?void 0:y.close)?O:l.effect.close,this.shapeFill=null!=(z=null==x?void 0:x.fill)?z:l.shape.fill,this.shapeClose=null!=(H=null==x?void 0:x.close)?H:l.shape.close,this.options=l;var w=this.options.move.path;this.pathDelay=$e8499b8b34df9b2a$export$e70c64b68236cb4e(w.delay.value)*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f,w.generator&&(this.pathGenerator=this._engine.getPathGenerator(w.generator),this.pathGenerator&&r.addPath(w.generator,this.pathGenerator)&&this.pathGenerator.init(r)),r.retina.initParticle(this),this.size=$45e196d141848e3a$export$bebd78259cce4fd(this.options.size,s),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(t),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=$6dc45f7ab9b94c34$export$a05b467d53228ab9-$e8499b8b34df9b2a$export$e70c64b68236cb4e(this.options.move.decay);var k=r.particles;k.setLastZIndex(this.position.z),this.zIndexFactor=this.position.z/r.zLayers,this.sides=24;var B=r.effectDrawers.get(this.effect);!B&&(B=this._engine.getEffectDrawer(this.effect))&&r.effectDrawers.set(this.effect,B),(null==B?void 0:B.loadEffect)&&B.loadEffect(this);var S=r.shapeDrawers.get(this.shape);!S&&(S=this._engine.getShapeDrawer(this.shape))&&r.shapeDrawers.set(this.shape,S),(null==S?void 0:S.loadShape)&&S.loadShape(this);var C=null==S?void 0:S.getSidesCount;C&&(this.sides=C(this)),this.spawning=!1,this.shadowColor=$7221c4a44f814a20$export$fbf0bf3cc1fc0cc4(this._engine,this.options.shadow.color);var E=!0,_=!1,I=void 0;try{for(var T,M,L,R,P,A,D,O,z,H,j,F=k.updaters[Symbol.iterator]();!(E=(j=F.next()).done);E=!0)j.value.init(this)}catch(e){_=!0,I=e}finally{try{E||null==F.return||F.return()}finally{if(_)throw I}}var X=!0,V=!1,U=void 0;try{for(var W,N=k.movers[Symbol.iterator]();!(X=(W=N.next()).done);X=!0){var Y=W.value;null==(T=Y.init)||T.call(Y,this)}}catch(e){V=!0,U=e}finally{try{X||null==N.return||N.return()}finally{if(V)throw U}}null==B||null==(M=B.particleInit)||M.call(B,r,this),null==S||null==(L=S.particleInit)||L.call(S,r,this);var G=!0,K=!1,Z=void 0;try{for(var q,$=r.plugins.values()[Symbol.iterator]();!(G=(q=$.next()).done);G=!0){var J=q.value;null==(R=J.particleCreated)||R.call(J,this)}}catch(e){K=!0,Z=e}finally{try{G||null==$.return||$.return()}finally{if(K)throw Z}}}},{key:"isInsideCanvas",value:function(){var e=this.getRadius(),t=this.container.canvas.size,i=this.position;return i.x>=-e&&i.y>=-e&&i.y<=t.height+e&&i.x<=t.width+e}},{key:"isVisible",value:function(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}},{key:"reset",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r,a=this.container.particles.updaters[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;null==(n=s.reset)||n.call(s,this)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$45089bd2aab345ac$export$baf26146a414f24a=function e(t,i){"use strict";(0,$cx0mh._)(this,e),this.position=t,this.particle=i},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$fFwUa=parcelRequire("fFwUa"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$9xmuV=parcelRequire("9xmuV");!function(e){e.circle="circle",e.rectangle="rectangle"}($a591b6a325fc72d7$export$2ede450fbdbb4e4c||($a591b6a325fc72d7$export$2ede450fbdbb4e4c={}));var $538e60494ef20eea$export$f237afe0deab98f9=function e(t,i,n){"use strict";(0,$cx0mh._)(this,e),this.position={x:t,y:i},this.type=n},$538e60494ef20eea$export$c89a927ffc67e6fa=function(e){"use strict";function t(e,i,n){var r;return(0,$cx0mh._)(this,t),(r=(0,$fFwUa._)(this,t,[e,i,$a591b6a325fc72d7$export$2ede450fbdbb4e4c.circle])).radius=n,r}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"contains",value:function(e){return $e8499b8b34df9b2a$export$79376507b09a66f(e,this.position)<=this.radius}},{key:"intersects",value:function(e){var i=this.position,n=e.position,r={x:Math.abs(n.x-i.x),y:Math.abs(n.y-i.y)},a=this.radius;if(e instanceof t||e.type===$a591b6a325fc72d7$export$2ede450fbdbb4e4c.circle)return a+e.radius>Math.sqrt(Math.pow(r.x,$6dc45f7ab9b94c34$export$69af1894d00750e2)+Math.pow(r.y,$6dc45f7ab9b94c34$export$69af1894d00750e2));if(e instanceof $538e60494ef20eea$export$4617fb02663045ef||e.type===$a591b6a325fc72d7$export$2ede450fbdbb4e4c.rectangle){var s=e.size,o=s.width,l=s.height;return Math.pow(r.x-o,$6dc45f7ab9b94c34$export$69af1894d00750e2)+Math.pow(r.y-l,$6dc45f7ab9b94c34$export$69af1894d00750e2)<=Math.pow(a,$6dc45f7ab9b94c34$export$69af1894d00750e2)||r.x<=a+o&&r.y<=a+l||r.x<=o||r.y<=l}return!1}}]),t}($538e60494ef20eea$export$f237afe0deab98f9),$538e60494ef20eea$export$4617fb02663045ef=function(e){"use strict";function t(e,i,n,r){var a;return(0,$cx0mh._)(this,t),(a=(0,$fFwUa._)(this,t,[e,i,$a591b6a325fc72d7$export$2ede450fbdbb4e4c.rectangle])).size={height:r,width:n},a}return(0,$9xmuV._)(t,e),(0,$7h4XF._)(t,[{key:"contains",value:function(e){var t=this.size.width,i=this.size.height,n=this.position;return e.x>=n.x&&e.x<=n.x+t&&e.y>=n.y&&e.y<=n.y+i}},{key:"intersects",value:function(e){if(e instanceof $538e60494ef20eea$export$c89a927ffc67e6fa)return e.intersects(this);var i=this.size.width,n=this.size.height,r=this.position,a=e.position,s=e instanceof t?e.size:{width:0,height:0},o=s.width,l=s.height;return a.x<r.x+i&&a.x+o>r.x&&a.y<r.y+n&&a.y+l>r.y}}]),t}($538e60494ef20eea$export$f237afe0deab98f9),$e75d251b7cecf9c2$export$b82688eb02220411=function(){"use strict";function e(t,i){var n=this;(0,$cx0mh._)(this,e),this.rectangle=t,this.capacity=i,this._subdivide=function(){for(var t=n.rectangle.position,i=t.x,r=t.y,a=n.rectangle.size,s=a.width,o=a.height,l=n.capacity,h=0;h<$6dc45f7ab9b94c34$export$857680dbc0592f23;h++){var c=h%$6dc45f7ab9b94c34$export$7b3cbda67be88f5f;n._subs.push(new e(new $538e60494ef20eea$export$4617fb02663045ef(i+s*$6dc45f7ab9b94c34$export$3ced024fb15e6103*c,r+o*$6dc45f7ab9b94c34$export$3ced024fb15e6103*(Math.round(h*$6dc45f7ab9b94c34$export$3ced024fb15e6103)-c),s*$6dc45f7ab9b94c34$export$3ced024fb15e6103,o*$6dc45f7ab9b94c34$export$3ced024fb15e6103),l))}n._divided=!0},this._points=[],this._divided=!1,this._subs=[]}return(0,$7h4XF._)(e,[{key:"insert",value:function(e){return!!this.rectangle.contains(e.position)&&(this._points.length<this.capacity?(this._points.push(e),!0):(this._divided||this._subdivide(),this._subs.some(function(t){return t.insert(e)})))}},{key:"query",value:function(e,t){var i=[];if(!e.intersects(this.rectangle))return[];var n=!0,r=!1,a=void 0;try{for(var s,o,l=this._points[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var h=o.value;!e.contains(h.position)&&$e8499b8b34df9b2a$export$79376507b09a66f(e.position,h.position)>h.particle.getRadius()&&(!t||t(h.particle))||i.push(h.particle)}}catch(e){r=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}var c=!0,u=!1,d=void 0;if(this._divided)try{for(var p,f=this._subs[Symbol.iterator]();!(c=(p=f.next()).done);c=!0){var g=p.value;(s=i).push.apply(s,(0,$bX4ja._)(g.query(e,t)))}}catch(e){u=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(u)throw d}}return i}},{key:"queryCircle",value:function(e,t,i){return this.query(new $538e60494ef20eea$export$c89a927ffc67e6fa(e.x,e.y,t),i)}},{key:"queryRectangle",value:function(e,t,i){return this.query(new $538e60494ef20eea$export$4617fb02663045ef(e.x,e.y,t.width,t.height),i)}}]),e}(),$a9a8797c9c0d1867$var$qTreeRectangle=function(e){var t=e.height,i=e.width;return new $538e60494ef20eea$export$4617fb02663045ef($6dc45f7ab9b94c34$export$3824525d016aa873*i,$6dc45f7ab9b94c34$export$3824525d016aa873*t,$6dc45f7ab9b94c34$export$59892a8b616aa484*i,$6dc45f7ab9b94c34$export$59892a8b616aa484*t)},$a9a8797c9c0d1867$export$ec4bceef241d2e36=function(){"use strict";function e(t,i){var n=this,r=this;(0,$cx0mh._)(this,e),this._addToPool=function(){for(var e,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];(e=r._pool).push.apply(e,(0,$bX4ja._)(i))},this._applyDensity=function(e,t,i,r){var a,s,o,l,h,c=e.number;if(!(null==(a=e.number.density)?void 0:a.enable))return void(void 0===i?n._limit=c.limit.value:(null!=(l=null==r||null==(s=r.number.limit)?void 0:s.value)?l:c.limit.value)&&n._groupLimits.set(i,null!=(h=null==r||null==(o=r.number.limit)?void 0:o.value)?h:c.limit.value));var u=n._initDensityFactor(c.density),d=c.value,p=c.limit.value>$6dc45f7ab9b94c34$export$e82fde291e144b99?c.limit.value:d,f=Math.min(d,p)*u+t,g=Math.min(n.count,n.filter(function(e){return e.group===i}).length);void 0===i?n._limit=c.limit.value*u:n._groupLimits.set(i,c.limit.value*u),g<f?n.push(Math.abs(f-g),void 0,e,i):g>f&&n.removeQuantity(g-f,i)},this._initDensityFactor=function(e){var t=n._container;if(!t.canvas.element||!e.enable)return $6dc45f7ab9b94c34$export$9b262e3383f198e7;var i=t.canvas.element,r=t.retina.pixelRatio;return i.width*i.height/(e.height*e.width*Math.pow(r,$6dc45f7ab9b94c34$export$69af1894d00750e2))},this._pushParticle=function(e,t,i,r){try{var a=n._pool.pop();a||(a=new $42aa3bbd561591dd$export$c36c68baa13912a5(n._engine,n._container)),a.init(n._nextId,e,t,i);var s=!0;if(r&&(s=r(a)),!s)return;return n._array.push(a),n._zArray.push(a),n._nextId++,n._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.particleAdded,{container:n._container,data:{particle:a}}),a}catch(e){$45e196d141848e3a$export$2b1d391cd05230fd().warning(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} adding particle: ${e}`)}},this._removeParticle=function(e,t,i){var r=n._array[e];if(!r||r.group!==t)return!1;var a=n._zArray.indexOf(r);return n._array.splice(e,$6dc45f7ab9b94c34$export$346cdd8493ece6c8),n._zArray.splice(a,$6dc45f7ab9b94c34$export$346cdd8493ece6c8),r.destroy(i),n._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.particleRemoved,{container:n._container,data:{particle:r}}),n._addToPool(r),!0},this._engine=t,this._container=i,this._nextId=0,this._array=[],this._zArray=[],this._pool=[],this._limit=0,this._groupLimits=new Map,this._needsSort=!1,this._lastZIndex=0,this._interactionManager=new $071291eba7a28b39$export$aaa80641d584351c(t,i),this._pluginsInitialized=!1;var a=i.canvas.size;this.quadTree=new $e75d251b7cecf9c2$export$b82688eb02220411($a9a8797c9c0d1867$var$qTreeRectangle(a),$6dc45f7ab9b94c34$export$ff9931f04b025271),this.movers=[],this.updaters=[]}return(0,$7h4XF._)(e,[{key:"count",get:function(){return this._array.length}},{key:"addManualParticles",value:function(){var e=this,t=this._container;t.actualOptions.manualParticles.forEach(function(i){return e.addParticle(i.position?$45e196d141848e3a$export$1690e12b840569b9(i.position,t.canvas.size):void 0,i.options)})}},{key:"addParticle",value:function(e,t,i,n){var r,a=this._container.actualOptions.particles.number.limit.mode,s=void 0===i?this._limit:null!=(r=this._groupLimits.get(i))?r:this._limit,o=this.count;if(s>$6dc45f7ab9b94c34$export$e82fde291e144b99)switch(a){case $5c76476020892ee7$export$e9c6a0495dc4055f.delete:var l=o+$6dc45f7ab9b94c34$export$1fe1264f46963094-s;l>$6dc45f7ab9b94c34$export$da4e5697b3441fa1&&this.removeQuantity(l);break;case $5c76476020892ee7$export$e9c6a0495dc4055f.wait:if(o>=s)return}return this._pushParticle(e,t,i,n)}},{key:"clear",value:function(){this._array=[],this._zArray=[],this._pluginsInitialized=!1}},{key:"destroy",value:function(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}},{key:"draw",value:function(e){var t=this._container,i=t.canvas;i.clear(),this.update(e);var n=!0,r=!1,a=void 0;try{for(var s,o=t.plugins.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;i.drawPlugin(l,e)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}var h=!0,c=!1,u=void 0;try{for(var d,p=this._zArray[Symbol.iterator]();!(h=(d=p.next()).done);h=!0)d.value.draw(e)}catch(e){c=!0,u=e}finally{try{h||null==p.return||p.return()}finally{if(c)throw u}}}},{key:"filter",value:function(e){return this._array.filter(e)}},{key:"find",value:function(e){return this._array.find(e)}},{key:"get",value:function(e){return this._array[e]}},{key:"handleClickMode",value:function(e){this._interactionManager.handleClickMode(e)}},{key:"init",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o,l,h,c,u,d,p,f,g,v,m;return(0,$2gUX3.__generator)(this,function(y){switch(y.label){case 0:return t=(e=this._container).actualOptions,this._lastZIndex=0,this._needsSort=!1,[4,this.initPlugins()];case 1:y.sent(),i=!1,n=!0,r=!1,a=void 0;try{for(s=e.plugins.values()[Symbol.iterator]();!(n=(o=s.next()).done)&&!(i=null!=(c=null==(h=(l=o.value).particlesInitialization)?void 0:h.call(l))?c:i);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}if(this.addManualParticles(),!i){for(var x in d=(u=t.particles).groups)for(f=d[x],g=this.count,v=0;v<(null==(p=f.number)?void 0:p.value)&&g<u.number.value;g++,v++)this.addParticle(void 0,f,x);for(m=this.count;m<u.number.value;m++)this.addParticle()}return[2]}})}).call(this)}},{key:"initPlugins",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o;return(0,$2gUX3.__generator)(this,function(l){switch(l.label){case 0:if(this._pluginsInitialized)return[2];return e=this._container,t=this,[4,this._engine.getMovers(e,!0)];case 1:return t.movers=l.sent(),i=this,[4,this._engine.getUpdaters(e,!0)];case 2:return i.updaters=l.sent(),[4,this._interactionManager.init()];case 3:l.sent(),n=!0,r=!1,a=void 0;try{for(s=e.pathGenerators.values()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)o.value.init(e)}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return[2]}})}).call(this)}},{key:"push",value:function(e,t,i,n){for(var r=0;r<e;r++)this.addParticle(null==t?void 0:t.position,i,n)}},{key:"redraw",value:function(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:return this.clear(),[4,this.init()];case 1:return e.sent(),this.draw({value:0,factor:0}),[2]}})}).call(this)}},{key:"remove",value:function(e,t,i){this.removeAt(this._array.indexOf(e),void 0,t,i)}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$6dc45f7ab9b94c34$export$1f93977e73a42602,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!(e<$6dc45f7ab9b94c34$export$e410eba367ce792b)&&!(e>this.count))for(var r=0,a=e;r<t&&a<this.count;a++)this._removeParticle(a,i,n)&&(a--,r++)}},{key:"removeQuantity",value:function(e,t){this.removeAt($6dc45f7ab9b94c34$export$e410eba367ce792b,e,t)}},{key:"setDensity",value:function(){var e=this._container.actualOptions,t=e.particles.groups,i=e.manualParticles.length;for(var n in t)this._applyDensity(t[n],i,n);this._applyDensity(e.particles,i)}},{key:"setLastZIndex",value:function(e){this._lastZIndex=e,this._needsSort=this._needsSort||this._lastZIndex<e}},{key:"setResizeFactor",value:function(e){this._resizeFactor=e}},{key:"update",value:function(e){var t=this._container,i=new Set;this.quadTree=new $e75d251b7cecf9c2$export$b82688eb02220411($a9a8797c9c0d1867$var$qTreeRectangle(t.canvas.size),$6dc45f7ab9b94c34$export$ff9931f04b025271);var n=!0,r=!1,a=void 0;try{for(var s,o,l=t.pathGenerators.values()[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)o.value.update()}catch(e){r=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}var h=!0,c=!1,u=void 0;try{for(var d,p=t.plugins.values()[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var f=d.value;null==(s=f.update)||s.call(f,e)}}catch(e){c=!0,u=e}finally{try{h||null==p.return||p.return()}finally{if(c)throw u}}var g=this._resizeFactor,v=!0,m=!1,y=void 0;try{for(var x,b=this._array[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var w=x.value;g&&!w.ignoresResizeRatio&&(w.position.x*=g.width,w.position.y*=g.height,w.initialPosition.x*=g.width,w.initialPosition.y*=g.height),w.ignoresResizeRatio=!1,this._interactionManager.reset(w);var k=!0,B=!1,S=void 0;try{for(var C,E=this._container.plugins.values()[Symbol.iterator]();!(k=(C=E.next()).done);k=!0){var _,I=C.value;if(w.destroyed)break;null==(_=I.particleUpdate)||_.call(I,w,e)}}catch(e){B=!0,S=e}finally{try{k||null==E.return||E.return()}finally{if(B)throw S}}var T=!0,M=!1,L=void 0;try{for(var R,P=this.movers[Symbol.iterator]();!(T=(R=P.next()).done);T=!0){var A=R.value;A.isEnabled(w)&&A.move(w,e)}}catch(e){M=!0,L=e}finally{try{T||null==P.return||P.return()}finally{if(M)throw L}}if(w.destroyed){i.add(w);continue}this.quadTree.insert(new $45089bd2aab345ac$export$baf26146a414f24a(w.getPosition(),w))}}catch(e){m=!0,y=e}finally{try{v||null==b.return||b.return()}finally{if(m)throw y}}if(i.size){var D=function(e){return!i.has(e)};this._array=this.filter(D),this._zArray=this._zArray.filter(D);var O=!0,z=!1,H=void 0;try{for(var j,F=i[Symbol.iterator]();!(O=(j=F.next()).done);O=!0){var X=j.value;this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.particleRemoved,{container:this._container,data:{particle:X}})}}catch(e){z=!0,H=e}finally{try{O||null==F.return||F.return()}finally{if(z)throw H}}this._addToPool.apply(this,(0,$bX4ja._)(i))}this._interactionManager.externalInteract(e);var V=!0,U=!1,W=void 0;try{for(var N,Y=this._array[Symbol.iterator]();!(V=(N=Y.next()).done);V=!0){var G=N.value,K=!0,Z=!1,q=void 0;try{for(var $,J=this.updaters[Symbol.iterator]();!(K=($=J.next()).done);K=!0)$.value.update(G,e)}catch(e){Z=!0,q=e}finally{try{K||null==J.return||J.return()}finally{if(Z)throw q}}G.destroyed||G.spawning||this._interactionManager.particlesInteract(G,e)}}catch(e){U=!0,W=e}finally{try{V||null==Y.return||Y.return()}finally{if(U)throw W}}if(delete this._resizeFactor,this._needsSort){var Q=this._zArray;Q.sort(function(e,t){return t.position.z-e.position.z||e.id-t.id}),this._lastZIndex=Q[Q.length-$6dc45f7ab9b94c34$export$4a5b9680be542cf8].position.z,this._needsSort=!1}}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$01b3c4753d940e6d$export$b7a992a6d33e9eff=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.container=t,this.pixelRatio=$6dc45f7ab9b94c34$export$728175ae61348876,this.reduceFactor=$6dc45f7ab9b94c34$export$7e2d520c66b9f331}return(0,$7h4XF._)(e,[{key:"init",value:function(){var e=this.container,t=e.actualOptions;this.pixelRatio=!t.detectRetina||$45e196d141848e3a$export$460b6777813d3d86()?$6dc45f7ab9b94c34$export$728175ae61348876:devicePixelRatio,this.reduceFactor=$6dc45f7ab9b94c34$export$7e2d520c66b9f331;var i=this.pixelRatio,n=e.canvas;if(n.element){var r=n.element;n.size.width=r.offsetWidth*i,n.size.height=r.offsetHeight*i}var a=t.particles,s=a.move;this.maxSpeed=$e8499b8b34df9b2a$export$e70c64b68236cb4e(s.gravity.maxSpeed)*i,this.sizeAnimationSpeed=$e8499b8b34df9b2a$export$e70c64b68236cb4e(a.size.animation.speed)*i}},{key:"initParticle",value:function(e){var t=e.options,i=this.pixelRatio,n=t.move,r=n.distance,a=e.retina;a.moveDrift=$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.drift)*i,a.moveSpeed=$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.speed)*i,a.sizeAnimationSpeed=$e8499b8b34df9b2a$export$e70c64b68236cb4e(t.size.animation.speed)*i;var s=a.maxDistance;s.horizontal=void 0!==r.horizontal?r.horizontal*i:void 0,s.vertical=void 0!==r.vertical?r.vertical*i:void 0,a.maxSpeed=$e8499b8b34df9b2a$export$e70c64b68236cb4e(n.gravity.maxSpeed)*i}}]),e}();function $e4ef2b203f4e797d$var$guardCheck(e){return e&&!e.destroyed}function $e4ef2b203f4e797d$var$initDelta(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$6dc45f7ab9b94c34$export$a58a85a1d96b5da5,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{value:e,factor:i?$6dc45f7ab9b94c34$export$a58a85a1d96b5da5/t:$6dc45f7ab9b94c34$export$a58a85a1d96b5da5*e/$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f}}function $e4ef2b203f4e797d$var$loadContainerOptions(e,t){for(var i=arguments.length,n=Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var a=new $44a825250a5b45c8$export$c019608e5b5bb4cb(e,t);return $5b39c3e502bab1cd$export$cad72087bded938.apply(void 0,[a].concat((0,$bX4ja._)(n))),a}var $e4ef2b203f4e797d$export$42a852a2b6b56249=function(){"use strict";function e(t,i,n){var r=this;(0,$cx0mh._)(this,e),this._intersectionManager=function(e){if($e4ef2b203f4e797d$var$guardCheck(r)&&r.actualOptions.pauseOnOutsideViewport){var t=!0,i=!1,n=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value;o.target===r.interactivity.element&&(o.isIntersecting?r.play():r.pause())}}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}}},this._nextFrame=function(e){try{if(!r._smooth&&void 0!==r._lastFrameTime&&e<r._lastFrameTime+$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f/r.fpsLimit)return void r.draw(!1);null!=(t=r._lastFrameTime)||(r._lastFrameTime=e);var t,i=$e4ef2b203f4e797d$var$initDelta(e-r._lastFrameTime,r.fpsLimit,r._smooth);if(r.addLifeTime(i.value),r._lastFrameTime=e,i.value>$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f)return void r.draw(!1);if(r.particles.draw(i),!r.alive())return void r.destroy();r.animationStatus&&r.draw(!1)}catch(e){$45e196d141848e3a$export$2b1d391cd05230fd().error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} in animation loop`,e)}},this._engine=t,this.id=Symbol(i),this.fpsLimit=120,this._smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this._lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._clickHandlers=new Map,this._sourceOptions=n,this._initialSourceOptions=n,this.retina=new $01b3c4753d940e6d$export$b7a992a6d33e9eff(this),this.canvas=new $5c8dba58fca6e9bb$export$8d01c972ee8b14a9(this,this._engine),this.particles=new $a9a8797c9c0d1867$export$ec4bceef241d2e36(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this._options=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this),this.actualOptions=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this),this._eventListeners=new $41fd8665fa436cdd$export$b20b719ec758a20f(this),this._intersectionObserver=$45e196d141848e3a$export$d97d2a93dce76cc2(function(e){return r._intersectionManager(e)}),this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerBuilt,{container:this})}return(0,$7h4XF._)(e,[{key:"animationStatus",get:function(){return!this._paused&&!this.pageHidden&&$e4ef2b203f4e797d$var$guardCheck(this)}},{key:"options",get:function(){return this._options}},{key:"sourceOptions",get:function(){return this._sourceOptions}},{key:"addClickHandler",value:function(e){var t=this;if($e4ef2b203f4e797d$var$guardCheck(this)){var i=this.interactivity.element;if(i){var n=function(i,n,r){if($e4ef2b203f4e797d$var$guardCheck(t)){var a=t.retina.pixelRatio,s={x:n.x*a,y:n.y*a},o=t.particles.quadTree.queryCircle(s,r*a);e(i,o)}},r=function(e){if($e4ef2b203f4e797d$var$guardCheck(t)){var i=e,r={x:i.offsetX||i.clientX,y:i.offsetY||i.clientY};n(e,r,$6dc45f7ab9b94c34$export$ed597c6eb324bc8f)}},a=function(){$e4ef2b203f4e797d$var$guardCheck(t)&&(h=!0,c=!1)},s=function(){$e4ef2b203f4e797d$var$guardCheck(t)&&(c=!0)},o=function(e){if($e4ef2b203f4e797d$var$guardCheck(t)){if(h&&!c){var i=e,r=i.touches[i.touches.length-$6dc45f7ab9b94c34$export$7a917036bd0c18e0];if(!r&&!(r=i.changedTouches[i.changedTouches.length-$6dc45f7ab9b94c34$export$7a917036bd0c18e0]))return;var a=t.canvas.element,s=a?a.getBoundingClientRect():void 0;n(e,{x:r.clientX-(s?s.left:$6dc45f7ab9b94c34$export$17c6bab6aae4c3d),y:r.clientY-(s?s.top:$6dc45f7ab9b94c34$export$17c6bab6aae4c3d)},Math.max(r.radiusX,r.radiusY))}h=!1,c=!1}},l=function(){$e4ef2b203f4e797d$var$guardCheck(t)&&(h=!1,c=!1)},h=!1,c=!1;this._clickHandlers.set("click",r),this._clickHandlers.set("touchstart",a),this._clickHandlers.set("touchmove",s),this._clickHandlers.set("touchend",o),this._clickHandlers.set("touchcancel",l);var u=!0,d=!1,p=void 0;try{for(var f,g=this._clickHandlers[Symbol.iterator]();!(u=(f=g.next()).done);u=!0){var v=(0,$8N5YG._)(f.value,2),m=v[0],y=v[1];i.addEventListener(m,y)}}catch(e){d=!0,p=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw p}}}}}},{key:"addLifeTime",value:function(e){this._lifeTime+=e}},{key:"addPath",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!$e4ef2b203f4e797d$var$guardCheck(this)||!i&&this.pathGenerators.has(e))&&(this.pathGenerators.set(e,t),!0)}},{key:"alive",value:function(){return!this._duration||this._lifeTime<=this._duration}},{key:"clearClickHandlers",value:function(){if($e4ef2b203f4e797d$var$guardCheck(this)){var e=!0,t=!1,i=void 0;try{for(var n,r,a=this._clickHandlers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=(0,$8N5YG._)(r.value,2),o=s[0],l=s[1];null==(n=this.interactivity.element)||n.removeEventListener(o,l)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}this._clickHandlers.clear()}}},{key:"destroy",value:function(){var e=this,t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if($e4ef2b203f4e797d$var$guardCheck(this)){this.stop(),this.clearClickHandlers(),this.particles.destroy(),this.canvas.destroy();var i=!0,n=!1,r=void 0;try{for(var a,s,o,l=this.effectDrawers.values()[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var h=o.value;null==(a=h.destroy)||a.call(h,this)}}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}var c=!0,u=!1,d=void 0;try{for(var p,f=this.shapeDrawers.values()[Symbol.iterator]();!(c=(p=f.next()).done);c=!0){var g=p.value;null==(s=g.destroy)||s.call(g,this)}}catch(e){u=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(u)throw d}}var v=!0,m=!1,y=void 0;try{for(var x,b=this.effectDrawers.keys()[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var w=x.value;this.effectDrawers.delete(w)}}catch(e){m=!0,y=e}finally{try{v||null==b.return||b.return()}finally{if(m)throw y}}var k=!0,B=!1,S=void 0;try{for(var C,E=this.shapeDrawers.keys()[Symbol.iterator]();!(k=(C=E.next()).done);k=!0){var _=C.value;this.shapeDrawers.delete(_)}}catch(e){B=!0,S=e}finally{try{k||null==E.return||E.return()}finally{if(B)throw S}}if(this._engine.clearPlugins(this),this.destroyed=!0,t){var I=this._engine.items,T=I.findIndex(function(t){return t===e});T>=$6dc45f7ab9b94c34$export$6347387141f4c7b9&&I.splice(T,$6dc45f7ab9b94c34$export$310c6557edf6330f)}this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerDestroyed,{container:this})}}},{key:"draw",value:function(e){var t=this;if($e4ef2b203f4e797d$var$guardCheck(this)){var i=e,n=function(e){i&&(t._lastFrameTime=void 0,i=!1),t._nextFrame(e)};this._drawAnimationFrame=$e8499b8b34df9b2a$export$e3607ec2d7a891c4(function(e){return n(e)})}}},{key:"export",value:function(e){return(0,$1LaJZ._)(function(e){var t,i,n,r,a,s,o,l,h,c=arguments;return(0,$2gUX3.__generator)(this,function(u){switch(u.label){case 0:t=c.length>1&&void 0!==c[1]?c[1]:{},i=!0,n=!1,r=void 0,u.label=1;case 1:u.trys.push([1,6,7,8]),a=this.plugins.values()[Symbol.iterator](),u.label=2;case 2:if(i=(s=a.next()).done)return[3,5];if(!(o=s.value).export)return[3,4];return[4,o.export(e,t)];case 3:if(!(l=u.sent()).supported)return[3,4];return[2,l.blob];case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return h=u.sent(),n=!0,r=h,[3,8];case 7:try{i||null==a.return||a.return()}finally{if(n)throw r}return[7];case 8:return $45e196d141848e3a$export$2b1d391cd05230fd().error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} - Export plugin with type ${e} not found`),[2]}})}).apply(this,arguments)}},{key:"handleClickMode",value:function(e){if($e4ef2b203f4e797d$var$guardCheck(this)){this.particles.handleClickMode(e);var t=!0,i=!1,n=void 0;try{for(var r,a,s=this.plugins.values()[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value;null==(r=o.handleClickMode)||r.call(o,e)}}catch(e){i=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw n}}}}},{key:"init",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o,l,h,c,u,d,p,f,g,v,m,y,x,b,w,k,B,S,C,E,_,I,T,M,L,R,P,A,D,O,z,H,j,F,X,V,U,W,N,Y,G,K,Z,q,$,J,Q,ee,et,ei,en,er,ea;return(0,$2gUX3.__generator)(this,function(es){switch(es.label){case 0:if(!$e4ef2b203f4e797d$var$guardCheck(this))return[2];r=this._engine.getSupportedEffects(),a=!0,s=!1,o=void 0;try{for(l=r[Symbol.iterator]();!(a=(h=l.next()).done);a=!0)c=h.value,(u=this._engine.getEffectDrawer(c))&&this.effectDrawers.set(c,u)}catch(e){s=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}d=this._engine.getSupportedShapes(),p=!0,f=!1,g=void 0;try{for(v=d[Symbol.iterator]();!(p=(m=v.next()).done);p=!0)y=m.value,(x=this._engine.getShapeDrawer(y))&&this.shapeDrawers.set(y,x)}catch(e){f=!0,g=e}finally{try{p||null==v.return||v.return()}finally{if(f)throw g}}return[4,this.particles.initPlugins()];case 1:return es.sent(),this._options=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this,this._options),[4,this._engine.getAvailablePlugins(this)];case 2:b=es.sent(),w=!0,k=!1,B=void 0;try{for(S=b[Symbol.iterator]();!(w=(C=S.next()).done);w=!0)_=(E=(0,$8N5YG._)(C.value,2))[0],I=E[1],this.plugins.set(_,I)}catch(e){k=!0,B=e}finally{try{w||null==S.return||S.return()}finally{if(k)throw B}}return this.retina.init(),[4,this.canvas.init()];case 3:es.sent(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize(),M=(T=this.actualOptions).zLayers,L=T.duration,R=T.delay,P=T.fpsLimit,A=T.smooth,this.zLayers=M,this._duration=$e8499b8b34df9b2a$export$e70c64b68236cb4e(L)*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f,this._delay=$e8499b8b34df9b2a$export$e70c64b68236cb4e(R)*$6dc45f7ab9b94c34$export$f64c3bfbc58eec0f,this._lifeTime=0,this.fpsLimit=P>$6dc45f7ab9b94c34$export$1f9ec247b9f4a442?P:$6dc45f7ab9b94c34$export$a1db07711c3c21cf,this._smooth=A,D=!0,O=!1,z=void 0,es.label=4;case 4:es.trys.push([4,9,10,11]),H=this.effectDrawers.values()[Symbol.iterator](),es.label=5;case 5:if(D=(j=H.next()).done)return[3,8];return[4,null==(e=(F=j.value).init)?void 0:e.call(F,this)];case 6:es.sent(),es.label=7;case 7:return D=!0,[3,5];case 8:return[3,11];case 9:return X=es.sent(),O=!0,z=X,[3,11];case 10:try{D||null==H.return||H.return()}finally{if(O)throw z}return[7];case 11:V=!0,U=!1,W=void 0,es.label=12;case 12:es.trys.push([12,17,18,19]),N=this.shapeDrawers.values()[Symbol.iterator](),es.label=13;case 13:if(V=(Y=N.next()).done)return[3,16];return[4,null==(t=(G=Y.value).init)?void 0:t.call(G,this)];case 14:es.sent(),es.label=15;case 15:return V=!0,[3,13];case 16:return[3,19];case 17:return X=es.sent(),U=!0,W=X,[3,19];case 18:try{V||null==N.return||N.return()}finally{if(U)throw W}return[7];case 19:K=!0,Z=!1,q=void 0,es.label=20;case 20:es.trys.push([20,25,26,27]),$=this.plugins.values()[Symbol.iterator](),es.label=21;case 21:if(K=(J=$.next()).done)return[3,24];return[4,null==(i=(Q=J.value).init)?void 0:i.call(Q)];case 22:es.sent(),es.label=23;case 23:return K=!0,[3,21];case 24:return[3,27];case 25:return X=es.sent(),Z=!0,q=X,[3,27];case 26:try{K||null==$.return||$.return()}finally{if(Z)throw q}return[7];case 27:return this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerInit,{container:this}),[4,this.particles.init()];case 28:es.sent(),this.particles.setDensity(),ee=!0,et=!1,ei=void 0;try{for(en=this.plugins.values()[Symbol.iterator]();!(ee=(er=en.next()).done);ee=!0)null==(n=(ea=er.value).particlesSetup)||n.call(ea)}catch(e){et=!0,ei=e}finally{try{ee||null==en.return||en.return()}finally{if(et)throw ei}}return this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.particlesSetup,{container:this}),[2]}})}).call(this)}},{key:"loadTheme",value:function(e){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:if(!$e4ef2b203f4e797d$var$guardCheck(this))return[2];return this._currentTheme=e,[4,this.refresh()];case 1:return t.sent(),[2]}})}).call(this)}},{key:"pause",value:function(){if($e4ef2b203f4e797d$var$guardCheck(this)&&(void 0!==this._drawAnimationFrame&&($e8499b8b34df9b2a$export$623ab1da75e685de(this._drawAnimationFrame),delete this._drawAnimationFrame),!this._paused)){var e=!0,t=!1,i=void 0;try{for(var n,r,a=this.plugins.values()[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;null==(n=s.pause)||n.call(s)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}this.pageHidden||(this._paused=!0),this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerPaused,{container:this})}}},{key:"play",value:function(e){if($e4ef2b203f4e797d$var$guardCheck(this)){var t=this._paused||e;if(this._firstStart&&!this.actualOptions.autoPlay){this._firstStart=!1;return}if(this._paused&&(this._paused=!1),t){var i=!0,n=!1,r=void 0;try{for(var a,s=this.plugins.values()[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;o.play&&o.play()}}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerPlay,{container:this}),this.draw(null!=t&&t)}}},{key:"refresh",value:function(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){return $e4ef2b203f4e797d$var$guardCheck(this)?(this.stop(),[2,this.start()]):[2]})}).call(this)}},{key:"reset",value:function(e){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(t){return $e4ef2b203f4e797d$var$guardCheck(this)?(this._initialSourceOptions=e,this._sourceOptions=e,this._options=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=$e4ef2b203f4e797d$var$loadContainerOptions(this._engine,this,this._options),[2,this.refresh()]):[2]})}).call(this)}},{key:"start",value:function(){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:if(e=this,!$e4ef2b203f4e797d$var$guardCheck(this)||this.started)return[2];return[4,this.init()];case 1:return t.sent(),this.started=!0,[4,new Promise(function(t){var i=function(){return(0,$1LaJZ._)(function(){var e,i,n,r,a,s,o,l;return(0,$2gUX3.__generator)(this,function(h){switch(h.label){case 0:this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element),i=!0,n=!1,r=void 0,h.label=1;case 1:h.trys.push([1,6,7,8]),a=this.plugins.values()[Symbol.iterator](),h.label=2;case 2:if(i=(s=a.next()).done)return[3,5];return[4,null==(e=(o=s.value).start)?void 0:e.call(o)];case 3:h.sent(),h.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return l=h.sent(),n=!0,r=l,[3,8];case 7:try{i||null==a.return||a.return()}finally{if(n)throw r}return[7];case 8:return this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerStarted,{container:this}),this.play(),t(),[2]}})}).call(e)};e._delayTimeout=setTimeout(function(){i()},e._delay)})];case 2:return t.sent(),[2]}})}).call(this)}},{key:"stop",value:function(){if($e4ef2b203f4e797d$var$guardCheck(this)&&this.started){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);var e=!0,t=!1,i=void 0;try{for(var n,r,a=this.plugins.values()[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;null==(n=s.stop)||n.call(s)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}var o=!0,l=!1,h=void 0;try{for(var c,u=this.plugins.keys()[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value;this.plugins.delete(d)}}catch(e){l=!0,h=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw h}}this._sourceOptions=this._options,this._engine.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.containerStopped,{container:this})}}},{key:"updateActualOptions",value:function(){this.actualOptions.responsive=[];var e=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this._responsiveMaxWidth!==e&&(this._responsiveMaxWidth=e,!0)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$d820043f22dd55b7$export$ec8b666c5fe2c75a=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this._listeners=new Map}return(0,$7h4XF._)(e,[{key:"addEventListener",value:function(e,t){this.removeEventListener(e,t);var i=this._listeners.get(e);i||(i=[],this._listeners.set(e,i)),i.push(t)}},{key:"dispatchEvent",value:function(e,t){var i=this._listeners.get(e);null==i||i.forEach(function(e){return e(t)})}},{key:"hasEventListener",value:function(e){return!!this._listeners.get(e)}},{key:"removeAllEventListeners",value:function(e){e?this._listeners.delete(e):this._listeners=new Map}},{key:"removeEventListener",value:function(e,t){var i=this._listeners.get(e);if(i){var n=i.length,r=i.indexOf(t);r<$6dc45f7ab9b94c34$export$e410eba367ce792b||(n===$6dc45f7ab9b94c34$export$346cdd8493ece6c8?this._listeners.delete(e):i.splice(r,$6dc45f7ab9b94c34$export$346cdd8493ece6c8))}}}]),e}();function $5646055750442b51$var$getItemsFromInitializer(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,$1LaJZ._)(function(){var r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(!(!(r=t.get(e))||n))return[3,2];return[4,Promise.all((0,$bX4ja._)(i.values()).map(function(t){return t(e)}))];case 1:r=a.sent(),t.set(e,r),a.label=2;case 2:return[2,r]}})})()}function $5646055750442b51$var$getDataFromUrl(e){return(0,$1LaJZ._)(function(){var t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:if(!(t=$45e196d141848e3a$export$3fbf39566d3ee62e(e.url,e.index)))return[2,e.fallback];return[4,fetch(t)];case 1:if(!(i=n.sent()).ok)return[3,3];return[4,i.json()];case 2:return[2,n.sent()];case 3:return $45e196d141848e3a$export$2b1d391cd05230fd().error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} ${i.status} while retrieving config file`),[2,e.fallback]}})})()}var $5646055750442b51$var$getCanvasFromContainer=function(e){if(e instanceof HTMLCanvasElement||e.tagName.toLowerCase()===$6dc45f7ab9b94c34$export$af8f840c6caca708)(t=e).dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]||(t.dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]=$6dc45f7ab9b94c34$export$c392cf7a2bd47e88);else{var t,i=e.getElementsByTagName($6dc45f7ab9b94c34$export$af8f840c6caca708);i.length?(t=i[$6dc45f7ab9b94c34$export$878d5c9fc03f6a6f]).dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]=$6dc45f7ab9b94c34$export$c392cf7a2bd47e88:((t=document.createElement($6dc45f7ab9b94c34$export$af8f840c6caca708)).dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]=$6dc45f7ab9b94c34$export$f4379e05d59339d2,e.appendChild(t))}var n="100%";return t.style.width||(t.style.width=n),t.style.height||(t.style.height=n),t},$5646055750442b51$var$getDomContainer=function(e,t){var i=null!=t?t:document.getElementById(e);return i||((i=document.createElement("div")).id=e,i.dataset[$6dc45f7ab9b94c34$export$4a278486528d5cfb]=$6dc45f7ab9b94c34$export$f4379e05d59339d2,document.body.append(i)),i},$5646055750442b51$export$2c3b404bf3a77a1f=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this._configs=new Map,this._domArray=[],this._eventDispatcher=new $d820043f22dd55b7$export$ec8b666c5fe2c75a,this._initialized=!1,this.plugins=[],this.colorManagers=new Map,this.easingFunctions=new Map,this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this.pathGenerators=new Map}return(0,$7h4XF._)(e,[{key:"configs",get:function(){var e={},t=!0,i=!1,n=void 0;try{for(var r,a=this._configs[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=(0,$8N5YG._)(r.value,2),o=s[0],l=s[1];e[o]=l}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}return e}},{key:"items",get:function(){return this._domArray}},{key:"version",get:function(){return"3.9.1"}},{key:"addColorManager",value:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return this.colorManagers.set(e.key,e),[4,this.refresh(t)];case 1:return i.sent(),[2]}})}).call(this)}},{key:"addConfig",value:function(e){var t,i,n=null!=(i=null!=(t=e.key)?t:e.name)?i:"default";this._configs.set(n,e),this._eventDispatcher.dispatchEvent($faa26ded1880cb9a$export$3d7865934588d77e.configAdded,{data:{name:n,config:e}})}},{key:"addEasing",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:if(this.getEasing(e))return[2];return this.easingFunctions.set(e,t),[4,this.refresh(i)];case 1:return n.sent(),[2]}})}).call(this)}},{key:"addEffect",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){var n;return(0,$2gUX3.__generator)(this,function(r){switch(r.label){case 0:return n=this,$45e196d141848e3a$export$8e5dc47097396754(e,function(e){n.getEffectDrawer(e)||n.effectDrawers.set(e,t)}),[4,this.refresh(i)];case 1:return r.sent(),[2]}})}).call(this)}},{key:"addEventListener",value:function(e,t){this._eventDispatcher.addEventListener(e,t)}},{key:"addInteractor",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return this._initializers.interactors.set(e,t),[4,this.refresh(i)];case 1:return n.sent(),[2]}})}).call(this)}},{key:"addMover",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return this._initializers.movers.set(e,t),[4,this.refresh(i)];case 1:return n.sent(),[2]}})}).call(this)}},{key:"addParticleUpdater",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return this._initializers.updaters.set(e,t),[4,this.refresh(i)];case 1:return n.sent(),[2]}})}).call(this)}},{key:"addPathGenerator",value:function(e,t){var i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return this.getPathGenerator(e)||this.pathGenerators.set(e,t),[4,this.refresh(i)];case 1:return n.sent(),[2]}})}).call(this)}},{key:"addPlugin",value:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return this.getPlugin(e.id)||this.plugins.push(e),[4,this.refresh(t)];case 1:return i.sent(),[2]}})}).call(this)}},{key:"addPreset",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(r){switch(r.label){case 0:return(i||!this.getPreset(e))&&this.presets.set(e,t),[4,this.refresh(n)];case 1:return r.sent(),[2]}})}).call(this)}},{key:"addShape",value:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,$1LaJZ._)(function(){var i,n,r,a,s,o;return(0,$2gUX3.__generator)(this,function(l){switch(l.label){case 0:i=!0,n=!1,r=void 0;try{for(a=e.validTypes[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)o=s.value,this.getShapeDrawer(o)||this.shapeDrawers.set(o,e)}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}return[4,this.refresh(t)];case 1:return l.sent(),[2]}})}).call(this)}},{key:"checkVersion",value:function(e){if(this.version!==e)throw Error(`The tsParticles version is different from the loaded plugins version. Engine version: ${this.version}. Plugin version: ${e}`)}},{key:"clearPlugins",value:function(e){this.updaters.delete(e),this.movers.delete(e),this.interactors.delete(e)}},{key:"dispatchEvent",value:function(e,t){this._eventDispatcher.dispatchEvent(e,t)}},{key:"dom",value:function(){return this.items}},{key:"domItem",value:function(e){return this.item(e)}},{key:"getAvailablePlugins",value:function(e){return(0,$1LaJZ._)(function(){var t,i,n,r,a,s,o,l,h,c;return(0,$2gUX3.__generator)(this,function(u){switch(u.label){case 0:t=new Map,i=!0,n=!1,r=void 0,u.label=1;case 1:u.trys.push([1,6,7,8]),a=this.plugins[Symbol.iterator](),u.label=2;case 2:if(i=(s=a.next()).done)return[3,5];if(!(o=s.value).needsPlugin(e.actualOptions))return[3,4];return l=t.set,h=[o.id],[4,o.getPlugin(e)];case 3:l.apply(t,h.concat([u.sent()])),u.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return c=u.sent(),n=!0,r=c,[3,8];case 7:try{i||null==a.return||a.return()}finally{if(n)throw r}return[7];case 8:return[2,t]}})}).call(this)}},{key:"getEasing",value:function(e){var t;return null!=(t=this.easingFunctions.get(e))?t:function(e){return e}}},{key:"getEffectDrawer",value:function(e){return this.effectDrawers.get(e)}},{key:"getInteractors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return[2,$5646055750442b51$var$getItemsFromInitializer(e,this.interactors,this._initializers.interactors,t)]})}).call(this)}},{key:"getMovers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return[2,$5646055750442b51$var$getItemsFromInitializer(e,this.movers,this._initializers.movers,t)]})}).call(this)}},{key:"getPathGenerator",value:function(e){return this.pathGenerators.get(e)}},{key:"getPlugin",value:function(e){return this.plugins.find(function(t){return t.id===e})}},{key:"getPreset",value:function(e){return this.presets.get(e)}},{key:"getShapeDrawer",value:function(e){return this.shapeDrawers.get(e)}},{key:"getSupportedEffects",value:function(){return this.effectDrawers.keys()}},{key:"getSupportedShapes",value:function(){return this.shapeDrawers.keys()}},{key:"getUpdaters",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return[2,$5646055750442b51$var$getItemsFromInitializer(e,this.updaters,this._initializers.updaters,t)]})}).call(this)}},{key:"init",value:function(){this._initialized||(this._initialized=!0)}},{key:"item",value:function(e){var t=this.items,i=t[e];return!i||i.destroyed?void t.splice(e,$6dc45f7ab9b94c34$export$310c6557edf6330f):i}},{key:"load",value:function(e){return(0,$1LaJZ._)(function(){var t,i,n,r,a,s,o,l,h,c,u,d,p,f;return(0,$2gUX3.__generator)(this,function(g){switch(g.label){case 0:if(r=null!=(n=null!=(i=e.id)?i:null==(t=e.element)?void 0:t.id)?n:`tsparticles${Math.floor($e8499b8b34df9b2a$export$1a76347094524b3b()*$6dc45f7ab9b94c34$export$d20f7c11146fd35)}`,a=e.index,!(s=e.url))return[3,2];return[4,$5646055750442b51$var$getDataFromUrl({fallback:e.options,url:s,index:a})];case 1:return u=g.sent(),[3,3];case 2:u=e.options,g.label=3;case 3:return o=$45e196d141848e3a$export$3fbf39566d3ee62e(u,a),h=(l=this.items).findIndex(function(e){return e.id.description===r}),c=new $e4ef2b203f4e797d$export$42a852a2b6b56249(this,r,o),h>=$6dc45f7ab9b94c34$export$a0a8145c86a935c7?(p=(d=this.item(h))?$6dc45f7ab9b94c34$export$80bf7733f1207381:$6dc45f7ab9b94c34$export$f883a24d5edde77c,d&&!d.destroyed&&d.destroy(!1),l.splice(h,p,c)):l.push(c),f=$5646055750442b51$var$getCanvasFromContainer($5646055750442b51$var$getDomContainer(r,e.element)),c.canvas.loadCanvas(f),[4,c.start()];case 4:return g.sent(),[2,c]}})}).call(this)}},{key:"loadOptions",value:function(e,t){this.plugins.forEach(function(i){var n;return null==(n=i.loadOptions)?void 0:n.call(i,e,t)})}},{key:"loadParticlesOptions",value:function(e,t){for(var i=arguments.length,n=Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var a=this.updaters.get(e);a&&a.forEach(function(e){var i,r;return null==(r=e.loadOptions)?void 0:(i=r).call.apply(i,[e,t].concat((0,$bX4ja._)(n)))})}},{key:"refresh",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:if(!e)return[2];return[4,Promise.all(this.items.map(function(e){return e.refresh()}))];case 1:return t.sent(),[2]}})}).call(this)}},{key:"removeEventListener",value:function(e,t){this._eventDispatcher.removeEventListener(e,t)}},{key:"setOnClickHandler",value:function(e){var t=this.items;if(!t.length)throw Error(`${$6dc45f7ab9b94c34$export$adea4917e02d93dc} can only set click handlers after calling tsParticles.load()`);t.forEach(function(t){return t.addClickHandler(e)})}}]),e}();function $e0cdd417374362a0$export$2cd8252107eb640b(){var e=new $5646055750442b51$export$2c3b404bf3a77a1f;return e.init(),e}var $cx0mh=parcelRequire("cx0mh"),$b5db82df783c5b83$export$6e252256471acc61=function e(t){"use strict";(0,$cx0mh._)(this,e),this.type=$35f0e6a9a0aa9be9$export$143a800d561d28fd.external,this.container=t},$cx0mh=parcelRequire("cx0mh"),$f5d91de5d1c6f991$export$becdaab2d9289dc4=function e(t){"use strict";(0,$cx0mh._)(this,e),this.type=$35f0e6a9a0aa9be9$export$143a800d561d28fd.particles,this.container=t};!function(e){e.clockwise="clockwise",e.counterClockwise="counter-clockwise",e.random="random"}($b315ee1492430f48$export$9506977ce2a96a5b||($b315ee1492430f48$export$9506977ce2a96a5b={})),function(e){e.linear="linear",e.radial="radial",e.random="random"}($6d37125ffb90f03e$export$20d70ee9873a8ba||($6d37125ffb90f03e$export$20d70ee9873a8ba={})),function(e){e.easeInBack="ease-in-back",e.easeInCirc="ease-in-circ",e.easeInCubic="ease-in-cubic",e.easeInLinear="ease-in-linear",e.easeInQuad="ease-in-quad",e.easeInQuart="ease-in-quart",e.easeInQuint="ease-in-quint",e.easeInExpo="ease-in-expo",e.easeInSine="ease-in-sine",e.easeOutBack="ease-out-back",e.easeOutCirc="ease-out-circ",e.easeOutCubic="ease-out-cubic",e.easeOutLinear="ease-out-linear",e.easeOutQuad="ease-out-quad",e.easeOutQuart="ease-out-quart",e.easeOutQuint="ease-out-quint",e.easeOutExpo="ease-out-expo",e.easeOutSine="ease-out-sine",e.easeInOutBack="ease-in-out-back",e.easeInOutCirc="ease-in-out-circ",e.easeInOutCubic="ease-in-out-cubic",e.easeInOutLinear="ease-in-out-linear",e.easeInOutQuad="ease-in-out-quad",e.easeInOutQuart="ease-in-out-quart",e.easeInOutQuint="ease-in-out-quint",e.easeInOutExpo="ease-in-out-expo",e.easeInOutSine="ease-in-out-sine"}($4ffd794d8a54e991$export$483bfb5d033dec0c||($4ffd794d8a54e991$export$483bfb5d033dec0c={}));var $43c100db3512d244$export$218c38ca7c058037=$e0cdd417374362a0$export$2cd8252107eb640b();$45e196d141848e3a$export$460b6777813d3d86()||(window.tsParticles=$43c100db3512d244$export$218c38ca7c058037);var $1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$d711de5b069e63ac$var$defaultInset=2,$d711de5b069e63ac$var$origin={x:0,y:0};function $d711de5b069e63ac$export$ca57b923902a3c0(e){var t,i=e.context,n=e.particle,r=e.radius,a=n.sides,s=null!=(t=n.starInset)?t:$d711de5b069e63ac$var$defaultInset;i.moveTo($d711de5b069e63ac$var$origin.x,$d711de5b069e63ac$var$origin.y-r);for(var o=0;o<a;o++)i.rotate(Math.PI/a),i.lineTo($d711de5b069e63ac$var$origin.x,$d711de5b069e63ac$var$origin.y-r*s),i.rotate(Math.PI/a),i.lineTo($d711de5b069e63ac$var$origin.x,$d711de5b069e63ac$var$origin.y-r)}var $80023d2441d8d57c$var$defaultInset=2,$80023d2441d8d57c$var$defaultSides=5,$80023d2441d8d57c$export$9353a030aedd2caa=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.validTypes=["star"]}return(0,$7h4XF._)(e,[{key:"draw",value:function(e){$d711de5b069e63ac$export$ca57b923902a3c0(e)}},{key:"getSidesCount",value:function(e){var t,i=e.shapeData;return Math.round($e8499b8b34df9b2a$export$e70c64b68236cb4e(null!=(t=null==i?void 0:i.sides)?t:$80023d2441d8d57c$var$defaultSides))}},{key:"particleInit",value:function(e,t){var i,n=t.shapeData;t.starInset=$e8499b8b34df9b2a$export$e70c64b68236cb4e(null!=(i=null==n?void 0:n.inset)?i:$80023d2441d8d57c$var$defaultInset)}}]),e}();function $aff60a259e2538a3$export$f283471236cef89e(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return e.checkVersion("3.9.1"),[4,e.addShape(new $80023d2441d8d57c$export$9353a030aedd2caa,t)];case 1:return i.sent(),[2]}})})()}var $77ea71586764307c$var$ALPHA_CIRCLE=0,$77ea71586764307c$var$ALPHA_CHALK=1,$77ea71586764307c$var$ALPHA_CAL=2,$77ea71586764307c$var$ALPHA_SQUARE=3,$77ea71586764307c$var$TWO_PI=2*Math.PI,$77ea71586764307c$export$acbb57e7d21b5855=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.context={},this.klHistory={},this.particleContainer=void 0,this.settingHasOpacityPressure=!1,this.settingHasScatterPressure=!1,this.settingHasSizePressure=!0,this.settingSize=2,this.settingSpacing=.8489,this.settingOpacity=1,this.settingScatter=0,this.settingColor={},this.settingColorStr="",this.settingAlphaId=$77ea71586764307c$var$ALPHA_CIRCLE,this.settingLockLayerAlpha=!1,this.settingSparkleCount=5,this.hasDrawnDot=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.inputArr=[],this.inputIsDrawing=!1,this.bezierLine=null,this.alphaCanvas128=$eWjiX.BB.canvas(128,128),this.alphaCanvas64=$eWjiX.BB.canvas(64,64),this.alphaCanvas32=$eWjiX.BB.canvas(32,32),this.alphaOpacityArr=[1,.9,1,1],this.changedTiles=[],this.initializeParticles()}return(0,$7h4XF._)(e,[{key:"updateChangedTiles",value:function(e){var t=(0,$eg83P.boundsOverlap)(e,this.selectionBounds);t&&(this.changedTiles=$3798530d3967d87a$export$1774f90c6da5013c(this.changedTiles,$3798530d3967d87a$export$2098fe43203ddd32(t,this.context.canvas.width,this.context.canvas.height)))}},{key:"updateAlphaCanvas",value:function(){if(this.settingAlphaId!==$77ea71586764307c$var$ALPHA_CIRCLE&&this.settingAlphaId!==$77ea71586764307c$var$ALPHA_SQUARE)for(var e,t=[[this.alphaCanvas128,128],[this.alphaCanvas64,64],[this.alphaCanvas32,32]],i=0;i<t.length;i++)(e=$eWjiX.BB.ctx(t[i][0])).save(),e.clearRect(0,0,t[i][1],t[i][1]),e.fillStyle="rgba("+this.settingColor.r+", "+this.settingColor.g+", "+this.settingColor.b+", "+this.alphaOpacityArr[this.settingAlphaId]+")",e.fillRect(0,0,t[i][1],t[i][1]),e.globalCompositeOperation="destination-in",e.imageSmoothingQuality="high",e.drawImage($ff6c1f784f50f5d5$export$67a3081d7cc6182d[this.settingAlphaId],0,0,t[i][1],t[i][1]),e.restore()}},{key:"calcOpacity",value:function(e){return this.settingOpacity*(this.settingHasOpacityPressure?e*e:1)}},{key:"calcScatter",value:function(e){return this.settingScatter*this.settingSize*(this.settingHasScatterPressure?e:1)}},{key:"drawDot",value:function(e,t,i,n,r,a,s){if(!(i<=0))if(this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),s&&s[3]===n||(this.context.globalAlpha=n),s||this.settingAlphaId!==$77ea71586764307c$var$ALPHA_CIRCLE&&this.settingAlphaId!==$77ea71586764307c$var$ALPHA_SQUARE||(this.context.fillStyle=this.settingColorStr),this.particleContainer){for(var o=Math.max(.5,i/4),l=i/2,h=[],c=0;c<this.settingSparkleCount;c++){var u=e,d=t;if(r>0){var p=2*Math.random()*Math.PI,f=Math.sqrt(Math.random())*r;u+=Math.cos(p)*f,d+=Math.sin(p)*f}var g=Math.random()*$77ea71586764307c$var$TWO_PI,v=Math.random()*l;u+=Math.cos(g)*v,d+=Math.sin(g)*v,h.push({position:{x:u,y:d},size:o,color:this.settingColor,opacity:n});var m=o;this.updateChangedTiles({x1:Math.floor(u-m),y1:Math.floor(d-m),x2:Math.ceil(u+m),y2:Math.ceil(d+m)})}this.renderParticlesToCanvas(h),this.hasDrawnDot=!0}else for(var y=Math.max(.5,i/4),x=i/2,b=0;b<this.settingSparkleCount;b++){var w=e,k=t;if(r>0){var B=2*Math.random()*Math.PI,S=Math.sqrt(Math.random())*r;w+=Math.cos(B)*S,k+=Math.sin(B)*S}var C=Math.random()*$77ea71586764307c$var$TWO_PI,E=Math.random()*x;w+=Math.cos(C)*E,k+=Math.sin(C)*E;var _=y;if(this.updateChangedTiles({x1:Math.floor(w-_),y1:Math.floor(k-_),x2:Math.ceil(w+_),y2:Math.ceil(k+_)}),this.settingAlphaId===$77ea71586764307c$var$ALPHA_CIRCLE)this.context.beginPath(),this.context.arc(w,k,y,0,$77ea71586764307c$var$TWO_PI),this.context.closePath(),this.context.fill(),this.hasDrawnDot=!0;else if(this.settingAlphaId===$77ea71586764307c$var$ALPHA_SQUARE)void 0!==a&&(this.context.save(),this.context.translate(w,k),this.context.rotate(a/180*Math.PI),this.context.fillRect(-y,-y,2*y,2*y),this.context.restore(),this.hasDrawnDot=!0);else{this.context.save(),this.context.translate(w,k);var I=this.alphaCanvas128;y<=32&&y>16?I=this.alphaCanvas64:y<=16&&(I=this.alphaCanvas32),this.context.scale(y,y),this.settingAlphaId===$77ea71586764307c$var$ALPHA_CHALK&&this.context.rotate((w+k)*53123%$77ea71586764307c$var$TWO_PI),this.context.drawImage(I,-1,-1,2,2),this.context.restore(),this.hasDrawnDot=!0}}}},{key:"continueLine",value:function(e,t,i,n){var r=this;null===this.bezierLine&&(this.bezierLine=new $eWjiX.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,function(){}));var a=[],s=function(e){var t=$eWjiX.BB.mix(r.lastInput2.pressure,n,e.t),i=r.calcOpacity(t),s=Math.max(.1,r.settingSize*(r.settingHasSizePressure?t:1)),o=r.calcScatter(t);a.push([e.x,e.y,s,i,o,e.angle])},o=i*this.settingSpacing;null===e||null===t?this.bezierLine.addFinal(o,s):this.bezierLine.add(e,t,o,s),this.context.save();for(var l=void 0,h=0;h<a.length;h++){var c=a[h];this.drawDot(c[0],c[1],c[2],c[3],c[4],c[5],l),l=c}this.context.restore()}},{key:"initializeParticles",value:function(){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:if(this.particleContainer)return[2];t.label=1;case 1:return t.trys.push([1,4,,5]),e=this,[4,$43c100db3512d244$export$218c38ca7c058037.load({id:"glitter-brush",options:{background:{color:{value:"transparent"}},fpsLimit:60,particles:{number:{value:0},color:{value:`rgb(${this.settingColor.r}, ${this.settingColor.g}, ${this.settingColor.b})`},shape:{type:"star"},opacity:{value:1},size:{value:2},move:{enable:!1}},detectRetina:!0}})];case 2:return e.particleContainer=t.sent(),[4,$aff60a259e2538a3$export$f283471236cef89e($43c100db3512d244$export$218c38ca7c058037)];case 3:return t.sent(),[3,5];case 4:return console.warn("Failed to initialize tsparticles for glitter brush:",t.sent()),this.particleContainer=void 0,[3,5];case 5:return[2]}})}).call(this)}},{key:"renderParticlesToCanvas",value:function(e){var t=this;this.particleContainer&&(this.context.save(),this.context.globalCompositeOperation=this.settingLockLayerAlpha?"source-atop":"source-over",e.forEach(function(e){t.context.save(),t.context.globalAlpha=e.opacity,t.context.fillStyle=`rgb(${e.color.r}, ${e.color.g}, ${e.color.b})`,t.drawStar(e.position.x,e.position.y,e.size),t.context.restore()}),this.context.restore())}},{key:"drawStar",value:function(e,t,i){var n=5,r=i,a=.5*i,s=Math.PI/2*3,o=e,l=t,h=Math.PI/5;this.context.beginPath(),this.context.moveTo(e,t-r);for(var c=0;c<n;c++)o=e+Math.cos(s)*r,l=t+Math.sin(s)*r,this.context.lineTo(o,l),s+=h,o=e+Math.cos(s)*a,l=t+Math.sin(s)*a,this.context.lineTo(o,l),s+=h;this.context.lineTo(e,t-r),this.context.closePath(),this.context.fill()}},{key:"startLine",value:function(e,t,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],i=$eWjiX.BB.clamp(i,0,1);var n=this.calcOpacity(i),r=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize),a=this.calcScatter(i);this.hasDrawnDot=!1,this.inputIsDrawing=!0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(e,t,r,n,a),this.context.restore(),this.lineToolLastDot=r*this.settingSpacing,this.lastInput.x=e,this.lastInput.y=t,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.inputArr=[{x:e,y:t,pressure:i}]}},{key:"goLine",value:function(e,t,i){if(this.inputIsDrawing){var n=$eWjiX.BB.clamp(i,0,1),r=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(e,t,r,this.lastInput.pressure),this.context.restore(),this.lastInput.x=e,this.lastInput.y=t,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=n,this.inputArr.push({x:e,y:t,pressure:i})}}},{key:"endLine",value:function(){var e=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);if(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(null,null,e,this.lastInput.pressure),this.context.restore(),this.inputIsDrawing=!1,this.settingAlphaId===$77ea71586764307c$var$ALPHA_SQUARE&&!this.hasDrawnDot){var t=this.inputArr[0];this.inputArr.forEach(function(e){e.pressure>t.pressure&&(t=e)}),this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);var i=$eWjiX.BB.clamp(t.pressure,0,1),n=this.calcOpacity(i),r=this.calcScatter(i);this.drawDot(t.x,t.y,e,n,r,0),this.context.restore()}this.bezierLine=null,this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles))),this.hasDrawnDot=!1,this.inputArr=[]}},{key:"drawLineSegment",value:function(e,t,i,n){if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$9b3eo.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.lastInput.x=i,this.lastInput.y=n,this.lastInput.pressure=1,!this.inputIsDrawing&&void 0!==e){var r,a=$eWjiX.BB.pointsToAngleDeg({x:e,y:t},{x:i,y:n}),s=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),o=(i-e)/s,l=(n-t)/s,h=this.settingSize*this.settingSpacing;this.lineToolLastDot=this.settingSize*this.settingSpacing,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);var c=this.calcScatter(1);for(r=this.lineToolLastDot;r<=s;r+=h)this.drawDot(e+o*r,t+l*r,this.settingSize,this.settingOpacity,c,a);this.context.restore(),this.changedTiles.some(function(e){return e})&&this.klHistory.push($5bc59effccf14376$export$263fa670dc037098(this.klHistory.getComposed(),$1a6c9997bc8182ff$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}}},{key:"isDrawing",value:function(){return this.inputIsDrawing}},{key:"setAlpha",value:function(e){this.settingAlphaId!==e&&(this.settingAlphaId=e,this.updateAlphaCanvas())}},{key:"setColor",value:function(e){this.settingColor!==e&&(this.settingColor={r:e.r,g:e.g,b:e.b},this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")",this.updateAlphaCanvas())}},{key:"setContext",value:function(e){this.context=e}},{key:"setHistory",value:function(e){this.klHistory=e}},{key:"setSize",value:function(e){this.settingSize=e}},{key:"setOpacity",value:function(e){this.settingOpacity=e}},{key:"setScatter",value:function(e){this.settingScatter=e}},{key:"setSpacing",value:function(e){this.settingSpacing=e}},{key:"sizePressure",value:function(e){this.settingHasSizePressure=e}},{key:"opacityPressure",value:function(e){this.settingHasOpacityPressure=e}},{key:"scatterPressure",value:function(e){this.settingHasScatterPressure=e}},{key:"setLockAlpha",value:function(e){this.settingLockLayerAlpha=e}},{key:"setSparkleCount",value:function(e){this.settingSparkleCount=Math.max(1,Math.min(20,e))}},{key:"getSpacing",value:function(){return this.settingSpacing}},{key:"getSize",value:function(){return this.settingSize}},{key:"getOpacity",value:function(){return this.settingOpacity}},{key:"getScatter",value:function(){return this.settingScatter}},{key:"getLockAlpha",value:function(){return this.settingLockLayerAlpha}},{key:"getSparkleCount",value:function(){return this.settingSparkleCount}}]),e}(),$42ac5b30ad65dabb$export$32510733a89b2eab={PenBrush:$3f0923cd3c55ea92$export$6f96c8f9e6ae7341,BlendBrush:$02d77b8dd5755328$export$9659db8d01dd5313,SketchyBrush:$c214fbe9e4fc15b0$export$566f9061f0f5ba33,PixelBrush:$58b45953679baa4a$export$4de5ef8eecde6f12,ChemyBrush:$348fcce123898af9$export$38b08aa4ea8f61c6,SmudgeBrush:$78ad817c60f81b7c$export$c9f800961903deab,EraserBrush:$fc1a683099fb2d61$export$fe52c90afd1cf5ba,GlitterBrush:$77ea71586764307c$export$acbb57e7d21b5855},$eWjiX=parcelRequire("eWjiX"),$e8a5c017c49bb311$export$f02de051ab70b20e=20,$3941da0020c40ac2$exports={};$3941da0020c40ac2$exports=$parcel$resolve("iiCd6");var $8b6ca25eb0830594$export$a0d4983f3b0b5c8e=function(){var e={image:$parcel$interopDefault($3941da0020c40ac2$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen"),sizeSlider:{min:.5,max:100,curve:$eWjiX.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]},scatterSlider:{min:0,max:100,curve:$eWjiX.BB.powerSplineInput(0,100,.1,2.5)}},t=[$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-circle"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-chalk"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-calligraphy"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-square")];return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen"),t=[$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-circle"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-chalk"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-calligraphy"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-square")]}),e.Ui=function(i){var n,r,a,s=document.createElement("div"),o=new $42ac5b30ad65dabb$export$32510733a89b2eab.PenBrush;o.setHistory(i.klHistory),i.onSizeChange(o.getSize());var l=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[0,1,2,3].map(function(e){var i=$eWjiX.BB.el({className:"dark-invert",css:{width:"31px",height:"31px",backgroundSize:"contain",margin:"2px"}}),n=$eWjiX.BB.canvas(70,70),r=$eWjiX.BB.ctx(n);return 0===e||3===e?0===e?(r.beginPath(),r.arc(35,35,30,0,2*Math.PI),r.closePath(),r.fill()):r.fillRect(5,5,60,60):1===e?r.drawImage($f875015ce1aeb4d3$export$74a44bbc21d06a28(60),5,5):2===e&&r.drawImage($f875015ce1aeb4d3$export$eaa218d5d17c8f1c(60),5,5),i.style.backgroundImage="url("+n.toDataURL("image/png")+")",{id:e,label:i,title:t[e]}}),initId:0,onChange:function(e){o.setAlpha(e)}}),h=new $365a915dfb503274$export$48513f6b9f8ce62d({init:o.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){o.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),c=new $eWjiX.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function u(e){o.setSize(e),o.setSpacing(Math.max(2,c.interpolate(e))/15)}(function(){n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:o.getSize(),curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){u(e),i.onSizeChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),r=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:e.opacitySlider.max,curve:e.opacitySlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){o.setOpacity(e),i.onOpacityChange(e)}}),a=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("scatter"),width:225,height:30,min:e.scatterSlider.min,max:e.scatterSlider.max,value:e.scatterSlider.min,curve:e.scatterSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,onChange:function(e){o.setScatter(e),i.onScatterChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1});var t=$a49c90053f8766a2$export$9da2e8821e6cbb57(!0,function(e){o.sizePressure(e)}),c=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){o.opacityPressure(e)}),d=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){o.scatterPressure(e)});s.append($eWjiX.BB.el({content:[n.getElement(),t],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[r.getElement(),c],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[a.getElement(),d],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),$eWjiX.BB.el({content:l.getElement(),css:{marginTop:"10px"}}),$eWjiX.BB.el({content:h.getElement(),css:{marginTop:"10px"}}))})(),this.increaseSize=function(e){o.isDrawing()||n.changeSliderValue(e)},this.decreaseSize=function(e){o.isDrawing()||n.changeSliderValue(-e)},this.getSize=function(){return o.getSize()},this.setSize=function(e){u(e),n.setValue(e)},this.getOpacity=function(){return o.getOpacity()},this.setOpacity=function(e){o.setOpacity(e),r.setValue(e)},this.getScatter=function(){return o.getScatter()},this.setScatter=function(e){o.setScatter(e),a.setValue(e)},this.setColor=function(e){o.setColor(e)},this.setLayer=function(e){o.setContext(e.context)},this.startLine=function(e,t,i){o.startLine(e,t,i)},this.goLine=function(e,t,i){o.goLine(e,t,i)},this.endLine=function(){o.endLine()},this.getBrush=function(){return o},this.isDrawing=function(){return o.isDrawing()},this.getElement=function(){return s}},e}(),$eWjiX=parcelRequire("eWjiX"),$56d129e05aa1cb30$exports={};$56d129e05aa1cb30$exports=$parcel$resolve("6fRlX");var $2e3c50106ba150d5$export$156bb4fe8f4bcb4b=function(){var e={image:$parcel$interopDefault($56d129e05aa1cb30$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-blend"),sizeSlider:{min:.5,max:100,curve:$eWjiX.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-blend")}),e.Ui=function(t){var i,n,r=document.createElement("div"),a=new $42ac5b30ad65dabb$export$32510733a89b2eab.BlendBrush;function s(e){a.setSize(e)}a.setHistory(t.klHistory),t.onSizeChange(a.getSize()),function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:58,curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){s(e),t.onSizeChange(e)}}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:a.getOpacity(),curve:e.opacitySlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setOpacity(e),t.onOpacityChange(e)}});var o=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-blending"),width:225,height:30,min:0,max:1,value:a.getBlending(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setBlending(e)}});o.getElement().style.marginTop="10px";var l=$a49c90053f8766a2$export$9da2e8821e6cbb57(!0,function(e){a.setSizePressure(e)}),h=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){a.setOpacityPressure(e)}),c=new $365a915dfb503274$export$48513f6b9f8ce62d({init:a.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){a.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),css:{marginTop:"10px",display:"inline-block"},name:"lock-alpha"});r.append($eWjiX.BB.el({content:[i.getElement(),l],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[n.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),o.getElement(),c.getElement())}(),this.increaseSize=function(e){a.getIsDrawing()||i.changeSliderValue(e)},this.decreaseSize=function(e){a.getIsDrawing()||i.changeSliderValue(-e)},this.getSize=function(){return a.getSize()},this.setSize=function(e){s(e),i.setValue(e)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(e){a.setOpacity(e),n.setValue(e)},this.setColor=function(e){a.setColor(e)},this.setLayer=function(e){a.setContext(e.context,e.id)},this.startLine=function(e,t,i){a.startLine(e,t,i)},this.goLine=function(e,t,i,n){a.goLine(e,t,i,!1)},this.endLine=function(){a.endLine()},this.getBrush=function(){return a},this.isDrawing=function(){return a.getIsDrawing()},this.getElement=function(){return r}},e}(),$28d12d45dca1131c$exports={};$28d12d45dca1131c$exports=$parcel$resolve("hC7PC");var $eWjiX=parcelRequire("eWjiX"),$94537af75923b9e3$export$ffae56164d1bde68=function(){var e={image:$parcel$interopDefault($28d12d45dca1131c$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-sketchy"),sizeSlider:{min:.5,max:10},opacitySlider:{min:.01,max:1}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-sketchy")}),e.Ui=function(t){var i,n,r=document.createElement("div"),a=new $42ac5b30ad65dabb$export$32510733a89b2eab.SketchyBrush;function s(e){a.setSize(e)}a.setHistory(t.klHistory),t.onSizeChange(a.getSize()),function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:250,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:2*a.getSize(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){a.setSize(e),t.onSizeChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:250,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:a.getOpacity(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setOpacity(e),t.onOpacityChange(e)}});var s=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-blending"),width:250,height:30,min:0,max:1,value:a.getBlending(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setBlending(e)}}),o=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-sketchy-scale"),width:250,height:30,min:1,max:20,value:a.getScale(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,onChange:function(e){a.setScale(e)}});n.getElement().style.marginTop="10px",s.getElement().style.marginTop="10px",o.getElement().style.marginTop="10px",r.append(i.getElement(),n.getElement(),s.getElement(),o.getElement())}(),this.increaseSize=function(e){a.isDrawing()||i.changeSliderValue(e)},this.decreaseSize=function(e){a.isDrawing()||i.changeSliderValue(-e)},this.getSize=function(){return a.getSize()},this.setSize=function(e){s(e),i.setValue(e)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(e){a.setOpacity(e),n.setValue(e)},this.setColor=function(e){a.setColor(e)},this.setLayer=function(e){a.setContext(e.context)},this.startLine=function(e,t,i){a.startLine(e,t,i)},this.goLine=function(e,t,i){a.goLine(e,t,i,void 0)},this.endLine=function(){a.endLine()},this.getSeed=function(){return parseInt(""+a.getSeed())},this.setSeed=function(e){a.setSeed(parseInt(""+e))},this.getBrush=function(){return a},this.isDrawing=function(){return a.isDrawing()},this.getElement=function(){return r}},e}(),$eWjiX=parcelRequire("eWjiX"),$099bb534dd6472de$exports={};$099bb534dd6472de$exports=$parcel$resolve("eZgVv");var $9519e739bc9666ee$export$d001f3406562d07=function(){var e={image:$parcel$interopDefault($099bb534dd6472de$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-pixel"),sizeSlider:{min:.5,max:100,curve:$eWjiX.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-pixel")}),e.Ui=function(t){var i,n,r=document.createElement("div"),a=new $42ac5b30ad65dabb$export$32510733a89b2eab.PixelBrush;a.setHistory(t.klHistory),t.onSizeChange(a.getSize());var s=new $365a915dfb503274$export$48513f6b9f8ce62d({init:a.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){a.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),name:"lock-alpha-toggle"}),o=new $365a915dfb503274$export$48513f6b9f8ce62d({init:a.getIsEraser(),label:$8d7403abedf7cefa$export$ce37e184d908d785("eraser"),callback:function(e){a.setIsEraser(e)},name:"eraser-toggle"}),l=new $365a915dfb503274$export$48513f6b9f8ce62d({init:a.getUseDither(),label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-pixel-dither"),callback:function(e){a.setUseDither(e)},name:"dither-toggle"}),h=new $eWjiX.BB.SplineInterpolator([[.5,.45],[100,4]]);function c(e){a.setSize(e),a.setSpacing(h.interpolate(e)/e)}(function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:a.getSize(),curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){c(e),t.onSizeChange(e)}}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:e.opacitySlider.max,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setOpacity(e),t.onOpacityChange(e)}});var h=$a49c90053f8766a2$export$9da2e8821e6cbb57(!0,function(e){a.sizePressure(e)});r.append($eWjiX.BB.el({content:[i.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),n.getElement()),$eWjiX.BB.el({parent:r,css:{display:"flex",marginTop:"10px",gap:"10px",flexWrap:"wrap"}}).append(s.getElement(),o.getElement(),l.getElement())})(),this.increaseSize=function(e){a.isDrawing()||i.changeSliderValue(e)},this.decreaseSize=function(e){a.isDrawing()||i.changeSliderValue(-e)},this.getSize=function(){return a.getSize()},this.setSize=function(e){c(e),i.setValue(2*e)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(e){a.setOpacity(e),n.setValue(100*e)},this.setColor=function(e){a.setColor(e)},this.setLayer=function(e){a.setContext(e.context)},this.startLine=function(e,t,i){a.startLine(e,t,i)},this.goLine=function(e,t,i){a.goLine(e,t,i)},this.endLine=function(){a.endLine()},this.getBrush=function(){return a},this.isDrawing=function(){return a.isDrawing()},this.toggleEraser=function(){o.setValue(!o.getValue()),a.setIsEraser(o.getValue())},this.getElement=function(){return r}},e}(),$eWjiX=parcelRequire("eWjiX"),$749e6c1deca5fab7$exports={};$749e6c1deca5fab7$exports=$parcel$resolve("fPZin");var $d6fc2ded7d9d56db$export$cf481ecf227135a8=function(){var e={image:$parcel$interopDefault($749e6c1deca5fab7$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("eraser")+" [E]",sizeSlider:{min:.5,max:200,curve:$eWjiX.BB.powerSplineInput(.5,200,.1)},opacitySlider:{min:.01,max:1}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("eraser")+" [E]"}),e.Ui=function(t){var i,n,r=document.createElement("div"),a=new $42ac5b30ad65dabb$export$32510733a89b2eab.EraserBrush;a.setHistory(t.klHistory),t.onSizeChange(a.getSize());var s=!1;function o(e){a.setSize(e)}(function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:30,curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){o(e),t.onSizeChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:e.opacitySlider.max,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setOpacity(e),t.onOpacityChange(e)}});var l=$a49c90053f8766a2$export$9da2e8821e6cbb57(!0,function(e){a.sizePressure(e)}),h=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){a.opacityPressure(e)});r.append($eWjiX.BB.el({content:[i.getElement(),l],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[n.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}));var c=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-eraser-transparent-bg"),callback:function(e){s=e,a.setTransparentBG(e)},css:{marginTop:"10px"},name:"transparency-toggle"});r.append(c.getElement())})(),this.increaseSize=function(e){a.isDrawing()||i.changeSliderValue(e)},this.decreaseSize=function(e){a.isDrawing()||i.changeSliderValue(-e)},this.getSize=function(){return a.getSize()},this.setSize=function(e){o(e),i.setValue(e)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(e){a.setOpacity(e),n.setValue(e)},this.setColor=function(){},this.setLayer=function(e){a.setLayer(e)},this.startLine=function(e,t,i){a.startLine(e,t,i)},this.goLine=function(e,t,i){a.goLine(e,t,i)},this.endLine=function(){a.endLine()},this.getBrush=function(){return a},this.getIsTransparentBg=function(){return s},this.isDrawing=function(){return a.isDrawing()},this.getElement=function(){return r}},e}(),$eWjiX=parcelRequire("eWjiX"),$e1552c11f17fda03$exports={};$e1552c11f17fda03$exports=$parcel$resolve("fp7H1");var $1045b9bae2ffbbb4$export$84831662ba707e7a=function(){var e={image:$parcel$interopDefault($e1552c11f17fda03$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-smudge"),sizeSlider:{min:.5,max:100,curve:$eWjiX.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-smudge")}),e.Ui=function(t){var i,n,r=document.createElement("div"),a=new $42ac5b30ad65dabb$export$32510733a89b2eab.SmudgeBrush;a.setHistory(t.klHistory),t.onSizeChange(a.getSize());var s=new $365a915dfb503274$export$48513f6b9f8ce62d({init:a.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){a.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),o=new $eWjiX.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function l(e){a.setSize(e),a.setSpacing(Math.max(2,o.interpolate(e))/15)}(function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:a.getSize(),curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){l(e),t.onSizeChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:a.getOpacity(),curve:e.opacitySlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){a.setOpacity(e),t.onOpacityChange(e)}});var o=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){a.sizePressure(e)}),h=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){a.opacityPressure(e)});r.append($eWjiX.BB.el({content:[i.getElement(),o],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[n.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}})),$eWjiX.BB.el({parent:r,css:{marginTop:"10px"}}).append(s.getElement())})(),this.increaseSize=function(e){a.getIsDrawing()||i.changeSliderValue(e)},this.decreaseSize=function(e){a.getIsDrawing()||i.changeSliderValue(-e)},this.getSize=function(){return a.getSize()},this.setSize=function(e){l(e),i.setValue(e)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(e){a.setOpacity(e),n.setValue(e)},this.setColor=function(e){a.setColor(e)},this.setLayer=function(e){a.setContext(e.context)},this.startLine=function(e,t,i){a.startLine(e,t,i)},this.goLine=function(e,t,i){a.goLine(e,t,i)},this.endLine=function(){a.endLine()},this.getBrush=function(){return a},this.isDrawing=function(){return a.getIsDrawing()},this.getElement=function(){return r}},e}(),$eWjiX=parcelRequire("eWjiX"),$457e9828be061aff$exports={};$457e9828be061aff$exports=$parcel$resolve("eX098");var $7jh4K=parcelRequire("7jh4K"),$18456e8104a5a825$export$80819a93636ebb04=function(){var e={image:$parcel$interopDefault($457e9828be061aff$exports),tooltip:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy"),sizeSlider:{min:.25,max:25,curve:$eWjiX.BB.powerSplineInput(.25,25,.1),isDisabled:!0},opacitySlider:{min:.01,max:1}};return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy")}),e.Ui=function(t){var i,n,r,a=document.createElement("div"),s=new $42ac5b30ad65dabb$export$32510733a89b2eab.ChemyBrush;function o(e){s.setSize(e)}s.setHistory(t.klHistory),t.onSizeChange(s.getSize()),function(){i=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:250,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:s.getSize(),curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,isEnabled:"stroke"===s.getMode(),toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){o(e),t.onSizeChange(e)},formatFunc:function(e){return e<5?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:250,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:s.getOpacity(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){s.setOpacity(e),t.onOpacityChange(e)}}),(0,$7jh4K.css)(n.getElement(),{marginTop:"10px"}),r=new $365a915dfb503274$export$48513f6b9f8ce62d({init:s.getIsEraser(),label:$8d7403abedf7cefa$export$ce37e184d908d785("eraser"),callback:function(e){s.setIsEraser(e)},css:{marginTop:"10px",marginLeft:"10px"},name:"eraser-toggle"});var l=new $365a915dfb503274$export$48513f6b9f8ce62d({init:s.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){s.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),css:{marginTop:"10px"},name:"lock-alpha-toggle"}),h=$eWjiX.BB.el({css:{display:"flex",marginTop:"10px"}}),c=35,u=8,d=19,p=9.5,f=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"fill",label:$eWjiX.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"#000",css:{transformOrigin:"0 0",transform:`translate(-0.5px, -0.5px) scale(${d}, ${d}) translate(0.5px, 0.5px)`},d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy-fill")},{id:"stroke",label:$eWjiX.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"0.12px",transformOrigin:"0 0",transform:`translate(-0.5px, -0.5px) scale(${d}, ${d}) translate(0.5px, 0.5px)`},d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy-stroke")}],initId:s.getMode(),onChange:function(n){s.setMode(n),e.sizeSlider.isDisabled="fill"===s.getMode(),i.setIsEnabled(!e.sizeSlider.isDisabled);var r=s.getSize();i.setValue(r),t.onSizeChange(r),t.onConfigChange()}}),g=new $afe02cc26c765c2c$export$2358c75ad3c15b2d({label:$eWjiX.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"1px"},d:`M ${p+u},${u} ${p+u},${d+u}`}]}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy-mirror-x"),init:s.getXSymmetry(),onChange:function(e){s.setXSymmetry(e)}}),v=new $afe02cc26c765c2c$export$2358c75ad3c15b2d({label:$eWjiX.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"1px"},d:`M ${u},${p+u} ${d+u},${p+u}`}]}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy-mirror-y"),init:s.getYSymmetry(),onChange:function(e){s.setYSymmetry(e)}}),m=new $afe02cc26c765c2c$export$2358c75ad3c15b2d({label:$eWjiX.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"defs",childrenArr:[{elementType:"linearGradient",id:"gradient",x1:"0",y1:"0",x2:"0",y2:"1",childrenArr:[{elementType:"stop",offset:"0%","stop-color":"rgba(0,0,0,0)"},{elementType:"stop",offset:"100%","stop-color":"rgba(0,0,0,1)"}]}]},{elementType:"rect",fill:"url('#gradient')",x:""+u,y:""+u,width:""+d,height:""+d}]}),title:$8d7403abedf7cefa$export$ce37e184d908d785("brush-chemy-gradient"),init:s.getGradient(),onChange:function(e){s.setGradient(e)}});(0,$7jh4K.css)(g.getElement(),{marginLeft:"10px"});var y={marginLeft:"4px"};(0,$7jh4K.css)(v.getElement(),y),(0,$7jh4K.css)(m.getElement(),y),h.append(f.getElement(),g.getElement(),v.getElement(),m.getElement()),a.append(i.getElement(),n.getElement(),h,$eWjiX.BB.el({content:[l.getElement(),r.getElement()],css:{display:"flex"}}))}(),this.increaseSize=function(e){s.getIsDrawing()||"stroke"!==s.getMode()||i.changeSliderValue(e)},this.decreaseSize=function(e){s.getIsDrawing()||"stroke"!==s.getMode()||i.changeSliderValue(-e)},this.getSize=function(){return s.getSize()},this.setSize=function(e){o(e),i.setValue(e)},this.getOpacity=function(){return s.getOpacity()},this.setOpacity=function(e){s.setOpacity(e),n.setValue(e)},this.setColor=function(e){s.setColor(e)},this.setLayer=function(e){s.setContext(e.context)},this.startLine=function(e,t,i){s.startLine(e,t)},this.goLine=function(e,t,i,n){s.goLine(e,t)},this.endLine=function(){s.endLine()},this.getBrush=function(){return s},this.isDrawing=function(){return s.getIsDrawing()},this.toggleEraser=function(){r.setValue(!r.getValue()),s.setIsEraser(r.getValue())},this.getElement=function(){return a}},e}(),$eWjiX=parcelRequire("eWjiX"),$00da50a5891c1757$export$7e5dfa86b6697bf5=function(){var e={image:$parcel$interopDefault($3941da0020c40ac2$exports),tooltip:"Glitter Brush",sizeSlider:{min:.5,max:100,curve:$eWjiX.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]},scatterSlider:{min:0,max:100,curve:$eWjiX.BB.powerSplineInput(0,100,.1,2.5)}},t=[$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-circle"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-chalk"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-calligraphy"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-square")];return $8d7403abedf7cefa$export$e4ce066d17694649.subscribe(function(){e.tooltip=$8d7403abedf7cefa$export$ce37e184d908d785("brush-glitter"),t=[$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-circle"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-chalk"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-calligraphy"),$8d7403abedf7cefa$export$ce37e184d908d785("brush-pen-square")]}),e.Ui=function(i){var n,r,a,s,o=document.createElement("div"),l=new $42ac5b30ad65dabb$export$32510733a89b2eab.GlitterBrush;l.setHistory(i.klHistory),i.onSizeChange(l.getSize());var h=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[0,1,2,3].map(function(e){var i=$eWjiX.BB.el({className:"dark-invert",css:{width:"31px",height:"31px",backgroundSize:"contain",margin:"2px"}}),n=$eWjiX.BB.canvas(70,70),r=$eWjiX.BB.ctx(n);return 0===e||3===e?0===e?(r.beginPath(),r.arc(35,35,30,0,2*Math.PI),r.closePath(),r.fill()):r.fillRect(5,5,60,60):1===e?r.drawImage($f875015ce1aeb4d3$export$74a44bbc21d06a28(60),5,5):2===e&&r.drawImage($f875015ce1aeb4d3$export$eaa218d5d17c8f1c(60),5,5),i.style.backgroundImage="url("+n.toDataURL("image/png")+")",{id:e,label:i,title:t[e]}}),initId:0,onChange:function(e){l.setAlpha(e)}}),c=new $365a915dfb503274$export$48513f6b9f8ce62d({init:l.getLockAlpha(),label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),callback:function(e){l.setLockAlpha(e)},doHighlight:!0,title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),u=new $eWjiX.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function d(e){l.setSize(e),l.setSpacing(Math.max(2,u.interpolate(e))/15)}(function(){n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-size"),width:225,height:30,min:e.sizeSlider.min,max:e.sizeSlider.max,value:l.getSize(),curve:e.sizeSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 2*e},toValue:function(e){return e/2},onChange:function(e){d(e),i.onSizeChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),r=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:225,height:30,min:e.opacitySlider.min,max:e.opacitySlider.max,value:e.opacitySlider.max,curve:e.opacitySlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,toDisplayValue:function(e){return 100*e},toValue:function(e){return e/100},onChange:function(e){l.setOpacity(e),i.onOpacityChange(e)}}),a=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("scatter"),width:225,height:30,min:e.scatterSlider.min,max:e.scatterSlider.max,value:e.scatterSlider.min,curve:e.scatterSlider.curve,eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,onChange:function(e){l.setScatter(e),i.onScatterChange(e)},formatFunc:function(e){return e<10?$eWjiX.BB.round(e,1):Math.round(e)},manualInputRoundDigits:1}),s=new $5c0625e6104e2c75$export$a1855b925e534de7({label:"Sparkle Count",width:225,height:30,min:1,max:20,value:l.getSparkleCount(),eventResMs:$e8a5c017c49bb311$export$f02de051ab70b20e,onChange:function(e){l.setSparkleCount(Math.round(e))},formatFunc:function(e){return Math.round(e)},manualInputRoundDigits:0});var t=$a49c90053f8766a2$export$9da2e8821e6cbb57(!0,function(e){l.sizePressure(e)}),u=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){l.opacityPressure(e)}),p=$a49c90053f8766a2$export$9da2e8821e6cbb57(!1,function(e){l.scatterPressure(e)});o.append($eWjiX.BB.el({content:[n.getElement(),t],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[r.getElement(),u],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:[a.getElement(),p],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$eWjiX.BB.el({content:s.getElement(),css:{marginBottom:"10px"}}),$eWjiX.BB.el({content:h.getElement(),css:{marginTop:"10px"}}),$eWjiX.BB.el({content:c.getElement(),css:{marginTop:"10px"}}))})(),this.increaseSize=function(e){l.isDrawing()||n.changeSliderValue(e)},this.decreaseSize=function(e){l.isDrawing()||n.changeSliderValue(-e)},this.getSize=function(){return l.getSize()},this.setSize=function(e){d(e),n.setValue(e)},this.getOpacity=function(){return l.getOpacity()},this.setOpacity=function(e){l.setOpacity(e),r.setValue(e)},this.getScatter=function(){return l.getScatter()},this.setScatter=function(e){l.setScatter(e),a.setValue(e)},this.setColor=function(e){l.setColor(e)},this.setLayer=function(e){l.setContext(e.context)},this.startLine=function(e,t,i){l.startLine(e,t,i)},this.goLine=function(e,t,i){l.goLine(e,t,i)},this.endLine=function(){l.endLine()},this.getBrush=function(){return l},this.isDrawing=function(){return l.isDrawing()},this.getElement=function(){return o}},e}(),$7de2f0eab7a9ead7$export$d1a79a5ce7e46547={penBrush:$8b6ca25eb0830594$export$a0d4983f3b0b5c8e,blendBrush:$2e3c50106ba150d5$export$156bb4fe8f4bcb4b,sketchyBrush:$94537af75923b9e3$export$ffae56164d1bde68,pixelBrush:$9519e739bc9666ee$export$d001f3406562d07,chemyBrush:$18456e8104a5a825$export$80819a93636ebb04,smudgeBrush:$1045b9bae2ffbbb4$export$84831662ba707e7a,eraserBrush:$d6fc2ded7d9d56db$export$cf481ecf227135a8,glitterBrush:$00da50a5891c1757$export$7e5dfa86b6697bf5},$eWjiX=parcelRequire("eWjiX");function $2d47de6498e5a87c$export$35fa34e5af64bd4a(e,t){if(!t&&(window.innerHeight<500||window.innerWidth<700))return void window.open(e);var i,n=$eWjiX.BB.el({tagName:"iframe",custom:{src:e},css:{width:"100%",height:"100%",opacity:"0"}});setTimeout(function(){n.style.opacity=""},500);var r=$eWjiX.BB.el();t||(i=$eWjiX.BB.el({tagName:"a",parent:r,content:$8d7403abedf7cefa$export$ce37e184d908d785("modal-new-tab"),custom:{href:"help",target:"_blank"},onClick:function(){a.close()}}),n.onload=function(){if(i&&n.contentWindow)try{$eWjiX.BB.setAttributes(i,{href:""+n.contentWindow.location})}catch(e){}n.style.opacity=""});var a=new $e59fbd08bcc1a36b$export$185108a9b725b68({title:r,content:n,width:880,isMaxHeight:!0,onClose:function(){i&&(n.src="about:blank",$eWjiX.BB.destroyEl(i),i=void 0)}})}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$de98bdc3369d2e4f$export$3dff5655255b5729=function(){"use strict";function e(t){var i=this,n=t.name,r=t.init,a=t.items,s=t.ignoreFocus;(0,$cx0mh._)(this,e),this.inputs=[],this.el=$eWjiX.BB.el({className:"kl-radio"}),a.forEach(function(e){var t=$eWjiX.BB.el({tagName:"label"}),a=$eWjiX.BB.el({tagName:"input",parent:t,custom:{name:n,value:e.value,type:"radio"}});s&&a.setAttribute("data-ignore-focus","true"),r===e.value&&(a.checked=!0),t.append(e.label),i.el.append(t),i.inputs.push(a)})}return(0,$7h4XF._)(e,[{key:"getValue",value:function(){for(var e=0;e<this.inputs.length;e++)if(this.inputs[e].checked)return this.inputs[e].value;return null}},{key:"getElement",value:function(){return this.el}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX");function $57703debd837e772$export$1b9ca798405c9eb6(e){var t,i=new Date().getTime()-e;return i=Math.floor(i/1e3/60),t=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-min-ago").replace("{x}",""+i),i>60&&(i=Math.floor(i/60),t=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-hours-ago").replace("{x}",""+i),i>24&&(i=Math.floor(i/24),t=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-days-ago").replace("{x}",""+i),i>31&&(t=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-month-ago")))),t}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$959a92a71fa952f2$export$852ebaa1b01c8b5a=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.infoButton=$eWjiX.BB.el({content:"?",className:"kl-info-btn",title:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-about"),onClick:function(){$2d47de6498e5a87c$export$35fa34e5af64bd4a("./help/#help-browser-storage",!1)}}),this.rootEl=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage"),css:{display:"flex",margin:"-5px 0",gap:"6px"}}),this.rootEl.append(this.infoButton)}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"show",value:function(){}},{key:"destroy",value:function(){$eWjiX.BB.destroyEl(this.infoButton)}}]),e}();$f36d91ca9b37c82f$export$bd46b8ab3689edc4="a9LdEW_anim",$f36d91ca9b37c82f$export$b5381822af66064b="a9LdEW_animEl";var $72Jv0=parcelRequire("72Jv0"),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3");function $dc6d4b1d8d494091$export$f565b71ad023b7df(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:if(!("storage"in navigator&&"persist"in navigator.storage))return[3,2];return[4,navigator.storage.persist()];case 1:e.sent(),e.label=2;case 2:return[2]}})})()}var $eIcQa=parcelRequire("eIcQa"),$0e681e75eb3cab30$export$9c72cf485ef46673=function(){"use strict";function e(t){var i,n,r=this;((0,$cx0mh._)(this,e),this.previewEl={},this.ageEl={},this.emptyEl={},this.storeButtonEl={},this.clearButtonEl={},this.storeListener={},this.isFirst=!0,this.updateAgeInterval=setInterval(function(){return r.updateAge()},6e4),this.projectStore=t.projectStore,this.getProject=t.getProject,this.onStored=t.onStored,this.klRootEl=t.klRootEl,this.applyUncommitted=t.applyUncommitted,this.options=t.options,this.onOpen=t.onOpen,this.rootEl=$eWjiX.BB.el({}),this.header=new $959a92a71fa952f2$export$852ebaa1b01c8b5a,this.rootEl.append(this.header.getElement()),this.contentEl=$eWjiX.BB.el({parent:this.rootEl}),this.projectStore.getIsAvailable())?(this.previewEl=$eWjiX.BB.el({className:"kl-storage-preview",onClick:function(){var e,t;return null==(e=(t=r).onOpen)?void 0:e.call(t)},title:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open"),noRef:!0}),this.emptyEl=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-empty")}),this.ageEl=$eWjiX.BB.el({css:{position:"absolute",right:"0",bottom:"0",width:"100%",textAlign:"center",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"13px"}}),this.onOpen&&(this.openButtonEl=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open"),css:{margin:"0"},onClick:function(){var e,t;return null==(e=(t=r).onOpen)?void 0:e.call(t)},noRef:!0})),this.storeButtonEl=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-store"),css:{margin:"0"},onClick:function(){return r.store()},noRef:!0}),this.clearButtonEl=$eWjiX.BB.el({tagName:"button",className:"grid-button kl-button-delete",content:'<img src="'+$parcel$interopDefault($720ba2c010612610$exports)+'" height="20"/> '+$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-clear"),css:{margin:"0"},onClick:function(){return r.clear()},noRef:!0}),(null==(i=this.options)?void 0:i.isFocusable)||(this.openButtonEl&&(0,$72Jv0.makeUnfocusable)(this.openButtonEl),(0,$72Jv0.makeUnfocusable)(this.storeButtonEl),(0,$72Jv0.makeUnfocusable)(this.clearButtonEl)),(null==(n=this.options)?void 0:n.hideClearButton)&&(this.clearButtonEl.style.visibility="hidden"),this.contentEl.append($eWjiX.BB.el({content:[$eWjiX.BB.el({content:this.previewEl,css:{alignSelf:"stretch",flexGrow:"1"}}),$eWjiX.BB.el({content:[this.openButtonEl,this.storeButtonEl,this.clearButtonEl],css:{display:"flex",gap:"10px",flexDirection:"column"}})],css:{marginTop:"10px",display:"flex",gap:"10px"}})),this.storeListener={onUpdate:function(e){r.updateThumb(null==e?void 0:e.timestamp,null==e?void 0:e.thumbnail)}},this.projectStore.subscribe(this.storeListener),this.updateThumb()):this.showError()}return(0,$7h4XF._)(e,[{key:"updateAge",value:function(){this.timestamp&&(this.ageEl.textContent=$57703debd837e772$export$1b9ca798405c9eb6(this.timestamp))}},{key:"resetButtons",value:function(){this.previewEl.classList.remove("kl-storage-preview--disabled"),this.timestamp?(this.openButtonEl&&(this.openButtonEl.disabled=!1),this.storeButtonEl.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-overwrite"),this.storeButtonEl.disabled=!1,this.clearButtonEl.disabled=!1):(this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-store"),this.storeButtonEl.disabled=!1,this.clearButtonEl.disabled=!0)}},{key:"updateThumb",value:function(e,t){this.timestamp=e,null==(i=this.thumbnail)||i.remove(),this.thumbnail=t?(0,$eIcQa.copyCanvas)(t):void 0;var i,n=this.thumbnail;if(n&&e){if(n.classList.add("kl-storage-preview__im"),this.ageEl.remove(),this.emptyEl.remove(),this.updateAge(),this.previewEl.append(n,this.ageEl),this.previewEl.style.pointerEvents=this.onOpen?"":"none","undefined"!=typeof performance&&e>performance.timeOrigin){var r=$eWjiX.BB.el({parent:this.previewEl,className:$f36d91ca9b37c82f$export$b5381822af66064b});setTimeout(function(){r.remove()},500)}}else this.ageEl.remove(),this.previewEl.append(this.emptyEl),this.previewEl.style.pointerEvents="none";this.resetButtons()}},{key:"store",value:function(){return(0,$1LaJZ._)(function(){var e,t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:if(e=this.projectStore.getCurrentMeta(),t=this.getProject(),!(e&&e.projectId!==t.projectId))return[3,2];return[4,new Promise(function(e,t){$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-overwrite-confirm"),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-overwrite"),"Cancel"],callback:function(t){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return"Cancel"===t?e(!1):e(!0),[2]})})()}})})];case 1:if(!n.sent())return[2];n.label=2;case 2:return this.applyUncommitted(),[4,$dc6d4b1d8d494091$export$f565b71ad023b7df()];case 3:return n.sent(),this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-storing"),this.storeButtonEl.disabled=!0,this.clearButtonEl.disabled=!0,this.previewEl.classList.add("kl-storage-preview--disabled"),[4,new Promise(function(e){setTimeout(function(){return e(null)},20)})];case 4:n.sent(),n.label=5;case 5:return n.trys.push([5,7,,8]),[4,this.projectStore.store(t)];case 6:return n.sent(),this.onStored(),[3,8];case 7:return i=n.sent(),this.resetButtons(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:`${$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed-1")}<ul><li>${$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed-2")}</li><li>${$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed-3")}</li><li>${$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed-4")}</li></ul>`,buttons:["Ok"]}),setTimeout(function(){throw Error("storage-ui: failed to store browser storage, "+i)},0),[3,8];case 8:return[2]}})}).call(this)}},{key:"clear",value:function(){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(t){return e=this,$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-clear-prompt"),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-clear"),"Cancel"],deleteButtonName:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-clear"),callback:function(t){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:if("Cancel"===t)return[2];this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.disabled=!0,this.clearButtonEl.disabled=!0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.projectStore.clear()];case 2:return i.sent(),[3,4];case 3:return e=i.sent(),this.resetButtons(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed-clear"),buttons:["Ok"]}),setTimeout(function(){throw Error("storage-ui: failed to clear browser storage, "+e)},0),[3,4];case 4:return[2]}})}).call(e)}}),[2]})}).call(this)}},{key:"showError",value:function(){this.contentEl.innerHTML="",$eWjiX.BB.el({parent:this.contentEl,content:" "+$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-cant-access"),css:{marginTop:"10px"}})}},{key:"getElement",value:function(){return this.rootEl}},{key:"show",value:function(){var e=this;this.isFirst&&(this.isFirst=!1,this.projectStore.getIsAvailable()?function(){(0,$1LaJZ._)(function(){var e,t;return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.projectStore.update()];case 1:return i.sent(),(e=this.projectStore.getCurrentMeta())?this.updateThumb(e.timestamp,e.thumbnail):this.updateThumb(),[3,3];case 2:throw t=i.sent(),this.showError(),Error("browser-storage-ui: failed initial read browser storage, "+t);case 3:return[2]}})}).call(e)}():this.showError())}},{key:"hide",value:function(){}},{key:"destroy",value:function(){this.header.destroy(),$eWjiX.BB.destroyEl(this.storeButtonEl),$eWjiX.BB.destroyEl(this.clearButtonEl),clearInterval(this.updateAgeInterval),this.projectStore.unsubscribe(this.storeListener)}}]),e}(),$6mTnI=parcelRequire("6mTnI"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$f596c98d53b60fa1$exports={};$f596c98d53b60fa1$exports=$parcel$resolve("2oHM2");var $6l0gQ=parcelRequire("6l0gQ"),$eWjiX=parcelRequire("eWjiX"),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$6otAp=parcelRequire("6otAp"),$eIcQa=parcelRequire("eIcQa");$e87f92103dc0908f$export$48c2d0f2f545ac27="-c3MRW_preview";var $7jh4K=parcelRequire("7jh4K"),$ac1dc556c612a3be$export$feb3da9ac0115d49=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.recoveryListener=function(e,t){i.update(e,t)},this.klRecoveryManager=t.klRecoveryManager,this.rootEl=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("loading")}),this.klRecoveryManager.subscribe(this.recoveryListener),setTimeout(function(){return(0,$1LaJZ._)(function(){var e;return(0,$2gUX3.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.klRecoveryManager.update()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),setTimeout(function(){throw e}),this.rootEl.innerHTML="error",[3,3];case 3:return[2]}})}).call(i)})}return(0,$7h4XF._)(e,[{key:"update",value:function(e,t){return(0,$1LaJZ._)(function(){var i,n;return(0,$2gUX3.__generator)(this,function(r){return i=this,n=[],e.sort(function(e,t){return e.timestamp>t.timestamp?-1:+(e.timestamp<t.timestamp)}).forEach(function(e){var t=$eWjiX.BB.el({tagName:"a",className:"kl-button kl-button-link",content:$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-recover"),custom:{href:"#"+e.id,target:"_blank"}}),r=$eWjiX.BB.el({tagName:"button",className:"kl-button-delete",content:`<img src="${$parcel$interopDefault($720ba2c010612610$exports)}" height="20"/>${$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-delete")}`,onClick:function(){r.blur();var t=(0,$eIcQa.copyCanvas)(e.thumbnail);(0,$7jh4K.css)(t,{alignSelf:"start",background:"var(--kl-checkerboard-background)",maxWidth:"100%"}),$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-delete-confirmation"),t],css:{display:"flex",flexDirection:"column",gap:"10px"}}),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-delete"),"Cancel"],deleteButtonName:$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-delete"),callback:function(t){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){switch(i.label){case 0:if("Cancel"===t)return[2];return[4,this.klRecoveryManager.remove(+e.id)];case 1:return i.sent(),[2]}})}).call(i)}})},noRef:!0}),a=e.thumbnail,s=$eWjiX.BB.el({tagName:"a",content:a,className:$e87f92103dc0908f$export$48c2d0f2f545ac27,title:$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-recover"),css:{minHeight:$6otAp.RECOVERY_THUMB_HEIGHT_PX+"px"},custom:{href:"#"+e.id,target:"_blank"}}),o=$eWjiX.BB.el({content:[$57703debd837e772$export$1b9ca798405c9eb6(e.timestamp),", "+$eWjiX.BB.round(e.memoryEstimateBytes/1e6,1)+" MB"],css:{textAlign:"center"}});n.push($eWjiX.BB.el({content:[s,o,t,r],css:{display:"flex",flexDirection:"column",gap:"5px",maxWidth:"100%"}}))}),this.rootEl.innerHTML="",$6otAp.DEBUG_RETURN_ALL_RECOVERIES&&this.rootEl.append($eWjiX.BB.el({content:"Debug On - SHOWING ALL TABS",css:{background:"red"}})),this.rootEl.append($eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-explanation"),className:"kl-toolspace-note"}),$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-total-quota-label")+" "+$eWjiX.BB.round(t/1e6,1)+" MB / "+$eWjiX.BB.round($6otAp.RECOVERY_MEMORY_LIMIT_BYTES/1e6,1)+" MB",css:{margin:"10px 0"}}),$eWjiX.BB.el({content:(0,$bX4ja._)(n),css:{display:"flex",flexWrap:"wrap",gap:"20px 10px",justifyContent:"space-evenly"}})),0===n.length&&this.rootEl.append($8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-empty")),[2]})}).call(this)}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.klRecoveryManager.unsubscribe(this.recoveryListener)}}]),e}(),$jTg9g=parcelRequire("jTg9g");function $890b23f3a39679d3$export$abc0e2c9b0afece1(e){if(!e||!$jTg9g.KL_INDEXED_DB.getIsAvailable())return void $9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:document.body,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-cant-access"),buttons:["Ok"]});var t=new $ac1dc556c612a3be$export$feb3da9ac0115d49({klRecoveryManager:e}),i=$eWjiX.BB.el({content:[t.getElement()]}),n=function(e){t.destroy()};$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-recover-tabs")}</b>`,div:i,buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("modal-close")],callback:n,style:{width:"calc(100% - 50px)",maxWidth:"1000px",minWidth:"300px",boxSizing:"border-box"},clickOnEnter:"Ok"})}$34d04701a8a02997$export$bd7a7a9fa7e7f04b="Tt6aiG_recoveryBubble";var $7jh4K=parcelRequire("7jh4K"),$775b09ee76e7cc3e$var$LS_SHOW_SAVE_DIALOG="kl-save-dialog",$775b09ee76e7cc3e$var$createSpacer=function(){var e=document.createElement("div"),t=document.createElement("div"),i=$eWjiX.BB.el({className:"grid-hr"});return e.append(t,i),(0,$7jh4K.css)(t,{clear:"both"}),e},$775b09ee76e7cc3e$var$createButtonContent=function(e,t,i){return`<img ${i?'class="dark-no-invert"':""} src='${t}' alt='icon' height='20'/>${e}`},$775b09ee76e7cc3e$export$409b892ffe02580b=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.recoveryListener=function(e){if(i.recoveryCountBubble){var t=e.length;0===t?i.recoveryCountBubble.style.display="none":(i.recoveryCountBubble.textContent=""+t,i.recoveryCountBubble.style.display="inline-block")}},this.exportType=t.exportType,this.applyUncommitted=t.applyUncommitted,this.rootEl=document.createElement("div"),setTimeout(function(){var e,n,r=$eWjiX.BB.el({className:"kl-toolspace-note",textContent:$8d7403abedf7cefa$export$ce37e184d908d785("file-no-autosave"),css:{margin:"10px 10px 0 10px"}}),a=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$775b09ee76e7cc3e$var$createButtonContent($8d7403abedf7cefa$export$ce37e184d908d785("file-new"),$parcel$interopDefault($74ce9fe92d58e953$exports),!0),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:function(){return t.onNewImage()}}),s=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$775b09ee76e7cc3e$var$createButtonContent($8d7403abedf7cefa$export$ce37e184d908d785("file-import"),$parcel$interopDefault($ea09e4c322d05e2e$exports),!0),css:{position:"relative",cursor:"pointer",cssFloat:"left"},custom:{tabIndex:"-1"},onClick:function(){return i.importInput.click()}});i.importInput=$eWjiX.BB.el({tagName:"input",css:{display:"none"},onChange:function(){i.applyUncommitted(),i.importInput.files&&t.onFileSelect(i.importInput.files,"default"),i.importInput.value=""},custom:{tabIndex:"-1"}}),i.importInput.type="file",i.importInput.multiple=!0,i.importInput.accept="image/*,.psd";var o=$eWjiX.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:$775b09ee76e7cc3e$var$createButtonContent($8d7403abedf7cefa$export$ce37e184d908d785("file-save"),$parcel$interopDefault($7ba84df17a4098f2$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left",flex:"1 0 0",margin:"0"},onClick:function(){return t.onSaveImageToComputer()}}),l="showSaveFilePicker"in window,h=$6l0gQ.LocalStorage.getItem($775b09ee76e7cc3e$var$LS_SHOW_SAVE_DIALOG),c=null!==h&&"true"===h,u=new $365a915dfb503274$export$48513f6b9f8ce62d({init:c,label:$8d7403abedf7cefa$export$ce37e184d908d785("file-show-save-dialog"),callback:function(e){e?$6l0gQ.LocalStorage.setItem($775b09ee76e7cc3e$var$LS_SHOW_SAVE_DIALOG,"true"):$6l0gQ.LocalStorage.removeItem($775b09ee76e7cc3e$var$LS_SHOW_SAVE_DIALOG),t.onChangeShowSaveDialog(e)},css:{maxWidth:"fit-content"},name:"show-save-dialog"});t.onChangeShowSaveDialog(c);var d=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.Select({optionArr:[["png","PNG"],["psd","PSD"],["layers",$8d7403abedf7cefa$export$ce37e184d908d785("layers")+" (PNG)"]],initValue:i.exportType,onChange:function(e){i.exportType=e,t.onExportTypeChange(i.exportType),t.onSaveImageToComputer()},title:$8d7403abedf7cefa$export$ce37e184d908d785("file-format"),name:"export-type"});if((0,$7jh4K.css)(d.getElement(),{height:"30px",width:"calc(50% - 10px)",flex:"1 0 0"}),t.projectStore)i.browserStorageUi=new $0e681e75eb3cab30$export$9c72cf485ef46673({projectStore:t.projectStore,getProject:t.getProject,klRootEl:t.klRootEl,applyUncommitted:i.applyUncommitted,onOpen:t.onOpenBrowserStorage,onStored:function(){return t.onStoredToBrowserStorage()}}),(0,$7jh4K.css)(i.browserStorageUi.getElement(),{margin:"10px"});else{var p=new $959a92a71fa952f2$export$852ebaa1b01c8b5a;n=$eWjiX.BB.el({content:[p.getElement(),$eWjiX.BB.el({content:" "+$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-cant-access"),css:{marginTop:"10px"}})],css:{margin:"10px 10px 0 10px"}})}var f=$eWjiX.BB.el({content:[$eWjiX.BB.el({content:[o,d.getElement()],css:{display:"flex",gap:"10px"}})].concat((0,$bX4ja._)(l?[u.getElement()]:[])),css:{display:"flex",flexDirection:"column",gap:"10px",margin:"10px 10px 0 10px"}});i.klRecoveryManager=t.klRecoveryManager;var g=$eWjiX.BB.el({});i.recoveryCountBubble=$eWjiX.BB.el({className:$34d04701a8a02997$export$bd7a7a9fa7e7f04b});var v=$eWjiX.BB.el({tagName:"button",content:[$8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-recover-tabs"),i.recoveryCountBubble],onClick:function(){return $890b23f3a39679d3$export$abc0e2c9b0afece1(i.klRecoveryManager)},custom:{tabIndex:"-1"},css:{margin:"10px 0 0 10px",width:"calc(100% - 20px)"}});g.append(v,$775b09ee76e7cc3e$var$createSpacer()),function(){(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:if(!this.klRecoveryManager)return[2];return this.klRecoveryManager.subscribe(this.recoveryListener),[4,this.klRecoveryManager.update()];case 1:return e.sent(),this.klRecoveryManager.unsubscribe(this.recoveryListener),[2]}})}).call(i)}();var m=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$775b09ee76e7cc3e$var$createButtonContent($8d7403abedf7cefa$export$ce37e184d908d785("file-share"),$parcel$interopDefault($680b545dae725a15$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:function(){m.disabled=!0,t.onShareImage(function(){m.disabled=!1})}}),y=$eWjiX.BB.el({tagName:"button",className:"grid-button",content:$775b09ee76e7cc3e$var$createButtonContent($8d7403abedf7cefa$export$ce37e184d908d785("file-upload"),$parcel$interopDefault($f596c98d53b60fa1$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:function(){t.onUpload()}});$eWjiX.BB.append(i.rootEl,[r,a,s,$eWjiX.BB.el({css:{clear:"both"}}),f,$775b09ee76e7cc3e$var$createSpacer(),null==(e=i.browserStorageUi)?void 0:e.getElement(),n,$775b09ee76e7cc3e$var$createSpacer(),g,y,$eWjiX.BB.canShareFiles()?m:void 0,$eWjiX.BB.el({css:{clear:"both"}})])},1)}return(0,$7h4XF._)(e,[{key:"refresh",value:function(){}},{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){if(e){var t;this.refresh(),null==(t=this.browserStorageUi)||t.show(),this.klRecoveryManager&&(this.klRecoveryManager.subscribe(this.recoveryListener),this.klRecoveryManager.update())}else this.klRecoveryManager&&this.klRecoveryManager.unsubscribe(this.recoveryListener)}},{key:"triggerImport",value:function(){this.importInput&&this.importInput.click()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$8N5YG=parcelRequire("8N5YG"),$eWjiX=parcelRequire("eWjiX"),$eWjiX=parcelRequire("eWjiX");function $8501a2e1e79821a9$export$d731e22ecd0c25d3(e,t,i,n){(i||this._.texture).use(),this._.spareTexture.drawTo(function(){e.uniforms(t).drawRect()}),this._.spareTexture.swapWith(n||this._.texture)}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$8N5YG=parcelRequire("8N5YG");function $deb6b884ba4ae312$export$b59c6427db8463f4(e){$deb6b884ba4ae312$export$5822a9d0880a5d82=e}var $eWjiX=parcelRequire("eWjiX"),$e0143068cd462268$var$defaultVertexSource="    attribute vec2 vertex;    attribute vec2 _texCoord;    varying vec2 texCoord;    void main() {        texCoord = _texCoord;        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);    }",$e0143068cd462268$var$defaultFragmentSource="    uniform sampler2D texture;    varying vec2 texCoord;    void main() {        gl_FragColor = texture2D(texture, texCoord);    }";function $e0143068cd462268$var$isArray(e){return"[object Array]"==Object.prototype.toString.call(e)}function $e0143068cd462268$var$isNumber(e){return"[object Number]"==Object.prototype.toString.call(e)}var $e0143068cd462268$export$7d9b0d118d0c4108=function(){"use strict";function e(t,i,n){if((0,$cx0mh._)(this,e),this.vertexAttribute=null,this.texCoordAttribute=null,this.program=$eWjiX.BB.throwIfNull($deb6b884ba4ae312$export$5822a9d0880a5d82.createProgram()),t=t||$e0143068cd462268$var$defaultVertexSource,i=i||$e0143068cd462268$var$defaultFragmentSource,$e0143068cd462268$var$floatPrecision||($e0143068cd462268$var$floatPrecision=this.testPrecisionSupport($deb6b884ba4ae312$export$5822a9d0880a5d82.HIGH_FLOAT)?"highp":this.testPrecisionSupport($deb6b884ba4ae312$export$5822a9d0880a5d82.MEDIUM_FLOAT)?"mediump":"lowp"),i="precision "+$e0143068cd462268$var$floatPrecision+" float;"+i,$deb6b884ba4ae312$export$5822a9d0880a5d82.attachShader(this.program,this.compileSource($deb6b884ba4ae312$export$5822a9d0880a5d82.VERTEX_SHADER,t,n+"(vertex)")),$deb6b884ba4ae312$export$5822a9d0880a5d82.attachShader(this.program,this.compileSource($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAGMENT_SHADER,i,n+"(fragment)")),$deb6b884ba4ae312$export$5822a9d0880a5d82.linkProgram(this.program),!$deb6b884ba4ae312$export$5822a9d0880a5d82.getProgramParameter(this.program,$deb6b884ba4ae312$export$5822a9d0880a5d82.LINK_STATUS))throw"link error: "+$deb6b884ba4ae312$export$5822a9d0880a5d82.getProgramInfoLog(this.program)}return(0,$7h4XF._)(e,[{key:"compileSource",value:function(e,t,i){var n=$eWjiX.BB.throwIfNull($deb6b884ba4ae312$export$5822a9d0880a5d82.createShader(e));if($deb6b884ba4ae312$export$5822a9d0880a5d82.shaderSource(n,t.replace(/#define.*/,"")),$deb6b884ba4ae312$export$5822a9d0880a5d82.compileShader(n),!$deb6b884ba4ae312$export$5822a9d0880a5d82.getShaderParameter(n,$deb6b884ba4ae312$export$5822a9d0880a5d82.COMPILE_STATUS))throw"compile error: "+i+" - "+$deb6b884ba4ae312$export$5822a9d0880a5d82.getShaderInfoLog(n);return n}},{key:"testPrecisionSupport",value:function(e){var t=$deb6b884ba4ae312$export$5822a9d0880a5d82.getShaderPrecisionFormat($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAGMENT_SHADER,e);return null!==t&&0!==t.precision}},{key:"destroy",value:function(){$deb6b884ba4ae312$export$5822a9d0880a5d82.deleteProgram(this.program),this.program=null}},{key:"uniforms",value:function(e){var t=this;return $deb6b884ba4ae312$export$5822a9d0880a5d82.useProgram(this.program),Object.entries(e).forEach(function(e){var i=(0,$8N5YG._)(e,2),n=i[0],r=i[1],a=$deb6b884ba4ae312$export$5822a9d0880a5d82.getUniformLocation(t.program,n);if(null!==a)if($e0143068cd462268$var$isArray(r))switch(r.length){case 1:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform1fv(a,new Float32Array(r));break;case 2:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform2fv(a,new Float32Array(r));break;case 3:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform3fv(a,new Float32Array(r));break;case 4:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform4fv(a,new Float32Array(r));break;case 9:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniformMatrix3fv(a,!1,new Float32Array(r));break;case 16:$deb6b884ba4ae312$export$5822a9d0880a5d82.uniformMatrix4fv(a,!1,new Float32Array(r));break;default:throw"dont't know how to load uniform \""+n+'" of length '+r.length}else if($e0143068cd462268$var$isNumber(r))$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform1f(a,r);else throw'attempted to set uniform "'+n+'" to invalid value '+(r||"undefined").toString()}),this}},{key:"textures",value:function(e){var t=this;return $deb6b884ba4ae312$export$5822a9d0880a5d82.useProgram(this.program),Object.entries(e).forEach(function(e){var i=(0,$8N5YG._)(e,2),n=i[0],r=i[1];$deb6b884ba4ae312$export$5822a9d0880a5d82.uniform1i($deb6b884ba4ae312$export$5822a9d0880a5d82.getUniformLocation(t.program,n),r)}),this}},{key:"drawRect",value:function(e,t,i,n){var r,a=$deb6b884ba4ae312$export$5822a9d0880a5d82.getParameter($deb6b884ba4ae312$export$5822a9d0880a5d82.VIEWPORT);t=t!==r?(t-a[1])/a[3]:0,e=e!==r?(e-a[0])/a[2]:0,i=i!==r?(i-a[0])/a[2]:1,n=n!==r?(n-a[1])/a[3]:1,($deb6b884ba4ae312$export$5822a9d0880a5d82.vertexBuffer===r||null===$deb6b884ba4ae312$export$5822a9d0880a5d82.vertexBuffer)&&($deb6b884ba4ae312$export$5822a9d0880a5d82.vertexBuffer=$eWjiX.BB.throwIfNull($deb6b884ba4ae312$export$5822a9d0880a5d82.createBuffer())),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindBuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.vertexBuffer),$deb6b884ba4ae312$export$5822a9d0880a5d82.bufferData($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,new Float32Array([e,t,e,n,i,t,i,n]),$deb6b884ba4ae312$export$5822a9d0880a5d82.STATIC_DRAW),null==$deb6b884ba4ae312$export$5822a9d0880a5d82.texCoordBuffer&&($deb6b884ba4ae312$export$5822a9d0880a5d82.texCoordBuffer=$eWjiX.BB.throwIfNull($deb6b884ba4ae312$export$5822a9d0880a5d82.createBuffer()),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindBuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.texCoordBuffer),$deb6b884ba4ae312$export$5822a9d0880a5d82.bufferData($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),$deb6b884ba4ae312$export$5822a9d0880a5d82.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=$deb6b884ba4ae312$export$5822a9d0880a5d82.getAttribLocation(this.program,"vertex"),$deb6b884ba4ae312$export$5822a9d0880a5d82.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=$deb6b884ba4ae312$export$5822a9d0880a5d82.getAttribLocation(this.program,"_texCoord"),$deb6b884ba4ae312$export$5822a9d0880a5d82.enableVertexAttribArray(this.texCoordAttribute)),$deb6b884ba4ae312$export$5822a9d0880a5d82.useProgram(this.program),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindBuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.vertexBuffer),$deb6b884ba4ae312$export$5822a9d0880a5d82.vertexAttribPointer(this.vertexAttribute,2,$deb6b884ba4ae312$export$5822a9d0880a5d82.FLOAT,!1,0,0),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindBuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.ARRAY_BUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.texCoordBuffer),$deb6b884ba4ae312$export$5822a9d0880a5d82.vertexAttribPointer(this.texCoordAttribute,2,$deb6b884ba4ae312$export$5822a9d0880a5d82.FLOAT,!1,0,0),$deb6b884ba4ae312$export$5822a9d0880a5d82.drawArrays($deb6b884ba4ae312$export$5822a9d0880a5d82.TRIANGLE_STRIP,0,4)}}],[{key:"getDefaultShader",value:function(){return $deb6b884ba4ae312$export$5822a9d0880a5d82.defaultShader=$deb6b884ba4ae312$export$5822a9d0880a5d82.defaultShader||new e,$deb6b884ba4ae312$export$5822a9d0880a5d82.defaultShader}}]),e}(),$c50d7229cf0a789e$export$6408eeb1703e74b8=function(e,t){return $deb6b884ba4ae312$export$5822a9d0880a5d82.brightnessContrast=$deb6b884ba4ae312$export$5822a9d0880a5d82.brightnessContrast||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float brightness;        uniform float contrast;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb += brightness;            if (contrast > 0.0) {                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;            } else {                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;            }            gl_FragColor = clamp(color, 0.0, 1.0);        }    ","brightnessContrast"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.brightnessContrast,{brightness:$eWjiX.BB.clamp(e,-1,1),contrast:$eWjiX.BB.clamp(t,-1,1)}),this},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$80392da2a95619fd$export$7e6fd232cff50dd1=function(){"use strict";function e(t,i,n,r){(0,$cx0mh._)(this,e),this.gl=$deb6b884ba4ae312$export$5822a9d0880a5d82,this.id=$eWjiX.BB.throwIfNull($deb6b884ba4ae312$export$5822a9d0880a5d82.createTexture()),this.width=t,this.height=i,this.format=n,this.type=r,this.canvas=null,$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$deb6b884ba4ae312$export$5822a9d0880a5d82.texParameteri($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,$deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_MAG_FILTER,$deb6b884ba4ae312$export$5822a9d0880a5d82.LINEAR),$deb6b884ba4ae312$export$5822a9d0880a5d82.texParameteri($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,$deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_MIN_FILTER,$deb6b884ba4ae312$export$5822a9d0880a5d82.LINEAR),$deb6b884ba4ae312$export$5822a9d0880a5d82.texParameteri($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,$deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_WRAP_S,$deb6b884ba4ae312$export$5822a9d0880a5d82.CLAMP_TO_EDGE),$deb6b884ba4ae312$export$5822a9d0880a5d82.texParameteri($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,$deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_WRAP_T,$deb6b884ba4ae312$export$5822a9d0880a5d82.CLAMP_TO_EDGE),t&&i&&$deb6b884ba4ae312$export$5822a9d0880a5d82.texImage2D($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,t,i,0,this.format,this.type,null)}return(0,$7h4XF._)(e,[{key:"loadContentsOf",value:function(e){this.width=e.width||e.videoWidth,this.height=e.height||e.videoHeight,$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$deb6b884ba4ae312$export$5822a9d0880a5d82.texImage2D($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,this.format,this.type,e)}},{key:"initFromBytes",value:function(e,t,i){this.width=e,this.height=t,this.format=$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,this.type=$deb6b884ba4ae312$export$5822a9d0880a5d82.UNSIGNED_BYTE,$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$deb6b884ba4ae312$export$5822a9d0880a5d82.texImage2D($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,0,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,e,t,0,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,this.type,new Uint8Array(i))}},{key:"destroy",value:function(){$deb6b884ba4ae312$export$5822a9d0880a5d82.deleteTexture(this.id),this.id=null}},{key:"use",value:function(e){$deb6b884ba4ae312$export$5822a9d0880a5d82.activeTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE0+(e||0)),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id)}},{key:"unuse",value:function(e){$deb6b884ba4ae312$export$5822a9d0880a5d82.activeTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE0+(e||0)),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,null)}},{key:"ensureFormat",value:function(e,t,i,n){(e!=this.width||t!=this.height||i!=this.format||n!=this.type)&&(this.width=e,this.height=t,this.format=i,this.type=n,$deb6b884ba4ae312$export$5822a9d0880a5d82.bindTexture($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$deb6b884ba4ae312$export$5822a9d0880a5d82.texImage2D($deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,e,t,0,this.format,this.type,null))}},{key:"ensureFormatViaTexture",value:function(e){this.ensureFormat(e.width,e.height,e.format,e.type)}},{key:"drawTo",value:function(e){if($deb6b884ba4ae312$export$5822a9d0880a5d82.framebuffer=$deb6b884ba4ae312$export$5822a9d0880a5d82.framebuffer||$deb6b884ba4ae312$export$5822a9d0880a5d82.createFramebuffer(),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindFramebuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAMEBUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.framebuffer),$deb6b884ba4ae312$export$5822a9d0880a5d82.framebufferTexture2D($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAMEBUFFER,$deb6b884ba4ae312$export$5822a9d0880a5d82.COLOR_ATTACHMENT0,$deb6b884ba4ae312$export$5822a9d0880a5d82.TEXTURE_2D,this.id,0),$deb6b884ba4ae312$export$5822a9d0880a5d82.checkFramebufferStatus($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAMEBUFFER)!==$deb6b884ba4ae312$export$5822a9d0880a5d82.FRAMEBUFFER_COMPLETE)throw Error("incomplete framebuffer");$deb6b884ba4ae312$export$5822a9d0880a5d82.viewport(0,0,this.width,this.height),e(),$deb6b884ba4ae312$export$5822a9d0880a5d82.bindFramebuffer($deb6b884ba4ae312$export$5822a9d0880a5d82.FRAMEBUFFER,null)}},{key:"swapWith",value:function(e){var t;t=e.id,e.id=this.id,this.id=t,t=e.width,e.width=this.width,this.width=t,t=e.height,e.height=this.height,this.height=t,t=e.format,e.format=this.format,this.format=t}}],[{key:"fromElement",value:function(t){var i=new e(0,0,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,$deb6b884ba4ae312$export$5822a9d0880a5d82.UNSIGNED_BYTE);return i.loadContentsOf(t),i}}]),e}(),$eWjiX=parcelRequire("eWjiX");function $d747444e26286abc$export$4f237735eca1f248(e){for(var t=new $eWjiX.BB.SplineInterpolator(e),i=[],n=0;n<256;n++)i.push($eWjiX.BB.clamp(Math.floor(256*t.interpolate(n/255)),0,255));return i}var $7480e3ce85bc65db$export$6894093bf294bea5=function(e,t,i){for(var n=$d747444e26286abc$export$4f237735eca1f248(e),r=$d747444e26286abc$export$4f237735eca1f248(t),a=$d747444e26286abc$export$4f237735eca1f248(i),s=[],o=0;o<256;o++)s.splice(s.length,0,n[o],r[o],a[o],255);return this._.extraTexture.initFromBytes(256,1,s),this._.extraTexture.use(1),$deb6b884ba4ae312$export$5822a9d0880a5d82.curves=$deb6b884ba4ae312$export$5822a9d0880a5d82.curves||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform sampler2D map;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r = texture2D(map, vec2(color.r)).r;            color.g = texture2D(map, vec2(color.g)).g;            color.b = texture2D(map, vec2(color.b)).b;            gl_FragColor = color;        }    ","curves"),$deb6b884ba4ae312$export$5822a9d0880a5d82.curves.textures({map:1}),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.curves,{}),this},$eWjiX=parcelRequire("eWjiX"),$6dd7d8fac84d64b7$export$ef28bbbd731e79bf=function(e,t){return $deb6b884ba4ae312$export$5822a9d0880a5d82.hueSaturation=$deb6b884ba4ae312$export$5822a9d0880a5d82.hueSaturation||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float hue;        uniform float saturation;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */            float angle = hue * 3.14159265;            float s = sin(angle), c = cos(angle);            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;            float len = length(color.rgb);            color.rgb = vec3(                dot(color.rgb, weights.xyz),                dot(color.rgb, weights.zxy),                dot(color.rgb, weights.yzx)            );                        /* saturation adjustment */            float average = (color.r + color.g + color.b) / 3.0;            if (saturation > 0.0) {                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));            } else {                color.rgb += (average - color.rgb) * (-saturation);            }                        gl_FragColor = color;        }    ","hueSaturation"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.hueSaturation,{hue:$eWjiX.BB.clamp(e,-1,1),saturation:$eWjiX.BB.clamp(t,-1,1)}),this},$2d6d66f95a729b73$exports={};$2d6d66f95a729b73$exports="#define GLSLIFY 1\nuniform sampler2D texture;\nvarying vec2 texCoord;\nuniform vec2 texSize;\n\nuniform float seed;\nuniform float type;\nuniform vec2 scale;\nuniform vec2 offset;\nuniform float octaves;\nuniform float samples;\n\nuniform float peaks;\nuniform float contrast;\nuniform float brightness;\nuniform float isReversed;\n\nuniform vec3 colA;\nuniform vec3 colB;\n\nuniform float channels; // 0 - rgb, 1 - alpha\n\n// fbm, cellular_noise based on\n// https://github.com/Gonkee/Gonkees-Shaders\n// MIT, Copyright  Gonkee\n\n// hash & simplex based on\n// https://www.shadertoy.com/view/Msf3WH\n// MIT, Copyright  2013 Inigo Quilez\n// https://www.youtube.com/c/InigoQuilez\n// https://iquilezles.org\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat value_noise(vec2 coord){\n    return rand(floor(coord) / 100.0);\n}\n\nfloat cellular_noise(vec2 coord) {\n    vec2 i = floor(coord);\n    vec2 f = fract(coord);\n\n    float min_dist = 99999.0;\n    for (float x = -1.0; x <= 1.0; x++) {\n        for (float y = -1.0; y <= 1.0; y++) {\n            vec2 node = rand(i + vec2(x, y)) + vec2(x, y);\n            float dist = sqrt((f - node).x * (f - node).x + (f - node).y * (f - node).y);\n            min_dist = min(min_dist, dist);\n        }\n    }\n    return min_dist;\n}\n\n// ---------- Simplex Alternative ---------------------\n\nvec3 hash(vec3 p)\n{ p=vec3(dot(p, vec3(127.1, 311.7, 74.7))\n, dot(p, vec3(269.5, 183.3, 246.1))\n, dot(p, vec3(113.5, 271.9, 124.6)))\n;return fract(sin(p)*43758.5453123)*2.-1.; }\n\nmat3 hash(mat3 p)\n{ return mat3(hash(p[0]), hash(p[1]), hash(p[2])); }\n\nvec3 dots(mat3 a, vec3 w, mat3 b){ return vec3\n(dot(a[0], w-b[0]), dot(a[1], w-b[1]), dot(a[2], w-b[2])); }\n\n//return noiseGra13dx as .x, and its derivatives as .yzw\n// https://www.shadertoy.com/view/llByD1\nvec3 noiseGra13dx(in vec3 x) {\n    vec3 p=floor(x), w=fract(x)\n    #if 1\n    , u=w*w*w*(w*(w*6.-15.)+10.), v=30.*w*w*(w*(w-2.)+1.)//quintic hermite\n    #else\n    , u=w*w*(3.-2.*w), v=6.*w*(1.-w)//cubic hermite\n    #endif\n    //gradients\n    , G=hash(p+vec3(0)), F=hash(p+vec3(1))\n    ;mat3 D=hash(mat3(p, p, p)+mat3(1)), E=hash(mat3(p, p, p)+1.-mat3(1));\n    //projections\n    vec3 d=dots(D, w, mat3(1)), e=dots(E, w, 1.-mat3(1));\n    //interpolations\n    float g=dot(G, w), f=dot(F, w-vec3(1));\n    vec3 h=u.yzx*(g-d.xyx-d.yzz+e.zxy)+d-g, U=u*h, a=d-e;\n    mat3 S=D-mat3(G, G, G), W=D-E;\n    a.x=(a.x+a.y+a.z)+f-g;\n    ;float b=u.x*u.y*u.z;\n\n    vec4 result = vec4(g+U.x+U.y+U.z+a.x*b// value\n    , G*(1.-b)+b*(W[0]+W[1]+W[2]+F)//https://www.shadertoy.com/view/llByD1\n    +u.x*(S[0]+u.y*(G-D[0]-D[1]+E[2]))// derivatives\n    +u.y*(S[1]+u.z*(G-D[1]-D[2]+E[0]))\n    +u.z*(S[2]+u.x*(G-D[0]-D[2]+E[1]))\n    +v*(u.zxy*(g-d.xxy-d.zyz+e.yzx)+h+u.yzx*u.zxy*a.x));\n    return 0.5 + 0.5 * result.xxx;\n}\n\nfloat fbm(vec2 coord) {\n    float normalize_factor = 0.0;\n    float value = 0.0;\n    float scale = 0.5;\n\n    for (float i = 0.0; i < 7.0; i++){\n        if (i < octaves) {\n            if (type == 0.0) {\n                value += value_noise(coord) * scale;\n            } else if (type == 1.0) {\n                value += noiseGra13dx(vec3(coord.x, coord.y, 0.0)).r * scale;\n            } else if (type == 2.0) {\n                value += cellular_noise(coord) * scale;\n            }\n            normalize_factor += scale;\n            coord *= 2.0;\n            scale *= 0.5;\n        }\n    }\n    return value / normalize_factor;\n}\n\nfloat render (vec2 pos) {\n    float result = fbm(pos);\n    //\n\n    if (peaks > 0.0) {\n        result = abs(mod(result * peaks - 0.5, 1.0) - 0.5) * 2.0;// triangle\n        //result = mod(result * (peaks + 1.0), 1.0); // sawtooth\n    }\n\n    result += brightness;\n    if (contrast > 0.0) {\n        result = clamp((result - 0.5) / (1.0 - contrast) + 0.5, 0.0, 1.0);\n    } else if (contrast < 0.0) {\n        result = clamp((result - 0.5) * (1.0 + contrast) + 0.5, 0.0, 1.0);\n    }\n\n    if (isReversed == 1.0) {\n        result = 1.0 - result;\n    }\n    return result;\n}\n\nvoid main() {\n    vec4 color;\n\n    vec2 seedOffset;\n    seedOffset.x = (rand(vec2(seed, 0.0)) * 100.0 - 50.0);\n    seedOffset.y = (rand(vec2(0.0, seed)) * 100.0 - 50.0);\n\n    float val = 0.0;\n    vec2 basePos = texCoord * texSize / scale - offset / scale + seedOffset;\n\n    if (samples == 1.0) {\n        val = render(basePos);\n\n    }/* else if (samples == 4.0) {\n        for (float i = 0.0; i < 2.0; i++) {\n            for (float e = 0.0; e < 2.0; e++) {\n                val += render(basePos + (vec2(i, e) - 0.5) * 0.5 / scale);\n            }\n        }\n        val /= 4.0;\n\n    }*/ else if (samples == 16.0) {\n        for (float i = 0.0; i < 4.0; i++) {\n            for (float e = 0.0; e < 4.0; e++) {\n                val += render(basePos + (vec2(i, e) - 0.25) * 0.25 / scale);\n            }\n        }\n        val /= 16.0;\n    }\n\n    if (channels == 0.0) {\n        gl_FragColor = vec4(vec3(mix(colA, colB, val)), 1.0);\n    } else {\n        gl_FragColor = vec4(vec3(1.0), val);\n    }\n}";var $dd5d88e299e80db3$export$d3022aad56692482=function(e,t,i,n,r,a,s,o,l,h,c,u,d){return $deb6b884ba4ae312$export$5822a9d0880a5d82.noise=$deb6b884ba4ae312$export$5822a9d0880a5d82.noise||new $e0143068cd462268$export$7d9b0d118d0c4108(null,$parcel$interopDefault($2d6d66f95a729b73$exports).replace(/#define.*/,""),"noise"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.noise,{seed:e||0,type:t,scale:[i[0],i[1]],offset:n,octaves:r,samples:a,texSize:[this.width,this.height],peaks:s,brightness:o,contrast:l,isReversed:+!!h,colA:c?[c.r/255,c.g/255,c.b/255]:[0,0,0],colB:u?[u.r/255,u.g/255,u.b/255]:[1,1,1],channels:+("rgb"!==d)}),this},$904e6ba1142f7a16$export$af69f7ca07da04c9="    float random(vec3 scale, float seed) {        /* use the fragment position for a different seed per-pixel */        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);    }",$b01b186720ebdc8e$export$6e852234f1597a14=function(e){return $deb6b884ba4ae312$export$5822a9d0880a5d82.triangleBlur=$deb6b884ba4ae312$export$5822a9d0880a5d82.triangleBlur||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+$904e6ba1142f7a16$export$af69f7ca07da04c9+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta * percent);                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;        }    ","triangleBlur"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.triangleBlur,{delta:[e/this.width,0]}),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.triangleBlur,{delta:[0,e/this.height]}),this},$1ec92859a97056c3$export$4545acb2b6bb8f22=function(e,t,i,n,r,a){$deb6b884ba4ae312$export$5822a9d0880a5d82.tiltShift=$deb6b884ba4ae312$export$5822a9d0880a5d82.tiltShift||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float blurRadius;        uniform float gradientRadius;        uniform vec2 start;        uniform vec2 end;        uniform vec2 delta;        uniform vec2 texSize;        varying vec2 texCoord;        "+$904e6ba1142f7a16$export$af69f7ca07da04c9+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;            for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;        }    ","tiltShift");var s=i-e,o=n-t,l=Math.sqrt(s*s+o*o);return $8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.tiltShift,{blurRadius:r,gradientRadius:a,start:[e,t],end:[i,n],delta:[s/l,o/l],texSize:[this.width,this.height]}),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.tiltShift,{blurRadius:r,gradientRadius:a,start:[e,t],end:[i,n],delta:[-o/l,s/l],texSize:[this.width,this.height]}),this};function $1d7339974b05a229$export$820b3a44cb7b2b21(e,t){return new $e0143068cd462268$export$7d9b0d118d0c4108(null,e+"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;    void main() {        vec2 coord = texCoord * texSize;        "+t+"        gl_FragColor = texture2D(texture, coord / texSize);        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);        if (coord != clampedCoord) {            /* fade to transparent if we are outside the image */            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));        }    }","warp")}function $303d8d4ec53c4881$export$1c447127d27d7be4(e,t,i,n,r,a,s,o){var l=i-r,h=n-a,c=s-r,u=o-a,d=e-i+r-s,p=t-n+a-o,f=l*u-c*h,g=(d*u-c*p)/f,v=(l*p-d*h)/f;return[i-e+g*i,n-t+g*n,g,s-e+v*s,o-t+v*o,v,e,t,1]}function $303d8d4ec53c4881$export$68b3343017e80691(e){var t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],h=e[8],c=t*a*h-t*s*l-i*r*h+i*s*o+n*r*l-n*a*o;return[(a*h-s*l)/c,(n*l-i*h)/c,(i*s-n*a)/c,(s*o-r*h)/c,(t*h-n*o)/c,(n*r-t*s)/c,(r*l-a*o)/c,(i*o-t*l)/c,(t*a-i*r)/c]}function $303d8d4ec53c4881$export$2060d2db72cce88f(e,t){return[e[0]*t[0]+e[1]*t[3]+e[2]*t[6],e[0]*t[1]+e[1]*t[4]+e[2]*t[7],e[0]*t[2]+e[1]*t[5]+e[2]*t[8],e[3]*t[0]+e[4]*t[3]+e[5]*t[6],e[3]*t[1]+e[4]*t[4]+e[5]*t[7],e[3]*t[2]+e[4]*t[5]+e[5]*t[8],e[6]*t[0]+e[7]*t[3]+e[8]*t[6],e[6]*t[1]+e[7]*t[4]+e[8]*t[7],e[6]*t[2]+e[7]*t[5]+e[8]*t[8]]}var $5b33fb39bf5722a9$export$a93b0222aeadc54b=function(e,t,i){if($deb6b884ba4ae312$export$5822a9d0880a5d82.matrixWarp=$deb6b884ba4ae312$export$5822a9d0880a5d82.matrixWarp||$1d7339974b05a229$export$820b3a44cb7b2b21("        uniform mat3 matrix;        uniform bool useTextureSpace;    ","        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;        vec3 warp = matrix * vec3(coord, 1.0);        coord = warp.xy / warp.z;        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;    "),4==(e=e.flat()).length)e=[e[0],e[1],0,e[2],e[3],0,0,0,1];else if(9!=e.length)throw"can only warp with 2x2 or 3x3 matrix";return $8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.matrixWarp,{matrix:t?$303d8d4ec53c4881$export$68b3343017e80691(e):e,texSize:[this.width,this.height],useTextureSpace:+!!i}),this},$c6e0992c38eb55ab$export$915fb7313c578ba2=function(e,t){return $deb6b884ba4ae312$export$5822a9d0880a5d82.unsharpMask=$deb6b884ba4ae312$export$5822a9d0880a5d82.unsharpMask||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"        uniform sampler2D blurredTexture;        uniform sampler2D originalTexture;        uniform float strength;        uniform float threshold;        varying vec2 texCoord;        void main() {            vec4 blurred = texture2D(blurredTexture, texCoord);            vec4 original = texture2D(originalTexture, texCoord);            gl_FragColor = mix(blurred, original, 1.0 + strength);        }    ","unsharpMask"),this._.extraTexture.ensureFormatViaTexture(this._.texture),this._.texture.use(),this._.extraTexture.drawTo(function(){$e0143068cd462268$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),this._.extraTexture.use(1),this.triangleBlur(e),$deb6b884ba4ae312$export$5822a9d0880a5d82.unsharpMask.textures({originalTexture:1}),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.unsharpMask,{strength:t}),this._.extraTexture.unuse(1),this},$164716f3bce9dcdb$export$be1ee5ea42904fdc=function(e,t){return $deb6b884ba4ae312$export$5822a9d0880a5d82.toAlpha=$deb6b884ba4ae312$export$5822a9d0880a5d82.toAlpha||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"    uniform bool isInverted;    uniform vec4 replace;    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        float alpha = (color.r + color.g + color.b) / 3.0;        if (isInverted) alpha = 1.0 - alpha;        alpha = min(color.a, alpha);        if (replace.a > 0.0) color = replace;        gl_FragColor = vec4(color.r, color.g, color.b, alpha);    }","toAlpha"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.toAlpha,{isInverted:+!!e,replace:t?[t.r/255,t.g/255,t.b/255,t.a]:[0,0,0,0],texSize:[this.width,this.height]}),this},$6fb892cfa80f1621$export$6897c284b6f9f4dc=function(){return $deb6b884ba4ae312$export$5822a9d0880a5d82.invert=$deb6b884ba4ae312$export$5822a9d0880a5d82.invert||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        color.rgb = 1.0 - color.rgb;        gl_FragColor = color;    }","invert"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.invert,{texSize:[this.width,this.height]}),this},$bX4ja=parcelRequire("bX4ja"),$4d16a2f492bd5d16$export$541149539f3a4684=function(e,t){var i=$303d8d4ec53c4881$export$1c447127d27d7be4.apply(void 0,(0,$bX4ja._)(t)),n=$303d8d4ec53c4881$export$1c447127d27d7be4.apply(void 0,(0,$bX4ja._)(e)),r=$303d8d4ec53c4881$export$2060d2db72cce88f($303d8d4ec53c4881$export$68b3343017e80691(i),n);return this.matrixWarp(r)},$34a2490457ff8aab$export$b324c80262feb891=function(){return $deb6b884ba4ae312$export$5822a9d0880a5d82.unmultiplyAlpha=$deb6b884ba4ae312$export$5822a9d0880a5d82.unmultiplyAlpha||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        if(color.a > 0.0) {            color.rgb /= color.a;        }        gl_FragColor = color;    }","unmultiplyAlpha"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.unmultiplyAlpha,{texSize:[this.width,this.height]}),this},$55618926ab99fefa$export$7c9b924528782480=function(e){return $deb6b884ba4ae312$export$5822a9d0880a5d82.distort=$deb6b884ba4ae312$export$5822a9d0880a5d82.distort||$1d7339974b05a229$export$820b3a44cb7b2b21(`
    uniform float stepSize;
    uniform vec2 scale;
    uniform vec2 strength;
    uniform vec2 phase;
    uniform float type;
    uniform vec2 offset;
`,`
    const float PI = 3.14159265;
    float x = coord.x + offset.x;
    float y = coord.y + offset.y;
    if (stepSize > 1.0) {
        x = floor(x / stepSize) * stepSize;
        y = floor(y / stepSize) * stepSize;
    }
    float distortX = sin((x/scale.x + phase.x) * PI * 2.0) * strength.x;
    float distortY = sin((y/scale.y + phase.y) * PI * 2.0) * strength.y;
    if (type == 0.0) {
        coord.y += distortX;
        coord.x += distortY;
    } else if (type == 1.0) {
        coord.x += distortX;
        coord.y += distortY;
    } else if (type == 2.0) {
        x -= offset.x;
        y -= offset.y;
        gl_FragColor = texture2D(texture, vec2(x, y) / texSize);
        coord.y += sin(gl_FragColor.r/scale.x*200.0 + phase.x * PI * 2.0) * strength.x;
        coord.x += cos(gl_FragColor.g/scale.y*200.0 + phase.y * PI * 2.0) * strength.y;
    }
    coord.x = mod(coord.x, texSize.x);
    coord.y = mod(coord.y, texSize.y);
`),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.distort,{stepSize:e.stepSize,type:e.distortType,scale:[e.scale.x,e.scale.y],strength:[e.strength.x,e.strength.y],phase:[e.phase.x,e.phase.y],offset:[e.offset.x,e.offset.y],texSize:[this.width,this.height]}),this},$f157b4bc2111ecb8$export$57b05c961ff98d6a=function(){return $deb6b884ba4ae312$export$5822a9d0880a5d82.multiplyAlpha=$deb6b884ba4ae312$export$5822a9d0880a5d82.multiplyAlpha||new $e0143068cd462268$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        color.rgb *= color.a;        gl_FragColor = color;    }","multiplyAlpha"),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.multiplyAlpha,{texSize:[this.width,this.height]}),this},$eWjiX=parcelRequire("eWjiX"),$c7d207160ef493f6$export$d99f0801a68bbcf1=function(e,t){return e._.use(1),t?t._.use(2):(this._.extraTexture.use(2),this._.extraTexture.initFromBytes(1,1,[0,0,0,0])),$deb6b884ba4ae312$export$5822a9d0880a5d82.mask=$deb6b884ba4ae312$export$5822a9d0880a5d82.mask||new $e0143068cd462268$export$7d9b0d118d0c4108(null,`
        uniform sampler2D texture;
        uniform sampler2D mask;
        uniform sampler2D original;
        varying vec2 texCoord;

        void main() {
            vec4 filteredCol = texture2D(texture, texCoord);
            vec4 originalCol = texture2D(original, texCoord);
            float maskStrength = texture2D(mask, texCoord).r;
            gl_FragColor = mix(originalCol, filteredCol, maskStrength);
        }
        `,"mask"),$deb6b884ba4ae312$export$5822a9d0880a5d82.mask.textures({mask:1,original:2}),$8501a2e1e79821a9$export$d731e22ecd0c25d3.call(this,$deb6b884ba4ae312$export$5822a9d0880a5d82.mask,{}),this},$eeae469bfe7893fd$export$a04cfca62fd2892f=function(){function e(e){return{_:e,loadContentsOf:function(e){$deb6b884ba4ae312$export$b59c6427db8463f4(this._.gl),this._.loadContentsOf(e)},destroy:function(){$deb6b884ba4ae312$export$b59c6427db8463f4(this._.gl),this._.destroy()}}}function t(t){return e($80392da2a95619fd$export$7e6fd232cff50dd1.fromElement(t))}function i(){var e=$deb6b884ba4ae312$export$5822a9d0880a5d82.UNSIGNED_BYTE;if($deb6b884ba4ae312$export$5822a9d0880a5d82.getExtension("WEBGL_color_buffer_float")&&$deb6b884ba4ae312$export$5822a9d0880a5d82.getExtension("OES_texture_float")&&$deb6b884ba4ae312$export$5822a9d0880a5d82.getExtension("OES_texture_float_linear")){var t=new $80392da2a95619fd$export$7e6fd232cff50dd1(100,100,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,$deb6b884ba4ae312$export$5822a9d0880a5d82.FLOAT);try{t.drawTo(function(){e=$deb6b884ba4ae312$export$5822a9d0880a5d82.FLOAT})}catch(e){}t.destroy()}return e}function n(e,t){var n=i();this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=e,this.height=t,this._.texture=new $80392da2a95619fd$export$7e6fd232cff50dd1(e,t,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,n),this._.spareTexture=new $80392da2a95619fd$export$7e6fd232cff50dd1(e,t,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,n),this._.extraTexture=this._.extraTexture||new $80392da2a95619fd$export$7e6fd232cff50dd1(0,0,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,n),this._.flippedShader=this._.flippedShader||new $e0143068cd462268$export$7d9b0d118d0c4108(null,`
uniform sampler2D texture;
varying vec2 texCoord;
void main() {
    gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));
}
        `,"flippedShader"),this._.isInitialized=!0}function r(e,t,i){return this._.isInitialized&&e._.width==this.width&&e._.height==this.height||n.call(this,t||e._.width,i||e._.height),e._.use(),this._.texture.drawTo(function(){$e0143068cd462268$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),this}function a(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function s(){var t=new $80392da2a95619fd$export$7e6fd232cff50dd1(this._.texture.width,this._.texture.height,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,$deb6b884ba4ae312$export$5822a9d0880a5d82.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo(function(){$e0143068cd462268$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),e(t)}function o(){var e=this._.texture.width,t=this._.texture.height,i=new Uint8Array(e*t*4);return this._.texture.drawTo(function(){$deb6b884ba4ae312$export$5822a9d0880a5d82.readPixels(0,0,e,t,$deb6b884ba4ae312$export$5822a9d0880a5d82.RGBA,$deb6b884ba4ae312$export$5822a9d0880a5d82.UNSIGNED_BYTE,i)}),i}function l(e){return function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return $deb6b884ba4ae312$export$b59c6427db8463f4(this._.gl),e.apply(this,i)}}function h(e,t){var i=null;return["webgl","experimental-webgl","webgl2"].forEach(function(n){if(!i)try{i=e.getContext(n,t)}catch(e){}}),i}return function(){if(!window.WebGLRenderingContext)throw"WebGLRenderingContext not set. Browser does not support WebGL.";var e=$eWjiX.BB.canvas(1,1),i=h(e,{premultipliedAlpha:!1});if(!i)throw"This browser does not support WebGL";return $deb6b884ba4ae312$export$b59c6427db8463f4(i),e._={gl:$deb6b884ba4ae312$export$5822a9d0880a5d82,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},e.texture=l(t),e.initialize=l(n),e.draw=l(r),e.update=l(a),e.contents=l(s),e.getPixelArray=l(o),e.brightnessContrast=l($c50d7229cf0a789e$export$6408eeb1703e74b8),e.hueSaturation=l($6dd7d8fac84d64b7$export$ef28bbbd731e79bf),e.triangleBlur=l($b01b186720ebdc8e$export$6e852234f1597a14),e.unsharpMask=l($c6e0992c38eb55ab$export$915fb7313c578ba2),e.perspective=l($4d16a2f492bd5d16$export$541149539f3a4684),e.matrixWarp=l($5b33fb39bf5722a9$export$a93b0222aeadc54b),e.tiltShift=l($1ec92859a97056c3$export$4545acb2b6bb8f22),e.noise=l($dd5d88e299e80db3$export$d3022aad56692482),e.curves=l($7480e3ce85bc65db$export$6894093bf294bea5),e.invert=l($6fb892cfa80f1621$export$6897c284b6f9f4dc),e.multiplyAlpha=l($f157b4bc2111ecb8$export$57b05c961ff98d6a),e.unmultiplyAlpha=l($34a2490457ff8aab$export$b324c80262feb891),e.toAlpha=l($164716f3bce9dcdb$export$be1ee5ea42904fdc),e.distort=l($55618926ab99fefa$export$7c9b924528782480),e.mask=l($c7d207160ef493f6$export$d99f0801a68bbcf1),e}}(),$02a74dc72797630f$var$failed=!1,$02a74dc72797630f$var$fx=null;function $02a74dc72797630f$export$8c4423af32b21158(){if($02a74dc72797630f$var$failed)return $02a74dc72797630f$var$fx;if(!$02a74dc72797630f$var$fx||$02a74dc72797630f$var$fx._.gl.isContextLost())try{$02a74dc72797630f$var$fx=$eeae469bfe7893fd$export$a04cfca62fd2892f()}catch(e){$02a74dc72797630f$var$failed=!0,$02a74dc72797630f$var$fx=null,setTimeout(function(){throw e})}return $02a74dc72797630f$var$fx}var $72Jv0=parcelRequire("72Jv0"),$9f0e53c75e472aaf$export$aeb1a0a0e64541b5=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.isInit=!1,this.klRootEl=t.klRootEl,this.klColorSlider=t.klColorSlider,this.layersUi=t.layersUi,this.getCurrentColor=t.getCurrentColor,this.maxCanvasSize=t.maxCanvasSize,this.klCanvas=t.klCanvas,this.getCurrentLayer=t.getCurrentLayer,this.isEmbed=t.isEmbed,this.statusOverlay=t.statusOverlay,this.onCanvasChanged=t.onCanvasChanged,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.onCopyToClipboard=t.onCopyToClipboard,this.onPaste=t.onPaste,this.rootEl=$eWjiX.BB.el()}return(0,$7h4XF._)(e,[{key:"testHasWebGL",value:function(){return!!$02a74dc72797630f$export$8c4423af32b21158()}},{key:"init",value:function(){var e=this,t=$9cbe98d1fb398012$export$6e4a713ddcda1e5e.FILTER_LIB,i=[];if(!$9cbe98d1fb398012$export$6e4a713ddcda1e5e.FILTER_LIB_STATUS.isLoaded)throw Error("filters not loaded");var n=this.testHasWebGL();if(!n){var r=$eWjiX.BB.el({parent:this.rootEl,className:"kl-toolspace-note",content:"Features disabled because WebGL is failing.",css:{margin:"10px",marginBottom:"0"}});$eWjiX.BB.el({parent:r,tagName:"button",textContent:"Learn More",css:{marginLeft:"5px"}}).onclick=function(){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:"<b>WebGL is not working</b>",div:$eWjiX.BB.el({content:`
See if your browser supports WebGL and has it enabled: <a href="https://get.webgl.org" target="_blank" rel="noopener noreferrer">get.webgl.org</a><br>
<br>
Recently (2023-05) a number of Chrome users on Chrome OS reported that WebGL fails, although it is enabled & supported.
This has been reported to Google.
`}),buttons:["Ok"],clickOnEnter:"Ok"})}}var a=function(r){var a=t[r],s=$eWjiX.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[(0,$72Jv0.createImage)({alt:"icon",src:a.icon,width:18,height:20,className:a.darkNoInvert?"dark-no-invert":"",css:{marginRight:"3px"}}),$8d7403abedf7cefa$export$ce37e184d908d785(a.lang.button)],css:{lineHeight:"20px",fontSize:"12px"},custom:{tabIndex:"-1"}}),o=$8d7403abedf7cefa$export$ce37e184d908d785(a.lang.name),l=!0;return a.webGL&&!n&&(l=!1),l?s.onclick=function(){e.applyUncommitted();var i=["Ok","Cancel"],n=function(e,t){var i;if(!("error"in t)){if("Cancel"==e){t.destroy&&t.destroy();return}try{i=t.getInput()}catch(e){if(-1!==e.message.indexOf(".getInput is not a function"))throw"filterDialog.getInput is not a function, filter: "+o;throw e}l(i)}};if(!("apply"in t[r]))return void $9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:"Application not fully loaded",type:"error"});var l=function(i){t[r].apply({layer:e.getCurrentLayer(),klCanvas:e.klCanvas,klHistory:e.klHistory,input:i})||$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:"Couldn't apply the edit action",type:"error"}),t[r].updatePos&&e.onCanvasChanged(),e.layersUi.update()};if(t[r].isInstant)s.blur(),l(null),e.statusOverlay.out('"'+o+'" '+$8d7403abedf7cefa$export$ce37e184d908d785("filter-applied"),!0);else{var h,c,u=e.klColorSlider.getSecondaryRGB(),d=void 0;try{d=t[r].getDialog({context:e.getCurrentLayer().context,klCanvas:e.klCanvas,maxWidth:e.maxCanvasSize,maxHeight:e.maxCanvasSize,currentColorRgb:{r:e.getCurrentColor().r,g:e.getCurrentColor().g,b:e.getCurrentColor().b},secondaryColorRgb:{r:u.r,g:u.g,b:u.b},composed:e.klHistory.getComposed()})}catch(e){setTimeout(function(){throw e})}if(!d||"error"in d)return void $9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:d?d.error:"Error: Could not perform action.",type:"error"});d.errorCallback=function(t){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:"Error: Could not perform action.",type:"error"}),setTimeout(function(){throw t},0),h()};var p={};"width"in d&&(p.width=d.width+"px");var f=[$075b9fd415bad4ff$export$db3b6bfb95261072("b",o)];void 0!==a.lang.description&&f.push($075b9fd415bad4ff$export$db3b6bfb95261072({className:"kl-info-btn",onClick:function(){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785(a.lang.description)})},title:$8d7403abedf7cefa$export$ce37e184d908d785(a.lang.description),noRef:!0},"?")),c=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,gap-5",f),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.klRootEl,message:c,div:d.element,style:p,buttons:i,clickOnEnter:"Ok",callback:function(e){n(e,d)},closeFunc:function(e){h=e}})}}:s.disabled=!0,i.push(s),s},s=function(i){Object.entries(t).forEach(function(t){var n=(0,$8N5YG._)(t,2),r=n[0],s=n[1];i.includes(r)&&(!e.isEmbed||s.inEmbed)&&e.rootEl.append(a(r))})},o=["cropExtend","flip","perspective","resize","rotate","transform"],l=["brightnessContrast","curves","distort","hueSaturation","invert","tiltShift","toAlpha","blur","unsharpMask"],h=["grid","noise","pattern","vanishPoint"];if(!this.isEmbed){var c=$eWjiX.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[(0,$72Jv0.createImage)({alt:"icon",src:$parcel$interopDefault($a77baa3d81294bff$exports),width:18,height:20,css:{marginRight:"3px"}}),$8d7403abedf7cefa$export$ce37e184d908d785("file-copy")],onClick:function(){return e.onCopyToClipboard()},title:$8d7403abedf7cefa$export$ce37e184d908d785("file-copy-title"),custom:{tabIndex:"-1"},css:{lineHeight:"20px"}}),u=$eWjiX.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[$eWjiX.BB.el({css:{height:"20px",cssFloat:"left"}}),$8d7403abedf7cefa$export$ce37e184d908d785("file-paste")],custom:{tabIndex:"-1"},css:{lineHeight:"20px"},onClick:function(){return e.onPaste()}});this.rootEl.append(c,u,$eWjiX.BB.el({className:"grid-hr"}))}s(o),this.rootEl.append($eWjiX.BB.el({className:"grid-hr"})),s(l),this.rootEl.append($eWjiX.BB.el({className:"grid-hr"})),s(h),this.isInit=!0}},{key:"getElement",value:function(){return this.rootEl}},{key:"show",value:function(){this.isInit||this.init(),this.rootEl.style.display="block"}},{key:"hide",value:function(){this.rootEl.style.display="none"}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$c80c88976de71b18$exports={};$c80c88976de71b18$exports=$parcel$resolve("iGeXe");var $eIcQa=parcelRequire("eIcQa"),$7jh4K=parcelRequire("7jh4K");function $6349b006a6604e1b$var$upload(e,t,i,n,r){return(0,$1LaJZ._)(function(){var a,s,o,l,h,c,u,d,p;return(0,$2gUX3.__generator)(this,function(f){switch(f.label){case 0:return[4,(0,$eIcQa.canvasToBlob)(e,"image/"+n)];case 1:if(a=f.sent(),!(s=window.open()))throw Error("could not create new tab");o=s.document.createElement("div"),(l=s.document.createElement("img")).src=$parcel$interopDefault($c80c88976de71b18$exports),o.append(l),(0,$7jh4K.css)(l,{filter:"invert(1)"}),(0,$7jh4K.css)(s.document.body,{backgroundColor:"#121211",backgroundImage:"linear-gradient(#2b2b2b 0%, #121211 50%)",backgroundRepeat:"no-repeat"}),(h=s.document.createElement("div")).style.marginTop="10px",o.append(h),h.textContent=$8d7403abedf7cefa$export$ce37e184d908d785("upload-uploading"),s.document.body.append(o),(0,$7jh4K.css)(o,{marginLeft:"auto",marginRight:"auto",marginTop:"100px",fontFamily:"system-ui, sans-serif",fontSize:"20px",textAlign:"center",transition:"opacity 0.3s ease-in-out",opacity:"0",color:"#ccc"}),setTimeout(function(){o.style.opacity="1"},20),f.label=2;case 2:return f.trys.push([2,4,,5]),(u=new FormData).append("title",t),u.append("description",i),u.append("image",a),[4,fetch("https://api.imgur.com/3/image",{method:"POST",headers:{Authorization:"Client-ID "+r},body:u})];case 3:return c=f.sent(),[3,5];case 4:throw d=f.sent(),s.close(),d;case 5:if(!c.ok)throw s.close(),Error();return[4,c.json()];case 6:return p=f.sent().data,s.location.href=p.link.replace(/\.(jpg|png)/,""),[2,p]}})})()}function $6349b006a6604e1b$export$b1dd62fa0b5f32f5(e,t,i,n){if(!i)throw Error("imgur key missing");var r=$eWjiX.BB.el({tagName:"input",custom:{name:"image-title"}});r.type="text",r.value=$8d7403abedf7cefa$export$ce37e184d908d785("upload-title-untitled");var a=$eWjiX.BB.el({tagName:"textarea",custom:{rows:"2",name:"image-description"},css:{width:"100%",maxWidth:"100%"}}),s=$eWjiX.BB.el({textContent:$8d7403abedf7cefa$export$ce37e184d908d785("upload-name")+":"}),o=$eWjiX.BB.el({textContent:$8d7403abedf7cefa$export$ce37e184d908d785("upload-caption")+":",css:{marginTop:"10px"}}),l=$eWjiX.BB.el({content:`<br/><a href="https://imgur.com/tos" target="_blank" rel="noopener noreferrer">${$8d7403abedf7cefa$export$ce37e184d908d785("terms-of-service")}</a>`}),h=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.RadioList({name:"filetype",init:"jpeg",items:[{label:"JPG",value:"jpeg"},{label:"PNG",value:"png"}],ignoreFocus:!0});(0,$7jh4K.css)(h.getElement(),{marginBottom:"10px"});var c=$eWjiX.BB.el(),u=$eWjiX.BB.el({className:"info-hint",textContent:$8d7403abedf7cefa$export$ce37e184d908d785("upload-link-notice")});c.append(u,h.getElement(),s,r,o,a,l),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:t,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("upload-title")}</b>`,type:"upload",div:c,buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("upload-submit"),"Cancel"],clickOnEnter:$8d7403abedf7cefa$export$ce37e184d908d785("upload-submit"),primaries:[$8d7403abedf7cefa$export$ce37e184d908d785("upload-submit")],autoFocus:$8d7403abedf7cefa$export$ce37e184d908d785("upload-submit"),callback:function(s){return(0,$1LaJZ._)(function(){var o,l;return(0,$2gUX3.__generator)(this,function(c){switch(c.label){case 0:if(s!==$8d7403abedf7cefa$export$ce37e184d908d785("upload-submit")&&"Yes"!==s&&"Ok"!==s)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,$6349b006a6604e1b$var$upload(e.getCompleteCanvas(1),r.value,a.value,h.getValue(),i)];case 2:return o=c.sent(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:t,type:"ok",message:`<h3>${$8d7403abedf7cefa$export$ce37e184d908d785("upload-success")}</h3><br>${$8d7403abedf7cefa$export$ce37e184d908d785("upload-delete")}<br><a target='_blank' rel="noopener noreferrer" href='https://imgur.com/delete/${o.deletehash}'>imgur.com/delete/${o.deletehash}</a><br><br>`,buttons:["Ok"]}),n(),[3,4];case 3:return l=c.sent(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:t,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("upload-failed"),buttons:["Ok"]}),[3,4];case 4:return[2]}})})()}})}var $1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3");function $a12fba8bc3214c1d$export$ab3d838b1d336b38(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:if($a12fba8bc3214c1d$var$agPsdLazy)return[3,2];return[4,parcelRequire("6caCk")];case 1:$a12fba8bc3214c1d$var$agPsdLazy=e.sent(),e.label=2;case 2:return[2,$a12fba8bc3214c1d$var$agPsdLazy]}})})()}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$6l0gQ=parcelRequire("6l0gQ");$7bc9f014309fd931$export$d4ef1ef99f1461a4="WKn-vG_psdWrapper";var $06e8423858d08972$var$DEBUG_TIME_LIMIT_MS=void 0,$06e8423858d08972$var$DEBUG_UNSAVED_ACTIONS_LIMIT=void 0,$06e8423858d08972$var$UNSAVED_ACTIONS_LIMIT=null!=$06e8423858d08972$var$DEBUG_UNSAVED_ACTIONS_LIMIT?$06e8423858d08972$var$DEBUG_UNSAVED_ACTIONS_LIMIT:100,$06e8423858d08972$var$LS_REMINDER_KEY="kl-save-reminder",$06e8423858d08972$export$befc6437ad34b28a=function(){"use strict";function e(t){var i;(0,$cx0mh._)(this,e),this.klHistory={},this.lastSavedAt=0,this.lastReminderShownAt=0,this.onSaveAsPsd=t.onSaveAsPsd,this.isDrawing=t.isDrawing,this.projectStore=t.projectStore,this.getProject=t.getProject,this.onStored=t.onStored,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.setting=null!=(i=$6l0gQ.LocalStorage.getItem($06e8423858d08972$var$LS_REMINDER_KEY))?i:"40min"}return(0,$7h4XF._)(e,[{key:"showPopup",value:function(){var e=this,t=Math.round((performance.now()-this.lastSavedAt)/1e3/60),i=$eWjiX.BB.el();i.append($eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("save-reminder-text",{a:"<strong>"+t,b:"</strong>"}),css:{marginBottom:"20px"}}));var n=$eWjiX.BB.el({className:$7bc9f014309fd931$export$d4ef1ef99f1461a4}),r=$eWjiX.BB.el({css:{margin:"0 -20px",padding:"20px",paddingBottom:"0"}});i.append(n,r);var a=$eWjiX.BB.el({tagName:"button",className:"kl-button kl-button-primary kl-button--extra-focus",content:$8d7403abedf7cefa$export$ce37e184d908d785("save-reminder-save-psd"),onClick:function(){e.applyUncommitted(),e.onSaveAsPsd()},css:{padding:"14px"},noRef:!0});n.append(a,$eWjiX.BB.el({content:" "+$8d7403abedf7cefa$export$ce37e184d908d785("save-reminder-psd-layers"),css:{marginTop:"10px"}}));var s=new $0e681e75eb3cab30$export$9c72cf485ef46673({projectStore:this.projectStore,getProject:this.getProject,klRootEl:document.body,applyUncommitted:this.applyUncommitted,options:{hideClearButton:!0,isFocusable:!0},onStored:function(){return e.onStored()}});s.show(),r.append(s.getElement()),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({type:"warning",target:document.body,message:`<b>${$8d7403abedf7cefa$export$ce37e184d908d785("save-reminder-title")}</b>`,div:i,ignoreBackground:!0,callback:function(){s.destroy(),$eWjiX.BB.destroyEl(a),e.closeFunc=void 0,e.lastReminderShownAt=performance.now()},closeFunc:function(t){e.closeFunc=t}}),setTimeout(function(){a.focus()},40)}},{key:"init",value:function(){var e=this;void 0===this.lastSavedHistoryIndex&&(this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),setInterval(function(){if("visible"===document.visibilityState){var t=Math.abs(e.klHistory.getTotalIndex()-e.lastSavedHistoryIndex),i=null!=$06e8423858d08972$var$DEBUG_TIME_LIMIT_MS?$06e8423858d08972$var$DEBUG_TIME_LIMIT_MS:6e4*({"20min":20,"40min":40,disabled:0})[e.setting];i>0&&0===$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()&&!e.isDrawing()&&e.lastReminderShownAt+i<performance.now()&&t>=$06e8423858d08972$var$UNSAVED_ACTIONS_LIMIT&&e.showPopup()}},5e3))}},{key:"reset",value:function(){void 0!==this.lastSavedHistoryIndex&&(this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),window.onbeforeunload=null,this.closeFunc&&this.closeFunc())}},{key:"getSetting",value:function(){return this.setting}},{key:"setSetting",value:function(e){this.setting=e,$6l0gQ.LocalStorage.setItem($06e8423858d08972$var$LS_REMINDER_KEY,this.setting)}}]),e}(),$1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$e1c6fbc08bfda4eb$var$types={"image/png":{description:"PNG Image",accept:{"image/png":[".png"]}},"image/vnd.adobe.photoshop":{description:"Adobe Photoshop Document",accept:{"image/vnd.adobe.photoshop":[".psd"]}}};function $e1c6fbc08bfda4eb$var$saveViaFilePicker(e,t){return(0,$1LaJZ._)(function(){var i,n,r,a;return(0,$2gUX3.__generator)(this,function(s){switch(s.label){case 0:if(i=e.type,!("showSaveFilePicker"in window))return[3,8];if(!$e1c6fbc08bfda4eb$var$types[i])return console.error("unknown mime type:",i),[2,!1];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,window.showSaveFilePicker({suggestedName:t,types:[$e1c6fbc08bfda4eb$var$types[i]]})];case 2:return n=s.sent(),[3,4];case 3:if((r=s.sent())instanceof Error&&"AbortError"===r.name)return[2,!0];return console.log("unpredicted error",r),[2,!1];case 4:if(!n)return[2,!1];return[4,n.createWritable()];case 5:return[4,(a=s.sent()).write(e)];case 6:return s.sent(),[4,a.close()];case 7:return s.sent(),[2,!0];case 8:return[2,!1];case 9:return[2]}})})()}function $e1c6fbc08bfda4eb$export$2bc2a80e311129ac(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,$1LaJZ._)(function(){var n,r,a;return(0,$2gUX3.__generator)(this,function(s){switch(s.label){case 0:if(!(n=i))return[3,2];return[4,$e1c6fbc08bfda4eb$var$saveViaFilePicker(e,t)];case 1:n=s.sent(),s.label=2;case 2:if(n)return[2];return(r=document.createElementNS("http://www.w3.org/1999/xhtml","a")).download=t,r.rel="noopener",r.href=a=URL.createObjectURL(e),setTimeout(function(){return URL.revokeObjectURL(a)},4e4),setTimeout(function(){document.body.appendChild(r),r.click(),document.body.removeChild(r)},1),[2]}})})()}var $da1a7600c10c1784$export$67ac20532b9ededa={filenameBase:"Klecks"},$eIcQa=parcelRequire("eIcQa"),$956d06d740fc5053$export$75e7b60500bb415b=function(){"use strict";function e(t,i,n){(0,$cx0mh._)(this,e),this.getExportType=t,this.klCanvas=i,this.onSaved=n,this.showSaveDialog=!0}return(0,$7h4XF._)(e,[{key:"saveImage",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(r){switch(r.label){case 0:return[4,(0,$eIcQa.canvasToBlob)(e,i)];case 1:return[4,$e1c6fbc08bfda4eb$export$2bc2a80e311129ac(r.sent(),t,n)];case 2:return r.sent(),[2]}})})()}},{key:"save",value:function(e){return(0,$1LaJZ._)(function(){var t,i,n,r,a,s,o,l,h,c,u,d,p,f,g,v,m;return(0,$2gUX3.__generator)(this,function(y){switch(y.label){case 0:if(t=this,e||(e=this.getExportType()),"png"!==e)return[3,5];i="png",n="image/png",r=$eWjiX.BB.getDate()+$da1a7600c10c1784$export$67ac20532b9ededa.filenameBase+"."+i,a=this.klCanvas.getCompleteCanvas(1),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.saveImage(a,r,n,this.showSaveDialog)];case 2:return y.sent(),[3,4];case 3:throw s=y.sent(),alert("could not save"),Error("failed png export");case 4:return[3,11];case 5:if("layers"!==e)return[3,10];o="png",l="image/png",h=$eWjiX.BB.getDate()+$da1a7600c10c1784$export$67ac20532b9ededa.filenameBase,c=this.klCanvas.getLayersFast(),u=0,y.label=6;case 6:if(!(u<c.length))return[3,9];return d=c[u],p=[h,"_",(""+(u+1)).padStart(2,"0"),"_",d.name,".",o],[4,this.saveImage(d.canvas,p.join(""),l)];case 7:y.sent(),y.label=8;case 8:return u++,[3,6];case 9:return[3,11];case 10:if("psd"===e){for(v=0,f=this.klCanvas.getLayersFast(),g={width:this.klCanvas.getWidth(),height:this.klCanvas.getHeight(),children:[],canvas:this.klCanvas.getCompleteCanvas(1)};v<f.length;v++)m=f[v],g.children.push({name:m.name,hidden:!m.isVisible,opacity:m.opacity,canvas:m.canvas,blendMode:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.PSD.blendKlToPsd(m.mixModeStr),left:0,top:0});$9cbe98d1fb398012$export$6e4a713ddcda1e5e.loadAgPsd().then(function(e){$e1c6fbc08bfda4eb$export$2bc2a80e311129ac(new Blob([e.writePsdBuffer(g)],{type:"image/vnd.adobe.photoshop"}),$eWjiX.BB.getDate()+$da1a7600c10c1784$export$67ac20532b9ededa.filenameBase+".psd",t.showSaveDialog)}).catch(function(){alert("Error: failed to load PSD library")})}y.label=11;case 11:return this.onSaved(),[2]}})}).call(this)}},{key:"setShowSaveDialog",value:function(e){this.showSaveDialog=e}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$53cc60fd413705d6$export$272bfd3ef9ef2f48=function(){"use strict";function e(t){if((0,$cx0mh._)(this,e),this.subscriberArr=[],this.onSetColor=t.onSetColor,this.onSetSize=t.onSetSize,this.onSetOpacity=t.onSetOpacity,this.onSetScatter=t.onSetScatter,this.onGetColor=t.onGetColor,this.onGetSize=t.onGetSize,this.onGetOpacity=t.onGetOpacity,this.onGetScatter=t.onGetScatter,this.onGetSliderConfig=t.onGetSliderConfig,e.instance)throw Error("BrushSettingService already instantiated");e.instance=this}return(0,$7h4XF._)(e,[{key:"emit",value:function(e,t){for(var i=0;i<this.subscriberArr.length;i++)this.subscriberArr[i]!==t&&this.subscriberArr[i](e)}},{key:"emitColor",value:function(e,t){this.emit({type:"color",value:e},t)}},{key:"emitSize",value:function(e,t){this.emit({type:"size",value:e},t)}},{key:"emitOpacity",value:function(e,t){this.emit({type:"opacity",value:e},t)}},{key:"emitScatter",value:function(e,t){this.emit({type:"scatter",value:e},t)}},{key:"emitSliderConfig",value:function(e,t){this.emit({type:"sliderConfig",value:e},t)}},{key:"setColor",value:function(e,t){this.onSetColor(e),this.emitColor(e,t)}},{key:"setSize",value:function(e,t){this.onSetSize(e)}},{key:"setOpacity",value:function(e,t){this.onSetOpacity(e)}},{key:"setScatter",value:function(e,t){this.onSetScatter(e)}},{key:"getColor",value:function(){return this.onGetColor()}},{key:"getSize",value:function(){return this.onGetSize()}},{key:"getOpacity",value:function(){return this.onGetOpacity()}},{key:"getScatter",value:function(){return this.onGetScatter()}},{key:"getSliderConfig",value:function(){return this.onGetSliderConfig()}},{key:"subscribe",value:function(e){this.subscriberArr.includes(e)||this.subscriberArr.push(e)}},{key:"unsubscribe",value:function(e){for(var t=0;t<this.subscriberArr.length;t++)e===this.subscriberArr[t]&&(this.subscriberArr.splice(t,1),t--)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$85d84ef8897d4b7a$exports={};$85d84ef8897d4b7a$exports=$parcel$resolve("kSWIa");var $659c57669da2cc2c$exports={};$659c57669da2cc2c$exports=$parcel$resolve("4FMUg");var $6l0gQ=parcelRequire("6l0gQ"),$7jh4K=parcelRequire("7jh4K");$8c9a65b29d77fa51$export$1c6ca1c73436aa3c="ttl1Ia_licenses";var $eWjiX=parcelRequire("eWjiX");function $c57a53a21f44c053$export$d3fe39c7bff44f23(){var e=$075b9fd415bad4ff$export$db3b6bfb95261072("."+$8c9a65b29d77fa51$export$1c6ca1c73436aa3c,$8d7403abedf7cefa$export$ce37e184d908d785("loading")),t=$075b9fd415bad4ff$export$db3b6bfb95261072("."+$8c9a65b29d77fa51$export$1c6ca1c73436aa3c,$8d7403abedf7cefa$export$ce37e184d908d785("loading")),i=$075b9fd415bad4ff$export$db3b6bfb95261072(",flex,flexCol,gap-10",[e,t]);new $e59fbd08bcc1a36b$export$185108a9b725b68({title:$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("licenses")}),content:$eWjiX.BB.el({content:i,css:{height:"100%",overflowY:"auto",padding:"10px",boxSizing:"border-box"}}),width:800,isMaxHeight:!0,onClose:function(){"#licenses"===window.location.hash&&history.replaceState("",document.title,window.location.pathname+window.location.search)}}),parcelRequire("kUTcy").then(function(t){e.innerHTML="",t.LICENSES.forEach(function(t){e.append($075b9fd415bad4ff$export$db3b6bfb95261072("details",[$075b9fd415bad4ff$export$db3b6bfb95261072("summary",t.title),$075b9fd415bad4ff$export$db3b6bfb95261072("",t.full.replace(/\n/g,"<br>"))]))})}),parcelRequire("6rG3P").then(function(e){t.innerHTML="",e.FONT_LICENSES.forEach(function(e){t.append($075b9fd415bad4ff$export$db3b6bfb95261072("details",[$075b9fd415bad4ff$export$db3b6bfb95261072("summary","Font: "+e.title),$075b9fd415bad4ff$export$db3b6bfb95261072("",e.full.replace(/\n/g,"<br>"))]))})})}var $72Jv0=parcelRequire("72Jv0"),$b02b612f245bffe6$export$ad7f6c626a2cdfad=function(){"use strict";function e(t){var i=t.onLeftRight,n=t.saveReminder,r=t.customAbout;(0,$cx0mh._)(this,e);var a=function(e){return"dark"===e?" "+$8d7403abedf7cefa$export$ce37e184d908d785("theme-dark"):" "+$8d7403abedf7cefa$export$ce37e184d908d785("theme-light")},s=function(){return $eWjiX.BB.el({tagName:"a",content:$8d7403abedf7cefa$export$ce37e184d908d785("licenses"),onClick:function(){return $c57a53a21f44c053$export$d3fe39c7bff44f23()}})};this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}});var o=$8d7403abedf7cefa$export$e4ce066d17694649.getAutoLanguage(),l=$eWjiX.BB.el({parent:this.rootEl,content:$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("settings-language")+":",css:{marginRight:"5px",marginBottom:"2px"}}),css:{display:"flex",alignItems:"center",flexWrap:"wrap"}}),h=[["auto",$8d7403abedf7cefa$export$ce37e184d908d785("auto")+` \u{2192} ${o.name} (${o.code})`]].concat((0,$bX4ja._)($90c6410f4b764e9c$export$d0d68bb9ed2c643d.map(function(e){return[e.code,e.name+` (${e.code})`]}))),c=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.Select({initValue:(0,$7jh4K.nullToUndefined)($6l0gQ.LocalStorage.getItem($8d7403abedf7cefa$export$991796128b2ca217)?$6l0gQ.LocalStorage.getItem($8d7403abedf7cefa$export$991796128b2ca217):"auto"),optionArr:h,onChange:function(e){"auto"===e?$6l0gQ.LocalStorage.removeItem($8d7403abedf7cefa$export$991796128b2ca217):$6l0gQ.LocalStorage.setItem($8d7403abedf7cefa$export$991796128b2ca217,e),u.style.display="block"},name:"language"});(0,$7jh4K.css)(c.getElement(),{flexGrow:"1"});var u=$eWjiX.BB.el({className:"kl-toolspace-note",content:$8d7403abedf7cefa$export$ce37e184d908d785("settings-language-reload"),css:{display:"none",marginTop:"5px",flexGrow:"1"}});l.append(c.getElement(),u);var d=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.Select({optionArr:[["auto",$8d7403abedf7cefa$export$ce37e184d908d785("auto")+"  "+a($e3b2ff8d1f8c5253$export$5714e40777c1bcc2.getMediaQueryTheme())],["light",a("light")],["dark",a("dark")]],initValue:$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.getStoredTheme()||"auto",onChange:function(e){$e3b2ff8d1f8c5253$export$5714e40777c1bcc2.setStoredTheme("auto"===e?void 0:e)},name:"ui-theme"});if((0,$7jh4K.css)(d.getElement(),{flexGrow:"1"}),(0,$7jh4K.addIsDarkListener)(function(){d.updateLabel("auto",$8d7403abedf7cefa$export$ce37e184d908d785("auto")+"  "+a($e3b2ff8d1f8c5253$export$5714e40777c1bcc2.getMediaQueryTheme()))}),$eWjiX.BB.el({parent:this.rootEl,content:[$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("settings-theme")+":",css:{marginRight:"5px",marginBottom:"2px"}}),d.getElement()],css:{marginTop:"15px",display:"flex",alignItems:"center",flexWrap:"wrap"}}),n){var p=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.Select({optionArr:[["20min",$8d7403abedf7cefa$export$ce37e184d908d785("x-minutes",{x:"20"})],["40min",$8d7403abedf7cefa$export$ce37e184d908d785("x-minutes",{x:"40"})],["disabled"," "+$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-disabled")]],initValue:n.getSetting(),onChange:function(e){if("disabled"!==e)return void n.setSetting(e);var t=$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-confirm-disable");$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:""+$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-confirm-title"),div:$075b9fd415bad4ff$export$db3b6bfb95261072("",[$075b9fd415bad4ff$export$db3b6bfb95261072(".info-hint",$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-confirm-a")),$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-confirm-b")]),buttons:[t,"Cancel"],callback:function(i){i===t?n.setSetting(e):p.setValue(n.getSetting())}})},name:"save-reminder-interval"});p.getElement().style.flexGrow="1",this.rootEl.append($075b9fd415bad4ff$export$db3b6bfb95261072(",flex,items-center,gap-5,mt-15,flexWrap",[$8d7403abedf7cefa$export$ce37e184d908d785("settings-save-reminder-label")+":",p.getElement()]))}$eWjiX.BB.el({tagName:"button",parent:this.rootEl,content:[(0,$72Jv0.createImage)({alt:"icon",src:$parcel$interopDefault($659c57669da2cc2c$exports),width:18,height:20,css:{marginRight:"5px"}}),$8d7403abedf7cefa$export$ce37e184d908d785("switch-ui-left-right")],onClick:function(){return i()},css:{marginTop:"15px"},custom:{tabIndex:"-1"}}),this.rootEl.append($eWjiX.BB.el({className:"grid-hr",css:{margin:"10px 0"}})),r?(this.rootEl.append(r),r.innerHTML||$eWjiX.BB.el({parent:r,css:{textAlign:"center"}}).append($eWjiX.BB.el({content:[(0,$72Jv0.createImage)({alt:"icon",height:20,src:$parcel$interopDefault($85d84ef8897d4b7a$exports),css:{verticalAlign:"middle"}})," ",$eWjiX.BB.el({tagName:"a",content:"bitbof",custom:{href:"https://bitbof.com",target:"_blank",tabIndex:"-1"}}),"  2025",$eWjiX.BB.el({tagName:"br"})]}),s())):$eWjiX.BB.el({parent:this.rootEl,css:{textAlign:"center"},content:[(0,$72Jv0.createImage)({alt:"Klecks",className:"dark-invert",height:25,src:$parcel$interopDefault($8f2db75412060fdc$exports)}),$eWjiX.BB.el({tagName:"br"}),(0,$72Jv0.createImage)({alt:"icon",height:20,src:$parcel$interopDefault($85d84ef8897d4b7a$exports),css:{verticalAlign:"middle"}})," ",$eWjiX.BB.el({tagName:"a",content:"bitbof",custom:{href:"https://bitbof.com",target:"_blank",tabIndex:"-1"}}),"  2025",$eWjiX.BB.el({tagName:"br"})]}).append(s(),document.createTextNode(" | "),$eWjiX.BB.el({tagName:"a",content:$8d7403abedf7cefa$export$ce37e184d908d785("donate"),custom:{href:"https://kleki.com/donate/",target:"_blank"}}),document.createTextNode(" | "),$eWjiX.BB.el({tagName:"a",content:$8d7403abedf7cefa$export$ce37e184d908d785("source-code"),custom:{href:"https://klecks.org",target:"_blank"}})),window.addEventListener("storage",function(e){e.key===$8d7403abedf7cefa$export$991796128b2ca217&&c.setValue((0,$7jh4K.nullToUndefined)($6l0gQ.LocalStorage.getItem($8d7403abedf7cefa$export$991796128b2ca217)?$6l0gQ.LocalStorage.getItem($8d7403abedf7cefa$export$991796128b2ca217):"auto"))})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$951e508110f8a437$export$42a534af7eb650e8=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.toolspace=t.toolspace,this.upBtn=$eWjiX.BB.el({parent:this.toolspace,title:$8d7403abedf7cefa$export$ce37e184d908d785("scroll"),className:"kl-scroller",css:{top:"0",transform:"rotate(180deg)"}}),this.downBtn=$eWjiX.BB.el({parent:this.toolspace,title:$8d7403abedf7cefa$export$ce37e184d908d785("scroll"),className:"kl-scroller",css:{bottom:"0"}}),this.updateUiState(t.uiState),new $eWjiX.BB.PointerListener({target:this.upBtn,onPointer:function(e){"pointerdown"===e.type&&(i.upInterval=setInterval(function(){i.toolspace.scrollBy(0,-13),i.update()},20)),"pointerup"===e.type&&(clearInterval(i.upInterval),setTimeout(function(){i.upInterval=null,i.update()},50))}}),new $eWjiX.BB.PointerListener({target:this.downBtn,onPointer:function(e){"pointerdown"===e.type&&(i.downInterval=setInterval(function(){i.toolspace.scrollBy(0,13),i.update()},20)),"pointerup"===e.type&&(clearInterval(i.downInterval),setTimeout(function(){i.downInterval=null,i.update()},50))}});var n=function(e){i.toolspace.scrollBy(0,Math.round(.7*e.deltaY)),i.update()};this.upBtn.addEventListener("wheel",n,{passive:!1}),this.downBtn.addEventListener("wheel",n,{passive:!1}),this.update(),new MutationObserver(function(){return i.update()}).observe(this.toolspace,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("resize",function(){return i.update()}),$dd0d395ff14a3e11$export$d3d1650bc39c4419.subscribe(function(e){i.upBtn.style.opacity=e>=1?"0":"",i.downBtn.style.opacity=e>=1?"0":""})}return(0,$7h4XF._)(e,[{key:"update",value:function(){var e=this.upBtn.style.display,t=this.downBtn.style.display;this.toolspace.scrollHeight>this.toolspace.offsetHeight+3?(this.upInterval||(e=0===this.toolspace.scrollTop?"none":"block"),this.downInterval||(t=this.toolspace.scrollTop+this.toolspace.offsetHeight+1>=this.toolspace.scrollHeight?"none":"block")):(e="none",t="none"),e!==this.upBtn.style.display&&(this.upBtn.style.display=e),t!==this.downBtn.style.display&&(this.downBtn.style.display=t)}},{key:"updateUiState",value:function(e){(0,$7jh4K.css)(this.upBtn,{left:"left"===e?"0":"",right:"right"===e?"0":""}),(0,$7jh4K.css)(this.downBtn,{left:"left"===e?"0":"",right:"right"===e?"0":""})}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$f244572c1923a3ac$export$7fa03d1ef9d3489e=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.settings={opacity:1,type:"linear",doLockAlpha:!1,doSnap:!1,isReversed:!1,isEraser:!1},this.colorSlider=t.colorSlider,this.rootEl=$eWjiX.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$eWjiX.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.iconArr=[];var n=33;[0,1,2].forEach(function(){var e=$eWjiX.BB.el({className:"dark-invert",css:{width:n+"px",height:n+"px",borderRadius:"3px",margin:"1px"}});i.iconArr.push(e)}),this.updateIcons();var r=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"linear",label:this.iconArr[0],title:$8d7403abedf7cefa$export$ce37e184d908d785("gradient-linear")},{id:"linear-mirror",label:this.iconArr[1],title:$8d7403abedf7cefa$export$ce37e184d908d785("gradient-linear-mirror")},{id:"radial",label:this.iconArr[2],title:$8d7403abedf7cefa$export$ce37e184d908d785("gradient-radial")}],initId:"linear",onChange:function(e){i.settings.type=e}});this.rootEl.append(r.getElement());var a=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:this.settings.opacity,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e},onChange:function(e){i.settings.opacity=e}});(0,$7jh4K.css)(a.getElement(),{marginTop:"10px"}),this.rootEl.append(a.getElement());var s=$eWjiX.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px"}}),o=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("reverse"),callback:function(e){i.settings.isReversed=e,i.updateIcons()},css:{width:"50%"},name:"reverse-gradient"}),l=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("angle-snap"),title:$8d7403abedf7cefa$export$ce37e184d908d785("angle-snap-title"),callback:function(e){i.settings.doSnap=e},css:{width:"50%"},name:"enable-snapping"});s.append(o.getElement(),l.getElement());var h=$eWjiX.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px"}}),c=new $365a915dfb503274$export$48513f6b9f8ce62d({init:this.settings.isEraser,label:$8d7403abedf7cefa$export$ce37e184d908d785("eraser"),callback:function(e){i.settings.isEraser=e},css:{width:"50%"},name:"enable-eraser"}),u=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha"),title:$8d7403abedf7cefa$export$ce37e184d908d785("lock-alpha-title"),callback:function(e){i.settings.doLockAlpha=e},doHighlight:!0,css:{width:"50%"},name:"enable-alpha-lock"});h.append(c.getElement(),u.getElement())}return(0,$7h4XF._)(e,[{key:"updateIcons",value:function(){var e=this.settings.isReversed?"#0000":"#000",t=this.settings.isReversed?"#000":"#0000";this.iconArr[0].style.background=`linear-gradient(${e}, ${t})`,this.iconArr[1].style.background=`linear-gradient(${t}, ${e}, ${t})`,this.iconArr[2].style.background=`radial-gradient(${e}, ${t})`}},{key:"getElement",value:function(){return this.rootEl}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=e?"block":"none",e&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}},{key:"getSettings",value:function(){return $eWjiX.BB.copyObj(this.settings)}}]),e}(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e={BRUSHES:$42ac5b30ad65dabb$export$32510733a89b2eab,BRUSHES_UI:$7de2f0eab7a9ead7$export$d1a79a5ce7e46547,BrushSettingService:$53cc60fd413705d6$export$272bfd3ef9ef2f48,KlCanvas:$0621fc8724f6bfac$export$4a819bde91671014,KlCanvasPreview:$e6889b231e436752$export$e258ade1648009b7,FILTER_LIB_STATUS:$805be15a1e91c0ee$export$24724bc1f91cba3,FILTER_LIB:$805be15a1e91c0ee$export$bac24f240bb7727d,ShapeTool:$01d7180c5d1d0fdf$export$27550cc14d7ae85a,drawShape:$01d7180c5d1d0fdf$export$71b514a25c47df50,GradientTool:$5e45fa121ba5050f$export$74d12f09ff9f1956,drawGradient:$5e45fa121ba5050f$export$b1f70a113e3b5c1b,PSD:$4c230b0de5e1a470$exports,ProjectStore:$6mTnI.ProjectStore,loadAgPsd:$a12fba8bc3214c1d$export$ab3d838b1d336b38,SaveToComputer:$956d06d740fc5053$export$75e7b60500bb415b,Checkbox:$365a915dfb503274$export$48513f6b9f8ce62d,input:$dJPtW.input,Select:$7a3263857aacf58f$export$ef9b1a59e592288f,ImageToggle:$8fa94d142febb502$export$b6d053cded550773,ImageRadioList:$8cb981a3c9e5b15b$export$7cc1012a658e6ad8,RadioList:$de98bdc3369d2e4f$export$3dff5655255b5729,createPenPressureToggle:$a49c90053f8766a2$export$9da2e8821e6cbb57,KlSlider:$5c0625e6104e2c75$export$a1855b925e534de7,HexColorDialog:$dada52d673c8c4ac$export$cc42e119007cb939,KlColorSlider:$0ebf4eb3a9343b24$export$4e5102252876c5d7,KlColorSliderSmall:$3ce0af1e789f1ab4$export$66306bf21a9ff39e,PointSlider:$5e81242a941997c7$export$ac00cea56cec3037,ColorOptions:$4db8cbbb01889095$export$24ba9b81662d4366,Options:$7960d0c50ff12b0d$export$c019608e5b5bb4cb,BoxToggle:$afe02cc26c765c2c$export$2358c75ad3c15b2d,StatusOverlay:$c1a93a3cd82636c9$export$5ee0af1d5c87e856,CropCopy:$01fcd0ed15aa4018$export$40175a5948a88a57,FreeTransform:$0370167ee97a20d9$export$79a74567acf241b0,FreeTransformCanvas:$48f5d87739d28bf9$export$205c2dd29f8a66b5,Cropper:$de496a1759b04ed9$export$71ed2b85d4ca43d3,LayerPreview:$18e69c7d4cb991e8$export$d25420b53e16716f,KlImageDropper:$01cb8095758db224$export$e789742143ba5b1,OverlayToolspace:$d6fe881e8fc421ac$export$9f0da9b942594e99,ToolspaceTopRow:$6003e73b8cbb69e2$export$665d2c76b1eb8459,ToolDropdown:$18c597dee53260ff$export$a0a40f8a0b8fee15,ToolspaceToolRow:$a372d78c806cd0cc$export$c744a22bef9e0b97,ToolspaceStabilizerRow:$90c04b5ac185bf3d$export$8162a66cd18867a7,TabRow:$d04d72b97d637d65$export$3c6d17ed0106bfb9,ToolspaceCollapser:$9091fb5691a677d9$export$5b91f641162972fc,BrowserStorageUi:$0e681e75eb3cab30$export$9c72cf485ef46673,SaveReminder:$06e8423858d08972$export$befc6437ad34b28a,ToolspaceScroller:$951e508110f8a437$export$42a534af7eb650e8,DIALOG_COUNTER:$dd0d395ff14a3e11$export$d3d1650bc39c4419,popup:$c902829f68f42bce$export$d7e8d4d4450c819c,Popup:$e59fbd08bcc1a36b$export$185108a9b725b68,clipboardDialog:$ffd40240385bb9f9$export$32b89bc9bb92706a,showImportAsLayerDialog:$e3dfa43019bc3f08$export$962af7e240721d88,newImageDialog:$4fb68589de8a8c9a$export$f77a89101d7d6586,textToolDialog:$7a7111f71abacc0a$export$e263e067d6140649,showImportImageDialog:$c8d2eb7d799b314c$export$1bf16d9bd59fd8f9,showIframePopup:$2d47de6498e5a87c$export$35fa34e5af64bd4a,imgurUpload:$6349b006a6604e1b$export$b1dd62fa0b5f32f5,HandUi:$9934467c988b088a$export$cf20160367bae46c,FillUi:$51d47356d698ffec$export$1e63e3b0645421a2,GradientUi:$f244572c1923a3ac$export$7fa03d1ef9d3489e,TextUi:$d06987f550ff485e$export$32a22540e4b2f123,ShapeUi:$45c003c723de07b5$export$a9387b1d4260d39c,FileUi:$775b09ee76e7cc3e$export$409b892ffe02580b,EditUi:$9f0e53c75e472aaf$export$aeb1a0a0e64541b5,SettingsUi:$b02b612f245bffe6$export$ad7f6c626a2cdfad,LayersUi:$615843517fb18518$export$c3bf51e04f391d6d};Object.keys($9cbe98d1fb398012$export$6e4a713ddcda1e5e);var $eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$1eff19bee197987a$export$ce26cd3db18613a3=function(){"use strict";function e(t){(0,$cx0mh._)(this,e);var i=function(e){var t=6+(e.extraPadding?e.extraPadding:0),i=$eWjiX.BB.el({className:"toolspace-row-button nohighlight",title:e.title,onClick:e.onClick,css:{padding:e.content?"":e.contain?t+"px 0":""}});if(e.content)i.append(e.content);else{var n=$eWjiX.BB.el({className:"dark-invert",css:{backgroundImage:"url('"+e.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:e.contain?"contain":"",height:"100%"}});n.style.pointerEvents="none",i.append(n)}var r=new $eWjiX.BB.PointerListener({target:i,onEnterLeave:function(e){i.classList.toggle("toolspace-row-button-hover",e)}});return{el:i,pointerListener:r}};this.rootEl=$eWjiX.BB.el({className:"kl-toolspace-row",css:{height:"36px",display:"flex"}});var n=i({onClick:t.onSubmit,title:$8d7403abedf7cefa$export$ce37e184d908d785("submit-title"),content:$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("submit"),className:"toolspace-row-button__submit",css:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),contain:!0});n.el.style.width="45px";var r=i({onClick:t.onHelp,title:$8d7403abedf7cefa$export$ce37e184d908d785("help"),image:$parcel$interopDefault($5f1a2e996d986b65$exports),contain:!0}),a=i({onClick:t.onLeftRight,title:$8d7403abedf7cefa$export$ce37e184d908d785("switch-ui-left-right"),image:$parcel$interopDefault($659c57669da2cc2c$exports),contain:!0});this.rootEl.append(n.el,a.el,r.el)}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$fca35583bfaa35b6$export$f02de051ab70b20e=60,$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$dZ59l=parcelRequire("dZ59l"),$83Kse=parcelRequire("83Kse"),$kDVZW=parcelRequire("kDVZW"),$kFecW=parcelRequire("kFecW"),$kr2fR=parcelRequire("kr2fR"),$eIcQa=parcelRequire("eIcQa"),$bbA6w=parcelRequire("bbA6w"),$14b90ba44af68d49$export$94ec999f33a691e3=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.texture=void 0,this.maskCanvas=void 0,this.maskTexture=void 0,this.oldOnUpdateProps={textureWidth:0,textureHeight:0,transform:{scaleX:0,scaleY:0,angleDeg:0,x:0,y:0}},this.render=function(e,t,n){var r=$92816524e1b72be4$export$ad1d215dd03fe75a(e),a=0,s=(0,$83Kse.identity)(),o=(0,$cdZRx.applyToPoint)(r,{x:0,y:0}),l=(0,$cdZRx.applyToPoint)(r,{x:i.original.width,y:i.original.height});l.x=Math.round(l.x),l.y=Math.round(l.y);var h={x:Math.max(a,o.x),y:Math.max(a,o.y)},c={x:Math.min(t-a,l.x),y:Math.min(n-a,l.y)};if((x={x:h.x,y:h.y,width:c.x-h.x,height:c.y-h.y}).width<=0||x.height<=0)return i.textureSource.width=1,i.textureSource.height=1,i.textureSource;var u=(0,$dZ59l.compose)((0,$kDVZW.inverse)(r),(0,$kr2fR.translate)(a,a),(0,$kr2fR.translate)(x.x-a,x.y-a)),d={textureWidth:Math.ceil(x.width),textureHeight:Math.ceil(x.height),transform:{scaleX:e.scaleX,scaleY:e.scaleY,angleDeg:e.angleDeg,x:e.x-x.x,y:e.y-x.y}},p=0,f=0;if(e.scaleX>1){var g=(0,$cdZRx.applyToPoint)(u,{x:0,y:0});p=-g.x,f=-g.y,g.x=Math.max(0,Math.floor(g.x)),g.y=Math.max(0,Math.floor(g.y)),p+=g.x,f+=g.y;var v=(0,$cdZRx.applyToPoint)(u,{x:x.width,y:x.height});v.x=Math.min(i.original.width,Math.ceil(v.x)),v.y=Math.min(i.original.height,Math.ceil(v.y));var m=v.x-g.x,y=v.y-g.y;d.textureWidth=m,d.textureHeight=y,d.transform={scaleX:1,scaleY:1,angleDeg:0,x:-g.x,y:-g.y},u=(0,$dZ59l.compose)(u,(0,$kFecW.scale)(e.scaleX,e.scaleY),(0,$kr2fR.translate)(p,f))}if(!i.texture||JSON.stringify(d)!==JSON.stringify(i.oldOnUpdateProps)||i.postMix){i.textureSource.width=d.textureWidth,i.textureSource.height=d.textureHeight,i.ctx.save(),i.ctx.imageSmoothingEnabled=!1,e.scaleX>1?(s=$92816524e1b72be4$export$ad1d215dd03fe75a(d.transform),(b=i.ctx).setTransform.apply(b,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(s)))):(s=(0,$kDVZW.inverse)(u),(w=i.ctx).setTransform.apply(w,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(s)))),i.ctx.drawImage(i.original,0,0),i.ctx.restore();var x,b,w,k=JSON.stringify(d)!==JSON.stringify(i.oldOnUpdateProps);if((!i.texture||k)&&(i.texture?i.texture.loadContentsOf(i.textureSource):i.texture=i.fxCanvas.texture(i.textureSource)),i.selection&&(!i.maskTexture||k)){i.maskCanvas?(i.maskCanvas.width=d.textureWidth,i.maskCanvas.height=d.textureHeight):i.maskCanvas=$eWjiX.BB.canvas(d.textureWidth,d.textureHeight);var B=$eWjiX.BB.ctx(i.maskCanvas),S=(0,$bbA6w.transformMultiPolygon)(i.selection,s);(0,$eIcQa.drawSelectionMask)(S,B),i.maskTexture?i.maskTexture.loadContentsOf(i.maskCanvas):i.maskTexture=i.fxCanvas.texture(i.maskCanvas)}i.postMix||(i.textureSource.width=1,i.textureSource.height=1)}return(i.oldOnUpdateProps=d,i.onUpdate(i.fxCanvas.draw(i.texture),d.transform),i.maskTexture&&i.fxCanvas.multiplyAlpha().mask(i.maskTexture,i.isMaskingWithEmptyOriginal?void 0:i.texture).unmultiplyAlpha(),i.fxCanvas.update(),i.postMix)?(i.ctx.save(),i.ctx.globalAlpha=i.postMix.opacity,i.ctx.globalCompositeOperation=i.postMix.operation,i.ctx.drawImage(i.fxCanvas,0,0),i.ctx.restore(),{image:i.textureSource,transform:u}):{image:i.fxCanvas,transform:u}},this.original=t.original,this.onUpdate=t.onUpdate,this.textureSource=$eWjiX.BB.canvas(1,1),this.ctx=$eWjiX.BB.ctx(this.textureSource),this.fxCanvas=(0,$7jh4K.throwIfNull)($02a74dc72797630f$export$8c4423af32b21158()),this.postMix=t.postMix,this.selection=t.selection,this.isMaskingWithEmptyOriginal=!!t.isMaskingWithEmptyOriginal}return(0,$7h4XF._)(e,[{key:"setPostMix",value:function(e){this.postMix=e}},{key:"destroy",value:function(){var e;$eWjiX.BB.freeCanvas(this.textureSource),this.maskCanvas&&$eWjiX.BB.freeCanvas(this.maskCanvas),this.texture&&(this.texture=this.fxCanvas.texture(this.textureSource),this.fxCanvas.draw(this.texture).update(),this.texture&&this.texture.destroy()),null==(e=this.maskTexture)||e.destroy()}}]),e}(),$eWjiX=parcelRequire("eWjiX"),$eWjiX=parcelRequire("eWjiX"),$eIcQa=parcelRequire("eIcQa"),$eg83P=parcelRequire("eg83P");function $670db093f8076d2c$export$66c6ccb6bcae2c94(e,t,i,n){var r,a=$02a74dc72797630f$export$8c4423af32b21158();if(!a)return!1;if(t){var s=$eWjiX.BB.canvas(e.canvas.width,e.canvas.height),o=$eWjiX.BB.ctx(s);(0,$eIcQa.drawSelectionMask)(t,o),r=a.texture(s),$eWjiX.BB.freeCanvas(s)}var l=a.texture(e.canvas);return a.draw(l),i(a),r&&(a.multiplyAlpha().mask(r,l).unmultiplyAlpha(),r.destroy()),l.destroy(),a.update(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(a,0,0),n.push($5bc59effccf14376$export$263fa670dc037098(n.getComposed(),$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.canvas,t?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(t)):void 0))),!0}var $7jh4K=parcelRequire("7jh4K"),$024aabab8b30bbfd$export$af433fb90aa90a38={getDialog(e){var t=$eWjiX.BB.el(),i={element:t},n=$042ba564475611dc$export$8f6817a932bf45cd();n||(i.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(n));var r=e.context,a=e.klCanvas;if(!r||!a)return!1;var s=a.getLayers(),o=a.getLayerIndex(r.canvas),l=0,h=0,c=new $14b90ba44af68d49$export$94ec999f33a691e3({original:r.canvas,onUpdate:function(e){return e.brightnessContrast(l,h)},selection:a.getSelection()}),u=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-bright-contrast-brightness"),width:300,height:30,min:0,max:100,value:(l+1)*50,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){l=e/50-1,g.render()}}),d=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-bright-contrast-contrast"),width:300,height:30,min:0,max:100,value:(h+1)*50,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){h=e/50-1,g.render()}});u.getElement().style.marginBottom="10px",d.getElement().style.marginBottom="10px",t.append(u.getElement(),d.getElement());for(var p=[],f=0;f<s.length;f++)p.push({image:f===o?c.render:s[f].context.canvas,isVisible:s[f].isVisible,opacity:s[f].opacity,mixModeStr:s[f].mixModeStr,hasClipping:!1});var g=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(n),height:$a433d11ad38d7c38$export$94cffdbcf128864a(n),project:{width:r.canvas.width,height:r.canvas.height,layers:p},selection:a.getSelection()});return g.render(),(0,$7jh4K.css)(g.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),t.append(g.getElement()),i.destroy=function(){u.destroy(),d.destroy(),c.destroy(),g.destroy()},i.getInput=function(){return i.destroy(),{brightness:l,contrast:h}},i},apply(e){var t=e.layer.context,i=e.input.brightness,n=e.input.contrast,r=e.klHistory;return!!t&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.brightnessContrast(i,n)},r)}},$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$eg83P=parcelRequire("eg83P"),$2680b5781517cb67$export$e5937df51b9e1d86={getDialog(e){var t=e.klCanvas;if(!t)return!1;var i=$eWjiX.BB.canvas(),n=$eWjiX.BB.fitInto(t.getWidth(),t.getHeight(),560,400,1),r=parseInt(""+n.width),a=parseInt(""+n.height),s=r/t.getWidth();i.width=r,i.height=a,i.style.display="block",$eWjiX.BB.ctx(i).drawImage(t.getCompleteCanvas(s),0,0,r,a);var o=$eWjiX.BB.el(),l={element:o},h=0,c=0,u=0,d=0,p=!1,f=!1,g=!1,v=!1,m=e.maxWidth,y=e.maxHeight,x=1,b=t.getSelection(),w=b?(0,$eg83P.intBoundsWithinArea)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(b),t.getWidth(),t.getHeight()):void 0;if(w){var k=w.x2-w.x1,B=w.y2-w.y1;k<=m&&B<=y?(u=w.y1,c=w.x2-t.getWidth(),d=w.y2-t.getHeight(),h=w.x1):w=void 0}var S=(0,$dJPtW.input)({init:h,type:"number",min:-t.getWidth(),max:m,css:{width:"75px"},callback:function(){p=!0,A()}}),C=(0,$dJPtW.input)({init:c,type:"number",min:-t.getWidth(),max:m,css:{width:"75px"},callback:function(){f=!0,A()}}),E=(0,$dJPtW.input)({init:u,type:"number",min:-t.getHeight(),max:y,css:{width:"75px"},callback:function(){g=!0,A()}}),_=(0,$dJPtW.input)({init:d,type:"number",min:-t.getHeight(),max:y,css:{width:"75px"},callback:function(){v=!0,A()}}),I={display:"flex",flexDirection:"column",width:"calc(50% - 5px)",gap:"3px"},T=$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-left")+":",S],css:I}),M=$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-right")+":",C],css:I}),L=$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-top")+":",E],css:I}),R=$eWjiX.BB.el({content:[$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-bottom")+":",_],css:I}),P=$eWjiX.BB.el({css:{display:"flex",flexWrap:"wrap",gap:"10px"}});function A(){h=parseInt(S.value),c=parseInt(C.value),u=parseInt(E.value),d=parseInt(_.value);var e=t.getWidth()+h+c,i=t.getHeight()+u+d;e<=0&&(p&&(S.value=""+(h=-t.getWidth()-c+1)),f&&(C.value=""+(c=-t.getWidth()-h+1)),e=1),e>m&&(p&&(S.value=""+(h=-t.getWidth()-c+m)),f&&(C.value=""+(c=-t.getWidth()-h+m)),e=m),i<=0&&(g&&(E.value=""+(u=-t.getHeight()-d+1)),v&&(_.value=""+(d=-t.getHeight()-u+1)),i=1),i>y&&(g&&(E.value=""+(u=-t.getHeight()-d+y)),v&&(_.value=""+(d=-t.getHeight()-u+y)),i=y),Y.setTransform({x:-h,y:-u,width:e,height:i}),p=!1,f=!1,g=!1,v=!1}P.append(T,M,L,R),o.append(P);var D=!0,O=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-rule-thirds"),allowTab:!0,callback:function(e){D=e,Y.showThirds(D)},name:"rule-of-thirds"});o.append($eWjiX.BB.el({css:{clear:"both"}}));var z={r:0,g:0,b:0,a:0},H=[{r:0,g:0,b:0,a:0},{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1}];H.push({r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1}),H.push({r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1});var j=new $4db8cbbb01889095$export$24ba9b81662d4366({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-crop-fill"),colorArr:H,onChange:function(e){z=e,G()}}),F=$eWjiX.BB.el({css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"}});function X(e){var n=$eWjiX.BB.fitInto(e.width,e.height,260,180,1);x=n.width/e.width;var r=$eWjiX.BB.centerWithin($a433d11ad38d7c38$export$ec2d17c6d3ae0768.width,V,n.width,n.height);i.style.width=t.getWidth()*x+"px",i.style.height=t.getHeight()*x+"px",N.style.left=r.x-e.x*x+"px",N.style.top=r.y-e.y*x+"px",h=parseInt(""+-e.x),u=parseInt(""+-e.y),c=parseInt(""+(e.x+e.width-t.getWidth())),d=parseInt(""+(e.y+e.height-t.getHeight())),S.value=""+h,E.value=""+u,C.value=""+c,_.value=""+d,0!==z.a&&(i.style.background="var(--kl-checkerboard-background)",i.style.backgroundSize=100*x+"px"),U.style.backgroundPosition=r.x+"px "+r.y+"px",U.style.backgroundSize=100*x+"px",Y.setScale(x)}o.append(F),F.append(O.getElement(),j.getElement());var V=$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height-2,U=$eWjiX.BB.el({className:"kl-edit-crop-preview",css:{width:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.width+"px",marginTop:"10px",marginLeft:"-20px",height:V+"px",backgroundColor:"#9e9e9e",position:"relative",borderTop:"1px solid rgb(144,144,144)",borderBottom:"1px solid rgb(144,144,144)",overflow:"hidden",userSelect:"none",touchAction:"none",background:"var(--kl-checkerboard-background)"}});U.oncontextmenu=function(){return!1};var W=$eWjiX.BB.el({css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"}});U.append(W);var N=$eWjiX.BB.el({parent:U,css:{position:"absolute",left:"0",top:"0"}});$eWjiX.BB.el({parent:N,content:i,css:{boxShadow:"0 0 0px 1px rgb(130,130,130)",position:"absolute",left:"0px",top:"0px"}}),o.append(U);var Y=new $de496a1759b04ed9$export$71ed2b85d4ca43d3({x:0,y:0,width:t.getWidth(),height:t.getHeight(),scale:x,callback:X,maxW:m,maxH:y,init:w});function G(){0===z.a?(W.style.background="",i.style.background=""):(W.style.background=$eWjiX.BB.ColorConverter.toRgbStr(z),i.style.background="var(--kl-checkerboard-background)",i.style.backgroundSize=100*x+"px")}return X(Y.getTransform()),N.append(Y.getElement()),l.destroy=function(){Y.destroy(),O.destroy(),j.destroy()},l.getInput=function(){return l.destroy(),{left:h,right:c,top:u,bottom:d,fillColor:0===z.a?void 0:z}},l},apply(e){var t=e.klCanvas;return!(!t||isNaN(e.input.left)||isNaN(e.input.right)||isNaN(e.input.top)||isNaN(e.input.bottom))&&(t.resizeCanvas(e.input),!0)}},$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");function $81ac57466912ccc9$export$4300cf0a0df418a6(){return $eWjiX.BB.copyObj({r:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],g:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],b:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]]})}var $81ac57466912ccc9$export$1c43bf66c2a2e4da=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({css:{position:"relative",marginBottom:"10px"}}),this.rootEl.oncontextmenu=function(){return!1};var n="All",r=t.curves;this.modeButtons=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"All",label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-curves-all")},{id:"Red",label:$8d7403abedf7cefa$export$ce37e184d908d785("red")},{id:"Green",label:$8d7403abedf7cefa$export$ce37e184d908d785("green")},{id:"Blue",label:$8d7403abedf7cefa$export$ce37e184d908d785("blue")}],initId:"All",onChange:function(e){"All"===(n=e)&&(r=$81ac57466912ccc9$export$4300cf0a0df418a6());var t=r.r;"Green"===n&&(t=r.g),"Blue"===n&&(t=r.b),i.p0.setPos(0,o-t[0][1]*o),i.p1.setPos(t[1][0]*s,o-t[1][1]*o),i.p2.setPos(t[2][0]*s,o-t[2][1]*o),i.p3.setPos(s,o-t[3][1]*o),p()}}),this.rootEl.append(this.modeButtons.getElement());var a=$eWjiX.BB.el({parent:this.rootEl,className:"kl-curves-graph",css:{position:"relative",marginTop:"10px"}}),s=300,o=100,l=$eWjiX.BB.canvas(s,o),h=$eWjiX.BB.ctx(l);a.append(l);var c=function(e){return Math.max(0,Math.min(1,e))},u=function(e,t,i,n){var r=14,l=t,h=e,c=$eWjiX.BB.el({className:"kl-curves-graph__grip",css:{left:e-r/2+"px",top:t-r/2+"px",width:r+"px",height:r+"px",borderRadius:r+"px"}}),u=function(){(0,$7jh4K.css)(c,{left:e-r/2+"px",top:t-r/2+"px"})},d=new $eWjiX.BB.PointerListener({target:c,onPointer:function(r){r.eventPreventDefault(),"pointerdown"===r.type&&(h=e,l=t),"left"===r.button&&"pointermove"===r.type&&(n||(h+=r.dX),e=Math.max(0,Math.min(s,h)),l+=r.dY,t=Math.max(0,Math.min(o,l)),u(),i({x:e,y:t}))}});a.append(c);var p=function(i,n){e=i,l=t=n,h=e,(0,$7jh4K.css)(c,{left:e-r/2+"px",top:t-r/2+"px"})};return{el:c,setPos:p,pointerListener:d}},d=function(e,t,i){"All"===n&&(r.r[e]=[c(t/s),c(1-i/o)],r.g[e]=[c(t/s),c(1-i/o)],r.b[e]=[c(t/s),c(1-i/o)]),"Red"===n&&(r.r[e]=[c(t/s),c(1-i/o)]),"Green"===n&&(r.g[e]=[c(t/s),c(1-i/o)]),"Blue"===n&&(r.b[e]=[c(t/s),c(1-i/o)])};this.p0=u(0,o,function(e){d(0,e.x,e.y),p()},!0),this.p1=u(s/3,o/3*2,function(e){d(1,e.x,e.y),p()}),this.p2=u(s/3*2,o/3,function(e){d(2,e.x,e.y),p()}),this.p3=u(s,0,function(e){d(3,e.x,e.y),p()},!0);var p=function(){(h=$eWjiX.BB.ctx(l)).clearRect(0,0,l.width,l.height);for(var e={r:[],g:[],b:[]},i=0;i<r.r.length;i++)e.r.push(r.r[i]),e.g.push(r.g[i]),e.b.push(r.b[i]);var a=function(e){h.beginPath();for(var t=new $eWjiX.BB.SplineInterpolator(e),i=0;i<100;i++){var n=t.interpolate(i/100);n=Math.max(0,Math.min(1,n)),0===i?h.moveTo(i/100*s,o-n*o):h.lineTo(i/100*s,o-n*o)}h.stroke()};h.save(),"All"===n?(h.strokeStyle="black",a(e.r)):(h.globalAlpha=.5,h.strokeStyle="red",a(e.r),h.strokeStyle="green",a(e.g),h.strokeStyle="blue",a(e.b)),h.restore(),t.callback(e)};p()}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}},{key:"getModeButtons",value:function(){return this.modeButtons}},{key:"destroy",value:function(){this.p0.pointerListener.destroy(),this.p1.pointerListener.destroy(),this.p2.pointerListener.destroy(),this.p3.pointerListener.destroy()}}]),e}(),$7jh4K=parcelRequire("7jh4K"),$4c948640eb8ef791$export$309483fcb6d5c7ca={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));for(var l=$81ac57466912ccc9$export$4300cf0a0df418a6(),h=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e){return e.curves(l.r,l.g,l.b)},selection:i.getSelection()}),c=[],u=0;u<n.length;u++)c.push({image:u===r?h.render:n[u].context.canvas,isVisible:n[u].isVisible,opacity:n[u].opacity,mixModeStr:n[u].mixModeStr,hasClipping:!1});var d=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:c},selection:i.getSelection()});(0,$7jh4K.css)(d.getElement(),{marginLeft:"-20px",marginRight:"-20px"});var p=new $81ac57466912ccc9$export$1c43bf66c2a2e4da({curves:l,callback:function(e){l=e,d.render()}}),f=p.getModeButtons();return a.append(p.getElement(),d.getElement()),s.destroy=function(){p.destroy(),f.destroy(),h.destroy(),d.destroy()},s.getInput=function(){return s.destroy(),{curves:l}},s},apply(e){var t=e.layer.context,i=e.input.curves,n=e.klHistory;return!!t&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.curves(i.r,i.g,i.b)},n)}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$6b01e1931d168e01$export$9b1b7b3985b9625a={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.fitInto(t.canvas.width,t.canvas.height,280,200,1),s=parseInt(""+a.width),o=parseInt(""+a.height),l=$eWjiX.BB.el(),h={element:l},c=!0,u=!1,d=!0,p=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-flip-horizontal")+" ",allowTab:!0,callback:function(e){c=e,b()},css:{marginBottom:"10px"},name:"flip-horizontal"}),f=new $365a915dfb503274$export$48513f6b9f8ce62d({init:u,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-flip-vertical")+" ",allowTab:!0,callback:function(e){u=e,b()},css:{marginBottom:"10px"},name:"flip-vertical"});l.append(p.getElement()),l.append(f.getElement());var g=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-flip-image")},{id:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-flip-layer")}],onChange:function(e){d=e,b()}});l.append(g.getElement());var v=$eWjiX.BB.el({className:"kl-preview-wrapper",css:{width:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.width+"px",height:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height+"px"}}),m={image:$eWjiX.BB.canvas(Math.round(s),Math.round(o)),isVisible:!0,opacity:1,mixModeStr:"source-over"},y=new $e6889b231e436752$export$e258ade1648009b7({width:Math.round(s),height:Math.round(o),layers:[m]}),x=$eWjiX.BB.el({className:"kl-preview-wrapper__canvas",css:{width:parseInt(""+s)+"px",height:parseInt(""+o)+"px"}});function b(){var e=$eWjiX.BB.ctx(m.image);e.save(),e.clearRect(0,0,m.image.width,m.image.height),d&&(c&&(e.translate(m.image.width,0),e.scale(-1,1)),u&&(e.translate(0,m.image.height),e.scale(1,-1)));for(var t=0;t<n.length;t++)n[t].isVisible&&(e.save(),!d&&r===t&&(c&&(e.translate(m.image.width,0),e.scale(-1,1)),u&&(e.translate(0,m.image.height),e.scale(1,-1))),e.canvas.width>n[t].context.canvas.width&&(e.imageSmoothingEnabled=!1),e.globalAlpha=n[t].opacity,e.globalCompositeOperation=n[t].mixModeStr,e.drawImage(n[t].context.canvas,0,0,m.image.width,m.image.height),e.restore());y.render(),e.restore()}return x.append(y.getElement()),v.append(x),setTimeout(b,0),l.append(v),h.destroy=function(){p.destroy(),f.destroy(),g.destroy(),y.destroy()},h.getInput=function(){return h.destroy(),{horizontal:c,vertical:u,flipCanvas:d}},h},apply(e){var t=e.layer.context,i=e.klCanvas,n=e.input.horizontal,r=e.input.vertical,a=e.input.flipCanvas;return!!t&&!!i&&(i.flip(n,r,a?void 0:(0,$7jh4K.throwIfNull)(i.getLayerIndex(t.canvas))),!0)}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$041c656037c77a96$export$2aa46bd5587f0eb={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l=0,h=0,c=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e){return e.hueSaturation(l,h)},selection:i.getSelection()}),u=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-hue-sat-hue"),width:300,height:30,min:-100,max:100,value:100*l,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){l=e/100,g.render()}}),d=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-hue-sat-saturation"),width:300,height:30,min:0,max:100,value:(h+1)*50,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){h=e/50-1,g.render()}});u.getElement().style.marginBottom="10px",d.getElement().style.marginBottom="10px",a.append(u.getElement(),d.getElement());for(var p=[],f=0;f<n.length;f++)p.push({image:f===r?c.render:n[f].context.canvas,isVisible:n[f].isVisible,opacity:n[f].opacity,mixModeStr:n[f].mixModeStr,hasClipping:!1});var g=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:p},selection:i.getSelection()});return g.render(),(0,$7jh4K.css)(g.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),a.append(g.getElement()),s.destroy=function(){u.destroy(),d.destroy(),c.destroy(),g.destroy()},s.getInput=function(){return s.destroy(),{hue:l,saturation:h}},s},apply(e){var t=e.layer.context,i=e.input.hue,n=e.klHistory,r=e.input.saturation;return!!t&&null!==i&&null!==r&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.hueSaturation(i,r)},n)}},$82b3d1ba61b3412f$export$b7ebcfbdc840ef76={apply(e){var t=e.layer.context,i=e.klHistory;return!!t&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.invert()},i)}},$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$8b4f5ae4fe73ff76$export$b1241e74876d9bbe=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.value=t.init,this.rootEl=$eWjiX.BB.el({className:"kl-2-tabs"}),this.leftTab=$eWjiX.BB.el({parent:this.rootEl,content:t.left,className:"kl-2-tabs__left"}),this.leftTab.onpointerdown=function(){return!1},this.rightTab=$eWjiX.BB.el({parent:this.rootEl,content:t.right,className:"kl-2-tabs__right"}),this.rightTab.onpointerdown=function(){return!1},this.update(),this.leftTab.onclick=function(){0!==i.value&&(i.value=0,i.update(),t.onChange(i.value))},this.rightTab.onclick=function(){1!==i.value&&(i.value=1,i.update(),t.onChange(i.value))}}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.leftTab.classList.toggle("kl-2-tabs--active",0===this.value),this.rightTab.classList.toggle("kl-2-tabs--active",1===this.value)}},{key:"getElement",value:function(){return this.rootEl}}]),e}();parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$7jh4K=parcelRequire("7jh4K"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$7jh4K=parcelRequire("7jh4K"),$1ca80fac51ad2a2d$var$SIZE=16,$1ca80fac51ad2a2d$export$87247fc399965417=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.value=(0,$cL71g._)({},t.value),this.transform={x:0,y:0,scale:1,angleDeg:0},this.rootEl=$eWjiX.BB.el({css:{width:$1ca80fac51ad2a2d$var$SIZE+"px",height:$1ca80fac51ad2a2d$var$SIZE+"px",backgroundColor:"#fff",border:"2px solid #000",borderRadius:$1ca80fac51ad2a2d$var$SIZE+"px",position:"absolute",cursor:"move",userSelect:"none",touchAction:"none"}}),this.pointerListener=new $eWjiX.BB.PointerListener({target:this.rootEl,onPointer:function(e){e.eventPreventDefault(),"left"===e.button&&"pointermove"===e.type&&(i.value.x+=e.dX/i.transform.scale,i.value.y+=e.dY/i.transform.scale,i.update(),t.onChange(i.value))}})}return(0,$7h4XF._)(e,[{key:"update",value:function(){var e=(0,$cdZRx.applyToPoint)($92816524e1b72be4$export$ad1d215dd03fe75a(this.transform),this.value);(0,$7jh4K.css)(this.rootEl,{left:e.x-$1ca80fac51ad2a2d$var$SIZE/2+"px",top:e.y-$1ca80fac51ad2a2d$var$SIZE/2+"px"})}},{key:"setTransform",value:function(e){JSON.stringify(this.transform)!==JSON.stringify(e)&&(this.transform=e,this.update())}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=(0,$cL71g._)({},e),this.update()}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.rootEl.remove(),this.pointerListener.destroy()}}]),e}(),$460859cbeb601dec$export$a76d798fa7d85e4e={getDialog(e){var t,i=e.context,n=e.klCanvas;if(!i||!n)return!1;var r=$042ba564475611dc$export$8f6817a932bf45cd(),a=n.getLayers(),s=n.getLayerIndex(i.canvas),o=$eWjiX.BB.el(),l={element:o};r||(l.width=$a433d11ad38d7c38$export$3a4a74a7d8c44e62.width);var h=(0,$7jh4K.throwIfNull)($02a74dc72797630f$export$8c4423af32b21158()),c=(0,$7jh4K.throwIfUndefined)(null==h?void 0:h.texture(i.canvas));function u(){v?h.draw(c).update():h.draw(c).perspective(g(p),g(f)).update(),b.render()}var d=[{x:0,y:0},{x:i.canvas.width,y:0},{x:i.canvas.width,y:i.canvas.height},{x:0,y:i.canvas.height}],p=d.map(function(e){return new $1ca80fac51ad2a2d$export$87247fc399965417({value:e,onChange:function(){u()}})});p.forEach(function(e){return e.getElement().style.display="none"});var f=d.map(function(e){return new $1ca80fac51ad2a2d$export$87247fc399965417({value:e,onChange:function(){u()}})});function g(e,t){return e.flatMap(function(e){var i=e.getValue();return t&&(i=(0,$cdZRx.applyToPoint)(t,i)),[i.x,i.y]})}var v=!1,m=new $8b4f5ae4fe73ff76$export$b1241e74876d9bbe({left:$8d7403abedf7cefa$export$ce37e184d908d785("compare-before"),right:$8d7403abedf7cefa$export$ce37e184d908d785("compare-after"),init:1,onChange:function(e){(v=0===e)?(p.forEach(function(e){return e.getElement().style.display="block"}),f.forEach(function(e){return e.getElement().style.display="none"})):(p.forEach(function(e,t){f[t].setValue(e.getValue())}),p.forEach(function(e){return e.getElement().style.display="none"}),f.forEach(function(e){return e.getElement().style.display="block"})),u()}});o.append(m.getElement());for(var y=[],x=0;x<a.length;x++)y.push({image:x===s?h:a[x].context.canvas,isVisible:a[x].isVisible,opacity:a[x].opacity,mixModeStr:a[x].mixModeStr,hasClipping:!1});var b=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(r),height:$a433d11ad38d7c38$export$94cffdbcf128864a(r),project:{width:i.canvas.width,height:i.canvas.height,layers:y},onTransformChange:function(e){p.forEach(function(t){return t.setTransform(e)}),f.forEach(function(t){return t.setTransform(e)})}});return(0,$7jh4K.css)(b.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),(t=b.getElement()).append.apply(t,(0,$bX4ja._)(p.map(function(e){return e.getElement()})).concat((0,$bX4ja._)(f.map(function(e){return e.getElement()})))),o.append(b.getElement()),u(),l.destroy=function(){b.destroy(),c.destroy(),p.forEach(function(e){return e.destroy()}),f.forEach(function(e){return e.destroy()})},l.getInput=function(){return l.destroy(),{before:g(p),after:g(f)}},l},apply(e){var t=e.layer.context,i=e.klHistory,n=e.input.before,r=e.input.after;if(!t||!n||!r)return!1;var a=$02a74dc72797630f$export$8c4423af32b21158();if(!a)return!1;var s=a.texture(t.canvas);a.draw(s).multiplyAlpha().perspective(n,r).unmultiplyAlpha().update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(a,0,0),s.destroy();var o=Object.fromEntries(e.klCanvas.getLayers().map(function(t){return t.id===e.layer.id?[t.id,{tiles:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.layer.canvas)}]:[t.id,{}]}));return i.push({layerMap:o}),!0}},$eWjiX=parcelRequire("eWjiX"),$10acd09ea053c7b9$exports={};$10acd09ea053c7b9$exports=$parcel$resolve("2BZYe");var $7jh4K=parcelRequire("7jh4K"),$63d62a20f3ba2c7d$export$5705240d31427a82={getDialog(e){var t=e.klCanvas;if(!t)return!1;var i=$eWjiX.BB.fitInto(t.getWidth(),t.getHeight(),280,200,1),n=parseInt(""+i.width),r=parseInt(""+i.height),a=n/t.getWidth(),s=t.getCompleteCanvas(1),o=$eWjiX.BB.el(),l={element:o},h=t.getWidth(),c=t.getHeight(),u=e.maxWidth,d=e.maxHeight,p=$eWjiX.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),f=$eWjiX.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),g=$eWjiX.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+u,value:""+t.getWidth()}}),v=$eWjiX.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+d,value:""+t.getHeight()}});g.onclick=function(){this.focus(),b=!0,T()},v.onclick=function(){this.focus(),x=!0,T()},g.onchange=function(){b=!0,T()},v.onchange=function(){x=!0,T()},p.append($8d7403abedf7cefa$export$ce37e184d908d785("width")+": ",g),f.append($8d7403abedf7cefa$export$ce37e184d908d785("height")+": ",v),$eWjiX.BB.el({css:{background:"url("+$parcel$interopDefault($10acd09ea053c7b9$exports)+") no-repeat 140px 5px",backgroundSize:"50px 52px"}}).append(p,f);var m=new Image;m.src=$parcel$interopDefault($10acd09ea053c7b9$exports),m.height=40;var y=$96366ef7b36c82a7$export$9852986a3ec5f6a0([[$8d7403abedf7cefa$export$ce37e184d908d785("width")+":&nbsp;",g,m],[$eWjiX.BB.el({css:{height:"5px"}}),"",""],[$8d7403abedf7cefa$export$ce37e184d908d785("height")+":&nbsp;",v]],{"0.2":{rowspan:3}});(0,$7jh4K.css)(y,{marginBottom:"10px"}),o.append(y);var x=!1,b=!1,w=t.getWidth()/t.getHeight();function k(){m.style.display=B?"":"none",B&&(g.value=""+t.getWidth(),v.value=""+t.getHeight(),T())}var B=!0,S=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("constrain-proportions"),allowTab:!0,callback:function(e){B=e,k()},name:"constrain-proportions"});o.append($eWjiX.BB.el({css:{clear:"both"}}));var C=new $7a3263857aacf58f$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-pixelated")]],title:$8d7403abedf7cefa$export$ce37e184d908d785("scaling-algorithm"),initValue:"smooth",onChange:function(){T()},name:"interpolation-algorithm"});$eWjiX.BB.el({parent:o,css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}).append(S.getElement(),C.getElement());var E=$eWjiX.BB.canvas(n,r);E.style.imageRendering="pixelated";var _=$eWjiX.BB.ctx(E);function I(){"smooth"===C.getValue()?(E.style.imageRendering=a>1?"pixelated":"",E.width=t.getWidth(),E.height=t.getHeight(),_.save(),_.imageSmoothingQuality="high",_.drawImage(s,0,0),$eWjiX.BB.resizeCanvas(E,h,c)):(E.style.imageRendering="pixelated",E.width=h,E.height=c,_.save(),_.imageSmoothingEnabled=!1,_.drawImage(s,0,0,E.width,E.height)),_.restore()}function T(){if(0===g.value.length&&b||0===v.value.length&&x){x=!1,b=!1;return}if(g.value=""+Math.max(1,parseInt(g.value)),v.value=""+Math.max(1,parseInt(v.value)),B&&(x&&(g.value=""+parseInt(""+parseInt(v.value)*w)),b&&(v.value=""+parseInt(""+parseInt(g.value)/w)),parseInt(g.value)>u||parseInt(v.value)>d)){var e=$eWjiX.BB.fitInto(parseInt(g.value),parseInt(v.value),u,d,1);g.value=""+parseInt(""+e.width),v.value=""+parseInt(""+e.height)}parseInt(g.value)>u&&(g.value=""+u),parseInt(v.value)>d&&(v.value=""+d),x=!1,b=!1,h=parseInt(g.value),c=parseInt(v.value);var t=$eWjiX.BB.fitInto(h,c,280,200,1),i=parseInt(""+t.width),n=parseInt(""+t.height);a=i/h;var r=$eWjiX.BB.centerWithin($a433d11ad38d7c38$export$ec2d17c6d3ae0768.width,$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height,i,n);I(),E.style.width=Math.max(1,i)+"px",E.style.height=Math.max(1,n)+"px",L.style.left=r.x+"px",L.style.top=r.y+"px",L.style.width=Math.max(1,i)+"px",L.style.height=Math.max(1,n)+"px"}var M=$eWjiX.BB.el({className:"kl-transparent-preview",css:{width:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.width+"px",height:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height+"px",marginLeft:"-20px",display:"table",marginTop:"10px",position:"relative",userSelect:"none",background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}}),L=$eWjiX.BB.el({parent:M,content:E,className:"kl-transparent-preview__canvas",css:{width:n+"px",height:r+"px",position:"absolute",overflow:"hidden"}});return o.append(M),T(),l.destroy=function(){S.destroy()},l.getInput=function(){return l.destroy(),{width:h,height:c,algorithm:C.getValue()}},l},apply(e){var t=e.klCanvas,i=e.input.width,n=e.input.height,r=e.input.algorithm;return!!t&&(t.resize(i,n,r),!0)}},$eWjiX=parcelRequire("eWjiX"),$878715182dcd377b$export$ac7e9efc751d5791={getDialog(e){var t=e.klCanvas;if(!t)return!1;var i=$eWjiX.BB.fitInto(t.getWidth(),t.getHeight(),280,200,1),n=parseInt(""+i.width),r=parseInt(""+i.height),a=n/t.getWidth(),s=$eWjiX.BB.canvas(n,r);s.style.display="block",$eWjiX.BB.ctx(s).drawImage(t.getCompleteCanvas(a),0,0,n,r);var o=$eWjiX.BB.el(),l={element:o},h=0;function c(){if(g.style.transform="rotate("+h+"deg)",90===Math.abs(h%180)){var e=parseInt(""+$eWjiX.BB.fitInto(r,n,280,200,1).height)/n;g.style.transform="rotate("+h+"deg) scale("+e+")"}}var u=$eWjiX.BB.el({tagName:"button",content:[$eWjiX.BB.el({tagName:"span",content:"",css:{fontSize:"1.3em"}})," 90"],onClick:function(){h-=90,c()},noRef:!0}),d=$eWjiX.BB.el({tagName:"button",content:[$eWjiX.BB.el({tagName:"span",content:"",css:{fontSize:"1.3em"}})," 90"],onClick:function(){h+=90,c()},noRef:!0,css:{marginLeft:"5px"}});o.append(u,d);var p=$eWjiX.BB.el({className:"kl-preview-wrapper",css:{width:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.width+"px",height:$a433d11ad38d7c38$export$ec2d17c6d3ae0768.height+"px",display:"table"}}),f=$eWjiX.BB.el({parent:p,css:{display:"table-cell",verticalAlign:"middle"}}),g=$eWjiX.BB.el({parent:f,content:s,className:"kl-preview-wrapper__canvas",css:{width:n+"px",height:r+"px",marginLeft:"auto",marginRight:"auto",overflow:"hidden",background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}});return g.style.transition="transform 0.2s ease-out",o.append(p),c(),l.destroy=function(){},l.getInput=function(){return l.destroy(),{deg:h}},l},apply(e){var t=e.klCanvas;return!!t&&(t.rotate(e.input.deg),!0)}},$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$7jh4K=parcelRequire("7jh4K"),$aa97ed406a9700f0$export$1b8796b18b7c19ed={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l=20,h=200,c={destroy:function(){}};function u(){y.render()}c=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e,t){d.setTransform(y.getTransform()),p.setTransform(y.getTransform());var i=$92816524e1b72be4$export$ad1d215dd03fe75a(t),n=(0,$cdZRx.applyToPoint)(i,d.getValue()),r=(0,$cdZRx.applyToPoint)(i,p.getValue());return e.multiplyAlpha().tiltShift(n.x,n.y,r.x,r.y,l*t.scaleX,h*t.scaleX).unmultiplyAlpha()},selection:i.getSelection()});var d=new $1ca80fac51ad2a2d$export$87247fc399965417({value:{x:t.canvas.width/4,y:t.canvas.height/2},onChange:function(){u()}}),p=new $1ca80fac51ad2a2d$export$87247fc399965417({value:{x:3*t.canvas.width/4,y:t.canvas.height/2},onChange:function(){u()}}),f=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-tilt-shift-gradient"),width:300,height:30,min:0,max:1e3,value:h,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){h=e,u()}});f.getElement().style.marginBottom="10px",a.append(f.getElement());var g=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-tilt-shift-blur"),width:300,height:30,min:0,max:200,value:l,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){l=e,u()}});g.getElement().style.marginBottom="10px",a.append(g.getElement());for(var v=[],m=0;m<n.length;m++)v.push({image:m===r?c.render:n[m].context.canvas,isVisible:n[m].isVisible,opacity:n[m].opacity,mixModeStr:n[m].mixModeStr,hasClipping:!1});var y=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:v},selection:i.getSelection()});return y.render(),(0,$7jh4K.css)(y.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),y.getElement().append(d.getElement(),p.getElement()),a.append(y.getElement()),s.destroy=function(){g.destroy(),f.destroy(),d.destroy(),p.destroy(),c.destroy(),y.destroy()},s.getInput=function(){return s.destroy(),{a:d.getValue(),b:p.getValue(),blur:l,gradient:h}},s},apply(e){var t=e.layer.context,i=e.klHistory,n=e.input.a,r=e.input.b,a=e.input.blur,s=e.input.gradient;return!!t&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.multiplyAlpha().tiltShift(n.x,n.y,r.x,r.y,a,s).unmultiplyAlpha()},i)}},$cL71g=parcelRequire("cL71g"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$esGm2=parcelRequire("esGm2"),$7jh4K=parcelRequire("7jh4K"),$9b3eo=parcelRequire("9b3eo");parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$1RMPr=parcelRequire("1RMPr"),$kFecW=parcelRequire("kFecW"),$kr2fR=parcelRequire("kr2fR"),$bbA6w=parcelRequire("bbA6w");function $31a0dd41d7428d32$var$getIsTransparentBg(e,t,i){return!e||(void 0!==i?i:t)}function $31a0dd41d7428d32$var$parseCssColor(e){if(e.startsWith("#")){var t=e.slice(1);3===t.length&&(t=t.split("").map(function(e){return e+e}).join("")),6===t.length&&(t+="ff");var i=parseInt(t,16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:(255&i)/255}}var n=e.match(/rgba?\(([^)]+)\)/);if(n){var r=(0,$8N5YG._)(n[1].split(",").map(function(e){return parseFloat(e.trim())}),4),a=r[0],s=r[1],o=r[2],l=r[3];return{r:a,g:s,b:o,a:void 0===l?1:l}}}function $31a0dd41d7428d32$export$d7a217b118c790a6(e){var t=!0,i=!1,n=void 0;try{for(var r,a=e.tiles[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;if((0,$esGm2.isLayerFill)(s)){var o=$31a0dd41d7428d32$var$parseCssColor(s.fill);if(o&&o.a<1)return!0}else for(var l=s.data.data,h=3;h<l.length;h+=4)if(l[h]<255)return!0}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}return!1}function $31a0dd41d7428d32$var$drawTransform(e,t,i,n,r,a,s,o){var l=e.canvas.width,h=e.canvas.height;if(e.save(),e.clearRect(0,0,l,h),e.save(),r){if(e.drawImage(t,0,0),!s){var c=(0,$9b3eo.getSelectionPath2d)(r);e.clip(c),e.globalCompositeOperation=o?"destination-out":"source-atop",e.fillStyle="white",e.fillRect(0,0,l,h)}}else o?s&&e.drawImage(t,0,0):(e.drawImage(t,0,0),s||(e.fillStyle="white",e.globalCompositeOperation="source-atop",e.fillRect(0,0,l,h)));if(e.restore(),r){var u,d,p=null!=a?a:{x:0,y:0,width:e.canvas.width,height:e.canvas.height};i||$eWjiX.BB.testShouldPixelate(n,n.width/p.width,n.height/p.height)?e.imageSmoothingEnabled=!1:(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high"),u=(0,$dZ59l.compose)((0,$kr2fR.translate)(n.x,n.y),(0,$1RMPr.rotate)(n.angleDeg/180*Math.PI),(0,$kFecW.scale)(n.width>0?1:-1,n.height>0?1:-1),(0,$kr2fR.translate)(-Math.abs(n.width)/2,-Math.abs(n.height)/2),(0,$kFecW.scale)(Math.abs(n.width/p.width),Math.abs(n.height/p.height)),(0,$kr2fR.translate)(-p.x,-p.y)),(d=e).setTransform.apply(d,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(u)));var f=(0,$9b3eo.getSelectionPath2d)(r);e.clip(f),e.drawImage(t,0,0)}else $eWjiX.BB.drawTransformedImageWithBounds(e,t,n,a,i);return e.restore(),u}var $31a0dd41d7428d32$export$dc15474d94cdc2b3={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=$042ba564475611dc$export$8f6817a932bf45cd(),r=i.getLayers(),a=(0,$7jh4K.throwIfNull)(i.getLayerIndex(t.canvas)),s=0===a,o=!1;s&&(o=$31a0dd41d7428d32$export$d7a217b118c790a6(Object.entries(e.composed.layerMap).find(function(e){var t=(0,$8N5YG._)(e,2);return(t[0],t[1]).index===a})[1]));var l=i.getSelection(),h=l?$4ae5c842364e8628$export$6be4733fa804854c(l,t):$eWjiX.BB.canvasBounds(t);if(!h)return{error:$8d7403abedf7cefa$export$ce37e184d908d785(l?"filter-transform-empty-selection":"filter-transform-empty")};var c={x:h.x+h.width/2,y:h.y+h.height/2,width:h.width,height:h.height,angleDeg:0},u=$eWjiX.BB.el(),d={element:u};n||(d.width=$a433d11ad38d7c38$export$3a4a74a7d8c44e62.width);var p=new $eWjiX.BB.KeyListener({onDown:function(e){$eWjiX.BB.isInputFocused(!0)||("left"===e&&(y.value=""+(parseFloat(y.value)-1),G()),"right"===e&&(y.value=""+(parseFloat(y.value)+1),G()),"up"===e&&(m.value=""+(parseFloat(m.value)-1),G()),"down"===e&&(m.value=""+(parseFloat(m.value)+1),G()))}}),f=$eWjiX.BB.el({css:{width:"100px",height:"30px",display:"inline-block"}}),g=$eWjiX.BB.el({css:{width:"100px",height:"30px",display:"inline-block"}}),v=$eWjiX.BB.el({css:{width:"150px",height:"30px",display:"inline-block"}}),m=$eWjiX.BB.el({tagName:"input"}),y=$eWjiX.BB.el({tagName:"input"}),x=$eWjiX.BB.el({tagName:"input"});m.type="number",y.type="number",x.type="number",y.style.width="70px",m.style.width="70px",x.style.width="70px",m.value="0",y.value="0",x.value="0",m.onclick=function(){m.focus(),G()},y.onclick=function(){y.focus(),G()},x.onclick=function(){x.focus(),G()},m.onchange=function(){G()},y.onchange=function(){G()},x.onchange=function(){G()},m.onkeyup=function(){G()},y.onkeyup=function(){G()},x.onkeyup=function(){G()},f.append("X: ",y),g.append("Y: ",m),v.append($8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-rotation")+": ",x),n||$eWjiX.BB.el({parent:u,css:{marginTop:"10px"}}).append(f,g,v);var b=$eWjiX.BB.el({parent:u,css:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",marginTop:"10px"}}),w=$eWjiX.BB.el({parent:b,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-flip")+" X",onClick:function(){var e=Y.getValue();Y.setSize(-e.width,e.height)}}),k=$eWjiX.BB.el({parent:b,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-flip")+" Y",onClick:function(){var e=Y.getValue();Y.setSize(e.width,-e.height)}}),B=$eWjiX.BB.el({parent:b,tagName:"button",content:"-90",onClick:function(){var e=Y.getValue();e.angleDeg-=90,e.angleDeg%=360,Y.setAngleDeg(e.angleDeg),x.value=""+Math.round(e.angleDeg),N()}}),S=$eWjiX.BB.el({parent:b,tagName:"button",content:"+90",onClick:function(){var e=Y.getValue();e.angleDeg+=90,e.angleDeg%=360,Y.setAngleDeg(e.angleDeg),x.value=""+Math.round(e.angleDeg),N()}}),C=$eWjiX.BB.el({parent:b,tagName:"button",content:"2&times;",onClick:function(){var e=Y.getValue();A.getValue()?Y.setSize((e.width<0?-1:1)*Y.getRatio()*Math.abs(e.height)*2,2*e.height):Y.setSize(2*e.width,2*e.height)}}),E=$eWjiX.BB.el({parent:b,tagName:"button",content:"&frac12;&times;",onClick:function(){var e=Y.getValue();Y.setSize(Math.round(e.width/2),Math.round(e.height/2))}}),_=$eWjiX.BB.el({parent:b,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("center"),onClick:function(){var e=Y.getValue();Y.setPos({x:t.canvas.width/2,y:t.canvas.height/2}),Y.setAngleDeg(e.angleDeg),N()}}),I=!1,T=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!1,label:$8d7403abedf7cefa$export$ce37e184d908d785("select-transform-clone"),allowTab:!0,callback:function(e){I=e,N(!0)},css:{display:"inline-block"},name:"clone-before-transforming"}),M=$31a0dd41d7428d32$var$getIsTransparentBg(s,o,$31a0dd41d7428d32$var$preferenceIsTransparentBg),L=!1,R=new $365a915dfb503274$export$48513f6b9f8ce62d({init:M,label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-eraser-transparent-bg"),allowTab:!0,callback:function(e){L=!0,M=e,N(!0)},css:{display:"inline-block"},name:"transparent-background"});b.append(T.getElement()),s&&b.append(R.getElement());var P=!0,A=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-constrain"),title:$8d7403abedf7cefa$export$ce37e184d908d785("constrain-proportions"),allowTab:!0,callback:function(e){P=e,Y.setIsConstrained(P)},css:{display:"inline-block"},name:"constrain-proportions"}),D=!1,O=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-snap"),title:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-snap-title"),allowTab:!0,callback:function(e){D=e,Y.setSnapping(D)},css:{display:"inline-block",marginLeft:"10px"},name:"enable-snapping"}),z=$eWjiX.BB.el();z.append(A.getElement(),O.getElement()),u.append($eWjiX.BB.el({css:{clear:"both",height:"10px"}}));var H=$eWjiX.BB.el({parent:u,css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),j=new $7a3263857aacf58f$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",title:$8d7403abedf7cefa$export$ce37e184d908d785("scaling-algorithm"),onChange:function(){N(!0)},name:"interpolation-algorithm"});H.append(z,j.getElement());for(var F=$eWjiX.BB.canvas(t.canvas.width,t.canvas.height),X=[],V=0;V<r.length;V++)X.push({image:V===a?F:r[V].context.canvas,isVisible:r[V].isVisible,opacity:r[V].opacity,mixModeStr:r[V].mixModeStr,hasClipping:!1});var U=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(n),height:$a433d11ad38d7c38$export$94cffdbcf128864a(n),project:{width:t.canvas.width,height:t.canvas.height,layers:X},hasEditMode:!0,onModeChange:function(e){Y.getElement().style.pointerEvents="edit"===e?"":"none",Y.getElement().style.opacity="edit"===e?"":"0.5"},onTransformChange:function(e){Y.setViewportTransform(e)},padding:30});U.render(),(0,$7jh4K.css)(U.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),u.append(U.getElement());var W="";function N(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Y){var t=Y.getValue();if(JSON.stringify(t)!==W||e){W=JSON.stringify(t);var i=$eWjiX.BB.ctx(F);$31a0dd41d7428d32$var$drawTransform(i,r[a].context.canvas,"pixelated"===j.getValue(),t,l,h,I,M||a>0),U.render()}}}var Y=new $0370167ee97a20d9$export$79a74567acf241b0({x:c.x,y:c.y,width:c.width,height:c.height,angleDeg:c.angleDeg,isConstrained:!0,snapX:[0,t.canvas.width],snapY:[0,t.canvas.height],callback:function(e){y.value=""+Math.round(e.x-c.x),m.value=""+Math.round(e.y-c.y),x.value=""+Math.round(e.angleDeg),N()},viewportTransform:U.getTransform()});function G(){Y.setPos({x:parseInt(y.value)+c.x,y:parseInt(m.value)+c.y}),Y.setAngleDeg(parseInt(x.value)),N()}return(0,$7jh4K.css)(Y.getElement(),{position:"absolute",left:"0",top:"0"}),U.getElement().append(Y.getElement()),N(),d.destroy=function(){p.destroy(),Y.destroy(),A.destroy(),O.destroy(),$eWjiX.BB.destroyEl(w),$eWjiX.BB.destroyEl(k),$eWjiX.BB.destroyEl(B),$eWjiX.BB.destroyEl(S),$eWjiX.BB.destroyEl(C),$eWjiX.BB.destroyEl(E),$eWjiX.BB.destroyEl(_),U.destroy(),$eWjiX.BB.freeCanvas(F)},d.getInput=function(){var e=Y.getValue();L&&($31a0dd41d7428d32$var$preferenceIsTransparentBg=M);var t={transform:e,bounds:h,isPixelated:"pixelated"===j.getValue(),doClone:I,isTransparentBg:M};return d.destroy(),$eWjiX.BB.copyObj(t)},d},apply(e){var t=e.layer.context,i=e.klHistory;if(!t)return!1;i.pause(!0);var n=e.input,r=e.klCanvas.getLayerIndex(t.canvas),a=$eWjiX.BB.copyCanvas(t.canvas),s=e.klCanvas.getSelection(),o=$31a0dd41d7428d32$var$drawTransform(t,a,n.isPixelated,n.transform,s,n.bounds,n.doClone,n.isTransparentBg||r>0);s&&o&&(s=(0,$bbA6w.transformMultiPolygon)(s,o),e.klCanvas.setSelection(s)),i.pause(!1);var l=Object.fromEntries(e.klCanvas.getLayers().map(function(t){return t.id===e.layer.id?[t.id,{tiles:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.layer.canvas)}]:[t.id,{}]}));return i.push((0,$cL71g._)({layerMap:l},s?{selection:{value:s}}:void 0)),!0}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$95b95646154e8218$export$55e7eb2ebd0db869={getDialog(e){var t=e.klCanvas,i=e.context;if(!t||!i)return!1;var n=t.getLayers(),r=t.getLayerIndex(i.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l=10,h=new $14b90ba44af68d49$export$94ec999f33a691e3({original:i.canvas,onUpdate:function(e,t){return e.multiplyAlpha().triangleBlur(l*t.scaleX).unmultiplyAlpha()},selection:t.getSelection()}),c=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("radius"),width:300,height:30,min:1,max:200,value:l,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){l=e,p.render()}});c.getElement().style.marginBottom="10px",a.append(c.getElement());for(var u=[],d=0;d<n.length;d++)u.push({image:d===r?h.render:n[d].context.canvas,isVisible:n[d].isVisible,opacity:n[d].opacity,mixModeStr:n[d].mixModeStr,hasClipping:!1});var p=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:i.canvas.width,height:i.canvas.height,layers:u},selection:t.getSelection()});return p.render(),(0,$7jh4K.css)(p.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),a.append(p.getElement()),s.destroy=function(){c.destroy(),h.destroy(),p.destroy()},s.getInput=function(){return s.destroy(),{radius:l}},s},apply(e){var t=e.layer.context,i=e.klHistory,n=e.input.radius;return!!t&&!!n&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.multiplyAlpha().triangleBlur(n).unmultiplyAlpha()},i)}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$82f12ab116cea855$export$62ac74a5ea43bd5c={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l=2,h=.51,c=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e,t){return e.unsharpMask(l*t.scaleX,h)},selection:i.getSelection()});function u(){v.render()}var d=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("radius"),width:300,height:30,min:0,max:200,value:2,onChange:function(e){l=e,u()},curve:[[0,0],[.1,2],[.5,50],[1,200]]}),p=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-unsharp-mask-strength"),width:300,height:30,min:0,max:50,value:5.1,onChange:function(e){h=e/10,u()},curve:[[0,0],[.1,2],[.5,10],[1,50]]});d.getElement().style.marginBottom="10px",p.getElement().style.marginBottom="10px",a.append(d.getElement()),a.append(p.getElement());for(var f=[],g=0;g<n.length;g++)f.push({image:g===r?c.render:n[g].context.canvas,isVisible:n[g].isVisible,opacity:n[g].opacity,mixModeStr:n[g].mixModeStr,hasClipping:!1});var v=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:f},selection:i.getSelection()});return u(),(0,$7jh4K.css)(v.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),a.append(v.getElement()),s.destroy=function(){d.destroy(),p.destroy(),c.destroy(),v.destroy()},s.getInput=function(){return s.destroy(),{radius:l,strength:h}},s},apply(e){var t=e.layer.context,i=e.klHistory,n=e.input.radius,r=e.input.strength;return!!t&&null!==n&&null!==r&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.unsharpMask(n,r)},i)}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$a535e7a374deb8f5$export$6158ed2b22ebf4d9={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=i.getLayerIndex(t.canvas),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e){return e.toAlpha("inverted-luminance"===h,u)},selection:i.getSelection()}),h="inverted-luminance",c=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"inverted-luminance",label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-to-alpha-inverted-lum")},{id:"luminance",label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-to-alpha-lum")}],initId:h,onChange:function(e){h=e,v.render()}});a.append(c.getElement());var u={r:0,g:0,b:0,a:1},d=[null,{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1},{r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1},{r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1}],p=new $4db8cbbb01889095$export$24ba9b81662d4366({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-to-alpha-replace"),colorArr:d,initialIndex:1,onChange:function(e){u=e,v.render()},css:{margin:"10px 0"}});a.append(p.getElement());for(var f=[],g=0;g<n.length;g++)f.push({image:g===r?l.render:n[g].context.canvas,isVisible:n[g].isVisible,opacity:n[g].opacity,mixModeStr:n[g].mixModeStr,hasClipping:!1});var v=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:f},selection:i.getSelection()});return v.render(),(0,$7jh4K.css)(v.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),a.append(v.getElement()),s.destroy=function(){c.destroy(),p.destroy(),l.destroy(),v.destroy()},s.getInput=function(){return s.destroy(),{sourceId:h,selectedRgbaObj:u}},s},apply(e){var t=e.layer.context,i=e.klHistory,n=e.input.sourceId,r=e.input.selectedRgbaObj;return!!t&&!!n&&$670db093f8076d2c$export$66c6ccb6bcae2c94(t,e.klCanvas.getSelection(),function(e){e.toAlpha("inverted-luminance"===n,r)},i)}},$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW");function $74df8e8cd35bce4e$export$20d2db9c68afeac(e,t,i,n,r,a){e.save();var s=e.canvas.width,o=e.canvas.height,l=(n=Math.round(n))%2==0;e.beginPath(),e.lineWidth=n,e.strokeStyle=r,e.globalAlpha=a;for(var h=0;h<t-1;h++){var c=s/t*(h+1);c=l?Math.round(c):Math.round(c+.5)-.5,e.moveTo(c,0),e.lineTo(c,o)}for(var u=0;u<i-1;u++){var d=o/i*(u+1);d=l?Math.round(d):Math.round(d+.5)-.5,e.moveTo(0,d),e.lineTo(s,d)}e.stroke(),e.restore()}var $7jh4K=parcelRequire("7jh4K"),$bad33651972f8d2c$export$50020de79e1bc23={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=(0,$7jh4K.throwIfNull)(i.getLayerIndex(t.canvas)),a=$eWjiX.BB.el(),s={element:a},o=$042ba564475611dc$export$8f6817a932bf45cd();o||(s.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(o));var l={x:2,y:2,thickness:8,color:"#000",opacity:1},h=$eWjiX.BB.el({parent:a,css:{display:"flex",alignItems:"center"}}),c=$eWjiX.BB.el({parent:a,css:{display:"flex",alignItems:"center",marginTop:"10px",marginBottom:"10px"}}),u=(0,$dJPtW.input)({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(e){l.x=parseFloat(e),k()}}),d=(0,$dJPtW.input)({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(e){l.y=parseFloat(e),k()}}),p=(0,$dJPtW.input)({init:l.thickness,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(e){l.thickness=parseFloat(e),k()}}),f={r:0,g:0,b:0,a:1},g=[{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];g.push({r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1}),g.push({r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1}),l.color=$eWjiX.BB.ColorConverter.toRgbStr(f);var v=new $4db8cbbb01889095$export$24ba9b81662d4366({label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-stroke"),colorArr:g,onChange:function(e){f=e,l.color=$eWjiX.BB.ColorConverter.toRgbStr(f),k()}}),m={display:"inline-block",marginRight:"5px"};h.append($eWjiX.BB.el({content:"X:",css:m}),u,$eWjiX.BB.el({content:"Y:",css:m}),d),c.append($eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("shape-line-width")+":",css:m}),p,$eWjiX.BB.el({css:{flexGrow:"1"}}),v.getElement());var y=$eWjiX.BB.canvas(t.canvas.width,t.canvas.height),x=$eWjiX.BB.ctx(y),b=n.map(function(e,t){return{image:t===r?y:e.context.canvas,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr,hasClipping:!1}}),w=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(o),height:$a433d11ad38d7c38$export$94cffdbcf128864a(o),project:{width:t.canvas.width,height:t.canvas.height,layers:b}});function k(){var e=x;e.save(),e.clearRect(0,0,y.width,y.height),e.drawImage(t.canvas,0,0),$74df8e8cd35bce4e$export$20d2db9c68afeac(e,l.x,l.y,Math.max(l.thickness,1),l.color,l.opacity),e.restore(),w.render()}return(0,$7jh4K.css)(w.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),a.append(w.getElement()),k(),w.render(),s.destroy=function(){w.destroy(),$eWjiX.BB.freeCanvas(y),v.destroy()},s.getInput=function(){return s.destroy(),$eWjiX.BB.copyObj(l)},s},apply(e){var t=e.layer.context,i=e.klCanvas,n=e.klHistory;if(!t||!i)return!1;$74df8e8cd35bce4e$export$20d2db9c68afeac(t,e.input.x,e.input.y,e.input.thickness,e.input.color,e.input.opacity);var r=Object.fromEntries(e.klCanvas.getLayers().map(function(t){return t.id===e.layer.id?[t.id,{tiles:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.layer.canvas)}]:[t.id,{}]}));return n.push({layerMap:r}),!0}},$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$dJ1E2=parcelRequire("dJ1E2"),$7jh4K=parcelRequire("7jh4K"),$eIcQa=parcelRequire("eIcQa"),$eg83P=parcelRequire("eg83P"),$595c9469b8f94062$var$presetArr=[{type:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0,octaves:1,samples:1,peaks:0,brightness:0,contrast:0,isReversed:!0},{type:1,scaleX:166,scaleY:164,offsetX:105,offsetY:30,octaves:6,samples:1,peaks:0,brightness:.055,contrast:.23,isReversed:!0},{type:1,scaleX:235,scaleY:190,offsetX:3227,offsetY:2156,octaves:4,samples:16,peaks:22,brightness:-.375,contrast:1,isReversed:!1},{type:1,scaleX:40,scaleY:40,offsetX:0,offsetY:0,octaves:1,samples:1,peaks:0,brightness:0,contrast:0,isReversed:!1},{type:0,scaleX:26,scaleY:26,offsetX:557,offsetY:365,octaves:1,samples:1,peaks:0,brightness:.02,contrast:1,isReversed:!0},{type:1,scaleX:1500,scaleY:1500,offsetX:745,offsetY:2871,octaves:5,samples:16,peaks:156.02,brightness:.03,contrast:1,isReversed:!0},{type:1,scaleX:11,scaleY:11,offsetX:2940,offsetY:2045,octaves:1,samples:16,peaks:1,brightness:-.045,contrast:1,isReversed:!0},{type:2,scaleX:74,scaleY:74,offsetX:4816,offsetY:1304,octaves:3,samples:1,peaks:2.78,brightness:0,contrast:0,isReversed:!1}];function $595c9469b8f94062$var$createNoiseSettings(e){var t=$eWjiX.BB.copyObj($595c9469b8f94062$var$presetArr[e.presetIndex]);return t.seed=e.seed,t.scaleX=t.scaleX*e.scale/50,t.scaleY=t.scaleY*e.scale/50,t.colA=e.colA,t.colB=e.colB,t.isReversed=e.isReversed?!t.isReversed:t.isReversed,t.channels=e.channels,t}function $595c9469b8f94062$var$createNoiseParameters(e){return[e.seed,e.type,[e.scaleX,e.scaleY],[e.offsetX,e.offsetY],e.octaves,e.samples,e.peaks,e.brightness,e.contrast,e.isReversed,e.colA,e.colB,e.channels?e.channels:"rgb"]}var $595c9469b8f94062$export$1dab0536099042f5={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=(0,$7jh4K.throwIfNull)(i.getLayerIndex(t.canvas)),a=[],s=32,o=(0,$7jh4K.throwIfNull)($02a74dc72797630f$export$8c4423af32b21158()),l=$eWjiX.BB.canvas(s,s),h=$eWjiX.BB.ctx(l),c=o.texture(l);o.draw(c).update(),c.destroy(),$595c9469b8f94062$var$presetArr.forEach(function(e){var t,i=new Image,n=$eWjiX.BB.copyObj(e);n.scaleX/=10,n.scaleY/=10,(t=o).noise.apply(t,(0,$bX4ja._)($595c9469b8f94062$var$createNoiseParameters(n))).update(),h.drawImage(o,0,0),i.src=l.toDataURL("image/png"),a.push(i)}),c.destroy();var u=$eWjiX.BB.el(),d={element:u},p=$042ba564475611dc$export$8f6817a932bf45cd();p||(d.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(p));var f={seed:300*Math.random(),presetIndex:0,scale:50,opacity:.5,isReversed:!1,channels:"rgb",mixModeStr:"source-over",colA:{r:0,g:0,b:0},colB:{r:255,g:255,b:255}},g=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:a.map(function(e,t){return(0,$7jh4K.css)(e,{margin:"1px",borderRadius:"3px",transition:"all 0.1s ease-in-out"}),{id:""+t,label:e}}),initId:"0",onChange:function(e){f.presetIndex=Number(e),L()},css:{marginBottom:"10px"}});u.append(g.getElement());var v=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-noise-scale"),width:300,height:30,min:1,max:1e3,value:f.scale,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,curve:$eWjiX.BB.powerSplineInput(1,1e3,.1),onChange:function(e){f.scale=e,L()}});v.getElement().style.marginBottom="10px";var m=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("opacity"),width:300,height:30,min:.01,max:1,value:f.opacity,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,toValue:function(e){return e/100},toDisplayValue:function(e){return 100*e},onChange:function(e){f.opacity=e,L()}});m.getElement().style.marginBottom="10px";var y=$eWjiX.BB.el({css:{display:"flex",alignItems:"center",marginBottom:"10px"}}),x=$eWjiX.BB.el({css:{display:"flex",marginBottom:"10px"}}),b=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"rgb",label:"RGB"},{id:"alpha",label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-noise-alpha")}],initId:"rgb",onChange:function(e){f.channels=e,"rgb"===e?x.style.visibility="":x.style.visibility="hidden",L()}}),w=new $365a915dfb503274$export$48513f6b9f8ce62d({label:$8d7403abedf7cefa$export$ce37e184d908d785("reverse"),callback:function(e){f.isReversed=e,L()},allowTab:!0,name:"reverse-gradient"}),k=new $7a3263857aacf58f$export$ef9b1a59e592288f({isFocusable:!0,optionArr:["source-over",void 0,"darken","multiply","color-burn",void 0,"lighten","screen","color-dodge",void 0,"overlay","soft-light","hard-light",void 0,"difference","exclusion",void 0,"hue","saturation","color","luminosity"].map(function(e){return e?[e,$2f1281ced73ab1dc$export$6e1bedb2a6cdff30(e)]:void 0}),initValue:f.mixModeStr,onChange:function(e){f.mixModeStr=e,L()},name:"blend-mode"});k.getElement().title=$8d7403abedf7cefa$export$ce37e184d908d785("layers-blending");var B=$eWjiX.BB.el({css:{display:"flex"}}),S={width:"34px",height:"34px",marginRight:"5px"},C=$9cbe98d1fb398012$export$6e4a713ddcda1e5e.input({type:"color",init:"#"+$dJ1E2.ColorConverter.toHexString(f.colA),callback:function(e){var t=$dJ1E2.ColorConverter.hexToRGB(e);t&&(f.colA=t,L())},css:S}),E=$9cbe98d1fb398012$export$6e4a713ddcda1e5e.input({type:"color",init:"#"+$dJ1E2.ColorConverter.toHexString(f.colB),callback:function(e){var t=$dJ1E2.ColorConverter.hexToRGB(e);t&&(f.colB=t,L())},css:S});B.append(C,E),y.append(b.getElement(),$eWjiX.BB.el({css:{flexGrow:"1"}}),w.getElement()),x.append(k.getElement(),$eWjiX.BB.el({css:{flexGrow:"1"}}),B),u.append(v.getElement(),m.getElement(),y,x);for(var _=new $14b90ba44af68d49$export$94ec999f33a691e3({original:t.canvas,onUpdate:function(e,i){var n,r=$595c9469b8f94062$var$createNoiseSettings(f);return r.scaleX*=i.scaleX,r.scaleY*=i.scaleY,r.offsetX=t.canvas.width/2*i.scaleX+i.x,r.offsetY=t.canvas.height/2*i.scaleY+i.y,(n=e).noise.apply(n,(0,$bX4ja._)($595c9469b8f94062$var$createNoiseParameters(r)))},postMix:{opacity:f.opacity,operation:"alpha"===f.channels?"destination-out":f.mixModeStr},selection:i.getSelection(),isMaskingWithEmptyOriginal:!0}),I=[],T=0;T<n.length;T++)I.push({image:T===r?_.render:n[T].context.canvas,isVisible:n[T].isVisible,opacity:n[T].opacity,mixModeStr:n[T].mixModeStr,hasClipping:!1});var M=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(p),height:$a433d11ad38d7c38$export$94cffdbcf128864a(p),project:{width:t.canvas.width,height:t.canvas.height,layers:I},selection:i.getSelection()});function L(){_.setPostMix({opacity:f.opacity,operation:"alpha"===f.channels?"destination-out":f.mixModeStr}),M.render()}return M.render(),(0,$7jh4K.css)(M.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),u.append(M.getElement()),d.destroy=function(){g.destroy(),v.destroy(),m.destroy(),w.destroy(),b.destroy(),k.destroy(),M.destroy(),_.destroy()},d.getInput=function(){return d.destroy(),$eWjiX.BB.copyObj(f)},d},apply(e){var t=e.layer.context,i=e.klCanvas,n=e.klHistory;if(!t||!i)return!1;var r=$02a74dc72797630f$export$8c4423af32b21158();if(!r)return!1;var a=e.input,s=i.getSelection();if(s){var o=$eWjiX.BB.canvas(t.canvas.width,t.canvas.height),l=$eWjiX.BB.ctx(o);(0,$eIcQa.drawSelectionMask)(s,l),h=r.texture(o),$eWjiX.BB.freeCanvas(o)}r.initialize(t.canvas.width,t.canvas.height);var h,c,u=$595c9469b8f94062$var$createNoiseSettings(a);return u.offsetX=t.canvas.width/2,u.offsetY=t.canvas.height/2,(c=r).noise.apply(c,(0,$bX4ja._)($595c9469b8f94062$var$createNoiseParameters(u))).update(),h&&(r.multiplyAlpha().mask(h).unmultiplyAlpha(),h.destroy()),r.update(),t.save(),t.globalAlpha=a.opacity,"alpha"===a.channels?t.globalCompositeOperation="destination-out":t.globalCompositeOperation=a.mixModeStr,t.drawImage(r,0,0),t.restore(),n.push($5bc59effccf14376$export$263fa670dc037098(n.getComposed(),$1a6c9997bc8182ff$export$7b1ba44282f9a519(t.canvas,s?(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(s)):void 0))),!0}},$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$7jh4K=parcelRequire("7jh4K");function $ebbf7e5d844153e5$var$drawPattern(e,t){var i=t.blend?Math.round(t.blend*t.width/2):0,n=t.blend?Math.round(t.blend*t.height/2):0,r=$eWjiX.BB.canvas(t.width,t.height);if(t.blend){var a=$eWjiX.BB.canvas(2*t.width,2*t.height),s=$eWjiX.BB.ctx(a),o="#0000",l="#000";s.drawImage(e.canvas,-t.x+i,-t.y+n),s.save();var h=s.createLinearGradient(0,t.height,0,2*t.height);h.addColorStop(0,l),h.addColorStop(t.blend,o),s.globalCompositeOperation="destination-in",s.fillStyle=h,s.fillRect(0,0,a.width,a.height),s.restore(),s.save(),(h=s.createLinearGradient(0,0,0,t.height)).addColorStop(0,o),h.addColorStop(t.blend,l),s.globalCompositeOperation="destination-in",s.fillStyle=h,s.fillRect(0,0,2*t.width,2*t.height),s.restore(),s.save(),s.globalCompositeOperation="lighter",s.drawImage(a,0,-t.height),s.restore(),s.save(),(h=s.createLinearGradient(t.width,0,2*t.width,0)).addColorStop(0,l),h.addColorStop(t.blend,o),s.globalCompositeOperation="destination-in",s.fillStyle=h,s.fillRect(0,0,a.width,a.height),s.restore(),s.save(),(h=s.createLinearGradient(0,0,t.width,0)).addColorStop(0,o),h.addColorStop(t.blend,l),s.globalCompositeOperation="destination-in",s.fillStyle=h,s.fillRect(0,0,2*t.width,2*t.height),s.restore(),s.save(),s.globalCompositeOperation="lighter",s.drawImage(a,-t.width,0),s.restore(),$eWjiX.BB.ctx(r).drawImage(a,0,0)}else $eWjiX.BB.ctx(r).drawImage(e.canvas,-t.x,-t.y);e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.translate(t.offsetX-i,t.offsetY-n),e.fillStyle=(0,$7jh4K.throwIfNull)(e.createPattern(r,"repeat")),e.fillRect(-t.offsetX+i,-t.offsetY+n,e.canvas.width,e.canvas.height),e.restore()}var $ebbf7e5d844153e5$export$5b48b77a483d9b33={getDialog(e){var t,i=$042ba564475611dc$export$8f6817a932bf45cd(),n=1024,r=$eWjiX.BB.el(),a=e.context,s=a.canvas.width,o=a.canvas.height,l={x:0,y:0,width:s<=250?Math.round(s/4):200,height:o<=250?Math.round(o/4):200,blend:0,offsetX:0,offsetY:0},h=$eWjiX.BB.canvasBounds(a);h&&h.width<=n&&h.height<=n&&(h.width<.75*s||h.height<.75*o)?(l.x=h.x,l.y=h.y,l.width=h.width,l.height=h.height):(l.x=Math.round(s/2-l.width/2),l.y=Math.round(o/2-l.height/2));var c=(0,$dJPtW.input)({init:l.x,type:"number",min:0,max:s,css:{width:"100%"},callback:function(e){l.x=Number(e),j()}}),u=(0,$dJPtW.input)({init:l.y,type:"number",min:0,max:o,css:{width:"100%"},callback:function(e){l.y=Number(e),j()}}),d=(0,$dJPtW.input)({init:l.width,type:"number",min:1,max:Math.min(n,s),css:{width:"100%"},callback:function(e){l.width=Number(e),j()}}),p=(0,$dJPtW.input)({init:l.height,type:"number",min:1,max:Math.min(n,o),css:{width:"100%"},callback:function(e){l.height=Number(e),j()}}),f={marginLeft:"5px",flex:"1"};r.append($eWjiX.BB.el({content:[$eWjiX.BB.el({tagName:"label",content:["X:",c],css:f}),$eWjiX.BB.el({tagName:"label",content:["Y:",u],css:f}),$eWjiX.BB.el({tagName:"label",content:[$8d7403abedf7cefa$export$ce37e184d908d785("width")+":",d],css:f}),$eWjiX.BB.el({tagName:"label",content:[$8d7403abedf7cefa$export$ce37e184d908d785("height")+":",p],css:f})],css:{display:"flex",marginLeft:"-5px"}}));var g=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-blending"),width:300,height:30,min:0,max:1,value:l.blend,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){l.blend=e,j()},formatFunc:function(e){return $eWjiX.BB.round(e,2)},manualInputRoundDigits:2});(0,$7jh4K.css)(g.getElement(),{margin:"10px 0"}),r.append(g.getElement());var v=1,m=new $8b4f5ae4fe73ff76$export$b1241e74876d9bbe({left:$8d7403abedf7cefa$export$ce37e184d908d785("compare-before"),right:$8d7403abedf7cefa$export$ce37e184d908d785("compare-after"),init:v,onChange:function(e){v=e,M.style.display=0===e?"block":"none",j(!0)}});r.append(m.getElement());var y=e.klCanvas,x=y.getLayers(),b=(0,$7jh4K.throwIfNull)(y.getLayerIndex(a.canvas)),w=$eWjiX.BB.fitInto(a.canvas.width,a.canvas.height,i?280:490,i?200:240,1),k=parseInt(""+w.width),B=parseInt(""+w.height),S=Math.min(k,a.canvas.width),C=Math.min(B,a.canvas.height),E=k/a.canvas.width,_=$eWjiX.BB.el({className:"kl-preview-wrapper",css:{width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(i)+"px",height:$a433d11ad38d7c38$export$94cffdbcf128864a(i)+"px",marginTop:"0"}}),I={image:$eWjiX.BB.canvas(S,C),isVisible:x[b].isVisible,opacity:x[b].opacity,mixModeStr:x[b].mixModeStr},T=new $e6889b231e436752$export$e258ade1648009b7({width:Math.round(k),height:Math.round(B),layers:x.map(function(e,t){return t===b?I:{image:e.context.canvas,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr}})}),M=$eWjiX.BB.canvas(k,B);(0,$7jh4K.css)(M,{position:"absolute",left:"0",top:"0",mixBlendMode:"difference",imageRendering:"pixelated"});var L=$eWjiX.BB.el({className:"kl-preview-wrapper__canvas",css:{width:parseInt(""+k)+"px",height:parseInt(""+B)+"px"}});L.append(T.getElement(),M),_.append(L),r.append(_);var R={};function P(){c.value=""+l.x,u.value=""+l.y,d.value=""+l.width,p.value=""+l.height}var A=new $eWjiX.BB.KeyListener({});_.oncontextmenu=function(){return!1},L.style.touchAction="none";var D=new $eWjiX.BB.PointerListener({target:L,onPointer:function(e){if(0===v)if("pointerdown"===e.type){if(!R.state){R.oldSettings=$eWjiX.BB.copyObj(l);var t=e.relX/E,i=e.relY/E;$eWjiX.BB.isInsideRect({x:t,y:i},{x:l.x,y:l.y,width:l.width,height:l.height})?R.state="move":R.state="select",R.start={x:t,y:i}}}else if("pointermove"===e.type){var r=e.relX/E,a=e.relY/E;if("select"===R.state){R.end={x:r,y:a};var h=Math.max(0,Math.min(R.start.x,R.end.x)),c=Math.max(0,Math.min(R.start.y,R.end.y)),u=Math.min(s,Math.max(R.start.x,R.end.x)),d=Math.min(o,Math.max(R.start.y,R.end.y));l.x=Math.floor(h),l.y=Math.floor(c),l.width=Math.min(n,Math.ceil(u-l.x)),l.height=Math.min(n,Math.ceil(d-l.y)),A.isPressed("shift")&&(l.width=Math.min(l.width,l.height),l.height=Math.min(l.width,l.height)),(0===l.width||0===l.height)&&(l=$eWjiX.BB.copyObj(R.oldSettings)),P(),j()}else if("move"===R.state){var p=Math.round(r-R.start.x),f=Math.round(a-R.start.y);l.x=$eWjiX.BB.clamp(R.oldSettings.x+p,0,s-l.width),l.y=$eWjiX.BB.clamp(R.oldSettings.y+f,0,o-l.height),P(),j()}}else"pointerup"===e.type&&R.state&&(R.state=null);else"pointerdown"===e.type?R.state||(R.state="move",R.oldSettings=$eWjiX.BB.copyObj(l),R.start={x:e.relX/E,y:e.relY/E},R.end=null):"pointermove"===e.type?R.state&&(R.end={x:e.relX/E,y:e.relY/E},l.offsetX=Math.round(R.end.x-R.start.x)+R.oldSettings.offsetX,l.offsetY=Math.round(R.end.y-R.start.y)+R.oldSettings.offsetY,j()):"pointerup"===e.type&&R.state&&(R.end||(l.offsetX=0,l.offsetY=0,j()),R.state=null)}}),O=$eWjiX.BB.canvas(s,o),z=$eWjiX.BB.ctx(O);function H(e,t,i,n,r){var a=Math.round(t+.5)-.5,s=Math.round(i+.5)-.5,o=Math.round(t+n-a),l=Math.round(i+r-s);e.strokeRect(a,s,o,l)}function j(e){if(e||!t||JSON.stringify(t)!==JSON.stringify(l)){if(0===v){z.clearRect(0,0,s,o),z.drawImage(a.canvas,0,0);var i=I.image,n=$eWjiX.BB.ctx(i);n.save(),n.clearRect(0,0,S,C),n.drawImage(O,0,0,S,C),n.restore();var r=l.width*E,h=l.height*E,c=$eWjiX.BB.ctx(M);c.save(),c.clearRect(0,0,k,B),c.strokeStyle="#fff",H(c,l.x*E,l.y*E,r,h),l.blend>.05&&(c.strokeStyle="#f0f",H(c,l.x*E-r/2*l.blend,l.y*E-h/2*l.blend,r*(1+l.blend),h*(1+l.blend))),c.restore()}else{z.clearRect(0,0,s,o),z.drawImage(a.canvas,0,0),$ebbf7e5d844153e5$var$drawPattern(z,l);var u=I.image,d=$eWjiX.BB.ctx(u);d.clearRect(0,0,S,C),d.drawImage(O,0,0,S,C)}T.render(),t=$eWjiX.BB.copyObj(l)}}j();var F=function(){g.destroy(),A.destroy(),D.destroy(),T.destroy()},X={element:r,destroy:F,getInput:function(){return F(),$eWjiX.BB.copyObj(l)}};return i||(X.width=$a433d11ad38d7c38$export$3a4a74a7d8c44e62.width),X},apply(e){var t=e.klCanvas,i=e.layer.context,n=e.klHistory;if(!t)return!1;$ebbf7e5d844153e5$var$drawPattern(i,e.input);var r=Object.fromEntries(e.klCanvas.getLayers().map(function(t){return t.id===e.layer.id?[t.id,{tiles:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.layer.canvas)}]:[t.id,{}]}));return n.push({layerMap:r}),!0}},$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$67bee9819cf9d9ba$export$77c344cc65ad0ed2={getDialog(e){var t=$042ba564475611dc$export$8f6817a932bf45cd(),i=$eWjiX.BB.el(),n=e.context,r=!0,a={stepSize:1,distortType:0,scale:{x:100,y:100},strength:{x:20,y:20},phase:{x:0,y:0},offset:{x:0,y:0}},s=[],o=32,l=$eWjiX.BB.canvas(o,o),h=$eWjiX.BB.ctx(l);h.beginPath(),h.arc(o/2,o/2,o/2.5,0,2*Math.PI),h.fill();var c=h.createLinearGradient(0,0,o,o);c.addColorStop(0,"#00f"),c.addColorStop(.5,"#f00"),c.addColorStop(1,"#fff"),h.fillStyle=c,h.globalCompositeOperation="source-atop",h.fillRect(0,0,o,o),(c=h.createLinearGradient(o,0,0,o)).addColorStop(0,"#000"),c.addColorStop(1,"#000"),h.fillStyle=c,h.globalCompositeOperation="destination-atop",h.fillRect(0,0,o,o);var u=(0,$7jh4K.throwIfNull)($02a74dc72797630f$export$8c4423af32b21158()),d=u.texture(l);u.draw(d).update();var p=20;[0,1,2].forEach(function(e){var t=new Image,i=$eWjiX.BB.copyObj(a);i.distortType=e,i.scale.x/=p,i.scale.y/=p,i.strength.x/=p,i.strength.y/=p,u.draw(d).multiplyAlpha().distort(i).unmultiplyAlpha().update(),h.clearRect(0,0,o,o),h.drawImage(u,0,0),t.src=l.toDataURL("image/png"),s.push(t)}),d.destroy();var f=$eWjiX.BB.el({parent:i,css:{display:"flex",alignItems:"center"}}),g=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:s.map(function(e,t){return(0,$7jh4K.css)(e,{margin:"1px",borderRadius:"3px",transition:"all 0.1s ease-in-out"}),{id:""+t,label:e}}),initId:"0",onChange:function(e){a.distortType=Number(e),T.render()}});function v(e){"x"===e?(a.scale.y=a.scale.x,a.strength.y=a.strength.x,a.phase.y=a.phase.x,k[3].setValue(a.scale.y),k[4].setValue(a.strength.y),k[5].setValue(a.phase.y)):(a.scale.x=a.scale.y,a.strength.x=a.strength.y,a.phase.x=a.phase.y,k[0].setValue(a.scale.x),k[1].setValue(a.strength.x),k[2].setValue(a.phase.x)),T.render()}var m=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-distort-sync-xy"),callback:function(e){(r=e)&&v("x")},name:"sync-xy"});f.append(g.getElement(),$eWjiX.BB.el({css:{flexGrow:"1"}}),m.getElement());var y=$eWjiX.BB.el({parent:i,css:{display:"flex",flexWrap:"wrap"}}),x=$eWjiX.BB.el({parent:y,css:{marginRight:"10px"}}),b=$eWjiX.BB.el({parent:y}),w=t?300:245,k=[];["x","y"].forEach(function(e,t){var i=0===t?x:b,n=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-noise-scale")+" "+e.toUpperCase(),width:w,height:30,min:1,max:1e3,curve:"quadratic",value:a.scale[e],eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(t){a.scale[e]=t,r?v(e):T.render()}});n.getElement().style.marginTop="20px",i.append(n.getElement());var s=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-unsharp-mask-strength")+" "+e.toUpperCase(),width:w,height:30,min:0,max:200,curve:"quadratic",value:a.strength[e],eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(t){a.strength[e]=t,r?v(e):T.render()}});s.getElement().style.marginTop="10px",i.append(s.getElement());var o=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-distort-phase")+" "+e.toUpperCase(),width:w,height:30,min:0,max:1,value:a.phase[e],manualInputRoundDigits:2,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,formatFunc:function(e){return $eWjiX.BB.round(e,2)},onChange:function(t){a.phase[e]=t,r?v(e):T.render()}});o.getElement().style.marginTop="10px",i.append(o.getElement()),k.push(n),k.push(s),k.push(o)});var B=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-distort-stepsize"),width:300,height:30,min:1,max:300,curve:"quadratic",value:a.stepSize,eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){a.stepSize=Math.round(e),T.render()}});B.getElement().style.marginTop="20px",B.getElement().style.marginBottom="10px",i.append(B.getElement());var S=e.klCanvas,C=S.getLayers(),E=(0,$7jh4K.throwIfNull)(S.getLayerIndex(n.canvas)),_=new $14b90ba44af68d49$export$94ec999f33a691e3({original:n.canvas,onUpdate:function(e,t){var i=$eWjiX.BB.copyObj(a);return i.stepSize*=t.scaleX,i.strength.x*=t.scaleX,i.strength.y*=t.scaleY,2!==i.distortType&&(i.scale.x*=t.scaleX,i.scale.y*=t.scaleY),i.offset.x=-t.x,i.offset.y=-t.y,e.multiplyAlpha().distort(i).unmultiplyAlpha()},selection:S.getSelection()}),I=C.map(function(e,t){return{image:t===E?_.render:e.context.canvas,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr,hasClipping:!1}}),T=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(t),height:$a433d11ad38d7c38$export$94cffdbcf128864a(t),project:{width:n.canvas.width,height:n.canvas.height,layers:I},selection:S.getSelection()});T.render(),(0,$7jh4K.css)(T.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),i.append(T.getElement());var M=function(){g.destroy(),k.forEach(function(e){return e.destroy()}),B.destroy(),m.destroy(),_.destroy(),T.destroy()},L={element:i,destroy:M,getInput:function(){return M(),$eWjiX.BB.copyObj(a)}};return t||(L.width=$a433d11ad38d7c38$export$3a4a74a7d8c44e62.width),L},apply(e){var t=e.klCanvas,i=e.layer.context,n=e.klHistory;return!!t&&$670db093f8076d2c$export$66c6ccb6bcae2c94(i,e.klCanvas.getSelection(),function(t){t.multiplyAlpha().distort(e.input).unmultiplyAlpha()},n)}},$eWjiX=parcelRequire("eWjiX"),$dJPtW=parcelRequire("dJPtW"),$eWjiX=parcelRequire("eWjiX");function $cd59789add31bb97$export$8f57d6bdbceb36d0(e,t,i,n,r,a,s){e.save();for(var o=180/n,l=0;l<180;l+=o){var h=$eWjiX.BB.rotateAround({x:t,y:i},{x:t+9999,y:i},l);$01d7180c5d1d0fdf$export$71b514a25c47df50(e,{type:"line",x1:t,y1:i,x2:h.x,y2:h.y,isOutwards:!0,opacity:s,strokeRgb:a,lineWidth:r})}e.restore()}var $7jh4K=parcelRequire("7jh4K"),$9939d5f20537fa4b$export$a77e8ecd2a7fa9a5={getDialog(e){var t=e.context,i=e.klCanvas;if(!t||!i)return!1;var n=i.getLayers(),r=(0,$7jh4K.throwIfNull)(i.getLayerIndex(t.canvas)),a=$eWjiX.BB.canvas(t.canvas.width,t.canvas.height),s=$eWjiX.BB.ctx(a),o=$eWjiX.BB.el(),l={element:o},h=$042ba564475611dc$export$8f6817a932bf45cd();h||(l.width=$a433d11ad38d7c38$export$8b9199c1f5e4be8(h));var c={x:t.canvas.width/2,y:t.canvas.height/2,lines:8,thickness:2,color:{r:0,g:0,b:0},opacity:1},u=new $5c0625e6104e2c75$export$a1855b925e534de7({label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-vanish-point-lines"),width:300,height:30,min:2,max:20,value:c.lines,curve:"quadratic",eventResMs:$fca35583bfaa35b6$export$f02de051ab70b20e,onChange:function(e){c.lines=Math.round(e),k()}});u.getElement().style.marginBottom="10px",o.append(u.getElement());var d=$eWjiX.BB.el({parent:o,css:{display:"flex",alignItems:"center"}}),p=$eWjiX.BB.el({parent:o,css:{display:"flex",alignItems:"center",marginTop:"10px",marginBottom:"10px"}}),f=(0,$dJPtW.input)({init:c.x,type:"number",css:{width:"75px",marginRight:"20px"},callback:function(e){c.x=parseFloat(e),_.setValue({x:c.x,y:c.y}),k()}}),g=(0,$dJPtW.input)({init:c.y,type:"number",css:{width:"75px",marginRight:"20px"},callback:function(e){c.y=parseFloat(e),_.setValue({x:c.x,y:c.y}),k()}}),v=(0,$dJPtW.input)({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(e){c.thickness=parseFloat(e),k()}}),m={r:0,g:0,b:0,a:1},y=[{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];y.push({r:e.currentColorRgb.r,g:e.currentColorRgb.g,b:e.currentColorRgb.b,a:1}),y.push({r:e.secondaryColorRgb.r,g:e.secondaryColorRgb.g,b:e.secondaryColorRgb.b,a:1}),c.color=$eWjiX.BB.copyObj(m);var x=new $4db8cbbb01889095$export$24ba9b81662d4366({label:$8d7403abedf7cefa$export$ce37e184d908d785("shape-stroke"),colorArr:y,onChange:function(e){m=e,c.color=$eWjiX.BB.copyObj(m),k()}}),b={display:"inline-block",marginRight:"5px"};function w(){f.value=""+c.x,g.value=""+c.y}function k(){var e=s,i=a.width,n=a.height;e.save(),e.clearRect(0,0,i,n),e.drawImage(t.canvas,0,0,i,n),$cd59789add31bb97$export$8f57d6bdbceb36d0(e,c.x,c.y,c.lines,Math.max(c.thickness,1),c.color,c.opacity),e.restore(),E.render()}d.append($eWjiX.BB.el({content:"X:",css:b}),f,$eWjiX.BB.el({content:"Y:",css:b}),g),p.append($eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("shape-line-width")+":",css:b}),v,$eWjiX.BB.el({css:{flexGrow:"1"}}),x.getElement());for(var B=function(){return _.setTransform(E.getTransform()),a},S=[],C=0;C<n.length;C++)S.push({image:C===r?B:n[C].context.canvas,isVisible:n[C].isVisible,opacity:n[C].opacity,mixModeStr:n[C].mixModeStr,hasClipping:!1});var E=new $99362267c0b49949$export$133773870222880f({width:$a433d11ad38d7c38$export$8b9199c1f5e4be8(h),height:$a433d11ad38d7c38$export$94cffdbcf128864a(h),project:{width:t.canvas.width,height:t.canvas.height,layers:S}});(0,$7jh4K.css)(E.getElement(),{marginLeft:"-20px",marginRight:"-20px",overflow:"hidden"});var _=new $1ca80fac51ad2a2d$export$87247fc399965417({value:{x:c.x,y:c.y},onChange:function(e){c.x=Math.round(e.x),c.y=Math.round(e.y),w(),k()}});return k(),E.getElement().append(_.getElement()),o.append(E.getElement()),l.destroy=function(){u.destroy(),x.destroy(),E.destroy()},l.getInput=function(){return l.destroy(),$eWjiX.BB.copyObj(c)},l},apply(e){var t=e.layer.context,i=e.klCanvas,n=e.klHistory;if(!t||!i)return!1;$cd59789add31bb97$export$8f57d6bdbceb36d0(t,e.input.x,e.input.y,e.input.lines,e.input.thickness,e.input.color,e.input.opacity);var r=Object.fromEntries(e.klCanvas.getLayers().map(function(t){return t.id===e.layer.id?[t.id,{tiles:$1a6c9997bc8182ff$export$7b1ba44282f9a519(e.layer.canvas)}]:[t.id,{}]}));return n.push({layerMap:r}),!0}};function $4bb0d03ef02dc0c0$var$importFilter(e,t){t.getDialog&&(e.getDialog=t.getDialog),e.apply=t.apply}function $4bb0d03ef02dc0c0$export$4283b00eae4a6956(){$805be15a1e91c0ee$export$24724bc1f91cba3.isLoaded||($4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.brightnessContrast,$024aabab8b30bbfd$export$af433fb90aa90a38),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.cropExtend,$2680b5781517cb67$export$e5937df51b9e1d86),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.curves,$4c948640eb8ef791$export$309483fcb6d5c7ca),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.flip,$6b01e1931d168e01$export$9b1b7b3985b9625a),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.hueSaturation,$041c656037c77a96$export$2aa46bd5587f0eb),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.invert,$82b3d1ba61b3412f$export$b7ebcfbdc840ef76),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.perspective,$460859cbeb601dec$export$a76d798fa7d85e4e),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.resize,$63d62a20f3ba2c7d$export$5705240d31427a82),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.rotate,$878715182dcd377b$export$ac7e9efc751d5791),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.tiltShift,$aa97ed406a9700f0$export$1b8796b18b7c19ed),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.transform,$31a0dd41d7428d32$export$dc15474d94cdc2b3),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.blur,$95b95646154e8218$export$55e7eb2ebd0db869),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.unsharpMask,$82f12ab116cea855$export$62ac74a5ea43bd5c),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.toAlpha,$a535e7a374deb8f5$export$6158ed2b22ebf4d9),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.grid,$bad33651972f8d2c$export$50020de79e1bc23),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.noise,$595c9469b8f94062$export$1dab0536099042f5),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.pattern,$ebbf7e5d844153e5$export$5b48b77a483d9b33),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.distort,$67bee9819cf9d9ba$export$77c344cc65ad0ed2),$4bb0d03ef02dc0c0$var$importFilter($805be15a1e91c0ee$export$bac24f240bb7727d.vanishPoint,$9939d5f20537fa4b$export$a77e8ecd2a7fa9a5),$805be15a1e91c0ee$export$24724bc1f91cba3.isLoaded=!0)}var $1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3");function $40b8cea12adf584e$export$92433b641be3f7a(e){return(0,$1LaJZ._)(function(){var t,i;return(0,$2gUX3.__generator)(this,function(n){switch(n.label){case 0:return t=e.getLayersFast(),i={width:e.getWidth(),height:e.getHeight(),children:t.map(function(e){return{name:e.name,hidden:!e.isVisible,opacity:e.opacity,canvas:e.canvas,blendMode:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.PSD.blendKlToPsd(e.mixModeStr),left:0,top:0}})},[4,$a12fba8bc3214c1d$export$ab3d838b1d336b38()];case 1:return[2,new Blob([n.sent().writePsdBuffer(i)],{type:"application/octet-stream"})]}})})()}var $6mTnI=parcelRequire("6mTnI"),$6l0gQ=parcelRequire("6l0gQ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$3adbeb1f050c09d3$export$c57e2ed65bcf4d6a=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.smoothing=$eWjiX.BB.clamp(t.smoothing,0,1)}return(0,$7h4XF._)(e,[{key:"chainIn",value:function(e){var t=this;if(e=$eWjiX.BB.copyObj(e),clearTimeout(this.timeout),clearInterval(this.interval),"down"===e.type&&(this.lastMixedInput={x:e.x,y:e.y,pressure:e.pressure}),"move"===e.type){var i=e.x,n=e.y,r=e.pressure;e.x=$eWjiX.BB.mix(e.x,this.lastMixedInput.x,this.smoothing),e.y=$eWjiX.BB.mix(e.y,this.lastMixedInput.y,this.smoothing),e.pressure=$eWjiX.BB.mix(e.pressure,this.lastMixedInput.pressure,this.smoothing),this.lastMixedInput={x:e.x,y:e.y,pressure:e.pressure},this.smoothing>0&&(this.timeout=setTimeout(function(){t.interval=setInterval(function(){var a,s;(e=JSON.parse(JSON.stringify(e))).x=$eWjiX.BB.mix(i,t.lastMixedInput.x,t.smoothing),e.y=$eWjiX.BB.mix(n,t.lastMixedInput.y,t.smoothing),e.pressure=$eWjiX.BB.mix(r,t.lastMixedInput.pressure,t.smoothing),t.lastMixedInput={x:e.x,y:e.y,pressure:e.pressure},null==(a=(s=t).chainOut)||a.call(s,e)},35)},80))}return e}},{key:"setChainOut",value:function(e){this.chainOut=e}},{key:"setSmoothing",value:function(e){this.smoothing=$eWjiX.BB.clamp(e,0,1)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$73298182992a8985$export$91dcf4209534d21f=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.isDrawing=!1}return(0,$7h4XF._)(e,[{key:"chainIn",value:function(e){return("down"===e.type&&(this.isDrawing?this.chainOut&&this.chainOut({type:"up",scale:e.scale,shiftIsPressed:e.shiftIsPressed,isCoalesced:!1}):this.isDrawing=!0),this.isDrawing||"move"!==e.type&&"up"!==e.type)?("up"===e.type&&this.isDrawing&&(this.isDrawing=!1),e):null}},{key:"setChainOut",value:function(e){this.chainOut=e}},{key:"getIsDrawing",value:function(){return this.isDrawing}}]),e}();function $7aa12ecc06c22770$export$bcd109042a2e4bb5(e){return 1==e?.5:2==e?.84:3==e?.965:4==e?.9825:5==e?.99125:e}var $1LaJZ=parcelRequire("1LaJZ"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$8KHnw=parcelRequire("8KHnw"),$2gUX3=parcelRequire("2gUX3"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3");function $2b16b03b1892d95f$var$isBufferMatch(e,t){return t.every(function(t,i){return void 0===t||e[i]===t})}function $2b16b03b1892d95f$export$16b40d0fc7becfe6(e){return(0,$1LaJZ._)(function(){var t,i,n,r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(i=(t=e.name.split("."))[t.length-1].toLowerCase(),e.type.match("image/vnd.adobe.photoshop")||"psd"===i)return[2,"psd"];if(e.type.match("image.*"))return[2,"image"];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,new Promise(function(t,i){var n=new FileReader;n.onload=function(){null===n.result?i():t(new Uint8Array(n.result))},n.onerror=i,n.readAsArrayBuffer(e.slice(0,12))})];case 2:if($2b16b03b1892d95f$var$isBufferMatch(n=a.sent(),[56,66,80,83]))return[2,"psd"];if($2b16b03b1892d95f$var$isBufferMatch(n,[137,80,78,71,13,10,26,10])||$2b16b03b1892d95f$var$isBufferMatch(n,[255,216])||$2b16b03b1892d95f$var$isBufferMatch(n,[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]))return[2,"image"];return[3,4];case 3:return r=a.sent(),[3,4];case 4:return[2,void 0]}})})()}var $da20269bad242e5f$export$1ec1306c0c05d48d=function(){"use strict";function e(t,i){(0,$cx0mh._)(this,e),this.klRootEl=t.klRootEl,this.klMaxCanvasSize=t.maxCanvasSize,this.layersUi=t.layersUi,this.setCurrentLayer=t.setCurrentLayer,this.klCanvas=t.klCanvas,this.onImportConfirm=t.onImportConfirm,this.applyUncommitted=t.applyUncommitted,this.onColor=i.onColor}return(0,$7h4XF._)(e,[{key:"importFinishedLoading",value:function(e,t,i){var n=this;if(!e||isNaN(e.width)||isNaN(e.height)||e.width<=0||e.height<=0)return void $9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("import-broken-file"),buttons:["Ok"]});var r=function(e,t){var i=parseInt(""+e),r=parseInt(""+t);return i>n.klMaxCanvasSize&&(r=n.klMaxCanvasSize/i*r,i=n.klMaxCanvasSize),r>n.klMaxCanvasSize&&(i=n.klMaxCanvasSize/r*i,r=n.klMaxCanvasSize),{width:i=parseInt(""+i),height:r=parseInt(""+r)}},a=function(e){n.applyUncommitted();var i=r(e.width,e.height),a=$eWjiX.BB.canvas(e.width,e.height);$eWjiX.BB.ctx(a).drawImage(e,0,0),$eWjiX.BB.resizeCanvas(a,i.width,i.height),n.klCanvas.reset({width:i.width,height:i.height,image:a,layerName:t}),n.layersUi.update(0),n.setCurrentLayer(n.klCanvas.getLayer(0)),n.onImportConfirm()},s=function(e,t){n.applyUncommitted();var i,a=function(e,t,i){t.width=t.width,$eWjiX.BB.ctx(t).drawImage(e,-i.x,-i.y),e.width=i.width,e.height=i.height,$eWjiX.BB.ctx(e).drawImage(t,0,0)};if(t&&(t.width!==e.width||t.height!==e.height)){var s=$eWjiX.BB.canvas(t.width,t.height);if(e.width=t.width,e.height=t.height,e.layers||a(e.canvas,s,t),e.layers)for(var o=0;o<e.layers.length;o++)a(e.layers[o].image,s,t)}var l=r(e.width,e.height);if(e.width=l.width,e.height=l.height,e.layers||$eWjiX.BB.resizeCanvas(e.canvas,e.width,e.height),e.layers)for(var h=0;h<e.layers.length;h++){var c=e.layers[h];$eWjiX.BB.resizeCanvas(c.image,e.width,e.height)}i=e.layers?n.klCanvas.reset({width:e.width,height:e.height,layers:e.layers.map(function(e){return{id:$47ad43347dcf2f3c$export$b2ce7a8a096070e2(),name:e.name,isVisible:e.isVisible,opacity:e.opacity,mixModeStr:e.mixModeStr,image:e.image}})}):n.klCanvas.reset({width:e.width,height:e.height,image:e.canvas}),n.layersUi.update(i),n.setCurrentLayer(n.klCanvas.getLayer(i)),n.onImportConfirm()},o=function(e){n.applyUncommitted(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.showImportAsLayerDialog({target:n.klRootEl,klCanvas:n.klCanvas,importImage:e,callback:function(i,r){if(i){var a=function(t){$eWjiX.BB.drawTransformedImageWithBounds(t,e,i,void 0,r)};n.klCanvas.addLayer(void 0,{name:t,isVisible:!0,opacity:1,image:a})||n.klCanvas.drawOperation(n.klCanvas.getLayers().length-1,a);var s=n.klCanvas.getLayers(),o=s.length-1;n.setCurrentLayer(n.klCanvas.getLayer(o)),n.layersUi.update(o)}}})};"default"!==i&&i||$9cbe98d1fb398012$export$6e4a713ddcda1e5e.showImportImageDialog({image:e,target:this.klRootEl,maxSize:this.klMaxCanvasSize,callback:function(e){"as-image"===e.type?a(e.image):"as-image-psd"===e.type?s(e.image,e.cropObj):"as-layer"===e.type?o(e.image):e.type}}),"layer"===i&&o(e.canvas),"image"===i&&("psd"===e.type?s(e):a(e.canvas))}},{key:"readClipboard",value:function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o,l,h,c,u,d,p,f,g,v,m;return(0,$2gUX3.__generator)(this,function(y){switch(y.label){case 0:e=this,y.label=1;case 1:return y.trys.push([1,17,,18]),[4,navigator.clipboard.read()];case 2:t=y.sent(),i=!1,n=!0,r=!1,a=void 0,y.label=3;case 3:y.trys.push([3,14,15,16]),s=t[Symbol.iterator](),y.label=4;case 4:if(n=(o=s.next()).done)return[3,13];l=o.value,h=!0,c=!1,u=void 0,y.label=5;case 5:y.trys.push([5,10,11,12]),d=function(){var t,n,r;return(0,$2gUX3.__generator)(this,function(a){switch(a.label){case 0:if(!(t=f.value).startsWith("image"))return[3,2];return i=!0,[4,l.getType(t)];case 1:return n=a.sent(),(r=new Image).onload=function(){URL.revokeObjectURL(r.src),e.importFinishedLoading({type:"image",width:r.width,height:r.height,canvas:r},void 0,"default")},r.src=URL.createObjectURL(n),[2,{v:void 0}];case 2:return[2]}})},p=l.types[Symbol.iterator](),y.label=6;case 6:if(h=(f=p.next()).done)return[3,9];return[5,(0,$2gUX3.__values)(d())];case 7:if(g=y.sent(),"object"===(0,$8KHnw._)(g))return[2,g.v];y.label=8;case 8:return h=!0,[3,6];case 9:return[3,12];case 10:return v=y.sent(),c=!0,u=v,[3,12];case 11:try{h||null==p.return||p.return()}finally{if(c)throw u}return[7];case 12:return n=!0,[3,4];case 13:return[3,16];case 14:return v=y.sent(),r=!0,a=v,[3,16];case 15:try{n||null==s.return||s.return()}finally{if(r)throw a}return[7];case 16:return i||$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("clipboard-no-image"),buttons:["Ok"]}),[3,18];case 17:return m=y.sent(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("clipboard-read-fail"),buttons:["Ok"]}),[3,18];case 18:return[2]}})}).call(this)}},{key:"onPaste",value:function(e){var t=this;if(!($9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0)){var i=function(e,t){if(e){for(var i=0;i<e.length;i++)if(-1!=e[i].type.indexOf("image")){var n=e[i].getAsFile();n&&t(n)}}};e.stopPropagation(),e.preventDefault(),e.clipboardData&&(e.clipboardData.files[0]?i(e.clipboardData.items,function(e){var i=new Image;i.onload=function(){URL.revokeObjectURL(i.src),t.importFinishedLoading({type:"image",width:i.width,height:i.height,canvas:i},void 0,"default")},i.src=(window.URL||window.webkitURL).createObjectURL(e)}):e.clipboardData.items[0]&&e.clipboardData.items[0].getAsString(function(e){if((e=e.trim()).match(/^https?/)){var i=new Image;i.onload=function(){t.importFinishedLoading({type:"image",width:i.width,height:i.height,canvas:i},void 0,"default")},i.onerror=function(e){console.log("error loading",e)},i.crossOrigin="Anonymous",i.src=e}else if(e.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)){var n=$eWjiX.BB.ColorConverter.hexToRGB(e.replace("#",""));n&&t.onColor(n)}}))}}},{key:"handleFileSelect",value:function(e,t){return(0,$1LaJZ._)(function(){var i,n,r,a,s,o,l;return(0,$2gUX3.__generator)(this,function(h){switch(h.label){case 0:i=this,n=function(){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:i.klRootEl,type:"warning",message:$8d7403abedf7cefa$export$ce37e184d908d785("import-psd-unsupported")+"<br /><br />",buttons:["Ok"]})},r=!1,a=(0,$bX4ja._)(e),s=0,h.label=1;case 1:if(!(s<a.length))return[3,4];return[4,$2b16b03b1892d95f$export$16b40d0fc7becfe6(o=a[s])];case 2:"image"===(l=h.sent())?function(e){window.URL=window.URL||window.webkitURL;var n=window.URL.createObjectURL(e),r=new Image;r.src=n,$eWjiX.BB.loadImage(r,function(){URL.revokeObjectURL(n),i.importFinishedLoading({type:"image",width:r.width,height:r.height,canvas:r},e.name,t)})}(o):"psd"===l?function(e){var r,s=0x1900000,o=0x40000000,l=4096;if(e.size>=o)return $9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:i.klRootEl,type:"error",message:"File too big. Unable to import.<br /><br />",buttons:["Ok"]});var h=1===a.length&&e.size>=s,c=!0;h&&$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:i.klRootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785("import-opening"),callback:function(e){c=!1,r=null},closeFunc:function(e){r=e}});var u=new FileReader;u.onload=function(a){var s=(0,$7jh4K.throwIfNull)(a.target);$9cbe98d1fb398012$export$6e4a713ddcda1e5e.loadAgPsd().then(function(a){if(!h||c)try{var o;if((o=a.readPsd(s.result,{skipLayerImageData:!0,skipThumbnail:!0,skipCompositeImageData:!0})).width>l||o.height>l){r&&r(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:i.klRootEl,type:"error",message:$8d7403abedf7cefa$export$ce37e184d908d785("import-psd-too-large").replace(/{x}/g,""+l)+"<br /><br />"+$8d7403abedf7cefa$export$ce37e184d908d785("import-psd-size")+": "+o.width+" x "+o.height+" pixels<br /><br />",buttons:["Ok"]});return}o=null;try{o=a.readPsd(s.result)}catch(e){}if(o){var u=$9cbe98d1fb398012$export$6e4a713ddcda1e5e.PSD.readPsd(o);"image"===t&&u.error&&n(),r&&r(),i.importFinishedLoading(u,e.name,t)}else o=a.readPsd(s.result,{skipLayerImageData:!0,skipThumbnail:!0}),"image"===t&&n(),r&&r(),i.importFinishedLoading({type:"psd",width:o.width,height:o.height,canvas:(0,$7jh4K.throwIfUndefined)(o.canvas),error:!0},e.name,t)}catch(e){null==r||r(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:i.klRootEl,type:"error",message:"Failed to load PSD.<br /><br />",buttons:["Ok"]}),console.log(e),setTimeout(function(){throw Error("psd load error")})}}).catch(function(e){null==r||r(),alert("Error: failed to load PSD library")})},u.readAsArrayBuffer(e)}(o):r=!0,h.label=3;case 3:return s++,[3,1];case 4:return r&&$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785("import-unsupported-file"),type:"error",buttons:["OK"]}),[2]}})}).call(this)}}]),e}(),$297fb258e45d3497$exports={};$297fb258e45d3497$exports=$parcel$resolve("k9Nks");var $35c1331d74740d5d$exports={};$35c1331d74740d5d$exports=$parcel$resolve("bBxqy");var $9d5703f01759ee19$exports={};$9d5703f01759ee19$exports=$parcel$resolve("3UXKl");var $bX4ja=parcelRequire("bX4ja"),$3jT0U=parcelRequire("3jT0U");function $a8abbf3a9def9692$export$982e7602957287fa(e){var t,i,n=["Draw via the console! Learn more: %cKL.help()","background: #000; color: #0f0;"];return"info"in console?(t=console).info.apply(t,(0,$bX4ja._)(n)):(i=console).log.apply(i,(0,$bX4ja._)(n)),Object.freeze({draw:function(t){e.onDraw(t)},recognizeShape:function(e){console.log("Shape recognition triggered with",e.length,"points");var t=$3jT0U.ShapeRecognition.recognizeShapeFromPoints(e);return console.log(`Recognized shape: ${t||"unknown"}`),t},help:function(){console.log(`KL.draw({x: number; y: number}[]) // draw a line
KL.recognizeShape({x: number; y: number}[]) // recognize shape from points
KL.help() // print help
`)}})}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$8N5YG=parcelRequire("8N5YG"),$bX4ja=parcelRequire("bX4ja"),$04lDo=parcelRequire("04lDo"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$gCzYB=parcelRequire("gCzYB"),$7d3bbf0db34a31fc$export$ae7d5b5c7fa00e77=function(){"use strict";function e(t){(0,$cx0mh._)(this,e);var i=[];t.onUndo&&(this.twoFingerTap=new $eWjiX.BB.NFingerTapper({fingers:2,onTap:t.onUndo}),i.push(this.twoFingerTap)),t.onRedo&&(this.threeFingerTap=new $eWjiX.BB.NFingerTapper({fingers:3,onTap:t.onRedo}),i.push(this.threeFingerTap)),this.mainDoubleTapper=new $eWjiX.BB.DoubleTapper({onDoubleTap:t.onDoubleTap}),this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"]),this.middleDoubleTapper=new $eWjiX.BB.DoubleTapper({onDoubleTap:t.onDoubleTap}),this.middleDoubleTapper.setAllowedButtonArr(["middle"]),this.pinchZoomer=new $eWjiX.BB.PinchZoomer({onPinch:t.onPinch}),this.pointerEventChain=new(0,$gCzYB.EventChain)({chainArr:(0,$bX4ja._)(i).concat([this.mainDoubleTapper,this.middleDoubleTapper,this.pinchZoomer,new $eWjiX.BB.OnePointerLimiter])}),this.pointerEventChain.setChainOut(t.onChainOut)}return(0,$7h4XF._)(e,[{key:"chainIn",value:function(e){this.pointerEventChain.chainIn(e)}},{key:"setDoubleTapPointerTypes",value:function(e){this.mainDoubleTapper.setAllowedPointerTypeArr(e)}},{key:"destroy",value:function(){}}]),e}(),$idV3L=parcelRequire("idV3L"),$eg83P=parcelRequire("eg83P"),$bX4ja=parcelRequire("bX4ja"),$991ab38832278e02$export$31ee023005d8c68f=["touch"],$991ab38832278e02$export$4f41ddbc92f66d7d=["space","alt","r","z"],$991ab38832278e02$export$c5299001bfb7de59=["mouse-middle","mouse-right"].concat((0,$bX4ja._)($991ab38832278e02$export$4f41ddbc92f66d7d)),$991ab38832278e02$export$5e2c057e240c0b8c=1/16,$991ab38832278e02$export$ac82c07320907c00=128;function $da90e23ff63572c1$export$296b597c2b22784a(e,t){var i=e.x!==t.x||e.y!==t.y,n=e.scale!==t.scale||e.angleDeg!==t.angleDeg;return!i&&!n}var $cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx");function $11590af1b0c2eaf1$export$e5cb90f7d2eee96c(e,t,i,n,r){if($da90e23ff63572c1$export$296b597c2b22784a(e,t)||(e.x===t.x||2>Math.abs(e.x-t.x))&&(e.y===t.y||2>Math.abs(e.y-t.y))&&(e.scale===t.scale||Math.abs(e.scale-t.scale)<.08*t.scale))return(0,$cL71g._)({},t);if(e.angleDeg===t.angleDeg)return{x:$eWjiX.BB.mix(e.x,t.x,r),y:$eWjiX.BB.mix(e.y,t.y,r),angleDeg:t.angleDeg,scale:$eWjiX.BB.mix(e.scale,t.scale,r)};var a=$c4f45fb8696b5286$export$935bc53f7df03c95(e,n),s=$c4f45fb8696b5286$export$935bc53f7df03c95(t,n);if(1>$eWjiX.BB.Vec2.dist(a.canvasP,s.canvasP)){var o=a.angleDeg,l=s.angleDeg-a.angleDeg;l>180&&(o+=360),l<-180&&(o-=360);var h={viewportP:n,canvasP:s.canvasP,scale:$eWjiX.BB.mix(e.scale,t.scale,r),angleDeg:$eWjiX.BB.mix(o,t.angleDeg,r)};return $926e1894e59cf403$export$99c68a89351e15c0(h.viewportP,h.canvasP,h.scale,h.angleDeg)}var c={x:i.width/2,y:i.height/2},u=$92816524e1b72be4$export$ad1d215dd03fe75a(e),d=$92816524e1b72be4$export$ad1d215dd03fe75a(t),p=(0,$cdZRx.applyToPoint)(u,c),f=(0,$cdZRx.applyToPoint)(d,c),g={x:$eWjiX.BB.mix(p.x,f.x,r),y:$eWjiX.BB.mix(p.y,f.y,r)},v=$eWjiX.BB.mix(e.scale,t.scale,r),m=$eWjiX.BB.mix(e.angleDeg,t.angleDeg,r),y=Math.PI/180*m,x=-c.x*v,b=-c.y*v,w=x*Math.cos(y)-b*Math.sin(y),k=x*Math.sin(y)+b*Math.cos(y),B={x:g.x+w,y:g.y+k};return{x:B.x,y:B.y,scale:v,angleDeg:m}}var $7jh4K=parcelRequire("7jh4K");function $33e4247c53b6e65b$var$getToolEntries(e){return Object.entries(e)}var $33e4247c53b6e65b$export$2732362bcaeb02c2=function(){"use strict";function e(t){var i,n,r,a,s=this,o=this;(0,$cx0mh._)(this,e),this.doRender=!1,this.isFrozen=!1,this.lastRenderedTransform={},this.targetTransform={},this.easelInterface={setCursor:function(e){return s.rootEl.style.cursor=e},getTransform:function(){return s.viewport.getTransform()},getTargetTransform:function(){return s.targetTransform},getSize:function(){return{width:s.width,height:s.height}},getProjectSize:function(){return{width:s.project.width,height:s.project.height}},setTransform:function(e,t){return s.setTargetTransform(e,t)},requestRender:function(){return s.requestRender()},isKeyPressed:function(e){return s.keyListener.isPressed(e)},minScale:$991ab38832278e02$export$5e2c057e240c0b8c,maxScale:$991ab38832278e02$export$ac82c07320907c00,setAngleDeg:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return o.setAngleDeg.apply(o,(0,$bX4ja._)(t))},keyListener:{},updateDoubleTapPointerTypes:function(){return s.updateDoubleTapPointerTypes()},setRenderedSelection:function(e){return s.selectionRenderer.setRenderedSelection(e)},clearRenderedSelection:function(e){return s.selectionRenderer.clearRenderedSelection(e)},onWheel:function(e){return s.onWheel(e)},getElement:function(){return s.rootEl}},this.lastFrameTimestamp=0,this.onWheel=function(e){null==(t=e.event)||t.preventDefault();var t,i=!1;if(.8>Math.abs(e.deltaY)&&(i=!0),e.event&&e.event.ctrlKey&&!s.keyListener.isPressed("ctrl")){i=!0;var n=1;0===e.event.deltaMode&&(n=6),e.deltaY*=n}s.keyListener.isPressed("shift")&&(e.deltaY/=4);var r=s.targetTransform,a={x:e.relX,y:e.relY},o=$92816524e1b72be4$export$ad1d215dd03fe75a(r),l=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(o),a),h=$eWjiX.BB.clamp(r.scale*Math.pow(1.4,-e.deltaY),$991ab38832278e02$export$5e2c057e240c0b8c,$991ab38832278e02$export$ac82c07320907c00);s.setTargetTransform($926e1894e59cf403$export$99c68a89351e15c0(a,l,h,r.angleDeg),i)},this.project=t.project,this.width=t.width,this.height=t.height,this.toolId=t.tool,this.toolsMap=(0,$cL71g._)({},t.tools),this.onChangeTool=t.onChangeTool,this.onTransformChange=t.onTransformChange,this.onUndo=t.onUndo,this.onRedo=t.onRedo,this.tempTools=Object.fromEntries($991ab38832278e02$export$c5299001bfb7de59.map(function(e){return[e,$33e4247c53b6e65b$var$getToolEntries(s.toolsMap).filter(function(t){var i=(0,$8N5YG._)(t,2),n=(i[0],i[1]);return n.tempTriggers&&n.tempTriggers.includes(e)}).map(function(e){return e[0]})[0]]})),this.viewport=new $ee6e64f1b33d2735$export$a140ed60c2ca052c({width:this.width,height:this.height,project:{width:this.project.width,height:this.project.height,layers:this.project.layers},transform:this.getResetTransform(),renderAfter:function(e,t){var i,n=s.getActiveTool();null==(i=n.renderAfterViewport)||i.call(n,e,t)}}),Object.values(this.toolsMap).forEach(function(e){var t,i;null==(t=e.setEaselInterface)||t.call(e,s.easelInterface),null==(i=e.onResize)||i.call(e,s.width,s.height)});var l=!1,h=!1,c=!1;this.pointerPreprocessor=new $7d3bbf0db34a31fc$export$ae7d5b5c7fa00e77({onUndo:this.onUndo,onRedo:this.onRedo,onPinch:function(e){if("move"===e.type){var t=s.viewport.getTransform();s.pinchInitialTransform||(s.pinchInitialTransform=$eWjiX.BB.copyObj(t),c=s.pinchInitialTransform.angleDeg%180==0);var i=s.pinchInitialTransform.angleDeg+e.angleRad/Math.PI*180;(i=(0,$eg83P.minimizeAngleDeg)((0,$eg83P.snapAngleDeg)(i,90,c?12:4)))%90!=0&&(c=!1);var n=$c4f45fb8696b5286$export$935bc53f7df03c95(s.pinchInitialTransform,{x:e.downRelX,y:e.downRelY});n.scale=$eWjiX.BB.clamp(s.pinchInitialTransform.scale*e.scale,$991ab38832278e02$export$5e2c057e240c0b8c,$991ab38832278e02$export$ac82c07320907c00),n.viewportP.x+=e.relX-e.downRelX,n.viewportP.y+=e.relY-e.downRelY,n.angleDeg=i,s.setTargetTransform($926e1894e59cf403$export$99c68a89351e15c0(n.viewportP,n.canvasP,n.scale,n.angleDeg),!0),s.requestRender()}else"end"===e.type&&(s.pinchInitialTransform=void 0)},onDoubleTap:function(e){s.fitTransform()?s.requestRender():s.scale(2,e.relX,e.relY)},onChainOut:function(e){if(s.cursorPos={x:e.relX,y:e.relY},"pointerdown"===e.type)"middle"===e.button&&(l=!0,s.pushTempTool(s.tempTools["mouse-middle"])),"right"===e.button&&(h=!0,s.pushTempTool(s.tempTools["mouse-right"]));else if("pointermove"===e.type);else if("pointerup"===e.type){if(l){l=!1,s.getActiveTool().onPointer(e),s.popTempTool(s.tempTools["mouse-middle"]);return}if(h){h=!1,s.getActiveTool().onPointer(e),s.popTempTool(s.tempTools["mouse-right"]);return}}s.getActiveTool().onPointer(e)}}),this.pointerListener=new(0,$04lDo.PointerListener)({target:this.viewport.getElement(),onPointer:function(e){s.pointerPreprocessor.chainIn(e)},onWheel:this.onWheel,onEnterLeave:function(e){var t,i=s.getActiveTool();e||(s.cursorPos=void 0,null==(t=i.onPointerLeave)||t.call(i))},useDirtyWheel:!0,isWheelPassive:!1,maxPointers:3}),this.windowPointerListener=function(e){var t,i;!s.isFrozen&&(s.rootEl.contains(e.target)||null==(t=(i=s.getActiveTool()).onClickOutside)||t.call(i))},window.addEventListener("pointerdown",this.windowPointerListener),this.keyListener=new(0,$idV3L.KeyListener)({onDown:function(e,t,i,n){if(!s.isFrozen){if("plus"===i){var r,a=s.getTransform().scale,o=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(a,s.keyListener.isPressed("shift")?1/8:.5);s.scale(o/a)}if("minus"===i){var l=s.getTransform().scale,h=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(l,s.keyListener.isPressed("shift")?-1/8:-.5);s.scale(h/l)}if(s.keyListener.comboOnlyContains(["shift","left","right","up","down"])){var c,u,d=s.getActiveTool();if(!(null==(u=d.onArrowKeys)?void 0:u.call(d,e))){var p=40;"left"===e&&s.translate(p,0),"right"===e&&s.translate(-p,0),"up"===e&&s.translate(0,p),"down"===e&&s.translate(0,-p)}}$991ab38832278e02$export$4f41ddbc92f66d7d.forEach(function(e){i===e&&s.toolsMap[s.toolId].blockTrigger!==e&&s.pushTempTool(s.tempTools[e])});var f=s.toolsMap[null!=(r=s.tempToolId)?r:s.toolId];null==(c=f.onKeyDown)||c.call(f,e,t,i,n)}},onUp:function(e,t,i){if(!s.isFrozen){$991ab38832278e02$export$4f41ddbc92f66d7d.forEach(function(t){e===t&&s.toolsMap[s.toolId].blockTrigger!==t&&s.popTempTool(s.tempTools[t])});var n,r,a=s.toolsMap[null!=(r=s.tempToolId)?r:s.toolId];null==(n=a.onKeyUp)||n.call(a,e,t,i)}},onBlur:function(){var e,t,i=s.toolsMap[null!=(t=s.tempToolId)?t:s.toolId];null==(e=i.onBlur)||e.call(i)}}),this.easelInterface.keyListener=this.keyListener,this.selectionRenderer=new $396117890b5c76b0$export$c61ab90e0d3eb9b1({transform:this.viewport.getTransform(),selection:this.project.selection,width:this.width,height:this.height}),this.svgEl=$eWjiX.BB.createSvg({elementType:"svg",width:""+this.width,height:""+this.height}),(0,$7jh4K.css)(this.svgEl,{position:"absolute",left:"0",top:"0",pointerEvents:"none"}),(i=this.svgEl).append.apply(i,[this.selectionRenderer.getElement()].concat((0,$bX4ja._)(Object.values(this.toolsMap).map(function(e){return e.getSvgElement()})))),this.htmlOverlayEl=$eWjiX.BB.el({css:{position:"absolute",left:"0",top:"0"}}),(n=this.htmlOverlayEl).append.apply(n,(0,$bX4ja._)(Object.values(this.toolsMap).map(function(e){var t;return(null==(t=e.getHtmlOverlayElement)?void 0:t.call(e))||void 0}).filter(function(e){return void 0!==e}))),this.updateToolSvgs(),this.rootEl=$075b9fd415bad4ff$export$db3b6bfb95261072({css:{userSelect:"none",touchAction:"none",overscrollBehaviorX:"none"}},[this.viewport.getElement(),this.svgEl,this.htmlOverlayEl]),this.rootEl.addEventListener("contextmenu",function(e){return e.preventDefault(),!1},{passive:!1}),this.rootEl.addEventListener("touchend",function(e){return e.preventDefault(),!1}),this.rootEl.addEventListener("dragstart",function(e){return e.preventDefault(),!1}),null==(r=(a=this.toolsMap[this.toolId]).activate)||r.call(a,this.cursorPos),Object.values(this.toolsMap).forEach(function(e){var t;return null==(t=e.onTool)?void 0:t.call(e,s.toolId)}),this.renderLoop()}return(0,$7h4XF._)(e,[{key:"setTargetTransform",value:function(e,t){t&&this.viewport.setTransform(e),this.targetTransform=e,this.doRender=!0}},{key:"updateToolSvgs",value:function(){var e,t=this,i=null!=(e=this.tempToolId)?e:this.toolId;Object.keys(this.toolsMap).forEach(function(e){t.toolsMap[e].getSvgElement().style.display=e===i?"":"none"})}},{key:"updateDoubleTapPointerTypes",value:function(){var e,t,i=null!=(t=this.toolsMap[null!=(e=this.tempToolId)?e:this.toolId].doubleTapPointerTypes)?t:$991ab38832278e02$export$31ee023005d8c68f;this.pointerPreprocessor.setDoubleTapPointerTypes(i)}},{key:"renderLoop",value:function(){var e,t=this,i=performance.now(),n=i-this.lastFrameTimestamp;if(this.lastFrameTimestamp=i,this.animationFrameId=requestAnimationFrame(function(){return t.renderLoop()}),this.doRender){var r=this.getActiveTool(),a=this.viewport.getTransform(),s=a;if($da90e23ff63572c1$export$296b597c2b22784a(a,this.targetTransform))this.doRender=!1;else{var o=1-Math.pow(.7,n/(1e3/60));s=$11590af1b0c2eaf1$export$e5cb90f7d2eee96c(a,this.targetTransform,{width:this.project.width,height:this.project.height},{x:this.width/2,y:this.height/2},o),this.viewport.setTransform(s)}var l=s.x!==this.lastRenderedTransform.x||s.y!==this.lastRenderedTransform.y,h=s.scale!==this.lastRenderedTransform.scale||s.angleDeg!==this.lastRenderedTransform.angleDeg;this.viewport.render(!$da90e23ff63572c1$export$296b597c2b22784a(a,s)),(l||h)&&(null==(e=r.onUpdateTransform)||e.call(r,s),this.selectionRenderer.setTransform(s),this.onTransformChange(this.targetTransform,h),this.lastRenderedTransform=s)}}},{key:"pushTempTool",value:function(e){if(void 0===this.tempToolId&&void 0!==e){var t,i,n,r=this.toolsMap[this.toolId];if(null==(t=r.getIsLocked)||!t.call(r)){this.tempToolId=e;var a=this.getActiveToolId();null==(i=(n=this.toolsMap[a]).activate)||i.call(n,this.cursorPos),Object.values(this.toolsMap).forEach(function(e){var t;return null==(t=e.onTool)?void 0:t.call(e,a)}),this.updateToolSvgs(),this.updateDoubleTapPointerTypes()}}}},{key:"popTempTool",value:function(e){if(this.tempToolId===e&&void 0!==e){this.tempToolId=void 0,null==(t=(i=this.getActiveTool()).activate)||t.call(i,this.cursorPos,!0);var t,i,n=this.getActiveToolId();Object.values(this.toolsMap).forEach(function(e){var t;return null==(t=e.onTool)?void 0:t.call(e,n)}),this.updateToolSvgs(),this.updateDoubleTapPointerTypes()}}},{key:"getActiveToolId",value:function(){var e;return null!=(e=this.tempToolId)?e:this.toolId}},{key:"getActiveTool",value:function(){return this.toolsMap[this.getActiveToolId()]}},{key:"getResetTransform",value:function(){return $926e1894e59cf403$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},1,0)}},{key:"getFitTransform",value:function(){var e=this.viewport.getTransform().angleDeg;45===e&&(e=0),e=(0,$eg83P.snapAngleDeg)(e,90,90);var t=this.project.width,i=this.project.height,n=[[0,0],[t,0],[t,i],[0,i],[t/2,i/2]],r=$eWjiX.BB.Matrix.getIdentity();r=$eWjiX.BB.Matrix.multiplyMatrices(r,$eWjiX.BB.Matrix.createRotationMatrix(e/180*Math.PI));for(var a=0;a<n.length;a++){var s=[n[a][0],n[a][1],0,1];s=$eWjiX.BB.Matrix.multiplyMatrixAndPoint(r,s),n[a][0]=s[0],n[a][1]=s[1]}for(var o={},l=0;l<n.length;l++)(void 0===o.x1||n[l][0]<o.x1)&&(o.x1=n[l][0]),(void 0===o.y1||n[l][1]<o.y1)&&(o.y1=n[l][1]),(void 0===o.x2||n[l][0]>o.x2)&&(o.x2=n[l][0]),(void 0===o.y2||n[l][1]>o.y2)&&(o.y2=n[l][1]);var h=o.x2-o.x1,c=o.y2-o.y1,u=0,d=Math.min($991ab38832278e02$export$ac82c07320907c00,$eWjiX.BB.fitInto(h,c,this.width-u,this.height-u,1).width/h),p={width:this.width,height:this.height};return $926e1894e59cf403$export$99c68a89351e15c0({x:p.width/2,y:p.height/2},{x:t/2,y:i/2},d,e)}},{key:"setProject",value:function(e){var t,i;this.project=e,this.viewport.setProject({width:this.project.width,height:this.project.height,layers:this.project.layers}),this.selectionRenderer.setSelection(this.project.selection),null==(t=(i=this.getActiveTool()).onUpdateSelection)||t.call(i,this.project.selection),this.requestRender()}},{key:"setSize",value:function(e,t){var i,n,r=$92816524e1b72be4$export$ad1d215dd03fe75a(this.viewport.getTransform()),a=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(r),{x:this.width/2,y:this.height/2});this.width=e,this.height=t,$eWjiX.BB.setAttributes(this.svgEl,{width:""+this.width,height:""+this.height}),this.selectionRenderer.setSize(e,t),null==(i=(n=this.getActiveTool()).onResize)||i.call(n,e,t),this.viewport.setSize(e,t);var s=this.viewport.getTransform();this.setTargetTransform($926e1894e59cf403$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},a,s.scale,s.angleDeg),!0),this.requestRender()}},{key:"requestRender",value:function(){this.doRender=!0}},{key:"getTransform",value:function(){return this.viewport.getTransform()}},{key:"setTransform",value:function(e){this.setTargetTransform(e,!0)}},{key:"setTool",value:function(e){var t,i,n=this;e!==this.toolId&&(this.toolId=e,null==(t=(i=this.toolsMap[this.toolId]).activate)||t.call(i,this.cursorPos),Object.values(this.toolsMap).forEach(function(e){var t;return null==(t=e.onTool)?void 0:t.call(e,n.toolId)}),this.onChangeTool(e),this.updateToolSvgs(),this.updateDoubleTapPointerTypes(),this.requestRender())}},{key:"getTool",value:function(){return this.toolId}},{key:"translate",value:function(e,t){var i=this.targetTransform;this.setTargetTransform((0,$4EWN2._)((0,$cL71g._)({},i),{x:i.x+e,y:i.y+t}))}},{key:"scale",value:function(e,t,i){var n=this.targetTransform,r={width:this.width,height:this.height},a=$c4f45fb8696b5286$export$935bc53f7df03c95(n,{x:t=null!=t?t:r.width/2,y:i=null!=i?i:r.height/2});a.scale=$eWjiX.BB.clamp(a.scale*e,$991ab38832278e02$export$5e2c057e240c0b8c,$991ab38832278e02$export$ac82c07320907c00),this.setTargetTransform($926e1894e59cf403$export$99c68a89351e15c0(a.viewportP,a.canvasP,a.scale,a.angleDeg))}},{key:"resetTransform",value:function(e){var t=this.getResetTransform();this.setTargetTransform(t,e),this.requestRender()}},{key:"fitTransform",value:function(e){var t=this.viewport.getTransform(),i=this.getFitTransform(),n=i.x!==t.x||i.y!==t.y,r=i.scale!==t.scale||i.angleDeg!==t.angleDeg;return(!!n||!!r)&&(this.setTargetTransform(i,e),!0)}},{key:"resetOrFitTransform",value:function(e){var t=4;!$da1a7600c10c1784$export$67ac20532b9ededa.disableAutoFit&&this.project.width<=this.width/t&&this.project.height<=this.height/t?this.fitTransform(e):this.resetTransform(e)}},{key:"setAngleDeg",value:function(e,t){var i=this.targetTransform,n=$92816524e1b72be4$export$ad1d215dd03fe75a(i),r={width:this.width,height:this.height},a={x:r.width/2,y:r.height/2},s=(0,$eg83P.minimizeAngleDeg)(t?i.angleDeg+e:e),o=$926e1894e59cf403$export$99c68a89351e15c0(a,(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(n),a),i.scale,s);this.setTargetTransform(o)}},{key:"getIsLocked",value:function(){var e,t,i;return null!=(i=null==(e=(t=this.getActiveTool()).getIsLocked)?void 0:e.call(t))&&i}},{key:"setIsFrozen",value:function(e){this.isFrozen=e}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){this.viewport.destroy(),this.pointerListener.destroy(),this.keyListener.destroy(),void 0!==this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.selectionRenderer.destroy(),window.removeEventListener("pointerdown",this.windowPointerListener)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$970a66c5cf50c47f$export$6c14c4cb1f26a0eb=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.defaultDeltaMs=1e3/60,this.momentum={x:0,y:0},this.isDragging=!1,this.lastDragTimestamp=0,this.lastTimestamp=0,this.isEnabled=!1,this.getTransform=t.getTransform,this.setTransform=t.setTransform}return(0,$7h4XF._)(e,[{key:"stop",value:function(){void 0!==this.animationFrameHandle&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}},{key:"dampen",value:function(e){var t=$eWjiX.BB.Vec2.len(this.momentum);t<.3?(this.momentum.x=0,this.momentum.y=0,this.stop()):t<5?(this.momentum.x*=Math.pow(.85,e),this.momentum.y*=Math.pow(.85,e)):(this.momentum.x*=Math.pow(.95,e),this.momentum.y*=Math.pow(.95,e))}},{key:"physicsLoop",value:function(){var e=this;this.animationFrameHandle=requestAnimationFrame(function(){return e.physicsLoop()});var t=performance.now(),i=(t-this.lastTimestamp)/this.defaultDeltaMs;if(this.lastTimestamp=t,0===this.momentum.x&&0===this.momentum.y||this.isDragging)return void(this.isDragging?this.dampen(i):this.stop());var n=this.getTransform();if(this.lastTransform&&(this.lastTransform.x!==n.x||this.lastTransform.y!==n.y||this.lastTransform.x!==n.x||this.lastTransform.x!==n.x)){this.momentum.x=0,this.momentum.y=0,this.lastTransform=void 0,this.stop();return}n.x+=this.momentum.x,n.y+=this.momentum.y,this.lastTransform=n,this.dampen(i),this.setTransform(n)}},{key:"dragStart",value:function(){this.isEnabled&&(this.isDragging=!0,this.momentum.x=0,this.momentum.y=0,this.stop())}},{key:"dragMove",value:function(e,t){this.isEnabled&&(this.momentum={x:$eWjiX.BB.mix(this.momentum.x,e,.6),y:$eWjiX.BB.mix(this.momentum.y,t,.6)},this.lastDragTimestamp=new Date().getTime())}},{key:"dragEnd",value:function(){var e=this;this.isEnabled&&(new Date().getTime()-this.lastDragTimestamp>80?(this.momentum.x=0,this.momentum.y=0):(this.lastTimestamp=performance.now(),this.animationFrameHandle=requestAnimationFrame(function(){return e.physicsLoop()})),this.lastTransform=void 0,this.lastDragTimestamp=0,this.isDragging=!1)}},{key:"setIsEnabled",value:function(e){this.isEnabled=e}}]),e}(),$66028f220dcd865f$export$8202a4a90789f655=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.easel={},this.doubleTapPointerTypes=["touch","mouse","pen"],this.tempTriggers=["space","mouse-middle"],this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.inertiaScrolling=new $970a66c5cf50c47f$export$6c14c4cb1f26a0eb({getTransform:function(){return i.easel.getTransform()},setTransform:function(e){return i.easel.setTransform(e,!0)}})}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){if(this.easel.setCursor("grab"),"pointerdown"===e.type&&["left","middle"].includes(e.button)&&(this.inertiaScrolling.dragStart(),this.easel.setCursor("grabbing")),"pointermove"===e.type&&["left","middle"].includes(e.button)){var t=(0,$cL71g._)({},this.easel.getTransform());t.x+=e.dX,t.y+=e.dY,this.easel.setTransform(t,!0),this.easel.requestRender(),this.easel.setCursor("grabbing"),this.inertiaScrolling.dragMove(e.dX,e.dY)}"pointerup"===e.type&&void 0===e.button&&this.inertiaScrolling.dragEnd()}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("grab")}},{key:"setUseInertiaScrolling",value:function(e){this.inertiaScrolling.setIsEnabled(e)}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$jjWRi=parcelRequire("jjWRi"),$gCzYB=parcelRequire("gCzYB"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$62498d9607e3a2ac$export$e91d1e53efcc28e3=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.createSvg({elementType:"g",childrenArr:[{elementType:"path",fill:"none",stroke:"rgba(255,255,255,0.7)","stroke-width":"1"},{elementType:"path",fill:"none",stroke:"rgba(0,0,0,0.7)","stroke-width":"1"}]})}return(0,$7h4XF._)(e,[{key:"update",value:function(e,t,i){var n=$92816524e1b72be4$export$ad1d215dd03fe75a(e),r=Math.round(2*(i=Math.round(2*i)/2)),a=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(n),t);a.x=r%2==0?Math.round(a.x):Math.floor(a.x)+.5,a.y=r%2==0?Math.round(a.y):Math.floor(a.y)+.5;var s=[[a.x-i,a.y-i],[a.x+i,a.y-i],[a.x+i,a.y+i],[a.x-i,a.y+i],[a.x-i,a.y-i]].map(function(e){return(0,$cdZRx.applyToPoint)(n,e)}),o="M ";s.forEach(function(e){o+=e.join(",")+" "}),(0,$7jh4K.setAttributes)(this.rootEl.children[1],{d:o});var l=1/e.scale,h=[[a.x-i+l,a.y-i+l],[a.x+i-l,a.y-i+l],[a.x+i-l,a.y+i-l],[a.x-i+l,a.y+i-l],[a.x-i+l,a.y-i+l]].map(function(e){return(0,$cdZRx.applyToPoint)(n,e)}),c="M ";h.forEach(function(e){c+=e.join(",")+" "}),(0,$7jh4K.setAttributes)(this.rootEl.firstChild,{d:c})}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$3295e188fd460bfa$export$249b9041c848ec46=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.createSvg({elementType:"g",childrenArr:[{elementType:"circle",cx:"0",cy:"0",fill:"none",stroke:"rgba(255,255,255,0.7)","stroke-width":"1"},{elementType:"circle",cx:"0",cy:"0",fill:"none",stroke:"rgba(0,0,0,0.7)","stroke-width":"1"}]})}return(0,$7h4XF._)(e,[{key:"update",value:function(e,t,i){$eWjiX.BB.setAttributes(this.rootEl.children[0],{r:""+Math.max(0,i*e.scale-1)}),$eWjiX.BB.setAttributes(this.rootEl.children[1],{r:""+i*e.scale}),$eWjiX.BB.setAttributes(this.rootEl,{transform:`translate(${t.x} ${t.y})`})}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$3jT0U=parcelRequire("3jT0U"),$e63c9ca4199f5887$export$dfeedd8879a1038a=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.easel={},this.oldScale=1,this.isDragging=!1,this.lastPos={x:0,y:0},this.isOver=!1,this.radius=t.radius,this.onLineStart=t.onLineStart,this.onLineGo=t.onLineGo,this.onLineEnd=t.onLineEnd,this.onLine=t.onLine,this.onShapeDetected=t.onShapeDetected,console.log("EaselBrush: Initializing Shape Recogniton"),this.shapeRecognition=new(0,$3jT0U.ShapeRecognition)({onShapeRecognized:function(e){var t=i.shapeRecognition.getRecognizedShape();console.log("Shape recognized:",e,t),i.onShapeDetected&&t&&i.onShapeDetected(t)}}),this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.brushCursorRound=new $3295e188fd460bfa$export$249b9041c848ec46,this.brushCursorPixelSquare=new $62498d9607e3a2ac$export$e91d1e53efcc28e3,this.currentCursor=this.brushCursorRound,this.svgEl.append(this.currentCursor.getElement()),this.eventChain=new(0,$gCzYB.EventChain)({chainArr:[new(0,$jjWRi.CoalescedExploder)]}),this.eventChain.setChainOut(function(e){i.onExplodedPointer(e)})}return(0,$7h4XF._)(e,[{key:"onExplodedPointer",value:function(e){var t,i=this.easel.getTransform(),n=$92816524e1b72be4$export$ad1d215dd03fe75a(i),r=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(n),{x:e.relX,y:e.relY}),a=r.x,s=r.y;i.scale!==this.oldScale&&(this.oldScale=i.scale),!e.isCoalesced&&(this.lastPos.x=e.relX,this.lastPos.y=e.relY,this.currentCursor.update(this.easel.getTransform(),{x:e.relX,y:e.relY},this.radius),this.isOver||"pointerup"===e.type||this._onPointerEnter());var o=null!=(t=e.pressure)?t:1,l=e.isCoalesced,h=this.easel.keyListener.isPressed("shift");if(!h&&this.onShapeDetected){var c={pressure:o,isCoalesced:l,shiftIsPressed:h,scale:i.scale};"pointerdown"===e.type&&"left"===e.button?this.shapeRecognition.chainIn((0,$cL71g._)({type:"down",x:a,y:s},c)):"pointermove"===e.type&&"left"===e.button?this.shapeRecognition.chainIn((0,$cL71g._)({type:"move",x:a,y:s},c)):"pointerup"===e.type&&this.shapeRecognition.chainIn({type:"up",isCoalesced:l,shiftIsPressed:h,scale:i.scale})}if(h&&!this.firstShiftPos&&(this.firstShiftPos={x:e.relX,y:e.relY}),h||(this.firstShiftPos=void 0,this.lineToolDirection=void 0),"pointerdown"===e.type&&"left"===e.button){if(h){this.lastLineEnd&&this.onLine(this.lastLineEnd,{x:a,y:s});return}this.onLineStart({x:a,y:s,pressure:o,isCoalesced:l}),this.isDragging=!0}if("pointermove"===e.type&&"left"===e.button)if(h){if(!this.lineToolDirection){var u=Math.abs(e.relX-this.firstShiftPos.x),d=Math.abs(e.relY-this.firstShiftPos.y);(u>5||d>5)&&(this.lineToolDirection=u>d?"x":"y")}if(this.lineToolDirection){var p={x:"x"===this.lineToolDirection?e.relX:this.firstShiftPos.x,y:"y"===this.lineToolDirection?e.relY:this.firstShiftPos.y},f=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(n),p);this.onLineGo((0,$4EWN2._)((0,$cL71g._)({},f),{pressure:o,isCoalesced:l}))}}else this.onLineGo({x:a,y:s,pressure:o,isCoalesced:l});"pointerup"===e.type&&void 0===e.button&&this.isDragging&&(this.onLineEnd(),this.isDragging=!1,"touch"===e.pointerType&&this.onPointerLeave())}},{key:"_onPointerEnter",value:function(){clearTimeout(this.hideCursorTimeout),this.svgEl.setAttribute("opacity","1"),this.isOver=!0}},{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){this.eventChain.chainIn(e)}},{key:"onPointerLeave",value:function(){clearTimeout(this.hideCursorTimeout),this.svgEl.setAttribute("opacity","0"),this.isOver=!1}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"onUpdateTransform",value:function(e){this.currentCursor.update(e,{x:this.lastPos.x,y:this.lastPos.y},this.radius)}},{key:"getIsLocked",value:function(){return this.isDragging}},{key:"setBrush",value:function(e){var t=this;if(void 0!==e.radius){this.radius=e.radius,this.isOver||(this.svgEl.setAttribute("opacity","1"),clearTimeout(this.hideCursorTimeout),this.hideCursorTimeout=setTimeout(function(){t.svgEl.setAttribute("opacity","0")},500));var i=this.easel.getSize(),n=i.width,r=i.height;this.currentCursor.update(this.easel.getTransform(),this.isOver?this.lastPos:{x:n/2,y:r/2},this.radius)}if(void 0!==e.type){var a="round"===e.type?this.brushCursorRound:this.brushCursorPixelSquare;a!==this.currentCursor&&(this.currentCursor.getElement().remove(),this.currentCursor=a,this.getSvgElement().append(this.currentCursor.getElement()))}}},{key:"setLastDrawEvent",value:function(e){this.lastLineEnd=e?(0,$cL71g._)({},e):void 0}},{key:"activate",value:function(e){this.easel.setCursor("crosshair"),this.isDragging=!1,e?(this.lastPos.x=e.x,this.lastPos.y=e.y,this.currentCursor.update(this.easel.getTransform(),{x:e.x,y:e.y},this.radius)):this.onPointerLeave()}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$3dcbe6df163512b5$export$abfede0290e9bfba=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.compositeCanvas=$eWjiX.BB.canvas(1,1),this.klCanvas=t.klCanvas,this.easel=t.easel,this.update()}return(0,$7h4XF._)(e,[{key:"update",value:function(){var e=this,t=this.klCanvas.getWidth(),i=this.klCanvas.getHeight();this.easel.setProject({width:t,height:i,layers:this.klCanvas.getLayersFast().map(function(n){return{image:n.compositeObj?function(){(e.compositeCanvas.width!=t||e.compositeCanvas.height!=i)&&(e.compositeCanvas.width=t,e.compositeCanvas.height=i);var r,a=e.compositeCanvas.getContext("2d");return a.clearRect(0,0,t,i),a.drawImage(n.canvas,0,0),null==(r=n.compositeObj)||r.draw((0,$7jh4K.throwIfNull)(e.compositeCanvas.getContext("2d"))),e.compositeCanvas}:n.canvas,isVisible:n.isVisible,opacity:n.opacity,mixModeStr:n.mixModeStr,hasClipping:!1}}),selection:this.klCanvas.getSelection()})}},{key:"freeCompositeCanvas",value:function(){this.compositeCanvas.width=1,this.compositeCanvas.height=1}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$78f5c513e727111b$exports={};$78f5c513e727111b$exports=$parcel$resolve("1dLwT"),parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$24db627c4c8e30c9$export$1fda302750a9ba48=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.isDragging=!1,this.tempTriggers=["mouse-right","alt"],this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.onPick=t.onPick,this.onPickEnd=t.onPickEnd,this.previewBorder=$eWjiX.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"22",fill:"none"}),this.previewColor=$eWjiX.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"20",fill:"none"}),this.svgEl.append(this.previewBorder,this.previewColor)}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($78f5c513e727111b$exports)+"') 0 15, crosshair");var t=$92816524e1b72be4$export$ad1d215dd03fe75a(this.easel.getTransform()),i=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(t),{x:e.relX,y:e.relY}),n=void 0,r=["left","right"].includes(e.button);if(r?(this.svgEl.setAttribute("transform",`translate(${e.relX},${e.relY})`),this.svgEl.style.opacity="1"):this.svgEl.style.opacity="0","pointerdown"===e.type&&r&&(n=this.onPick(i),this.isDragging=!0,r=!0),"pointermove"===e.type&&r&&(n=this.onPick(i),r=!0),"pointerup"===e.type&&void 0===e.button&&this.isDragging&&(this.onPickEnd(),this.isDragging=!1),n&&r){this.previewColor.setAttribute("stroke",$eWjiX.BB.ColorConverter.toRgbStr(n));var a=$eWjiX.BB.testIsWhiteBestContrast(n)?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)";this.previewBorder.setAttribute("stroke",a)}}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($78f5c513e727111b$exports)+"') 0 15, crosshair"),this.isDragging=!1,this.svgEl.style.opacity="0"}},{key:"onPointerLeave",value:function(){this.isDragging||(this.svgEl.style.opacity="0")}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$4bb58f8998e01855$exports={};$4bb58f8998e01855$exports=$parcel$resolve("hQSEH"),parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$f8e6779c7f01196e$export$9b29623161064b87=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.onFill=t.onFill}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($4bb58f8998e01855$exports)+"') 1 12, crosshair");var t=$92816524e1b72be4$export$ad1d215dd03fe75a(this.easel.getTransform()),i=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(t),{x:e.relX,y:e.relY});"pointerdown"===e.type&&"left"===e.button&&this.onFill({x:Math.floor(i.x),y:Math.floor(i.y)})}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($4bb58f8998e01855$exports)+"') 1 12, crosshair")}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$04aa501093e072d1$export$11badb1ec62816a1=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.isDragging=!1,this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.onDown=t.onDown,this.onMove=t.onMove,this.onUp=t.onUp}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){this.easel.setCursor("crosshair");var t=this.easel.getTransform(),i=$92816524e1b72be4$export$ad1d215dd03fe75a(t),n=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),{x:e.relX,y:e.relY});"pointerdown"===e.type&&"left"===e.button&&(this.onDown(n,t.angleDeg/180*Math.PI),this.isDragging=!0),"pointermove"===e.type&&"left"===e.button&&this.onMove(n),"pointerup"===e.type&&void 0===e.button&&this.isDragging&&(this.onUp(n),this.isDragging=!1)}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"getIsLocked",value:function(){return this.isDragging}},{key:"activate",value:function(e){this.easel.setCursor("crosshair"),this.isDragging=!1}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$0dd25bde578361f5$exports={};$0dd25bde578361f5$exports=$parcel$resolve("916ZI"),parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$43b8e046e203efe4$export$b10c22a3fee9197f=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.onDown=t.onDown}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($0dd25bde578361f5$exports)+"') 1 12, crosshair");var t=this.easel.getTransform(),i=$92816524e1b72be4$export$ad1d215dd03fe75a(t),n=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),{x:e.relX,y:e.relY});"pointerdown"===e.type&&"left"===e.button&&this.onDown(n,t.angleDeg/180*Math.PI)}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($0dd25bde578361f5$exports)+"') 1 12, crosshair")}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$201034f69477f047$export$4deed4c512c630c2=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.thresholdPx=25,this.lastFrameTimestamp=0,this.repeatEvent={},this.getEaselSize=t.getEaselSize,this.getTransform=t.getTransform,this.setTransform=t.setTransform,this.testCanPan=t.testCanPan,this.onRepeatEvent=t.onRepeatEvent}return(0,$7h4XF._)(e,[{key:"movementLoop",value:function(){var e=this;if(!this.cornerDirection){this.animationFrameHandle&&cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0,this.lastFrameTimestamp=0;return}this.animationFrameHandle=requestAnimationFrame(function(){return e.movementLoop()});var t=performance.now(),i=Math.min((t-this.lastFrameTimestamp)/(1e3/60),10);this.lastFrameTimestamp=t;var n=this.getTransform();n.x+=this.cornerDirection.x*i,n.y+=this.cornerDirection.y*i,this.setTransform(n),this.onRepeatEvent(this.repeatEvent)}},{key:"getSpeed",value:function(e){return .4*Math.min(e,this.thresholdPx)}},{key:"onPointer",value:function(e){var t=this,i=!1;this.cornerDirection={x:0,y:0},this.testCanPan(void 0!==e.button)&&"pointermove"===e.type&&(e.relX>this.getEaselSize().width-this.thresholdPx&&(this.cornerDirection.x-=this.getSpeed(e.relX-(this.getEaselSize().width-this.thresholdPx)),i=!0),e.relX<this.thresholdPx&&(this.cornerDirection.x+=this.getSpeed(this.thresholdPx-e.relX),i=!0),e.relY>this.getEaselSize().height-this.thresholdPx&&(this.cornerDirection.y-=this.getSpeed(e.relY-(this.getEaselSize().height-this.thresholdPx)),i=!0),e.relY<this.thresholdPx&&(this.cornerDirection.y+=this.getSpeed(this.thresholdPx-e.relY),i=!0)),i?(0===this.lastFrameTimestamp&&(this.lastFrameTimestamp=performance.now()),this.repeatEvent=e,this.animationFrameHandle=requestAnimationFrame(function(){return t.movementLoop()})):this.cornerDirection=void 0}}]),e}(),$ebd223e87e103321$export$f4821fa73b1145e5=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.easel={},this.isDragging=!1,this.doPan=!1,this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.onDown=t.onDown,this.onMove=t.onMove,this.onUp=t.onUp,this.cornerPanning=new $201034f69477f047$export$4deed4c512c630c2({getEaselSize:function(){return i.easel.getSize()},getTransform:function(){return i.easel.getTargetTransform()},setTransform:function(e){return i.easel.setTransform(e,!0)},testCanPan:function(e){return e},onRepeatEvent:function(e){i.onPointer(e,!0)}})}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e,t){this.doPan&&!t&&this.cornerPanning.onPointer(e),this.easel.setCursor("crosshair");var i=this.easel.getTransform(),n=$92816524e1b72be4$export$ad1d215dd03fe75a(i),r=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(n),{x:e.relX,y:e.relY});"pointerdown"===e.type&&"left"===e.button&&(this.onDown(r,i.angleDeg/180*Math.PI),this.isDragging=!0),"pointermove"===e.type&&"left"===e.button&&this.onMove(r),"pointerup"===e.type&&void 0===e.button&&this.isDragging&&(this.onUp(r),this.isDragging=!1)}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"getIsLocked",value:function(){return this.isDragging}},{key:"activate",value:function(e){this.easel.setCursor("crosshair"),this.isDragging=!1}},{key:"setPanning",value:function(e){this.doPan=e}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$eg83P=parcelRequire("eg83P"),$7jh4K=parcelRequire("7jh4K"),$5af1201febea9911$export$f3b0846760df78b=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.downPos=void 0,this.tempTriggers=["r"],this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.compassSize=30,this.compass=$eWjiX.BB.createSvg({elementType:"g"}),(0,$7jh4K.css)(this.compass,{transition:"opacity 0.25s ease-in-out"}),this.compassInner=$eWjiX.BB.createSvg({elementType:"g"}),this.compassBaseCircle=$eWjiX.BB.createSvg({elementType:"circle",fill:"rgba(0,0,0,0.9)",stroke:"none",cx:"0",cy:"0",r:""+this.compassSize}),this.compassLineCircle=$eWjiX.BB.createSvg({elementType:"circle",fill:"none",stroke:"rgba(255,255,255,0.75)","stroke-width":"1",cx:"0",cy:"0",r:""+.9*this.compassSize}),(0,$7jh4K.css)(this.compassLineCircle,{transition:"opacity 0.1s ease-in-out"}),this.needleWrapper=$eWjiX.BB.createSvg({elementType:"g","transform-origin":"0 0"}),this.compassUpperTriangle=$eWjiX.BB.createSvg({elementType:"path",fill:"#f00",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,-"+.9*this.compassSize+" z"}),this.compassLowerTriangle=$eWjiX.BB.createSvg({elementType:"path",fill:"#fff",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,"+.9*this.compassSize+" z"}),this.needleWrapper.append(this.compassUpperTriangle,this.compassLowerTriangle),this.compassInner.append(this.compassBaseCircle,this.compassLineCircle,this.needleWrapper),this.compass.append(this.compassInner),this.svgEl.append(this.compass)}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){if(this.easel.setCursor("left"===e.button?"grabbing":"grab"),"pointerdown"===e.type&&"left"===e.button)this.downPos={x:e.relX,y:e.relY},this.downTransform=$eWjiX.BB.copyObj(this.easel.getTargetTransform());else if("left"===e.button&&this.downPos&&this.downTransform){var t=this.easel.getSize(),i={x:t.width/2,y:t.height/2},n=$eWjiX.BB.Vec2.angle(i,this.downPos),r=($eWjiX.BB.Vec2.angle(i,{x:e.relX,y:e.relY})-n)/Math.PI*180,a=this.downTransform.angleDeg+r;this.easel.isKeyPressed("shift")&&(a=45*Math.round(a/45)),a=(0,$eg83P.minimizeAngleDeg)(a);var s=$92816524e1b72be4$export$ad1d215dd03fe75a(this.downTransform),o=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(s),i);this.easel.setTransform($926e1894e59cf403$export$99c68a89351e15c0(i,o,this.downTransform.scale,a),!this.easel.isKeyPressed("shift")),this.easel.requestRender()}else"pointerup"===e.type&&this.downPos&&(this.downPos=void 0,this.downTransform=void 0)}},{key:"onUpdateTransform",value:function(e){var t=this.easel.getTargetTransform();this.needleWrapper.setAttribute("transform","rotate("+e.angleDeg+")"),this.compassLineCircle.style.opacity=t.angleDeg%90==0?"1":"0"}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("grab");var t=this.easel.getSize(),i=t.width,n=t.height;this.compass.setAttribute("transform","translate("+i/2+", "+n/2+")"),this.onUpdateTransform(this.easel.getTransform())}},{key:"onKeyDown",value:function(e,t,i){["r+left","r+right"].includes(i)&&("left"===e&&this.easel.setAngleDeg(-15,!0),"right"===e&&this.easel.setAngleDeg(15,!0)),["r+up"].includes(i)&&this.easel.setAngleDeg(0,!1)}},{key:"onResize",value:function(e,t){this.compass.setAttribute("transform","translate("+e/2+", "+t/2+")")}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$ff8dbb1bd3f9b85c$exports={};$ff8dbb1bd3f9b85c$exports=$parcel$resolve("9wZxU"),parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$kDVZW=parcelRequire("kDVZW"),$e041531c7ca89b12$export$6c389c8425707374=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.easel={},this.downPos=void 0,this.tempTriggers=["z"],this.svgEl=$eWjiX.BB.createSvg({elementType:"g"})}return(0,$7h4XF._)(e,[{key:"getSvgElement",value:function(){return this.svgEl}},{key:"onPointer",value:function(e){if(this.easel.setCursor("url('"+$parcel$interopDefault($ff8dbb1bd3f9b85c$exports)+"') 7 7, zoom-in"),"pointerdown"===e.type&&["left"].includes(e.button)&&(this.downPos={x:e.relX,y:e.relY},this.downTransform=$eWjiX.BB.copyObj(this.easel.getTransform())),"pointermove"===e.type&&["left"].includes(e.button)&&this.downPos&&this.downTransform){var t=this.downPos,i=$92816524e1b72be4$export$ad1d215dd03fe75a(this.downTransform),n=(0,$cdZRx.applyToPoint)((0,$kDVZW.inverse)(i),t),r=e.relX-this.downPos.x,a=$eWjiX.BB.clamp(this.downTransform.scale*Math.pow(1+1/400,r),this.easel.minScale,this.easel.maxScale);this.easel.setTransform($926e1894e59cf403$export$99c68a89351e15c0(t,n,a,this.downTransform.angleDeg),!0),this.easel.requestRender()}"pointerup"===e.type&&void 0===e.button&&(this.downPos=void 0,this.downTransform=void 0)}},{key:"setEaselInterface",value:function(e){this.easel=e}},{key:"activate",value:function(e){this.easel.setCursor("url('"+$parcel$interopDefault($ff8dbb1bd3f9b85c$exports)+"') 7 7, zoom-in")}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$8N5YG=parcelRequire("8N5YG"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$3e01e916c4e53185$exports={};$3e01e916c4e53185$exports=$parcel$resolve("kiEfz");var $6dae220a5b70a5f8$exports={};$6dae220a5b70a5f8$exports=$parcel$resolve("4uXfZ");var $2c33980c55e55d8e$exports={};$2c33980c55e55d8e$exports=$parcel$resolve("bjhUB");var $f4416a3e89ce50bf$exports={};$f4416a3e89ce50bf$exports=$parcel$resolve("9MYhm");var $4ab563d9dade83ab$exports={};$4ab563d9dade83ab$exports=$parcel$resolve("fsl8L");var $94fd3ca351798f15$exports={};$94fd3ca351798f15$exports=$parcel$resolve("3QHUd");var $115673c0650a4220$exports={};$115673c0650a4220$exports=$parcel$resolve("5GkZe");var $2dfd245fd3bb9927$exports={};$2dfd245fd3bb9927$exports=$parcel$resolve("2zM6R");var $d77fe25b1a559789$exports={};$d77fe25b1a559789$exports=$parcel$resolve("5rTlv");var $72Jv0=parcelRequire("72Jv0"),$7jh4K=parcelRequire("7jh4K"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$eae820938baa028e$export$f04a61298a47a40f=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.rootEl=$eWjiX.BB.el({className:t.darkInvert?"dark-invert":"",css:(0,$cL71g._)({backgroundImage:`url("${t.imageUrl}")`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:t.width+"px",height:t.height+"px"},t.css)})}return(0,$7h4XF._)(e,[{key:"getElement",value:function(){return this.rootEl}}]),e}(),$79d09d3423439479$export$b3e6ed306341f794=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.isVisible=!0,this.hasSelection=!1,this.onChangeMode=t.onChangeMode,this.modeOptions=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"select",label:$075b9fd415bad4ff$export$db3b6bfb95261072("",[$075b9fd415bad4ff$export$db3b6bfb95261072({content:"<img class='dark-invert' src='"+$parcel$interopDefault($3e01e916c4e53185$exports)+"' height='20'/><span>"+$8d7403abedf7cefa$export$ce37e184d908d785("select-select")+"</span>",css:{display:"flex",gap:"5px",alignItems:"center",height:"100%",margin:"10px 4px",justifyContent:"center"}})])},{id:"transform",label:$075b9fd415bad4ff$export$db3b6bfb95261072("",[$075b9fd415bad4ff$export$db3b6bfb95261072({content:"<img class='dark-invert' src='"+$parcel$interopDefault($6dae220a5b70a5f8$exports)+"' height='20'/><span>"+$8d7403abedf7cefa$export$ce37e184d908d785("select-transform")+"</span>",css:{display:"flex",gap:"5px",alignItems:"center",height:"100%",margin:"10px 4px",justifyContent:"center"}})])}],initId:"select",onChange:function(e){"select"===e&&i.operationOptions.setValue("new"),i.onChangeMode(e),E()},onBeforeChange:function(e){return"transform"!==e||t.canTransform()},optionCss:{flexGrow:"1",flexBasis:"0"},css:{marginBottom:"10px"}});var n=$eWjiX.BB.el(),r=new Image;r.src=$parcel$interopDefault($2c33980c55e55d8e$exports),r.classList.add("dark-invert");var a=new Image;a.src=$parcel$interopDefault($f4416a3e89ce50bf$exports),a.classList.add("dark-invert");var s=new Image;s.src=$parcel$interopDefault($4ab563d9dade83ab$exports),s.classList.add("dark-invert"),this.operationOptions=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"new",label:r,title:$8d7403abedf7cefa$export$ce37e184d908d785("select-boolean-replace")},{id:"union",label:a,title:$8d7403abedf7cefa$export$ce37e184d908d785("select-boolean-add")},{id:"difference",label:s,title:$8d7403abedf7cefa$export$ce37e184d908d785("select-boolean-subtract")}],initId:"new",onChange:function(e){t.onChangeBooleanOperation(e)},css:{marginBottom:"10px"}});var o={width:"32px",height:"32px"},l=new Image;l.src=$parcel$interopDefault($94fd3ca351798f15$exports),l.classList.add("dark-invert"),(0,$7jh4K.css)(l,o);var h=new Image;h.src=$parcel$interopDefault($115673c0650a4220$exports),h.classList.add("dark-invert"),(0,$7jh4K.css)(h,o);var c=new Image;c.src=$parcel$interopDefault($2dfd245fd3bb9927$exports),c.classList.add("dark-invert"),(0,$7jh4K.css)(c,o);var u=new Image;u.src=$parcel$interopDefault($d77fe25b1a559789$exports),u.classList.add("dark-invert"),(0,$7jh4K.css)(u,o);var d=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"rect",label:l,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-rect")},{id:"ellipse",label:h,title:$8d7403abedf7cefa$export$ce37e184d908d785("shape-ellipse")},{id:"lasso",label:c,title:$8d7403abedf7cefa$export$ce37e184d908d785("select-lasso")},{id:"poly",label:u,title:$8d7403abedf7cefa$export$ce37e184d908d785("select-polygon")}],initId:t.select.shape,onChange:function(e){t.select.onChangeShape(e)},css:{marginBottom:"10px"}});n.append(d.getElement(),this.operationOptions.getElement());var p=$eWjiX.BB.el({parent:n,css:{display:"flex",gap:"5px",flexWrap:"wrap"}});$eWjiX.BB.el({parent:p,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("select-all"),onClick:function(){t.select.onAll()},custom:{tabindex:"-1"},css:{minHeight:"30px"}}),$eWjiX.BB.el({parent:p,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("select-invert"),onClick:function(){t.select.onInvert()},custom:{tabindex:"-1"},css:{minHeight:"30px"}}),this.selectResetBtn=$eWjiX.BB.el({parent:p,tagName:"button",content:[(0,$72Jv0.createImage)({src:$parcel$interopDefault($720ba2c010612610$exports),alt:"icon",height:20,css:{marginRight:"3px",filter:"invert(1)"}}),$8d7403abedf7cefa$export$ce37e184d908d785("select-reset")],className:"kl-button kl-button-primary",css:{paddingRight:"8px",display:"none"},onClick:function(){t.select.onReset()},custom:{tabindex:"-1"}}),$eWjiX.BB.el({className:"grid-hr",parent:n,css:{margin:"10px 0"}});var f=$eWjiX.BB.el({parent:n,css:{display:"flex",gap:"5px"}});$eWjiX.BB.el({parent:f,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("select-erase"),onClick:function(){t.onErase()},custom:{tabindex:"-1"}}),$eWjiX.BB.el({parent:f,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("select-fill"),onClick:function(){t.onFill()},custom:{tabindex:"-1"}});var g=$eWjiX.BB.el({css:{display:"flex",flexDirection:"column",gap:"10px"}});this.positionOutput=$eWjiX.BB.el({}),g.append(this.positionOutput);var v=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-flip")+" X",className:"kl-button",onClick:function(){t.transform.onFlipX()},custom:{tabindex:"-1"}}),m=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-flip")+" Y",onClick:function(){t.transform.onFlipY()},custom:{tabindex:"-1"}}),y=$eWjiX.BB.el({tagName:"button",content:"-90",onClick:function(){t.transform.onRotateDeg(-90)},custom:{tabindex:"-1"}}),x=$eWjiX.BB.el({tagName:"button",content:"+90",onClick:function(){t.transform.onRotateDeg(90)},custom:{tabindex:"-1"}}),b=new $eae820938baa028e$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($ff6378202995f780$exports),width:20,height:20,darkInvert:!0}),w=$eWjiX.BB.el({tagName:"button",content:[b.getElement(),$8d7403abedf7cefa$export$ce37e184d908d785("select-transform-clone")],onClick:function(){t.transform.onClone()},css:{display:"flex",gap:"5px"},custom:{tabindex:"-1"}}),k=$eWjiX.BB.el({tagName:"button",content:"2&times;",onClick:function(){t.transform.onScale(2)},custom:{tabindex:"-1"}}),B=$eWjiX.BB.el({tagName:"button",content:"&frac12;&times;",onClick:function(){t.transform.onScale(.5)},custom:{tabindex:"-1"}}),S=$eWjiX.BB.el({tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("center"),onClick:function(){t.transform.onCenter()},custom:{tabindex:"-1"}});$eWjiX.BB.el({parent:g,content:[w,v,m,y,x,k,B,S],css:{display:"flex",flexWrap:"wrap",gap:"5px"}}),this.constrainCheckbox=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-constrain"),title:$8d7403abedf7cefa$export$ce37e184d908d785("constrain-proportions"),callback:function(e){t.transform.onChangeConstrain(e)},css:{display:"inline-block"},name:"constrain-proportions"}),this.snappingCheckbox=new $365a915dfb503274$export$48513f6b9f8ce62d({init:!0,label:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-snap"),title:$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-snap-title"),callback:function(e){t.transform.onChangeSnapping(e)},css:{display:"inline-block",marginLeft:"10px"},name:"enable-snapping"});var C=$eWjiX.BB.el();C.append(this.constrainCheckbox.getElement(),this.snappingCheckbox.getElement()),g.append(C),this.algorithmSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:[["smooth",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$8d7403abedf7cefa$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",onChange:function(e){t.transform.onChangeAlgorithm(e)},name:"interpolation-algorithm"}),g.append($075b9fd415bad4ff$export$db3b6bfb95261072(",flex,items-center,gap-5,flexWrap",[$8d7403abedf7cefa$export$ce37e184d908d785("scaling-algorithm")+":",this.algorithmSelect.getElement()])),this.moveToLayerSelect=new $7a3263857aacf58f$export$ef9b1a59e592288f({optionArr:[["1","Layer 2"],["0","Layer 1"]],onChange:function(e){t.transform.onMoveToLayer(+e)},name:"move-to-layer",css:{width:"100%"}}),g.append($075b9fd415bad4ff$export$db3b6bfb95261072(",flex,items-center,gap-5,flexWrap",[$8d7403abedf7cefa$export$ce37e184d908d785("select-transform-move-to-layer"),this.moveToLayerSelect.getElement()])),this.transparentBackgroundToggle=new $365a915dfb503274$export$48513f6b9f8ce62d({label:$8d7403abedf7cefa$export$ce37e184d908d785("brush-eraser-transparent-bg"),callback:function(e){t.transform.onChangeTransparentBackground(e)},name:"enable-transparent-background"}),(0,$7jh4K.css)(this.transparentBackgroundToggle.getElement(),{display:"inline-block"}),g.append(this.transparentBackgroundToggle.getElement());var E=function(){"select"===i.modeOptions.getValue()?(i.rootEl.append(n),g.remove()):(n.remove(),i.rootEl.append(g))};this.rootEl=$eWjiX.BB.el({content:[this.modeOptions.getElement()],css:{margin:"10px"}}),E()}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.selectResetBtn.style.display=this.hasSelection?"block":"none"}},{key:"setIsVisible",value:function(e){this.isVisible=e,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.operationOptions.setValue("new")}},{key:"setMode",value:function(e){this.modeOptions.setValue(e)}},{key:"setLayers",value:function(e){this.moveToLayerSelect.setOptionArr(e.map(function(e,t){return[""+t,e]}).reverse())}},{key:"setMoveToLayer",value:function(e){this.moveToLayerSelect.setValue(void 0===e?void 0:""+e)}},{key:"setHasSelection",value:function(e){this.hasSelection=e,this.update()}},{key:"setBackgroundIsTransparent",value:function(e){this.transparentBackgroundToggle.setValue(e)}},{key:"setAlgorithm",value:function(e){this.algorithmSelect.setValue(e)}},{key:"setFreeTransformTransformation",value:function(e){var t=$eWjiX.BB.round(e.x,0),i=$eWjiX.BB.round(e.y,0),n=$eWjiX.BB.round(e.angleDeg,0);this.positionOutput.innerText=`X: ${t}; Y: ${i}; ${$8d7403abedf7cefa$export$ce37e184d908d785("filter-transform-rotation")}: ${n}\xb0`}},{key:"setShowTransparentBackgroundToggle",value:function(e){this.transparentBackgroundToggle.getElement().style.display=e?"block":"none"}},{key:"getElement",value:function(){return this.rootEl}},{key:"destroy",value:function(){}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$eWjiX=parcelRequire("eWjiX");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$dZ59l=parcelRequire("dZ59l"),$kDVZW=parcelRequire("kDVZW"),$1RMPr=parcelRequire("1RMPr"),$kr2fR=parcelRequire("kr2fR"),$eg83P=parcelRequire("eg83P"),$9b3eo=parcelRequire("9b3eo"),$gCzYB=parcelRequire("gCzYB"),$c1lmK=parcelRequire("c1lmK"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$9b3eo=parcelRequire("9b3eo");parcelRequire("ciAU9");var $cdZRx=parcelRequire("cdZRx"),$dZ59l=parcelRequire("dZ59l"),$83Kse=parcelRequire("83Kse"),$1RMPr=parcelRequire("1RMPr"),$kFecW=parcelRequire("kFecW"),$kr2fR=parcelRequire("kr2fR"),$bbA6w=parcelRequire("bbA6w"),$eg83P=parcelRequire("eg83P");function $bf77e842daed0824$export$a8cb0d8fd60b16e8(e,t){e.imageSmoothingEnabled="smooth"===t,"smooth"===t&&(e.imageSmoothingQuality="high")}function $512c3ce4311decfe$export$e464a809f7257768(e,t){var i={x:t.x1+(t.x2-t.x1)/2,y:t.y1+(t.y2-t.y1)/2},n=t.x2-t.x1,r=t.y2-t.y1,a=e.width/n,s=e.height/r,o=e.angleDeg/180*Math.PI;return(0,$dZ59l.compose)((0,$kr2fR.translate)(e.x,e.y),(0,$1RMPr.rotate)(o),(0,$kFecW.scale)(a,s),(0,$kr2fR.translate)(-i.x,-i.y))}var $512c3ce4311decfe$export$68f5601e78b8ada8=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.selection=[],this.selectionBounds={},this.transform={},this.doClone=!1,this.backgroundIsTransparent=!1,this.algorithm="smooth"}return(0,$7h4XF._)(e,[{key:"setBackgroundIsTransparent",value:function(e){this.backgroundIsTransparent=e}},{key:"setSelection",value:function(e){this.selection=e,this.selectionBounds=(0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(this.selection)),this.transform=(0,$83Kse.identity)()}},{key:"isTransformationChanged",value:function(){for(var e=(0,$83Kse.identity)(),t=Object.keys(e),i=0;i<t.length;i++){var n=t[i];if(e[n]!==this.transform[n])return!0}return!1}},{key:"reset",value:function(){this.transform=(0,$83Kse.identity)(),this.selection=[],this.selectionBounds={x1:0,y1:0,x2:0,y2:0}}},{key:"translate",value:function(e){this.transform=(0,$dZ59l.compose)((0,$kr2fR.translate)(e.x,e.y),this.transform)}},{key:"center",value:function(e,t){var i={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},n=(0,$cdZRx.applyToPoint)(this.transform,i);this.transform=(0,$dZ59l.compose)((0,$kr2fR.translate)(e-n.x,t-n.y),this.transform)}},{key:"flip",value:function(e){var t={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},i=(0,$cdZRx.applyToPoint)(this.transform,t);this.transform=(0,$dZ59l.compose)((0,$kr2fR.translate)(i.x,i.y),(0,$kFecW.scale)("x"===e?-1:1,"y"===e?-1:1),(0,$kr2fR.translate)(-i.x,-i.y),this.transform)}},{key:"scale",value:function(e){var t={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},i=(0,$cdZRx.applyToPoint)(this.transform,t);this.transform=(0,$dZ59l.compose)((0,$kr2fR.translate)(i.x,i.y),(0,$kFecW.scale)(e),(0,$kr2fR.translate)(-i.x,-i.y),this.transform)}},{key:"setDoClone",value:function(e){this.doClone=e}},{key:"getDoClone",value:function(){return this.doClone}},{key:"getTransform",value:function(){return this.transform}},{key:"setTransform",value:function(e){this.transform=e}},{key:"getTransformedSelection",value:function(){return(0,$bbA6w.transformMultiPolygon)(this.selection,this.getTransform())}},{key:"setSelectionSample",value:function(e){this.selectionSample=e}},{key:"setAlgorithm",value:function(e){this.algorithm=e}},{key:"getAlgorithm",value:function(){return this.algorithm}},{key:"createComposite",value:function(e){var t=this,i=(0,$9b3eo.getSelectionPath2d)(this.selection),n=this.getTransform();return{draw:function(r){if(r.save(),$bf77e842daed0824$export$a8cb0d8fd60b16e8(r,t.algorithm),t.selectionSample&&t.doClone){if(t.selectionSample.image){(s=r).setTransform.apply(s,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(n))),r.clip(i);var a,s,o,l=(0,$dZ59l.compose)(n,t.selectionSample.transformation);(o=r).setTransform.apply(o,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(l))),r.drawImage(t.selectionSample.image,0,0)}}else t.doClone||(r.save(),r.clip(i),t.backgroundIsTransparent?r.clearRect(0,0,e.width,e.height):(r.globalCompositeOperation="source-in",r.fillStyle="#fff",r.fillRect(0,0,e.width,e.height)),r.restore()),(a=r).setTransform.apply(a,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(n))),r.clip(i),r.drawImage(e,0,0);r.restore()}}}},{key:"createSourceComposite",value:function(e){var t=this,i=(0,$9b3eo.getSelectionPath2d)(this.selection);if(!this.doClone)return{draw:function(n){n.save(),$bf77e842daed0824$export$a8cb0d8fd60b16e8(n,t.algorithm),n.clip(i),t.backgroundIsTransparent?n.clearRect(0,0,e.width,e.height):(n.globalCompositeOperation="source-in",n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height)),n.restore()}}}},{key:"createTargetComposite",value:function(e){var t=this,i=(0,$9b3eo.getSelectionPath2d)(this.selection),n=this.getTransform();return{draw:function(r){if(r.save(),$bf77e842daed0824$export$a8cb0d8fd60b16e8(r,t.algorithm),t.selectionSample&&t.doClone){if(t.selectionSample.image){(s=r).setTransform.apply(s,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(n))),r.clip(i);var a,s,o,l=(0,$dZ59l.compose)(n,t.selectionSample.transformation);(o=r).setTransform.apply(o,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(l))),r.drawImage(t.selectionSample.image,0,0)}}else(a=r).setTransform.apply(a,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(n))),r.clip(i),r.drawImage(e,0,0);r.restore()}}}}]),e}();function $3d292a495f65a250$var$transformFreeTransformViaMatrix(e,t){var i=e.width,n=e.height,r=(0,$dZ59l.compose)((0,$kr2fR.translate)(e.x,e.y),(0,$1RMPr.rotate)(e.angleDeg/180*Math.PI)),a=(0,$cdZRx.applyToPoint)(t,e),s=(0,$cdZRx.applyToPoint)(r,{x:0,y:1}),o=(0,$cdZRx.applyToPoint)(t,s),l=(0,$eg83P.pointsToAngleDeg)(a,o)-90,h=(0,$cdZRx.applyToPoint)(r,{x:-i/2,y:-n/2}),c=(0,$cdZRx.applyToPoint)(r,{x:i/2,y:-n/2}),u=(0,$cdZRx.applyToPoint)(r,{x:-i/2,y:n/2}),d=(0,$dZ59l.compose)((0,$1RMPr.rotate)(-l/180*Math.PI,a.x,a.y),t),p=(0,$cdZRx.applyToPoint)(d,h),f=(0,$cdZRx.applyToPoint)(d,c),g=(0,$cdZRx.applyToPoint)(d,u),v=f.x-p.x,m=g.y-p.y;return{x:a.x,y:a.y,width:Math.round(v),height:Math.round(m),angleDeg:l}}var $3d292a495f65a250$var$modeToCursor={select:"default",transform:"move"},$3d292a495f65a250$var$operationToCursor={new:"default",union:"copy",difference:"alias"},$3d292a495f65a250$export$24961ed376c522a3=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.easel={},this.viewportTransform={},this.tempCtx=$eWjiX.BB.ctx($eWjiX.BB.canvas(1,1)),this.canvasSelection=[],this.selectionPath=(0,$9b3eo.getSelectionPath2d)([]),this.mode="select",this.isDragging=!1,this.selectSelectMode="select",this.didSelectionMove=!1,this.defaultBooleanOperation="new",this.selectShape="rect",this.polyShape=[],this.initialTransformMatrix={},this.initialFreeTransform={},this.freeTransformIsConstrained=!0,this.freeTransformIsSnapping=!0,this.doubleTapPointerTypes=["touch"],this.blockTrigger="alt",this.mode=t.selectMode,this.onStartSelect=t.onStartSelect,this.onGoSelect=t.onGoSelect,this.onEndSelect=t.onEndSelect,this.onStartMoveSelect=t.onStartMoveSelect,this.onGoMoveSelect=t.onGoMoveSelect,this.onEndMoveSelect=t.onEndMoveSelect,this.onSelectAddPoly=t.onSelectAddPoly,this.onResetSelection=t.onResetSelection,this.onFreeTransform=t.onFreeTransform,this.cornerPanning=new $201034f69477f047$export$4deed4c512c630c2({getEaselSize:function(){return i.easel.getSize()},getTransform:function(){return i.easel.getTargetTransform()},setTransform:function(e){return i.easel.setTransform(e,!0)},testCanPan:function(e){return(e||i.polyShape.length>1)&&("lasso"!==i.selectShape||"select"!==i.selectSelectMode)},onRepeatEvent:function(e){"select"===i.mode?i.selectOnPointer(e):i.transformOnPointer(e)}}),this.pointerChain=new(0,$gCzYB.EventChain)({chainArr:[new(0,$c1lmK.DoubleTapper)({onDoubleTap:function(e){if(!(i.polyShape.length<3)){var n=i.polyShape.map(function(e){return{x:e.x,y:e.y}});i.resetPolyShape(),n.length>1&&(n.push((0,$cL71g._)({},n[0])),t.onSelectAddPoly(n,i.appliedBooleanOperation))}},isInstant:!0})]}),this.svgEl=$eWjiX.BB.createSvg({elementType:"g"}),this.htmlEl=$eWjiX.BB.el()}return(0,$7h4XF._)(e,[{key:"viewportToCanvas",value:function(e){var t=(0,$kDVZW.inverse)($92816524e1b72be4$export$ad1d215dd03fe75a(this.easel.getTransform()));return(0,$cdZRx.applyToPoint)(t,e)}},{key:"updateSelectionPath",value:function(){this.selectionPath=(0,$9b3eo.getSelectionPath2d)(this.canvasSelection)}},{key:"resetPolyShape",value:function(){return 0!==this.polyShape.length&&(this.polyShape=[],this.doubleTapPointerTypes=["touch"],this.easel.updateDoubleTapPointerTypes(),this.easel.requestRender(),!0)}},{key:"getEffectiveBooleanOperation",value:function(){var e="new"===this.defaultBooleanOperation?this.easel.keyListener.isPressed("alt"):"difference"===this.defaultBooleanOperation,t="new"===this.defaultBooleanOperation?this.easel.keyListener.isPressed("shift"):"union"===this.defaultBooleanOperation;return e?"difference":t?"union":"new"}},{key:"getDoMoveSelection",value:function(e,t){var i=this.polyShape.length<2&&this.selectionPath&&this.tempCtx.isPointInPath(this.selectionPath,t.x,t.y);return"new"===e&&i}},{key:"selectOnPointer",value:function(e){var t,i=this.getEffectiveBooleanOperation(),n=this.isDragging,r=this.viewportToCanvas({x:e.relX,y:e.relY}),a=this.getDoMoveSelection(i,r);if("pointerdown"===e.type&&(this.isDragging=!0,a?this.selectSelectMode="move":this.selectSelectMode="select"),"pointerup"===e.type&&(this.isDragging=!1),"move"===this.selectSelectMode)"pointerdown"===e.type&&"left"===e.button&&(this.didSelectionMove=!1,this.onStartMoveSelect(r)),"pointermove"===e.type&&"left"===e.button&&(this.didSelectionMove=!0,this.onGoMoveSelect(r)),"pointerup"===e.type&&(this.onEndMoveSelect(),this.didSelectionMove||this.onResetSelection());else if("poly"===this.selectShape){if("pointermove"===e.type&&((null==(s=this.polyShape[this.polyShape.length-1])?void 0:s.temp)&&this.polyShape.pop(),this.polyShape.push((0,$4EWN2._)((0,$cL71g._)({},r),{temp:!0})),this.easel.requestRender()),"pointerup"===e.type&&n){this.polyShape.length<2&&(this.appliedBooleanOperation=i),this.doubleTapPointerTypes=[],this.easel.updateDoubleTapPointerTypes(),(null==(o=this.polyShape[this.polyShape.length-1])?void 0:o.temp)&&this.polyShape.pop();var s,o,l=this.polyShape[this.polyShape.length-1];l&&r.x===l.x&&r.y===l.y||(this.polyShape.push(r),this.easel.requestRender());var h=this.polyShape[0],c=this.polyShape[this.polyShape.length-1];if(this.polyShape.length>2&&$eWjiX.BB.dist(h.x,h.y,c.x,c.y)*this.viewportTransform.scale<4){this.polyShape.pop(),this.polyShape.push((0,$cL71g._)({},this.polyShape[0]));var u=this.polyShape;this.polyShape=[],this.onSelectAddPoly(u,this.appliedBooleanOperation),this.appliedBooleanOperation=void 0}}}else"pointerdown"===e.type&&"left"===e.button&&(this.appliedBooleanOperation=i,this.onStartSelect(r,this.appliedBooleanOperation)),"pointermove"===e.type&&"left"===e.button&&this.isDragging&&this.onGoSelect(r),"pointerup"===e.type&&n&&(this.onEndSelect(),this.appliedBooleanOperation=void 0);e.button||(a?this.selectSelectMode="move":this.selectSelectMode="select"),"move"===this.selectSelectMode?this.easel.setCursor("move"):this.easel.setCursor($3d292a495f65a250$var$operationToCursor[null!=(t=this.appliedBooleanOperation)?t:i])}},{key:"transformOnPointer",value:function(e){this.easel.setCursor("default")}},{key:"onPointerChainOut",value:function(e){"select"===this.mode?(this.cornerPanning.onPointer(e),this.selectOnPointer(e)):this.transformOnPointer(e)}},{key:"createFreeTransform",value:function(){var e=this,t=!0;this.freeTransform=new $0370167ee97a20d9$export$79a74567acf241b0({x:1,y:1,width:1,height:1,angleDeg:0,isConstrained:this.freeTransformIsConstrained,snapX:[],snapY:[],viewportTransform:{scale:1,x:0,y:0,angleDeg:0},callback:function(i){if(t){t=!1;return}if(e.selection&&"select"!==e.mode&&e.selectionBounds){var n=$512c3ce4311decfe$export$e464a809f7257768(i,e.selectionBounds),r=(0,$dZ59l.compose)(n,(0,$kDVZW.inverse)(e.initialTransformMatrix));e.onFreeTransform(r)}},onWheel:this.easel.onWheel,wheelParent:this.easel.getElement()}),this.freeTransform.setSnapping(this.freeTransformIsSnapping),this.htmlEl.append(this.freeTransform.getElement()),this.freeTransform.setViewportTransform(this.viewportTransform)}},{key:"destroyFreeTransform",value:function(){var e,t;null==(e=this.freeTransform)||e.getElement().remove(),null==(t=this.freeTransform)||t.destroy(),this.freeTransform=void 0}},{key:"getSvgElement",value:function(){return this.svgEl}},{key:"getHtmlOverlayElement",value:function(){return this.htmlEl}},{key:"onPointer",value:function(e){this.onPointerChainOut(e),this.pointerChain.chainIn(e)}},{key:"setEaselInterface",value:function(e){this.easel=e,this.viewportTransform=this.easel.getTransform()}},{key:"setMode",value:function(e){this.mode=e,this.resetPolyShape(),"transform"===this.mode?this.createFreeTransform():this.destroyFreeTransform()}},{key:"onTool",value:function(e){"select"===e?this.htmlEl.style.display="block":this.htmlEl.style.display="none"}},{key:"activate",value:function(e,t){this.easel.setCursor($3d292a495f65a250$var$modeToCursor[this.mode]),this.isDragging=!1,this.onUpdateTransform(this.easel.getTransform()),t||this.resetPolyShape()}},{key:"onUpdateTransform",value:function(e){var t;this.viewportTransform=e,this.updateSelectionPath(),null==(t=this.freeTransform)||t.setViewportTransform(e)}},{key:"onUpdateSelection",value:function(e){this.canvasSelection=e||[],this.updateSelectionPath()}},{key:"setRenderedSelection",value:function(e){this.selection=e,this.easel.setRenderedSelection(e)}},{key:"updateInitialTransformMatrix",value:function(){if(this.freeTransform){var e=this.freeTransform.getValue();this.initialFreeTransform=e,this.initialTransformMatrix=$512c3ce4311decfe$export$e464a809f7257768(e,this.selectionBounds)}}},{key:"initialiseTransform",value:function(e){this.selectionBounds={x1:0,y1:0,x2:e.x2-e.x1,y2:e.y2-e.y1};var t,i,n=(0,$eg83P.boundsToRect)(e,!1);null==(t=this.freeTransform)||t.initialise({x:n.x+n.width/2,y:n.y+n.height/2,width:n.width,height:n.height,angleDeg:0});var r=this.easel.getProjectSize(),a=r.width,s=r.height;null==(i=this.freeTransform)||i.setSnappingPoints([0,a],[0,s]),this.updateInitialTransformMatrix()}},{key:"setTransform",value:function(e){var t,i=$3d292a495f65a250$var$transformFreeTransformViaMatrix(this.initialFreeTransform,e);null==(t=this.freeTransform)||t.initialise(i)}},{key:"clearRenderedSelection",value:function(e){this.easel.clearRenderedSelection(e)}},{key:"setBooleanOperation",value:function(e){this.defaultBooleanOperation=e}},{key:"setSelectShape",value:function(e){this.resetPolyShape(),this.selectShape=e}},{key:"getIsLocked",value:function(){return this.isDragging}},{key:"renderAfterViewport",value:function(e,t){if(!(this.polyShape.length<2)){e.save(),e.globalCompositeOperation="difference",e.beginPath();var i=this.polyShape;e.moveTo(i[0].x,i[0].y);for(var n=1;n<i.length;n++)e.lineTo(i[n].x,i[n].y);e.lineWidth=1/t.scaleX,e.strokeStyle="white",e.lineCap="round",e.lineJoin="round",e.stroke(),e.restore()}}},{key:"onKeyDown",value:function(e,t){"esc"===e&&this.resetPolyShape()&&t.preventDefault()}},{key:"onClickOutside",value:function(){this.resetPolyShape()}},{key:"onBlur",value:function(){this.resetPolyShape()}},{key:"onArrowKeys",value:function(e){if(!this.freeTransform)return!1;var t={x:0,y:0};return"left"===e&&(t={x:-1,y:0}),"right"===e&&(t={x:1,y:0}),"up"===e&&(t={x:0,y:-1}),"down"===e&&(t={x:0,y:1}),this.easel.isKeyPressed("shift")&&(t.x*=5,t.y*=5),this.freeTransform.move(t.x,t.y),!0}},{key:"setIsConstrained",value:function(e){var t;this.freeTransformIsConstrained=e,null==(t=this.freeTransform)||t.setIsConstrained(e)}},{key:"setIsSnapping",value:function(e){var t;this.freeTransformIsSnapping=e,null==(t=this.freeTransform)||t.setSnapping(e)}},{key:"getFreeTransformTransformation",value:function(){var e;return null==(e=this.freeTransform)?void 0:e.getValue()}},{key:"rotateFreeTransform",value:function(e){if(this.freeTransform&&this.selectionBounds){var t=(this.freeTransform.getValue().angleDeg+e)%360;this.freeTransform.setAngleDeg(t);var i=$512c3ce4311decfe$export$e464a809f7257768(this.freeTransform.getValue(),this.selectionBounds),n=(0,$dZ59l.compose)(i,(0,$kDVZW.inverse)(this.initialTransformMatrix));this.onFreeTransform(n)}}}]),e}(),$7jh4K=parcelRequire("7jh4K"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$8N5YG=parcelRequire("8N5YG");function $87b240a7315255f9$export$1b1b9d54d324857f(e,t,i,n,r){for(var a=[],s=2*Math.PI/r,o=0;o<2*Math.PI;o+=s)a.push([Math.cos(o)*i+e,Math.sin(o)*n+t]);return[a]}var $eWjiX=parcelRequire("eWjiX"),$29bdc5a628b41259$export$6f71e8a0179bd005=2;function $29bdc5a628b41259$export$1f0b3b9c2ff2269f(e){return parseFloat(e.toFixed($29bdc5a628b41259$export$6f71e8a0179bd005))}function $29bdc5a628b41259$export$9ff2e12a5746572e(e){return e.map(function(e){return e.map(function(e){var t=(0,$8N5YG._)(e,2),i=t[0],n=t[1];return[$29bdc5a628b41259$export$1f0b3b9c2ff2269f(i),$29bdc5a628b41259$export$1f0b3b9c2ff2269f(n)]})})}var $29bdc5a628b41259$export$53d9e71218013355=function(){"use strict";function e(t){(0,$cx0mh._)(this,e),this.shape="rect",this.selectOperation="new",this.selectDragInputs=[],this.didMove=!1,this.klCanvas=t.klCanvas}return(0,$7h4XF._)(e,[{key:"reset",value:function(){this.selection=void 0}},{key:"combineSelection",value:function(e){var t,i=null!=(t=this.selection)?t:[];return"new"===this.selectOperation?i=[e]:this.selection&&this.selection.length>0?i=$0b0ef140191bcf10$export$7ec1a3fdd6e82838("difference"===this.selectOperation?"difference":"union",this.selection,e):"union"===this.selectOperation&&(i=[e]),i}},{key:"getSelection",value:function(){var e=this.selection||[];if(this.selectDragInputs.length>1)if(this.selectOperation,"rect"===this.shape){var t=this.selectDragInputs[0],i=this.selectDragInputs[this.selectDragInputs.length-1],n=Math.floor(Math.min(t.x,i.x)),r=Math.floor(Math.min(t.y,i.y)),a=Math.ceil(Math.max(t.x,i.x)),s=Math.ceil(Math.max(t.y,i.y));e=this.combineSelection([[[n,r],[a,r],[a,s],[n,s]]])}else if("ellipse"===this.shape){var o=this.selectDragInputs[0],l=this.selectDragInputs[this.selectDragInputs.length-1],h=(o.x+l.x)/2,c=(o.y+l.y)/2,u=Math.abs(l.x-o.x)/2,d=Math.abs(l.y-o.y)/2;e=this.combineSelection($29bdc5a628b41259$export$9ff2e12a5746572e($87b240a7315255f9$export$1b1b9d54d324857f(h,c,u,d,50)))}else"lasso"===this.shape&&(e=this.combineSelection([this.selectDragInputs.map(function(e){return[$29bdc5a628b41259$export$1f0b3b9c2ff2269f(e.x),$29bdc5a628b41259$export$1f0b3b9c2ff2269f(e.y)]})]));return 0===e.length?void 0:e}},{key:"startSelect",value:function(e,t){this.selectOperation=t,"new"===this.selectOperation&&this.reset(),this.selectDragInputs=[e]}},{key:"goSelect",value:function(e){this.selectDragInputs.push({x:e.x,y:e.y})}},{key:"endSelect",value:function(){this.selectDragInputs.length>1?this.selection=this.getSelection():this.reset(),this.selectDragInputs=[]}},{key:"addPoly",value:function(e,t){this.selectOperation=t,this.selection=this.combineSelection([e.map(function(e){return[$29bdc5a628b41259$export$1f0b3b9c2ff2269f(e.x),$29bdc5a628b41259$export$1f0b3b9c2ff2269f(e.y)]})])}},{key:"startMoveSelect",value:function(e){this.moveLastPos=e,this.didMove=!1}},{key:"goMoveSelect",value:function(e){if(this.moveLastPos){this.didMove=!0;var t=Math.round(e.x-this.moveLastPos.x),i=Math.round(e.y-this.moveLastPos.y);this.selection&&(this.selection=$f2ea5f654adc2709$export$199acb5b15c43176(this.selection,t,i)),this.moveLastPos={x:this.moveLastPos.x+t,y:this.moveLastPos.y+i}}}},{key:"endMoveSelect",value:function(){this.moveLastPos=void 0}},{key:"getDidMove",value:function(){return this.didMove}},{key:"selectAll",value:function(){this.reset();var e=this.klCanvas.getWidth(),t=this.klCanvas.getHeight();this.selection=[[[[0,0],[e,0],[e,t],[0,t],[0,0]]]]}},{key:"invertSelection",value:function(){var e,t=null!=(e=this.selection)?e:[],i=this.klCanvas.getWidth(),n=this.klCanvas.getHeight();this.selection=$0b0ef140191bcf10$export$7ec1a3fdd6e82838("difference",[[[0,0],[i,0],[i,n],[0,n]]],t)}},{key:"setShape",value:function(e){this.shape=e}},{key:"getShape",value:function(){return this.shape}},{key:"setSelection",value:function(e){this.selection=e?$eWjiX.BB.copyObj(e).map($29bdc5a628b41259$export$9ff2e12a5746572e):void 0}}]),e}();parcelRequire("ciAU9");var $83Kse=parcelRequire("83Kse"),$eg83P=parcelRequire("eg83P"),$cL71g=parcelRequire("cL71g"),$4EWN2=parcelRequire("4EWN2"),$bX4ja=parcelRequire("bX4ja");parcelRequire("ciAU9");var $dZ59l=parcelRequire("dZ59l"),$83Kse=parcelRequire("83Kse"),$kr2fR=parcelRequire("kr2fR"),$eg83P=parcelRequire("eg83P");function $83e9d90767208815$export$a70ad15f9d5e7f79(e){if(e.image)return(0,$eg83P.integerBounds)($32a8ea052c2ead31$export$7efa1f930df882cc({x1:0,y1:0,x2:e.image.width,y2:e.image.height},e.transformation))}var $eWjiX=parcelRequire("eWjiX"),$bbA6w=parcelRequire("bbA6w"),$9b3eo=parcelRequire("9b3eo");function $2fd1f16943677fce$var$createSelectionSample(e,t){var i=t.getLayersRaw()[e],n=$4ae5c842364e8628$export$6be4733fa804854c(t.getSelectionOrFallback(),i.context);if(!n)return{image:void 0,transformation:(0,$83Kse.identity)()};var r=$eWjiX.BB.canvas(n.width,n.height),a=$eWjiX.BB.ctx(r);return a.save(),a.translate(-n.x,-n.y),a.drawImage(i.canvas,0,0),a.restore(),{image:r,transformation:(0,$kr2fR.translate)(n.x,n.y)}}function $2fd1f16943677fce$var$transformSelectionAndSample(e,t,i){return{selection:i?(0,$bbA6w.transformMultiPolygon)(i,e):void 0,selectionSample:(0,$4EWN2._)((0,$cL71g._)({},t),{transformation:(0,$dZ59l.compose)([e,t.transformation])})}}function $2fd1f16943677fce$var$drawSelectionSample(e,t,i,n){if(i.image){var r,a=n.getLayersRaw(),s=a[e],o=$eWjiX.BB.ctx(s.canvas),l=n.getSelectionOrFallback(),h=(0,$9b3eo.getSelectionPath2d)(l);o.save(),o.clip(h),(r=o).setTransform.apply(r,(0,$bX4ja._)($c9ab5bbe74e01c89$export$2b60e7dafdbde18a(i.transformation))),$bf77e842daed0824$export$a8cb0d8fd60b16e8(o,t?"pixelated":"smooth"),o.drawImage(i.image,0,0),o.restore()}}function $2fd1f16943677fce$export$1653b9fe2026bf29(e){var t,i,n=e.klCanvas.getKlHistory(),r=e.klCanvas.getLayersRaw();n.pause(!0);var a=$2fd1f16943677fce$var$createSelectionSample(e.sourceLayer,e.klCanvas),s=$83e9d90767208815$export$a70ad15f9d5e7f79(a);e.klCanvas.eraseLayer({layerIndex:e.sourceLayer,useSelection:!0,useAlphaLock:0===e.sourceLayer&&!e.backgroundIsTransparent});var o=$2fd1f16943677fce$var$transformSelectionAndSample(e.transformation,a,e.klCanvas.getSelection());a=o.selectionSample,e.klCanvas.setSelection(o.selection);var l=$83e9d90767208815$export$a70ad15f9d5e7f79(a);$2fd1f16943677fce$var$drawSelectionSample(null!=(t=e.targetLayer)?t:e.sourceLayer,null!=(i=e.isPixelated)&&i,a,e.klCanvas),n.pause(!1);var h=!e.targetLayer||e.sourceLayer===e.targetLayer;if(!n.isPaused()){var c=r[e.sourceLayer],u=void 0!==e.targetLayer&&e.targetLayer!==e.sourceLayer?r[e.targetLayer]:void 0;n.push({selection:{value:e.klCanvas.getSelection()},layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(r,{layerId:c.id,attributes:["tiles"],bounds:h?$eWjiX.BB.updateBounds(s,l):s},u?{layerId:u.id,attributes:["tiles"],bounds:l}:void 0)})}return a}function $2fd1f16943677fce$export$97eaf46efcb3997(e){var t,i=e.klCanvas.getKlHistory(),n=e.klCanvas.getLayersRaw(),r=e.selectionSample;if(i.pause(!0),!r){if(void 0===e.sourceLayer)throw Error("no source layer");r=$2fd1f16943677fce$var$createSelectionSample(e.sourceLayer,e.klCanvas)}var a=$2fd1f16943677fce$var$transformSelectionAndSample(e.transformation,r,e.klCanvas.getSelection());r=a.selectionSample,e.klCanvas.setSelection(a.selection),$2fd1f16943677fce$var$drawSelectionSample(e.targetLayer,null!=(t=e.isPixelated)&&t,r,e.klCanvas);var s=$83e9d90767208815$export$a70ad15f9d5e7f79(r);if(i.pause(!1),!i.isPaused()&&s){var o=n[e.targetLayer];i.push({selection:{value:e.klCanvas.getSelection()},layerMap:$17f5ce4410029f54$export$7cefb04ac49374c4(n,{layerId:o.id,attributes:["tiles"],bounds:s})})}return r}var $eWjiX=parcelRequire("eWjiX");function $f177420b33748502$var$isSelectTransformTempEntry(e){return"select-transform"===e.type&&!!e.data}var $f177420b33748502$export$e471993a29671b7=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.selectMode="select",this.targetLayerIndex=0,this.initialTransform={transform:(0,$83Kse.identity)(),doClone:!1,targetLayerIndex:0,backgroundIsTransparent:!1,algorithm:"smooth"},this.backgroundIsTransparent=!1,this.selectionSample=void 0,this.klCanvas=t.klCanvas,this.onUpdateProject=t.onUpdateProject,this.getCurrentLayerCtx=t.getCurrentLayerCtx,this.klHistory=t.klHistory,this.tempHistory=t.tempHistory,this.statusOverlay=t.statusOverlay,this.onFill=t.onFill,this.onErase=t.onErase,this.klHistory.addListener(function(){i.selectUi.setHasSelection(!!i.klCanvas.getSelection()),"transform"===i.selectMode&&i.updateUiLayerList()}),this.selectTool=new $29bdc5a628b41259$export$53d9e71218013355({klCanvas:this.klCanvas}),this.transformTool=new $512c3ce4311decfe$export$68f5601e78b8ada8,this.easelSelect=new $3d292a495f65a250$export$24961ed376c522a3({selectMode:this.selectMode,onStartSelect:function(e,t){return i.selectTool.startSelect(e,t)},onGoSelect:function(e){i.selectTool.goSelect(e),i.easelSelect.setRenderedSelection(i.selectTool.getSelection())},onEndSelect:function(){i.selectTool.endSelect();var e=i.selectTool.getSelection();i.easelSelect.clearRenderedSelection(),i.klCanvas.setSelection(e),i.selectUi.setHasSelection(!!e)},onStartMoveSelect:function(e){i.selectTool.startMoveSelect(e)},onGoMoveSelect:function(e){i.selectTool.goMoveSelect(e),i.easelSelect.setRenderedSelection(i.selectTool.getSelection())},onEndMoveSelect:function(){if(i.selectTool.endMoveSelect(),i.selectTool.getDidMove()){var e=i.selectTool.getSelection();i.easelSelect.clearRenderedSelection(),i.klCanvas.setSelection(e),i.selectUi.setHasSelection(!!e)}},onSelectAddPoly:function(e,t){i.selectTool.addPoly(e,t);var n=i.selectTool.getSelection();i.klCanvas.setSelection(n),i.selectUi.setHasSelection(!!n)},onResetSelection:function(){return i.resetSelection()},onFreeTransform:function(e){i.transformTool.setTransform(e),i.propagateTransformationChange()}}),this.selectUi=new $79d09d3423439479$export$b3e6ed306341f794({onChangeMode:function(e){if(i.selectMode=e,"select"===i.selectMode){i.tempHistory.clear(),i.tempHistory.setIsActive(!1);var n=(0,$7jh4K.throwIfNull)(i.klCanvas.getLayerIndex(i.getCurrentLayerCtx().canvas));(i.transformTool.isTransformationChanged()||i.transformTool.getDoClone()||n!==i.targetLayerIndex)&&(i.transformTool.getDoClone()?$2fd1f16943677fce$export$97eaf46efcb3997({klCanvas:i.klCanvas,selectionSample:i.selectionSample,sourceLayer:n,targetLayer:i.targetLayerIndex,transformation:i.transformTool.getTransform(),isPixelated:"pixelated"===i.transformTool.getAlgorithm()}):$2fd1f16943677fce$export$1653b9fe2026bf29({klCanvas:i.klCanvas,sourceLayer:n,targetLayer:i.targetLayerIndex,transformation:i.transformTool.getTransform(),backgroundIsTransparent:i.backgroundIsTransparent,isPixelated:"pixelated"===i.transformTool.getAlgorithm()}),t.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("select-transform-applied"),!0)),i.selectionSample=void 0,i.transformTool.setSelectionSample(i.selectionSample),i.klCanvas.setComposite(n,void 0),i.klCanvas.setComposite(i.targetLayerIndex,void 0),i.easelSelect.clearRenderedSelection(!0);var r=i.klCanvas.getSelection();i.selectTool.setSelection(r),i.selectUi.setHasSelection(!!r),i.onUpdateProject(),i.easelSelect.setMode(i.selectMode)}else{i.tempHistory.setIsActive(!0);var a=i.selectTool.getSelection()||[];if(0===a.length){var s=$eWjiX.BB.canvasBounds(i.getCurrentLayerCtx());a=[[[[s.x,s.y],[s.x+s.width,s.y],[s.x+s.width,s.height+s.y],[s.x,s.height+s.y],[s.x,s.y]]]]}i.transformTool.setSelection(a),i.transformTool.setDoClone(!1),i.transformTool.setSelectionSample(i.selectionSample);var o=i.getCurrentLayerCtx().canvas,l=(0,$7jh4K.throwIfNull)(i.klCanvas.getLayerIndex(o));i.initialTransform.targetLayerIndex=l,i.initialTransform.backgroundIsTransparent=i.backgroundIsTransparent,i.initialTransform.algorithm=i.transformTool.getAlgorithm(),i.targetLayerIndex=l;var h=0===l;i.selectUi.setShowTransparentBackgroundToggle(h);var c=!1;h&&(c=$31a0dd41d7428d32$export$d7a217b118c790a6(Object.entries(i.klHistory.getComposed().layerMap).find(function(e){var t=(0,$8N5YG._)(e,2);return(t[0],t[1]).index===l})[1]),i.selectUi.setBackgroundIsTransparent(c)),i.backgroundIsTransparent=c,i.initialTransform.backgroundIsTransparent=c,i.transformTool.setBackgroundIsTransparent(i.isSourceLayerBackgroundTransparent()),i.updateComposites(),i.selectUi.setHasSelection(!!a),i.updateUiLayerList(),i.selectUi.setMoveToLayer(void 0),i.onUpdateProject(),i.easelSelect.setMode(i.selectMode);var u=i.transformTool.getTransformedSelection();i.easelSelect.setRenderedSelection(u),i.easelSelect.initialiseTransform((0,$eg83P.integerBounds)($2c64e9e8cb297da3$export$a04a50ae6d6450f8(a))),i.updateSelectUi()}},onChangeBooleanOperation:function(e){i.easelSelect.setBooleanOperation(e)},canTransform:function(){var e=(0,$7jh4K.throwIfNull)(i.klCanvas.getLayerIndex(i.getCurrentLayerCtx().canvas)),t=!!i.klCanvas.getSelectionArea(e);return t||setTimeout(function(){$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:$8d7403abedf7cefa$export$ce37e184d908d785("select-transform-empty"),type:"error"})}),t},select:{shape:this.selectTool.getShape(),onChangeShape:function(e){i.selectTool.setShape(e),i.easelSelect.setSelectShape(e)},onReset:function(){return i.resetSelection()},onAll:function(){i.selectTool.selectAll();var e=i.selectTool.getSelection();i.klCanvas.setSelection(e),i.selectUi.setHasSelection(!!e)},onInvert:function(){i.selectTool.invertSelection();var e=i.selectTool.getSelection();i.klCanvas.setSelection(e),i.selectUi.setHasSelection(!!e)}},transform:{onFlipY:function(){i.transformTool.flip("y"),i.propagateTransformationChange(),i.easelSelect.setTransform(i.transformTool.getTransform())},onFlipX:function(){i.transformTool.flip("x"),i.propagateTransformationChange(),i.easelSelect.setTransform(i.transformTool.getTransform())},onRotateDeg:function(e){i.easelSelect.rotateFreeTransform(e)},onClone:function(){i.tempHistory.clear();var e=(0,$7jh4K.throwIfNull)(i.klCanvas.getLayerIndex(i.getCurrentLayerCtx().canvas));i.transformTool.getDoClone()?i.selectionSample=$2fd1f16943677fce$export$97eaf46efcb3997({klCanvas:i.klCanvas,selectionSample:i.selectionSample,sourceLayer:e,targetLayer:i.targetLayerIndex,transformation:i.transformTool.getTransform(),isPixelated:"pixelated"===i.transformTool.getAlgorithm()}):i.transformTool.isTransformationChanged()&&(i.selectionSample=$2fd1f16943677fce$export$1653b9fe2026bf29({klCanvas:i.klCanvas,sourceLayer:e,targetLayer:i.targetLayerIndex,transformation:i.transformTool.getTransform(),backgroundIsTransparent:i.backgroundIsTransparent,isPixelated:"pixelated"===i.transformTool.getAlgorithm()}));var t=i.transformTool.getTransformedSelection(),n=i.klCanvas.getSelection()||t;i.initialTransform.backgroundIsTransparent=i.backgroundIsTransparent,i.transformTool.setSelection(n),i.transformTool.setDoClone(!0),i.transformTool.setSelectionSample(i.selectionSample),i.updateComposites(),i.easelSelect.setRenderedSelection(i.transformTool.getTransformedSelection()),i.easelSelect.updateInitialTransformMatrix(),i.selectUi.setHasSelection(!!n),i.onUpdateProject(),i.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("select-transform-clone-applied"),!0)},onScale:function(e){i.transformTool.scale(e),i.propagateTransformationChange(),i.easelSelect.setTransform(i.transformTool.getTransform())},onCenter:function(){i.transformTool.center(i.klCanvas.getWidth()/2,i.klCanvas.getHeight()/2),i.propagateTransformationChange(),i.easelSelect.setTransform(i.transformTool.getTransform())},onMoveToLayer:function(e){i.resetComposites(),i.targetLayerIndex=e,i.updateComposites(),i.onUpdateProject(),i.tempHistoryReplaceTop()},onChangeTransparentBackground:function(e){i.backgroundIsTransparent=e,i.transformTool.setBackgroundIsTransparent(i.isSourceLayerBackgroundTransparent()),i.updateComposites(),i.onUpdateProject(),i.tempHistoryReplaceTop()},onChangeAlgorithm:function(e){i.transformTool.setAlgorithm(e),i.updateComposites(),i.onUpdateProject(),i.tempHistoryReplaceTop()},onChangeConstrain:function(e){i.easelSelect.setIsConstrained(e)},onChangeSnapping:function(e){i.easelSelect.setIsSnapping(e)}},onErase:function(){i.onErase()},onFill:function(){i.onFill()}}),this.klHistory.addListener(function(){var e=i.klCanvas.getSelection();"select"===i.selectMode&&i.selectTool.setSelection(e)})}return(0,$7h4XF._)(e,[{key:"isSourceLayerBackgroundTransparent",value:function(){var e=this.getCurrentLayerCtx();return(0,$7jh4K.throwIfNull)(this.klCanvas.getLayerIndex(e.canvas))>0||this.backgroundIsTransparent}},{key:"resetComposites",value:function(){var e=this.getCurrentLayerCtx(),t=(0,$7jh4K.throwIfNull)(this.klCanvas.getLayerIndex(e.canvas));this.klCanvas.setComposite(t,void 0),this.targetLayerIndex!==t&&this.klCanvas.setComposite(this.targetLayerIndex,void 0)}},{key:"updateComposites",value:function(){var e=this.getCurrentLayerCtx().canvas,t=(0,$7jh4K.throwIfNull)(this.klCanvas.getLayerIndex(e));t===this.targetLayerIndex?this.klCanvas.setComposite(t,this.transformTool.createComposite(e)):(this.klCanvas.setComposite(t,this.transformTool.createSourceComposite(e)),this.klCanvas.setComposite(this.targetLayerIndex,this.transformTool.createTargetComposite(e)))}},{key:"updateUiLayerList",value:function(){this.selectUi.setLayers(this.klCanvas.getLayers().map(function(e){return e.name}))}},{key:"resetSelection",value:function(){this.selectTool.reset();var e=this.selectTool.getSelection();this.klCanvas.setSelection(e),this.selectUi.setHasSelection(!!e)}},{key:"tempHistoryReplaceTop",value:function(){this.tempHistory.replaceTop({type:"select-transform",data:{transform:this.transformTool.getTransform(),doClone:this.transformTool.getDoClone(),targetLayerIndex:this.targetLayerIndex,backgroundIsTransparent:this.backgroundIsTransparent,algorithm:this.transformTool.getAlgorithm()}})}},{key:"propagateTransformationChange",value:function(){var e=this.transformTool.getTransformedSelection();this.easelSelect.setRenderedSelection(e),this.updateComposites(),this.onUpdateProject(),this.updateSelectUi(),this.tempHistoryReplaceTop()}},{key:"updateSelectUi",value:function(){var e=this.easelSelect.getFreeTransformTransformation();e&&this.selectUi.setFreeTransformTransformation(e)}},{key:"getSelectUi",value:function(){return this.selectUi}},{key:"getEaselSelect",value:function(){return this.easelSelect}},{key:"commitTransform",value:function(){var e=!1;return"transform"===this.selectMode&&(this.selectUi.setMode("select"),e=!0),e}},{key:"discardTransform",value:function(){if("transform"===this.selectMode){this.transformTool.reset(),this.transformTool.setDoClone(!1);var e=this.getCurrentLayerCtx().canvas;return this.targetLayerIndex=(0,$7jh4K.throwIfNull)(this.klCanvas.getLayerIndex(e)),this.selectUi.setMode("select"),!0}return!1}},{key:"onHistory",value:function(e){if("undo"===e)this.selectUi.setMode("select");else if("tempUndo"===e||"tempRedo"===e){this.resetComposites();var t=this.tempHistory.getEntries().at(-1),i=(0,$4EWN2._)((0,$cL71g._)({},this.initialTransform),{doClone:this.transformTool.getDoClone()});t&&$f177420b33748502$var$isSelectTransformTempEntry(t)&&(i=t.data),this.transformTool.setTransform(i.transform),this.transformTool.setDoClone(i.doClone),this.targetLayerIndex=i.targetLayerIndex,this.backgroundIsTransparent=i.backgroundIsTransparent,this.selectUi.setBackgroundIsTransparent(i.backgroundIsTransparent),this.transformTool.setBackgroundIsTransparent(this.isSourceLayerBackgroundTransparent()),this.selectUi.setAlgorithm(i.algorithm),this.transformTool.setAlgorithm(i.algorithm);var n=this.transformTool.getTransformedSelection();this.easelSelect.setRenderedSelection(n),this.easelSelect.setTransform(this.transformTool.getTransform()),this.selectUi.setMoveToLayer(this.klCanvas.getLayerIndex(this.getCurrentLayerCtx().canvas)===i.targetLayerIndex?void 0:i.targetLayerIndex),this.updateComposites(),this.onUpdateProject()}}},{key:"destroy",value:function(){}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$d3a44cd9d3ee7598$export$ab82e91194f5da86=function(){"use strict";function e(){(0,$cx0mh._)(this,e),this.entries=[],this.currentIndex=-1,this.listeners=[],this.isActive=!1}return(0,$7h4XF._)(e,[{key:"emit",value:function(e){this.listeners.forEach(function(t){return t(e)})}},{key:"push",value:function(e){var t=this;this.currentIndex<this.entries.length-1&&this.entries.splice(this.currentIndex+1),this.entries.push(e),this.currentIndex=this.entries.length-1,setTimeout(function(){return t.emit("push")})}},{key:"replaceTop",value:function(e){var t=this;this.entries.splice(this.currentIndex),this.entries.push(e),this.currentIndex=this.entries.length-1,setTimeout(function(){return t.emit("push")})}},{key:"canDecreaseIndex",value:function(){return this.currentIndex>-1}},{key:"canIncreaseIndex",value:function(){return this.currentIndex<this.entries.length-1}},{key:"decreaseIndex",value:function(){var e=this;this.canDecreaseIndex()&&(this.currentIndex--,setTimeout(function(){return e.emit("decrease")}))}},{key:"increaseIndex",value:function(){var e=this;this.canIncreaseIndex()&&(this.currentIndex++,setTimeout(function(){return e.emit("increase")}))}},{key:"getEntries",value:function(){return this.entries.slice(0,this.currentIndex+1)}},{key:"clear",value:function(){var e=this;this.entries=[],this.currentIndex=-1,setTimeout(function(){return e.emit("clear")})}},{key:"addListener",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"removeListener",value:function(e){var t=this;this.listeners.map(function(i,n){i===e&&t.listeners.splice(n,1)})}},{key:"setIsActive",value:function(e){this.isActive!==e&&(this.isActive=e,this.emit("active"))}},{key:"getIsActive",value:function(){return this.isActive}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$eWjiX=parcelRequire("eWjiX"),$7jh4K=parcelRequire("7jh4K"),$456806b212fdf6a8$export$3e66e8feec69f8d=function e(){"use strict";(0,$cx0mh._)(this,e);var t=function(){if(!n){var e=$eWjiX.BB.el({parent:document.body,css:{position:"fixed",inset:"0",zIndex:"-1"}}),t=e.getBoundingClientRect();e.remove();var o=(i.width!==Math.round(t.width)||i.height!==Math.round(t.height))&&i.scale>1;o?((0,$7jh4K.css)(r,{left:i.offsetLeft+"px",top:i.offsetTop+"px",width:i.width+"px",height:i.height+"px"}),s||(document.body.append(a),document.body.append(r))):s&&(a.remove(),r.remove()),s=o}};if("visualViewport"in window&&null!==visualViewport){var i=visualViewport,n=!1,r=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("browser-zoom-help"),className:"kl-pinch-overlay",css:{position:"fixed",pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"100",flexDirection:"column",gap:"10px",padding:"10px",backdropFilter:"blur(3px)"}});$eWjiX.BB.el({parent:r,tagName:"button",content:$8d7403abedf7cefa$export$ce37e184d908d785("dismiss"),onClick:function(){n=!0,a.remove(),r.remove()},css:{pointerEvents:"initial"}});var a=$eWjiX.BB.el({tagName:"iframe",css:{position:"fixed",width:"100vw",height:"100vh",zIndex:"99",opacity:"0"}}),s=!1;i.addEventListener("resize",t),i.addEventListener("scroll",t),setTimeout(t)}},$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$45179ad71c16c96a$export$cb9945923eaef1dd=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.doIgnore=!1,this.lastCanUndo=!1,this.lastCanRedo=!1,this.klHistory=t.klHistory,this.tempHistory=t.tempHistory,this.onCanUndoRedoChange=t.onCanUndoRedoChange;var n=function(){var e=i.canUndo(),t=i.canRedo();(i.lastCanUndo!==e||i.lastCanRedo!==t)&&(i.lastCanUndo=e,i.lastCanRedo=t,i.onCanUndoRedoChange(e,t))};this.klHistory.addListener(n),this.tempHistory.addListener(n)}return(0,$7h4XF._)(e,[{key:"testShouldSkip",value:function(){var e=this;return!!this.doIgnore||(this.doIgnore=!0,setTimeout(function(){e.doIgnore=!1},0),!1)}},{key:"canUndo",value:function(){return this.tempHistory.getIsActive()&&this.tempHistory.canDecreaseIndex()||this.klHistory.canUndo()}},{key:"canRedo",value:function(){return this.tempHistory.getIsActive()?this.tempHistory.canIncreaseIndex():this.klHistory.canRedo()}},{key:"undo",value:function(){return this.testShouldSkip()?void 0:this.tempHistory.getIsActive()&&this.tempHistory.canDecreaseIndex()?(this.tempHistory.decreaseIndex(),{type:"tempUndo"}):this.klHistory.canUndo()?(this.klHistory.decreaseIndex(),{type:"undo"}):void 0}},{key:"redo",value:function(){return this.testShouldSkip()?void 0:this.tempHistory.getIsActive()&&this.tempHistory.canIncreaseIndex()?(this.tempHistory.increaseIndex(),{type:"tempRedo"}):this.klHistory.canRedo()?(this.klHistory.increaseIndex(),{type:"redo"}):void 0}}]),e}(),$gWfkn=parcelRequire("gWfkn");function $0eb4c7d1339a9456$export$beb462111ff337c5(e){var t=Object.keys(e);return 1===t.length&&"activeLayerId"===t[0]}var $cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$bX4ja=parcelRequire("bX4ja"),$eWjiX=parcelRequire("eWjiX"),$6l0gQ=parcelRequire("6l0gQ"),$7jh4K=parcelRequire("7jh4K"),$ea23e70ae6749408$export$38b681d46b785af1=function(){"use strict";function e(t){var i,n=this;(0,$cx0mh._)(this,e),this.toolspaceIsOpen=!0,this.orientation="right",this.isVisible=!1,this.onShowToolspace=t.onShowToolspace,this.toolspaceCollapser=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ToolspaceCollapser({onChange:function(){n.toolspaceIsOpen=n.toolspaceCollapser.isOpen(),n.onShowToolspace(n.toolspaceIsOpen),n.toolspaceIsOpen?$6l0gQ.LocalStorage.removeItem("uiShowMobile"):$6l0gQ.LocalStorage.setItem("uiShowMobile","true")}}),this.mobileWrapperEl=$eWjiX.BB.el({css:{marginTop:"4px",display:"flex",flexDirection:"column",gap:"4px"}}),(i=this.mobileWrapperEl).append.apply(i,(0,$bX4ja._)(t.toolUis)),this.rootEl=$eWjiX.BB.el({css:{position:"absolute",top:"0",userSelect:"none"}}),this.rootEl.append(this.toolspaceCollapser.getElement(),this.mobileWrapperEl),this.update()}return(0,$7h4XF._)(e,[{key:"update",value:function(){this.isVisible?(this.toolspaceIsOpen?(this.mobileWrapperEl.style.display="none","left"===this.orientation?(0,$7jh4K.css)(this.rootEl,{left:"271px",right:""}):(0,$7jh4K.css)(this.rootEl,{left:"",right:"271px"})):(this.mobileWrapperEl.style.display="flex","left"===this.orientation?(0,$7jh4K.css)(this.rootEl,{left:"0",right:""}):(0,$7jh4K.css)(this.rootEl,{left:"",right:"0"})),this.rootEl.style.display="block"):this.rootEl.style.display="none"}},{key:"setOrientation",value:function(e){this.orientation=e,this.toolspaceCollapser.setOrientation(e)}},{key:"setIsVisible",value:function(e){this.isVisible=e}},{key:"getToolspaceIsOpen",value:function(){return this.toolspaceIsOpen}},{key:"setToolspaceIsOpen",value:function(e){this.toolspaceIsOpen=e,this.toolspaceCollapser.setIsOpen(e),this.onShowToolspace(e)}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$eWjiX=parcelRequire("eWjiX"),$78e60fb79fb423b6$export$87fd7552ee5cd26e=function(){"use strict";function e(t){(0,$cx0mh._)(this,e);var i=new $eae820938baa028e$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($1813762111ff3b93$exports),width:28,height:28,darkInvert:!0,css:{margin:"4px"}}),n=new $eae820938baa028e$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($749e6c1deca5fab7$exports),width:28,height:28,darkInvert:!0,css:{margin:"4px"}});this.brushOptions=new $7960d0c50ff12b0d$export$c019608e5b5bb4cb({optionArr:[{id:"brush",label:i.getElement(),title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-brush")},{id:"eraser",label:n.getElement(),title:$8d7403abedf7cefa$export$ce37e184d908d785("eraser")}],initId:"brush",onChange:function(e){"brush"===e?t.onBrush():t.onEraser()},isColumn:!0}),this.rootEl=$eWjiX.BB.el({css:{}}),this.rootEl.append(this.brushOptions.getElement())}return(0,$7h4XF._)(e,[{key:"setIsVisible",value:function(e){this.rootEl.style.display=e?"block":"none"}},{key:"setType",value:function(e){this.brushOptions.setValue(e,!0)}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$eIcQa=parcelRequire("eIcQa"),$bX4ja=parcelRequire("bX4ja"),$esGm2=parcelRequire("esGm2"),$eWjiX=parcelRequire("eWjiX");function $f2b7ac9d4f1c1625$export$f8f3f96593f6a47(e){var t="",i=Object.fromEntries(e.layers.map(function(i,n){t=$47ad43347dcf2f3c$export$b2ce7a8a096070e2();var r,a=[];return a=i.image instanceof Array?(0,$bX4ja._)(i.image):$1a6c9997bc8182ff$export$7b1ba44282f9a519(function(){if(i.image instanceof HTMLCanvasElement)return i.image;var t=$eWjiX.BB.canvas(e.width,e.height),n=$eWjiX.BB.ctx(t);return(0,$esGm2.isLayerFill)(i.image)?(n.fillStyle=i.image.fill,n.fillRect(0,0,e.width,e.height)):n.drawImage(i.image,0,0),t}()),[t,{name:i.name,opacity:i.opacity,isVisible:i.isVisible,mixModeStr:null!=(r=i.mixModeStr)?r:"source-over",index:n,tiles:a}]}));return{projectId:{value:e.projectId},size:{width:e.width,height:e.height},selection:{},activeLayerId:t,layerMap:i}}var $aSJRf=parcelRequire("aSJRf"),$7jh4K=parcelRequire("7jh4K"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$248aa716a9226bd7$export$747c5e57cda7ca57=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.onBeforeUnload=function(e){e.preventDefault(),e.returnValue=""},this.klHistory=t.klHistory,this.getLastSavedHistoryIndex=t.getLastSavedHistoryIndex,t.klHistory.addListener(function(){return i.update()})}return(0,$7h4XF._)(e,[{key:"update",value:function(){var e=this.klHistory.getTotalIndex();this.getLastSavedHistoryIndex()!==e?window.addEventListener("beforeunload",this.onBeforeUnload):window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"destroy",value:function(){}}]),e}(),$jTg9g=parcelRequire("jTg9g"),$1LaJZ=parcelRequire("1LaJZ"),$2gUX3=parcelRequire("2gUX3"),$eWjiX=parcelRequire("eWjiX");$b07b255a18a05a27$export$bb5ee47d9ea2348e="RP219q_banner",$b07b255a18a05a27$export$534219b709288da9="RP219q_btn",$b07b255a18a05a27$export$8001e369bcc9b474="RP219q_closeArea",$b07b255a18a05a27$export$efe229eab43a9869="RP219q_closeButton",$b07b255a18a05a27$export$ad430d422a89f9f0="RP219q_mainContent",$b07b255a18a05a27$export$48c2d0f2f545ac27="RP219q_preview",$b07b255a18a05a27$export$4a3e8128f471434a="RP219q_rightCol",$b07b255a18a05a27$export$e8e78c978b129247="RP219q_root",$b07b255a18a05a27$export$bbeb943159d69f5b="RP219q_rootAnim";var $7jh4K=parcelRequire("7jh4K"),$3uJxV=parcelRequire("3uJxV");function $ee60bdc4a11355ae$export$4a2ed1038e76f37f(e){return(0,$1LaJZ._)(function(){var t,i,n,r,a,s,o,l,h,c,u,d,p,f,g,v,m,y;function x(){clearTimeout(m),document.removeEventListener("pointerdown",y),(0,$7jh4K.css)(v,{opacity:"0"}),(0,$7jh4K.css)(g,{pointerEvents:"none"}),setTimeout(function(){v.remove()},200)}return(0,$2gUX3.__generator)(this,function(b){switch(b.label){case 0:if(!e.projectStore)return[2];return i=[],(n=new(0,$3uJxV.CrossTabChannel)("kl-tab-communication")).subscribe(function(t){"request-project-ids"===t.type&&n.postMessage({type:"response-project-id",id:e.klHistory.getComposed().projectId.value})}),r=function(e){"response-project-id"===e.type&&i.push(e.id)},n.subscribe(r),n.postMessage({type:"request-project-ids"}),[4,(0,$7jh4K.sleep)(100)];case 1:if(b.sent(),n.unsubscribe(r),(null==(t=e.klRecoveryManager)?void 0:t.getTabId())!==void 0)return[2];return[4,e.projectStore.readMeta()];case 2:if(!(a=b.sent())||i.includes(a.projectId))return[2];return s=(0,$7jh4K.fitInto)(a.thumbnail.width,a.thumbnail.height,100,100),(0,$7jh4K.css)(a.thumbnail,{width:s.width+"px",height:s.height+"px"}),(o=$eWjiX.BB.el({tagName:"button",className:$b07b255a18a05a27$export$efe229eab43a9869+" popup-x",content:`<img alt="${$8d7403abedf7cefa$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($e33dc4efcac9043e$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("modal-close"),custom:{tabindex:"0"}})).onclick=x,(l=$eWjiX.BB.el({className:$b07b255a18a05a27$export$48c2d0f2f545ac27,content:a.thumbnail,title:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open")})).onclick=function(){x(),e.onOpenBrowserStorage()},h=$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage")}),c=$b07b255a18a05a27$export$534219b709288da9,(u=$eWjiX.BB.el({tagName:"button",className:["kl-button-primary",c].join(" "),content:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open"),custom:{tabIndex:"-1"}})).onclick=function(){x(),e.onOpenBrowserStorage()},d=$eWjiX.BB.el({className:$b07b255a18a05a27$export$4a3e8128f471434a,content:[h,u]}),p=$eWjiX.BB.el({className:$b07b255a18a05a27$export$ad430d422a89f9f0,content:[l,d]}),(f=$eWjiX.BB.el({className:$b07b255a18a05a27$export$8001e369bcc9b474})).onclick=x,(g=$eWjiX.BB.el({className:$b07b255a18a05a27$export$bb5ee47d9ea2348e,content:[f,p,o]})).onclick=$eWjiX.BB.handleClick,v=$eWjiX.BB.el({content:[g],className:$b07b255a18a05a27$export$e8e78c978b129247}),document.body.append(v),m=setTimeout(x,4500),y=function(e){var t=e.target;g.contains(t)||g.contains(t)||x()},document.addEventListener("pointerdown",y,{passive:!1}),[2]}})})()}var $3uJxV=parcelRequire("3uJxV"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$cx0mh=parcelRequire("cx0mh"),$7h4XF=parcelRequire("7h4XF"),$cL71g=parcelRequire("cL71g"),$eWjiX=parcelRequire("eWjiX"),$eg83P=parcelRequire("eg83P"),$7jh4K=parcelRequire("7jh4K"),$a6a4d7bf66434db3$export$a82a053f5f536d09=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.position=(0,$cL71g._)({},t.position),this.xButton=$eWjiX.BB.el({tagName:"button",className:"popup-x",content:`<img alt="${$8d7403abedf7cefa$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($e33dc4efcac9043e$exports)}">`,title:$8d7403abedf7cefa$export$ce37e184d908d785("modal-close"),noRef:!0,onClick:function(){t.onClose()},css:{width:"32px",height:"32px",lineHeight:"32px",background:"none",boxShadow:"none"},custom:{tabindex:"0"}});var n=$eWjiX.BB.el({className:"kl-floating-window-header"});n.append(this.xButton);var r=$eWjiX.BB.el({content:t.content}),a={x:0,y:0};this.pointerListener=new $eWjiX.BB.PointerListener({target:n,onPointer:function(e){e.eventPreventDefault(),"left"===e.button&&"pointerdown"===e.type&&(a=(0,$cL71g._)({},i.position)),"left"===e.button&&"pointermove"===e.type&&(i.position.x=a.x+e.pageX-e.downPageX,i.position.y=a.y+e.pageY-e.downPageY,i.applyPosition())}}),this.rootEl=$eWjiX.BB.el({css:{position:"fixed",display:"flex",flexDirection:"column",left:this.position.x+"px",top:this.position.y+"px"}}),this.rootEl.append(n,r),setTimeout(function(){return i.applyPosition()})}return(0,$7h4XF._)(e,[{key:"applyPosition",value:function(){var e=this.rootEl.getBoundingClientRect();this.position.x=(0,$eg83P.clamp)(this.position.x,0,window.innerWidth-e.width),this.position.y=(0,$eg83P.clamp)(this.position.y,0,window.innerHeight-e.height),(0,$7jh4K.css)(this.rootEl,{left:this.position.x+"px",top:this.position.y+"px"})}},{key:"getElement",value:function(){return this.rootEl}},{key:"getPosition",value:function(){return(0,$cL71g._)({},this.position)}},{key:"destroy",value:function(){this.pointerListener.destroy()}}]),e}(),$6fc6caead7b75ed5$export$f27d6e4616dd9b30=function(){"use strict";function e(t){var i=this;(0,$cx0mh._)(this,e),this.colorPickerPosition={x:100,y:100},this.color={r:0,g:0,b:0},this.color=(0,$cL71g._)({},t.color),this.colorCircle=$eWjiX.BB.el({css:{width:"30px",height:"30px",background:$eWjiX.BB.ColorConverter.toRgbStr(t.color),borderRadius:"100%",boxShadow:"0 0 0 1px rgba(0,0,0,0.5), inset 0 0 0 1px rgba(255,255,255,0.5)",alignSelf:"center",cursor:"pointer"},noRef:!0,onClick:function(){i.colorPicker?i.closeColorPicker():(i.colorPicker=new $3ce0af1e789f1ab4$export$66306bf21a9ff39e({width:200,heightSV:200,heightH:30,color:i.color,callback:t.onColorChange}),i.colorWindow=new $a6a4d7bf66434db3$export$a82a053f5f536d09({content:$eWjiX.BB.el({content:i.colorPicker.getElement()}),onClose:function(){i.closeColorPicker()},position:i.colorPickerPosition}),document.body.append(i.colorWindow.getElement()))}});var n=new $eae820938baa028e$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($c698add026ba173f$exports),width:1,height:1,css:{width:"100%",height:"100%"},darkInvert:!0});this.eyedropperToggle=new $afe02cc26c765c2c$export$2358c75ad3c15b2d({init:!1,title:$8d7403abedf7cefa$export$ce37e184d908d785("eyedropper"),onChange:function(e){t.onEyedropper(e)},label:$eWjiX.BB.el({content:n.getElement(),css:{padding:"6px",height:"36px"}})}),this.rootEl=$eWjiX.BB.el({css:{display:"flex",flexDirection:"column",gap:"4px"}}),this.rootEl.append(this.colorCircle,this.eyedropperToggle.getElement())}return(0,$7h4XF._)(e,[{key:"getIsEyedropping",value:function(){return this.eyedropperToggle.getValue()}},{key:"setIsEyedropping",value:function(e){this.eyedropperToggle.setValue(e)}},{key:"setColor",value:function(e){var t;this.color=(0,$cL71g._)({},e),this.colorCircle.style.backgroundColor=$eWjiX.BB.ColorConverter.toRgbStr(e),null==(t=this.colorPicker)||t.setColor(e)}},{key:"closeColorPicker",value:function(){var e,t,i;this.colorWindow&&(this.colorPickerPosition=this.colorWindow.getPosition(),null==(t=this.colorWindow)||t.destroy(),null==(i=this.colorWindow)||i.getElement().remove(),this.colorWindow=void 0),null==(e=this.colorPicker)||e.destroy(),this.colorPicker=void 0}},{key:"setIsVisible",value:function(e){this.rootEl.style.display=e?"flex":"none",e||this.closeColorPicker()}},{key:"getElement",value:function(){return this.rootEl}}]),e}(),$9b3eo=parcelRequire("9b3eo");$4bb0d03ef02dc0c0$export$4283b00eae4a6956();var $cf5d938ee512ebca$export$96f6458b62e4c2c=function(){"use strict";function e(t){var i,n,r,a,s,o,l,h=this,c=this;(0,$cx0mh._)(this,e),this.collapseThreshold=2e5,this.toolWidth=271,this.lastSavedHistoryIndex=0,this.drawMode="freehand",this.liveShape=null,this.getPSD=function(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:return[4,$40b8cea12adf584e$export$92433b641be3f7a(this.klCanvas)];case 1:return[2,e.sent()]}})}).call(h)},this.embed=t.embed;var u=Math.min(4096,Math.max(2048,Math.max(window.screen.width,window.screen.height)));this.uiLayout=this.embed?"left":$6l0gQ.LocalStorage.getItem("uiState")?$6l0gQ.LocalStorage.getItem("uiState"):"right";var d=$jTg9g.KL_INDEXED_DB.getIsAvailable()?new(0,$6mTnI.ProjectStore):void 0;this.rootEl=$eWjiX.BB.el({className:"g-root",css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"}}),this.uiWidth=Math.max(0,window.innerWidth),this.uiHeight=Math.max(0,window.innerHeight);var p="png",f=Math.max(10,Math.min(u,window.innerWidth<this.collapseThreshold?this.uiWidth:this.uiWidth-this.toolWidth)),g=Math.max(10,Math.min(u,this.uiHeight));this.klHistory=new(0,$gWfkn.KlHistory)({oldest:$f2b7ac9d4f1c1625$export$f8f3f96593f6a47(null!=(n=t.project)?n:{projectId:(0,$7jh4K.randomUuid)(),width:f,height:g,layers:[{name:$8d7403abedf7cefa$export$ce37e184d908d785("layers-layer")+" 1",opacity:1,isVisible:!0,mixModeStr:"source-over",image:{fill:$eWjiX.BB.ColorConverter.toRgbStr({r:$00f785a5ea9e210d$export$e4203cb02d5e5b28,g:$00f785a5ea9e210d$export$e4203cb02d5e5b28,b:$00f785a5ea9e210d$export$e4203cb02d5e5b28})}}]})});var v=t.klRecoveryManager;v&&(v.setKlHistory(this.klHistory),v.setGetThumbnail(function(e){return(0,$aSJRf.drawProject)(h.klCanvas.getProject(),e)})),t.project&&t.project.layers.forEach(function(e){e.image instanceof HTMLCanvasElement&&$eWjiX.BB.freeCanvas(e.image),e.image=null}),this.klCanvas=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.KlCanvas(this.klHistory,this.embed?-1:1);var m=new $d3a44cd9d3ee7598$export$ab82e91194f5da86,y=void 0,x=function(e,t){I();var i=w.index;h.klCanvas.eraseLayer({layerIndex:i,useAlphaLock:0===i&&!F.eraserBrush.getIsTransparentBg(),useSelection:!t}),e&&h.statusOverlay.out(h.klCanvas.getSelection()?$8d7403abedf7cefa$export$ce37e184d908d785("cleared-selected-area"):$8d7403abedf7cefa$export$ce37e184d908d785("cleared-layer"),!0)},b=new $eWjiX.BB.RGB(0,0,0),w=this.klCanvas.getLayer(this.klCanvas.getLayerCount()-1),k=function(){if("eraserBrush"===a)return s;var e=Object.keys(F).filter(function(e){return"eraserBrush"!==e}),t=e.findIndex(function(e){return e===a});return e[(t+1)%e.length]},B=function(e){S.emitSize(e),h.easelBrush&&h.easelBrush.setBrush({radius:e})},S=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.BrushSettingService({onSetColor:function(e){h.klColorSlider.setColor(e),r.setColor(e),h.mobileColorUi.setColor(e),b=$eWjiX.BB.copyObj(e)},onSetSize:function(e){r.setSize(e),h.easelBrush.setBrush({radius:e})},onSetOpacity:function(e){r.setOpacity(e)},onSetScatter:function(e){r.setScatter(e)},onGetColor:function(){return h.klColorSlider.getColor()},onGetSize:function(){return F[a].getSize()},onGetOpacity:function(){return F[a].getOpacity()},onGetScatter:function(){return F[a].getScatter()},onGetSliderConfig:function(){return{sizeSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].sizeSlider,opacitySlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].opacitySlider,scatterSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].scatterSlider}}}),C=new $3adbeb1f050c09d3$export$c57e2ed65bcf4d6a({smoothing:$7aa12ecc06c22770$export$bcd109042a2e4bb5(1)});this.lineSanitizer=new $73298182992a8985$export$91dcf4209534d21f;var E=new $eWjiX.BB.EventChain({chainArr:[this.lineSanitizer,C]});E.setChainOut(function(e){if("down"===e.type&&(h.toolspace.style.pointerEvents="none",r.startLine(e.x,e.y,e.pressure),h.easelBrush.setLastDrawEvent({x:e.x,y:e.y}),h.easel.requestRender()),"move"===e.type){if("liveShape"===h.drawMode&&h.liveShape){h.liveShape=(0,$4EWN2._)((0,$cL71g._)({},h.liveShape),{x2:e.x,y2:e.y});var t=h.liveShape;h.klCanvas.setComposite(t.layerIndex,{draw:function(e){var i={type:t.type,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,angleRad:t.angleRad,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};"line"===t.type?(i.strokeRgb=h.klColorSlider.getColor(),i.lineWidth=J.getLineWidth(),i.isAngleSnap=J.getIsSnap()):(i.isFixedRatio=J.getIsFixed(),"stroke"===J.getMode()?(i.strokeRgb=h.klColorSlider.getColor(),i.lineWidth=J.getLineWidth()):i.fillRgb=h.klColorSlider.getColor()),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.drawShape(e,i,void 0)}}),h.easelProjectUpdater.update();return}r.goLine(e.x,e.y,e.pressure,e.isCoalesced),h.easelBrush.setLastDrawEvent({x:e.x,y:e.y}),h.easel.requestRender()}if("up"===e.type){if(h.toolspace.style.pointerEvents="","liveShape"===h.drawMode&&h.liveShape){var i=h.liveShape,n=i.layerIndex;h.klCanvas.setComposite(n,void 0);var a={type:i.type,x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,angleRad:i.angleRad,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};"line"===i.type?(a.strokeRgb=h.klColorSlider.getColor(),a.lineWidth=J.getLineWidth(),a.isAngleSnap=!1):(a.isFixedRatio=!1,"stroke"===J.getMode()?(a.strokeRgb=h.klColorSlider.getColor(),a.lineWidth=J.getLineWidth()):a.fillRgb=h.klColorSlider.getColor()),h.klCanvas.drawShape(n,a),h.easelProjectUpdater.update(),h.liveShape=null,h.drawMode="freehand";return}r.endLine(),h.easel.requestRender()}"line"===e.type&&(r.getBrush().drawLineSegment(e.x0,e.y0,e.x1,e.y1),h.easelBrush.setLastDrawEvent({x:e.x1,y:e.y1}),h.easel.requestRender())});var _={size:20,align:"left",isBold:!1,isItalic:!1,font:"sans-serif",letterSpacing:0,lineHeight:1,fill:{color:{r:0,g:0,b:0,a:1}}},I=function(){var e=!1;if(h.liveShape){var t=h.liveShape,i=t.layerIndex,n={type:t.type,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,angleRad:t.angleRad,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};"line"===t.type?(n.strokeRgb=h.klColorSlider.getColor(),n.lineWidth=J.getLineWidth(),n.isAngleSnap=!1):(n.isFixedRatio=!1,"stroke"===J.getMode()?(n.strokeRgb=h.klColorSlider.getColor(),n.lineWidth=J.getLineWidth()):n.fillRgb=h.klColorSlider.getColor()),h.klCanvas.setComposite(i,void 0),h.klCanvas.drawShape(i,n),h.easelProjectUpdater.update(),h.liveShape=null,e=!0}return"select"===h.easel.getTool()&&(e=P.commitTransform()||e),e},T=function(){return"select"===h.easel.getTool()&&P.discardTransform()},M=function(e,t){if(["undo","redo"].includes(e)){var i=h.klHistory.getComposed();h.klCanvas.updateViaComposed(t,i),U(h.klCanvas.getLayer(i.layerMap[i.activeLayerId].index)),h.easelProjectUpdater.update(),(t.size.width!==i.size.width||t.size.height!==i.size.height)&&h.easel.resetOrFitTransform(!0),h.easelBrush.setLastDrawEvent(),h.layersUi.update(w.index)}P.onHistory(e)},L=function(e){m.canDecreaseIndex()||T();var t=h.klHistory.getComposed(),i=ei.undo();i&&(M(i.type,t),e&&h.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("undo"),!0))},R=function(e){var t=h.klHistory.getComposed(),i=ei.redo();i&&(M(i.type,t),e&&h.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("redo"),!0))};this.statusOverlay=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.StatusOverlay;var P=new $f177420b33748502$export$e471993a29671b7({klCanvas:this.klCanvas,getCurrentLayerCtx:function(){return w.context},onUpdateProject:function(){return h.easelProjectUpdater.update()},klHistory:this.klHistory,tempHistory:m,statusOverlay:this.statusOverlay,onFill:function(){h.klCanvas.layerFill(w.index,h.klColorSlider.getColor(),void 0,!0),h.statusOverlay.out(h.klCanvas.getSelection()?$8d7403abedf7cefa$export$ce37e184d908d785("filled-selected-area"):$8d7403abedf7cefa$export$ce37e184d908d785("filled"),!0)},onErase:function(){var e=w.index;h.klCanvas.eraseLayer({layerIndex:e,useAlphaLock:0===e&&!F.eraserBrush.getIsTransparentBg(),useSelection:!0}),h.statusOverlay.out(h.klCanvas.getSelection()?$8d7403abedf7cefa$export$ce37e184d908d785("cleared-selected-area"):$8d7403abedf7cefa$export$ce37e184d908d785("cleared-layer"),!0)}});this.selectTool=new $29bdc5a628b41259$export$53d9e71218013355({klCanvas:this.klCanvas}),this.easelBrush=new $e63c9ca4199f5887$export$dfeedd8879a1038a({radius:5,onLineStart:function(e){E.chainIn({type:"down",scale:h.easel.getTransform().scale,shiftIsPressed:j.isPressed("shift"),pressure:e.pressure,isCoalesced:e.isCoalesced,x:e.x,y:e.y})},onLineGo:function(e){E.chainIn({type:"move",scale:h.easel.getTransform().scale,shiftIsPressed:j.isPressed("shift"),pressure:e.pressure,isCoalesced:e.isCoalesced,x:e.x,y:e.y})},onLineEnd:function(){E.chainIn({type:"up",scale:h.easel.getTransform().scale,shiftIsPressed:j.isPressed("shift"),isCoalesced:!1})},onLine:function(e,t){E.chainIn({type:"line",x0:e.x,y0:e.y,x1:t.x,y1:t.y,pressure0:1,pressure1:1})},onShapeDetected:function(e){if(console.log("Shape detected by algorithm:",e),"liveShape"!==h.drawMode){try{null==r||null==(t=r.endLine)||t.call(r)}catch(e){console.warn("endLine call failed on currentBrushUi",e)}L(!1);var t,i,n,a,s,o=null;if("rectangle"===e.type?o="rect":"circle"===e.type?o="ellipse":"line"===e.type&&(o="line"),o){"line"===o?(i=e.x1,a=e.y1,n=e.x2,s=e.y2):(i=Math.min(e.x1,e.x2),n=Math.max(e.x1,e.x2),a=Math.min(e.y1,e.y2),s=Math.max(e.y1,e.y2));var l=0,c=w.index;h.liveShape={type:o,x1:i,y1:a,x2:n,y2:s,angleRad:l,layerIndex:c},h.drawMode="liveShape";var u=function(){if(!h.liveShape)return null;var e=h.liveShape,t={type:e.type,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,angleRad:e.angleRad,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};return"line"===e.type?(t.strokeRgb=h.klColorSlider.getColor(),t.lineWidth=J.getLineWidth(),t.isAngleSnap=J.getIsSnap()):(t.isFixedRatio=J.getIsFixed(),"stroke"===J.getMode()?(t.strokeRgb=h.klColorSlider.getColor(),t.lineWidth=J.getLineWidth()):t.fillRgb=h.klColorSlider.getColor()),t};h.klCanvas.setComposite(c,{draw:function(e){var t=u();t&&$9cbe98d1fb398012$export$6e4a713ddcda1e5e.drawShape(e,t,void 0)}}),h.easelProjectUpdater.update(),null==y||y.open("shape"),H()}}}});var A=new $66028f220dcd865f$export$8202a4a90789f655({}),D=!1,O=new $ebd223e87e103321$export$f4821fa73b1145e5({onDown:function(e,t){if(h.liveShape){var i=h.liveShape,n=Math.min(i.x1,i.x2),r=Math.max(i.x1,i.x2),a=Math.min(i.y1,i.y2),s=Math.max(i.y1,i.y2);if(e.x>=n&&e.x<=r&&e.y>=a&&e.y<=s){D=!0;return}}D=!1,ee.onDown(e.x,e.y,t)},onMove:function(e){if(D&&h.liveShape){h.liveShape=(0,$4EWN2._)((0,$cL71g._)({},h.liveShape),{x2:e.x,y2:e.y});var t=h.liveShape;h.klCanvas.setComposite(t.layerIndex,{draw:function(e){var i={type:t.type,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,angleRad:t.angleRad,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};"line"===t.type?(i.strokeRgb=h.klColorSlider.getColor(),i.lineWidth=J.getLineWidth(),i.isAngleSnap=J.getIsSnap()):(i.isFixedRatio=J.getIsFixed(),"stroke"===J.getMode()?(i.strokeRgb=h.klColorSlider.getColor(),i.lineWidth=J.getLineWidth()):i.fillRgb=h.klColorSlider.getColor()),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.drawShape(e,i,void 0)}}),h.easelProjectUpdater.update();return}ee.onMove(e.x,e.y)},onUp:function(e){if(D){D=!1;return}ee.onUp(e.x,e.y)}}),z=!0;this.easel=new $33e4247c53b6e65b$export$2732362bcaeb02c2({width:Math.max(0,this.uiWidth-this.toolWidth),height:this.uiHeight,project:{width:this.klCanvas.getWidth(),height:this.klCanvas.getHeight(),layers:[]},tools:{brush:this.easelBrush,hand:A,select:P.getEaselSelect(),eyedropper:new $24db627c4c8e30c9$export$1fda302750a9ba48({onPick:function(e){var t=h.klCanvas.getColorAt(e.x,e.y);return S.setColor(t),t},onPickEnd:function(){(h.klColorSlider.getIsEyedropping()||h.mobileColorUi.getIsEyedropping())&&(h.klColorSlider.setIsEyedropping(!1),h.mobileColorUi.setIsEyedropping(!1),h.easel.setTool(h.toolspaceToolRow.getActive()))}}),paintBucket:new $f8e6779c7f01196e$export$9b29623161064b87({onFill:function(e){h.klCanvas.floodFill(w.index,e.x,e.y,Z.getIsEraser()?null:h.klColorSlider.getColor(),Z.getOpacity(),Z.getTolerance(),Z.getSample(),Z.getGrow(),Z.getContiguous()),h.easel.requestRender()}}),gradient:new $04aa501093e072d1$export$11badb1ec62816a1({onDown:function(e,t){Q.onDown(e.x,e.y,t)},onMove:function(e){Q.onMove(e.x,e.y)},onUp:function(e){Q.onUp(e.x,e.y)}}),text:new $43b8e046e203efe4$export$b10c22a3fee9197f({onDown:function(e,t){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||$9cbe98d1fb398012$export$6e4a713ddcda1e5e.textToolDialog({klCanvas:h.klCanvas,layerIndex:w.index,primaryColor:h.klColorSlider.getColor(),secondaryColor:h.klColorSlider.getSecondaryRGB(),text:(0,$4EWN2._)((0,$cL71g._)({},_),{text:"",x:e.x,y:e.y,angleRad:t,fill:_.fill?{color:(0,$4EWN2._)((0,$cL71g._)({},h.klColorSlider.getColor()),{a:_.fill.color.a})}:void 0,stroke:_.stroke?(0,$4EWN2._)((0,$cL71g._)({},_.stroke),{color:(0,$4EWN2._)((0,$cL71g._)({},h.klColorSlider.getSecondaryRGB()),{a:_.stroke.color.a})}):void 0}),onConfirm:function(e){_=(0,$4EWN2._)((0,$cL71g._)({},e),{text:""}),h.klCanvas.text(w.index,e)}})}}),shape:O,rotate:new $5af1201febea9911$export$f3b0846760df78b({}),zoom:new $e041531c7ca89b12$export$6c389c8425707374({})},tool:"brush",onChangeTool:function(e){h.mobileBrushUi.setIsVisible("brush"===e),h.mobileColorUi.setIsVisible("select"!==e)},onTransformChange:function(e,t){K.update(e.scale,e.angleDeg),h.toolspaceToolRow.setEnableZoomIn(e.scale!==$991ab38832278e02$export$ac82c07320907c00),h.toolspaceToolRow.setEnableZoomOut(e.scale!==$991ab38832278e02$export$5e2c057e240c0b8c),t&&!z&&h.statusOverlay.out({type:"transform",scale:e.scale,angleDeg:e.angleDeg}),z&&(z=!1)},onUndo:function(){L(!0)},onRedo:function(){R(!0)}}),(0,$7jh4K.css)(this.easel.getElement(),{position:"absolute",left:"0",top:"0"}),this.easelProjectUpdater=new $3dcbe6df163512b5$export$abfede0290e9bfba({klCanvas:this.klCanvas,easel:this.easel}),this.klHistory.addListener(function(){h.easelProjectUpdater.update()}),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.subscribe(function(e){h.easel.setIsFrozen(e>0)});var H=function(){if(y)for(var e={brush:{},hand:{},paintBucket:{},gradient:{},text:{},shape:{},select:{}},t=h.toolspaceToolRow.getActive(),i=y.getOpenedTabId(),n=Object.keys(e),r=0;r<n.length;r++)t===n[r]?y.setIsVisible(n[r],!0):(y.setIsVisible(n[r],!1),i===n[r]&&y.open(t))},j=new $eWjiX.BB.KeyListener({onDown:function(e,t,i){if(!($9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||$eWjiX.BB.isInputFocused(!0))&&!(h.lineSanitizer.getIsDrawing()||h.easel.getIsLocked())){if("home"===i&&h.easel.fitTransform(),"end"===i&&h.easel.resetTransform(),["ctrl+z","cmd+z"].includes(i)&&(t.preventDefault(),L()),(["ctrl+y","cmd+y"].includes(i)||($eWjiX.BB.sameKeys("ctrl+shift+z",i)||$eWjiX.BB.sameKeys("cmd+shift+z",i))&&"z"===e)&&(t.preventDefault(),R()),!h.embed&&(["ctrl+s","cmd+s"].includes(i)&&(t.preventDefault(),I(),h.saveToComputer.save()),["ctrl+shift+s","cmd+shift+s"].includes(i)&&(t.preventDefault(),I(),d?!function(){(0,$1LaJZ._)(function(){var e,t,i,n;return(0,$2gUX3.__generator)(this,function(r){switch(r.label){case 0:return[4,$dc6d4b1d8d494091$export$f565b71ad023b7df()];case 1:if(r.sent(),e=d.getCurrentMeta(),t=this.getProject(),!(e&&e.projectId!==t.projectId))return[3,3];return[4,new Promise(function(e,t){$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-overwrite-confirm"),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-overwrite"),"Cancel"],callback:function(t){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return"Cancel"===t?e(!1):e(!0),[2]})})()}})})];case 2:if(!r.sent())return[2];r.label=3;case 3:i=!0,r.label=4;case 4:return r.trys.push([4,6,,7]),[4,d.store(this.klCanvas.getProject())];case 5:return r.sent(),[3,7];case 6:return n=r.sent(),i=!1,setTimeout(function(){throw Error("keyboard-shortcut: failed to store browser storage, "+n)},0),this.statusOverlay.out(" "+$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed"),!0),[3,7];case 7:return i&&(this.updateLastSaved(),this.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("file-storage-stored"),!0)),[2]}})}).call(h)}():h.statusOverlay.out(" "+$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-failed"),!0)),["ctrl+c","cmd+c"].includes(i)&&(t.preventDefault(),I(),ea(!0))),["ctrl+a","cmd+a"].includes(i)&&t.preventDefault(),"sqbr_open"===i&&r.decreaseSize(Math.max(.005,.03/h.easel.getTransform().scale)),"sqbr_close"===i&&r.increaseSize(Math.max(.005,.03/h.easel.getTransform().scale)),"enter"!==i||I()||(h.klCanvas.layerFill(w.index,h.klColorSlider.getColor(),void 0,!0),h.statusOverlay.out(h.klCanvas.getSelection()?$8d7403abedf7cefa$export$ce37e184d908d785("filled-selected-area"):$8d7403abedf7cefa$export$ce37e184d908d785("filled"),!0)),"esc"===i&&T()&&t.preventDefault(),["delete","backspace"].includes(i)&&x(!0),"shift+e"===i?(t.preventDefault(),null==(n=r.toggleEraser)||n.call(r)):"e"===i&&(t.preventDefault(),I(),h.easel.setTool("brush"),h.toolspaceToolRow.setActive("brush"),null==y||y.open("brush"),H(),G.open("eraserBrush")),"b"===i){t.preventDefault(),I();var n,s=h.easel.getTool();h.easel.setTool("brush"),h.toolspaceToolRow.setActive("brush"),null==y||y.open("brush"),H(),G.open("brush"===s?k():a)}if("g"===i){t.preventDefault(),I();var o="paintBucket"===h.easel.getTool()?"gradient":"paintBucket";h.easel.setTool(o),h.toolspaceToolRow.setActive(o),null==y||y.open(o),H()}"t"===i&&(t.preventDefault(),I(),h.easel.setTool("text"),h.toolspaceToolRow.setActive("text"),null==y||y.open("text"),H()),"u"===i&&(t.preventDefault(),I(),h.easel.setTool("shape"),h.toolspaceToolRow.setActive("shape"),null==y||y.open("shape"),H()),"l"===i&&(t.preventDefault(),I(),h.easel.setTool("select"),h.toolspaceToolRow.setActive("select"),null==y||y.open("select"),H()),"x"===i&&(t.preventDefault(),h.klColorSlider.swapColors())}},onUp:function(e,t){}}),F={};Object.entries($9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI).forEach(function(e){var t=(0,$8N5YG._)(e,2),i=t[0],n=new t[1].Ui({klHistory:h.klHistory,onSizeChange:B,onScatterChange:function(e){S.emitScatter(e)},onOpacityChange:function(e){S.emitOpacity(e)},onConfigChange:function(){S.emitSliderConfig({sizeSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].sizeSlider,opacitySlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].opacitySlider,scatterSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[a].scatterSlider})}});F[i]=n,n.getElement().style.padding="10px"}),this.toolspace=$eWjiX.BB.el({className:"kl-toolspace",css:{position:"absolute",right:"0",top:"0",bottom:"0",width:this.toolWidth+"px",overflow:"hidden",userSelect:"none",touchAction:"none"}}),this.toolspaceInner=$eWjiX.BB.el({parent:this.toolspace}),this.toolspace.oncontextmenu=function(){return!1},this.toolspace.onclick=$eWjiX.BB.handleClick,this.mobileBrushUi=new $78e60fb79fb423b6$export$87fd7552ee5cd26e({onBrush:function(){G.open(s)},onEraser:function(){G.open("eraserBrush")}}),this.mobileColorUi=new $6fc6caead7b75ed5$export$f27d6e4616dd9b30({onEyedropper:function(e){e?(h.klColorSlider.setIsEyedropping(!0),h.easel.setTool("eyedropper")):(h.klColorSlider.setIsEyedropping(!1),h.easel.setTool(h.toolspaceToolRow.getActive()))},color:b,onColorChange:function(e){S.setColor(e)}}),this.mobileUi=new $ea23e70ae6749408$export$38b681d46b785af1({onShowToolspace:function(e){h.mobileColorUi.closeColorPicker(),h.updateCollapse()},toolUis:[this.mobileBrushUi.getElement(),this.mobileColorUi.getElement()]}),this.updateCollapse(!0),setTimeout(function(){o=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.OverlayToolspace({enabledTest:function(){return 0===$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()&&!h.easel.getIsLocked()},brushSettingService:S}),h.rootEl.append(o.getElement())},0),$eWjiX.BB.append(this.rootEl,[this.easel.getElement(),this.toolspace,this.mobileUi.getElement()]),(l=this.embed?new $1eff19bee197987a$export$ce26cd3db18613a3({onHelp:function(){$2d47de6498e5a87c$export$35fa34e5af64bd4a(h.embed.url+"/help.html",!!h.embed)},onSubmit:function(){I();var e=function(){var e,t=$eWjiX.BB.el({tagName:"button",textContent:$8d7403abedf7cefa$export$ce37e184d908d785("save-reminder-save-psd"),css:{display:"block"}});t.onclick=function(){h.saveAsPsd(),e()},$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:h.rootEl,message:"<b>"+$8d7403abedf7cefa$export$ce37e184d908d785("upload-failed")+"</b>",div:$eWjiX.BB.el({content:[$eWjiX.BB.el({content:$8d7403abedf7cefa$export$ce37e184d908d785("backup-drawing"),css:{marginBottom:"10px"}}),t]}),ignoreBackground:!0,closeFunc:function(t){e=t}})};$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:h.rootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785("submit-prompt"),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("submit"),"Cancel"],callback:function(t){return(0,$1LaJZ._)(function(){var i,n;return(0,$2gUX3.__generator)(this,function(r){return i=this,t!==$8d7403abedf7cefa$export$ce37e184d908d785("submit")||(n=$eWjiX.BB.el({parent:this.rootEl,className:"upload-overlay",content:'<div class="spinner"></div> '+$8d7403abedf7cefa$export$ce37e184d908d785("submit-submitting")}),this.embed.onSubmit(function(){i.updateLastSaved(),n.remove()},function(){n.remove(),e()})),[2]})}).call(h)}})},onLeftRight:function(){h.uiLayout="left"===h.uiLayout?"right":"left",h.updateUi()}}):new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ToolspaceTopRow({logoImg:t.logoImg,onLogo:function(){$2d47de6498e5a87c$export$35fa34e5af64bd4a("./home/",!!h.embed)},onNew:function(){en()},onImport:function(){eo.triggerImport()},onSave:function(){h.saveToComputer.save()},onShare:function(){er()},onHelp:function(){$2d47de6498e5a87c$export$35fa34e5af64bd4a("./help/",!!h.embed)}})).getElement().style.marginBottom="10px",this.toolspaceInner.append(l.getElement()),this.toolspaceToolRow=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ToolspaceToolRow({onActivate:function(e){if("hand"!==e&&I(),"brush"===e)h.easel.setTool("brush");else if("hand"===e)h.easel.setTool("hand");else if("paintBucket"===e)h.easel.setTool("paintBucket");else if("gradient"===e)h.easel.setTool("gradient");else if("text"===e)h.easel.setTool("text");else if("shape"===e)h.easel.setTool("shape");else if("select"===e)h.easel.setTool("select");else throw Error("unknown activeStr");null==y||y.open(e),H(),h.klColorSlider.setIsEyedropping(!1),h.mobileColorUi.setIsEyedropping(!1)},onZoomIn:function(){var e=h.easel.getTransform().scale,t=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(e,j.isPressed("shift")?1/8:.5);h.easel.scale(t/e)},onZoomOut:function(){var e=h.easel.getTransform().scale,t=$6ac4ab2dc9a117c8$export$8c03162b1a39d183(e,j.isPressed("shift")?-1/8:-.5);h.easel.scale(t/e)},onUndo:function(){L()},onRedo:function(){R()}}),this.toolspaceToolRow.setIsSmall(this.uiHeight<540),this.toolspaceInner.append(this.toolspaceToolRow.getElement());var X=function(e){b=e,r.setColor(e),S.emitColor(e),h.mobileColorUi.setColor(e),h.klColorSlider.setIsEyedropping(!1),h.mobileColorUi.setIsEyedropping(!1)};this.klColorSlider=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.KlColorSlider({width:250,height:30,svHeight:100,startValue:new $eWjiX.BB.RGB(0,0,0),onPick:X,onEyedropper:function(e){e?(h.mobileColorUi.setIsEyedropping(!0),h.easel.setTool("eyedropper")):(h.mobileColorUi.setIsEyedropping(!1),h.easel.setTool(h.toolspaceToolRow.getActive()))}}),this.klColorSlider.setHeight(Math.max(163,Math.min(400,this.uiHeight-505)));var V=function(e){"eraserBrush"!==e&&(s=e),h.klColorSlider&&("eraserBrush"===e?h.klColorSlider.enable(!1):h.klColorSlider.enable(!0)),a=e,(r=F[e]).setColor(b),r.setLayer(w),h.easelBrush.setBrush({type:"pixelBrush"===a?"pixel-square":"round"}),h.toolspaceToolRow.setActive("brush"),H()},U=function(e){w=e,r.setLayer(w),h.layerPreview.setLayer(w)},W=$eWjiX.BB.el(),N=$eWjiX.BB.el({css:{margin:"10px",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-end"}}),Y=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ToolspaceStabilizerRow({smoothing:1,onSelect:function(e){C.setSmoothing($7aa12ecc06c22770$export$bcd109042a2e4bb5(e))}});W.append(N),$eWjiX.BB.append(N,[this.klColorSlider.getElement(),this.klColorSlider.getOutputElement(),Y.getElement()]);var G=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.TabRow({initialId:"penBrush",useAccent:!0,tabArr:function(){for(var e=[],t=function(e){return{id:e,image:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[e].image,title:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[e].tooltip,onOpen:function(){F[e].getElement().style.display="block",V(e),h.klColorSlider.setIsEyedropping(!1),h.mobileColorUi.setIsEyedropping(!1),S.emitSliderConfig({sizeSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[e].sizeSlider,opacitySlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[e].opacitySlider,scatterSlider:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI[e].scatterSlider}),B(F[e].getSize()),S.emitOpacity(F[e].getOpacity()),h.mobileBrushUi.setType("eraserBrush"===e?"eraser":"brush")},onClose:function(){F[e].getElement().style.display="none"}}},i=Object.keys(F),n=0;n<i.length;n++)e.push(t(i[n]));return e}()});$eWjiX.BB.append(W,[G.getElement()].concat((0,$bX4ja._)(Object.entries($9cbe98d1fb398012$export$6e4a713ddcda1e5e.BRUSHES_UI).map(function(e){return F[(0,$8N5YG._)(e,1)[0]].getElement()}))));var K=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.HandUi({scale:this.easel.getTransform().scale,angleDeg:0,onReset:function(){h.easel.resetTransform()},onFit:function(){h.easel.fitTransform()},onAngleChange:function(e,t){h.easel.setAngleDeg(e,t)},onChangeUseInertiaScrolling:function(e){A.setUseInertiaScrolling(e)}}),Z=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.FillUi({colorSlider:this.klColorSlider}),q=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.GradientUi({colorSlider:this.klColorSlider}),$=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.TextUi({colorSlider:this.klColorSlider}),J=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ShapeUi({colorSlider:this.klColorSlider,onChangePanning:function(e){return O.setPanning(e)}}),Q=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.GradientTool({onGradient:function(e,t,i,n,r,a){var s=w.index,o=q.getSettings(),l={type:o.type,color1:h.klColorSlider.getColor(),isReversed:o.isReversed,opacity:o.opacity,doLockAlpha:o.doLockAlpha,isEraser:o.isEraser,doSnap:j.isPressed("shift")||o.doSnap,x1:t,y1:i,x2:n,y2:r,angleRad:a};if(e)h.klCanvas.setComposite(s,void 0),h.klCanvas.drawGradient(s,l);else{var c=h.klCanvas.getSelection(),u=c?new Path2D((0,$9b3eo.getSelectionPath2d)(c)):void 0;h.klCanvas.setComposite(s,{draw:function(e){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.drawGradient(e,l,u)}})}h.easelProjectUpdater.update()}}),ee=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ShapeTool({onShape:function(e,t,i,n,r,a){var s=w.index,o={type:J.getShape(),x1:t,y1:i,x2:n,y2:r,angleRad:a,isOutwards:J.getIsOutwards(),opacity:J.getOpacity(),isEraser:J.getIsEraser(),doLockAlpha:J.getDoLockAlpha()};if("line"===J.getShape()?(o.strokeRgb=h.klColorSlider.getColor(),o.lineWidth=J.getLineWidth(),o.isAngleSnap=J.getIsSnap()||j.isPressed("shift")):(o.isFixedRatio=J.getIsFixed()||j.isPressed("shift"),"stroke"===J.getMode()?(o.strokeRgb=h.klColorSlider.getColor(),o.lineWidth=J.getLineWidth()):o.fillRgb=h.klColorSlider.getColor()),e)h.klCanvas.setComposite(s,void 0),h.klCanvas.drawShape(s,o);else{var l=h.klCanvas.getSelection(),c=l?new Path2D((0,$9b3eo.getSelectionPath2d)(l)):void 0;h.klCanvas.setComposite(s,{draw:function(e){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.drawShape(e,o,c)}})}h.easelProjectUpdater.update()}});this.layersUi=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.LayersUi({klCanvas:this.klCanvas,onSelect:function(e,t){var i=h.klCanvas.getLayer(e);if(U(i),t){var n=$0eb4c7d1339a9456$export$beb462111ff337c5(h.klHistory.getEntries().at(-1).data);h.klHistory.push({activeLayerId:i.id},n)}},parentEl:this.rootEl,uiState:this.uiLayout,applyUncommitted:function(){return I()},klHistory:this.klHistory,onUpdateProject:function(){return h.easelProjectUpdater.update()},onClearLayer:function(){return x(!1,!0)}}),this.layerPreview=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.LayerPreview({klRootEl:this.rootEl,onClick:function(){null==y||y.open("layers")},uiState:this.uiLayout,klHistory:this.klHistory}),this.layerPreview.setIsVisible(this.uiHeight>=579),this.layerPreview.setLayer(w);var et=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.EditUi({klRootEl:this.rootEl,klColorSlider:this.klColorSlider,layersUi:this.layersUi,getCurrentColor:function(){return b},maxCanvasSize:u,klCanvas:this.klCanvas,getCurrentLayer:function(){return w},isEmbed:!!this.embed,statusOverlay:this.statusOverlay,onCanvasChanged:function(){h.easelProjectUpdater.update(),h.easel.resetOrFitTransform(!0)},applyUncommitted:function(){return I()},klHistory:this.klHistory,onCopyToClipboard:function(){I(),ea(!1,!1)},onPaste:function(){return eh.readClipboard()}}),ei=new $45179ad71c16c96a$export$cb9945923eaef1dd({klHistory:this.klHistory,tempHistory:m,onCanUndoRedoChange:function(e,t){h.toolspaceToolRow.setEnableUndo(e),h.toolspaceToolRow.setEnableRedo(t)}}),en=function(){I(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.newImageDialog({currentColor:b,secondaryColor:h.klColorSlider.getSecondaryRGB(),maxCanvasSize:u,canvasWidth:h.klCanvas.getWidth(),canvasHeight:h.klCanvas.getHeight(),workspaceWidth:window.innerWidth<h.collapseThreshold?h.uiWidth:h.uiWidth-h.toolWidth,workspaceHeight:h.uiHeight,onConfirm:function(e,t,i){h.klCanvas.reset({width:e,height:t,color:1===i.a?i:void 0}),h.layersUi.update(0),U(h.klCanvas.getLayer(0)),h.easelProjectUpdater.update(),h.easel.resetOrFitTransform(!0)},onCancel:function(){}})},er=function(e){I(),$eWjiX.BB.shareCanvas({canvas:h.klCanvas.getCompleteCanvas(1),fileName:$eWjiX.BB.getDate()+$da1a7600c10c1784$export$67ac20532b9ededa.filenameBase+".png",title:$eWjiX.BB.getDate()+$da1a7600c10c1784$export$67ac20532b9ededa.filenameBase+".png",callback:e||function(){}})};this.saveToComputer=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.SaveToComputer(function(){return p},this.klCanvas,function(){h.updateLastSaved()});var ea=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];$9cbe98d1fb398012$export$6e4a713ddcda1e5e.clipboardDialog(c.rootEl,function(e){return c.klCanvas.getCompleteCanvas(1,e)},function(e){(0!==e.left||0!==e.right||0!==e.top||0!==e.bottom)&&($9cbe98d1fb398012$export$6e4a713ddcda1e5e.FILTER_LIB.cropExtend.apply({layer:w,klCanvas:c.klCanvas,input:e,klHistory:c.klHistory}),c.layersUi.update(),c.easelProjectUpdater.update(),c.easel.resetOrFitTransform(!0))},c.statusOverlay,e||!1,t,c.klCanvas.getSelection())},es=function(){return(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o,l,h,c;return(0,$2gUX3.__generator)(this,function(u){switch(u.label){case 0:if(e=this,t=function(){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:e.rootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open-failed"),type:"error"})},!d)return t(),[2];if(!((i=d.getCurrentMeta())&&this.klHistory.getComposed().projectId.value!==i.projectId))return[3,4];return n=!0,r=new(0,$3uJxV.CrossTabChannel)("kl-tab-communication"),a=[],s=function(e){"response-project-id"===e.type&&a.push(e.id)},r.subscribe(s),r.postMessage({type:"request-project-ids"}),[4,(0,$7jh4K.sleep)(100)];case 1:if(u.sent(),r.unsubscribe(s),!(i&&a.includes(i.projectId)))return[3,3];return[4,new Promise(function(e,t){$c902829f68f42bce$export$d7e8d4d4450c819c({target:document.body,message:$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open-confirmation"),buttons:[$8d7403abedf7cefa$export$ce37e184d908d785("file-storage-open"),"Cancel"],callback:function(t){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(i){return"Cancel"===t?e(!1):e(!0),[2]})})()}})})];case 2:n=u.sent(),u.label=3;case 3:if(r.close(),!n)return[2];u.label=4;case 4:$9cbe98d1fb398012$export$6e4a713ddcda1e5e.popup({target:this.rootEl,message:$8d7403abedf7cefa$export$ce37e184d908d785("loading"),callback:function(e){o=void 0},closeFunc:function(e){o=e}}),u.label=5;case 5:return u.trys.push([5,7,,8]),[4,null==d?void 0:d.read()];case 6:return l=u.sent(),[3,8];case 7:return h=u.sent(),setTimeout(function(){throw h}),[3,8];case 8:if(!l)return null==o||o(),t(),[2];return I(),c=this.klCanvas.reset({projectId:l.project.projectId,width:l.project.width,height:l.project.height,layers:l.project.layers.map(function(e){var t,i=e.image;return!(i instanceof HTMLCanvasElement)&&(i=$eWjiX.BB.canvas(l.project.width,l.project.height),e.image instanceof HTMLImageElement&&$eWjiX.BB.ctx(i).drawImage(e.image,0,0)),(0,$4EWN2._)((0,$cL71g._)({},e),{id:(0,$7jh4K.randomUuid)(),image:i,mixModeStr:null!=(t=e.mixModeStr)?t:"source-over"})})}),this.layersUi.update(c),U(this.klCanvas.getLayer(c)),this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0),setTimeout(function(){e.statusOverlay.out($8d7403abedf7cefa$export$ce37e184d908d785("file-storage-restored"))}),null==o||o(),[2]}})}).call(h)},eo=this.embed?null:new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.FileUi({klRootEl:this.rootEl,projectStore:d,getProject:function(){return h.klCanvas.getProject()},exportType:p,onExportTypeChange:function(e){p=e},onFileSelect:function(e,t){return eh.handleFileSelect(e,t)},onSaveImageToComputer:function(){I(),h.saveToComputer.save()},onNewImage:en,onShareImage:function(e){I(),er(e)},onUpload:function(){I(),$9cbe98d1fb398012$export$6e4a713ddcda1e5e.imgurUpload(h.klCanvas,h.rootEl,t.app&&t.app.imgurKey?t.app.imgurKey:"",function(){return h.updateLastSaved()})},applyUncommitted:function(){return I()},onChangeShowSaveDialog:function(e){h.saveToComputer.setShowSaveDialog(e)},klRecoveryManager:v,onOpenBrowserStorage:es,onStoredToBrowserStorage:function(){h.updateLastSaved()}});!this.embed&&d&&(this.saveReminder=new $06e8423858d08972$export$befc6437ad34b28a({onSaveAsPsd:function(){h.embed||h.saveAsPsd()},isDrawing:function(){return h.isDrawing()},projectStore:d,getProject:function(){return h.getProject()},onStored:function(){h.updateLastSaved()},applyUncommitted:I,klHistory:this.klHistory}));var el=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.SettingsUi({onLeftRight:function(){h.uiLayout="left"===h.uiLayout?"right":"left",h.updateUi(),h.embed||$6l0gQ.LocalStorage.setItem("uiState",h.uiLayout)},saveReminder:this.saveReminder,customAbout:t.aboutEl});y=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.TabRow({initialId:"brush",tabArr:[{id:"brush",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-brush"),image:$parcel$interopDefault($1813762111ff3b93$exports),onOpen:function(){"eraserBrush"===a&&h.klColorSlider.enable(!1),$eWjiX.BB.append(N,[h.klColorSlider.getElement(),h.klColorSlider.getOutputElement(),Y.getElement()]),W.style.display="block"},onClose:function(){W.style.display="none"},css:{minWidth:"45px"}},{id:"hand",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-hand"),image:$parcel$interopDefault($ec1da9254c8485a7$exports),isVisible:!1,onOpen:function(){K.setIsVisible(!0)},onClose:function(){K.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"paintBucket",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-paint-bucket"),image:$parcel$interopDefault($09067d6182ed3b8e$exports),isVisible:!1,onOpen:function(){h.klColorSlider.enable(!0),Z.setIsVisible(!0)},onClose:function(){Z.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"gradient",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-gradient"),image:$parcel$interopDefault($493fdfa42d027406$exports),isVisible:!1,onOpen:function(){h.klColorSlider.enable(!0),q.setIsVisible(!0)},onClose:function(){q.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"text",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-text"),image:$parcel$interopDefault($7bad8de727b6761d$exports),isVisible:!1,onOpen:function(){h.klColorSlider.enable(!0),$.setIsVisible(!0)},onClose:function(){$.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"shape",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-shape"),image:$parcel$interopDefault($a931fbdaeae5b97a$exports),isVisible:!1,onOpen:function(){h.klColorSlider.enable(!0),J.setIsVisible(!0)},onClose:function(){J.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"select",title:$8d7403abedf7cefa$export$ce37e184d908d785("tool-select"),image:$parcel$interopDefault($b8ba25f8f8b8d477$exports),isVisible:!1,onOpen:function(){P.getSelectUi().setIsVisible(!0)},onClose:function(){P.getSelectUi().setIsVisible(!1)},css:{minWidth:"45px"}},{id:"layers",title:$8d7403abedf7cefa$export$ce37e184d908d785("layers"),image:$parcel$interopDefault($35c1331d74740d5d$exports),onOpen:function(){h.layersUi.update(),h.layersUi.getElement().style.display="block"},onClose:function(){h.layersUi.getElement().style.display="none"},css:{minWidth:"45px"}},{id:"edit",title:$8d7403abedf7cefa$export$ce37e184d908d785("tab-edit"),image:$parcel$interopDefault($9d5703f01759ee19$exports),onOpen:function(){et.show()},onClose:function(){et.hide()},css:{minWidth:"45px"}},{id:"file",label:$8d7403abedf7cefa$export$ce37e184d908d785("tab-file"),isVisible:!!eo,onOpen:function(){eo&&(eo.getElement().style.display="block",eo.setIsVisible(!0))},onClose:function(){eo&&(eo.getElement().style.display="none",eo.setIsVisible(!1))},css:{padding:"0 7px"}},{id:"settings",title:$8d7403abedf7cefa$export$ce37e184d908d785("tab-settings"),image:$parcel$interopDefault($297fb258e45d3497$exports),onOpen:function(){el.getElement().style.display="block"},onClose:function(){el.getElement().style.display="none"},css:{minWidth:"45px"}}]}),this.bottomBarWrapper=$eWjiX.BB.el({css:{width:"270px",position:"absolute",bottom:"0",left:"0"}}),t.bottomBar&&(this.bottomBar=t.bottomBar,this.bottomBarWrapper.append(this.bottomBar),new MutationObserver(function(){return h.updateBottomBar()}).observe(this.toolspaceInner,{attributes:!0,childList:!0,subtree:!0})),$eWjiX.BB.append(this.toolspaceInner,[this.layerPreview.getElement(),y.getElement(),W,K.getElement(),Z.getElement(),q.getElement(),$.getElement(),J.getElement(),P.getSelectUi().getElement(),this.layersUi.getElement(),et.getElement(),eo?eo.getElement():void 0,el.getElement(),$eWjiX.BB.el({css:{height:"10px"}}),this.bottomBarWrapper?this.bottomBarWrapper:void 0]),this.toolspaceScroller=new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.ToolspaceScroller({toolspace:this.toolspace,uiState:this.uiLayout}),this.embed||Object.defineProperty(window,"KL",{value:$a8abbf3a9def9692$export$982e7602957287fa({onDraw:function(e){e&&0!==e.length&&(e.forEach(function(e,t){0===t?r.startLine(e.x,e.y,1):r.goLine(e.x,e.y,1)}),r.endLine())}}),writable:!1}),this.resize(this.uiWidth,this.uiHeight),this.updateUi();var eh=new $da20269bad242e5f$export$1ec1306c0c05d48d({klRootEl:this.rootEl,maxCanvasSize:u,layersUi:this.layersUi,setCurrentLayer:U,klCanvas:this.klCanvas,onImportConfirm:function(){h.easelProjectUpdater.update(),h.easel.resetOrFitTransform(!0)},applyUncommitted:function(){return I()}},{onColor:function(e){return S.setColor(e)}});(!this.embed||this.embed.enableImageDropperImport)&&(new $9cbe98d1fb398012$export$6e4a713ddcda1e5e.KlImageDropper({target:document.body,onDrop:function(e,t){$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||(I(),eh.handleFileSelect(e,t))},enabledTest:function(){return 0===$9cbe98d1fb398012$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()}}),window.document.addEventListener("paste",function(e){return eh.onPaste(e)},!1)),this.unloadWarningTrigger=new $248aa716a9226bd7$export$747c5e57cda7ca57({klHistory:this.klHistory,getLastSavedHistoryIndex:function(){return h.lastSavedHistoryIndex}}),window.addEventListener("resize",function(){h.resize(window.innerWidth,window.innerHeight)}),window.addEventListener("orientationchange",function(){h.resize(window.innerWidth,window.innerHeight)}),"visualViewport"in window&&null!==visualViewport&&visualViewport.addEventListener("resize",function(){h.resize(window.innerWidth,window.innerHeight)});var ec=$eWjiX.BB.el({parent:document.body,css:{position:"fixed",left:"0",top:"0",right:"0",bottom:"0",pointerEvents:"none",zIndex:"-1",userSelect:"none"}});try{new ResizeObserver(function(){return h.resize(window.innerWidth,window.innerHeight)}).observe(ec)}catch(e){ec.remove()}this.rootEl.addEventListener("wheel",function(e){j.isPressed("ctrl")&&e.preventDefault()},{passive:!1});var eu=function(e){e.preventDefault()};window.addEventListener("gesturestart",eu,{passive:!1}),window.addEventListener("gesturechange",eu,{passive:!1}),window.addEventListener("gestureend",eu,{passive:!1}),new $456806b212fdf6a8$export$3e66e8feec69f8d,this.embed||setTimeout(function(){$ee60bdc4a11355ae$export$4a2ed1038e76f37f({projectStore:d,klRecoveryManager:v,onOpenBrowserStorage:es,klHistory:h.klHistory})}),null==(i=this.saveReminder)||i.init()}return(0,$7h4XF._)(e,[{key:"updateLastSaved",value:function(){var e,t;this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),null==(e=this.saveReminder)||e.reset(),null==(t=this.unloadWarningTrigger)||t.update()}},{key:"updateCollapse",value:function(e){if(e){var t;null!=(t=$6l0gQ.LocalStorage.getItem("uiShowMobile"))&&t&&this.mobileUi.setToolspaceIsOpen(!1)}this.mobileUi.setOrientation(this.uiLayout),this.uiWidth<this.collapseThreshold?(this.mobileUi.setIsVisible(!0),this.mobileUi.getToolspaceIsOpen()?("left"===this.uiLayout?(0,$7jh4K.css)(this.easel.getElement(),{left:"271px"}):(0,$7jh4K.css)(this.easel.getElement(),{left:"0"}),this.toolspace.style.display="block",this.easel.setSize(Math.max(0,this.uiWidth-this.toolWidth),this.uiHeight),this.statusOverlay.setWide(!1)):(this.uiLayout,(0,$7jh4K.css)(this.easel.getElement(),{left:"0"}),this.toolspace.style.display="none",this.easel.setSize(Math.max(0,this.uiWidth),this.uiHeight),this.statusOverlay.setWide(!0))):(this.mobileColorUi.closeColorPicker(),this.mobileUi.setIsVisible(!1),"left"===this.uiLayout&&(0,$7jh4K.css)(this.easel.getElement(),{left:"271px"}),this.toolspace.style.display="block",this.easel.setSize(Math.max(0,this.uiWidth-this.toolWidth),this.uiHeight),this.statusOverlay.setWide(!1)),this.mobileUi.update()}},{key:"updateBottomBar",value:function(){if(this.bottomBar){var e=this.toolspaceInner.scrollHeight+40<window.innerHeight,t=e?"":"none";t!==this.bottomBarWrapper.style.display&&(this.bottomBarWrapper.style.display=t)}}},{key:"updateUi",value:function(){this.toolspace.classList.toggle("kl-toolspace--left","left"===this.uiLayout),this.toolspace.classList.toggle("kl-toolspace--right","right"===this.uiLayout),"left"===this.uiLayout?((0,$7jh4K.css)(this.toolspace,{left:"0",right:""}),(0,$7jh4K.css)(this.easel.getElement(),{left:"271px"})):((0,$7jh4K.css)(this.toolspace,{left:"",right:"0"}),(0,$7jh4K.css)(this.easel.getElement(),{left:"0"})),this.statusOverlay.setUiState(this.uiLayout),this.layerPreview.setUiState(this.uiLayout),this.layersUi.setUiState(this.uiLayout),this.updateCollapse(),this.toolspaceScroller.updateUiState(this.uiLayout)}},{key:"getElement",value:function(){return this.rootEl}},{key:"resize",value:function(e,t){window.scrollY>0&&window.scrollTo(0,0),(this.uiWidth!==Math.max(0,e)||this.uiHeight!==Math.max(0,t))&&(this.uiWidth=Math.max(0,e),this.uiHeight=Math.max(0,t),this.updateCollapse(),this.updateBottomBar(),this.layerPreview.setIsVisible(this.uiHeight>=579),this.klColorSlider.setHeight(Math.max(163,Math.min(400,this.uiHeight-505))),this.toolspaceToolRow.setIsSmall(this.uiHeight<540))}},{key:"out",value:function(e){this.statusOverlay.out(e)}},{key:"getPNG",value:function(){return(0,$1LaJZ._)(function(){return(0,$2gUX3.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,$eIcQa.canvasToBlob)(this.klCanvas.getCompleteCanvas(1),"image/png")];case 1:return[2,e.sent()]}})}).call(this)}},{key:"getProject",value:function(){return this.klCanvas.getProject()}},{key:"swapUiLeftRight",value:function(){this.uiLayout="left"===this.uiLayout?"right":"left",this.embed||$6l0gQ.LocalStorage.setItem("uiState",this.uiLayout),this.updateUi()}},{key:"saveAsPsd",value:function(){this.saveToComputer.save("psd")}},{key:"isDrawing",value:function(){return this.lineSanitizer.getIsDrawing()||this.easel.getIsLocked()}}]),e}(),$jTg9g=parcelRequire("jTg9g"),$6otAp=parcelRequire("6otAp");function $b8f9b41d70e8fccd$var$showInitError(e){var t=document.createElement("div");t.style.textAlign="center",t.style.background="#fff",t.style.padding="20px",t.innerHTML="<h1>App failed to initialize</h1>";var i=document.createElement("div");i.textContent="Error: "+(e.message?e.message:""+e),t.append(i),document.body.append(t),console.error(e)}!function(){(0,$1LaJZ._)(function(){var e,t,i,n,r,a,s,o;return(0,$2gUX3.__generator)(this,function(l){switch(l.label){case 0:return l.trys.push([0,9,,10]),e=[],[4,$8d7403abedf7cefa$export$7a2ea9f2e4d199d3()];case 1:return l.sent(),$jTg9g.KL_INDEXED_DB.init((0,$jTg9g.getKlIndexedDbName)(),$jTg9g.KL_INDEXED_DB_STORES,$jTg9g.KL_INDEXED_DB_VERSION,$jTg9g.KL_INDEXED_DB_UPGRADER),[4,$jTg9g.KL_INDEXED_DB.testConnection()];case 2:l.sent()||e.push($8d7403abedf7cefa$export$ce37e184d908d785("file-storage-cant-access")),t=$jTg9g.KL_INDEXED_DB.getIsAvailable()?new(0,$6otAp.KlRecoveryManager)({}):void 0,i=void 0,l.label=3;case 3:if(l.trys.push([3,7,,8]),!t)return[3,5];return[4,t.getRecovery()];case 4:return r=l.sent(),[3,6];case 5:r=void 0,l.label=6;case 6:return(n=r)&&(i=n.project,e.push($8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-recovered"))),[3,8];case 7:return a=l.sent(),setTimeout(function(){throw a}),e.push($8d7403abedf7cefa$export$ce37e184d908d785("tab-recovery-failed-to-recover")),[3,8];case 8:return null==(s=document.getElementById("loading-screen"))||s.remove(),o=new $cf5d938ee512ebca$export$96f6458b62e4c2c({project:i,klRecoveryManager:t}),document.body.append(o.getElement()),setTimeout(function(){e.forEach(function(e){o.out(e)})},100),[3,10];case 9:return $b8f9b41d70e8fccd$var$showInitError(l.sent()),[3,10];case 10:return[2]}})})()}()}();
//# sourceMappingURL=klecks.3aab7fe1.js.map
