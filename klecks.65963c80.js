let $e9d04a247aa46c18$var$kl2PsdMap,$e9d04a247aa46c18$var$psd2KlMap,$ca843f6dd01906cb$export$5822a9d0880a5d82,$ba022370a1e95297$var$floatPrecision,$e4b3248b4ce95ea5$var$agPsdLazy,$31d0877b7a0bd896$var$preferenceIsTransparentBg;function $parcel$resolve(t){if(t=parcelRequire.i?.[t]||t,!$parcel$bundleURL)try{throw Error()}catch(i){var e=(""+i.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(!e)return $parcel$distDir+t;$parcel$bundleURL=e[0]}return new URL($parcel$distDir+t,$parcel$bundleURL).toString()}var $parcel$bundleURL,$cf02414f4b0b48a4$export$9852986a3ec5f6a0,$36bbe8d945937d2a$export$48c2d0f2f545ac27,$36bbe8d945937d2a$export$d7b7311ec04a3e8f,$a40e51dbac8cdac4$export$eea3e4f737fa39e3,$a40e51dbac8cdac4$export$2f48b40a5a83dc1b,$d9aa3b7905088459$export$7b388ca536128c6d,$d9aa3b7905088459$export$62d58b1c91e8e902,$d9aa3b7905088459$export$84aa927130f1a919,$d9aa3b7905088459$export$ee483a02838ec162,$d9aa3b7905088459$export$e114d13b1a258938,$219efb580e609ac5$export$cc1a246adca07dd4,$1f6c98f1bc1611d6$export$6bf57c7f0219f07d,$c9ea12bc676afcc7$export$a2d3d93c57d16a1a,$25b07e12db1a9da9$export$41a461248611663e,$70f4c2ccd9f1fc4e$export$56c1e4693edf08f9,$646f0f1b6fd77518$export$1009f0178778a981,$7a43ac3a337343a6$export$5385b9a82993d2c8,$7d2e2ca9f0011a18$export$d3c0448523aecc2e,$a824238dd90318d5$export$a061a4a5d124ecc0,$caa94592e0101c24$export$3d7865934588d77e,$c5bce1325a5b7ff7$export$9e83d65c7ba90739,$b6970044e814ff87$export$73c2705cb2da08ab,$daa049cf342b91a4$export$cd01a11ba097c64c,$6ca36586b626e950$export$c17cb29bf4746ec8,$082579e39391a6a4$export$cf5942d9a76b7ae2,$c92fcd34ca9c4923$export$e9c6a0495dc4055f,$f046497a552209d8$export$143a800d561d28fd,$fddb00d16107a6f8$export$2e559b10bdb6bb80,$b3e19d81d874cda5$export$2ede450fbdbb4e4c,$5b16a89e54ff4835$export$9506977ce2a96a5b,$8f2d2240b8e15785$export$20d70ee9873a8ba,$6a6d4ee2903f5490$export$483bfb5d033dec0c,$41907456dd919c99$export$b5381822af66064b,$aa54b3f0adef983e$export$48c2d0f2f545ac27,$26979e340e24ad46$export$bd7a7a9fa7e7f04b,$095683c145b0ace5$export$d4ef1ef99f1461a4,$3a83d9f064170ff2$export$1c6ca1c73436aa3c,$88c9efa60ac19d5d$export$bb5ee47d9ea2348e,$88c9efa60ac19d5d$export$534219b709288da9,$88c9efa60ac19d5d$export$8001e369bcc9b474,$88c9efa60ac19d5d$export$efe229eab43a9869,$88c9efa60ac19d5d$export$ad430d422a89f9f0,$88c9efa60ac19d5d$export$48c2d0f2f545ac27,$88c9efa60ac19d5d$export$4a3e8128f471434a,$88c9efa60ac19d5d$export$e8e78c978b129247,$parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function $parcel$export(t,e,i,s){Object.defineProperty(t,e,{get:i,set:s,enumerable:!0,configurable:!0})}function $parcel$extendImportMap(t){Object.assign(parcelRequire.i??={},t)}function $parcel$interopDefault(t){return t&&t.__esModule?t.default:t}var $parcel$distDir="./",$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire94c2;null==parcelRequire&&((parcelRequire=function(t){if(t in $parcel$modules)return $parcel$modules[t].exports;if(t in $parcel$inits){var e=$parcel$inits[t];delete $parcel$inits[t];var i={id:t,exports:{}};return $parcel$modules[t]=i,e.call(i.exports,i,i.exports),i.exports}var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){$parcel$inits[t]=e},$parcel$global.parcelRequire94c2=parcelRequire);var parcelRegister=parcelRequire.register;if(parcelRegister("j0wU0",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("6OT74")).then(()=>parcelRequire("11sRX"))}),parcelRegister("fKq5I",function(t,e){t.exports=parcelRequire("20Uq9")(function(t){return new Promise(function(e,i){var s="i".concat((""+Math.random()).slice(2));$parcel$global[s]=function(t){e(t),n()};var n=function(){delete $parcel$global[s],r.onerror=null,r.remove()},r=document.createElement("script");r.async=!0,r.type="module",r.charset="utf-8",r.textContent="import * as m from '".concat(t,"'; ").concat(s,"(m);"),r.onerror=function(t){i(t),n()},document.head.appendChild(r)})})}),parcelRegister("20Uq9",function(t,e){var i={},s={},n={};function r(t){switch(t){case"preload":return s;case"prefetch":return n;default:return i}}t.exports=function(t,e){return function(i){var s=r(e);return s[i]?s[i]:s[i]=t.apply(null,arguments).catch(function(t){throw delete s[i],t})}}}),parcelRegister("eYAiv",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("2MWxt")).then(()=>parcelRequire("aGMEi"))}),parcelRegister("FCOGf",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("3NN9W")).then(()=>parcelRequire("caaFG"))}),parcelRegister("8QPRU",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("i8WN1")).then(()=>parcelRequire("aZ0Sx"))}),parcelRegister("bh2gX",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("MMtuR")).then(()=>parcelRequire("iEGk8"))}),parcelRegister("6zMTy",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("j1Skh")).then(()=>parcelRequire("a43yv"))}),parcelRegister("i7mHL",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("hUIiR")).then(()=>parcelRequire("2BQEx"))}),parcelRegister("1vdkc",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("6SS5P")).then(()=>parcelRequire("k4vvc"))}),parcelRegister("EJ9Pd",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("klZAl")).then(()=>parcelRequire("68m8f"))}),parcelRegister("VfRNd",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("5xEoy")).then(()=>parcelRequire("PvL2A"))}),parcelRegister("7Cmcd",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("fCBVN")).then(()=>parcelRequire("fjTuu"))}),parcelRegister("hGaKk",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("3Cac3")).then(()=>parcelRequire("dG1Dm"))}),parcelRegister("8vyDa",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("i3Nr5")).then(()=>parcelRequire("5ukhf"))}),parcelRegister("aCMGc",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("8ZRjr")).then(()=>parcelRequire("bWyC7"))}),parcelRegister("9C1up",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("bAwoY")).then(()=>parcelRequire("4bdyP"))}),parcelRegister("gXjy0",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("eiNJp")).then(()=>parcelRequire("2C9ch"))}),parcelRegister("5wCMx",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("b1997")).then(()=>parcelRequire("aGeQD"))}),parcelRegister("2UvqW",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("4tKUq")).then(()=>parcelRequire("duojR"))}),parcelRegister("62C6p",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("hn23i")).then(()=>parcelRequire("2vgBY"))}),parcelRegister("9vuYc",function(t,e){t.exports=parcelRequire("fKq5I")($parcel$resolve("af9Ft")).then(()=>parcelRequire("lbeJP"))}),parcelRegister("4byZX",function(module,exports){$parcel$export(module.exports,"ShapeRecognition",function(){return ShapeRecognition});var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz");class ShapeRecognition{chainIn(t){t=$2Eggz.BB.copyObj(t);let e=Date.now();return"down"===t.type?(this.points=[{x:t.x,y:t.y,time:e}],this.isHolding=!1,clearTimeout(this.holdTimeout),this.holdTimeout=setTimeout(()=>{this.isHolding=!0,this.recognizeShape()},this.holdThreshold)):"move"===t.type?(this.points.push({x:t.x,y:t.y,time:e}),this.points.length>200&&this.points.shift(),this.isHolding||(clearTimeout(this.holdTimeout),this.holdTimeout=setTimeout(()=>{this.isHolding=!0,this.recognizeShape()},this.holdThreshold))):"up"===t.type&&(clearTimeout(this.holdTimeout),this.isHolding=!1,this.points=[]),t}async recognizeShape(){if(this.points.length<10)return;if(this.externalRecognizer&&"function"==typeof this.externalRecognizer.recognize)try{let t=await this.externalRecognizer.recognize(this.points);if(t){let e=this.externalRecognizer.getParams?this.externalRecognizer.getParams(t,this.points):this.getShapeParams(t,this.points);this.recognizedShape=(0,$wpIFA._)({type:t},e),this.onShapeRecognized&&this.onShapeRecognized(t);return}}catch(t){}let t=this.detectShape(this.points);if(t){let e=this.getShapeParams(t,this.points);this.recognizedShape=(0,$wpIFA._)({type:t},e),this.onShapeRecognized&&this.onShapeRecognized(t)}else this.recognizedShape=null}async loadExternalRecognizer(){let candidates=["@tldraw/tldraw","@tldraw/core","shape-recognition","shape-recognizer"];for(let pkg of candidates)try{var _mod_default,_candidate_getEllipseFromPoints,_ref,_candidate_getRectangleFromPoints,_ref1,_candidate_getLineFromPoints,_ref2;let mod=await eval('import("'+pkg+'")').catch(()=>null);if(!mod)continue;let candidate=null!=(_mod_default=mod.default)?_mod_default:mod,normalizePoints=t=>t.map(t=>({x:t.x,y:t.y}));if("function"==typeof(null==candidate?void 0:candidate.detectShape)){this.externalRecognizer={recognize:t=>candidate.detectShape(t),getParams:(t,e)=>"function"==typeof candidate.getShapeParams?candidate.getShapeParams(t,e):this.getShapeParams(t,e)},console.log("ShapeRecognition: using",pkg,"detectShape");return}let getEllipse=null!=(_ref=null!=(_candidate_getEllipseFromPoints=null==candidate?void 0:candidate.getEllipseFromPoints)?_candidate_getEllipseFromPoints:null==candidate?void 0:candidate.getEllipse)?_ref:null==candidate?void 0:candidate.ellipseFromPoints,getRect=null!=(_ref1=null!=(_candidate_getRectangleFromPoints=null==candidate?void 0:candidate.getRectangleFromPoints)?_candidate_getRectangleFromPoints:null==candidate?void 0:candidate.getRectangle)?_ref1:null==candidate?void 0:candidate.rectFromPoints,getLine=null!=(_ref2=null!=(_candidate_getLineFromPoints=null==candidate?void 0:candidate.getLineFromPoints)?_candidate_getLineFromPoints:null==candidate?void 0:candidate.getLine)?_ref2:null==candidate?void 0:candidate.lineFromPoints;if(getEllipse||getRect||getLine){this.externalRecognizer={recognize:t=>{let e=normalizePoints(t);if(getEllipse)try{if(getEllipse(e))return"circle"}catch(t){}if(getRect)try{if(getRect(e))return"rectangle"}catch(t){}if(getLine)try{if(getLine(e))return"line"}catch(t){}return null},getParams:(t,e)=>{let i=normalizePoints(e);if("circle"===t&&getEllipse){let t=getEllipse(i);if(t&&void 0!==t.cx&&void 0!==t.cy&&void 0!==t.rx&&void 0!==t.ry){let e=t.cx,i=t.cy,s=Math.max(t.rx,t.ry);return{x1:e-s,y1:i-s,x2:e+s,y2:i+s}}}if("rectangle"===t&&getRect){let t=getRect(i);if(t&&void 0!==t.x&&void 0!==t.y&&void 0!==t.width&&void 0!==t.height)return{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}}if("line"===t&&getLine){let t=getLine(i);if(t&&void 0!==t.x1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}return this.getShapeParams(t,e)}},console.log("ShapeRecognition: using",pkg,"ellipse/rect/line helpers");return}if(candidate){let names=Object.keys(candidate),lowerNames=names.map(t=>t.toLowerCase()),hasEllipse=lowerNames.find(t=>t.includes("ellipse")||t.includes("ellipsefrom")),hasRect=lowerNames.find(t=>t.includes("rectangle")||t.includes("rectfrom")||t.includes("rect")),hasLine=lowerNames.find(t=>t.includes("line")||t.includes("linestart")||t.includes("segment")),fnEllipse=hasEllipse?candidate[names[lowerNames.indexOf(hasEllipse)]]:null,fnRect=hasRect?candidate[names[lowerNames.indexOf(hasRect)]]:null,fnLine=hasLine?candidate[names[lowerNames.indexOf(hasLine)]]:null;if(fnEllipse||fnRect||fnLine){this.externalRecognizer={recognize:t=>{let e=normalizePoints(t);if(fnEllipse)try{if(fnEllipse(e))return"circle"}catch(t){}if(fnRect)try{if(fnRect(e))return"rectangle"}catch(t){}if(fnLine)try{if(fnLine(e))return"line"}catch(t){}return null},getParams:(t,e)=>{let i=normalizePoints(e);try{if("circle"===t&&fnEllipse){let t=fnEllipse(i);if(t&&void 0!==t.cx){var s,n,r;let e=t.cx,i=t.cy,a=null!=(r=t.r)?r:Math.max(null!=(s=t.rx)?s:0,null!=(n=t.ry)?n:0);return{x1:e-a,y1:i-a,x2:e+a,y2:i+a}}}if("rectangle"===t&&fnRect){let t=fnRect(i);if(t&&void 0!==t.x&&void 0!==t.y&&void 0!==t.width&&void 0!==t.height)return{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}}if("line"===t&&fnLine){let t=fnLine(i);if(t&&void 0!==t.x1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}}catch(t){}return this.getShapeParams(t,e)}},console.log("ShapeRecognition: using heuristics from",pkg);return}}}catch(err){}this.externalRecognizer=null}detectShape(t){if(t.length<10)return null;let e=t.map(t=>t.x),i=t.map(t=>t.y),s=Math.min(...e),n=Math.min(...i),r=Math.max(...e)-s,a=Math.max(...i)-n,o=0===a?1/0:r/a;return o>5||o<.2?this.isLine(t)?"line":null:o>.7&&o<1.3&&this.isCircle(t)?"circle":this.isRectangle(t)?"rectangle":this.isLine(t)?"line":null}isCircle(t){if(t.length<20)return!1;let e=t.map(t=>t.x),i=t.map(t=>t.y),s=Math.min(...e),n=Math.min(...i),r=Math.max(...e)-s,a=Math.max(...i)-n;if(r<10||a<10)return!1;let o=r/a;if(o<.7||o>1.3)return!1;let l=0,h=0;for(let e of t)l+=e.x,h+=e.y;let c=l/t.length,d=h/t.length,p=0;for(let e of t)p+=Math.sqrt((e.x-c)**2+(e.y-d)**2);let u=p/t.length,g=0;for(let e of t)g+=Math.abs(Math.sqrt((e.x-c)**2+(e.y-d)**2)-u);return(g/=t.length)<.5*u}isRectangle(t){if(t.length<12)return!1;let e=t.map(t=>t.x),i=t.map(t=>t.y),s=Math.min(...e),n=Math.max(...e),r=Math.min(...i),a=Math.max(...i),o=n-s,l=a-r;if(o<15||l<15)return!1;let h=o/l;if(h>5||h<.2)return!1;let c=Math.max(8,.25*Math.min(o,l)),d=!1,p=!1,u=!1,g=!1;for(let e of t){let t=Math.abs(e.x-s),i=Math.abs(e.x-n),o=Math.abs(e.y-r),l=Math.abs(e.y-a);t<c&&o<c&&(d=!0),i<c&&o<c&&(p=!0),t<c&&l<c&&(u=!0),i<c&&l<c&&(g=!0)}return[d,p,u,g].filter(t=>t).length>=3}isLine(t){let e=t[0],i=t[t.length-1],s=i.x-e.x,n=i.y-e.y,r=Math.sqrt(s*s+n*n),a=0;for(let i=1;i<t.length-1;i++){let o=t[i];a+=Math.abs(n*(o.x-e.x)-s*(o.y-e.y))/(r||1)}return a/Math.max(1,t.length-2)<7}getShapeParams(t,e){if("line"===t)return{x1:e[0].x,y1:e[0].y,x2:e[e.length-1].x,y2:e[e.length-1].y};if("rectangle"===t){let t=e.map(t=>t.x).sort((t,e)=>t-e),i=e.map(t=>t.y).sort((t,e)=>t-e);return{x1:t[0],y1:i[0],x2:t[t.length-1],y2:i[i.length-1]}}if("circle"===t){let t=0,i=0;for(let s of e)t+=s.x,i+=s.y;let s=t/e.length,n=i/e.length,r=0;for(let t of e)r+=Math.sqrt((t.x-s)**2+(t.y-n)**2);let a=r/e.length;return{x1:s-a,y1:n-a,x2:s+a,y2:n+a}}throw Error("Unknown shape type")}getRecognizedShape(){return this.recognizedShape}setChainOut(t){this.chainOut=t}setOnShapeRecognized(t){this.onShapeRecognized=t}static async recognizeShapeFromPoints(points){if(points.length<10)return null;let ptsWithTime=points.map(t=>(0,$9FMZM._)((0,$wpIFA._)({},t),{time:Date.now()}));try{let mod=await eval('import("@tldraw/tldraw")').catch(()=>null)||await eval('import("@tldraw/core")').catch(()=>null);if(mod){var _mod_default;let candidate=null!=(_mod_default=mod.default)?_mod_default:mod;if("function"==typeof(null==candidate?void 0:candidate.detectShape))return candidate.detectShape(ptsWithTime)}}catch(e){}let xs=ptsWithTime.map(t=>t.x),ys=ptsWithTime.map(t=>t.y),minX=Math.min(...xs),maxX=Math.max(...xs),minY=Math.min(...ys),maxY=Math.max(...ys),width=maxX-minX,height=maxY-minY,aspect=0===height?1/0:width/height;return aspect>5||aspect<.2?ShapeRecognition.isLineStatic(ptsWithTime)?"line":null:aspect>.7&&aspect<1.3&&ShapeRecognition.isCircleStatic(ptsWithTime)?"circle":ShapeRecognition.isRectangleStatic(ptsWithTime)?"rectangle":ShapeRecognition.isLineStatic(ptsWithTime)?"line":null}static isCircleStatic(t){if(t.length<20)return!1;let e=t.map(t=>t.x),i=t.map(t=>t.y),s=Math.min(...e),n=Math.min(...i),r=Math.max(...e)-s,a=Math.max(...i)-n;if(r<10||a<10)return!1;let o=r/a;if(o<.7||o>1.3)return!1;let l=0,h=0;for(let e of t)l+=e.x,h+=e.y;let c=l/t.length,d=h/t.length,p=0;for(let e of t)p+=Math.sqrt((e.x-c)**2+(e.y-d)**2);let u=p/t.length,g=0;for(let e of t)g+=Math.abs(Math.sqrt((e.x-c)**2+(e.y-d)**2)-u);return(g/=t.length)<.5*u}static isRectangleStatic(t){if(t.length<12)return!1;let e=t.map(t=>t.x),i=t.map(t=>t.y),s=Math.min(...e),n=Math.max(...e),r=Math.min(...i),a=Math.max(...i),o=n-s,l=a-r;if(o<15||l<15)return!1;let h=o/l;if(h>5||h<.2)return!1;let c=Math.max(8,.25*Math.min(o,l)),d=!1,p=!1,u=!1,g=!1;for(let e of t){let t=Math.abs(e.x-s),i=Math.abs(e.x-n),o=Math.abs(e.y-r),l=Math.abs(e.y-a);t<c&&o<c&&(d=!0),i<c&&o<c&&(p=!0),t<c&&l<c&&(u=!0),i<c&&l<c&&(g=!0)}return[d,p,u,g].filter(t=>t).length>=3}static isLineStatic(t){if(t.length<5)return!1;let e=t[0],i=t[t.length-1],s=i.x-e.x,n=i.y-e.y,r=Math.sqrt(s*s+n*n);if(r<15)return!1;let a=0;for(let i=1;i<t.length-1;i++){let o=t[i];a+=Math.abs(n*(o.x-e.x)-s*(o.y-e.y))/(r||1)}return a/Math.max(1,t.length-2)<7}constructor(t){this.points=[],this.isHolding=!1,this.holdThreshold=500,this.recognizedShape=null,this.externalRecognizer=null,this.onShapeRecognized=t.onShapeRecognized,this.loadExternalRecognizer()}}}),parcelRegister("wpIFA",function(t,e){$parcel$export(t.exports,"_",function(){return s});var i=parcelRequire("ino0r");function s(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},n=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),n.forEach(function(e){(0,i._)(t,e,s[e])})}return t}}),parcelRegister("ino0r",function(t,e){$parcel$export(t.exports,"_",function(){return i});function i(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}}),parcelRegister("9FMZM",function(t,e){function i(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function s(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}),t}$parcel$export(t.exports,"_",function(){return s})}),parcelRegister("2Eggz",function(t,e){$parcel$export(t.exports,"BB",function(){return B});var i=parcelRequire("VM6dD"),s=parcelRequire("8oUKZ"),n=parcelRequire("27fCv"),r=parcelRequire("iwR8S"),a=parcelRequire("ao0qX"),o=parcelRequire("2SCiK"),l=parcelRequire("70cu1"),h=parcelRequire("4zqo7"),c=parcelRequire("5EmwV"),d=parcelRequire("jmKbV"),p=parcelRequire("8cWis"),u=parcelRequire("f5ug2"),g=parcelRequire("2A815"),m=parcelRequire("dGRuJ"),f=parcelRequire("h5jm6"),y=parcelRequire("1CkT5"),v=parcelRequire("2WBc7"),x=parcelRequire("lEiB9"),b=parcelRequire("957vH"),w=parcelRequire("VbzD9");let B={eventUsesHighResTimeStamp:s.EVENT_USES_HIGH_RES_TIMESTAMP,hasPointerEvents:s.HAS_POINTER_EVENTS,isCssMinMaxSupported:s.IS_CSS_MIN_MAX_SUPPORTED,canShareFiles:s.canShareFiles,unsetEventHandler:s.unsetEventHandler,insertAfter:i.insertAfter,loadImage:i.loadImage,css:i.css,setAttributes:i.setAttributes,append:i.append,fitInto:i.fitInto,centerWithin:i.centerWithin,getDate:i.getDate,gcd:i.gcd,reduce:i.reduce,decToFraction:i.decToFraction,imageBlobToUrl:i.imageBlobToUrl,dateDayDifference:i.dateDayDifference,copyObj:i.copyObj,shareCanvas:i.shareCanvas,handleClick:i.handleClick,createSvg:i.createSvg,BbLog:g.BbLog,LocalStorage:m.LocalStorage,throwIfNull:i.throwIfNull,nullToUndefined:i.nullToUndefined,isDark:i.isDark,mix:p.mix,dist:p.dist,distSquared:p.distSquared,lenSquared:p.lenSquared,pointsToAngleRad:p.pointsToAngleRad,pointsToAngleDeg:p.pointsToAngleDeg,isInsideRect:p.isInsideRect,clamp:p.clamp,rotate:p.rotate,rotateAround:p.rotateAround,Matrix:o.Matrix,Vec2:l.Vec2,intDxy:p.intDxy,roundEven:p.roundEven,roundUneven:p.roundUneven,round:p.round,updateBounds:p.updateBounds,boundsInArea:p.boundsInArea,projectPointOnLine:h.projectPointOnLine,PointLine:h.PointLine,BezierLine:h.BezierLine,SplineInterpolator:h.SplineInterpolator,powerSplineInput:h.powerSplineInput,canvas:u.createCanvas,ctx:a.ctx,copyCanvas:a.copyCanvas,testShouldPixelate:a.testShouldPixelate,drawTransformedImageWithBounds:a.drawTransformedImageWithBounds,drawTransformedImageOnCanvas:a.drawTransformedImageOnCanvas,createCheckerCanvas:a.createCheckerCanvas,createCheckerDataUrl:a.createCheckerDataUrl,resizeCanvas:a.resizeCanvas,convertToAlphaChannelCanvas:a.convertToAlphaChannelCanvas,freeCanvas:a.freeCanvas,canvasBounds:a.canvasBounds,HSV:c.HSV,RGB:c.RGB,CMYK:c.CMYK,ColorConverter:c.ColorConverter,testIsWhiteBestContrast:c.testIsWhiteBestContrast,appendTextDiv:d.appendTextDiv,clearSelection:d.clearSelection,el:d.el,destroyEl:d.destroyEl,isInputFocused:d.isInputFocused,unfocusAnyInput:d.unfocusAnyInput,KeyListener:n.KeyListener,PointerListener:r.PointerListener,sameKeys:n.sameKeys,EventChain:w.EventChain,DoubleTapper:x.DoubleTapper,NFingerTapper:y.NFingerTapper,PinchZoomer:v.PinchZoomer,CoalescedExploder:f.CoalescedExploder,OnePointerLimiter:b.OnePointerLimiter};Object.keys(B)}),parcelRegister("VM6dD",function(t,e){function i(t,e){t.parentNode&&t.parentNode.insertBefore(e,t.nextSibling)}function s(t,e){let i=0;function s(){1e3===i?alert("couldn't load"):t.complete?(i++,e()):setTimeout(s,1)}s()}function n(t){return new Promise((e,i)=>{let s=new Image;s.onload=()=>e(s),s.onerror=i,s.src=t})}function r(t,e){let i=t.style;Object.keys(e).forEach(t=>{let s=t;i[s]=e[s],"userSelect"===s&&(i.webkitUserSelect=e[s])})}function a(t,e){let i,s=Object.keys(e);for(let n=0;n<s.length;n++)i=s[n],t.setAttribute(i,e[i])}function o(t,e){let i=document.createDocumentFragment();e.forEach(t=>t&&i.append(t)),t.append(i)}function l(t,e,i,s,n){let r=t*i,a=e*i;return r>i&&(a=i/r*a,r=i),a>s&&(r=s/a*r,a=s),n&&(r=Math.max(n,r),a=Math.max(n,a)),{width:r,height:a}}function h(t,e,i,s){return{x:t/2-i/2,y:e/2-s/2}}function c(){let t=new Date;return t.getFullYear()+"_"+(t.getMonth()+1).toString().padStart(2,"0")+"_"+t.getDate().toString().padStart(2,"0")+"_"+(60*t.getHours()+t.getMinutes()).toString(36).padStart(3,"0")+"_"}function d(t,e){return e?d(e,t%e):t}function p(t,e){let i=d(t,e);return[t/i,e/i]}function u(t){let e=Math.pow(10,t.toString().length-2);return p(t*e,e)}function g(t){return t instanceof Blob||"[object Blob]"===Object.prototype.toString.call(t)}function m(t){if(!t)throw Error("blobObj is undefined or null");if(window.Blob&&t instanceof Blob)return URL.createObjectURL(t);if("Object"===t.constructor.name){let e=t;return"data:"+e.type+";"+e.encoding+","+e.data}throw Error("unknown blob format")}function f(t,e){return t=new Date(t),e=new Date(e),t.setHours(0,0,0,0),e.setHours(0,0,0,0),(e.getTime()-t.getTime())/864e5}function y(t){return JSON.parse(JSON.stringify(t))}function v(t){let e="image/png",i=()=>alert("sharing not supported");t.canvas.toBlob(function(s){if(!s){i(),t.callback();return}try{let n=[new File([s],t.fileName,{type:e})];navigator.share({title:t.title,files:n}).then(()=>{}).catch(()=>{i()})}catch(t){i()}t.callback()},e)}function x(t){let e=t.target;if(!e)return!1;let i=e;for(;i;){if(["A","LABEL","INPUT","SUMMARY"].includes(i.tagName))return!0;i=i.parentElement}return t.preventDefault(),!1}function b(t){let e=document.createElementNS("http://www.w3.org/2000/svg",t.elementType);return Object.entries(t).forEach(([t,i])=>{"childrenArr"===t?i.forEach(t=>{e.append(b(t))}):"css"===t?r(e,i):"elementType"!==t&&e.setAttribute(t,i)}),e}function w(t){if(null===t)throw Error("value is null");return t}function B(t,e="value is undefined"){if(void 0===t)throw Error(e);return t}function S(t){return null===t?void 0:t}$parcel$export(t.exports,"insertAfter",function(){return i}),$parcel$export(t.exports,"loadImage",function(){return s}),$parcel$export(t.exports,"asyncLoadImage",function(){return n}),$parcel$export(t.exports,"css",function(){return r}),$parcel$export(t.exports,"setAttributes",function(){return a}),$parcel$export(t.exports,"append",function(){return o}),$parcel$export(t.exports,"fitInto",function(){return l}),$parcel$export(t.exports,"centerWithin",function(){return h}),$parcel$export(t.exports,"getDate",function(){return c}),$parcel$export(t.exports,"gcd",function(){return d}),$parcel$export(t.exports,"reduce",function(){return p}),$parcel$export(t.exports,"decToFraction",function(){return u}),$parcel$export(t.exports,"isBlob",function(){return g}),$parcel$export(t.exports,"imageBlobToUrl",function(){return m}),$parcel$export(t.exports,"dateDayDifference",function(){return f}),$parcel$export(t.exports,"copyObj",function(){return y}),$parcel$export(t.exports,"shareCanvas",function(){return v}),$parcel$export(t.exports,"handleClick",function(){return x}),$parcel$export(t.exports,"createSvg",function(){return b}),$parcel$export(t.exports,"throwIfNull",function(){return w}),$parcel$export(t.exports,"throwIfUndefined",function(){return B}),$parcel$export(t.exports,"nullToUndefined",function(){return S}),$parcel$export(t.exports,"isDark",function(){return E}),$parcel$export(t.exports,"addIsDarkListener",function(){return k}),$parcel$export(t.exports,"base64ToBlob",function(){return I}),$parcel$export(t.exports,"createArray",function(){return T}),$parcel$export(t.exports,"randomUuid",function(){return M}),$parcel$export(t.exports,"sleep",function(){return P}),$parcel$export(t.exports,"timeoutWrapper",function(){return L});let C="matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)");function E(){return C&&C.matches}function k(t){C&&"addEventListener"in C&&C.addEventListener("change",t)}function I(t){let e=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),i=atob(e[3]),s=new Uint8Array(new ArrayBuffer(i.length));for(let t=0;t<s.length;t++)s[t]=i.charCodeAt(t);return new Blob([s],{type:e[1]})}function T(t,e){return Array(t).fill(e)}function M(){return"randumUUID"in crypto?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function P(t){return new Promise(e=>setTimeout(e,t))}async function L(t,e,i=5e3){return Promise.race([t,new Promise((t,s)=>{setTimeout(()=>s(Error(`Promise "${e}" timed out.`)),i)})])}}),parcelRegister("8oUKZ",function(t,e){$parcel$export(t.exports,"IS_FIREFOX",function(){return i}),$parcel$export(t.exports,"EVENT_USES_HIGH_RES_TIMESTAMP",function(){return s}),$parcel$export(t.exports,"HAS_POINTER_EVENTS",function(){return n}),$parcel$export(t.exports,"IS_CSS_MIN_MAX_SUPPORTED",function(){return r}),$parcel$export(t.exports,"canShareFiles",function(){return a}),$parcel$export(t.exports,"unsetEventHandler",function(){return o});let i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,s=function(){let t=new Event("").timeStamp<36e5;return function(){return t}}(),n=!!window.PointerEvent,r=function(){let t;function e(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="max(0px, 25px)",document.body.append(e),setTimeout(function(){t=25===e.offsetLeft,e.remove()},25)}return document.body?e():window.addEventListener("DOMContentLoaded",function(){e()}),function(){if(void 0===t)throw Error("isCssMinMaxSupported not initialized");return t}}(),a=function(){return"share"in navigator&&"canShare"in navigator};function o(t,...e){e.forEach(e=>{t[e]=null})}}),parcelRegister("27fCv",function(t,e){$parcel$export(t.exports,"KeyListener",function(){return s}),$parcel$export(t.exports,"sameKeys",function(){return n});let i=(()=>{let t,e={space:[" ","Spacebar"],alt:["Alt","AltGraph"],shift:"Shift",ctrl:"Control",cmd:["Meta","MetaLeft","MetaRight"],enter:"Enter",esc:"Escape",backspace:"Backspace",delete:"Delete",sqbr_open:"[",sqbr_close:"]",a:["a","A"],b:["b","B"],c:["c","C"],e:["e","E"],f:["f","F"],g:["g","G"],l:["l","L"],r:["r","R"],s:["s","S"],t:["t","T"],u:["u","U"],x:["x","X"],y:["y","Y"],z:["z","Z"],plus:"+",minus:"-",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",home:"Home",end:"End"},i=Object.keys(e),s=Object.entries(e).reduce((t,[e])=>(t[e]=!1,t),{}),n=Object.entries(e).reduce((t,[e,i])=>("string"==typeof i?t[i]=e:i.forEach(i=>{t[i]=e}),t),{}),r=[],a={},o=[],l=(e,i)=>{t=setTimeout(()=>{if(1!==r.length||"cmd"===r[0])return;let n=r.join("+");s[e]=!1,a[i]=void 0;for(let t=0;t<r.length;t++)r[t]==e&&(r.splice(t,1),t--);c(e,{preventDefault:function(){},stopPropagation:function(){}},n),t=void 0},1e3)},h=function(t,e,i,s){o.forEach(n=>{n[0]&&n[0](t,e,i,s)})},c=function(t,e,i){o.forEach(s=>{s[1]&&s[1](t,e,i)})},d=function(){o.forEach(t=>{t[2]&&t[2]()})};function p(e){let i=e.key,o=e.code;if(i in n){let c=n[i];if(s[c])return void h(c,e,r.join("+"),!0);"cmd"===c?l(c,o):clearTimeout(t),"esc"===c&&setTimeout(()=>g()),s[c]=!0,a[o]=c,r.push(c),h(c,e,r.join("+"))}}function u(t){let e=t.code,i=r.join("+");if(["Meta","MetaLeft","MetaRight","OSLeft","OSRight"].includes(e)||s.cmd)return void g();let n=a[e];if(void 0!==n){s[n]=!1,a[e]=void 0;for(let t=0;t<r.length;t++)r[t]==n&&(r.splice(t,1),t--);c(n,t,i)}}function g(){let t=r.join("+");r=[],a={};let e=[];i.forEach(t=>{s[t]&&(s[t]=!1,e.push(t))});for(let i=0;i<e.length;i++)c(e[i],{preventDefault:function(){},stopPropagation:function(){}},t);d()}return{add:t=>{if(o.includes(t))return;let e=0===o.length;o.push(t),e&&(document.addEventListener("keydown",p),document.addEventListener("keyup",u),window.addEventListener("blur",g))},remove:t=>{if(!o.includes(t))return;let e=1===o.length;for(let e=0;e<o.length;e++)if(o[e]===t){o.splice(e,1);break}e&&(document.removeEventListener("keydown",p),document.removeEventListener("keyup",u),window.removeEventListener("blur",g))},getIsDown:()=>s,getCombo:()=>r,blur:g}})();class s{isPressed(t){if(!(t in i.getIsDown()))throw'key "'+t+'" not found';return i.getIsDown()[t]}getComboStr(){return i.getCombo().join("+")}comboOnlyContains(t){for(let e=0;e<i.getCombo().length;e++)if(!t.includes(i.getCombo()[e]))return!1;return!0}destroy(){i.remove(this.ref),i.blur()}constructor(t){this.onDown=t.onDown,this.onUp=t.onUp,this.onBlur=t.onBlur,this.ref=[this.onDown,this.onUp,this.onBlur],i.add(this.ref)}}function n(t,e){return t.split("+").sort().join("+")===e.split("+").sort().join("+")}}),parcelRegister("iwR8S",function(t,e){$parcel$export(t.exports,"PointerListener",function(){return w});var i=parcelRequire("wpIFA"),s=parcelRequire("9FMZM"),n=parcelRequire("8oUKZ"),r=parcelRequire("dVW3b"),a=parcelRequire("3TuLN");let o=[];function l(t){let e={pointerId:t.pointerId,lastPageX:null,lastPageY:null};return o.push(e),o.length>15&&o.shift(),e}function h(t){for(let e=o.length-1;e>=0;e--)if(t.pointerId===o[e].pointerId)return o[e];return null}function c(t){switch(t){case 1:return"left";case 2:return"right";case 4:return"middle";default:return}}let d=new(0,a.PressureNormalizer),p=(0,n.EVENT_USES_HIGH_RES_TIMESTAMP)()?0:-performance.timing.navigationStart,u=n.HAS_POINTER_EVENTS?"pointerdown":"mousedown",g=n.HAS_POINTER_EVENTS?"pointermove":"mousemove",m=n.HAS_POINTER_EVENTS?"pointerup":"mouseup",f=n.HAS_POINTER_EVENTS?"pointercancel":"mousecancel",y=n.HAS_POINTER_EVENTS?"pointerleave":"mouseleave",v=n.HAS_POINTER_EVENTS?"pointerenter":"mouseenter";function x(t){if("corrected"in t)return t.corrected;function e(){return void 0!==t.buttons?t.buttons:void 0!==t.button?[1,4,2,8,16][t.button]:0}let i={pointerId:t.pointerId,pointerType:t.pointerType,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,movementX:t.movementX,movementY:t.movementY,timeStamp:t.timeStamp+p,pressure:d.normalize(t.pressure,t.type,t.pointerType),buttons:e(),button:t.button,coalescedArr:[],eventPreventDefault:()=>t.preventDefault(),eventStopPropagation:()=>t.stopPropagation()};t.corrected=i;let s=null;"pointerId"in t?"pressure"in t&&0!==t.buttons&&("touch"===t.pointerType&&0===t.pressure&&(i.pressure=1,s=1),"mouse"===t.pointerType&&(.5===t.pressure||0===t.pressure)&&(i.pressure=1,s=1)):(i.pointerId=0,i.pointerType="mouse",i.pressure=+(0!==t.buttons),s=i.pressure),n.IS_FIREFOX&&"mouse"!=t.pointerType&&"pointermove"===t.type&&0===t.buttons&&(i.buttons=1);let r=[];"getCoalescedEvents"in t&&(r=t.getCoalescedEvents());let a=h(i)||l(i),o=a.lastPageX,c=a.lastPageY;for(let t=0;t<r.length;t++){let e=r[t];i.coalescedArr.push({pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY,movementX:null===a.lastPageX?0:e.pageX-a.lastPageX,movementY:null===a.lastPageY?0:e.pageY-a.lastPageY,timeStamp:0===e.timeStamp?i.timeStamp:e.timeStamp+p,pressure:null===s?d.normalize(e.pressure):s}),a.lastPageX=e.pageX,a.lastPageY=e.pageY}return a.lastPageX=i.pageX,a.lastPageY=i.pageY,i.movementX=null===o?0:a.lastPageX-o,i.movementY=null===c?0:a.lastPageY-c,i}let b={passive:!1};class w{getDragObj(t){for(let e=0;e<this.dragObjArr.length;e++)if(t===this.dragObjArr[e].pointerId)return this.dragObjArr[e];return null}removeDragObj(t){let e=null;for(let i=0;i<this.dragPointerIdArr.length;i++)this.dragPointerIdArr[i]===t&&(e=this.dragObjArr[i],this.dragObjArr.splice(i,1),this.dragPointerIdArr.splice(i,1),i--);return e}createPointerOutEvent(t,e,s){let n=this.targetElement.getBoundingClientRect(),r=(0,i._)({type:t,pointerId:e.pointerId,pointerType:e.pointerType,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY,relX:e.clientX-n.left+this.targetElement.scrollLeft,relY:e.clientY-n.top+this.targetElement.scrollTop,dX:e.movementX,dY:e.movementY,time:e.timeStamp,eventPreventDefault:e.eventPreventDefault,eventStopPropagation:e.eventStopPropagation},s);if("pointermove"===t&&(r.coalescedArr=[],e.coalescedArr.length>1)){let t;for(let i=0;i<e.coalescedArr.length;i++)t=e.coalescedArr[i],r.coalescedArr.push({pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,relX:t.clientX-n.left+this.targetElement.scrollLeft,relY:t.clientY-n.top+this.targetElement.scrollTop,dX:t.movementX,dY:t.movementY,time:t.timeStamp})}return r}setupDocumentListeners(){this.windowOnPointerMove&&document.addEventListener(g,this.windowOnPointerMove,b),this.windowOnPointerUp&&document.addEventListener(m,this.windowOnPointerUp,b),this.windowOnPointerLeave&&document.addEventListener(f,this.windowOnPointerLeave,b),this.windowOnPointerLeave&&document.addEventListener(y,this.windowOnPointerLeave,b)}destroyDocumentListeners(){this.windowOnPointerMove&&document.removeEventListener(g,this.windowOnPointerMove),this.windowOnPointerUp&&document.removeEventListener(m,this.windowOnPointerUp),this.windowOnPointerLeave&&document.removeEventListener(f,this.windowOnPointerLeave),this.windowOnPointerLeave&&document.removeEventListener(y,this.windowOnPointerLeave)}destroy(){!this.isDestroyed&&(this.isDestroyed=!0,this.onPointerEnter&&this.targetElement.removeEventListener(v,this.onPointerEnter),this.onPointerLeave&&this.targetElement.removeEventListener(y,this.onPointerLeave),this.onPointerMove&&this.targetElement.removeEventListener(g,this.onPointerMove),this.onPointerDown&&this.targetElement.removeEventListener(u,this.onPointerDown),this.onWheel&&this.targetElement.removeEventListener("wheel",this.onWheel),this.destroyDocumentListeners(),this.onTouchMoveScribbleFix&&document.removeEventListener("touchmove",this.onTouchMoveScribbleFix),this.onTouchStart&&this.targetElement.removeEventListener("touchstart",this.onTouchStart),this.onTouchMove&&this.targetElement.removeEventListener("touchmove",this.onTouchMove),this.onTouchEnd&&this.targetElement.removeEventListener("touchend",this.onTouchEnd),this.onTouchCancel&&this.targetElement.removeEventListener("touchcancel",this.onTouchCancel))}constructor(t){var e;this.isDestroyed=!1,this.isOverCounter=0,this.dragObjArr=[],this.dragPointerIdArr=[],this.lastPointerType=null,this.didSkip=!1,this.targetElement=t.target,this.onPointerCallback=t.onPointer,this.onWheelCallback=t.onWheel,this.onEnterLeaveCallback=t.onEnterLeave,this.maxPointers=Math.max(1,null!=(e=t.maxPointers)?e:1);let a=t=>{if(this.isDestroyed||!this.onWheelCallback)return;let e=this.targetElement.getBoundingClientRect(),n=(0,i._)((0,s._)((0,i._)({},t instanceof WheelEvent?{deltaY:t.deltaY/120,pageX:t.pageX,pageY:t.pageY}:t),{relX:t.clientX-e.left+this.targetElement.scrollLeft,relY:t.clientY-e.top+this.targetElement.scrollTop}),t instanceof WheelEvent?{event:t}:{});this.onWheelCallback(n)};if(this.wheelCleaner=t.useDirtyWheel?void 0:new(0,r.WheelCleaner)(a),this.onPointerCallback&&(this.onPointerMove=t=>{var e,i;let s=x(t),n=this.lastPointerType;if(this.lastPointerType=s.pointerType,this.dragPointerIdArr.includes(s.pointerId)||this.dragPointerIdArr.length===this.maxPointers||"touch"===s.pointerType){this.didSkip=!1;return}if(!this.didSkip&&"mouse"===s.pointerType&&"pen"===n){this.didSkip=!0;return}this.didSkip=!1;let r=this.createPointerOutEvent("pointermove",s);null==(e=(i=this).onPointerCallback)||e.call(i,r)},this.onPointerDown=(t,e)=>{var i,s;let n=x(t);if(this.dragPointerIdArr.includes(n.pointerId)||this.dragPointerIdArr.length===this.maxPointers||![1,2,4].includes(n.buttons))return;0!==this.dragObjArr.length||e||this.setupDocumentListeners();let r={pointerId:n.pointerId,pointerType:n.pointerType,downPageX:n.pageX,downPageY:n.pageY,buttons:n.buttons,lastPageX:n.pageX,lastPageY:n.pageY,lastTimeStamp:n.timeStamp};this.dragObjArr.push(r),this.dragPointerIdArr.push(n.pointerId);let a=this.createPointerOutEvent("pointerdown",n,{downPageX:n.pageX,downPageY:n.pageY,button:c(n.buttons),pressure:n.pressure});null==(i=(s=this).onPointerCallback)||i.call(s,a)},this.windowOnPointerMove=t=>{var e,i,s,n;let r=x(t);if(!this.dragPointerIdArr.includes(r.pointerId))return;let a=this.getDragObj(r.pointerId);if(!a)return;if(r.buttons!==a.buttons){1===this.dragObjArr.length&&this.destroyDocumentListeners(),this.removeDragObj(r.pointerId);let t=this.createPointerOutEvent("pointerup",r,{downPageX:a.downPageX,downPageY:a.downPageY});null==(s=(n=this).onPointerCallback)||s.call(n,t);return}if("pen"===r.pointerType&&r.pageX===a.lastPageX&&r.pageY===a.lastPageY&&r.timeStamp===a.lastTimeStamp)return;let o=this.createPointerOutEvent("pointermove",r,{downPageX:a.downPageX,downPageY:a.downPageY,button:c(r.buttons),pressure:r.pressure});a.lastPageX=r.pageX,a.lastPageY=r.pageY,a.lastTimeStamp=r.timeStamp,null==(e=(i=this).onPointerCallback)||e.call(i,o)},this.windowOnPointerUp=t=>{var e,i;let s=x(t);if(!this.dragPointerIdArr.includes(s.pointerId))return;1===this.dragObjArr.length&&this.destroyDocumentListeners();let n=this.removeDragObj(s.pointerId);if(!n)return;let r=this.createPointerOutEvent("pointerup",s,{downPageX:n.downPageX,downPageY:n.downPageY});null==(e=(i=this).onPointerCallback)||e.call(i,r)},this.windowOnPointerLeave=t=>{var e,i;let s=x(t);if(!this.dragPointerIdArr.includes(s.pointerId))return;1===this.dragObjArr.length&&this.destroyDocumentListeners();let n=this.removeDragObj(s.pointerId);if(!n)return;let r=this.createPointerOutEvent("pointerup",s,{downPageX:n.downPageX,downPageY:n.downPageY});null==(e=(i=this).onPointerCallback)||e.call(i,r)},this.targetElement.addEventListener(g,this.onPointerMove,b),this.targetElement.addEventListener(u,this.onPointerDown,b),!n.HAS_POINTER_EVENTS)){let t=(t,e,i)=>({pointerId:t.identifier,pointerType:"touch",pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,button:i?0:void 0,buttons:+!!i,timeStamp:e.timeStamp,target:e.target,pressure:+!!i,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()}),e=(e,i)=>{for(let s=0;s<e.changedTouches.length;s++){let n=t(e.changedTouches[s],e,["start","move"].includes(i));"start"===i?this.onPointerDown(n,!1):"move"===i?this.windowOnPointerMove(n):"end"===i?this.windowOnPointerUp(n):this.windowOnPointerLeave(n)}};this.onTouchStart=t=>{t.preventDefault(),e(t,"start")},this.onTouchMove=t=>{e(t,"move")},this.onTouchEnd=t=>{e(t,"end")},this.onTouchCancel=t=>{e(t,"cancel")},this.targetElement.addEventListener("touchstart",this.onTouchStart,b),this.targetElement.addEventListener("touchmove",this.onTouchMove,b),this.targetElement.addEventListener("touchend",this.onTouchEnd,b),this.targetElement.addEventListener("touchcancel",this.onTouchCancel,b)}this.onWheelCallback&&(this.onWheel=t=>{this.wheelCleaner?this.wheelCleaner.process(t):a(t)},this.targetElement.addEventListener("wheel",this.onWheel,{passive:!!t.isWheelPassive})),this.onEnterLeaveCallback&&(this.onPointerEnter=()=>{var t,e;this.isOverCounter++,null==(t=(e=this).onEnterLeaveCallback)||t.call(e,!0)},this.onPointerLeave=()=>{var t,e;this.isOverCounter--,null==(t=(e=this).onEnterLeaveCallback)||t.call(e,!1)},this.targetElement.addEventListener(v,this.onPointerEnter,b),this.targetElement.addEventListener(y,this.onPointerLeave,b)),t.fixScribble&&(this.onTouchMoveScribbleFix=t=>t.preventDefault(),this.targetElement.addEventListener("touchmove",this.onTouchMoveScribbleFix,b))}}}),parcelRegister("dVW3b",function(t,e){$parcel$export(t.exports,"WheelCleaner",function(){return s});let i=200;class s{emit(t){null!==this.position&&null!==this.sequenceUnit&&this.callback({deltaY:Math.round(t/this.sequenceUnit),pageX:this.position.pageX,pageY:this.position.pageY,clientX:this.position.clientX,clientY:this.position.clientY})}endSequence(){null!==this.toEmitDelta&&(this.emit(this.toEmitDelta),this.toEmitDelta=null),null===this.sequenceUnit||this.knownUnitArr.includes(this.sequenceUnit)||this.knownUnitArr.push(this.sequenceUnit),this.sequenceLength=0,this.sequenceUnit=null}process(t){this.position={pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY},this.endSequenceTimeout&&clearTimeout(this.endSequenceTimeout),this.endSequenceTimeout=setTimeout(()=>this.endSequence(),i);let e=t.deltaY;"deltaMode"in t&&1===t.deltaMode&&(e*=100/3);let s=Math.abs(e);if(0===this.sequenceLength){if(this.sequenceLength++,s<50)return;this.sequenceUnit=s,this.knownUnitArr.includes(this.sequenceUnit)?this.emit(e):this.toEmitDelta=e;return}if(null===this.sequenceUnit){this.toEmitDelta=null;return}if(0!==s){if(s===this.sequenceUnit||s/this.sequenceUnit%1<1e-4);else if(this.sequenceUnit/s%1<1e-4)this.sequenceUnit=s;else if(s!==this.sequenceUnit){this.sequenceUnit=null,this.toEmitDelta=null;return}null!==this.toEmitDelta&&(this.emit(this.toEmitDelta),this.toEmitDelta=null),this.emit(e)}}constructor(t){this.callback=t,this.knownUnitArr=[100],this.sequenceLength=0,this.sequenceUnit=null,this.toEmitDelta=null,this.position=null}}}),parcelRegister("3TuLN",function(t,e){$parcel$export(t.exports,"PressureNormalizer",function(){return i});class i{normalize(t,e,i){if("pen"!==i)return t;if(!this.detectionComplete&&("pointerdown"===e?-1===this.initialPointerDownPressure?this.initialPointerDownPressure=t:this.initialPointerDownPressure===t?(this.pointerDownPressureRepeatCount++,this.pointerDownPressureRepeatCount>1&&this.pointerMoveHasDifferentPressure&&(this.detectionComplete=!0,this.isApplePencil=!0)):(this.detectionComplete=!0,this.isApplePencil=!1):"pointermove"===e&&this.initialPointerDownPressure!==t&&(this.pointerMoveHasDifferentPressure=!0)),this.detectionComplete&&this.isApplePencil){if(this.initialPointerDownPressure===t)return 0;t=Math.min(2,2*t)}return t}constructor(){this.detectionComplete=!1,this.isApplePencil=!1,this.initialPointerDownPressure=-1,this.pointerDownPressureRepeatCount=0,this.pointerMoveHasDifferentPressure=!1}}}),parcelRegister("ao0qX",function(t,e){$parcel$export(t.exports,"copyCanvas",function(){return r}),$parcel$export(t.exports,"ctx",function(){return a}),$parcel$export(t.exports,"testShouldPixelate",function(){return o}),$parcel$export(t.exports,"drawTransformedImageWithBounds",function(){return l}),$parcel$export(t.exports,"drawTransformedImageOnCanvas",function(){return h}),$parcel$export(t.exports,"createCheckerCanvas",function(){return c}),$parcel$export(t.exports,"createCheckerDataUrl",function(){return d}),$parcel$export(t.exports,"resizeCanvas",function(){return p}),$parcel$export(t.exports,"convertToAlphaChannelCanvas",function(){return u}),$parcel$export(t.exports,"freeCanvas",function(){return g}),$parcel$export(t.exports,"canvasBounds",function(){return m}),$parcel$export(t.exports,"canvasToBlob",function(){return y}),$parcel$export(t.exports,"drawSelectionMask",function(){return v});var i=parcelRequire("f5ug2"),s=parcelRequire("VM6dD"),n=parcelRequire("aXq9D");function r(t){let e=(0,i.createCanvas)(t.width,t.height),s=e.getContext("2d");if(!s)throw Error("2d context not supported or canvas already initialized");return s.drawImage(t,0,0),e}function a(t,e){let i=t.getContext("2d",e);if(!i)throw Error("couldn't get 2d context");return i}function o(t,e,i){if(![1,-1].includes(e)||![1,-1].includes(i)||t.width%1!=0||t.height%1!=0||Math.abs(t.angleDeg)%90!=0)return!1;let s=Math.abs(t.angleDeg-90)%180==0,n=s?t.height:t.width,r=s?t.width:t.height;return(Math.abs(n)%2==0&&t.x%1==0||Math.abs(n)%2==1&&t.x%1==.5)&&(Math.abs(r)%2==0&&t.y%1==0||Math.abs(r)%2==1&&t.y%1==.5)}function l(t,e,i,s,n){s||(s={x:0,y:0,width:e.width,height:e.height}),t.save(),n?t.imageSmoothingEnabled=!1:(t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high"),t.translate(i.x,i.y),t.rotate(i.angleDeg/180*Math.PI),t.scale(i.width>0?1:-1,i.height>0?1:-1),t.drawImage(e,s.x,s.y,s.width,s.height,-Math.abs(i.width)/2,-Math.abs(i.height)/2,Math.abs(i.width),Math.abs(i.height)),t.restore()}function h(t,e,i){(i=(0,s.copyObj)(i)).center||(i.center={x:e.width/2,y:e.height/2}),i.scale||(i.scale={x:1,y:1}),i.angleDegree||(i.angleDegree=0),i.translate||(i.translate={x:0,y:0});let n=t.getContext("2d");if(!n)throw Error("2d context not supported or canvas already initialized");n.save(),Math.abs(i.scale.x-1)>1e-6||Math.abs(i.scale.y-1)>1e-6||Math.abs(i.angleDegree%90)>1e-6?(n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high"):n.imageSmoothingEnabled=!1,n.translate(i.translate.x,i.translate.y),n.translate(i.center.x,i.center.y),n.rotate(i.angleDegree/180*Math.PI),n.scale(i.scale.x,i.scale.y),n.translate(-i.center.x,-i.center.y),n.drawImage(e,0,0,e.width,e.height),n.restore()}let c=function(t,e){let s,n=(0,i.createCanvas)();if(t<1){if(n.width=1,n.height=1,!(s=n.getContext("2d")))throw Error("2d context not supported or canvas already initialized");s.fillStyle="rgb(128, 128, 128)",s.fillRect(0,0,1,1)}else{if(n.width=2*t,n.height=2*t,!(s=n.getContext("2d")))throw Error("2d context not supported or canvas already initialized");s.fillStyle=e?"rgb(90, 90, 90)":"rgb(255, 255, 255)",s.fillRect(0,0,2*t,2*t),s.fillStyle=e?"rgb(63, 63, 63)":"rgb(200, 200, 200)",s.fillRect(0,0,t,t),s.fillRect(t,t,2*t,2*t)}return n},d=function(){let t={};return function(e,i,s){let n=s?"d":"l";function r(e){if(t[""+(e=parseInt(""+e))+n])return t[""+e+n];let i=c(e,s).toDataURL("image/png");return t[""+e+n]=i,i}if(!i)return r(e);setTimeout(function(){i(r(e))},1)}}();function p(t,e,s,n,r){function a(t,e,i,s){let n={oldWidthEx:Math.round(Math.log2(t)),oldHeightEx:Math.round(Math.log2(e)),newWidthEx:Math.ceil(Math.log2(i)),newHeightEx:Math.ceil(Math.log2(s))};return n.oldWidthEx=Math.max(n.oldWidthEx,n.newWidthEx),n.oldHeightEx=Math.max(n.oldHeightEx,n.newHeightEx),n}if(e&&s&&(e!==t.width||s!==t.height))if(e=Math.max(e,1),s=Math.max(s,1),e<=t.width&&s<=t.height){let o,l;n=n||(0,i.createCanvas)(),r=r||(0,i.createCanvas)();let h=a(t.width,t.height,e,s);r.width=h.oldWidthEx>h.newWidthEx?Math.pow(2,h.oldWidthEx):e,r.height=h.oldHeightEx>h.newHeightEx?Math.pow(2,h.oldHeightEx):s,n.getContext("2d").save(),r.getContext("2d").save();let c=n,d=r;o=h.oldWidthEx,l=h.oldHeightEx;let p=d.getContext("2d");p.imageSmoothingEnabled=!0,p.imageSmoothingQuality="high",p.globalCompositeOperation="copy",p.drawImage(t,0,0,d.width,d.height);let u=d.width,g=d.height;for(;o>h.newWidthEx||l>h.newHeightEx;o--,l--){(p=c.getContext("2d")).imageSmoothingEnabled=!0,p.imageSmoothingQuality="high",p.globalCompositeOperation="copy";let t=o>h.newWidthEx?u/2:u,e=l>h.newHeightEx?g/2:g;c.width=t,c.height=e,p.drawImage(d,0,0,u,g,0,0,t,e),u=t,g=e;let i=c;c=d,d=i}t.width=e,t.height=s;let m=t.getContext("2d");m.save(),m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.drawImage(d,0,0,u,g,0,0,e,s),m.restore(),n.getContext("2d").restore(),r.getContext("2d").restore()}else if(e>=t.width&&s>=t.height){(n=n||(0,i.createCanvas)()).width=e,n.height=s;let r=n.getContext("2d");r.save(),r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(t,0,0,e,s),r.restore(),t.width=e,t.height=s,t.getContext("2d").drawImage(n,0,0)}else p(t,e,t.height,n,r),p(t,e,s,n,r)}function u(t){let e=t.getContext("2d").getImageData(0,0,t.width,t.height);for(let t=0;t<e.data.length;t+=4)0!==e.data[t+3]&&(e.data[t+3]=(e.data[t]+e.data[t+1]+e.data[t+2])/3*(e.data[t+3]/255));t.getContext("2d").putImageData(e,0,0)}function g(t){t.width=1,t.height=1,t.remove()}function m(t,e){let i=null!=e?e:{x1:0,y1:0,x2:t.canvas.width-1,y2:t.canvas.height-1},s=i.x2-i.x1+1,n=i.y2-i.y1+1,r=t.getImageData(i.x1,i.y1,s,n);if(r.data[3]>0&&r.data[r.data.length-1]>0)return{x:i.x1,y:i.y1,width:i.x2-i.x1+1,height:i.y2-i.y1+1};let a={x1:void 0,y1:void 0,x2:void 0,y2:void 0};for(let t=3;t<r.data.length;t+=4)if(r.data[t]>0){let e=(t-3)/4%s,i=Math.floor((t-3)/4/s);(void 0===a.x1||a.x1>e)&&(a.x1=e),void 0===a.y1&&(a.y1=i),(void 0===a.x2||a.x2<e)&&(a.x2=e),(void 0===a.y2||a.y2<i)&&(a.y2=i)}if(void 0!==a.x1&&void 0!==a.y1&&void 0!==a.x2&&void 0!==a.y2)return{x:a.x1+i.x1,y:a.y1+i.y1,width:a.x2-a.x1+1,height:a.y2-a.y1+1}}function f(t,e){return new Promise((i,s)=>{t.toBlob(t=>{t?i(t):s(Error("Failed to create blob from canvas."))},e)})}async function y(t,e){return"toBlob"in HTMLCanvasElement.prototype?await f(t,e):(0,s.base64ToBlob)(t.toDataURL(e))}function v(t,e){let i=e.canvas;e.save(),e.fillRect(0,0,i.width,i.height);let s=(0,n.getSelectionPath2d)(t);e.clip(s),e.fillStyle="white",e.fillRect(0,0,i.width,i.height),e.restore()}}),parcelRegister("f5ug2",function(t,e){$parcel$export(t.exports,"createCanvas",function(){return i});function i(t,e){let i=document.createElement("canvas");return t&&e&&(i.width=t,i.height=e),i}}),parcelRegister("aXq9D",function(t,e){function i(t){let e=new Path2D;return t.forEach(t=>{t.forEach(t=>{t.forEach((t,i)=>{0===i?e.moveTo(...t):e.lineTo(...t)})}),e.closePath()}),e}function s(t){let e="";return t.forEach(t=>{t.forEach(t=>{e+="M",t.forEach(t=>{e+=t.join(",")+" "})})}),e.trim()}$parcel$export(t.exports,"getSelectionPath2d",function(){return i}),$parcel$export(t.exports,"getSvgPathD",function(){return s})}),parcelRegister("2SCiK",function(t,e){function i(t,e){return[e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15]]}function s(t,e){let s=[e[0],e[1],e[2],e[3]],n=[e[4],e[5],e[6],e[7]],r=[e[8],e[9],e[10],e[11]],a=[e[12],e[13],e[14],e[15]],o=i(t,s),l=i(t,n),h=i(t,r),c=i(t,a);return[o[0],o[1],o[2],o[3],l[0],l[1],l[2],l[3],h[0],h[1],h[2],h[3],c[0],c[1],c[2],c[3]]}$parcel$export(t.exports,"Matrix",function(){return n});let n=Object.freeze({getIdentity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiplyMatrixAndPoint:i,multiplyMatrices:s,createTranslationMatrix:function(t,e){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]},createRotationMatrix:function(t){return[Math.cos(-t),-Math.sin(-t),0,0,Math.sin(-t),Math.cos(-t),0,0,0,0,1,0,0,0,0,1]},createScaleMatrix:function(t){return[t,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]}})}),parcelRegister("70cu1",function(t,e){$parcel$export(t.exports,"Vec2",function(){return i});let i={add:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},nor:function(t){let e=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x/e,y:t.y/e}},len:function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))},dist:function(t,e){return i.len(i.sub(t,e))},mul:function(t,e){return{x:t.x*e,y:t.y*e}},angle:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},dot:function(t,e){let i=[t.x,t.y],s=[e.x,e.y];return i.map((t,e)=>i[e]*s[e]).reduce((t,e)=>t+e)}}}),parcelRegister("4zqo7",function(t,e){$parcel$export(t.exports,"projectPointOnLine",function(){return r}),$parcel$export(t.exports,"PointLine",function(){return a}),$parcel$export(t.exports,"BezierLine",function(){return o}),$parcel$export(t.exports,"SplineInterpolator",function(){return l}),$parcel$export(t.exports,"powerSplineInput",function(){return h});var i=parcelRequire("70cu1"),s=parcelRequire("8cWis"),n=parcelRequire("VM6dD");let r=function(t,e,i){let s,n;if(t.x===e.x)return{x:s=t.x,y:n=i.y};let r=(e.y-t.y)/(e.x-t.x),a=t.y-r*t.x;return{x:s=(r*i.y+i.x-r*a)/(r*r+1),y:n=(r*r*i.y+r*i.x+a)/(r*r+1)}};class a{getAtDist(t){let e=Math.min(this.getLength(),t),i=0;for(;e>this.segmentArr[i].length&&i<this.segmentArr.length-2;i++)e-=this.segmentArr[i].length;let s=Math.min(1,Math.max(0,e/this.segmentArr[i].length));return{x:this.segmentArr[i].x*(1-s)+this.segmentArr[i+1].x*s,y:this.segmentArr[i].y*(1-s)+this.segmentArr[i+1].y*s}}getLength(){let t=0;for(let e=0;e<this.segmentArr.length-1;e++)t+=this.segmentArr[e].length;return t}constructor(t){this.segmentArr=[];for(let e=0;e<t.points.length;e++)(e=>{let i=0;e<t.points.length-1&&(i=(0,s.dist)(t.points[e].x,t.points[e].y,t.points[e+1].x,t.points[e+1].y)),this.segmentArr[e]={x:t.points[e].x,y:t.points[e].y,length:i}})(e)}}class o{getBezierPoints(t,e,i,s,n){let r,a=[];for(let o=0;o<=n;o++)r=o/n,a[a.length]={x:Math.pow(1-r,3)*t.x+3*Math.pow(1-r,2)*r*e.x+3*(1-r)*Math.pow(r,2)*i.x+Math.pow(r,3)*s.x,y:Math.pow(1-r,3)*t.y+3*Math.pow(1-r,2)*r*e.y+3*(1-r)*Math.pow(r,2)*i.y+Math.pow(r,3)*s.y};return a}add(t,e,r,o,l){let h;if(this.lastPoint&&t===this.lastPoint.x&&e===this.lastPoint.y)return;if(this.lastPoint={x:t,y:e},this.pointArr[this.pointArr.length]={x:t,y:e,spacing:r},1===this.pointArr.length){this.lastSpacing=r;return}if(2===this.pointArr.length){this.pointArr[0].dir=i.Vec2.nor(i.Vec2.sub(this.pointArr[1],this.pointArr[0])),this.lastDot=r,this.lastSpacing=r;return}{let t=this.pointArr[this.pointArr.length-1],e=this.pointArr[this.pointArr.length-2],s=this.pointArr[this.pointArr.length-3];e.dir=i.Vec2.nor(i.Vec2.sub(t,s)),(isNaN(e.dir.x)||isNaN(e.dir.y))&&(e.dir=(0,n.copyObj)(s.dir))}let c=this.pointArr[this.pointArr.length-3],d=this.pointArr[this.pointArr.length-2],p=c,u=i.Vec2.add(c,i.Vec2.mul(c.dir,i.Vec2.dist(c,d)/4)),g=i.Vec2.sub(d,i.Vec2.mul(d.dir,i.Vec2.dist(c,d)/4)),m=d,f=(h=new a(o?{points:this.getBezierPoints(p,u,g,m,20)}:{points:[p,m]})).getLength(),y=(0,s.mix)(this.lastSpacing,r,(0,s.clamp)(this.lastDot/f,0,1)),v=this.lastDot;for(;v<=f;v+=y){y=(0,s.mix)(this.lastSpacing,r,(0,s.clamp)(v/f,0,1));let t=h.getAtDist(v),e=this.lastCallbackPoint?(0,s.pointsToAngleDeg)(this.lastCallbackPoint,t):void 0;o&&o({x:t.x,y:t.y,t:v/f,angle:e,dAngle:this.lastCallbackPoint?e-this.lastAngle:0}),this.lastCallbackPoint=t,this.lastAngle=e}o?this.lastDot=v-f:(this.lastDot=0,null==l||l({p1:p,p2:u,p3:g,p4:m})),this.lastSpacing=r}addFinal(t,e,s){if(this.pointArr.length<2)return;let n=this.pointArr[this.pointArr.length-2],r=this.pointArr[this.pointArr.length-1],a=i.Vec2.add(r,i.Vec2.sub(r,n));this.add(a.x,a.y,t,e,s)}constructor(){this.lastDot=0,this.pointArr=[]}}class l{getFirstX(){return this.first}getLastX(){return this.last}interpolate(t){let e=this.ya.length,i=0,s=e-1;for(;s-i>1;){let e=s+i>>1;this.xa[e]>t?s=e:i=e}let n=this.xa[s]-this.xa[i],r=(this.xa[s]-t)/n,a=(t-this.xa[i])/n;return r*this.ya[i]+a*this.ya[s]+((r*r*r-r)*this.y2[i]+(a*a*a-a)*this.y2[s])*(n*n)/6}findX(t,e){let i,s;for(let n=0;n<=e;n++){let r=n/e,a=this.interpolate(r);if(void 0===i){i=r,s=Math.abs(a-t);continue}let o=Math.abs(a-t);if(o<s)i=r,s=o;else break}return i}constructor(t){let e,i=t.length;for(this.xa=[],this.ya=[],this.u=[],this.y2=[],this.first=t[0][0],this.last=t[t.length-1][0],t.sort(function(t,e){return t[0]-e[0]}),e=0;e<i;e++)this.xa.push(t[e][0]),this.ya.push(t[e][1]);for(e=1,this.u[0]=0,this.y2[0]=0;e<i-1;++e){let t=this.xa[e+1]-this.xa[e-1],i=(this.xa[e]-this.xa[e-1])/t,s=i*this.y2[e-1]+2;this.y2[e]=(i-1)/s;let n=(this.ya[e+1]-this.ya[e])/(this.xa[e+1]-this.xa[e])-(this.ya[e]-this.ya[e-1])/(this.xa[e]-this.xa[e-1]);this.u[e]=(6*n/t-i*this.u[e-1])/s}for(this.y2[i-1]=0,e=i-2;e>=0;--e)this.y2[e]=this.y2[e]*this.y2[e+1]+this.u[e]}}function h(t,e,i,s=2){function n(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}let r=[];for(let a=0;a<=1;a+=i)r.push([n(a,4),n(t+Math.pow(a,s)*(e-t),4)]);return r}}),parcelRegister("8cWis",function(t,e){function i(t,e,i){return t*(1-i)+e*i}function s(t,e,i,s){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-s,2))}function n(t,e,i,s){return Math.pow(t-i,2)+Math.pow(e-s,2)}function r(t,e){return t*t+e*e}function a(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function o(t,e){return 180*a(t,e)/Math.PI}function l(t,e){return e.x<=t.x&&t.x<=e.x+e.width&&e.y<=t.y&&t.y<=e.y+e.height}function h(t,e,i){return t<e?e:t>i?i:t}function c(t,e,i){let s=Math.PI/180*i,n=Math.cos(s),r=Math.sin(s);return{x:t*n-e*r,y:t*r+e*n}}function d(t,e,i){let s=c(e.x-t.x,e.y-t.y,i);return s.x+=t.x,s.y+=t.y,s}function p(t,e,i){let s=Math.abs(t%e);return Math.min(s,e-s)<=i&&(t=Math.round(t/e)*e),t}function u(t){return(t%=360)>180?t-=360:t<-180&&(t+=360),t}function g(t,e,i){t.x+=e,t.y+=i;let s=Math.round(t.x),n=Math.round(t.y);return t.x-=s,t.y-=n,{dX:s,dY:n}}function m(t){if(t%1==0)return t%2==0?t:t+1;let e=Math.ceil(t),i=Math.floor(t);return e%2==0?e:i}function f(t){if(t%1==0)return t%2==0?t+1:t;let e=Math.ceil(t),i=Math.floor(t);return e%2==1?e:i}function y(t,e){let i=Math.pow(10,e);return Math.round(t*i)/i}function v(t,e){if(!e&&!t)throw Error("at least one param needs to be defined");return e&&(t?(t.x1=Math.min(t.x1,e.x1),t.y1=Math.min(t.y1,e.y1),t.x2=Math.max(t.x2,e.x2),t.y2=Math.max(t.y2,e.y2)):t={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),t}function x(t,e){if(!t)return;if(!e)return t;let i=Math.max(e.x1,t.x1),s=Math.max(e.y1,t.y1),n=Math.min(e.x2,t.x2),r=Math.min(e.y2,t.y2);if(!(i>n)&&!(s>r))return{x1:i,y1:s,x2:n,y2:r}}function b(t,e,i){if(t)return x(t,{x1:0,y1:0,x2:e-1,y2:i-1})}function w(t,e,i,s){let n=Math.max(0,Math.floor(t.x1)),r=Math.max(0,Math.floor(t.y1)),a=Math.min(e-!!s,Math.ceil(t.x2)),o=Math.min(i-!!s,Math.ceil(t.y2));if(!(n>a)&&!(r>o))return{x1:n,y1:r,x2:a,y2:o}}function B(t,e){return{x:t.x1,y:t.y1,width:t.x2-t.x1+ +!!e,height:t.y2-t.y1+ +!!e}}function S(t){return{x1:Math.floor(t.x1),y1:Math.floor(t.y1),x2:Math.ceil(t.x2),y2:Math.ceil(t.y2)}}$parcel$export(t.exports,"mix",function(){return i}),$parcel$export(t.exports,"dist",function(){return s}),$parcel$export(t.exports,"distSquared",function(){return n}),$parcel$export(t.exports,"lenSquared",function(){return r}),$parcel$export(t.exports,"pointsToAngleRad",function(){return a}),$parcel$export(t.exports,"pointsToAngleDeg",function(){return o}),$parcel$export(t.exports,"isInsideRect",function(){return l}),$parcel$export(t.exports,"clamp",function(){return h}),$parcel$export(t.exports,"rotate",function(){return c}),$parcel$export(t.exports,"rotateAround",function(){return d}),$parcel$export(t.exports,"snapAngleDeg",function(){return p}),$parcel$export(t.exports,"minimizeAngleDeg",function(){return u}),$parcel$export(t.exports,"intDxy",function(){return g}),$parcel$export(t.exports,"roundEven",function(){return m}),$parcel$export(t.exports,"roundUneven",function(){return f}),$parcel$export(t.exports,"round",function(){return y}),$parcel$export(t.exports,"updateBounds",function(){return v}),$parcel$export(t.exports,"boundsOverlap",function(){return x}),$parcel$export(t.exports,"boundsInArea",function(){return b}),$parcel$export(t.exports,"intBoundsWithinArea",function(){return w}),$parcel$export(t.exports,"boundsToRect",function(){return B}),$parcel$export(t.exports,"integerBounds",function(){return S})}),parcelRegister("5EmwV",function(t,e){$parcel$export(t.exports,"HSV",function(){return i}),$parcel$export(t.exports,"RGB",function(){return s}),$parcel$export(t.exports,"CMYK",function(){return n}),$parcel$export(t.exports,"ColorConverter",function(){return r}),$parcel$export(t.exports,"testIsWhiteBestContrast",function(){return a});class i{constructor(t,e,i){this.h=Math.max(0,Math.min(360,t)),this.s=Math.max(.001,Math.min(100,e)),this.v=Math.max(0,Math.min(100,i))}}class s{constructor(t,e,i){this.r=Math.max(0,Math.min(255,t)),this.g=Math.max(0,Math.min(255,e)),this.b=Math.max(0,Math.min(255,i))}}class n{constructor(t,e,i,s){this.c=Math.max(0,Math.min(100,t)),this.m=Math.max(0,Math.min(100,e)),this.y=Math.max(0,Math.min(100,i)),this.k=Math.max(0,Math.min(100,s))}}let r={_RGBtoHSV:function(t){let e=new i(0,0,0),s=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(s,n,r),o=Math.max(s,n,r),l=o-a;if(e.v=o,0==l)e.h=0,e.s=0;else{e.s=l/o;let t=((o-s)/6+l/2)/l,i=((o-n)/6+l/2)/l,a=((o-r)/6+l/2)/l;s==o?e.h=a-i:n==o?e.h=1/3+t-a:r==o&&(e.h=2/3+i-t),e.h<0&&(e.h+=1),e.h>1&&(e.h-=1)}return e.h=Math.round(360*e.h),e.s=Math.round(100*e.s),e.v=Math.round(100*e.v),e},_HSVtoRGB:function(t){let e,i,n,r,a,o,l,h,c=new s(0,0,0),d=t.h/360%1,p=t.s/100,u=t.v/100;return 0==p?(c.r=255*u,c.g=255*u,c.b=255*u):(i=Math.floor(e=6*d),n=u*(1-p),r=u*(1-p*(e-i)),a=u*(1-p*(1-(e-i))),0==i?(o=u,l=a,h=n):1==i?(o=r,l=u,h=n):2==i?(o=n,l=u,h=a):3==i?(o=n,l=r,h=u):4==i?(o=a,l=n,h=u):(o=u,l=n,h=r),c.r=255*o,c.g=255*l,c.b=255*h,c.r=Math.round(c.r),c.g=Math.round(c.g),c.b=Math.round(c.b)),c},_CMYKtoRGB:function(t){let e=new s(0,0,0),i=t.c/100,n=t.m/100,r=t.y/100,a=t.k/100;return e.r=1-Math.min(1,i*(1-a)+a),e.g=1-Math.min(1,n*(1-a)+a),e.b=1-Math.min(1,r*(1-a)+a),e.r=Math.round(255*e.r),e.g=Math.round(255*e.g),e.b=Math.round(255*e.b),e},_RGBtoCMYK:function(t){let e=new n(0,0,0,0),i=t.r/255,s=t.g/255,r=t.b/255;return e.k=Math.min(1-i,1-s,1-r),e.c=(1-i-e.k)/(1-e.k),e.m=(1-s-e.k)/(1-e.k),e.y=(1-r-e.k)/(1-e.k),e.c=Math.round(100*e.c),e.m=Math.round(100*e.m),e.y=Math.round(100*e.y),e.k=Math.round(100*e.k),e},toRGB:function(t){if(t instanceof s)return t;if(t instanceof i)return this._HSVtoRGB(t);if(t instanceof n)return this._CMYKtoRGB(t);throw Error("unknown type")},toHSV:function(t){if(t instanceof i)return t;if(t instanceof s)return this._RGBtoHSV(t);if(t instanceof n)return this._RGBtoHSV(this._CMYKtoRGB(t));throw Error("unknown type")},toCMYK:function(t){if(t instanceof n)return t;if(t instanceof s)return this._RGBtoCMYK(t);if(t instanceof i)return this._RGBtoCMYK(this._HSVtoRGB(t));throw Error("unknown type")},toHexString:function(t){if(t instanceof s||"r"in t&&"g"in t&&"b"in t){let e=parseInt(""+t.r).toString(16),i=parseInt(""+t.g).toString(16),s=parseInt(""+t.b).toString(16);return 1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),1==s.length&&(s="0"+s),e+i+s}return"#000"},toRgbStr:function(t){return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"},toRgbaStr:function(t){return"rgba("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+", "+t.a+")"},hexToRGB:function(t){t=t.trim();let e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,s){return e+e+i+i+s+s});let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?new s(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)):void 0}};function a(t){return .299*t.r+.587*t.g+.114*t.b<125}}),parcelRegister("jmKbV",function(t,e){$parcel$export(t.exports,"appendTextDiv",function(){return n}),$parcel$export(t.exports,"isInputFocused",function(){return r}),$parcel$export(t.exports,"unfocusAnyInput",function(){return a}),$parcel$export(t.exports,"clearSelection",function(){return o}),$parcel$export(t.exports,"makeUnfocusable",function(){return l}),$parcel$export(t.exports,"el",function(){return c}),$parcel$export(t.exports,"destroyEl",function(){return d}),$parcel$export(t.exports,"createImage",function(){return p});var i=parcelRequire("VM6dD"),s=parcelRequire("2Eggz");function n(t,e){let i=document.createElement("div");return i.innerHTML=e,t.append(i),i}function r(t=!1){var e;let i=!!document.activeElement&&["INPUT","TEXTAREA","SELECT"].includes(document.activeElement.tagName);return t?i:i&&!(null==(e=document.activeElement)?void 0:e.getAttribute("data-ignore-focus"))}function a(){if(r(!0)){let t=s.BB.el({parent:document.body,tagName:"input",css:{opacity:"0",width:"0",height:"0"}});setTimeout(()=>{t.select(),t.focus(),t.remove()},10)}}function o(){if(window.getSelection){let t=window.getSelection();t&&(t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges())}}let l=function(){function t(t){t.preventDefault();let e=!1;if(t.relatedTarget)try{t.relatedTarget.focus(),e=!0}catch(t){console.error("failed to focus")}e||t.currentTarget.blur()}return function(e){e.setAttribute("tabindex","-1"),e.addEventListener("focus",t)}}(),h=[];function c(t){if(!t)return document.createElement("div");let e=document.createElement(t.tagName?t.tagName:"div");t.css&&(0,i.css)(e,t.css),t.content&&("string"==typeof t.content?e.innerHTML=t.content:Array.isArray(t.content)?s.BB.append(e,t.content):e.append(t.content)),t.textContent&&(e.textContent=t.textContent),t.className&&(e.className=t.className),t.id&&(e.id=t.id),t.parent&&t.parent.append(e),"title"in t&&void 0!==t.title&&(e.title=t.title);let n=[];if(void 0!==t.onClick&&(e.addEventListener("click",t.onClick),t.noRef||n.push(["click",t.onClick])),void 0!==t.onChange&&(e.addEventListener("change",t.onChange),t.noRef||n.push(["change",t.onChange])),n.length>0&&h.push({el:e,listeners:n}),"custom"in t&&t.custom){let i=Object.keys(t.custom);for(let s=0;s<i.length;s++)e.setAttribute(i[s],t.custom[i[s]])}return e}function d(t){if(t)for(let e=0;e<h.length;e++){let i=h[e];if(i.el===t){i.listeners.forEach(e=>{t.removeEventListener(e[0],e[1])}),h.splice(e,1);break}}}function p(t){let e=new Image;return void 0!==t.src&&(e.src=t.src),void 0!==t.alt&&(e.alt=t.alt),void 0!==t.width&&(e.width=t.width),void 0!==t.height&&(e.height=t.height),void 0!==t.className&&(e.className=t.className),t.css&&(0,i.css)(e,t.css),e}}),parcelRegister("2A815",function(t,e){$parcel$export(t.exports,"BbLog",function(){return i});class i{static subscribe(t){i.listeners.includes(t)||i.listeners.push(t)}static unsubscribe(t){for(let e=0;e<i.listeners.length;e++)if(t===i.listeners[e])return void i.listeners.splice(e,1)}static emit(t){i.listeners.forEach(e=>{e(t)})}}i.listeners=[]}),parcelRegister("dGRuJ",function(t,e){$parcel$export(t.exports,"LocalStorage",function(){return i});class i{static getItem(t){let e=null;try{e=localStorage.getItem(t)}catch(t){this.error=t}return e}static setItem(t,e){try{localStorage.setItem(t,e)}catch(t){this.error=t}}static removeItem(t){try{localStorage.removeItem(t)}catch(t){this.error=t}}static getError(){return this.error}}}),parcelRegister("h5jm6",function(t,e){$parcel$export(t.exports,"CoalescedExploder",function(){return s});var i=parcelRequire("VM6dD");class s{setChainOut(t){this.chainOut=t}chainIn(t){if("pointermove"!==t.type||!t.coalescedArr||!(t.coalescedArr.length>0))return t;for(let e=0;e<t.coalescedArr.length;e++){let s=(0,i.copyObj)(t);0===e&&(s.coalescedArr=[]);let n=t.coalescedArr[e];s.pageX=n.pageX,s.pageY=n.pageY,s.relX=n.relX,s.relY=n.relY,s.dX=n.dX,s.dY=n.dY,s.time=n.time,s.isCoalesced=e<t.coalescedArr.length-1,this.chainOut&&this.chainOut(s)}return null}}}),parcelRegister("1CkT5",function(t,e){$parcel$export(t.exports,"NFingerTapper",function(){return s});var i=parcelRequire("8cWis");class s{failGesture(){if(0!==this.eventQueueArr.length){this.timeoutObj.firstLastDownTimeout&&clearTimeout(this.timeoutObj.firstLastDownTimeout),this.timeoutObj.tapTimeout&&clearTimeout(this.timeoutObj.tapTimeout);for(let t=0;t<this.eventQueueArr.length;t++)this.chainOut&&this.chainOut(this.eventQueueArr[t]);this.eventQueueArr=[],this.fingerArr=[]}}success(){this.timeoutObj.firstLastDownTimeout&&clearTimeout(this.timeoutObj.firstLastDownTimeout),this.timeoutObj.tapTimeout&&clearTimeout(this.timeoutObj.tapTimeout),this.eventQueueArr=[],this.fingerArr=[],this.onTap()}setupTimeout(t,e){let i=e-this.nowTime;return!(i<=0)&&(this.timeoutObj[t]=setTimeout(()=>this.failGesture(),i),!0)}processEvent(t){let e=this.lastEventTime;if(this.lastEventTime=t.time,"pointerdown"===t.type)this.pointersDownIdArr.push(t.pointerId);else if("pointerup"===t.type){for(let e=0;e<this.pointersDownIdArr.length;e++)if(this.pointersDownIdArr[e]===t.pointerId){this.pointersDownIdArr.splice(e,1);break}}if("touch"!==t.pointerType){this.fingerArr.length>0&&this.failGesture();return}if(this.nowTime=performance.now(),"pointerdown"===t.type)return this.fingerArr.length+1!==this.pointersDownIdArr.length||this.fingerArr.length===this.fingers||this.fingerArr.length>0&&t.time-this.maxFirstLastFingerDownMs>this.fingerArr[0].downTimeMs||0===this.fingerArr.length&&t.time-this.minSilenceBeforeDurationMs<e||0===this.fingerArr.length&&(this.firstDownTime=t.time,!this.setupTimeout("firstLastDownTimeout",t.time+this.maxFirstLastFingerDownMs)||!this.setupTimeout("tapTimeout",t.time+this.maxTapMs))?void this.failGesture():void this.fingerArr.push({pointerId:t.pointerId,downTimeMs:t.time,downPageX:t.pageX,downPageY:t.pageY});if("pointermove"===t.type){if(0===this.fingerArr.length)return;let e=null;for(let i=0;i<this.fingerArr.length;i++)if(this.fingerArr[i].pointerId===t.pointerId){e=this.fingerArr[i];break}if(null===e||t.time-this.maxTapMs>this.firstDownTime||(0,i.dist)(t.pageX,t.pageY,e.downPageX,e.downPageY)>this.maxPressedDistancePx)return void this.failGesture()}if("pointerup"===t.type){if(0===this.fingerArr.length)return;if(this.fingerArr.length!==this.fingers)return void this.failGesture();let e=null,s=0;for(;s<this.fingerArr.length;s++)if(this.fingerArr[s].pointerId===t.pointerId){e=this.fingerArr[s];break}if(null===e)return;if(t.time-this.maxTapMs>this.firstDownTime||(0,i.dist)(t.pageX,t.pageY,e.downPageX,e.downPageY)>this.maxPressedDistancePx)return void this.failGesture();e.isUp=!0;let n=!0;for(let t=0;t<this.fingerArr.length;t++)if(!this.fingerArr[t].isUp){n=!1;break}if(n)return this.success(),!0}}chainIn(t){return!0===this.processEvent(t)?null:0===this.fingerArr.length?t:(this.eventQueueArr.push(t),null)}setChainOut(t){this.chainOut=t}constructor(t){this.minSilenceBeforeDurationMs=50,this.maxTapMs=500,this.maxFirstLastFingerDownMs=250,this.maxPressedDistancePx=12,this.fingerArr=[],this.eventQueueArr=[],this.firstDownTime=0,this.lastEventTime=0,this.nowTime=performance.now(),this.pointersDownIdArr=[],this.timeoutObj={firstLastDownTimeout:null,tapTimeout:null},this.fingers=t.fingers,this.onTap=t.onTap}}}),parcelRegister("2WBc7",function(t,e){$parcel$export(t.exports,"PinchZoomer",function(){return s});var i=parcelRequire("8cWis");class s{end(){this.gestureObj=null,this.eventQueueArr=[]}fail(t){if(this.gestureObj){if(this.timeoutObj.secondFingerTimeout&&clearTimeout(this.timeoutObj.secondFingerTimeout),!t)for(let t=0;t<this.eventQueueArr.length;t++)this.chainOut&&this.chainOut(this.eventQueueArr[t]);this.end()}}setupFailTimeout(t){let e=t-this.nowTime;return!(e<=0)&&(this.timeoutObj.secondFingerTimeout=setTimeout(()=>this.fail(),e),!0)}processEvent(t){if("pointerdown"===t.type)this.pointersDownIdArr.push(t.pointerId);else if("pointerup"===t.type){for(let e=0;e<this.pointersDownIdArr.length;e++)if(this.pointersDownIdArr[e]===t.pointerId){this.pointersDownIdArr.splice(e,1);break}}if(this.gestureObj||"touch"===t.pointerType&&("pointermove"!==t.type||!(this.pointersDownIdArr.length>0))&&!(this.pointersDownIdArr.length>1)&&"pointerup"!==t.type){if(this.nowTime=performance.now(),"pointerdown"===t.type)if(!this.gestureObj)return(this.gestureObj={touchPointerArr:[{pointerId:t.pointerId,relX:t.relX,relY:t.relY,downRelX:t.relX,downRelY:t.relY}],otherPointerIdArr:[],isInProgress:!1},this.setupFailTimeout(t.time+this.untilSecondFingerDurationMs))?void 0:void this.fail();else{if("touch"!==t.pointerType)return void(this.gestureObj.isInProgress?this.gestureObj.otherPointerIdArr.push(t.pointerId):this.fail());this.gestureObj.touchPointerArr.push({pointerId:t.pointerId,relX:t.relX,relY:t.relY}),this.gestureObj.isInProgress?this.continuePinch(this.gestureObj,{type:"down",index:this.gestureObj.touchPointerArr.length-1}):(this.timeoutObj.secondFingerTimeout&&clearTimeout(this.timeoutObj.secondFingerTimeout),this.gestureObj.isInProgress=!0,this.beginPinch(this.gestureObj));return}if(!this.gestureObj)return void this.fail();if("pointermove"===t.type&&"touch"===t.pointerType){let e=null,s=0;for(;s<this.gestureObj.touchPointerArr.length;s++)if(t.pointerId===this.gestureObj.touchPointerArr[s].pointerId){e=this.gestureObj.touchPointerArr[s];break}if(!e)return void this.fail();if(e.relX=t.relX,e.relY=t.relY,this.gestureObj.isInProgress)s<2&&this.continuePinch(this.gestureObj,{type:"move",index:s});else if(!("downRelX"in e&&void 0!==e.downRelX)||!("downRelY"in e&&void 0!==e.downRelY)||(0,i.dist)(e.downRelX,e.downRelY,e.relX,e.relY)>this.firstFingerMaxDistancePx)return void this.fail();return}if("pointerup"===t.type){if("touch"===t.pointerType){let e=0;for(;e<this.gestureObj.touchPointerArr.length;e++)if(this.gestureObj.touchPointerArr[e].pointerId===t.pointerId){this.gestureObj.touchPointerArr.splice(e,1);break}this.gestureObj.touchPointerArr.length>0&&this.continuePinch(this.gestureObj,{type:"up",index:e})}else for(let e=0;e<this.gestureObj.otherPointerIdArr.length;e++)if(this.gestureObj.otherPointerIdArr[e]===t.pointerId){this.gestureObj.otherPointerIdArr.splice(e,1);break}if(0===this.gestureObj.touchPointerArr.length&&0===this.gestureObj.otherPointerIdArr.length)return void(this.gestureObj.isInProgress?(this.end(),this.endPinch()):this.fail())}}}beginPinch(t){for(let e=0;e<t.touchPointerArr.length;e++){let i=t.touchPointerArr[e];this.pincherArr.push({pointerId:i.pointerId,relX:i.relX,relY:i.relY,downRelX:i.relX,downRelY:i.relY})}let e={type:"move",downRelX:0,downRelY:0,relX:0,relY:0,angleRad:0,scale:1};1===this.pincherArr.length?(e.relX=this.pincherArr[0].downRelX,e.relY=this.pincherArr[0].downRelY):(e.relX=.5*(this.pincherArr[0].downRelX+this.pincherArr[1].downRelX),e.relY=.5*(this.pincherArr[0].downRelY+this.pincherArr[1].downRelY)),e.downRelX=e.relX,e.downRelY=e.relY,this.onPinch(e)}continuePinch(t,e){if(!(e.index>1))if("move"===e.type){let s;if(this.pincherArr[e.index].relX=t.touchPointerArr[e.index].relX,this.pincherArr[e.index].relY=t.touchPointerArr[e.index].relY,1===this.pincherArr.length)s={type:"move",downRelX:this.pincherArr[0].downRelX,downRelY:this.pincherArr[0].downRelY,relX:this.pincherArr[0].relX,relY:this.pincherArr[0].relY,angleRad:0,scale:1};else{let t=(0,i.dist)(this.pincherArr[0].downRelX,this.pincherArr[0].downRelY,this.pincherArr[1].downRelX,this.pincherArr[1].downRelY),e=(0,i.dist)(this.pincherArr[0].relX,this.pincherArr[0].relY,this.pincherArr[1].relX,this.pincherArr[1].relY),n=(0,i.pointsToAngleRad)({x:this.pincherArr[0].downRelX,y:this.pincherArr[0].downRelY},{x:this.pincherArr[1].downRelX,y:this.pincherArr[1].downRelY}),r=(0,i.pointsToAngleRad)({x:this.pincherArr[0].relX,y:this.pincherArr[0].relY},{x:this.pincherArr[1].relX,y:this.pincherArr[1].relY});s={type:"move",downRelX:.5*(this.pincherArr[0].downRelX+this.pincherArr[1].downRelX),downRelY:.5*(this.pincherArr[0].downRelY+this.pincherArr[1].downRelY),relX:.5*(this.pincherArr[0].relX+this.pincherArr[1].relX),relY:.5*(this.pincherArr[0].relY+this.pincherArr[1].relY),angleRad:r-n,scale:e/t}}this.onPinch(s)}else("down"===e.type||"up"===e.type)&&(this.endPinch(),this.beginPinch(t))}endPinch(){this.pincherArr=[],this.onPinch({type:"end"})}chainIn(t){return(this.processEvent(t),this.gestureObj)?(this.gestureObj.isInProgress||this.eventQueueArr.push(t),null):t}setChainOut(t){this.chainOut=t}constructor(t){this.firstFingerMaxDistancePx=10,this.untilSecondFingerDurationMs=250,this.pointersDownIdArr=[],this.gestureObj=null,this.eventQueueArr=[],this.nowTime=performance.now(),this.timeoutObj={secondFingerTimeout:null},this.pincherArr=[],this.onPinch=t.onPinch}}}),parcelRegister("lEiB9",function(t,e){$parcel$export(t.exports,"DoubleTapper",function(){return s});var i=parcelRequire("8cWis");class s{success(){this.timeoutObj.fail=null,this.timeoutObj.success=null,this.eventQueueArr=[];let t=this.sequenceArr[this.sequenceArr.length-1];this.sequenceArr=[],"pageX"in t&&this.onDoubleTap({pageX:t.pageX,pageY:t.pageY,relX:t.relX,relY:t.relY})}setupTimeout(t,e,i,s){let n=i-this.nowTime;return(!(n<=0)||!!s)&&(this.timeoutObj[t]=setTimeout(e,Math.max(0,n)),!0)}processEvent(t){if("pointerdown"===t.type)this.pointersDownIdArr.push(t.pointerId);else if("pointerup"===t.type){for(let e=0;e<this.pointersDownIdArr.length;e++)if(this.pointersDownIdArr[e]===t.pointerId){this.pointersDownIdArr.splice(e,1);break}}if(!this.allowedPointerTypeArr.includes(t.pointerType))return void this.gestureFailed();this.nowTime=performance.now();let e=this.sequenceArr.length>0?this.sequenceArr[this.sequenceArr.length-1]:null;if("pointerup"===t.type&&(this.lastUpTime=t.time),"pointerdown"===t.type){if(this.pointersDownIdArr.length>1||null!==this.timeoutObj.success||0===this.sequenceArr.length&&this.nowTime-this.lastUpTime<this.minSilenceBeforeDurationMs||t.button&&!this.allowedButtonArr.includes(t.button)||e&&"isDown"in e&&e.isDown||this.sequenceArr.length>2)return void this.gestureFailed();if(e&&"position"in e&&(0,i.dist)(e.position[0],e.position[1],t.pageX,t.pageY)>this.maxInbetweenDistancePx&&(this.gestureFailed(),"time"in e&&this.nowTime-e.time<this.minSilenceBeforeDurationMs))return;if(this.sequenceArr.push({isDown:!0,time:this.nowTime,position:[t.pageX,t.pageY],pointerId:t.pointerId}),this.sequenceArr.length>1)this.timeoutObj.maxUntilSecondDown&&clearTimeout(this.timeoutObj.maxUntilSecondDown);else if(!this.setupTimeout("maxUntilSecondDown",()=>this.gestureFailed(),t.time+this.maxUntilSecondDownDurationMs))return void this.gestureFailed();if(this.timeoutObj.fail&&clearTimeout(this.timeoutObj.fail),!this.setupTimeout("fail",()=>this.gestureFailed(),t.time+this.maxPressedDurationMs))return void this.gestureFailed()}if(e&&"pointermove"===t.type&&"pointerId"in e&&e.pointerId===t.pointerId&&(0,i.dist)(e.position[0],e.position[1],t.pageX,t.pageY)>this.maxPressedDistancePx)return void this.gestureFailed();if(e&&"pointerup"===t.type){if("pointerId"in e&&e.pointerId!==t.pointerId||"time"in e&&this.nowTime>=e.time+this.maxPressedDurationMs)return void this.gestureFailed();if(this.timeoutObj.fail&&clearTimeout(this.timeoutObj.fail),this.sequenceArr.length<3)return this.setupTimeout("fail",()=>this.gestureFailed(),t.time+this.maxUpToUpDurationMs)?void(this.sequenceArr=[e,{isUp:!0,time:this.nowTime,position:[t.pageX,t.pageY]}]):void this.gestureFailed();"time"in this.sequenceArr[1]&&this.nowTime<this.sequenceArr[1].time+this.maxUpToUpDurationMs?(this.sequenceArr.push({pageX:t.pageX,pageY:t.pageY,relX:t.relX,relY:t.relY}),this.setupTimeout("success",()=>this.success(),t.time+this.minSilenceAfterMs,!0)||this.gestureFailed()):this.gestureFailed()}}chainIn(t){return(this.processEvent(t),0===this.sequenceArr.length)?(this.gestureFailed(),t):(this.eventQueueArr.push(t),null)}setChainOut(t){this.chainOut=t}setAllowedPointerTypeArr(t){this.allowedPointerTypeArr=[...t]}setAllowedButtonArr(t){this.allowedButtonArr=[...t]}constructor(t){this.allowedPointerTypeArr=["touch","mouse","pen"],this.allowedButtonArr=["left"],this.minSilenceBeforeDurationMs=400,this.maxPressedDurationMs=300,this.maxPressedDistancePx=10,this.maxInbetweenDistancePx=19,this.maxUpToUpDurationMs=500,this.maxUntilSecondDownDurationMs=300,this.minSilenceAfterMs=250,this.sequenceArr=[],this.pointersDownIdArr=[],this.lastUpTime=0,this.nowTime=0,this.eventQueueArr=[],this.timeoutObj={fail:null,maxUntilSecondDown:null,success:null},this.onDoubleTap=t.onDoubleTap,t.isInstant&&(this.minSilenceBeforeDurationMs=0,this.minSilenceAfterMs=0),this.gestureFailed=()=>{if(0!==this.sequenceArr.length){if(this.timeoutObj.fail&&clearTimeout(this.timeoutObj.fail),this.timeoutObj.maxUntilSecondDown&&clearTimeout(this.timeoutObj.maxUntilSecondDown),this.timeoutObj.success&&clearTimeout(this.timeoutObj.success),this.timeoutObj.fail=null,this.timeoutObj.maxUntilSecondDown=null,this.timeoutObj.success=null,this.chainOut)for(let t=0;t<this.eventQueueArr.length;t++)this.chainOut(this.eventQueueArr[t]);this.eventQueueArr=[],this.sequenceArr=[]}}}}}),parcelRegister("957vH",function(t,e){$parcel$export(t.exports,"OnePointerLimiter",function(){return i});class i{chainIn(t){if(this.ignorePointerIdArr.includes(t.pointerId)){if("pointerup"===t.type){for(let e=0;e<this.ignorePointerIdArr.length;e++)if(this.ignorePointerIdArr[e]===t.pointerId){this.ignorePointerIdArr.splice(e,1);break}}return null}return null===this.downPointerId?("pointerdown"===t.type&&(this.downPointerId=t.pointerId),t):t.pointerId!==this.downPointerId?("pointerdown"===t.type&&this.ignorePointerIdArr.push(t.pointerId),null):("pointerup"===t.type&&(this.downPointerId=null),t)}setChainOut(t){this.chainOut=t}constructor(){this.downPointerId=null,this.ignorePointerIdArr=[]}}}),parcelRegister("VbzD9",function(t,e){$parcel$export(t.exports,"EventChain",function(){return i});class i{continueChain(t,e){for(;t<this.chainArr.length;t++)if(null===(e=this.chainArr[t].chainIn(e)))return null;return this.chainOut&&this.chainOut(e),null}chainIn(t){return this.continueChain(0,t)}setChainOut(t){this.chainOut=t}constructor(t){this.chainArr=t.chainArr;for(let t=0;t<this.chainArr.length;t++)(t=>{this.chainArr[t].setChainOut(e=>{this.continueChain(t+1,e)})})(t)}}}),$parcel$extendImportMap({"6OT74":"de.819e75de.js","2MWxt":"es.0006f75c.js","3NN9W":"fi.514a3c6b.js",i8WN1:"fr.56e8a786.js",MMtuR:"hu.02d096c3.js",j1Skh:"id.b342c94c.js",hUIiR:"ja.fb0d47dc.js","6SS5P":"jv.28558272.js",klZAl:"ko.cb7c2088.js","5xEoy":"lv.05912199.js",fCBVN:"nl.3b1f6891.js","3Cac3":"pt-BR.a9d8541d.js",i3Nr5:"ru.93edf029.js","8ZRjr":"su.21eb3769.js",bAwoY:"sv.9304afc1.js",eiNJp:"zh-CN.69d5a812.js",b1997:"zh-TW.cff3bfc2.js","8gElo":"cancel.340fb0bb.svg",iDK6N:"check.e6114d75.svg",dpNT8:"remove-layer.da17ce5a.svg",kav7s:"brush-pressure.8782e24b.svg","43nfB":"copy.22819386.svg","9Vqzx":"tool-picker.896489f2.svg",vALcr:"angle.319ede69.svg",bReTA:"tool-zoom-in.a322442c.svg",i3X7V:"tool-zoom-out.a0c9b082.svg",fETts:"viewport-reset.f69c6fbc.svg",ksMx1:"tool-hand.b64de96e.svg",hRKJH:"edit-pencil.070f95f1.svg","25BJB":"edit-crop.5a25544f.svg",gShQZ:"add-layer.ec19e714.svg",ldqtT:"duplicate-layer.fd421984.svg",apAfQ:"merge-layers.ec5eab67.svg","5E29d":"rename-layer.a037b591.svg","48B5J":"caret-down.5e676c46.svg",lI82b:"merge-moved.161569b7.png","8BBCz":"cursor-rotate.0c8e34b1.png",g2W7q:"klecks-logo.2d4f704b.png","7SFt9":"new-image.1891be3f.svg","2Vvkk":"import.eacba42d.svg","1zJpX":"export.15a4d72c.svg","9cKp0":"share.ab903904.svg","3iiTs":"help.648f7d00.svg",gGmfI:"tool-paint.1b2f44ed.svg","67aEJ":"tool-fill.bbd4ae51.svg",baTSW:"tool-gradient.dedc893d.svg",a2j2Q:"tool-text.0da9f984.svg",gZhDT:"tool-shape.522cd4b5.svg","2x0SU":"tool-select.5ec1da7d.svg",j4HZO:"tool-undo.9138898d.svg",ea7ga:"edit-rotate.8fb5b1ef.svg",gNPQL:"ui-collapse.da4b78fc.svg","9Mrdl":"align-left.dd4a3407.svg",jc4S8:"align-center.13c1a9ae.svg",cgtA2:"align-right.20a4fe41.svg",erfrN:"typo-italic.010c7282.svg",kdJe6:"typo-bold.e186ac23.svg",ialpb:"Caveat-Regular.2fe80bbd.woff2","4YP0p":"ClimateCrisis-Regular-VariableFont_YEAR.3ad02523.woff2",f9bZe:"CorrectionBrush.a69973aa.woff2",dnR06:"DancingScript-Regular.ef2fe647.woff2",lVw6N:"Diabolik-Regular-VF.f4eeb79e.woff2",a0LKB:"FreckleFace-Regular.05946539.woff2",eDCEO:"Gloock-Regular.60f8f765.woff2","6nihP":"Pacha.08c8457a.woff2","4rqd5":"GochiHand-Regular.c45792b0.woff2",isxTc:"PassionOne-Bold.9e08b0dc.woff2","9lp1S":"PixeloidSans.bc292131.woff2","2yKB9":"PlaypenSans-Thin.314b29a4.woff2",jJcCY:"Quicksand-Light.1f0c44a2.woff2","1JYDa":"Silkscreen-Regular.cef2b4cb.woff2",kVDlu:"Tehroc-Regular.4540047b.woff2",caTXQ:"YUNGA-Display.30c04a15.woff2",gJYYq:"edit-brightness-contrast.78620665.svg",fDGND:"edit-curves.56e09e16.svg","8f0bW":"edit-flip.8010ad0f.svg",fAhTF:"edit-hue-saturation.373aa41d.svg",lTNVM:"edit-invert.91bfa402.png","2mMxs":"edit-perspective.474c436b.svg",lkhcY:"edit-resize.673fffa7.svg",c9hFy:"edit-tilt-shift.7ad164eb.png","297B8":"edit-to-alpha.10878d74.svg",jxtUn:"edit-transform.56e34528.svg",lfC0f:"edit-triangle-blur.17417e43.png",cDstS:"edit-unsharp-mask.38afa514.png",arfqb:"edit-grid.c20f8e5f.svg",jz2is:"edit-noise.20c18f19.svg",aeV12:"edit-pattern.f6d27c58.svg",cFLos:"edit-vanish-point.a8c2dde8.svg",abcn9:"edit-distort.33c9d58d.svg",efRnq:"brush-pen.c04fbc65.svg",lGY8s:"brush-blend.d8ce5270.svg",jDXzO:"brush-sketchy.6c75169d.png",hkoNI:"brush-pixel.bfd351cf.svg",baIZM:"brush-eraser.388bfa8c.svg","91Av5":"brush-smudge.9c9edfb1.svg",aI6cE:"brush-chemy.a5a188f6.svg",k0KEP:"upload.fb4a8f36.svg","28TVy":"loading.7ff8a2ac.gif","4tKUq":"dist.49a152f3.js","8EUal":"bitbof-logo.738252a6.svg",lQWO9:"ui-swap-lr.695f74b3.svg",hn23i:"licenses.7e27b050.js",af9Ft:"font-licenses.857d957c.js","2xc61":"constrain.46a31747.svg",gXLuy:"tab-settings.980aa34c.svg",ll6eH:"tab-layers.e4748a75.svg",elaiI:"tab-edit.0d1e8b85.svg","6rWqS":"cursor-picker.71be1460.png",gy6aj:"cursor-fill.ab749dde.png","9SVhx":"cursor-text.b4ebf6cd.png","5mHop":"cursor-zoom-ew.d3ab2d60.png","6WP3U":"select-mode-select.46ceb4fe.svg",hNYGT:"select-mode-move.321505b0.svg",lU1xy:"select-default.a4d71ff2.svg",d4ONi:"select-union.add41cd9.svg",efKXt:"select-subtract.a2c61ba8.svg",iG2IE:"select-shape-rect.ecb1b83c.svg",heTsK:"select-shape-ellipse.42a3a2f0.svg",bXno8:"select-shape-lasso.3dedd955.svg","4BXSU":"select-shape-poly.25fd4f29.svg"}),!function(){function t(){var t=Array.prototype.slice.call(arguments),e=document.createDocumentFragment();t.forEach(function(t){var i=t instanceof Node;e.appendChild(i?t:document.createTextNode(String(t)))}),this.appendChild(e)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:t})})}(),!function(){function t(){var t=Array.prototype.slice.call(arguments),e=document.createDocumentFragment();t.forEach(function(t){var i=t instanceof Node;e.appendChild(i?t:document.createTextNode(String(t)))}),this.insertBefore(e,this.firstChild)}[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:t})})}(),String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(e||" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var s=arguments[1],n=0;n<i;){var r=e[n];if(t.call(s,r,n,e))return n;n++}return -1}}),"scrollTo"in Element.prototype||Object.defineProperty(Element.prototype,"scrollTo",{value:function(t,e){this.scrollLeft=t,this.scrollTop=e}}),"scrollBy"in Element.prototype||Object.defineProperty(Element.prototype,"scrollBy",{value:function(t,e){this.scrollLeft+=t,this.scrollTop+=e}}),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(...e){let i=isNaN(e[0])?1:Number(e[0]);return i?Array.prototype.reduce.call(this,function(e,s){return Array.isArray(s)?e.push.apply(e,t.call(s,i-1)):e.push(s),e},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(t,e){if("function"!=typeof t)throw TypeError(t+" is not a function");let i=[];for(let s=0;s<this.length;s++)if(s in this){let n=t.call(e,this[s],s,this);Array.isArray(n)?i.push(...n):i.push(n)}return i}}),String.prototype.replaceAll||Object.defineProperty(String.prototype,"replaceAll",{value:function(t,e){if("function"==typeof e)throw Error("replaceAll polyfill does not support replaceValue: function");return this.replace(RegExp(t,"g"),e)}}),"at"in Array.prototype||Object.defineProperty(Array.prototype,"at",{value:function(t){return t>0?this[t]:t<0?this[t+this.length]:void 0}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{value(t){if(!t||!t[Symbol.iterator])throw Error("Object.fromEntries() requires a single iterable argument");let e={};return Object.keys(t).forEach(i=>{let[s,n]=t[i];e[s]=n}),e}}),!("localStorage"in window))try{window.localStorage={getItem:()=>null,setItem:()=>{},removeItem:()=>{}}}catch(e){}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM");class $6b37b427615ca1fa$export$f5386afdb763a67e{emit(){this.listeners.forEach(t=>{t(this.count)})}increase(t){void 0!==t?this.count+=t:this.count++,this.emit()}decrease(t){void 0!==t?this.count-=t:this.count--,this.emit()}get(){return this.count}subscribe(t){this.listeners.push(t)}constructor(){this.listeners=[],this.count=0}}let $6b37b427615ca1fa$export$d3d1650bc39c4419=new $6b37b427615ca1fa$export$f5386afdb763a67e;var $2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$3b474fbd2c41de06$exports={};$3b474fbd2c41de06$exports=JSON.parse('{"switch-ui-left-right":"Switch left/right UI","toggle-show-tools":"Show/Hide Tools","scroll":"Scroll","donate":"Donate","home":"Home","modal-new-tab":"Open in new tab","tab-edit":"Edit","tab-file":"File","tool-brush":"Brush","tool-paint-bucket":"Paint Bucket","tool-gradient":"Gradient","tool-shape":"Shape","tool-text":"Text","tool-hand":"Hand Tool","tool-select":"Select Tool","tool-zoom":"Zoom","tool-more-tools":"More Tools","tool-more-tools-click-again":"Click again for more tools","undo":"Undo","redo":"Redo","brush-pen":"Pen","brush-blend":"Blend","brush-sketchy":"Sketchy","brush-pixel":"Pixel","brush-chemy":"Chemy","brush-smudge":"Smudge","brush-glitter":"Glitter","brush-size":"Size","brush-blending":"Blending","brush-toggle-pressure":"Toggle Pressure Sensitivity","brush-pen-circle":"Circle","brush-pen-chalk":"Chalk","brush-pen-calligraphy":"Calligraphy","brush-pen-square":"Square","brush-sketchy-scale":"Scale","brush-pixel-dither":"Dither","brush-chemy-fill":"Fill","brush-chemy-stroke":"Stroke","brush-chemy-mirror-x":"Horizontal Symmetry","brush-chemy-mirror-y":"Vertical Symmetry","brush-chemy-gradient":"Gradient","brush-eraser-transparent-bg":"Transparent Background","stabilizer":"Stabilizer","stabilizer-title":"Stroke Stabilizer","eyedropper":"Eyedropper","secondary-color":"Secondary Color","manual-color-input":"Manual Color Input","mci-hex":"Hex","mci-copy":"Copy","modal-ok":"Ok","modal-cancel":"Cancel","modal-close":"Close","layers-active-layer":"Active Layer","layers-layer":"Layer","layers-copy":"copy","layers-blending":"Blending","layers-new":"New Layer","layers-remove":"Remove Layer","layers-duplicate":"Duplicate Layer","layers-merge":"Merge with layer below","layers-clear":"Clear layer","layers-merge-advanced":"Advanced merge","layers-merge-all":"Merge all","layers-rename":"Rename","layers-active-layer-visible":"Active layer is visible","layers-active-layer-hidden":"Active layer is hidden","layers-visibility-toggle":"Layer Visibility","layers-blend-normal":"normal","layers-blend-darken":"darken","layers-blend-multiply":"multiply","layers-blend-color-burn":"color burn","layers-blend-lighten":"lighten","layers-blend-screen":"screen","layers-blend-color-dodge":"color dodge","layers-blend-overlay":"overlay","layers-blend-soft-light":"soft light","layers-blend-hard-light":"hard light","layers-blend-difference":"difference","layers-blend-exclusion":"exclusion","layers-blend-hue":"hue","layers-blend-saturation":"saturation","layers-blend-color":"color","layers-blend-luminosity":"luminosity","layers-rename-title":"Rename Layer","layers-rename-name":"Name","layers-rename-clear":"Clear Name","layers-rename-sketch":"Sketch","layers-rename-colors":"Colors","layers-rename-shading":"Shading","layers-rename-lines":"Lines","layers-rename-effects":"Effects","layers-rename-foreground":"Foreground","layers-merge-modal-title":"Merge/Mix Layers","layers-merge-description":"Merges the selected layer with the one underneath. Select the mix mode:","file-no-autosave":"No autosave, no cloud storage","file-new":"New","file-import":"Import","file-save":"Save","file-format":"File Format","file-show-save-dialog":"Show save dialog","file-copy":"Copy","file-copy-title":"Copy To Clipboard","file-paste":"Paste","file-share":"Share","file-storage":"Browser Storage","file-storage-about":"About Browser Storage","file-storage-cant-access":"Can\'t access storage.","file-storage-empty":"Empty","file-storage-store":"Store","file-storage-open":"Open","file-storage-open-confirmation":"This image is already open in another tab. Open it here too?","file-storage-open-failed":"Failed to load.","file-storage-clear":"Clear","file-storage-clear-prompt":"Clear Browser Storage? Clearing can not be undone.","file-storage-storing":"Storing","file-storage-overwrite":"Overwrite","file-storage-overwrite-confirm":"Overwrite Browser Storage? Overwritten data will be permanently deleted.","file-storage-min-ago":"{x}min ago","file-storage-hours-ago":"{x}h ago","file-storage-days-ago":"{x}d ago","file-storage-month-ago":"> 1month ago","file-storage-restored":"Restored from Browser Storage","file-storage-stored":"Stored to Browser Storage","file-storage-failed":"Failed to store to Browser Storage","file-storage-failed-1":"Failed to store. Possible causes:","file-storage-failed-2":"Out of disk space","file-storage-failed-3":"Storage disabled in incognito tab","file-storage-failed-4":"Browser doesn\'t support storage","file-storage-failed-clear":"Failed to clear.","file-upload":"Upload","tab-recovery-recover-tabs":"Recover closed tabs","tab-recovery-explanation":"Recovery data is only kept for a little while. Save to ensure your work is not lost.","tab-recovery-total-quota-label":"Total:","tab-recovery-empty":"Nothing to recover.","tab-recovery-recover":"Recover","tab-recovery-delete":"Delete","tab-recovery-delete-confirmation":"Delete this recovery? Deletion can not be undone.","tab-recovery-failed-to-recover":"Failed to recover tab.","tab-recovery-recovered":"Tab recovered.","cleared-layer":"Cleared layer","cleared-selected-area":"Cleared selected area","filled":"Filled","filled-selected-area":"Filled selection","new-title":"New Image","new-current":"Current","new-fit":"Fit","new-oversize":"Oversize","new-square":"Square","new-landscape":"Landscape","new-portrait":"Portrait","new-screen":"Screen","new-video":"Video","new-din-paper":"DIN Paper","new-px":"px","new-ratio":"Ratio","upload-title":"Upload to Imgur","upload-link-notice":"Anyone with the link to your uploaded image will be able to view it.","upload-name":"Title","upload-title-untitled":"Untitled","upload-caption":"Caption","upload-submit":"Upload","upload-uploading":"Uploading...","upload-success":"Upload Successful","upload-failed":"Upload failed.","upload-delete":"To delete your image from Imgur visit:","cropcopy-title-copy":"Copy To Clipboard","cropcopy-title-crop":"Crop","cropcopy-mask":"Mask unselected","cropcopy-click-hold":"Right-click or press hold to copy.","cropcopy-btn-copy":"To Clipboard","cropcopy-copied":"Copied.","cropcopy-btn-crop":"Apply Crop","crop-drag-to-crop":"Drag to crop","filter-crop-extend":"Crop/Extend","filter-flip":"Flip","filter-perspective":"Perspective","filter-resize":"Resize","filter-rotate":"Rotate","filter-transform":"Transform","filter-bright-contrast":"Bright/Contrast","filter-curves":"Curves","filter-hue-sat":"Hue/Saturation","filter-invert":"Invert","filter-tilt-shift":"Tilt Shift","filter-to-alpha":"To Alpha","filter-triangle-blur":"Triangle Blur","filter-unsharp-mask":"Unsharp Mask","filter-crop-title":"Crop / Extend","filter-crop-description":"Crop or extend the image.","filter-crop-left":"Left","filter-crop-right":"Right","filter-crop-top":"Top","filter-crop-bottom":"Bottom","filter-crop-rule-thirds":"Rule of Thirds","filter-crop-fill":"Fill","filter-flip-title":"Flip","filter-flip-description":"Flips layer or whole image.","filter-flip-horizontal":"Horizontal","filter-flip-vertical":"Vertical","filter-flip-image":"Flip Image","filter-flip-layer":"Flip Layer","filter-perspective-title":"Perspective","filter-perspective-description":"Transforms the selected layer.","filter-resize-title":"Resize","filter-resize-description":"Resizes the image.","filter-rotate-title":"Rotate","filter-rotate-description":"Rotates the image.","filter-transform-empty":"Layer is empty.","filter-transform-empty-selection":"Layer is empty in selected area.","filter-transform-title":"Transform","filter-transform-description":"Transforms selected layer. Hold Shift for additional behavior.","filter-transform-rotation":"Rotation","filter-transform-flip":"Flip","filter-transform-center":"Center","filter-transform-constrain":"Constrain","filter-transform-snap":"Snap","filter-transform-snap-title":"Snap Rotation And Position","filter-bright-contrast-title":"Brightness / Contrast","filter-bright-contrast-description":"Change brightness and contrast for the selected layer.","filter-bright-contrast-brightness":"Brightness","filter-bright-contrast-contrast":"Contrast","filter-curves-title":"Curves","filter-curves-description":"Apply curves on the selected layer.","filter-curves-all":"All","filter-hue-sat-title":"Hue / Saturation","filter-hue-sat-description":"Change hue and saturation for the selected layer.","filter-hue-sat-hue":"Hue","filter-hue-sat-saturation":"Saturation","filter-applied":"applied","filter-tilt-shift-title":"Tilt Shift","filter-tilt-shift-description":"Applies tilt shift on the selected layer.","filter-tilt-shift-blur":"Blur Radius","filter-tilt-shift-gradient":"Gradient Radius","filter-to-alpha-title":"To Alpha","filter-to-alpha-description":"Generates alpha channel for selected layer from:","filter-to-alpha-inverted-lum":"Inverted Luminance","filter-to-alpha-lum":"Luminance","filter-to-alpha-replace":"Replace RGB","filter-triangle-blur-title":"Triangle Blur","filter-triangle-blur-description":"Applies triangle blur on the selected layer.","filter-unsharp-mask-title":"Unsharp Mask","filter-unsharp-mask-description":"Sharpens the selected layer by scaling pixels away from the average of their neighbors.","filter-unsharp-mask-strength":"Strength","filter-grid":"Grid","filter-grid-description":"Draws grid on selected layer.","filter-noise":"Noise","filter-noise-description":"Adds noise to selected layer.","filter-noise-scale":"Scale","filter-noise-alpha":"Alpha","filter-pattern":"Pattern","filter-pattern-description":"Generates pattern on selected layer. Drag the preview for further controls.","filter-distort":"Distort","filter-distort-description":"Distorts the selected layer.","filter-distort-phase":"Phase","filter-distort-stepsize":"Step Size","filter-distort-sync-xy":"Sync XY","filter-vanish-point":"Vanish Point","filter-vanish-point-title":"Vanishing Point","filter-vanish-point-description":"Adds vanishing point to selected layer. Drag preview to move.","filter-vanish-point-lines":"Lines","dropper-drop":"Drop to import","dropper-as-image":"As New Image","dropper-as-layer":"As Layer","import-opening":"Opening file...","import-title":"Import Image","import-too-large":"Image too large, will be downscaled.","import-btn-as-layer":"As Layer","import-btn-as-image":"As Image","import-as-layer-title":"Import Image as New Layer","import-as-layer-description":"Adjust the position of the imported image.","import-as-layer-limit-reached":"Layer limit reached. Image will be placed on existing layer.","import-as-layer-fit":"Fit","import-flatten":"Flatten image","import-unsupported-file":"Unsupported file type. See Help for supported types.","import-broken-file":"Couldn\'t load image. File might be corrupted.","import-psd-unsupported":"Unsupported features. PSD had to be flattened.","import-psd-limited-support":"PSD support is limited. Flattened will more likely look correct.","import-psd-too-large":"Image exceeds maximum dimensions of {x} x {x} pixels. Unable to import.","import-psd-size":"Image size","clipboard-read-fail":"Failed to read from clipboard.","clipboard-no-image":"No image found in clipboard.","hand-reset":"Reset","hand-fit":"Fit","hand-inertia-scrolling":"Inertia Scrolling","bucket-tolerance":"Tolerance","bucket-sample":"Sample","bucket-sample-title":"Which layers to sample color from","bucket-sample-all":"All","bucket-sample-active":"Active","bucket-sample-above":"Above","bucket-grow":"Grow","bucket-grow-title":"Grow filled area (in pixels)","bucket-contiguous":"Contiguous","bucket-contiguous-title":"Only fill connected areas","gradient-linear":"Linear","gradient-linear-mirror":"Linear-Mirror","gradient-radial":"Radial","shape-stroke":"Stroke","shape-fill":"Fill","shape-rect":"Rectangle","shape-ellipse":"Ellipse","shape-line":"Line","shape-line-width":"Line Width","shape-outwards":"Outwards","shape-fixed":"Fixed 1:1","shape-auto-pan":"Auto-pan","shape-auto-pan-title":"Automatically moves as you draw","text-instruction":"Click canvas to place text","text-title":"Add Text","text-text":"Text","text-font":"Font","text-placeholder":"Your text","text-color":"Color","text-size":"Size","text-line-height":"Line Height","text-letter-spacing":"Letter Spacing","text-left":"Left","text-center":"Center","text-right":"Right","text-italic":"Italic","text-bold":"Bold","text-failed-import":"Failed to import the following files:","text-supported-formats":"Supported formats:","select-select":"Select","select-transform":"Transform","select-lasso":"Lasso","select-polygon":"Polygon","select-boolean-replace":"Replace","select-boolean-add":"Add","select-boolean-subtract":"Subtract","select-all":"All","select-invert":"Invert","select-reset":"Reset","select-fill":"Fill","select-erase":"Erase","select-transform-clone":"Clone","select-transform-clone-applied":"Cloned","select-transform-move-to-layer":"Move to layer:","select-transform-applied":"Transformation applied","select-transform-empty":"Selected area on active layer is empty.","save-reminder-title":"Unsaved Work","save-reminder-text":"Image was not saved in {a} minutes{b}. Save now to prevent eventual loss.","save-reminder-save-psd":"Save As PSD","save-reminder-psd-layers":"PSD will remember all layers.","backup-drawing":"You can backup your drawing.","submit":"Submit","submit-title":"Submit Drawing","submit-prompt":"Submit drawing?","submit-submitting":"Submitting","embed-init-loading":"Loading app","embed-init-waiting":"Waiting for image","help":"Help","tab-settings":"Settings","settings-language":"Language","settings-language-reload":"Will update after reloading.","settings-theme":"Theme","settings-save-reminder-label":"Save Reminder","settings-save-reminder-disabled":"disabled","settings-save-reminder-confirm-title":"Turn off Save Reminder?","settings-save-reminder-confirm-a":"There is no autosave and browser tabs don\'t last forever. If you don\'t periodically save you will likely lose work.","settings-save-reminder-confirm-b":"Disable at your own risk?","settings-save-reminder-confirm-disable":"Disable","theme-dark":"Dark","theme-light":"Light","terms-of-service":"Terms of Service","licenses":"Licenses","source-code":"Source Code","auto":"auto","zoom-in":"Zoom In","zoom-out":"Zoom Out","radius":"Radius","constrain-proportions":"Constrain Proportions","width":"Width","height":"Height","opacity":"Opacity","scatter":"Scatter","red":"Red","green":"Green","blue":"Blue","eraser":"Eraser","center":"Center","layers":"Layers","background":"Background","scaling-algorithm":"Scaling Algorithm","algorithm-smooth":"Smooth","algorithm-pixelated":"Pixelated","preview":"Preview","angle-snap":"Snap","angle-snap-title":"45 Angle Snapping","lock-alpha":"Lock Alpha","lock-alpha-title":"Locks layer\'s alpha channel","reverse":"Reverse","compare-before":"Before","compare-after":"After","loading":"Loading","more":"More","x-minutes":"{x}min","wip":"Work in progress","browser-zoom-help":"Double-tap or pinch-out to reset browser zoom.","dismiss":"Dismiss"}');let $970d7af44d8b8038$export$33e6c23ebe2ee669=$parcel$interopDefault($3b474fbd2c41de06$exports),$970d7af44d8b8038$export$d0d68bb9ed2c643d=[{code:"en",name:"English"},{code:"de",name:"Deutsch"},{code:"es",name:"Espaol"},{code:"fi",name:"suomi"},{code:"fr",name:"Franais"},{code:"hu",name:"Magyar"},{code:"id",name:"Bahasa Indonesia"},{code:"ja",name:""},{code:"jv",name:"Basa Jawa"},{code:"ko",name:""},{code:"lv",name:"Latvieu Valoda"},{code:"nl",name:"Nederlands"},{code:"pt-BR",name:"Portugus Brasil"},{code:"ru",name:""},{code:"su",name:"Basa Sunda"},{code:"sv",name:"Svenska"},{code:"zh-CN",name:""},{code:"zh-TW",name:""}],$970d7af44d8b8038$export$f02cbd868e2f57cf=async t=>{if("en"===t)return $970d7af44d8b8038$export$33e6c23ebe2ee669;if("de"===t)return await parcelRequire("j0wU0");if("es"===t)return await parcelRequire("eYAiv");if("fi"===t)return await parcelRequire("FCOGf");if("fr"===t)return await parcelRequire("8QPRU");else if("hu"===t)return await parcelRequire("bh2gX");else if("id"===t)return await parcelRequire("6zMTy");else if("ja"===t)return await parcelRequire("i7mHL");else if("jv"===t)return await parcelRequire("1vdkc");else if("ko"===t)return await parcelRequire("EJ9Pd");else if("lv"===t)return await parcelRequire("VfRNd");else if("nl"===t)return await parcelRequire("7Cmcd");else if("pt-BR"===t)return await parcelRequire("hGaKk");else if("ru"===t)return await parcelRequire("8vyDa");else if("su"===t)return await parcelRequire("aCMGc");else if("sv"===t)return await parcelRequire("9C1up");else if("zh-CN"===t)return await parcelRequire("gXjy0");else if("zh-TW"===t)return await parcelRequire("5wCMx");throw Error("unknown language code")};var $dGRuJ=parcelRequire("dGRuJ");let $63d0b335c576c718$export$991796128b2ca217="klecks-language";class $63d0b335c576c718$var$LanguageStrings{async setLanguage(t){"en"===t?this.data=(0,$wpIFA._)({},$970d7af44d8b8038$export$33e6c23ebe2ee669):this.data=(0,$wpIFA._)({},$970d7af44d8b8038$export$33e6c23ebe2ee669,await $970d7af44d8b8038$export$f02cbd868e2f57cf(t)),this.code=t,document.documentElement.setAttribute("lang",t),this.listeners.forEach(t=>{t()})}get(t){if(!(t in this.data))throw Error("translation code doesn't exist: "+t);return this.data[t]}getLanguage(){return $970d7af44d8b8038$export$d0d68bb9ed2c643d.find(t=>t.code===this.code)}getAutoLanguage(){let t=$63d0b335c576c718$export$64783e31db14f0ba(!1);return $970d7af44d8b8038$export$d0d68bb9ed2c643d.find(e=>e.code===t)}getCode(){return this.code}subscribe(t){this.listeners.includes(t)||this.listeners.push(t)}unsubscribe(t){for(let e=0;e<this.listeners.length;e++)if(t===this.listeners[e])return void this.listeners.splice(e,1)}constructor(){this.listeners=[],this.data=(0,$wpIFA._)({},$970d7af44d8b8038$export$33e6c23ebe2ee669),this.code="en"}}function $63d0b335c576c718$export$64783e31db14f0ba(t){let e="en",i=[];if((navigator.languages?navigator.languages:[navigator.language]).forEach(t=>{let e=t.split("-");i.push(t),2===e.length&&i.push(e[0])}),t)try{let t=$dGRuJ.LocalStorage.getItem($63d0b335c576c718$export$991796128b2ca217);t&&i.unshift(t)}catch(t){}for(let t=0;t<i.length;t++){let s=i[t],n=$970d7af44d8b8038$export$d0d68bb9ed2c643d.find(t=>t.code.toLowerCase()===s.toLowerCase());if(n){e=n.code;break}}return e}let $63d0b335c576c718$var$activeLanguageCode=$63d0b335c576c718$export$64783e31db14f0ba(!0),$63d0b335c576c718$export$e4ce066d17694649=new $63d0b335c576c718$var$LanguageStrings,$63d0b335c576c718$export$ce37e184d908d785=(t,e)=>{if(!e)return $63d0b335c576c718$export$e4ce066d17694649.get(t);{let i=$63d0b335c576c718$export$e4ce066d17694649.get(t);return Object.keys(e).forEach(t=>{i=i.replace(`{${t}}`,e[t])}),i}},$63d0b335c576c718$export$7a2ea9f2e4d199d3=()=>$63d0b335c576c718$export$e4ce066d17694649.setLanguage($63d0b335c576c718$var$activeLanguageCode);window.onscroll=t=>{t.preventDefault()};var $f6d60f0cc8cfa5ae$exports={};$f6d60f0cc8cfa5ae$exports=$parcel$resolve("8gElo");var $0c1a638761209cc7$exports={};$0c1a638761209cc7$exports=$parcel$resolve("iDK6N");var $03e87c70019af696$exports={};function $2016c314bff36ab9$export$d7e8d4d4450c819c(t){let e,i,s;$6b37b427615ca1fa$export$d3d1650bc39c4419.increase();let n=!1,r=!!t.ignoreBackground,a=$2Eggz.BB.el({parent:document.body,css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",overflow:"hidden"}}),o=$2Eggz.BB.el({parent:a,className:"kl-popup"}),l=$2Eggz.BB.el({parent:o,css:{width:"100%",minHeight:"100%",position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}),h=$2Eggz.BB.el({parent:l,onClick:()=>{r||v("Cancel")},css:{position:"absolute",left:"0",top:"0",zIndex:"0",width:"100%",height:"100%"}}),c=40,d=$2Eggz.BB.el({tagName:"button",className:"popup-x",content:`<img alt="${$63d0b335c576c718$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($f6d60f0cc8cfa5ae$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("modal-close"),onClick:()=>{v("Cancel")},css:{width:c+"px",height:c+"px",lineHeight:c+"px",position:"absolute",right:"0",top:"0",background:"none",boxShadow:"none"}});t.type&&(s=$2Eggz.BB.el({className:{error:"kl-popup__icon-error",ok:"kl-popup__icon-ok",warning:"kl-popup__icon-warning",upload:"kl-popup__icon-upload"}[t.type]}));let p=["kl-popup-box"];p.push("kl-popup-box--sm");let u=$2Eggz.BB.el({content:[d,s,$2Eggz.BB.el({content:t.message,css:{marginRight:"15px",marginBottom:t.div?"10px":void 0}}),t.div],className:p.join(" "),css:t.style?t.style:void 0});l.append($2Eggz.BB.el({css:{flex:"0.5"}}),u,$2Eggz.BB.el({css:{flex:"1"}}));let g=new $2Eggz.BB.KeyListener({onDown:function(t,e,s){n||(i&&"enter"===s&&!$2Eggz.BB.isInputFocused()&&(e.stopPropagation(),setTimeout(()=>{i&&i.click()},10)),"esc"===s&&(e.stopPropagation(),e.preventDefault(),v("Cancel")))}}),m=t=>{g.isPressed("ctrl")&&t.preventDefault()};o.addEventListener("wheel",m,{passive:!1}),o.onclick=$2Eggz.BB.handleClick,e=t.autoFocus?t.autoFocus:!1===t.autoFocus?void 0:"Ok";let f=t.buttons&&t.buttons.length>0?$2Eggz.BB.el({parent:u,css:{display:"flex",flexWrap:"wrap",justifyContent:"flex-end",marginTop:"12px",marginLeft:"-8px"}}):void 0,y=[];function v(e){!n&&(n=!0,$2Eggz.BB.clearSelection(),$2Eggz.BB.unfocusAnyInput(),a.remove(),$6b37b427615ca1fa$export$d3d1650bc39c4419.decrease(),$2Eggz.BB.destroyEl(d),$2Eggz.BB.destroyEl(h),g.destroy(),o.removeEventListener("wheel",m),o.onclick=null,y.forEach(t=>$2Eggz.BB.destroyEl(t)),y.splice(0,y.length),t.callback&&t.callback(e))}return t.buttons&&t.buttons.forEach(s=>{let n,r,a=["kl-popup__btn"];("Ok"===s||t.primaries&&t.primaries.includes(s))&&a.push("kl-button-primary"),s===t.deleteButtonName&&a.push("kl-button-delete");let l=s;"Ok"===s&&(l=$63d0b335c576c718$export$ce37e184d908d785("modal-ok"),n=$parcel$interopDefault($0c1a638761209cc7$exports)),"Cancel"===s&&(l=$63d0b335c576c718$export$ce37e184d908d785("modal-cancel"),n=$parcel$interopDefault($f6d60f0cc8cfa5ae$exports),a.push("kl-button-cancel")),s===t.deleteButtonName&&(n=$parcel$interopDefault($03e87c70019af696$exports)),n&&(r=$2Eggz.BB.el({tagName:"img",custom:{src:n,height:"17"}}));let h=$2Eggz.BB.el({parent:f,tagName:"button",className:a.join(" "),content:[r,$2Eggz.BB.el({className:"kl-popup__btn__text",content:l})],onClick:()=>{v(s)}});y.push(h),e===s&&(setTimeout(()=>{h.focus(),o.scrollTo(0,0)},10),setTimeout(()=>{o.scrollTo(0,0)},20)),s===t.clickOnEnter&&(i=h)}),t.closeFunc&&t.closeFunc(function(){v("Cancel")}),{setIgnoreBackground:t=>{r=t}}}$03e87c70019af696$exports=$parcel$resolve("dpNT8");var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $18361e3f5d6257e8$export$185108a9b725b68{close(){$6b37b427615ca1fa$export$d3d1650bc39c4419.decrease(),$2Eggz.BB.destroyEl(this.rootEl),this.rootEl.remove(),window.removeEventListener("resize",this.updatePos),this.keyListener.destroy(),$2Eggz.BB.destroyEl(this.xButton),$2Eggz.BB.destroyEl(this.bgEl),this.onClose&&this.onClose()}constructor(t){$6b37b427615ca1fa$export$d3d1650bc39c4419.increase(),this.onClose=t.onClose,this.parent=document.body,this.rootEl=$2Eggz.BB.el({parent:this.parent,className:"g-root kl-d-modal-root",css:{position:"fixed",left:"0",top:"0",bottom:"0",right:"0",overflow:"auto",animationName:"consoleIn",animationDuration:"0.3s",animationTimingFunction:"ease-out"},onClick:$2Eggz.BB.handleClick}),this.bgEl=$2Eggz.BB.el({parent:this.rootEl,css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"},onClick:()=>this.close()});let e=$2Eggz.BB.el({parent:this.rootEl,className:"kl-d-modal",css:{position:"absolute",width:$2Eggz.BB.isCssMinMaxSupported()?"min(calc(100% - 40px), "+(t.width?t.width:400)+"px)":(t.width?t.width:400)+"px",height:"calc(100% - 40px)",borderRadius:"10px",overflow:"hidden"}});this.updatePos=()=>{let t=e.offsetWidth,i=e.offsetHeight;(0,$VM6dD.css)(e,{left:Math.max(0,(window.innerWidth-t)/2)+"px",top:Math.max(20,(window.innerHeight-i)/2-.2*i)+"px"})},this.updatePos(),window.addEventListener("resize",this.updatePos);let i=40,s=$2Eggz.BB.el({parent:e,css:{height:i+"px",display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:i/2+"px"}});t.title&&s.append(t.title),this.xButton=$2Eggz.BB.el({parent:s,tagName:"button",className:"popup-x",content:`<img alt="${$63d0b335c576c718$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($f6d60f0cc8cfa5ae$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("modal-close"),onClick:()=>this.close(),css:{width:i+"px",height:i+"px",lineHeight:i+"px",background:"none",boxShadow:"none"},custom:{tabindex:"0"}});let n=$2Eggz.BB.el({parent:e,css:{height:"calc(100% - "+i+"px)"}});t.content&&n.append(t.content),this.keyListener=new $2Eggz.BB.KeyListener({onDown:(t,e)=>{"esc"===t&&(e.stopPropagation(),e.preventDefault(),this.close())}})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $213947897b67ec3a$export$48513f6b9f8ce62d{getValue(){return this.check.checked}setValue(t){this.check.checked=t,this.doHighlight&&this.rootEl.classList.toggle("kl-checkbox--highlight",this.check.checked)}getElement(){return this.rootEl}destroy(){this.check.onchange=null}constructor(t){this.doHighlight=!!t.doHighlight,this.rootEl=$2Eggz.BB.el({className:"kl-checkbox"});let e=$2Eggz.BB.el({parent:this.rootEl,tagName:"label",className:"kl-checkbox__inner",css:{display:"flex"}});this.check=$2Eggz.BB.el({parent:e,tagName:"input",css:{margin:"0 5px 0 0"},custom:{type:"checkbox",name:t.name}}),this.check.checked=!!t.init,this.doHighlight&&this.check.checked&&this.rootEl.classList.add("kl-checkbox--highlight"),t.allowTab||(this.check.tabIndex=-1),t.title&&(e.title=t.title),$2Eggz.BB.el({parent:e,content:t.label,css:{}}),this.check.onchange=()=>{this.doHighlight&&this.rootEl.classList.toggle("kl-checkbox--highlight",this.check.checked),t.callback&&t.callback(this.check.checked),setTimeout(()=>{this.check.blur()},0)},t.css&&(0,$VM6dD.css)(this.rootEl,t.css)}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $760dd90d44275661$export$f5b8910cec6cf069{getElement(){return this.rootEl}getValue(){return this.input.value}setValue(t){this.input.value=""+t}destroy(){this.pointerListener&&this.pointerListener.destroy(),this.keyListener.destroy()}constructor(t){var e,i;this.keyListener={destroy:()=>{}},this.rootEl=$2Eggz.BB.el({tagName:"label",content:t.label,css:{display:"flex",alignItems:"center",gap:"5px"}}),this.input=$2Eggz.BB.el({tagName:"input",parent:this.rootEl,title:t.title,custom:{name:t.name}}),this.type=null!=(e=t.type)?e:"text";try{this.input.type=this.type}catch(t){}let s=null!=(i=t.step)?i:1;"number"===this.type&&(void 0!==t.min&&(this.input.min=""+t.min),void 0!==t.max&&(this.input.max=""+t.max),void 0!==t.step&&(this.input.step=""+s)),this.input.value=""+t.init;let n=this.input.value,r=()=>{let e=n,i=this.input.value;if(t.doResetIfInvalid){let e=!1;""===i&&(i=n,e=!0),void 0!==t.min&&parseFloat(i)<t.min&&(i=""+t.min,e=!0),void 0!==t.max&&parseFloat(i)>t.max&&(i=""+t.max,e=!0),e&&(this.input.value=""+i)}return n=i,e!==i};if(t.onChange){let e=t.onChange;this.input.onchange=()=>{r()&&e(this.input.value)}}if(t.css&&(0,$VM6dD.css)(this.input,t.css),t.doScrollWithoutFocus&&"number"===t.type&&t.onChange){let e=t.onChange;this.keyListener=new $2Eggz.BB.KeyListener({}),this.pointerListener=new $2Eggz.BB.PointerListener({target:this.input,onWheel:t=>{let i=this.keyListener.isPressed("shift")?4:1;this.input.value=""+(parseFloat(this.input.value)-t.deltaY*s*i),r()&&e(this.input.value)}})}}}let $760dd90d44275661$export$b7e3ae3d7c15e42e=function(t){let e=document.createElement("input");if(t.type)try{e.type=t.type}catch(t){}else e.type="text";return void 0!==t.min&&(e.min=""+t.min),void 0!==t.max&&(e.max=""+t.max),e.value=""+t.init,t.callback&&(e.onchange=function(){t.callback(e.value)}),t.css&&(0,$VM6dD.css)(e,t.css),e};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $b1ef42bd443626ca$export$ef9b1a59e592288f{setValue(t){this.selectEl.value=void 0===t?"":t}getValue(){return this.selectEl.value}setDeltaValue(t){let e=0;for(let t=0;t<this.optionArr.length;t++){let i=this.optionArr[t];if(i.item&&""+i.item[0]===this.selectEl.value){e=t;break}}e=Math.max(0,Math.min(this.optionArr.length-1,e+t));let i=this.optionArr[e];this.selectEl.value=i.item?i.item[0]:"",this.onChange&&this.onChange(this.getValue())}getElement(){return this.selectEl}updateLabel(t,e){this.optionArr.forEach(i=>{i.item&&i.item[0]===t&&i.el&&(i.item[1]=e,i.el.textContent=i.item[1])})}setOptionArr(t){let e=this.selectEl.value;this.optionArr=[],this.selectEl.innerHTML="";for(let e=0;e<t.length;e++){let i=t[e];if(!i){this.optionArr.push({item:i});continue}let s=document.createElement("option");s.value=i[0],s.textContent=i[1],i[2]&&(0,$VM6dD.css)(s,i[2].css),this.optionArr.push({item:i,el:s}),this.selectEl.append(s)}(""===e||t.findIndex(t=>t&&t[0]===e)>-1)&&this.setValue(e)}destroy(){this.selectEl.removeEventListener("change",this.changeListener)}constructor(t){this.optionArr=[],this.selectEl=$2Eggz.BB.el({tagName:"select",title:t.title,className:"kl-select",css:{cursor:"pointer",fontSize:"15px",padding:"3px"},custom:{name:t.name}}),t.css&&(0,$VM6dD.css)(this.selectEl,t.css);let e=t.isFocusable;e||(this.selectEl.tabIndex=-1),this.setOptionArr(t.optionArr),t.onChange&&(this.onChange=t.onChange),this.changeListener=()=>{e||this.selectEl.blur(),this.onChange&&this.onChange(this.getValue())},this.selectEl.addEventListener("change",this.changeListener),this.selectEl.value=void 0!==t.initValue?t.initValue:""}}var $2Eggz=parcelRequire("2Eggz");class $a14a8e8cf8cc5885$export$b6d053cded550773{update(){this.rootEl.classList.toggle("image-toggle-active",this.isActive)}setValue(t){this.isActive=t,this.update()}getElement(){return this.rootEl}getValue(){return this.isActive}destroy(){$2Eggz.BB.destroyEl(this.rootEl)}constructor(t){this.isActive=t.initValue,this.rootEl=$2Eggz.BB.el({className:"image-toggle",title:t.title,content:$2Eggz.BB.el({className:"image-toggle__im"+(t.darkInvert?" dark-invert":""),css:{backgroundImage:"url('"+t.image+"')"}}),onClick:e=>{e.preventDefault(),t.isRadio&&this.isActive||(this.isActive=!this.isActive,this.update(),t.onChange(this.isActive))}}),this.update()}}var $2Eggz=parcelRequire("2Eggz");class $fa6faa989b2cc6b2$export$7cc1012a658e6ad8{getElement(){return this.rootEl}getValue(){return this.optionArr[this.activeIndex].id}destroy(){this.optionArr.forEach(t=>{t.radioEl.destroy()})}constructor(t){let e;this.rootEl=$2Eggz.BB.el({className:"image-radio-wrapper",css:{display:"flex"}}),this.optionArr=[];let i=(e,i)=>{this.activeIndex=e;for(let t=0;t<this.optionArr.length;t++)this.optionArr[t].radioEl.setValue(t===this.activeIndex);t.onChange(i)},s=(s,n)=>{n.id===t.initId&&(e=s);let r=new $a14a8e8cf8cc5885$export$b6d053cded550773({image:n.image,title:n.title,initValue:n.id===t.initId,isRadio:!0,onChange:()=>{i(s,n.id)},darkInvert:n.darkInvert});return this.rootEl.append(r.getElement()),{id:n.id,radioEl:r}};for(let e=0;e<t.optionArr.length;e++)this.optionArr.push(s(e,t.optionArr[e]));if(void 0===e)throw Error("initId not in optionArr");this.activeIndex=e}}var $2Eggz=parcelRequire("2Eggz"),$28ed12ab6bd16517$exports={};$28ed12ab6bd16517$exports=$parcel$resolve("kav7s");var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $8d99bd5fadaac7f9$export$2358c75ad3c15b2d{update(){this.el.classList.toggle("kl-box-toggle--active",this.value)}getValue(){return this.value}setValue(t){this.value=t,this.update()}getElement(){return this.el}destroy(){$2Eggz.BB.destroyEl(this.el)}constructor(t){this.value=!!t.init,this.el=$2Eggz.BB.el({content:t.label,title:t.title,className:"string"==typeof t.label?"kl-box-toggle":"kl-box-toggle kl-box-toggle--custom-el",onClick:()=>{this.value=!this.value,this.update(),t.onChange(this.value)},css:{cursor:"pointer"}}),"string"!=typeof t.label&&(0,$VM6dD.css)(t.label,{display:"block",pointerEvents:"none"}),this.update()}}let $218f70778c2bf652$export$9da2e8821e6cbb57=function(t,e){return new $8d99bd5fadaac7f9$export$2358c75ad3c15b2d({label:$2Eggz.BB.el({className:"dark-invert",css:{width:"17px",height:"17px",backgroundImage:'url("'+$parcel$interopDefault($28ed12ab6bd16517$exports)+'")',backgroundSize:"contain",backgroundRepeat:"no-repeat",margin:"1px",borderRadius:"3px"}}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-toggle-pressure"),init:t,onChange:t=>{e(t)}}).getElement()};var $2Eggz=parcelRequire("2Eggz");function $6e485eb0c82960d0$export$f8e41e222e32615d(t,e){let i=Math.min(10,1+Math.pow(Math.floor(t/50),2));return e&&(i*=2),1/i}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $31b6ab403d8e5713$export$db3d4fde05db9a5e{emit(){this.lastValue!==Number(this.input.value)&&(this.onChange(Number(this.input.value)),this.lastValue=Number(this.input.value))}privateOnClose(){this.isClosed||(this.isClosed=!0,this.emit(),this.onClose(),setTimeout(()=>{this.scrollBefore&&window.scrollTo(this.scrollBefore.x,this.scrollBefore.y),this.scrollBefore=void 0}))}getElement(){return this.input}setIsEnabled(t){this.isEnabled=t}focus(){this.input.focus(),this.input.select()}destroy(){$2Eggz.BB.destroyEl(this.input)}constructor(t,e,i,s,n,r,a){let o;this.onChange=n,this.onClose=r,this.isEnabled=!0,this.isClosed=!1,this.input=$760dd90d44275661$export$b7e3ae3d7c15e42e({type:"number",init:t,min:e,max:i,callback:t=>{this.emit()}}),0!==a&&this.input.setAttribute("step","any"),this.input.onblur=()=>{this.privateOnClose()},this.input.addEventListener("keyup",t=>{["Enter","Escape"].includes(t.key)?this.privateOnClose():this.emit()},{passive:!1}),this.input.addEventListener("wheel",()=>this.emit(),{passive:!1}),this.scrollBefore={x:window.scrollX,y:window.scrollY},o=a||0===a?$2Eggz.BB.round(t,a):t,this.lastValue=o,this.input.value=""+o,(0,$VM6dD.css)(this.input,{width:s.width+"px",height:s.height+"px"})}}var $VM6dD=parcelRequire("VM6dD");class $cd73d123a4560ac3$export$a1855b925e534de7{valueToSliderValue(t){return this.useSpline&&this.splineInterpolator?this.splineInterpolator.findX(t,Math.floor(this.resolution))||0:(t-this.min)/(this.max-this.min)}sliderValueToValue(t){let e=this.min+t*(this.max-this.min);return this.useSpline&&this.splineInterpolator&&(e=this.splineInterpolator.interpolate(t)||0),e}updateLabel(){let t=this.valueToDisplayValue(this.value);t=(t=this.formatFunc?this.formatFunc(t):Math.round(t)).toLocaleString($63d0b335c576c718$export$e4ce066d17694649.getCode());let e=void 0!==this.unit?this.unit:"";this.labelValueEl.textContent=t+e;let i=this.valueToSliderValue(this.value);this.control.style.width=i*this.elementWidth+"px"}emit(t){if(t||!this.isChangeOnFinal){if(t||!this.eventResMs){this.onChange(this.value),this.emitInterval&&(clearInterval(this.emitInterval),this.emitInterval=void 0);return}this.emitInterval?this.emitValue=this.value:(this.onChange(this.value),this.emitInterval=setInterval(()=>{void 0===this.emitValue?(clearInterval(this.emitInterval),this.emitInterval=void 0):(this.onChange(this.emitValue),this.emitValue=void 0)},this.eventResMs))}}updateEnable(){this.sliderWrapperEl.classList.toggle("slider-wrapper--disabled",!this.isEnabled),(0,$VM6dD.css)(this.sliderWrapperEl,{opacity:this.isEnabled?"":"0.5",pointerEvents:this.isEnabled?"":"none"}),this.manualInput&&this.manualInput.setIsEnabled(this.isEnabled)}showManualInput(){this.manualInput=new $31b6ab403d8e5713$export$db3d4fde05db9a5e(this.valueToDisplayValue(this.value),this.valueToDisplayValue(this.min),this.valueToDisplayValue(this.max),this.sliderWrapperEl.getBoundingClientRect(),t=>{t=this.displayValueToValue(t),this.setValue($2Eggz.BB.clamp(t,this.min,this.max)),this.onChange(this.value)},()=>{(0,$VM6dD.css)(this.sliderWrapperEl,{display:""}),this.manualInput&&(this.manualInput.getElement().remove(),this.manualInput.destroy()),this.manualInput=void 0},this.manualInputRoundDigits&&this.manualInputRoundDigits>0?this.manualInputRoundDigits:0),this.manualInput.setIsEnabled(this.isEnabled),this.rootEl.append(this.manualInput.getElement()),setTimeout(()=>{this.manualInput&&this.manualInput.focus()}),(0,$VM6dD.css)(this.sliderWrapperEl,{display:"none"})}changeSliderValue(t){if(!this.isEnabled)return;let e=this.valueToSliderValue(this.value);e=$2Eggz.BB.clamp(e+t,0,1),this.value=this.sliderValueToValue(e),this.updateLabel(),this.onChange(this.value)}setValue(t){this.value=$2Eggz.BB.clamp(t,this.min,this.max),this.updateLabel()}getValue(){return this.value}getDisplayValue(){return this.valueToDisplayValue(this.value)}update(t){if(this.min=t.min,this.max=t.max,this.useSpline=!!t.curve,this.useSpline){if(!t.curve)throw Error("curve needs to be set if useSpline true");let e="quadratic"===t.curve?$2Eggz.BB.powerSplineInput(this.min,this.max,.1):t.curve;this.splineInterpolator=new $2Eggz.BB.SplineInterpolator(e)}else this.splineInterpolator=void 0;this.setIsEnabled(!t.isDisabled)}setIsEnabled(t){this.isEnabled=t,this.updateEnable()}getElement(){return this.rootEl}destroy(){clearTimeout(this.pointerListenerTimeout),this.pointerListener&&this.pointerListener.destroy(),this.manualInput&&this.manualInput.destroy(),this.emitInterval&&clearInterval(this.emitInterval)}constructor(t){let e;if(this.isEnabled=!1!==t.isEnabled,this.manualInputRoundDigits=t.manualInputRoundDigits,this.useSpline=!!t.curve,!t.label)throw Error("KlSlider missing params");if(0!=t.min&&0!=t.max&&0!=t.value&&(!t.min||!t.max||!t.value)||t.min>=t.max)throw Error("KlSlider broken params");if(this.min=t.min,this.max=t.max,this.value=$2Eggz.BB.clamp(t.value,this.min,this.max),this.elementWidth=t.width,this.elementHeight=t.height,this.resolution=t.resolution?t.resolution:2*this.elementWidth,this.onChange=t.onChange?t.onChange:()=>{},!t.toValue!=!t.toDisplayValue)throw Error("both or neither have to be set, toValue and toDisplayValue");if(this.displayValueToValue=t.toValue?t.toValue:t=>t,this.valueToDisplayValue=t.toDisplayValue?t.toDisplayValue:t=>t,this.isChangeOnFinal=!!t.isChangeOnFinal,this.formatFunc=t.formatFunc,this.eventResMs=t.eventResMs,this.unit=t.unit,this.useSpline){if(!t.curve)throw Error("curve needs to be set if useSpline true");let e="quadratic"===t.curve?$2Eggz.BB.powerSplineInput(this.min,this.max,.1):t.curve;this.splineInterpolator=new $2Eggz.BB.SplineInterpolator(e)}this.rootEl=$2Eggz.BB.el({css:{display:"flex"}}),this.sliderWrapperEl=$2Eggz.BB.el({parent:this.rootEl,className:"slider-wrapper",css:{overflow:"hidden",position:"relative",width:this.elementWidth+"px",height:this.elementHeight+"px",userSelect:"none"}}),this.rootEl.oncontextmenu=function(){return!1},this.label=t.label;let i=this.elementHeight-14;this.labelValueEl=$2Eggz.BB.el({css:{fontWeight:"bold"}}),this.textEl=$2Eggz.BB.el({content:[$2Eggz.BB.el({content:this.label,css:{overflow:"hidden",textOverflow:"ellipsis"}}),this.labelValueEl],css:{position:"absolute",display:"flex",alignItems:"center",padding:"0 7px",height:"100%",width:"100%",fontSize:i+"px",pointerEvents:"none",gap:"8px"}}),this.control=$2Eggz.BB.el({className:"slider-inner",css:{position:"absolute",left:"0",top:"0",width:this.valueToSliderValue(this.value)*this.elementWidth+"px",height:this.elementHeight+"px"}});let s=document.createElement("div");this.sliderWrapperEl.append(this.control,this.textEl),this.control.append(s),this.updateEnable();let n=new $2Eggz.BB.DoubleTapper({onDoubleTap:()=>{this.showManualInput()}});n.setAllowedButtonArr(["left","right"]);let r=new $2Eggz.BB.EventChain({chainArr:[n]}),a=t=>{if(t.eventPreventDefault(),this.isEnabled){if("pointerdown"===t.type){if($2Eggz.BB.unfocusAnyInput(),this.sliderWrapperEl.className="slider-wrapper slider-wrapper--active","left"===t.button){let e=t.relX/this.elementWidth;e=Math.max(0,Math.min(1,e)),this.value=this.sliderValueToValue(e),this.updateLabel(),this.emit(!1)}e=this.valueToSliderValue(this.value)}if("pointermove"===t.type&&["left","right"].includes(t.button||"")){let i=t.dX;i*=$6e485eb0c82960d0$export$f8e41e222e32615d(Math.abs(t.pageY-(t.downPageY||0)),"right"===t.button),i/=this.elementWidth;let s=Math.max(0,Math.min(1,e+=i));this.value=this.sliderValueToValue(s),this.updateLabel(),this.emit(!1)}"pointerup"===t.type&&(this.sliderWrapperEl.className="slider-wrapper",this.emit(!0))}};this.pointerListenerTimeout=setTimeout(()=>{this.pointerListener=new $2Eggz.BB.PointerListener({target:this.sliderWrapperEl,fixScribble:!0,onPointer:t=>{a(t),r.chainIn(t)},onWheel:t=>{let e=this.valueToSliderValue(this.value);e=$2Eggz.BB.clamp(e-t.deltaY/40,0,1),this.value=this.sliderValueToValue(e),this.updateLabel(),this.onChange(this.value)}}),this.updateLabel()},1)}}var $2Eggz=parcelRequire("2Eggz"),$895204cb2449c455$exports={};$895204cb2449c455$exports=$parcel$resolve("43nfB");var $jmKbV=parcelRequire("jmKbV"),$VM6dD=parcelRequire("VM6dD");function $934e5f47c3374e21$var$decomposeElString(t){let e,i;if(""===t)return{};let s=[];1===(e=t.split(".")).length?i=(e=e[0].split(",")).shift():(i=e.shift(),e.forEach((t,i)=>{if(i===e.length-1){let i=(e=t.split(",")).shift();void 0!==i&&s.push(i)}else s.push(t)}));let n={};return""!==i&&(n.tagName=i),s.length>0&&(n.classes=s),e.length>0&&(n.styles=e),n}function $934e5f47c3374e21$var$applyStyleNames(t,e){let i={},s={c:t=>{i.color=t[0]},bg:t=>{i.background=t[0]},p:t=>{i.padding=t[0]+"px"},py:t=>{i.paddingTop=t[0]+"px",i.paddingBottom=t[0]+"px"},pt:t=>{i.paddingTop=t[0]+"px"},pr:t=>{i.paddingRight=t[0]+"px"},pb:t=>{i.paddingBottom=t[0]+"px"},pl:t=>{i.paddingLeft=t[0]+"px"},mt:t=>{i.marginTop=t[0]+"px"},mr:t=>{i.marginRight=t[0]+"px"},mb:t=>{i.marginBottom=t[0]+"px"},ml:t=>{i.marginLeft=t[0]+"px"},flex:()=>{i.display="flex"},flexCol:()=>{i.flexDirection="column"},flexWrap:()=>{i.flexWrap="wrap"},gap:t=>{i.gap=t.map(t=>t+"px").join(" ")},grow:()=>{i.flexGrow="1"},justify:t=>{i.justifyContent=t[0]},items:t=>{i.alignItems=t[0]},hidden:()=>{i.display="none"},nowrap:()=>{i.whiteSpace="nowrap"},abs:t=>{i.position="absolute",i.left=t[0]+"px",i.top=t[1]+"px"},w:t=>{i.width="full"===t[0]?"100%":t[0]+"px"},h:t=>{i.height="full"===t[0]?"100%":t[0]+"px"},minh:t=>{i.minHeight=t[0]+"px"},z:t=>{i.zIndex=t[0]},overflow:t=>{i.overflow=t[0]},pos:t=>{i.position=t[0]},left:t=>{i.left="full"===t[0]?"100%":t[0]+"px"},top:t=>{i.top="full"===t[0]?"100%":t[0]+"px"},right:t=>{i.right="full"===t[0]?"100%":t[0]+"px"},bottom:t=>{i.bottom="full"===t[0]?"100%":t[0]+"px"},size:t=>{i.fontSize=t[0]+"px"},pointer:t=>{i.pointerEvents=t[0]}};e.forEach(t=>{let e=t.split("-");s[e.shift()](e)}),(0,$VM6dD.css)(t,i)}function $934e5f47c3374e21$export$db3b6bfb95261072(t,e){var i;if(void 0===t)return document.createElement("div");if("string"!=typeof t)return t instanceof HTMLElement||(t=(0,$jmKbV.el)(t)),e&&("string"==typeof e?t.innerHTML=e:t.append(...e)),t;let s=$934e5f47c3374e21$var$decomposeElString(t),n=document.createElement(null!=(i=s.tagName)?i:"div");return s.classes&&n.classList.add(...s.classes),s.styles&&$934e5f47c3374e21$var$applyStyleNames(n,s.styles),e&&("string"==typeof e?n.innerHTML=e:n.append(...e)),n}$cf02414f4b0b48a4$export$9852986a3ec5f6a0="_7-bVqq_table";class $49ce344532144fcf$export$cc42e119007cb939{constructor(t){let e=new $2Eggz.BB.RGB(t.color.r,t.color.g,t.color.b),i=$2Eggz.BB.el({css:{width:"20px",height:"20px",marginBottom:"10px",boxShadow:"inset 0 0 0 1px #fff, 0 0 0 1px #000",background:"#"+$2Eggz.BB.ColorConverter.toHexString(e)}}),s=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("mci-hex")}),n=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:"#"+$2Eggz.BB.ColorConverter.toHexString(e),css:{width:"80px"},callback:function(){let t=$2Eggz.BB.ColorConverter.hexToRGB(n.value);t?e=t:(t=e,n.value="#"+$2Eggz.BB.ColorConverter.toHexString(e)),i.style.background="#"+$2Eggz.BB.ColorConverter.toHexString(t);for(let t=0;t<l.length;t++)l[t].update()}}),r=$2Eggz.BB.el({tagName:"button",content:'<img src="'+$parcel$interopDefault($895204cb2449c455$exports)+'" height="20" alt=""/>',title:$63d0b335c576c718$export$ce37e184d908d785("mci-copy"),onClick:function(){n.select(),navigator.clipboard.writeText(n.value).then().catch()}}),a=$934e5f47c3374e21$export$db3b6bfb95261072({css:{display:"flex",alignItems:"center",marginBottom:"15px",flexWrap:"wrap",gap:"5px 10px",maxWidth:"250px"}},[s,$934e5f47c3374e21$export$db3b6bfb95261072(",flex,items-center,gap-10",[n,r])]);function o(t,s){let r=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:e[s],min:0,max:255,type:"number",css:{width:"80px"},callback:function(){""===r.value||0>parseFloat(r.value)||parseFloat(r.value)>255?a.update():(r.value=""+Math.round(parseFloat(r.value)),e[s]=Number(r.value),i.style.background="#"+$2Eggz.BB.ColorConverter.toHexString(e),n.value="#"+$2Eggz.BB.ColorConverter.toHexString(e))}}),a={update:()=>{r.value=""+e[s]},destroy:()=>{$2Eggz.BB.unsetEventHandler(r,"onchange")},element:$934e5f47c3374e21$export$db3b6bfb95261072("tr",[$934e5f47c3374e21$export$db3b6bfb95261072("td,pr-10",t),$934e5f47c3374e21$export$db3b6bfb95261072("td",[r])])};return a}setTimeout(function(){n.focus(),n.select()},0);let l=[o($63d0b335c576c718$export$ce37e184d908d785("red"),"r"),o($63d0b335c576c718$export$ce37e184d908d785("green"),"g"),o($63d0b335c576c718$export$ce37e184d908d785("blue"),"b")],h=$934e5f47c3374e21$export$db3b6bfb95261072("",[i,a,$934e5f47c3374e21$export$db3b6bfb95261072("table."+$cf02414f4b0b48a4$export$9852986a3ec5f6a0,[$934e5f47c3374e21$export$db3b6bfb95261072("tbody",l.map(t=>t.element))])]);$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("manual-color-input")}</b>`,div:h,autoFocus:!1,clickOnEnter:"Ok",buttons:["Ok","Cancel"],callback:function(e){$2Eggz.BB.destroyEl(r),l.forEach(t=>t.destroy()),l.splice(0,l.length),t.onClose("Ok"===e?$2Eggz.BB.ColorConverter.hexToRGB(n.value):void 0)}})}}var $2Eggz=parcelRequire("2Eggz"),$d1c3e18053002796$exports={};$d1c3e18053002796$exports=$parcel$resolve("9Vqzx");var $VM6dD=parcelRequire("VM6dD"),$dGRuJ=parcelRequire("dGRuJ");let $74a507c74cfe9692$var$LS_THEME_KEY="klecks-theme";class $74a507c74cfe9692$var$Theme{updateTheme(){let t=this.theme;this.theme=this.storedTheme||this.mediaQueryTheme,this.theme!==t&&(document.body.classList.toggle("kl-theme-dark","dark"===this.theme),this.listeners.forEach(t=>t()))}readLocalStorage(){let t=$dGRuJ.LocalStorage.getItem($74a507c74cfe9692$var$LS_THEME_KEY);return t&&("string"!=typeof t||["dark","light"].includes(t))||(t=void 0,$dGRuJ.LocalStorage.removeItem($74a507c74cfe9692$var$LS_THEME_KEY)),t}isDark(){return"dark"===this.theme}addIsDarkListener(t){this.listeners.includes(t)||this.listeners.push(t)}removeIsDarkListener(t){for(let e=0;e<this.listeners.length;e++)if(this.listeners[e]===t)return void this.listeners.splice(e,1)}getMediaQueryTheme(){return this.mediaQueryTheme}getStoredTheme(){return this.storedTheme}setStoredTheme(t){t?$dGRuJ.LocalStorage.setItem($74a507c74cfe9692$var$LS_THEME_KEY,t):$dGRuJ.LocalStorage.removeItem($74a507c74cfe9692$var$LS_THEME_KEY),this.storedTheme=t,this.updateTheme()}constructor(){this.mediaQueryTheme="light",this.theme="light",this.listeners=[],this.mediaQueryTheme=(0,$VM6dD.isDark)()?"dark":"light",(0,$VM6dD.addIsDarkListener)(()=>{this.mediaQueryTheme=(0,$VM6dD.isDark)()?"dark":"light",this.updateTheme()}),this.storedTheme=this.readLocalStorage(),addEventListener("storage",t=>{t.key===$74a507c74cfe9692$var$LS_THEME_KEY&&(this.storedTheme=this.readLocalStorage(),this.updateTheme())}),this.updateTheme()}}let $74a507c74cfe9692$export$5714e40777c1bcc2=new $74a507c74cfe9692$var$Theme,$7a2aeb795d64bafc$export$e4203cb02d5e5b28=($74a507c74cfe9692$export$5714e40777c1bcc2.isDark(),255);function $7a2aeb795d64bafc$export$8627e24041b28589(){return{r:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,g:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,b:$7a2aeb795d64bafc$export$e4203cb02d5e5b28}}var $VM6dD=parcelRequire("VM6dD");class $90a88670cfc900e0$export$4e5102252876c5d7{updatePrimaryHSV(t){0===t.s?this.primaryColorHsv=new $2Eggz.BB.HSV(this.primaryColorHsv.h,t.s,t.v):this.primaryColorHsv=new $2Eggz.BB.HSV(t.h,t.s,t.v)}updateSVCanvas(){let t=$2Eggz.BB.ColorConverter.toRGB(new $2Eggz.BB.HSV(this.primaryColorHsv.h,100,100));this.svGradient.style.setProperty("--kl-color-picker--hue","#"+$2Eggz.BB.ColorConverter.toHexString(t))}updateSVPointer(){let t=this.primaryColorHsv.s/100*this.width-7,e=(1-this.primaryColorHsv.v/100)*this.svHeight-6;(0,$VM6dD.css)(this.pointerSV,{left:t+"px",top:e+"px"})}setColPreview(){this.divPreview.style.backgroundColor="rgb("+this.primaryColorRgb.r+","+this.primaryColorRgb.g+","+this.primaryColorRgb.b+")",$2Eggz.BB.testIsWhiteBestContrast(this.primaryColorRgb)?((0,$VM6dD.css)(this.pickerButton,{filter:"invert(1)"}),(0,$VM6dD.css)(this.hexButton,{filter:"invert(1)"})):((0,$VM6dD.css)(this.pickerButton,{filter:""}),(0,$VM6dD.css)(this.hexButton,{filter:""}))}updateSecondaryColor(){this.secondaryColorBtn.style.backgroundColor=$2Eggz.BB.ColorConverter.toRgbStr(this.secondaryColorRgb)}setColor(t){this.primaryColorRgb={r:parseInt(""+t.r),g:parseInt(""+t.g),b:parseInt(""+t.b)},this.updatePrimaryHSV($2Eggz.BB.ColorConverter.toHSV(t)),this.controlH.style.left=parseInt(""+(this.primaryColorHsv.h/359*this.width-1))+"px",this.updateSVCanvas(),this.updateSVPointer(),this.setColPreview()}getColor(){return new $2Eggz.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b)}getSecondaryRGB(){return new $2Eggz.BB.RGB(this.secondaryColorRgb.r,this.secondaryColorRgb.g,this.secondaryColorRgb.b)}getIsEyedropping(){return this.isPicking}setIsEyedropping(t){t?(this.isPicking=!0,this.onEyedropper(!0),this.pickerButton.classList.add("color-picker-preview-button-active")):(this.isPicking=!1,this.onEyedropper(!1),this.pickerButton.classList.remove("color-picker-preview-button-active"))}enable(t){let e={pointerEvents:t?"":"none",opacity:t?"1":"0.5"};(0,$VM6dD.css)(this.rootEl,e),(0,$VM6dD.css)(this.outputDiv,e)}setHeight(t){(t=parseInt(""+(t-2*this.height-3),10))!==this.svHeight&&(this.svHeight=t,(0,$VM6dD.css)(this.svGradient,{width:this.width+"px",height:this.svHeight+"px"}),this.SVContainer.style.height=this.svHeight+"px",this.updateSVPointer())}swapColors(){let t=this.secondaryColorHsv;this.secondaryColorHsv=this.primaryColorHsv,this.updatePrimaryHSV(t),t=this.secondaryColorRgb,this.secondaryColorRgb=this.primaryColorRgb,this.primaryColorRgb=t,this.controlH.style.left=parseInt(""+(this.primaryColorHsv.h/359*this.width-1))+"px",this.updateSVCanvas(),this.updateSVPointer(),this.setColPreview(),this.updateSecondaryColor(),this.emitColor(new $2Eggz.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b))}getElement(){return this.rootEl}getOutputElement(){return this.outputDiv}constructor(t){this.rootEl=$2Eggz.BB.el({className:"kl-color-picker",css:{position:"relative"}}),this.outputDiv=$2Eggz.BB.el({css:{display:"flex",alignItems:"center"}}),this.width=t.width,this.svHeight=t.svHeight,this.height=t.height,this.emitColor=t.onPick,this.onEyedropper=t.onEyedropper,this.primaryColorRgb={r:parseInt(""+t.startValue.r),g:parseInt(""+t.startValue.g),b:parseInt(""+t.startValue.b)},this.primaryColorHsv=$2Eggz.BB.ColorConverter.toHSV(t.startValue),this.secondaryColorRgb={r:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,g:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,b:$7a2aeb795d64bafc$export$e4203cb02d5e5b28},this.secondaryColorHsv=$2Eggz.BB.ColorConverter._RGBtoHSV(this.secondaryColorRgb);let e=$2Eggz.BB.el();this.svGradient=$2Eggz.BB.el({css:{background:"linear-gradient(0deg, #000 0%, rgba(255, 0, 0, 0) 100%), linear-gradient(-90deg, var(--kl-color-picker--hue) 0%, #fff 100%)",width:this.width+"px",height:this.svHeight+"px"}}),e.append(this.svGradient);let i=$2Eggz.BB.el({className:"kl-color-picker__h",css:{overflow:"hidden",position:"relative",width:this.width+"px",height:this.height+"px",cursor:"ew-resize",marginTop:"1px",marginBottom:"1px"}});this.divPreview=$2Eggz.BB.el({className:"kl-color-picker__preview",css:{display:"flex",justifyContent:"space-between",width:2.5*this.height+"px",height:this.height+"px"}}),this.controlH=$2Eggz.BB.el();let s=t=>{let e=new Image;(0,$VM6dD.css)(e,{position:"absolute",left:"0",top:"0",display:"none",pointerEvents:"none"});let i=$2Eggz.BB.canvas(this.width,this.height),s=$2Eggz.BB.ctx(i),n=s.createLinearGradient(0,0,this.width,0);for(let t=0;t<1;t+=.01){let e=$2Eggz.BB.ColorConverter.toRGB(new $2Eggz.BB.HSV(360*t,100,100)),i=parseInt(""+e.r).toString(16),s=parseInt(""+e.g).toString(16),r=parseInt(""+e.b).toString(16);1===i.length&&(i="0"+i),1===s.length&&(s="0"+s),1===r.length&&(r="0"+r),n.addColorStop(t,"#"+i+s+r)}s.fillStyle=n,s.fillRect(0,0,this.width,this.height),t.append(e),e.alt="hue",e.src=i.toDataURL("image/png"),e.style.display="block"};this.updateSVCanvas(),this.rootEl.style.width=this.width+"px",this.rootEl.oncontextmenu=()=>!1,this.SVContainer=$2Eggz.BB.el({className:"kl-color-picker__sv",css:{width:this.width+"px",height:this.svHeight+"px",overflow:"hidden",display:"block",position:"relative",cursor:"crosshair"}}),this.pointerSV=$2Eggz.BB.el({css:{width:"12px",height:"12px",borderRadius:"6px",position:"absolute",pointerEvents:"none",boxShadow:"0px 0px 0 1px #000, inset 0px 0px 0 1px #fff"}}),this.SVContainer.append(e,this.pointerSV),this.updateSVPointer(),this.rootEl.append(this.SVContainer,i),this.outputDiv.append(this.divPreview),(0,$VM6dD.css)(this.controlH,{width:"2px",height:this.height+"px",background:"#000",borderLeft:"1px solid #fff",position:"absolute",top:"0",left:parseInt(""+(this.primaryColorHsv.h/360*this.width-1))+"px"});let n={h:0,s:0,v:0};this.pickerButton=$2Eggz.BB.el({title:$63d0b335c576c718$export$ce37e184d908d785("eyedropper")+" [Alt]",className:"color-picker-preview-button",css:{width:"30px",height:"30px",backgroundImage:"url("+$parcel$interopDefault($d1c3e18053002796$exports)+")",backgroundRepeat:"no-repeat",backgroundSize:"70%",backgroundPosition:"center"},onClick:()=>{this.isPicking?this.setIsEyedropping(!1):(this.pickerButton.classList.remove("color-picker-preview-button-hover"),this.pickerButton.classList.add("color-picker-preview-button-active"),this.isPicking=!0,this.onEyedropper(!0))}}),this.isPicking=!1,new $2Eggz.BB.PointerListener({target:this.pickerButton,onEnterLeave:t=>{this.isPicking||this.pickerButton.classList.toggle("color-picker-preview-button-hover",t)}}),this.divPreview.append(this.pickerButton),this.hexButton=$2Eggz.BB.el({content:"#",className:"color-picker-preview-button",title:$63d0b335c576c718$export$ce37e184d908d785("manual-color-input"),css:{height:"100%",width:this.height+"px",lineHeight:this.height+"px",fontSize:.65*this.height+"px"},onClick:()=>{new $49ce344532144fcf$export$cc42e119007cb939({color:new $2Eggz.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b),onClose:t=>{t&&(this.setColor(t),this.emitColor(new $2Eggz.BB.RGB(this.primaryColorRgb.r,this.primaryColorRgb.g,this.primaryColorRgb.b)))}})}}),new $2Eggz.BB.PointerListener({target:this.hexButton,onEnterLeave:t=>{this.hexButton.classList.toggle("color-picker-preview-button-hover",t)}}),this.divPreview.append(this.hexButton),this.setColPreview(),setTimeout(()=>{s(i),i.append(this.controlH),new $2Eggz.BB.PointerListener({target:e,fixScribble:!0,onPointer:t=>{if("pointerdown"===t.type&&($2Eggz.BB.unfocusAnyInput(),this.SVContainer.classList.toggle("kl-color-picker--active",!0),"left"===t.button?(n.s=t.relX/this.width*100,n.v=100-t.relY/this.svHeight*100,this.primaryColorHsv=new $2Eggz.BB.HSV(this.primaryColorHsv.h,n.s,n.v),this.primaryColorRgb=$2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv),this.updateSVPointer(),this.setColPreview(),this.emitColor($2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv))):(n.s=this.primaryColorHsv.s,n.v=this.primaryColorHsv.v)),"pointermove"===t.type&&["left","right"].includes(t.button||"")){let e=1;"right"===t.button&&(e=.5),n.s+=t.dX/this.width*100*e,n.v-=t.dY/this.svHeight*100*e,this.primaryColorHsv=new $2Eggz.BB.HSV(this.primaryColorHsv.h,n.s,n.v),this.primaryColorRgb=$2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv),this.updateSVPointer(),this.setColPreview(),this.emitColor($2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv))}"pointerup"===t.type&&this.SVContainer.classList.toggle("kl-color-picker--active",!1)}}),new $2Eggz.BB.PointerListener({target:i,fixScribble:!0,onPointer:t=>{if("pointerdown"===t.type&&($2Eggz.BB.unfocusAnyInput(),i.classList.toggle("kl-color-picker--active",!0),"left"===t.button?(n.h=t.relX/this.width*359.99,this.primaryColorHsv=new $2Eggz.BB.HSV(n.h,this.primaryColorHsv.s,this.primaryColorHsv.v),this.primaryColorRgb=$2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv),this.controlH.style.left=Math.round(this.primaryColorHsv.h/359.99*this.width)-1+"px",this.updateSVCanvas(),this.setColPreview(),this.emitColor($2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv))):n.h=this.primaryColorHsv.h),"pointermove"===t.type&&["left","right"].includes(t.button||"")){let e=$6e485eb0c82960d0$export$f8e41e222e32615d(Math.abs(t.pageY-t.downPageY),"right"===t.button);n.h+=t.dX/this.width*359.99*e,"right"===t.button&&(n.h=n.h%359.99,n.h<0&&(n.h+=359.99)),n.h=Math.min(359.99,n.h),this.primaryColorHsv=new $2Eggz.BB.HSV(n.h,this.primaryColorHsv.s,this.primaryColorHsv.v),this.primaryColorRgb=$2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv),this.controlH.style.left=Math.round(this.primaryColorHsv.h/359.99*this.width)-1+"px",this.updateSVCanvas(),this.setColPreview(),this.emitColor($2Eggz.BB.ColorConverter.toRGB(this.primaryColorHsv))}"pointerup"===t.type&&i.classList.toggle("kl-color-picker--active",!1)}})},1),this.secondaryColorBtn=$2Eggz.BB.el({parent:this.outputDiv,title:$63d0b335c576c718$export$ce37e184d908d785("secondary-color")+" [X]",className:"kl-color-picker__secondary",css:{cursor:"pointer",marginLeft:"5px",width:"22px",height:"22px"},onClick:t=>{t.preventDefault(),this.swapColors()}}),this.updateSecondaryColor()}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $8f768338795db7a0$export$66306bf21a9ff39e{updateSV(){let t=$2Eggz.BB.ctx(this.canvasSV);if(!t)throw Error("couldn't create canvas");for(let e=0;e<this.canvasSV.height;e+=1){let i=t.createLinearGradient(0,0,this.canvasSV.width,0),s=$2Eggz.BB.ColorConverter.toRGB(new $2Eggz.BB.HSV(this.color.h,1,100-e/this.canvasSV.height*100)),n=$2Eggz.BB.ColorConverter.toRGB(new $2Eggz.BB.HSV(this.color.h,100,100-e/this.canvasSV.height*100));i.addColorStop(0,"#"+$2Eggz.BB.ColorConverter.toHexString(s)),i.addColorStop(1,"#"+$2Eggz.BB.ColorConverter.toHexString(n)),t.fillStyle="#ff0000",t.fillStyle=i,t.fillRect(0,e,this.canvasSV.width,1)}}updateSVPointer(){let t=this.color.s/100*this.width-4,e=(1-this.color.v/100)*this.heightSV-4;(0,$VM6dD.css)(this.pointerSV,{left:t+"px",top:e+"px"})}updateHPointer(){this.pointerH.style.left=this.color.h/359.999*this.width-1+"px"}setColor(t){null===this.hPointerId&&null===this.svPointerId&&(this.color=$2Eggz.BB.ColorConverter.toHSV(new $2Eggz.BB.RGB(t.r,t.g,t.b)),this.updateSV(),this.updateSVPointer(),this.updateHPointer())}getColor(){return $2Eggz.BB.ColorConverter.toRGB(this.color)}getElement(){return this.rootEl}end(){this.svPointerId=null,this.hPointerId=null}destroy(){this.svPointerListener.destroy(),this.hPointerListener.destroy()}constructor(t){this.rootEl=$2Eggz.BB.el({css:{width:t.width+"px",position:"relative",overflow:"hidden",userSelect:"none"}}),this.rootEl.oncontextmenu=t=>{t.preventDefault()},this.color=$2Eggz.BB.ColorConverter.toHSV(new $2Eggz.BB.RGB(t.color.r,t.color.g,t.color.b)),this.width=t.width,this.heightSV=t.heightSV,this.canvasSV=$2Eggz.BB.canvas(10,10),(0,$VM6dD.css)(this.canvasSV,{width:this.width+"px",height:this.heightSV+"px",cursor:"crosshair"}),this.updateSV();let e=$2Eggz.BB.canvas(t.width,t.heightH);e.style.cursor="ew-resize",(()=>{let i=$2Eggz.BB.ctx(e),s=i.createLinearGradient(0,0,t.width,0);for(let t=0;t<1;t+=.01){let e=$2Eggz.BB.ColorConverter.toRGB(new $2Eggz.BB.HSV(360*t,100,100));s.addColorStop(t,"rgba("+parseInt(""+e.r)+", "+parseInt(""+e.g)+", "+parseInt(""+e.b)+", 1)")}i.fillStyle=s,i.fillRect(0,0,t.width,t.heightH)})(),(0,$VM6dD.css)(this.canvasSV,{width:t.width+"px",height:t.heightSV+"px",overflow:"hidden",position:"relative"}),this.canvasSV.style.cssFloat="left",e.style.cssFloat="left",this.rootEl.append(this.canvasSV,e),this.pointerSV=$2Eggz.BB.el({parent:this.rootEl,css:{width:"8px",height:"8px",borderRadius:"8px",position:"absolute",pointerEvents:"none",boxShadow:"0 0 0 1px #000, inset 0 0 0 1px #fff"}}),this.pointerH=$2Eggz.BB.el({parent:this.rootEl,css:{width:"0",height:t.heightH+"px",borderLeft:"1px solid #fff",borderRight:"1px solid #000",position:"absolute",top:t.heightSV+"px",pointerEvents:"none"}}),this.updateSVPointer(),this.updateHPointer();let i={h:0,s:0,v:0};this.svPointerId=null,this.svPointerListener=new $2Eggz.BB.PointerListener({target:this.canvasSV,fixScribble:!0,onPointer:e=>{if("pointerdown"===e.type&&($2Eggz.BB.unfocusAnyInput(),this.svPointerId=e.pointerId,"left"===e.button?(i.s=e.relX/t.width*100,i.v=100-e.relY/t.heightSV*100,this.color=new $2Eggz.BB.HSV(this.color.h,i.s,i.v),this.updateSVPointer(),t.callback($2Eggz.BB.ColorConverter.toRGB(this.color))):(i.s=this.color.s,i.v=this.color.v)),"pointermove"===e.type&&["left","right"].includes(""+e.button)&&this.svPointerId===e.pointerId){let s=1;"right"===e.button&&(s=.5),i.s+=e.dX/t.width*100*s,i.v-=e.dY/t.heightSV*100*s,this.color=new $2Eggz.BB.HSV(this.color.h,i.s,i.v),this.updateSVPointer(),t.callback($2Eggz.BB.ColorConverter.toRGB(this.color))}"pointerup"===e.type&&(this.svPointerId=null)}}),this.hPointerId=null,this.hPointerListener=new $2Eggz.BB.PointerListener({target:e,fixScribble:!0,onPointer:e=>{if("pointerdown"===e.type&&(this.hPointerId=e.pointerId,"left"===e.button?(i.h=e.relX/t.width*359.99,this.color=new $2Eggz.BB.HSV(i.h,this.color.s,this.color.v),this.updateSV(),this.updateHPointer(),t.callback($2Eggz.BB.ColorConverter.toRGB(this.color))):i.h=this.color.h),"pointermove"===e.type&&["left","right"].includes(""+e.button)&&this.hPointerId===e.pointerId){let s=$6e485eb0c82960d0$export$f8e41e222e32615d(Math.abs(e.pageY-e.downPageY),"right"===e.button);i.h+=e.dX/t.width*359.99*s,"right"===e.button&&(i.h=i.h%359.99,i.h<0&&(i.h+=359.99)),i.h=Math.min(359.99,i.h),this.color=new $2Eggz.BB.HSV(i.h,this.color.s,this.color.v),this.updateSV(),this.updateHPointer(),t.callback($2Eggz.BB.ColorConverter.toRGB(this.color))}"pointerup"===e.type&&(this.hPointerId=null)}}),$2Eggz.BB.el({parent:this.rootEl,css:{clear:"both"}})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $867da577d723d824$export$ac00cea56cec3037{getElement(){return this.rootEl}setActive(t){this.sliderPoint.style.backgroundColor=t?"#fff":"#eaeaea"}destroy(){this.pointerListener.destroy()}constructor(t){let e;this.rootEl=$2Eggz.BB.el({css:{position:"relative"}}),$2Eggz.BB.el({parent:this.rootEl,className:"kl-point-slider__line",css:{marginTop:parseInt(""+(t.pointSize/2-1))+"px",width:t.width+"px"}}),this.sliderPoint=$2Eggz.BB.el({parent:this.rootEl,className:"kl-point-slider__point"}),$2Eggz.BB.el({parent:this.sliderPoint,css:{margin:"-7px 0 0 -7px",width:"calc(100% + 14px)",height:"calc(100% + 7px)"}});let i=()=>{(0,$VM6dD.css)(this.sliderPoint,{left:e+"px"})},s=()=>e/(t.width-t.pointSize);{let n,r;e=$2Eggz.BB.clamp(t.init*(t.width-t.pointSize),0,t.width-t.pointSize),(0,$VM6dD.css)(this.sliderPoint,{width:t.pointSize+"px",height:t.pointSize+"px",borderRadius:t.pointSize+"px"}),i(),this.pointerListener=new $2Eggz.BB.PointerListener({target:this.sliderPoint,fixScribble:!0,onPointer:a=>{"pointerdown"===a.type&&"left"===a.button?(n=!0,r=e,i(),a.eventStopPropagation()):"pointermove"===a.type&&"left"===a.button&&(a.eventStopPropagation(),r+=a.dX,e=parseInt(""+$2Eggz.BB.clamp(r,0,t.width-t.pointSize)),i(),t.callback(s(),n,!1),n=!1),"pointerup"===a.type&&(a.eventStopPropagation(),i(),t.callback(s(),!1,!0))}})}}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$5EmwV=parcelRequire("5EmwV");class $3032e23fa8f3a9e5$export$24ba9b81662d4366{getElement(){return this.rootEl}getValue(){return this.colorArr[this.selectedIndex]}destroy(){this.rootEl.remove(),this.buttonArr.forEach(t=>{$2Eggz.BB.destroyEl(t.el)}),this.buttonArr.splice(0,this.buttonArr.length),this.colorInput.onchange=null,this.colorInput.oninput=null}constructor(t){var e;this.colorArr=[],this.selectedIndex=0,this.rootEl=$2Eggz.BB.el({content:t.label?t.label:"",title:null!=(e=t.title)?e:void 0,css:(0,$wpIFA._)({display:"flex",alignItems:"center",gap:"7px",position:"relative"},t.css)}),this.buttonArr=[];let i=22;this.onColorInputChange=()=>{let e=this.selectedIndex,i=this.colorArr[e];if(!i||i.a<1)return;let s=this.colorInput.value;this.buttonArr[this.selectedIndex].el.style.backgroundColor=s,this.colorArr[e]=(0,$9FMZM._)((0,$wpIFA._)({},$5EmwV.ColorConverter.hexToRGB(s)),{a:1}),t.onChange(this.colorArr[e])},this.colorInput=$2Eggz.BB.el({tagName:"input",custom:{type:"color",tabIndex:"-1"}}),this.colorInput.onchange=this.onColorInputChange,this.colorInput.oninput=this.onColorInputChange;for(let e=0;e<t.colorArr.length;e++){let i=t.colorArr[e],s=!1;for(let t=0;t<this.colorArr.length;t++){let e=this.colorArr[t];if(e===i||null!==e&&null!==i&&e.r===i.r&&e.g===i.g&&e.b===i.b&&e.a===i.a){s=!0;break}}!s&&(this.colorArr.push(i),"initialIndex"in t&&t.initialIndex===e&&(this.selectedIndex=this.colorArr.length-1))}for(let e=0;e<this.colorArr.length;e++)(e=>{let n=this.colorArr[e],r=$2Eggz.BB.el({parent:this.rootEl,content:n?"":"X",className:"kl-color-option",css:{width:i+"px",height:i+"px",backgroundColor:n?$2Eggz.BB.ColorConverter.toRgbaStr(n):"transparent",lineHeight:i+1+"px"},onClick:i=>{if(this.selectedIndex===e){n&&1===n.a&&(this.colorInput.showPicker?this.colorInput.showPicker():this.colorInput.click());return}i.preventDefault(),this.selectedIndex=e,s(),t.onChange(this.colorArr[e])}});n&&0===n.a&&(r.style.background="var(--kl-checkerboard-background)");let a=t=>{r.classList.toggle("kl-color-option--active",t)};this.buttonArr.push({el:r,setIsSelected:a})})(e);this.rootEl.append($934e5f47c3374e21$export$db3b6bfb95261072(",w-0,h-0,overflow-hidden,abs-0-0",[this.colorInput]));let s=()=>{for(let t=0;t<this.buttonArr.length;t++)this.buttonArr[t].setIsSelected(t===this.selectedIndex)};s()}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $1166276dc18d3ea9$export$c019608e5b5bb4cb{getIndex(){for(let t=0;t<this.optionArr.length;t++)if(this.optionArr[t].id===this.selectedId)return t;return -1}update(){for(let t=0;t<this.optionArr.length;t++)this.optionArr[t].el.classList.toggle("kl-option-selected",this.optionArr[t].id===this.selectedId)}getElement(){return this.rootEl}getValue(){return this.selectedId}next(){this.selectedId=this.optionArr[(this.getIndex()+1)%this.optionArr.length].id,this.update(),this.onChange&&this.onChange(this.selectedId)}setValue(t,e){this.selectedId!==t&&(this.selectedId=t,this.update(),!e&&this.onChange&&this.onChange(this.selectedId))}previous(){this.selectedId=this.optionArr[(this.optionArr.length+this.getIndex()-1)%this.optionArr.length].id,this.update(),this.onChange&&this.onChange(this.selectedId)}destroy(){this.rootEl.remove(),this.optionArr.forEach(t=>{$2Eggz.BB.destroyEl(t.el)}),this.optionArr.splice(0,this.optionArr.length)}constructor(t){this.rootEl=$2Eggz.BB.el({css:t.css});let e=$2Eggz.BB.el({parent:this.rootEl,className:"kl-option-wrapper",css:{display:"flex",flexDirection:t.isColumn?"column":"row"}});t.onChange&&(this.onChange=t.onChange),this.optionArr=[],this.selectedId="initialId"in t&&void 0!==t.initId?t.initId:t.optionArr[0].id;let i=i=>{let s=["kl-option"];t.isSmall&&s.push("kl-option--small"),"string"!=typeof i.label&&(s.push("kl-option--custom-el"),(0,$VM6dD.css)(i.label,{display:"block",pointerEvents:"none"}));let n={id:i.id,el:$2Eggz.BB.el({parent:e,content:i.label,className:s.join(" "),onClick:()=>{this.selectedId!==n.id&&(!t.onBeforeChange||t.onBeforeChange(n.id))&&(this.selectedId=n.id,this.update(),this.onChange&&this.onChange(this.selectedId))},css:t.optionCss})};i.title&&(n.el.title=i.title),this.optionArr.push(n)};for(let e=0;e<t.optionArr.length;e++)i(t.optionArr[e]);this.update(),t.changeOnInit&&setTimeout(()=>{this.onChange&&this.onChange(this.selectedId)},0)}}var $2Eggz=parcelRequire("2Eggz"),$e64ad8a2a278ae06$exports={};$e64ad8a2a278ae06$exports=$parcel$resolve("vALcr");var $VM6dD=parcelRequire("VM6dD");class $7ed35ae008fa6be6$export$5ee0af1d5c87e856{updateUiState(){"left"===this.uiState?this.el.style.left="271px":this.el.style.removeProperty("left")}setWide(t){this.isWide=t,this.el&&(this.isWide?(this.el.style.width="100%",this.el.style.left=""):(this.el.style.removeProperty("width"),this.el.style.left="left"===this.uiState?"271px":""))}setUiState(t){this.uiState=t,this.updateUiState()}out(t,e){"string"==typeof t?(this.angleIm.style.display="none",this.innerInnerEl.style.removeProperty("font-family"),this.innerInnerEl.innerHTML=t):"transform"===t.type?(this.angleIm.style.display="inline-block",this.angleIm.style.transform="rotate("+t.angleDeg+"deg)",t.angleDeg%90==0?this.angleIm.style.boxShadow="inset 0 0 0 1px rgba(255, 255, 255, 0.7)":this.angleIm.style.boxShadow="",this.innerInnerEl.style.fontFamily="monospace",this.innerInnerEl.innerHTML=Math.round(100*t.scale)+"%"):this.angleIm.style.display="none",e&&(this.innerEl.style.animation="",setTimeout(()=>this.innerEl.style.animation="topOverlayPulse 0.5s ease-out",20),clearTimeout(this.timeout3),this.timeout3=setTimeout(()=>this.innerEl.style.animation="",520)),clearTimeout(this.timeout),clearTimeout(this.timeout2),this.el.style.animationName=e?"consoleInFast":"consoleIn",this.el.style.opacity="1",this.timeout=setTimeout(()=>{this.el.style.opacity="0",this.el.style.animationName="consoleOut",this.timeout2=setTimeout(()=>{this.el.style.display="none"},450)},1200),this.el.style.display="flex"}constructor(){this.isWide=!1,this.uiState="right",this.el=$2Eggz.BB.el({className:"top-overlay g-root",onClick:$2Eggz.BB.handleClick}),this.updateUiState(),this.innerEl=$2Eggz.BB.el({className:"top-overlay--inner"}),this.angleIm=new Image,this.angleIm.src=$parcel$interopDefault($e64ad8a2a278ae06$exports),(0,$VM6dD.css)(this.angleIm,{verticalAlign:"bottom",width:"20px",height:"20px",marginLeft:"5px",borderRadius:"10px"}),this.innerInnerEl=document.createElement("div"),this.innerInnerEl.style.display="inline-block",this.innerEl.append(this.innerInnerEl,this.angleIm),this.el.append(this.innerEl),document.body.append(this.el),this.el.style.display="none"}}var $2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $855520c81dfcb96a$export$9b20165a36586806(t,e){return Array.isArray(e)?[t.a*e[0]+t.c*e[1]+t.e,t.b*e[0]+t.d*e[1]+t.f]:{x:t.a*e.x+t.c*e.y+t.e,y:t.b*e.x+t.d*e.y+t.f}}function $5c473edaf09eadd3$export$f0954fd7d5368655(){return{a:1,c:0,e:0,b:0,d:1,f:0}}function $077740f52fe6870e$export$70ae2c07e401031b(t){let{a:e,b:i,c:s,d:n,e:r,f:a}=t,o=e*n-i*s;return{a:n/o,b:-(i/o),c:-(s/o),d:e/o,e:-((n*r-s*a)/o),f:(i*r-e*a)/o}}function $bd2ee0a774cbe423$export$fce6876652108ab(t){return void 0===t}function $cf0617f9860dc277$export$d73ee8ef04f5226a(t,e=0){return{a:1,c:0,e:t,b:0,d:1,f:e}}function $611d5fdbbcda65d9$export$51186ad6e864892a(...t){t=Array.isArray(t[0])?t[0]:t;let e=(t,e)=>({a:t.a*e.a+t.c*e.b,c:t.a*e.c+t.c*e.d,e:t.a*e.e+t.c*e.f+t.e,b:t.b*e.a+t.d*e.b,d:t.b*e.c+t.d*e.d,f:t.b*e.e+t.d*e.f+t.f});switch(t.length){case 0:throw Error("no matrices provided");case 1:return t[0];case 2:return e(t[0],t[1]);default:{let[i,s,...n]=t;return $611d5fdbbcda65d9$export$51186ad6e864892a(e(i,s),...n)}}}function $611d5fdbbcda65d9$export$f672e0b6f7222cd7(...t){return $611d5fdbbcda65d9$export$51186ad6e864892a(...t)}let{cos:$20520e5c69c4ad5d$var$cos,sin:$20520e5c69c4ad5d$var$sin,PI:$20520e5c69c4ad5d$var$PI}=Math;function $20520e5c69c4ad5d$export$bb628a54ab399bc9(t,e,i){let s=$20520e5c69c4ad5d$var$cos(t),n=$20520e5c69c4ad5d$var$sin(t),r={a:s,c:-n,e:0,b:n,d:s,f:0};return $bd2ee0a774cbe423$export$fce6876652108ab(e)||$bd2ee0a774cbe423$export$fce6876652108ab(i)?r:$611d5fdbbcda65d9$export$51186ad6e864892a([$cf0617f9860dc277$export$d73ee8ef04f5226a(e,i),r,$cf0617f9860dc277$export$d73ee8ef04f5226a(-e,-i)])}function $a78c550eaaca7cca$export$dcdf75081b88279d(t,e,i,s){$bd2ee0a774cbe423$export$fce6876652108ab(e)&&(e=t);let n={a:t,c:0,e:0,b:0,d:e,f:0};return $bd2ee0a774cbe423$export$fce6876652108ab(i)||$bd2ee0a774cbe423$export$fce6876652108ab(s)?n:$611d5fdbbcda65d9$export$51186ad6e864892a([$cf0617f9860dc277$export$d73ee8ef04f5226a(i,s),n,$cf0617f9860dc277$export$d73ee8ef04f5226a(-i,-s)])}let{tan:$efe14c63f0506f3c$var$tan}=Math;class $2c16fa132dd43ca2$export$f21cea08b0dd60e8 extends SyntaxError{format(t){let e="Error: "+this.message;if(this.location){let i=null,s=t.find(t=>t.source===this.location.source);s&&(i=s.text.split(/\r\n|\n|\r/g));let n=this.location.start,r=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(n):n,a=this.location.source+":"+r.line+":"+r.column;if(i){let t=this.location.end,s="".padEnd(r.line.toString().length," "),o=i[n.line-1],l=(n.line===t.line?t.column:o.length+1)-n.column||1;e+="\n --\x3e "+a+"\n"+s+" |\n"+r.line+" | "+o+"\n"+s+" | "+"".padEnd(n.column-1," ")+"".padEnd(l,"^")}else e+="\n at "+a}return e}static buildMessage(t,e){function i(t){return t.codePointAt(0).toString(16).toUpperCase()}let s=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function n(t){return s?t.replace(s,t=>"\\u{"+i(t)+"}"):t}function r(t){return n(t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+i(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+i(t)))}function a(t){return n(t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,t=>"\\x0"+i(t)).replace(/[\x10-\x1F\x7F-\x9F]/g,t=>"\\x"+i(t)))}let o={literal:t=>'"'+r(t.text)+'"',class(t){let e=t.parts.map(t=>Array.isArray(t)?a(t[0])+"-"+a(t[1]):a(t));return"["+(t.inverted?"^":"")+e.join("")+"]"+(t.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:t=>t.description};function l(t){return o[t.type](t)}function h(t){return t?'"'+r(t)+'"':"end of input"}return"Expected "+function(t){let e=t.map(l);if(e.sort(),e.length>0){let t=1;for(let i=1;i<e.length;i++)e[i-1]!==e[i]&&(e[t]=e[i],t++);e.length=t}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(t)+" but "+h(e)+" found."}constructor(t,e,i,s){super(t),this.expected=e,this.found=i,this.location=s,this.name="SyntaxError"}}function $00bfc001d6438b5d$export$ad1d215dd03fe75a(t){let e="scale"in t?t.scale:t.scaleX,i="scale"in t?t.scale:t.scaleY;return $611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(t.x,t.y),$20520e5c69c4ad5d$export$bb628a54ab399bc9(t.angleDeg/180*Math.PI),$a78c550eaaca7cca$export$dcdf75081b88279d(e,i))}function $974f651610599156$export$2b60e7dafdbde18a(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD"),$wpIFA=parcelRequire("wpIFA");function $58cad15031bfc18d$var$getLatestDefined(t){for(let e=t.length-1;e>=0;e--){let i=t[e];if(void 0!==i)return i}throw Error("no defined entry found")}function $58cad15031bfc18d$var$getLatestDefinedProp(t,e){for(let i=t.length-1;i>=0;i--){if(!t[i])continue;let s=t[i][e];if(void 0!==s)return s}throw Error("no defined entry found")}function $58cad15031bfc18d$var$composeLayerTiles(t){let e=[...$58cad15031bfc18d$var$getLatestDefined(t)];return Object.entries(e).forEach(([i])=>{e[+i]=$58cad15031bfc18d$var$getLatestDefinedProp(t,i)}),e}function $58cad15031bfc18d$var$composeLayer(t){return{name:$58cad15031bfc18d$var$getLatestDefinedProp(t,"name"),opacity:$58cad15031bfc18d$var$getLatestDefinedProp(t,"opacity"),isVisible:$58cad15031bfc18d$var$getLatestDefinedProp(t,"isVisible"),mixModeStr:$58cad15031bfc18d$var$getLatestDefinedProp(t,"mixModeStr"),index:$58cad15031bfc18d$var$getLatestDefinedProp(t,"index"),tiles:$58cad15031bfc18d$var$composeLayerTiles(t.map(t=>t?t.tiles:void 0))}}function $58cad15031bfc18d$var$composeLayerMap(t){let e=(0,$wpIFA._)({},$58cad15031bfc18d$var$getLatestDefined(t));return Object.entries(e).forEach(([i])=>{e[i]=$58cad15031bfc18d$var$composeLayer(t.map(t=>t?t[i]:void 0))}),e}function $58cad15031bfc18d$export$801426c37c1dd1c8(t,e){return void 0===e&&(e=t.length-1),{projectId:$58cad15031bfc18d$var$getLatestDefinedProp(t=t.slice(0,e+1),"projectId"),size:$58cad15031bfc18d$var$getLatestDefinedProp(t,"size"),activeLayerId:$58cad15031bfc18d$var$getLatestDefinedProp(t,"activeLayerId"),selection:$58cad15031bfc18d$var$getLatestDefinedProp(t,"selection"),layerMap:$58cad15031bfc18d$var$composeLayerMap(t.map(t=>t.layerMap))}}function $15ded6c5722f2bc8$export$dba0834b723f37f4(t){return"object"==typeof t&&null!==t&&"fill"in t&&"string"==typeof t.fill}function $2cbc755fe0cf3940$export$9522719957028754(t){var e,i;let s=0;return null==(i=t.selection)||null==(e=i.value)||e.forEach(t=>{t.forEach(t=>{s+=2*t.length*8})}),t.layerMap&&Object.entries(t.layerMap).forEach(([,t])=>{var e;null==(e=t.tiles)||e.forEach(t=>{void 0!==t&&($15ded6c5722f2bc8$export$dba0834b723f37f4(t)?s+=2*t.fill.length:s+=t.data.width*t.data.height*4)})}),s}function $cf71a5c2f724654d$export$770e40ded99d2233(t,e){if(void 0!==t.size&&(t.size.width!==e.size.width||t.size.height!==e.size.height)||void 0!==t.selection&&t.selection.value!==e.selection.value||void 0!==t.activeLayerId&&t.activeLayerId!==e.activeLayerId)return!0;if(void 0!==t.layerMap){let i=Object.keys(t.layerMap);for(let t of Object.keys(e.layerMap))if(!i.includes(t))return!0;for(let s of i){let i=e.layerMap[s];if(!i)return!0;let n=t.layerMap[s];if(void 0!==n.name&&n.name!==i.name||void 0!==n.opacity&&n.opacity!==i.opacity||void 0!==n.isVisible&&n.isVisible!==i.isVisible||void 0!==n.mixModeStr&&n.mixModeStr!==i.mixModeStr||void 0!==n.index&&n.index!==i.index||void 0!==n.tiles)return!0}}return!1}let $d2dccce11beb16cf$export$f7bc58374d6bc9b6=256,$d2dccce11beb16cf$var$HISTORY_DEBUGGING=!1;class $d2dccce11beb16cf$export$1a1044741a812c67{broadcast(){this.changeCount++,setTimeout(()=>{for(let t=0;t<this.listeners.length;t++)this.listeners[t]()},1)}updateComposed(){this.composed=$58cad15031bfc18d$export$801426c37c1dd1c8(this.entries.slice(0,this.index+1).map(t=>t.data))}pause(t){t?this.pauseStack++:this.pauseStack=Math.max(0,this.pauseStack-1)}addListener(t){this.listeners.push(t)}push(t,e){if(this.pauseStack>0)return;let i={timestamp:new Date().getTime(),memoryEstimateBytes:$2cbc755fe0cf3940$export$9522719957028754(t),data:t};if(e&&this.index>0){for(this.index--;this.index<this.entries.length-1;)this.entries.pop();$cf71a5c2f724654d$export$770e40ded99d2233(t,$58cad15031bfc18d$export$801426c37c1dd1c8(this.entries.slice(0,this.index+1).map(t=>t.data)))&&this.entries.push(i)}else{for(;this.index<this.entries.length-1;)this.entries.pop();this.entries.push(i)}let s=this.maxUndoSteps,n=this.entries.length-1,r=this.totalThresholdBytes-i.memoryEstimateBytes;for(;n>0&&s>=0;){n--;let t=this.entries[n].memoryEstimateBytes;if(t<this.isFreeThresholdBytes){r-=t;continue}if(0===s||r-t<0){n++;break}r-=t,s--}for(;n>0;){let t=$58cad15031bfc18d$export$801426c37c1dd1c8(this.entries.slice(0,n+1).map(t=>t.data),n),e=$2cbc755fe0cf3940$export$9522719957028754(t);this.entries=[{timestamp:this.entries[n].timestamp,memoryEstimateBytes:e,description:"oldest",data:t},...this.entries.slice(n+1)],this.indexOffset+=n,n=0,this.entries.reduce((t,e)=>t+e.memoryEstimateBytes,0)>this.totalThresholdBytes&&(n=1)}this.index=this.entries.length-1,this.updateComposed(),this.broadcast()}increaseIndex(){return this.canRedo()&&this.index++,this.updateComposed(),this.broadcast(),this.entries[this.index]}decreaseIndex(){return this.canUndo()&&this.index--,this.updateComposed(),this.broadcast(),this.entries[this.index]}canUndo(){return this.index>0}canRedo(){return this.index<this.entries.length-1}getEntries(){return this.entries.slice(0,this.index+1)}getComposed(){return this.composed}getChangeCount(){return this.changeCount}getTotalIndex(){return this.indexOffset+this.index}isPaused(){return this.pauseStack>0}constructor(t){this.maxUndoSteps=20,this.totalThresholdBytes=1e9,this.isFreeThresholdBytes=2048,this.index=0,this.indexOffset=0,this.changeCount=0,this.pauseStack=0,this.listeners=[],this.entries=[{timestamp:new Date().getTime(),memoryEstimateBytes:$2cbc755fe0cf3940$export$9522719957028754(t.oldest),data:t.oldest}],this.composed=t.oldest,$d2dccce11beb16cf$var$HISTORY_DEBUGGING&&(window.getHistoryEntries=()=>this.entries)}}let $e68ebad69e0ff595$export$40257b1b753712da=!1;class $e68ebad69e0ff595$var$DebugRender{render(t,e,i,s){this.internalRenderFuncs.forEach(n=>{t.save(),n(t,e,i,s),t.restore()}),this.renderFuncs.forEach(n=>{t.save(),n(t,e,i,s),t.restore()})}add(t){this.renderFuncs.push(t)}remove(t){for(let e=0;e<this.renderFuncs.length;e++)if(this.renderFuncs[e]===t)return void this.renderFuncs.splice(e,1)}clear(){this.renderFuncs=[]}constructor(){if(this.internalRenderFuncs=[],this.renderFuncs=[],$e68ebad69e0ff595$export$40257b1b753712da){let t=$2Eggz.BB.createCheckerCanvas(256,!1),e=(0,$VM6dD.throwIfNull)($2Eggz.BB.ctx($2Eggz.BB.canvas($d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6)).createPattern(t,"repeat"));this.internalRenderFuncs.push((t,i,s)=>{t.fillStyle=e,t.globalAlpha=.2,t.fillRect(0,0,i,s)})}}}let $e68ebad69e0ff595$export$7bf40fdf7bf55821=new $e68ebad69e0ff595$var$DebugRender;function $0ca7fca685ce788f$var$fixScale(t,e){return Math.round(e*t)/e}class $0ca7fca685ce788f$export$a140ed60c2ca052c{render(t){var e,i;let s=$74a507c74cfe9692$export$5714e40777c1bcc2.isDark(),n=(0,$9FMZM._)((0,$wpIFA._)({},this.transform),{x:this.transform.x,y:this.transform.y,scale:this.transform.scale});this.doResize&&(this.doResize=!1,this.resFactor=this.useNativeResolution?devicePixelRatio:1,this.canvas.width=Math.round(this.width*this.resFactor),this.canvas.height=Math.round(this.height*this.resFactor));let r=t?{x:n.x,y:n.y,angleDeg:n.angleDeg,scaleX:n.scale,scaleY:n.scale}:{x:Math.round(n.x),y:Math.round(n.y),scaleX:$0ca7fca685ce788f$var$fixScale(n.scale,this.project.width),scaleY:$0ca7fca685ce788f$var$fixScale(n.scale,this.project.height),angleDeg:n.angleDeg},a=$00bfc001d6438b5d$export$ad1d215dd03fe75a(r);if(this.ctx.save(),r.scaleX>=10?this.ctx.imageSmoothingEnabled=!1:(this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high"),this.drawBackground?(this.ctx.fillStyle=s?"rgb(33, 33, 33)":"rgb(158,158,158)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):(this.ctx.fillStyle=this.pattern,this.ctx.fillRect(0,0,this.width,this.height)),this.ctx.translate(r.x,r.y),this.ctx.scale(r.scaleX,r.scaleY),this.ctx.rotate(r.angleDeg/180*Math.PI),this.drawBackground){this.ctx.save(),this.ctx.fillStyle=$74a507c74cfe9692$export$5714e40777c1bcc2.isDark()?"rgba(255,255,255,0.25)":"rgba(0,0,0,0.2)";let t=1/r.scaleX,e=1/r.scaleY;this.ctx.fillRect(-t,-e,this.project.width+2*t,this.project.height+2*e),this.ctx.fillStyle=this.pattern;try{this.pattern.setTransform($077740f52fe6870e$export$70ae2c07e401031b(a))}catch(t){}this.ctx.fillRect(0,0,this.project.width,this.project.height),this.ctx.restore()}this.project.layers.forEach(t=>{let e;if(t.isVisible&&t.opacity){if(this.ctx.save(),this.ctx.globalCompositeOperation=t.mixModeStr,this.ctx.globalAlpha=t.opacity,"function"==typeof t.image){let i=t.image(r,this.canvas.width,this.canvas.height);"image"in i&&"transform"in i?(e=i.image,this.ctx.setTransform(...$974f651610599156$export$2b60e7dafdbde18a($611d5fdbbcda65d9$export$f672e0b6f7222cd7(a,i.transform)))):e=i}else e=t.image;this.ctx.drawImage(e,0,0),this.ctx.restore()}}),null==(e=(i=this).renderAfter)||e.call(i,this.ctx,r),$e68ebad69e0ff595$export$40257b1b753712da&&$e68ebad69e0ff595$export$7bf40fdf7bf55821.render(this.ctx,this.project.width,this.project.height,r.scaleX),this.ctx.restore()}setSize(t,e){this.doResize=!0,this.width=t,this.height=e,(0,$VM6dD.css)(this.canvas,{width:this.doFillParent?"100%":this.width+"px",height:this.doFillParent?"100%":this.height+"px"})}setTransform(t){this.transform=(0,$wpIFA._)({},t)}setProject(t){this.project=t}getTransform(){return(0,$wpIFA._)({},this.transform)}setUseNativeResolution(t){this.useNativeResolution=t,this.doResize=!0}getUseNativeResolution(){return this.useNativeResolution}getElement(){return this.canvas}destroy(){$2Eggz.BB.freeCanvas(this.canvas),$74a507c74cfe9692$export$5714e40777c1bcc2.removeIsDarkListener(this.onIsDark),window.removeEventListener("resize",this.resizeListener)}constructor(t){var e;this.doResize=!0,this.onIsDark=()=>{this.pattern=(0,$VM6dD.throwIfNull)(this.ctx.createPattern($2Eggz.BB.createCheckerCanvas(10,$74a507c74cfe9692$export$5714e40777c1bcc2.isDark()),"repeat")),this.render()},this.oldDPR=devicePixelRatio,this.resizeListener=()=>{this.oldDPR=devicePixelRatio},this.width=t.width,this.height=t.height,this.project=t.project,this.useNativeResolution=!!t.useNativeResolution,this.drawBackground=null==(e=t.drawBackground)||e,this.doFillParent=!!t.fillParent,this.renderAfter=t.renderAfter,this.transform=(0,$wpIFA._)({},t.transform),this.resFactor=this.useNativeResolution?devicePixelRatio:1,this.canvas=$2Eggz.BB.canvas(this.width*this.resFactor,this.height*this.resFactor),this.ctx=$2Eggz.BB.ctx(this.canvas),(0,$VM6dD.css)(this.canvas,{width:this.doFillParent?"100%":this.width+"px",height:this.doFillParent?"100%":this.height+"px",display:"block"}),window.addEventListener("resize",this.resizeListener),this.pattern=(0,$VM6dD.throwIfNull)(this.ctx.createPattern($2Eggz.BB.createCheckerCanvas(10,$74a507c74cfe9692$export$5714e40777c1bcc2.isDark()),"repeat")),$74a507c74cfe9692$export$5714e40777c1bcc2.addIsDarkListener(this.onIsDark)}}var $2Eggz=parcelRequire("2Eggz"),$iwR8S=parcelRequire("iwR8S"),$4ae8ffb159df37c1$exports={};$4ae8ffb159df37c1$exports=$parcel$resolve("bReTA");var $c1f95fb9358806e5$exports={};$c1f95fb9358806e5$exports=$parcel$resolve("i3X7V");var $e4b592a73e1920d7$exports={};$e4b592a73e1920d7$exports=$parcel$resolve("fETts");var $071c8859c903033f$exports={};$071c8859c903033f$exports=$parcel$resolve("ksMx1");var $12ab2cee238fdb68$exports={};$12ab2cee238fdb68$exports=$parcel$resolve("hRKJH");var $VbzD9=parcelRequire("VbzD9"),$lEiB9=parcelRequire("lEiB9");function $b18d1bd8e7aad78b$export$8c03162b1a39d183(t,e){let i=Math.log2(t)/Math.abs(e);return i+=e>0?1:-1,Math.pow(2,i=Math.round(i)*Math.abs(e))}$36bbe8d945937d2a$export$48c2d0f2f545ac27="VFEAZq_preview",$36bbe8d945937d2a$export$d7b7311ec04a3e8f="VFEAZq_viewport";var $2WBc7=parcelRequire("2WBc7");function $68a5ab3e745a3a87$export$99c68a89351e15c0(t,e,i,s){let n=$855520c81dfcb96a$export$9b20165a36586806($611d5fdbbcda65d9$export$f672e0b6f7222cd7($a78c550eaaca7cca$export$dcdf75081b88279d(-i,-i),$20520e5c69c4ad5d$export$bb628a54ab399bc9(s/180*Math.PI)),e);return n.x+=t.x,n.y+=t.y,{x:n.x,y:n.y,scale:i,angleDeg:s}}function $bfc75b1b92419309$export$935bc53f7df03c95(t,e){let i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(t)),e);return{viewportP:e,canvasP:i,scale:t.scale,angleDeg:t.angleDeg}}var $2Eggz=parcelRequire("2Eggz");$a40e51dbac8cdac4$export$eea3e4f737fa39e3="uIhb5a_blackPath",$a40e51dbac8cdac4$export$2f48b40a5a83dc1b="uIhb5a_whitePath";var $aXq9D=parcelRequire("aXq9D");function $1d9e27e0466b80f7$export$aa391dbbf8073422(t,e){return t.map(t=>t.map(t=>t.map(t=>Object.values($855520c81dfcb96a$export$9b20165a36586806(e,{x:t[0],y:t[1]})))))}var $fa2cff2ef725812f$exports={};function $bec2c57bfccd422e$export$7ec1a3fdd6e82838(t,e,...i){let s=[];try{s=$fa2cff2ef725812f$exports[t](e,...i)}catch(t){}return s}function $af70c2e1b3c35649$export$f3040a9d9c5d06ba(t){return t.map(t=>t.map(t=>t.map(t=>[Math.round(t[0]+.5)-.5,Math.round(t[1]+.5)-.5])))}!function(t,e){$fa2cff2ef725812f$exports=e()}(0,function(){function t(t,e){var i,s,n,r,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(t){return function(e){return l([t,e])}}function l(r){if(i)throw TypeError("Generator is already executing.");for(;a;)try{if(i=1,s&&(n=2&r[0]?s.return:r[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,r[1])).done)return n;switch(s=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,s=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){a.label=r[1];break}if(6===r[0]&&a.label<n[1]){a.label=n[1],n=r;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(r);break}n[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],s=0}finally{i=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}var e=function(){return function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}}();function i(t,e){return t>e?1:t<e?-1:0}function s(t,i,s){for(var n=new e(null,null),r=n,a=n;;){var o=s(t,i.key);if(o<0){if(null===i.left)break;if(0>s(t,i.left.key)){var l=i.left;if(i.left=l.right,l.right=i,null===(i=l).left)break}a.left=i,a=i,i=i.left}else if(o>0){if(null===i.right)break;if(s(t,i.right.key)>0){var l=i.right;if(i.right=l.left,l.left=i,null===(i=l).right)break}r.right=i,r=i,i=i.right}else break}return r.right=i.left,a.left=i.right,i.left=n.right,i.right=n.left,i}function n(t,i,n,r){var a=new e(t,i);if(null===n)return a.left=a.right=null,a;n=s(t,n,r);var o=r(t,n.key);return o<0?(a.left=n.left,a.right=n,n.left=null):o>=0&&(a.right=n.right,a.left=n,n.right=null),a}function r(t,e,i){var n=null,r=null;if(e){e=s(t,e,i);var a=i(e.key,t);0===a?(n=e.left,r=e.right):a<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function a(t,e,i){return null===e?t:(null===t||((e=s(t.key,e,i)).left=t),e)}function o(t,e,i,s,n){if(t){s(""+e+(i?" ":" ")+n(t)+"\n");var r=e+(i?"    ":"   ");t.left&&o(t.left,r,!1,s,n),t.right&&o(t.right,r,!0,s,n)}}var l=function(){function l(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return l.prototype.insert=function(t,e){return this._size++,this._root=n(t,e,this._root,this._comparator)},l.prototype.add=function(t,i){var n=new e(t,i);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,a=s(t,this._root,r),o=r(t,a.key);return 0===o?this._root=a:(o<0?(n.left=a.left,n.right=a,a.left=null):o>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},l.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},l.prototype._remove=function(t,e,i){var n;return null===e?null:(e=s(t,e,i),0===i(t,e.key))?(null===e.left?n=e.right:(n=s(t,e.left,i)).right=e.right,this._size--,n):e},l.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},l.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var s=i(t,e.key);if(0===s)return e;e=s<0?e.left:e.right}return null},l.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},l.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var s=i(t,e.key);if(0===s)return!0;e=s<0?e.left:e.right}return!1},l.prototype.forEach=function(t,e){for(var i=this._root,s=[],n=!1;!n;)null!==i?(s.push(i),i=i.left):0!==s.length?(i=s.pop(),t.call(e,i),i=i.right):n=!0;return this},l.prototype.range=function(t,e,i,s){for(var n=[],r=this._comparator,a=this._root;0!==n.length||a;)if(a)n.push(a),a=a.left;else{if(r((a=n.pop()).key,e)>0)break;if(r(a.key,t)>=0&&i.call(s,a))return this;a=a.right}return this},l.prototype.keys=function(){var t=[];return this.forEach(function(e){var i=e.key;return t.push(i)}),t},l.prototype.values=function(){var t=[];return this.forEach(function(e){var i=e.data;return t.push(i)}),t},l.prototype.min=function(){return this._root?this.minNode(this._root).key:null},l.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},l.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},l.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},l.prototype.at=function(t){for(var e=this._root,i=!1,s=0,n=[];!i;)if(e)n.push(e),e=e.left;else if(n.length>0){if(e=n.pop(),s===t)return e;s++,e=e.right}else i=!0;return null},l.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var s=this._comparator;e;){var n=s(t.key,e.key);if(0===n)break;n<0?(i=e,e=e.left):e=e.right}return i},l.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var s=this._comparator;e;){var n=s(t.key,e.key);if(0===n)break;n<0?e=e.left:(i=e,e=e.right)}return i},l.prototype.clear=function(){return this._root=null,this._size=0,this},l.prototype.toList=function(){return d(this._root)},l.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var s=t.length,n=this._comparator;if(i&&g(t,e,0,s-1,n),null===this._root)this._root=h(t,e,0,s),this._size=s;else{var r=u(this.toList(),c(t,e),n);s=this._size+s,this._root=p({head:r},0,s)}return this},l.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(l.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),l.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return o(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},l.prototype.update=function(t,e,i){var s=this._comparator,o=r(t,this._root,s),l=o.left,h=o.right;0>s(t,e)?h=n(e,i,h,s):l=n(e,i,l,s),this._root=a(l,h,s)},l.prototype.split=function(t){return r(t,this._root,this._comparator)},l.prototype[Symbol.iterator]=function(){var e,i,s;return t(this,function(t){switch(t.label){case 0:e=this._root,i=[],s=!1,t.label=1;case 1:if(s)return[3,6];if(null===e)return[3,2];return i.push(e),e=e.left,[3,5];case 2:if(0===i.length)return[3,4];return[4,e=i.pop()];case 3:return t.sent(),e=e.right,[3,5];case 4:s=!0,t.label=5;case 5:return[3,1];case 6:return[2]}})},l}();function h(t,i,s,n){var r=n-s;if(r>0){var a=s+Math.floor(r/2),o=new e(t[a],i[a]);return o.left=h(t,i,s,a),o.right=h(t,i,a+1,n),o}return null}function c(t,i){for(var s=new e(null,null),n=s,r=0;r<t.length;r++)n=n.next=new e(t[r],i[r]);return n.next=null,s.next}function d(t){for(var i=t,s=[],n=!1,r=new e(null,null),a=r;!n;)i?(s.push(i),i=i.left):s.length>0?i=(i=a=a.next=s.pop()).right:n=!0;return a.next=null,r.next}function p(t,e,i){var s=i-e;if(s>0){var n=e+Math.floor(s/2),r=p(t,e,n),a=t.head;return a.left=r,t.head=t.head.next,a.right=p(t,n+1,i),a}return null}function u(t,i,s){for(var n=new e(null,null),r=n,a=t,o=i;null!==a&&null!==o;)0>s(a.key,o.key)?(r.next=a,a=a.next):(r.next=o,o=o.next),r=r.next;return null!==a?r.next=a:null!==o&&(r.next=o),n.next}function g(t,e,i,s,n){if(!(i>=s)){for(var r=t[i+s>>1],a=i-1,o=s+1;;){do a++;while(0>n(t[a],r))do o--;while(n(t[o],r)>0)if(a>=o)break;var l=t[a];t[a]=t[o],t[o]=l,l=e[a],e[a]=e[o],e[o]=l}g(t,e,i,o,n),g(t,e,o+1,s,n)}}let m=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,f=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;let i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,s=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:s,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},y=Number.EPSILON;void 0===y&&(y=2220446049250313e-31);let v=y*y,x=(t,e)=>{if(-y<t&&t<y&&-y<e&&e<y)return 0;let i=t-e;return i*i<v*t*e?0:t<e?-1:1};class b{reset(){this.xRounder=new w,this.yRounder=new w}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}constructor(){this.reset()}}class w{round(t){let e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===x(e.key,i.key))return this.tree.remove(t),i.key;let s=this.tree.next(e);return null!==s&&0===x(e.key,s.key)?(this.tree.remove(t),s.key):t}constructor(){this.tree=new l,this.round(0)}}let B=new b,S=0x8000001,C=(3+8881784197001252e-31)*11102230246251565e-32;function E(t,e,i,s,n){let r,a,o,l,h=e[0],c=s[0],d=0,p=0;c>h==c>-h?(r=h,h=e[++d]):(r=c,c=s[++p]);let u=0;if(d<t&&p<i)for(c>h==c>-h?(a=h+r,o=r-(a-h),h=e[++d]):(a=c+r,o=r-(a-c),c=s[++p]),r=a,0!==o&&(n[u++]=o);d<t&&p<i;)c>h==c>-h?(l=(a=r+h)-r,o=r-(a-l)+(h-l),h=e[++d]):(l=(a=r+c)-r,o=r-(a-l)+(c-l),c=s[++p]),r=a,0!==o&&(n[u++]=o);for(;d<t;)l=(a=r+h)-r,o=r-(a-l)+(h-l),h=e[++d],r=a,0!==o&&(n[u++]=o);for(;p<i;)l=(a=r+c)-r,o=r-(a-l)+(c-l),c=s[++p],r=a,0!==o&&(n[u++]=o);return(0!==r||0===u)&&(n[u++]=r),u}function k(t,e){let i=e[0];for(let s=1;s<t;s++)i+=e[s];return i}function I(t){return new Float64Array(t)}let T=(3+17763568394002505e-31)*11102230246251565e-32,M=(2+13322676295501878e-31)*11102230246251565e-32,P=(9+7105427357601002e-30)*11102230246251565e-32*11102230246251565e-32,L=I(4),R=I(8),A=I(12),D=I(16),z=I(4);function _(t,e,i,s,n,r,a){let o,l,h,c,d,p,u,g,m,f,y,v,x,b,w,B,I,T,_=t-n,O=i-n,H=e-r,V=s-r;b=_*V,u=(p=S*_)-(p-_),g=_-u,m=(p=S*V)-(p-V),w=g*(f=V-m)-(b-u*m-g*m-u*f),B=H*O,u=(p=S*H)-(p-H),g=H-u,m=(p=S*O)-(p-O),y=w-(I=g*(f=O-m)-(B-u*m-g*m-u*f)),d=w-y,L[0]=w-(y+d)+(d-I),d=(v=b+y)-b,y=(x=b-(v-d)+(y-d))-B,d=x-y,L[1]=x-(y+d)+(d-B),d=(T=v+y)-v,L[2]=v-(T-d)+(y-d),L[3]=T;let F=k(4,L),U=M*a;if(F>=U||-F>=U||(d=t-_,o=t-(_+d)+(d-n),d=i-O,h=i-(O+d)+(d-n),d=e-H,l=e-(H+d)+(d-r),d=s-V,c=s-(V+d)+(d-r),0===o&&0===l&&0===h&&0===c)||(U=P*a+C*Math.abs(F),(F+=_*c+V*o-(H*h+O*l))>=U||-F>=U))return F;b=o*V,u=(p=S*o)-(p-o),g=o-u,m=(p=S*V)-(p-V),w=g*(f=V-m)-(b-u*m-g*m-u*f),B=l*O,u=(p=S*l)-(p-l),g=l-u,m=(p=S*O)-(p-O),y=w-(I=g*(f=O-m)-(B-u*m-g*m-u*f)),d=w-y,z[0]=w-(y+d)+(d-I),d=(v=b+y)-b,y=(x=b-(v-d)+(y-d))-B,d=x-y,z[1]=x-(y+d)+(d-B),d=(T=v+y)-v,z[2]=v-(T-d)+(y-d),z[3]=T;let j=E(4,L,4,z,R);b=_*c,u=(p=S*_)-(p-_),g=_-u,m=(p=S*c)-(p-c),w=g*(f=c-m)-(b-u*m-g*m-u*f),B=H*h,u=(p=S*H)-(p-H),g=H-u,m=(p=S*h)-(p-h),y=w-(I=g*(f=h-m)-(B-u*m-g*m-u*f)),d=w-y,z[0]=w-(y+d)+(d-I),d=(v=b+y)-b,y=(x=b-(v-d)+(y-d))-B,d=x-y,z[1]=x-(y+d)+(d-B),d=(T=v+y)-v,z[2]=v-(T-d)+(y-d),z[3]=T;let N=E(j,R,4,z,A);b=o*c,u=(p=S*o)-(p-o),g=o-u,m=(p=S*c)-(p-c),w=g*(f=c-m)-(b-u*m-g*m-u*f),B=l*h,u=(p=S*l)-(p-l),g=l-u,m=(p=S*h)-(p-h),y=w-(I=g*(f=h-m)-(B-u*m-g*m-u*f)),d=w-y,z[0]=w-(y+d)+(d-I),d=(v=b+y)-b,y=(x=b-(v-d)+(y-d))-B,d=x-y,z[1]=x-(y+d)+(d-B),d=(T=v+y)-v,z[2]=v-(T-d)+(y-d),z[3]=T;let W=E(N,A,4,z,D);return D[W-1]}function O(t,e,i,s,n,r){let a=(e-r)*(i-n),o=(t-n)*(s-r),l=a-o,h=Math.abs(a+o);return Math.abs(l)>=T*h?l:-_(t,e,i,s,n,r,h)}let H=(t,e)=>t.x*e.y-t.y*e.x,V=(t,e)=>t.x*e.x+t.y*e.y,F=(t,e,i)=>{let s=O(t.x,t.y,e.x,e.y,i.x,i.y);return s>0?-1:+(s<0)},U=t=>Math.sqrt(V(t,t)),j=(t,e,i)=>{let s={x:e.x-t.x,y:e.y-t.y},n={x:i.x-t.x,y:i.y-t.y};return H(n,s)/U(n)/U(s)},N=(t,e,i)=>{let s={x:e.x-t.x,y:e.y-t.y},n={x:i.x-t.x,y:i.y-t.y};return V(n,s)/U(n)/U(s)},W=(t,e,i)=>0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i},X=(t,e,i)=>0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)},Y=(t,e,i,s)=>{if(0===e.x)return X(i,s,t.x);if(0===s.x)return X(t,e,i.x);if(0===e.y)return W(i,s,t.y);if(0===s.y)return W(t,e,i.y);let n=H(e,s);if(0==n)return null;let r={x:i.x-t.x,y:i.y-t.y},a=H(r,e)/n,o=H(r,s)/n;return{x:(t.x+o*e.x+(i.x+a*s.x))/2,y:(t.y+o*e.y+(i.y+a*s.y))/2}};class G{static compare(t,e){let i=G.comparePoints(t.point,e.point);return 0!==i?i:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft)?t.isLeft?1:-1:$.compare(t.segment,e.segment)}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:+(t.y>e.y)}link(t){if(t.point===this.point)throw Error("Tried to link already linked events");let e=t.point.events;for(let t=0,i=e.length;t<i;t++){let i=e[t];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}checkForConsuming(){let t=this.point.events.length;for(let e=0;e<t;e++){let i=this.point.events[e];if(void 0===i.segment.consumedBy)for(let s=e+1;s<t;s++){let t=this.point.events[s];void 0===t.consumedBy&&i.otherSE.point.events===t.otherSE.point.events&&i.segment.consume(t.segment)}}}getAvailableLinkedEvents(){let t=[];for(let e=0,i=this.point.events.length;e<i;e++){let i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){let e=new Map,i=i=>{let s=i.otherSE;e.set(i,{sine:j(this.point,t.point,s.point),cosine:N(this.point,t.point,s.point)})};return(t,s)=>{e.has(t)||i(t),e.has(s)||i(s);let{sine:n,cosine:r}=e.get(t),{sine:a,cosine:o}=e.get(s);return n>=0&&a>=0?r<o?1:r>o?-1:0:n<0&&a<0?r<o?-1:+(r>o):a<n?-1:+(a>n)}}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}}let q=0;class ${static compare(t,e){let i=t.leftSE.point.x,s=e.leftSE.point.x,n=t.rightSE.point.x,r=e.rightSE.point.x;if(r<i)return 1;if(n<s)return -1;let a=t.leftSE.point.y,o=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(i<s){if(o<a&&o<l)return 1;if(o>a&&o>l)return -1;let i=t.comparePoint(e.leftSE.point);if(i<0)return 1;if(i>0)return -1;let s=e.comparePoint(t.rightSE.point);return 0!==s?s:-1}if(i>s){if(a<o&&a<h)return -1;if(a>o&&a>h)return 1;let i=e.comparePoint(t.leftSE.point);if(0!==i)return i;let s=t.comparePoint(e.rightSE.point);return s<0?1:s>0?-1:1}if(a<o)return -1;if(a>o)return 1;if(n<r){let i=e.comparePoint(t.rightSE.point);if(0!==i)return i}if(n>r){let i=t.comparePoint(e.rightSE.point);if(i<0)return 1;if(i>0)return -1}if(n!==r){let t=l-a,e=n-i,c=h-o,d=r-s;if(t>e&&c<d)return 1;if(t<e&&c>d)return -1}return n>r?1:n<r||l<h?-1:l>h?1:t.id<e.id?-1:+(t.id>e.id)}static fromRing(t,e,i){let s,n,r,a=G.comparePoints(t,e);if(a<0)s=t,n=e,r=1;else if(a>0)s=e,n=t,r=-1;else throw Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);return new $(new G(s,!0),new G(n,!1),[i],[r])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;let e=this.leftSE.point,i=this.rightSE.point,s=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;let n=(t.y-e.y)/s.y,r=e.x+n*s.x;if(t.x===r)return 0;let a=(t.x-e.x)/s.x,o=e.y+a*s.y;return t.y===o?0:t.y<o?-1:1}getIntersection(t){let e=this.bbox(),i=t.bbox(),s=f(e,i);if(null===s)return null;let n=this.leftSE.point,r=this.rightSE.point,a=t.leftSE.point,o=t.rightSE.point,l=m(e,a)&&0===this.comparePoint(a),h=m(i,n)&&0===t.comparePoint(n),c=m(e,o)&&0===this.comparePoint(o),d=m(i,r)&&0===t.comparePoint(r);if(h&&l)return d&&!c?r:!d&&c?o:null;if(h)return c&&n.x===o.x&&n.y===o.y?null:n;if(l)return d&&r.x===a.x&&r.y===a.y?null:a;if(d&&c)return null;if(d)return r;if(c)return o;let p=Y(n,this.vector(),a,t.vector());return null!==p&&m(s,p)?B.round(p.x,p.y):null}split(t){let e=[],i=void 0!==t.events,s=new G(t,!0),n=new G(t,!1),r=this.rightSE;this.replaceRightSE(n),e.push(n),e.push(s);let a=new $(s,r,this.rings.slice(),this.windings.slice());return G.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),G.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(s.checkForConsuming(),n.checkForConsuming()),e}swapEvents(){let t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(t){let e=this,i=t;for(;e.consumedBy;)e=e.consumedBy;for(;i.consumedBy;)i=i.consumedBy;let s=$.compare(e,i);if(0!==s){if(s>0){let t=e;e=i,i=t}if(e.prev===i){let t=e;e=i,i=t}for(let t=0,s=i.rings.length;t<s;t++){let s=i.rings[t],n=i.windings[t],r=e.rings.indexOf(s);-1===r?(e.rings.push(s),e.windings.push(n)):e.windings[r]+=n}i.rings=null,i.windings=null,i.consumedBy=e,i.leftSE.consumedBy=e.leftSE,i.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){let t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;let t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};let e=this._afterState.rings,i=this._afterState.windings,s=this._afterState.multiPolys;for(let t=0,s=this.rings.length;t<s;t++){let s=this.rings[t],n=this.windings[t],r=e.indexOf(s);-1===r?(e.push(s),i.push(n)):i[r]+=n}let n=[],r=[];for(let t=0,s=e.length;t<s;t++){if(0===i[t])continue;let s=e[t],a=s.poly;if(-1===r.indexOf(a))if(s.isExterior)n.push(a);else{-1===r.indexOf(a)&&r.push(a);let t=n.indexOf(s.poly);-1!==t&&n.splice(t,1)}}for(let t=0,e=n.length;t<e;t++){let e=n[t].multiPoly;-1===s.indexOf(e)&&s.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;let t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(ta.type){case"union":{let i=0===t.length,s=0===e.length;this._isInResult=i!==s;break}case"intersection":{let i,s;t.length<e.length?(i=t.length,s=e.length):(i=e.length,s=t.length),this._isInResult=s===ta.numMultiPolys&&i<s;break}case"xor":{let i=Math.abs(t.length-e.length);this._isInResult=i%2==1;break}case"difference":{let i=t=>1===t.length&&t[0].isSubject;this._isInResult=i(t)!==i(e);break}default:throw Error(`Unrecognized operation type found ${ta.type}`)}return this._isInResult}constructor(t,e,i,s){this.id=++q,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=s}}class K{getSweepEvents(){let t=[];for(let e=0,i=this.segments.length;e<i;e++){let i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}constructor(t,e,i){if(!Array.isArray(t)||0===t.length||(this.poly=e,this.isExterior=i,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1]))throw Error("Input geometry is not a valid Polygon or MultiPolygon");let s=B.round(t[0][0],t[0][1]);this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};let n=s;for(let e=1,i=t.length;e<i;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");let i=B.round(t[e][0],t[e][1]);(i.x!==n.x||i.y!==n.y)&&(this.segments.push($.fromRing(n,i,this)),i.x<this.bbox.ll.x&&(this.bbox.ll.x=i.x),i.y<this.bbox.ll.y&&(this.bbox.ll.y=i.y),i.x>this.bbox.ur.x&&(this.bbox.ur.x=i.x),i.y>this.bbox.ur.y&&(this.bbox.ur.y=i.y),n=i)}(s.x!==n.x||s.y!==n.y)&&this.segments.push($.fromRing(n,s,this))}}class Z{getSweepEvents(){let t=this.exteriorRing.getSweepEvents();for(let e=0,i=this.interiorRings.length;e<i;e++){let i=this.interiorRings[e].getSweepEvents();for(let e=0,s=i.length;e<s;e++)t.push(i[e])}return t}constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new K(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=t.length;e<i;e++){let i=new K(t[e],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}}class Q{getSweepEvents(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getSweepEvents();for(let e=0,s=i.length;e<s;e++)t.push(i[e])}return t}constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:1/0,y:1/0},ur:{x:-1/0,y:-1/0}};for(let e=0,i=t.length;e<i;e++){let i=new Z(t[e],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}}class J{static factory(t){let e=[];for(let i=0,s=t.length;i<s;i++){let s=t[i];if(!s.isInResult()||s.ringOut)continue;let n=null,r=s.leftSE,a=s.rightSE,o=[r],l=r.point,h=[];for(;n=r,r=a,o.push(r),r.point!==l;)for(;;){let t=r.getAvailableLinkedEvents();if(0===t.length){let t=o[0].point,e=o[o.length-1].point;throw Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){a=t[0].otherSE;break}let i=null;for(let t=0,e=h.length;t<e;t++)if(h[t].point===r.point){i=t;break}if(null!==i){let t=h.splice(i)[0],s=o.splice(t.index);s.unshift(s[0].otherSE),e.push(new J(s.reverse()));continue}h.push({index:o.length,point:r.point});let s=r.getLeftmostComparator(n);a=t.sort(s)[0].otherSE;break}e.push(new J(o))}return e}getGeom(){let t=this.events[0].point,e=[t];for(let i=1,s=this.events.length-1;i<s;i++){let s=this.events[i].point;0!==F(s,t,this.events[i+1].point)&&(e.push(s),t=s)}if(1===e.length)return null;0===F(e[0],t,e[1])&&e.shift(),e.push(e[0]);let i=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:e.length-1,n=this.isExteriorRing()?e.length:-1,r=[];for(let t=s;t!=n;t+=i)r.push([e[t].x,e[t].y]);return r}isExteriorRing(){if(void 0===this._isExteriorRing){let t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,i=this.events.length;e<i;e++){let i=this.events[e];G.compare(t,i)>0&&(t=i)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)if(i.ringOut.enclosingRing()!==e.ringOut)return e.ringOut;else return e.ringOut.enclosingRing();i=(e=i.prevInResult())?e.prevInResult():null}}constructor(t){this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}}class tt{addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){let t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,i=this.interiorRings.length;e<i;e++){let i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}}class te{getGeom(){let t=[];for(let e=0,i=this.polys.length;e<i;e++){let i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}_composePolys(t){let e=[];for(let i=0,s=t.length;i<s;i++){let s=t[i];if(!s.poly)if(s.isExteriorRing())e.push(new tt(s));else{let t=s.enclosingRing();t.poly||e.push(new tt(t)),t.poly.addInterior(s)}}return e}constructor(t){this.rings=t,this.polys=this._composePolys(t)}}class ti{process(t){let e,i,s=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(s),n;let r=t.isLeft?this.tree.add(s):this.tree.find(s);if(!r)throw Error(`Unable to find segment #${s.id} [${s.leftSE.point.x}, ${s.leftSE.point.y}] -> [${s.rightSE.point.x}, ${s.rightSE.point.y}] in SweepLine tree.`);let a=r,o=r;for(;void 0===e;)null===(a=this.tree.prev(a))?e=null:void 0===a.key.consumedBy&&(e=a.key);for(;void 0===i;)null===(o=this.tree.next(o))?i=null:void 0===o.key.consumedBy&&(i=o.key);if(t.isLeft){let r=null;if(e){let t=e.getIntersection(s);if(null!==t&&(s.isAnEndpoint(t)||(r=t),!e.isAnEndpoint(t))){let i=this._splitSafely(e,t);for(let t=0,e=i.length;t<e;t++)n.push(i[t])}}let a=null;if(i){let t=i.getIntersection(s);if(null!==t&&(s.isAnEndpoint(t)||(a=t),!i.isAnEndpoint(t))){let e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}if(null!==r||null!==a){let t=null;t=null===r?a:null===a||0>=G.comparePoints(r,a)?r:a,this.queue.remove(s.rightSE),n.push(s.rightSE);let e=s.split(t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}n.length>0?(this.tree.remove(s),n.push(t)):(this.segments.push(s),s.prev=e)}else{if(e&&i){let t=e.getIntersection(i);if(null!==t){if(!e.isAnEndpoint(t)){let i=this._splitSafely(e,t);for(let t=0,e=i.length;t<e;t++)n.push(i[t])}if(!i.isAnEndpoint(t)){let e=this._splitSafely(i,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}}this.tree.remove(s)}return n}_splitSafely(t,e){this.tree.remove(t);let i=t.rightSE;this.queue.remove(i);let s=t.split(e);return s.push(i),void 0===t.consumedBy&&this.tree.add(t),s}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.compare;this.queue=t,this.tree=new l(e),this.segments=[]}}let ts=1e6,tn=1e6;class tr{run(t,e,i){ta.type=t,B.reset();let s=[new Q(e,!0)];for(let t=0,e=i.length;t<e;t++)s.push(new Q(i[t],!1));if(ta.numMultiPolys=s.length,"difference"===ta.type){let t=s[0],e=1;for(;e<s.length;)null!==f(s[e].bbox,t.bbox)?e++:s.splice(e,1)}if("intersection"===ta.type)for(let t=0,e=s.length;t<e;t++){let e=s[t];for(let i=t+1,n=s.length;i<n;i++)if(null===f(e.bbox,s[i].bbox))return[]}let n=new l(G.compare);for(let t=0,e=s.length;t<e;t++){let e=s[t].getSweepEvents();for(let t=0,i=e.length;t<i;t++)if(n.insert(e[t]),n.size>ts)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let r=new ti(n),a=n.size,o=n.pop();for(;o;){let t=o.key;if(n.size===a){let e=t.segment;throw Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(n.size>ts)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(r.segments.length>tn)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let e=r.process(t);for(let t=0,i=e.length;t<i;t++){let i=e[t];void 0===i.consumedBy&&n.insert(i)}a=n.size,o=n.pop()}return B.reset(),new te(J.factory(r.segments)).getGeom()}}let ta=new tr;return{union:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return ta.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return ta.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return ta.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];return ta.run("difference",t,i)}}});class $af70c2e1b3c35649$export$c61ab90e0d3eb9b1{update(){let t=null===this.renderedSelection?this.selection:this.renderedSelection;if(!t){this.svgPath1.setAttribute("d",""),this.svgPath2.setAttribute("d","");return}let e=$1d9e27e0466b80f7$export$aa391dbbf8073422(t,this.viewportMat),i=10,s=$bec2c57bfccd422e$export$7ec1a3fdd6e82838("intersection",e,[[[-10,-10],[this.viewportWidth+i,-i],[this.viewportWidth+i,this.viewportHeight+i],[-i,this.viewportHeight+i],[-i,-i]]]),n=(0,$aXq9D.getSvgPathD)($af70c2e1b3c35649$export$f3040a9d9c5d06ba(s));this.svgPath1.setAttribute("d",n),this.svgPath2.setAttribute("d",n)}setTransform(t){this.viewportTransform=t,this.viewportMat=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),this.update()}setSelection(t){this.selection!==t&&(this.selection=t,null===this.renderedSelection&&this.update())}setRenderedSelection(t,e){this.renderedSelection!==t&&(this.renderedSelection=t,this.update())}clearRenderedSelection(t){this.renderedSelection=null,t&&this.update()}setSize(t,e){this.viewportWidth=t,this.viewportHeight=e}getElement(){return this.rootEl}destroy(){this.rootEl.remove(),this.selection=void 0}constructor(t){this.renderedSelection=null,this.viewportTransform=t.transform,this.viewportMat=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),this.selection=t.selection,this.viewportWidth=t.width,this.viewportHeight=t.height,this.svgPath1=$2Eggz.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke"}),this.svgPath1.classList.add($a40e51dbac8cdac4$export$2f48b40a5a83dc1b),this.svgPath2=$2Eggz.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke"}),this.svgPath2.classList.add($a40e51dbac8cdac4$export$eea3e4f737fa39e3),this.rootEl=$2Eggz.BB.createSvg({elementType:"g"}),this.rootEl.append(this.svgPath1,this.svgPath2)}}var $VM6dD=parcelRequire("VM6dD");let $324add89932145ee$var$DEFAULT_PADDING=10;class $324add89932145ee$export$133773870222880f{requestRerender(){this.doRender=!0}resetOrZoom(t,e){if(this.isReset){this.isReset=!1;let i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewport.getTransform())),{x:t,y:e});this.viewport.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},i,1,0)),this.requestRerender()}else this.reset()}reset(){let t=$2Eggz.BB.fitInto(this.project.width,this.project.height,this.width-2*this.padding,this.height-2*this.padding).width/this.project.width;this.viewport.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},t,0)),this.isReset=!0,this.requestRerender()}transformCanvas(t){if("translate"===t.type){let e=this.viewport.getTransform();if(0===t.x&&0===t.y)return;this.viewport.setTransform((0,$9FMZM._)((0,$wpIFA._)({},e),{x:e.x+t.x,y:e.y+t.y}))}else if("zoom"===t.type){var e,i;let s=this.viewport.getTransform(),n=this.viewport.getElement().getBoundingClientRect();t.vX=null!=(e=t.vX)?e:n.width/2,t.vY=null!=(i=t.vY)?i:n.height/2;let r=$bfc75b1b92419309$export$935bc53f7df03c95(s,{x:t.vX,y:t.vY});r.scale*=t.fac,this.viewport.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(r.viewportP,r.canvasP,r.scale,r.angleDeg))}this.isReset=!1,this.requestRerender()}render(){this.requestRerender()}setTransform(t){this.viewport.setTransform(t),this.requestRerender(),this.isReset=!1}getTransform(){return this.viewport.getTransform()}onPointer(t){this.pointerChain.chainIn(t)}getElement(){return this.rootEl}destroy(){var t;void 0!==this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.viewport.destroy(),this.viewportPointerListener.destroy(),this.rootEl.remove(),this.modeToggle&&this.modeToggle.destroy(),null==(t=this.selectionRenderer)||t.destroy()}constructor(t){var e;let i;this.isReset=!0,this.doRender=!1,this.lastEmittedTransform={x:0,y:0,scale:0,angleDeg:0},this.renderLoop=()=>{if(this.animationFrameId=requestAnimationFrame(this.renderLoop),this.doRender){var t;this.doRender=!1,this.viewport.render();let e=this.viewport.getTransform();null==(t=this.selectionRenderer)||t.setTransform(e),this.onTransformChange&&JSON.stringify(this.lastEmittedTransform)!==JSON.stringify(e)&&(this.onTransformChange(e),this.lastEmittedTransform=e)}},this.onWheel=t=>{let e=this.viewport.getElement().getBoundingClientRect(),i=t.pageX-e.x,s=t.pageY-e.y,n=this.viewport.getTransform().scale,r=$b18d1bd8e7aad78b$export$8c03162b1a39d183(n,-t.deltaY/2);this.transformCanvas({type:"zoom",vX:i,vY:s,fac:r/n})},this.width=t.width,this.height=t.height,this.project=t.project,this.onTransformChange=t.onTransformChange,this.padding=null!=(e=t.padding)?e:$324add89932145ee$var$DEFAULT_PADDING;let s=$2Eggz.BB.fitInto(this.project.width,this.project.height,this.width-2*this.padding,this.height-2*this.padding).width/this.project.width;this.viewport=new $0ca7fca685ce788f$export$a140ed60c2ca052c({width:this.width,height:this.height,transform:$68a5ab3e745a3a87$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},s,0),project:this.project,useNativeResolution:!1,drawBackground:!0});let n=new(0,$lEiB9.DoubleTapper)({onDoubleTap:t=>{let e=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewport.getTransform()),i=$855520c81dfcb96a$export$9b20165a36586806(e,{x:0,y:0}),s=$855520c81dfcb96a$export$9b20165a36586806(e,{x:this.project.width,y:this.project.height}),n=$2Eggz.BB.isInsideRect({x:t.relX,y:t.relY},{x:i.x,y:i.y,width:s.x-i.x,height:s.y-i.y});(!this.isReset||n)&&this.resetOrZoom(t.relX,t.relY)},isInstant:!0}),r=new(0,$2WBc7.PinchZoomer)({onPinch:t=>{if("move"===t.type){i||(i=this.viewport.getTransform());let e=$bfc75b1b92419309$export$935bc53f7df03c95(i,{x:t.downRelX,y:t.downRelY});e.scale*=t.scale,e.viewportP.x+=t.relX-t.downRelX,e.viewportP.y+=t.relY-t.downRelY,this.viewport.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(e.viewportP,e.canvasP,e.scale,e.angleDeg)),this.requestRerender(),this.isReset=!1}else"end"===t.type&&(i=void 0)}});this.pointerChain=new(0,$VbzD9.EventChain)({chainArr:[r,n]}),this.pointerChain.setChainOut(t=>{t.button&&["left","middle"].includes(t.button)&&this.transformCanvas({type:"translate",x:t.dX,y:t.dY})}),this.viewport.getElement().classList.add($36bbe8d945937d2a$export$d7b7311ec04a3e8f),(0,$VM6dD.css)(this.viewport.getElement(),{userSelect:"none",touchAction:"none"}),this.viewport.getElement().addEventListener("touchend",t=>(t.preventDefault(),!1)),this.viewport.getElement().addEventListener("contextmenu",t=>(t.preventDefault(),!1)),this.viewport.getElement().addEventListener("dragstart",t=>(t.preventDefault(),!1)),this.viewportPointerListener=new(0,$iwR8S.PointerListener)({target:this.viewport.getElement(),onPointer:t=>{this.pointerChain.chainIn(t)},onWheel:this.onWheel,maxPointers:2}),this.viewport.getElement().addEventListener("wheel",t=>{t.preventDefault()});let a=$2Eggz.BB.createSvg({elementType:"svg"});(0,$VM6dD.css)(a,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",pointerEvents:"none"}),t.selection&&(this.selectionRenderer=new $af70c2e1b3c35649$export$c61ab90e0d3eb9b1({transform:this.lastEmittedTransform,selection:t.selection,width:this.width,height:this.height}),a.append(this.selectionRenderer.getElement())),t.hasEditMode&&(this.modeToggle=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:["edit","hand"].map(e=>{var i;let s=$2Eggz.BB.el({className:"dark-invert",css:{width:"28px",height:"28px",backgroundSize:"contain",margin:"5px",backgroundImage:`url(${"edit"===e?null!=(i=t.editIcon)?i:$parcel$interopDefault($12ab2cee238fdb68$exports):$parcel$interopDefault($071c8859c903033f$exports)})`,backgroundPosition:"center",backgroundRepeat:"no-repeat"}});return{id:e,label:s,title:"edit"===e?$63d0b335c576c718$export$ce37e184d908d785("tab-edit"):$63d0b335c576c718$export$ce37e184d908d785("tool-hand")}}),initId:"edit",onChange:e=>{t.onModeChange&&t.onModeChange(e)}})),this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072({className:!1===t.hasBorder?void 0:$36bbe8d945937d2a$export$48c2d0f2f545ac27,css:{position:"relative",zIndex:"0"}},[this.viewport.getElement(),a,...this.modeToggle?[$934e5f47c3374e21$export$db3b6bfb95261072(",pos-absolute,left-5,top-5,z-1,pointer-auto",[this.modeToggle.getElement()])]:[],$934e5f47c3374e21$export$db3b6bfb95261072(",pos-absolute,right-5,bottom-5,flex,flexCol,gap-5,z-1,pointer-auto",[$934e5f47c3374e21$export$db3b6bfb95261072({tagName:"button",title:$63d0b335c576c718$export$ce37e184d908d785("hand-reset"),onClick:()=>{this.reset()},content:`<img alt="reset" height="20" src="${$parcel$interopDefault($e4b592a73e1920d7$exports)}">`,noRef:!0}),$934e5f47c3374e21$export$db3b6bfb95261072({tagName:"button",title:$63d0b335c576c718$export$ce37e184d908d785("zoom-in"),onClick:()=>{let t=this.viewport.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,1);this.transformCanvas({type:"zoom",fac:e/t})},content:`<img alt="zoom-in" height="20" src="${$parcel$interopDefault($4ae8ffb159df37c1$exports)}">`,noRef:!0}),$934e5f47c3374e21$export$db3b6bfb95261072({tagName:"button",title:$63d0b335c576c718$export$ce37e184d908d785("zoom-out"),onClick:()=>{let t=this.viewport.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,-1);this.transformCanvas({type:"zoom",fac:e/t})},content:`<img alt="zoom-out" height="20" src="${$parcel$interopDefault($c1f95fb9358806e5$exports)}">`,noRef:!0})])]),this.renderLoop()}}var $8cWis=parcelRequire("8cWis"),$2d3a7d1efb01840c$exports={};$2d3a7d1efb01840c$exports=$parcel$resolve("25BJB");var $VbzD9=parcelRequire("VbzD9"),$957vH=parcelRequire("957vH"),$ao0qX=parcelRequire("ao0qX"),$VM6dD=parcelRequire("VM6dD");class $c5a9090dbc3ef918$export$40175a5948a88a57{resetCrop(){this.cropRect={x:0,y:0,width:this.canvas.width,height:this.canvas.height}}getViewportSelectionRect(){let t=this.preview.getTransform(),e=$855520c81dfcb96a$export$9b20165a36586806($00bfc001d6438b5d$export$ad1d215dd03fe75a(t),this.cropRect);return{x:e.x,y:e.y,width:this.cropRect.width*t.scale,height:this.cropRect.height*t.scale}}async updateCroppedCanvas(){var t,e;this.croppedCanvas.width=Math.round(this.cropRect.width),this.croppedCanvas.height=Math.round(this.cropRect.height),$2Eggz.BB.ctx(this.croppedCanvas).drawImage(this.canvas,Math.round(-this.cropRect.x),Math.round(-this.cropRect.y));let i=await (0,$ao0qX.canvasToBlob)(this.croppedCanvas,"image/png");this.croppedBlob=i,""!==this.croppedObjectUrl&&URL.revokeObjectURL(this.croppedObjectUrl),this.croppedObjectUrl=URL.createObjectURL(i),this.croppedImageElement&&(this.croppedImageElement.src=this.croppedObjectUrl),null==(t=(e=this).onChange)||t.call(e,this.croppedCanvas.width,this.croppedCanvas.height)}updateSelectionRect(){var t,e;let i=this.getViewportSelectionRect();(0,$VM6dD.css)(this.selectionRectEl,{left:i.x+"px",top:i.y+"px",width:i.width+"px",height:i.height+"px",display:this.isReset()?"none":""}),null==(t=(e=this).onChange)||t.call(e,Math.round(this.cropRect.width),Math.round(this.cropRect.height))}isReset(){return 0===this.cropRect.x&&0===this.cropRect.y&&this.cropRect.width===this.canvas.width&&this.cropRect.height===this.canvas.height}getElement(){return this.rootEl}getCropRect(){return $2Eggz.BB.copyObj(this.cropRect)}getCroppedCanvas(){return this.croppedCanvas}getCroppedBlob(){return this.croppedBlob}setCanvas(t){this.canvas=t,this.previewLayer.image=t,this.updateCroppedCanvas(),this.preview.render()}destroy(){this.croppedImageElement&&(this.croppedImageElement.src=""),URL.revokeObjectURL(this.croppedObjectUrl),this.rootEl.remove(),this.eventTarget.style.removeProperty("width"),this.eventTarget.style.removeProperty("height"),this.keyListener.destroy(),this.pointerListener.destroy(),this.preview.destroy()}constructor(t){let e,i;this.cropRect={x:0,y:0,width:0,height:0},this.mode="edit",this.rootEl=$2Eggz.BB.el({className:"kl-edit-crop-preview",css:{position:"relative",height:t.height+"px",width:t.width+"px",overflow:"hidden"}}),t.onChange&&(this.onChange=t.onChange),this.canvas=t.canvas,t.init?this.cropRect=t.init:this.resetCrop();let s=t=>$2Eggz.BB.isInsideRect(t,this.getViewportSelectionRect());this.croppedCanvas=$2Eggz.BB.canvas(),this.croppedBlob={},this.croppedObjectUrl="",this.eventTarget=this.croppedCanvas,t.enableRightClickCopy&&(this.croppedImageElement=new Image,this.eventTarget=this.croppedImageElement),(0,$VM6dD.css)(this.eventTarget,{height:t.height+"px",width:t.width+"px"}),this.rootEl.append(this.eventTarget),this.updateCroppedCanvas(),this.previewLayer={image:t.canvas,opacity:1,isVisible:!0,mixModeStr:"source-over",hasClipping:!1},this.preview=new $324add89932145ee$export$133773870222880f({width:t.width,height:t.height-2,project:{width:t.canvas.width,height:t.canvas.height,layers:[this.previewLayer]},hasEditMode:!0,onModeChange:t=>{this.mode=t,this.preview.getElement().style.pointerEvents="edit"===t?"none":"",this.rootEl.title="edit"===t?$63d0b335c576c718$export$ce37e184d908d785("crop-drag-to-crop"):""},onTransformChange:()=>this.updateSelectionRect(),padding:20,hasBorder:!1,editIcon:$parcel$interopDefault($2d3a7d1efb01840c$exports)}),(0,$VM6dD.css)(this.preview.getElement(),{position:"absolute",left:"0",top:"0",overflow:"hidden",pointerEvents:"none"}),this.preview.render(),this.rootEl.append(this.preview.getElement()),this.selectionRectEl=$2Eggz.BB.el({parent:this.preview.getElement(),className:"kl-edit-crop-preview__sel"}),this.updateSelectionRect();let n=(t,e)=>{let i=$077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.preview.getTransform())),s={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y)},n={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},r=$855520c81dfcb96a$export$9b20165a36586806(i,s),a=$855520c81dfcb96a$export$9b20165a36586806(i,n);return r.x=(0,$8cWis.clamp)(Math.floor(r.x),0,this.canvas.width),r.y=(0,$8cWis.clamp)(Math.floor(r.y),0,this.canvas.height),a.x=(0,$8cWis.clamp)(Math.ceil(a.x),0,this.canvas.width),a.y=(0,$8cWis.clamp)(Math.ceil(a.y),0,this.canvas.height),{x:r.x,y:r.y,width:a.x-r.x,height:a.y-r.y}},r=null,a=!1,o=!1,l=new(0,$VbzD9.EventChain)({chainArr:[new(0,$957vH.OnePointerLimiter)]});l.setChainOut(t=>{if("pointerdown"===t.type&&"left"===t.button)t.eventPreventDefault(),a=!0,e={x:t.relX,y:t.relY},!this.isReset()&&s(e)?r={x:this.cropRect.x,y:this.cropRect.y,width:this.cropRect.width,height:this.cropRect.height}:this.cropRect=n(e,e);else if("pointermove"===t.type&&"left"===t.button){if(t.eventPreventDefault(),o=!0,r){let i=this.preview.getTransform();this.cropRect.x=r.x+Math.round((t.relX-e.x)/i.scale),this.cropRect.y=r.y+Math.round((t.relY-e.y)/i.scale),this.cropRect.x=$2Eggz.BB.clamp(this.cropRect.x,0,this.canvas.width-this.cropRect.width),this.cropRect.y=$2Eggz.BB.clamp(this.cropRect.y,0,this.canvas.height-this.cropRect.height)}else this.cropRect=n(e,{x:t.relX,y:t.relY});this.updateSelectionRect()}else"pointerup"===t.type&&e&&(t.eventPreventDefault(),a=!1,r=null,e=null,0!==this.cropRect.width&&0!==this.cropRect.height&&o||(this.resetCrop(),this.updateSelectionRect()),o=!1,i=setTimeout(()=>this.updateCroppedCanvas(),1))}),this.pointerListener=new $2Eggz.BB.PointerListener({target:this.eventTarget,fixScribble:!0,onWheel:t=>{this.preview.onWheel(t)},onPointer:t=>{if("hand"===this.mode){t.eventPreventDefault(),this.preview.onPointer(t);return}l.chainIn(t)},maxPointers:2}),this.keyListener=new $2Eggz.BB.KeyListener({onDown:(t,e)=>{if(a)return;let s=!1,n=Math.max(1,1/this.preview.getTransform().scale),r=this.keyListener.isPressed("shift");"left"===t&&(r?this.cropRect.width=$2Eggz.BB.clamp(this.cropRect.width-n,1,this.canvas.width-this.cropRect.x):this.cropRect.x=$2Eggz.BB.clamp(this.cropRect.x-n,0,this.canvas.width-this.cropRect.width),s=!0),"right"===t&&(r?this.cropRect.width=$2Eggz.BB.clamp(this.cropRect.width+n,1,this.canvas.width-this.cropRect.x):this.cropRect.x=$2Eggz.BB.clamp(this.cropRect.x+n,0,this.canvas.width-this.cropRect.width),s=!0),"up"===t&&(r?this.cropRect.height=$2Eggz.BB.clamp(this.cropRect.height-n,1,this.canvas.height-this.cropRect.y):this.cropRect.y=$2Eggz.BB.clamp(this.cropRect.y-n,0,this.canvas.height-this.cropRect.height),s=!0),"down"===t&&(r?this.cropRect.height=$2Eggz.BB.clamp(this.cropRect.height+n,1,this.canvas.height-this.cropRect.y):this.cropRect.y=$2Eggz.BB.clamp(this.cropRect.y+n,0,this.canvas.height-this.cropRect.height),s=!0),s&&(e.preventDefault(),this.updateSelectionRect(),clearTimeout(i),i=setTimeout(()=>this.updateCroppedCanvas(),100))}})}}var $2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis");function $b6390a4afb7d8067$export$a04a50ae6d6450f8(t){let e,i,s,n;if(t.forEach(t=>{t.forEach(t=>{t.forEach(t=>{e=void 0===e?t[0]:Math.min(e,t[0]),i=void 0===i?t[1]:Math.min(i,t[1]),s=void 0===s?t[0]:Math.max(s,t[0]),n=void 0===n?t[1]:Math.max(n,t[1])})})}),void 0===e||void 0===i||void 0===s||void 0===n)throw"empty poly";return{x1:e,y1:i,x2:s,y2:n}}var $VM6dD=parcelRequire("VM6dD");let $5e9fef22bb47992b$var$maskSelection=!1;function $5e9fef22bb47992b$export$32b89bc9bb92706a(t,e,i,s,n,r=!0,a){let o,l,h=!1;try{h=!!ClipboardItem}catch(t){}let c=document.createElement("div"),d=window.innerWidth<550||window.innerHeight<550,p=a?new $213947897b67ec3a$export$48513f6b9f8ce62d({init:$5e9fef22bb47992b$var$maskSelection,label:$63d0b335c576c718$export$ce37e184d908d785("cropcopy-mask"),name:"check-mask-selection",css:{width:"fit-content"},callback:t=>{$5e9fef22bb47992b$var$maskSelection=t,m.setCanvas(e(t))}}):void 0,u=$2Eggz.BB.el({content:[null==p?void 0:p.getElement(),$63d0b335c576c718$export$ce37e184d908d785("crop-drag-to-crop")+(h?"":"<br>"+$63d0b335c576c718$export$ce37e184d908d785("cropcopy-click-hold"))],css:{textAlign:"center"}});c.append(u);let g=e($5e9fef22bb47992b$var$maskSelection);if(a){let t=$b6390a4afb7d8067$export$a04a50ae6d6450f8(a),e=(0,$8cWis.intBoundsWithinArea)(t,g.width,g.height);o=e?(0,$8cWis.boundsToRect)(e):void 0}let m=new $c5a9090dbc3ef918$export$40175a5948a88a57({width:d?340:540,height:d?300:350,canvas:g,enableRightClickCopy:!0,init:o});async function f(){try{let t=m.getCroppedBlob();await navigator.clipboard.write([new ClipboardItem({[t.type]:t})]),setTimeout(function(){s.out($63d0b335c576c718$export$ce37e184d908d785("cropcopy-copied"),!0)},200)}catch(t){console.error(t.name,t.message);return}}(0,$VM6dD.css)(m.getElement(),{marginTop:"10px",marginLeft:"-20px"}),c.append(m.getElement());let y=new $2Eggz.BB.KeyListener({onDown:function(t,e,i){["ctrl+c","cmd+c"].includes(i)&&(f(),l&&l())}});function v(){r&&(null==l||l())}window.addEventListener("blur",v);let x=[];h&&x.push($63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-copy")),n&&x.push($63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-crop")),x.push("Cancel"),$2016c314bff36ab9$export$d7e8d4d4450c819c({target:t,message:"<b>"+(n?`${$63d0b335c576c718$export$ce37e184d908d785("cropcopy-title-copy")} / ${$63d0b335c576c718$export$ce37e184d908d785("cropcopy-title-crop")}`:`${$63d0b335c576c718$export$ce37e184d908d785("cropcopy-title-copy")}`)+"</b>",div:c,style:d?{}:{width:"540px"},buttons:x,primaries:[$63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-copy")],callback:function(t){if(t===$63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-copy"))f();else if(t===$63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-crop")){let t=m.getCropRect();i({left:Math.round(-t.x),right:Math.round(t.x+t.width-g.width),top:Math.round(-t.y),bottom:Math.round(t.y+t.height-g.height)})}window.removeEventListener("blur",v),$2Eggz.BB.freeCanvas(m.getCroppedCanvas()),m.destroy(),y.destroy()},clickOnEnter:$63d0b335c576c718$export$ce37e184d908d785("cropcopy-btn-copy"),closeFunc:function(t){l=t}})}var $2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz");function $469fa98e1403db53$var$fillRect(t,e,i,s,n,r){for(let a=i;a<=n;a++)for(let i=s;i<=r;i++)255!==t[i*e+a]&&(t[i*e+a]=254)}function $469fa98e1403db53$var$toleranceTest(t,e,i,s,n,r,a){return(t[4*a]-e)**2<=r&&(t[4*a+1]-i)**2<=r&&(t[4*a+2]-s)**2<=r&&(t[4*a+3]-n)**2<=r}function $469fa98e1403db53$var$selectionMaskTest(t,e){return!t||!!t[e]}function $469fa98e1403db53$var$floodFill(t,e,i,s,n,r,a,o,l,h){let c,d,p,u,g,m,f,y,v,x,b,w,B=t[(a*s+r)*4],S=t[(a*s+r)*4+1],C=t[(a*s+r)*4+2],E=t[(a*s+r)*4+3],k=new DataView(t.buffer),I=k.getUint32((a*s+r)*4,!0),T=o**2,M={x1:r,y1:a,x2:r,y2:a};if(h){let l,h,c,d,p=[];for(p.push(a*s+r),i[a*s+r]=255;p.length;)d=Math.floor((l=p.pop())/s),(c=l%s)>0&&255!==i[h=l-1]&&$469fa98e1403db53$var$selectionMaskTest(e,h)&&(k.getUint32(4*h,!0)===I||o>0&&$469fa98e1403db53$var$toleranceTest(t,B,S,C,E,T,h))&&(M.x1=Math.min(M.x1,c-1),i[h]=255,p.push(h)),c<s-1&&255!==i[h=l+1]&&$469fa98e1403db53$var$selectionMaskTest(e,h)&&(k.getUint32(4*h,!0)===I||o>0&&$469fa98e1403db53$var$toleranceTest(t,B,S,C,E,T,h))&&(M.x2=Math.max(M.x2,c+1),i[h]=255,p.push(h)),d>0&&255!==i[h=l-s]&&$469fa98e1403db53$var$selectionMaskTest(e,h)&&(k.getUint32(4*h,!0)===I||o>0&&$469fa98e1403db53$var$toleranceTest(t,B,S,C,E,T,h))&&(M.y1=Math.min(M.y1,d-1),i[h]=255,p.push(h)),d<n-1&&255!==i[h=l+s]&&$469fa98e1403db53$var$selectionMaskTest(e,h)&&(k.getUint32(4*h,!0)===I||o>0&&$469fa98e1403db53$var$toleranceTest(t,B,S,C,E,T,h))&&(M.y2=Math.max(M.y2,d+1),i[h]=255,p.push(h))}else for(let r=0,a=0;r<n;r++)for(let n=0;n<s;n++,a++)$469fa98e1403db53$var$selectionMaskTest(e,a)&&(k.getUint32(4*a,!0)===I||o>0&&$469fa98e1403db53$var$toleranceTest(t,B,S,C,E,T,a))&&(i[a]=255,n<M.x1&&(M.x1=n),r<M.y1&&(M.y1=r),n>M.x2&&(M.x2=n),r>M.y2&&(M.y2=r));if(0===l)return M;for(let t=M.x1;t<=M.x2;t++)for(let e=M.y1;e<=M.y2;e++)255===i[e*s+t]&&(c=t,d=t,p=e,u=e,g=255!==i[e*s+t-1],m=255!==i[(e-1)*s+t-1],f=255!==i[(e-1)*s+t],y=255!==i[(e-1)*s+t+1],v=255!==i[e*s+t+1],x=255!==i[(e+1)*s+t+1],b=255!==i[(e+1)*s+t],w=255!==i[(e+1)*s+t-1],g&&(c=t-l),g&&m&&f&&(c=t-l,p=e-l),f&&(p=Math.min(p,e-l)),f&&y&&v&&(p=Math.min(p,e-l),d=t+l),v&&(d=Math.max(d,t+l)),v&&x&&b&&(d=Math.max(d,t+l),u=Math.max(u,e+l)),b&&(u=Math.max(u,e+l)),b&&w&&g&&(c=Math.min(c,t-l),u=Math.max(u,e+l)),(g||m||f||y||v||x||b||w)&&$469fa98e1403db53$var$fillRect(i,s,Math.max(0,c),Math.max(0,p),Math.min(s-1,d),Math.min(n-1,u)));for(let t=0;t<s*n;t++)254===i[t]&&(i[t]=255);return M.x1-=l,M.y1-=l,M.x2+=l,M.y2+=l,M}function $469fa98e1403db53$export$13d50f258a8034f(t,e,i,s,n,r,a,o,l){n=Math.round(n),r=Math.round(r);let h=new Uint8Array(new ArrayBuffer(i*s)),c=$469fa98e1403db53$var$floodFill(t,e,h,i,s,n,r,a,o,l);return{data:h,bounds:c}}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz");function $bc9f0500a48e5dd5$export$7efa1f930df882cc(t,e){let i=$855520c81dfcb96a$export$9b20165a36586806(e,{x:t.x1,y:t.y1}),s=$855520c81dfcb96a$export$9b20165a36586806(e,{x:t.x2,y:t.y1}),n=$855520c81dfcb96a$export$9b20165a36586806(e,{x:t.x2,y:t.y2}),r=$855520c81dfcb96a$export$9b20165a36586806(e,{x:t.x1,y:t.y2});return{x1:Math.min(i.x,s.x,n.x,r.x),y1:Math.min(i.y,s.y,n.y,r.y),x2:Math.max(i.x,s.x,n.x,r.x),y2:Math.max(i.y,s.y,n.y,r.y)}}class $583d130d11db85ad$export$27550cc14d7ae85a{onDown(t,e,i){this.downX=t,this.downY=e,this.downAngleRad=i}onMove(t,e){this.onShape(!1,this.downX,this.downY,t,e,this.downAngleRad)}onUp(t,e){this.onShape(!0,this.downX,this.downY,t,e,this.downAngleRad)}constructor(t){this.downX=0,this.downY=0,this.downAngleRad=0,this.onShape=t.onShape}}function $583d130d11db85ad$export$71b514a25c47df50(t,e,i){e=(0,$wpIFA._)({angleRad:0,isOutwards:!1,opacity:1,isEraser:!1,doLockAlpha:!1},$2Eggz.BB.copyObj(e));let s={x1:0,y1:0,x2:0,y2:0};if(["rect","ellipse","line"].includes(e.type)){let n,r;if(void 0===e.angleRad)throw Error("angleRad undefined");let a=void 0===e.lineWidth?-1:Math.round(e.lineWidth),o=180*e.angleRad/Math.PI;if(!e.isEraser&&void 0===e.fillRgb&&void 0===e.strokeRgb)throw Error("fillRgb and strokeRgb undefined");let l=e.isEraser?{r:255,g:255,b:255}:e.fillRgb?e.fillRgb:e.strokeRgb;t.save(),i&&t.clip(i),e.opacity&&(t.globalAlpha=e.opacity),e.isEraser&&(t.globalCompositeOperation="destination-out"),e.doLockAlpha&&(t.globalCompositeOperation="source-atop");let h=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($20520e5c69c4ad5d$export$bb628a54ab399bc9(-e.angleRad));t.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(h)),e.fillRgb?t.fillStyle=$2Eggz.BB.ColorConverter.toRgbStr(l):e.strokeRgb&&(t.strokeStyle=$2Eggz.BB.ColorConverter.toRgbStr(l),t.lineWidth=a);let c=e.x1,d=e.y1,p=e.x2,u=e.y2;if(e.isAngleSnap){let t=$2Eggz.BB.rotate(c,d,e.angleRad/Math.PI*180),i=$2Eggz.BB.rotate(p,u,e.angleRad/Math.PI*180),s=$2Eggz.BB.pointsToAngleDeg(t,i)+90,n=45*Math.round(s/45),r=$2Eggz.BB.rotateAround({x:c,y:d},{x:p,y:u},n-s);p=r.x,u=r.y,(o+n)%90==0&&(Math.round((o-n)/90)%2==0?p=c:u=d)}let g=c,m=d,f=p-c,y=u-d;if("line"!==e.type&&e.isFixedRatio){let t=$2Eggz.BB.rotate(e.x1,e.y1,e.angleRad/Math.PI*180),i=$2Eggz.BB.rotate(e.x2,e.y2,e.angleRad/Math.PI*180),s=t.x,n=t.y,r=i.x-t.x,a=i.y-t.y;Math.abs(r)<Math.abs(a)?a=Math.abs(r)*(a<0?-1:1):r=Math.abs(a)*(r<0?-1:1),i.x=s+r,i.y=n+a,t=$2Eggz.BB.rotate(t.x,t.y,-e.angleRad/Math.PI*180),i=$2Eggz.BB.rotate(i.x,i.y,-e.angleRad/Math.PI*180),c=t.x,d=t.y,p=i.x,u=i.y,g=c,m=d,f=p-c,y=u-d}if(e.isOutwards&&(g-=f,m-=y,f*=2,y*=2,c=g,d=m,p=g+f,u=m+y),"line"===e.type){let i=Math.round(c),o=Math.round(d),l=Math.round(p),h=Math.round(u),g=Math.floor(c),m=Math.floor(d),f=Math.floor(p),y=Math.floor(u);a%2==0?o===h?(n={x:g,y:o},r={x:f,y:h},g<f?r.x+=1:n.x+=1):i===l?(n={x:i,y:m},r={x:l,y:y},m<y?r.y+=1:n.y+=1):(n={x:c,y:d},r={x:p,y:u}):(n={x:g,y:m},r={x:f,y:y},m===y?(g<f?r.x+=1:n.x+=1,n.y+=.5,r.y+=.5):g===f?(m<y?r.y+=1:n.y+=1,n.x+=.5,r.x+=.5):(n.x=c,n.y=d,r.x=p,r.y=u)),s={x1:Math.min(n.x,r.x)-a/2,y1:Math.min(n.y,r.y)-a/2,x2:Math.max(n.x,r.x)+a/2,y2:Math.max(n.y,r.y)+a/2},n=$2Eggz.BB.rotate(n.x,n.y,e.angleRad/Math.PI*180),r=$2Eggz.BB.rotate(r.x,r.y,e.angleRad/Math.PI*180),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),t.stroke()}else if("rect"===e.type){let i=Math.floor(c),l=Math.floor(d),g=Math.floor(p),m=Math.floor(u);o%90==0?e.fillRgb?(c%1==0&&(c+=1),d%1==0&&(d+=1),p%1==0&&(p+=1),u%1==0&&(u+=1),n={x:c<p?i:g,y:d<u?l:m},(r={x:Math.ceil((c<p?p:c)-n.x),y:Math.ceil((d<u?u:d)-n.y)}).x=n.x+r.x,r.y=n.y+r.y):a%2==0?(n={x:i,y:l},r={x:g,y:m}):(n={x:i+.5,y:l+.5},r={x:g+.5,y:m+.5}):(n={x:c,y:d},r={x:p,y:u}),n=$2Eggz.BB.rotate(n.x,n.y,e.angleRad/Math.PI*180),r=$2Eggz.BB.rotate(r.x,r.y,e.angleRad/Math.PI*180);let f={x:n.x,y:n.y,width:r.x-n.x,height:r.y-n.y},y=e.fillRgb?0:a/2;s=$bc9f0500a48e5dd5$export$7efa1f930df882cc({x1:Math.min(n.x,r.x)-y,y1:Math.min(n.y,r.y)-y,x2:Math.max(n.x,r.x)+y,y2:Math.max(n.y,r.y)+y},h),e.fillRgb?t.fillRect(f.x,f.y,f.width,f.height):t.strokeRect(f.x,f.y,f.width,f.height)}else{n=$2Eggz.BB.rotate(c,d,e.angleRad/Math.PI*180),r=$2Eggz.BB.rotate(p,u,e.angleRad/Math.PI*180),g=n.x,m=n.y;let i={x:g+(f=r.x-n.x)/2,y:m+(y=r.y-n.y)/2},o=Math.abs(f/2),l=Math.abs(y/2);t.beginPath(),t.ellipse(i.x,i.y,o,l,0,0,2*Math.PI),e.fillRgb?t.fill():t.stroke();let v=e.fillRgb?0:a/2;s=$bc9f0500a48e5dd5$export$7efa1f930df882cc({x1:i.x-o-v,y1:i.y-l-v,x2:i.x+o+v,y2:i.y+l+v},h)}t.restore()}else throw Error("unknown shape");return s}var $2Eggz=parcelRequire("2Eggz");function $67e715fe604c9329$var$textMetricToRect(t,e){let i=t.actualBoundingBoxAscent,s=t.actualBoundingBoxDescent,n=t.actualBoundingBoxLeft,r=t.actualBoundingBoxRight+n,a=i+s;return"left"===e?{x:-n,y:-i,width:r,height:a}:"right"===e?{x:-r,y:-i,width:r,height:a}:{x:-n,y:-i,width:r,height:a}}function $67e715fe604c9329$export$482c90f94eb9717c(t,e,i){e=$2Eggz.BB.copyObj(e);let s=$2Eggz.BB.ctx(t);s.save(),i&&s.clip(i),s.textAlign=e.align,s.letterSpacing=e.letterSpacing?e.letterSpacing+"px":"0";let n=[e.size+"px "+(e.font?e.font:"sans-serif")];e.isBold&&n.unshift("bold"),e.isItalic&&n.unshift("italic"),s.font=n.join(" "),s.fillStyle=e.fill?$2Eggz.BB.ColorConverter.toRgbaStr(e.fill.color):"transparent",s.strokeStyle=e.stroke?$2Eggz.BB.ColorConverter.toRgbaStr(e.stroke.color):"transparent",e.stroke&&(s.lineWidth=e.stroke.lineWidth,s.lineJoin="round"),s.translate(e.x,e.y),s.rotate(-e.angleRad);let r=e.text.split("\n").map(t=>t.replaceAll("	","    ")),a={x1:0,y1:0,x2:0,y2:0};{let t=!0;r.forEach((i,n)=>{var r;let o=s.measureText(i),l=0,h=e.size*(null!=(r=e.lineHeight)?r:1)*n,c=$67e715fe604c9329$var$textMetricToRect(o,e.align);t?(t=!1,a.x1=l+c.x,a.y1=h+c.y,a.x2=l+c.x+c.width,a.y2=h+c.y+c.height):(a.x1=Math.min(a.x1,l+c.x),a.y1=Math.min(a.y1,h+c.y),a.x2=Math.max(a.x2,l+c.x+c.width),a.y2=Math.max(a.y2,h+c.y+c.height))})}return r.forEach((t,i)=>{var n;let r=0,a=e.size*(null!=(n=e.lineHeight)?n:1)*i;s.strokeText(t,r,a)}),r.forEach((t,i)=>{var n;let r=0,a=e.size*(null!=(n=e.lineHeight)?n:1)*i;s.fillText(t,r,a)}),s.restore(),{x:a.x1,y:a.y1,width:a.x2-a.x1,height:a.y2-a.y1}}var $2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D");function $2b8bf7b32e5ba51f$export$5f63a7b18dc4503a(t,e,i){let s=$2Eggz.BB.canvas(Math.max(1,Math.round(t.width*e)),Math.max(1,Math.round(t.height*e))),n=i?$1d9e27e0466b80f7$export$aa391dbbf8073422(i,$a78c550eaaca7cca$export$dcdf75081b88279d(s.width/t.width,s.height/t.height)):void 0,r=$2Eggz.BB.ctx(s);r.save(),n&&r.clip((0,$aXq9D.getSelectionPath2d)(n)),e>1&&(r.imageSmoothingEnabled=!1);for(let e=0;e<t.layers.length;e++){let i=t.layers[e];if(!i.isVisible||0===i.opacity)continue;r.globalAlpha=i.opacity;let n=i.mixModeStr;if(r.globalCompositeOperation=void 0!==n?n:"source-over",$15ded6c5722f2bc8$export$dba0834b723f37f4(i.image))r.fillStyle=i.image.fill,r.fillRect(0,0,s.width,s.height);else if(i.image instanceof Array)throw Error("not implemented");else r.drawImage(i.image,0,0,s.width,s.height)}return r.restore(),s}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz");class $64881aa9f7f8f596$export$74d12f09ff9f1956{onDown(t,e,i){this.downX=t,this.downY=e,this.downAngleRad=i}onMove(t,e){this.onGradient(!1,this.downX,this.downY,t,e,this.downAngleRad)}onUp(t,e){this.onGradient(!0,this.downX,this.downY,t,e,this.downAngleRad)}constructor(t){this.downX=0,this.downY=0,this.downAngleRad=0,this.onGradient=t.onGradient}}function $64881aa9f7f8f596$export$b1f70a113e3b5c1b(t,e,i){let s;t.save(),i&&t.clip(i);let n=e.x1,r=e.y1,a=e.x2,o=e.y2;if(e.doSnap){let t=180*e.angleRad/Math.PI,i=$2Eggz.BB.rotate(n,r,e.angleRad/Math.PI*180),s=$2Eggz.BB.rotate(a,o,e.angleRad/Math.PI*180),l=$2Eggz.BB.pointsToAngleDeg(i,s)+90,h=45*Math.round(l/45),c=$2Eggz.BB.rotateAround({x:n,y:r},{x:a,y:o},h-l);a=c.x,o=c.y,(t+h)%90==0&&(Math.round((t-h)/90)%2==0?a=n:o=r)}let l=e.color1;e.isEraser&&e.doLockAlpha&&(l={r:255,g:255,b:255});let h=(0,$9FMZM._)((0,$wpIFA._)({},l),{a:e.opacity}),c=(0,$9FMZM._)((0,$wpIFA._)({},l),{a:0});if(e.isReversed){let t=h;h=c,c=t}if("linear"===e.type)(s=t.createLinearGradient(n,r,a,o)).addColorStop(0,$2Eggz.BB.ColorConverter.toRgbaStr(h)),s.addColorStop(1,$2Eggz.BB.ColorConverter.toRgbaStr(c));else if("linear-mirror"===e.type){let e={x:a-n,y:o-r};(s=t.createLinearGradient(n-e.x,r-e.y,a,o)).addColorStop(0,$2Eggz.BB.ColorConverter.toRgbaStr(c)),s.addColorStop(.5,$2Eggz.BB.ColorConverter.toRgbaStr(h)),s.addColorStop(1,$2Eggz.BB.ColorConverter.toRgbaStr(c))}else if("radial"===e.type){let e=$2Eggz.BB.Vec2.dist({x:n,y:r},{x:a,y:o});(s=t.createRadialGradient(n,r,0,n,r,e)).addColorStop(0,$2Eggz.BB.ColorConverter.toRgbaStr(h)),s.addColorStop(1,$2Eggz.BB.ColorConverter.toRgbaStr(c))}t.fillStyle=s,e.isEraser&&(t.globalCompositeOperation="destination-out"),e.doLockAlpha&&(t.globalCompositeOperation="source-atop"),t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore()}var $aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");let $07b32ff703dd0314$var$layerId=0;function $07b32ff703dd0314$export$b2ce7a8a096070e2(){return""+$07b32ff703dd0314$var$layerId++}function $ad14059c4ef400ae$export$9a1731baa7701cc7(t,e,i){let s=[],n=Math.ceil(t/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),r=Math.ceil(e/$d2dccce11beb16cf$export$f7bc58374d6bc9b6);for(let t=0;t<r;t++)for(let t=0;t<n;t++)s.push({fill:i});return s}var $2Eggz=parcelRequire("2Eggz");function $a57b9cfc6d913e03$export$87eabc555ccfbb9f(t,e){return t.index>e.index?1:t.index<e.index?-1:0}function $44d5e766b59f1f60$export$cee5b735b1b9bad1(t,e,i){let s=e.size.width!==i.size.width||e.size.height!==i.size.height;return Object.entries(i.layerMap).map(([n,r])=>{let a={},o={},l=e.layerMap[n],h=Math.ceil(i.size.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6);return s||!l?(a=$2Eggz.BB.canvas(i.size.width,i.size.height),o=$2Eggz.BB.ctx(a),r.tiles.forEach((t,e)=>{let i=e%h,s=Math.floor(e/h);$15ded6c5722f2bc8$export$dba0834b723f37f4(t)?(o.save(),o.fillStyle=t.fill,o.fillRect(i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),o.restore()):o.putImageData(t.data,i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6)})):(a=t[l.index].canvas,o=t[l.index].context,r.tiles.forEach((t,e)=>{if(t===l.tiles[e])return;let i=e%h,s=Math.floor(e/h);$15ded6c5722f2bc8$export$dba0834b723f37f4(t)?(o.save(),o.fillStyle=t.fill,o.clearRect(i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),o.fillRect(i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),o.restore()):o.putImageData(t.data,i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6)})),{id:n,index:r.index,name:r.name,mixModeStr:r.mixModeStr,isVisible:r.isVisible,opacity:r.opacity,canvas:a,context:o}}).sort($a57b9cfc6d913e03$export$87eabc555ccfbb9f)}function $791a43fc2c5e07f3$export$e173233eae155bba(t,e){if(1!==Object.keys(t).length||!t.layerMap)return!1;let i=Object.keys(t.layerMap);for(let s=0;s<i.length;s++){let n=i[s],r=t.layerMap[n];if(n===e){let t=Object.keys(r);if(1!==t.length||"opacity"!==t[0])return!1}else if(Object.keys(r).length>0)return!1}return!0}function $17c16cc75e4c1e0d$export$b706b44cfdbaaa7d(t,e){if(1!==Object.keys(t).length||!t.layerMap)return!1;let i=Object.keys(t.layerMap);for(let s=0;s<i.length;s++){let n=i[s],r=t.layerMap[n];if(n===e){let t=Object.keys(r);if(1!==t.length||"isVisible"!==t[0])return!1}else if(Object.keys(r).length>0)return!1}return!0}var $2Eggz=parcelRequire("2Eggz");function $536e5ff7428d1419$export$6b742be78fc940fb(t,e,i,s){let n=$2Eggz.BB.ctx(t),r=Math.min(t.width,(e+1)*s)-e*s,a=Math.min(t.height,(i+1)*s)-i*s;if(r<=0||a<=0)throw Error("invalid out-of-bounds tile");return n.getImageData(e*s,i*s,r,a)}var $8cWis=parcelRequire("8cWis"),$VM6dD=parcelRequire("VM6dD");function $b37280925142c567$export$2098fe43203ddd32(t,e,i,s=$d2dccce11beb16cf$export$f7bc58374d6bc9b6){t={x1:Math.min(t.x1,t.x2),y1:Math.min(t.y1,t.y2),x2:Math.max(t.x1,t.x2),y2:Math.max(t.y1,t.y2)};let n=(0,$8cWis.boundsInArea)(t,e,i),r=Math.ceil(e/s),a=Math.ceil(i/s);if(!n)return(0,$VM6dD.createArray)(r*a,!1);let o=(0,$VM6dD.createArray)(r*a,!1),l={x1:(0,$8cWis.clamp)(Math.floor(t.x1/s),0,r-1),y1:(0,$8cWis.clamp)(Math.floor(t.y1/s),0,a-1),x2:(0,$8cWis.clamp)(Math.floor(t.x2/s),0,r-1),y2:(0,$8cWis.clamp)(Math.floor(t.y2/s),0,a-1)};for(let t=l.x1;t<=l.x2;t++)for(let e=l.y1;e<=l.y2;e++)o[e*r+t]=!0;return o}function $b37280925142c567$export$1774f90c6da5013c(t,e){return e.map((e,i)=>e||!!t[i])}let $2946cfe57170d555$export$3d7bd55e322555b1=t=>new ImageData(new Uint8ClampedArray(t.data),t.width,t.height);var $VM6dD=parcelRequire("VM6dD");function $96d94f28640c04c3$export$55941c74c8f934(t){return{id:(0,$VM6dD.randomUuid)(),data:t}}function $96d94f28640c04c3$export$1a44c122b8668cb(t){return{id:(0,$VM6dD.randomUuid)(),data:$2946cfe57170d555$export$3d7bd55e322555b1(t.data)}}function $a262f7e0a9f5e4af$export$6706c882ea9c3dbd(t,e){let i=[],s=Math.ceil(t.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),n=Math.ceil(t.height/$d2dccce11beb16cf$export$f7bc58374d6bc9b6);for(let r=0;r<n;r++)for(let n=0;n<s;n++)i.push(e[r*s+n]?$96d94f28640c04c3$export$55941c74c8f934($536e5ff7428d1419$export$6b742be78fc940fb(t,n,r,$d2dccce11beb16cf$export$f7bc58374d6bc9b6)):void 0);return i}function $a262f7e0a9f5e4af$export$7b1ba44282f9a519(t,e){if(e){let i=$b37280925142c567$export$2098fe43203ddd32(e,t.width,t.height);return $a262f7e0a9f5e4af$export$6706c882ea9c3dbd(t,i)}{let e=t.getContext("2d").getImageData(0,0,t.width,t.height),i=Math.ceil(t.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),s=Math.ceil(t.height/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),n=[];for(let r=0;r<s;r++)for(let s=0;s<i;s++){let i=s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,a=r*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,o=Math.min($d2dccce11beb16cf$export$f7bc58374d6bc9b6,t.width-i),l=Math.min($d2dccce11beb16cf$export$f7bc58374d6bc9b6,t.height-a),h=new ImageData(o,l);for(let s=0;s<l;s++){let n=((a+s)*t.width+i)*4,r=s*o*4;h.data.set(e.data.subarray(n,n+4*o),r)}n.push($96d94f28640c04c3$export$55941c74c8f934(h))}return n}}function $52ec11e106a92aac$var$createEntryLayer(t,e,i,s){let n="all"===e,r={};return(n||e.includes("name"))&&(r.name=t.name),(n||e.includes("opacity"))&&(r.opacity=t.opacity),(n||e.includes("isVisible"))&&(r.isVisible=t.isVisible),(n||e.includes("mixModeStr"))&&(r.mixModeStr=t.mixModeStr),(n||e.includes("index"))&&(r.index=t.index),(n||e.includes("tiles"))&&(r.tiles=null!=s?s:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.context.canvas,i)),r}function $52ec11e106a92aac$export$7cefb04ac49374c4(t,...e){var i;let s=null!=(i=e.find(t=>t&&!("layerId"in t)))?i:{attributes:[]},n=e.filter(t=>!!t).filter(t=>"layerId"in t);return Object.fromEntries(t.map((t,e)=>{for(let e of n)if(e.layerId===t.id)return[t.id,$52ec11e106a92aac$var$createEntryLayer(t,e.attributes,e.bounds,e.tiles)];return[t.id,$52ec11e106a92aac$var$createEntryLayer(t,s.attributes)]}))}var $2Eggz=parcelRequire("2Eggz");class $b3e5416e029154db$export$a8c18874b9331404{getColorAt(t,e,i){if(t=Math.floor(t),e=Math.floor(e),t<0||t>=i.size.width||e<0||e>=i.size.height)return new $2Eggz.BB.RGB(0,0,0);let s=$2Eggz.BB.canvas(1,1),n=$2Eggz.BB.ctx(s);n.imageSmoothingEnabled=!1;let r=Math.ceil(i.size.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),a=Math.floor(t/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),o=Math.floor(e/$d2dccce11beb16cf$export$f7bc58374d6bc9b6)*r+a;Object.values(i.layerMap).sort($a57b9cfc6d913e03$export$87eabc555ccfbb9f).forEach(s=>{if(!s.isVisible||0===s.opacity)return;let l=s.tiles[o],h="";if($15ded6c5722f2bc8$export$dba0834b723f37f4(l))h=l.fill;else{let s=$d2dccce11beb16cf$export$f7bc58374d6bc9b6;i.size.width%$d2dccce11beb16cf$export$f7bc58374d6bc9b6!=0&&a===r-1&&(s=i.size.width%$d2dccce11beb16cf$export$f7bc58374d6bc9b6);let n=e%$d2dccce11beb16cf$export$f7bc58374d6bc9b6*s+t%$d2dccce11beb16cf$export$f7bc58374d6bc9b6;if(0===l.data.data[4*n+3])return;h=$2Eggz.BB.ColorConverter.toRgbaStr({r:l.data.data[4*n],g:l.data.data[4*n+1],b:l.data.data[4*n+2],a:l.data.data[4*n+3]/255})}n.fillStyle=h,n.globalAlpha=s.opacity,n.globalCompositeOperation=s.mixModeStr,n.fillRect(0,0,1,1)});let l=n.getImageData(0,0,1,1);return new $2Eggz.BB.RGB(l.data[0],l.data[1],l.data[2])}}var $VM6dD=parcelRequire("VM6dD"),$8cWis=parcelRequire("8cWis"),$ao0qX=parcelRequire("ao0qX");function $273e2af276df50c0$export$6be4733fa804854c(t,e){let i=$b6390a4afb7d8067$export$a04a50ae6d6450f8(t),s=(0,$8cWis.intBoundsWithinArea)(i,e.canvas.width,e.canvas.height,!0);if(s)return(0,$ao0qX.canvasBounds)(e,s)}function $b5fa43d1e9c9aab9$export$199acb5b15c43176(t,e,i){return t.map(t=>t.map(t=>t.map(t=>[t[0]+e,t[1]+i])))}var $2Eggz=parcelRequire("2Eggz"),$ao0qX=parcelRequire("ao0qX");function $12e0dda7c62dd122$export$820c5732ce56544(t,e,i){let s=new Uint8Array(new ArrayBuffer(e*i)),n=$2Eggz.BB.canvas(e,i),r=$2Eggz.BB.ctx(n);(0,$ao0qX.drawSelectionMask)(t,r);let a=r.getImageData(0,0,e,i);$2Eggz.BB.freeCanvas(n);let o=e*i;for(let t=0,e=0;t<o;t++,e+=4)s[t]=a.data[e]>>>7;return s}function $d26b85e649dca02a$var$workaroundForChromium1281185(t){t.save(),t.fillStyle="rgba(0,0,0,0.01)",t.fillRect(-.9999999,-.9999999,1,1),t.restore()}let $d26b85e649dca02a$export$9f4f73b1bd7c2f26=16,$d26b85e649dca02a$var$KL_CANVAS_DEBUGGING=!1;class $d26b85e649dca02a$export$4a819bde91671014{updateIndices(){this.layers.forEach((t,e)=>{t.index=e})}getSelectionOrFallback(){var t;return null!=(t=this.selection)?t:[[[[0,0],[this.width,0],[this.width,this.height],[0,this.height],[0,0]]]]}reset(t){if(!t.width||!t.height||t.width<1||t.height<1||isNaN(t.width)||isNaN(t.height))throw Error("invalid canvas size");if(this.klHistory.pause(!0),this.width=t.width,this.height=t.height,this.selection=void 0,this.layers.splice(1,Math.max(0,this.layers.length-1)),t.layers)for(let e=0;e<t.layers.length;e++){let i=t.layers[e];this.layers[e]||this.addLayer();let s=this.layers[e];s.id=i.id,s.name=i.name,s.isVisible=i.isVisible,s.mixModeStr=i.mixModeStr?i.mixModeStr:"source-over",s.canvas.width=this.width,s.canvas.height=this.height,s.context.drawImage(i.image,0,0),this.setOpacity(e,i.opacity)}else{let e=this.layers[0];e.name=t.layerName?t.layerName:$63d0b335c576c718$export$ce37e184d908d785("layers-layer")+" 1",e.isVisible=!0,e.canvas.width=this.width,e.canvas.height=this.height,e.mixModeStr="source-over",this.setOpacity(0,1),t.color?this.layerFill(0,t.color):t.image&&e.context.drawImage(t.image,0,0)}if(this.updateIndices(),this.klHistory.pause(!1),!this.klHistory.isPaused()){var e;let i={projectId:{value:null!=(e=t.projectId)?e:(0,$VM6dD.randomUuid)()},size:{width:this.width,height:this.height},selection:{value:this.selection},activeLayerId:this.layers[this.layers.length-1].id,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:"all"})};this.klHistory.push(i)}return this.layers.length-1}isLayerLimitReached(){return this.layers.length>=$d26b85e649dca02a$export$9f4f73b1bd7c2f26}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.width=t,this.height=e}getLayerCount(){return this.layers.length}resize(t,e,i="smooth"){let s,n;if(!t||!e||t===this.width&&e===this.height||isNaN(t)||isNaN(e)||t<1||e<1)return!1;if(t=Math.max(t,1),e=Math.max(e,1),"pixelated"===i){s=$2Eggz.BB.canvas(t,e);let i=$2Eggz.BB.ctx(s);i.imageSmoothingEnabled=!1;for(let n=0;n<this.layers.length;n++){n>0&&i.clearRect(0,0,t,e);let r=this.layers[n];i.drawImage(r.canvas,0,0,t,e),r.canvas.width=t,r.canvas.height=e,r.context.drawImage(s,0,0)}}else if("smooth"===i){s=$2Eggz.BB.canvas(),n=$2Eggz.BB.canvas();for(let i=0;i<this.layers.length;i++)$2Eggz.BB.resizeCanvas(this.layers[i].canvas,t,e,s,n)}else throw Error("unknown resize algorithm");return this.selection&&(this.selection=$1d9e27e0466b80f7$export$aa391dbbf8073422(this.selection,$a78c550eaaca7cca$export$dcdf75081b88279d(t/this.width,e/this.height))),this.width=t,this.height=e,this.klHistory.push((0,$wpIFA._)({size:{width:this.width,height:this.height},layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{})),!0}resizeCanvas(t){let e=Math.round(t.left)+this.width+Math.round(t.right),i=Math.round(t.top)+this.height+Math.round(t.bottom),s=Math.round(t.left),n=Math.round(t.top);if(isNaN(e)||isNaN(i)||e<1||i<1)throw Error("KlCanvas.resizeCanvas - invalid canvas size");for(let r=0;r<this.layers.length;r++){let a=$2Eggz.BB.canvas(this.width,this.height),o=this.layers[r];$2Eggz.BB.ctx(a).drawImage(o.canvas,0,0),o.canvas.width=e,o.canvas.height=i,o.context.save(),0===r&&t.fillColor&&(o.context.fillStyle=$2Eggz.BB.ColorConverter.toRgbStr(t.fillColor),o.context.fillRect(0,0,e,i),o.context.clearRect(s,n,this.width,this.height)),o.context.drawImage(a,s,n),o.context.restore()}this.width=e,this.height=i,this.selection&&(this.selection=$b5fa43d1e9c9aab9$export$199acb5b15c43176(this.selection,s,n)),this.klHistory.push((0,$wpIFA._)({size:{width:this.width,height:this.height},layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}addLayer(t,e){var i;if(this.isLayerLimitReached())return!1;let s=void 0===t?this.layers.length:t+1,n=$2Eggz.BB.canvas(this.width,this.height),r=$2Eggz.BB.ctx(n);e&&("function"==typeof e.image?e.image(r):r.drawImage(e.image,0,0));let a=$07b32ff703dd0314$export$b2ce7a8a096070e2(),o={id:a,index:s,name:e&&void 0!==e.name?e.name:$63d0b335c576c718$export$ce37e184d908d785("layers-layer")+" "+(this.layers.length+this.layerNrOffset),mixModeStr:e&&null!=(i=e.mixModeStr)?i:"source-over",isVisible:!e||e.isVisible,opacity:e?e.opacity:1,canvas:n,context:r};return this.layers.splice(s,0,o),this.klHistory.pause(!0),this.setOpacity(s,1),this.klHistory.pause(!1),this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:a,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},{layerId:a,attributes:"all",tiles:e?void 0:$ad14059c4ef400ae$export$9a1731baa7701cc7(this.width,this.height,"transparent")})}),s}duplicateLayer(t){if(!this.layers[t]||this.isLayerLimitReached())return!1;let e=this.layers[t],i=t+1,s=this.klHistory.getComposed().layerMap[e.id],n=$2Eggz.BB.canvas(this.width,this.height),r=$2Eggz.BB.ctx(n),a=$07b32ff703dd0314$export$b2ce7a8a096070e2(),o={id:a,index:i,name:e.name+" "+$63d0b335c576c718$export$ce37e184d908d785("layers-copy"),mixModeStr:e.mixModeStr,isVisible:e.isVisible,opacity:e.opacity,canvas:n,context:r};this.layers.splice(i,0,o);{let t=Math.ceil(this.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6);s.tiles.forEach((e,i)=>{let s=i%t,n=Math.floor(i/t);r.save(),$15ded6c5722f2bc8$export$dba0834b723f37f4(e)?(r.fillStyle=e.fill,r.fillRect(s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,n*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6)):r.putImageData(e.data,s*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,n*$d2dccce11beb16cf$export$f7bc58374d6bc9b6),r.restore()})}return this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:a,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},{layerId:a,attributes:"all",tiles:s.tiles.map(t=>$15ded6c5722f2bc8$export$dba0834b723f37f4(t)?(0,$wpIFA._)({},t):$96d94f28640c04c3$export$1a44c122b8668cb(t))})}),t+1}getLayerContext(t,e){if(this.layers[t])return this.layers[t].context;if(e)return null;throw Error("layer of index "+t+" not found (in "+this.layers.length+" layers)")}removeLayer(t){let e=this.layers[t];if(!e)return!1;$2Eggz.BB.freeCanvas(e.canvas),this.layers.splice(t,1),this.updateIndices();let i=Math.max(0,t-1),s=this.layers[i].id;return this.klHistory.isPaused()||this.klHistory.push({activeLayerId:s,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["index"]})}),i}renameLayer(t,e){let i=this.layers[t];return!!i&&(i.name=e,this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["name"]})}),!0)}setOpacity(t,e){if(this.layers[t]&&(e=Math.max(0,Math.min(1,e)),this.layers[t].opacity=e,!this.klHistory.isPaused())){let e=this.layers[t].id,i=$791a43fc2c5e07f3$export$e173233eae155bba(this.klHistory.getEntries().at(-1).data,e);this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:e,attributes:["opacity"]})},i)}}setLayerIsVisible(t,e){if(this.layers[t])this.layers[t].isVisible=e;else throw Error(`layer ${t} undefined`);if(!this.klHistory.isPaused()){let e=this.layers[t].id,i=$17c16cc75e4c1e0d$export$b706b44cfdbaaa7d(this.klHistory.getEntries().at(-1).data,e);this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:e,attributes:["isVisible"]})},i)}}moveLayer(t,e){if(0===e||!this.layers[t])return;let i=this.layers[t];this.layers.splice(t,1);let s=Math.max(0,Math.min(t+e,this.layers.length));return this.layers.splice(s,0,i),this.updateIndices(),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:this.layers[s].id,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["index"]})}),s}mergeLayers(t,e,i){if(!this.layers[t]||!this.layers[e]||t===e)return;if(t>e){let i=t;t=e,e=i}let s=this.layers[e],n=this.layers[t];void 0===i&&(i=s.mixModeStr);let r=this.layers[e].opacity,a=s.opacity>0;if(a){let t=n.context;t.save(),"as-alpha"===i?($2Eggz.BB.convertToAlphaChannelCanvas(s.canvas),t.globalCompositeOperation="destination-in"):i&&(t.globalCompositeOperation=i),t.globalAlpha=r,t.drawImage(s.canvas,0,0),t.restore(),i&&$d26b85e649dca02a$var$workaroundForChromium1281185(t)}return this.klHistory.pause(!0),this.removeLayer(e),this.klHistory.pause(!1),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:n.id,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["index"]},a?{layerId:n.id,attributes:"all"}:void 0)}),t}mergeAll(){if(1===this.layers.length)return!1;let t=this.layers[0];t.name=$63d0b335c576c718$export$ce37e184d908d785("layers-layer")+" 1";let e=t.context;for(let t=1;t<this.layers.length;t++){let i=this.layers[t];i.isVisible&&0!==i.opacity&&(e.save(),e.globalCompositeOperation=i.mixModeStr,e.globalAlpha=i.opacity,e.drawImage(i.canvas,0,0),e.restore())}this.klHistory.pause(!0);for(let t=this.layers.length-1;t>0;t--)this.removeLayer(t);if(this.klHistory.pause(!1),!this.klHistory.isPaused()){let e=t.id;this.klHistory.push({activeLayerId:e,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})})}return 0}rotate(t){for(;t<0;)t+=360;if(90!=(t%=360)&&180!==t&&270!==t)return;let e=$2Eggz.BB.canvas();180===t?(e.width=this.width,e.height=this.height):(90===t||270===t)&&(e.width=this.height,e.height=this.width);let i=$5c473edaf09eadd3$export$f0954fd7d5368655();90===t?i=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(this.height,0),$20520e5c69c4ad5d$export$bb628a54ab399bc9(Math.PI/2)):180===t?i=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(this.width,this.height),$20520e5c69c4ad5d$export$bb628a54ab399bc9(Math.PI)):270===t&&(i=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(0,this.width),$20520e5c69c4ad5d$export$bb628a54ab399bc9(3*Math.PI/2)));let s=$2Eggz.BB.ctx(e);for(let t=0;t<this.layers.length;t++)s.clearRect(0,0,e.width,e.height),s.save(),s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i)),s.drawImage(this.layers[t].canvas,0,0),s.restore(),this.layers[t].canvas.width=e.width,this.layers[t].canvas.height=e.height,this.layers[t].context.drawImage(e,0,0);this.width=e.width,this.height=e.height,this.selection&&(this.selection=$1d9e27e0466b80f7$export$aa391dbbf8073422(this.selection,i)),this.klHistory.push((0,$wpIFA._)({size:{width:this.width,height:this.height},layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}flip(t,e,i){if(!t&&!e)return;let s=$2Eggz.BB.canvas(this.width,this.height);s.width=this.width,s.height=this.height;let n=$2Eggz.BB.ctx(s),r=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(s.width/2,s.height/2),$a78c550eaaca7cca$export$dcdf75081b88279d(t?-1:1,e?-1:1),$cf0617f9860dc277$export$d73ee8ef04f5226a(-s.width/2,-s.height/2));for(let t=0;t<this.layers.length;t++)(i||0===i)&&t!==i||(n.save(),n.clearRect(0,0,s.width,s.height),n.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(r)),n.drawImage(this.layers[t].canvas,0,0),n.restore(),this.layers[t].context.clearRect(0,0,this.layers[t].canvas.width,this.layers[t].canvas.height),this.layers[t].context.drawImage(s,0,0));this.selection&&(this.selection=$1d9e27e0466b80f7$export$aa391dbbf8073422(this.selection,r));let a=void 0===i?void 0:this.layers[i];this.klHistory.push((0,$wpIFA._)({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,a?{layerId:a.id,attributes:["tiles"]}:{attributes:["tiles"]})},this.selection?{selection:{value:this.selection}}:{}))}drawOperation(t,e){let i=this.layers[t];e(i.context),this.klHistory.isPaused()||this.klHistory.push({activeLayerId:i.id,layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"]})})}layerFill(t,e,i,s){let n,r=this.layers[t].context;r.save();let a=!(s&&this.selection)&&void 0===i;if(i&&(r.globalCompositeOperation=i),s&&this.selection){let t=(0,$aXq9D.getSelectionPath2d)(this.selection);r.clip(t),n=(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection))}let o="rgba("+e.r+","+e.g+","+e.b+",1)";if(r.fillStyle=o,r.fillRect(0,0,this.layers[t].canvas.width,this.layers[t].canvas.height),r.restore(),r.save(),r.fillStyle="rgba(0,0,0,0.01)",r.fillRect(-.9999999,-.9999999,1,1),r.restore(),!this.klHistory.isPaused()){let e=this.layers[t];this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:e.id,attributes:["tiles"],tiles:a?$ad14059c4ef400ae$export$9a1731baa7701cc7(this.width,this.height,o):void 0,bounds:n})})}}floodFill(t,e,i,s,n,r,a,o,l){let h,c,d;if(e<0||i<0||e>=this.width||i>=this.height||0===n)return;if(r=Math.round(r),e=Math.round(e),i=Math.round(i),!["above","current","all"].includes(a))throw Error("invalid sampleStr");let p=this.selection?$12e0dda7c62dd122$export$820c5732ce56544(this.selection,this.width,this.height):void 0;if(p&&0===p[i*this.width+e])return;let u=this.layers[t];if("all"===a){let t=1===this.layers.length?this.layers[0].canvas:this.getCompleteCanvas(1);h=$469fa98e1403db53$export$13d50f258a8034f($2Eggz.BB.ctx(t).getImageData(0,0,this.width,this.height).data,p,this.width,this.height,e,i,r,Math.round(o),l),d=(c=u.context).getImageData(0,0,this.width,this.height)}else{let s="above"===a?t+1:t;if(s>=this.layers.length)return;let n=this.layers[s].context,g=n.getImageData(0,0,this.width,this.height);h=$469fa98e1403db53$export$13d50f258a8034f(g.data,p,this.width,this.height,e,i,r,Math.round(o),l),c=t===s?n:u.context,d=t===s?g:c.getImageData(0,0,this.width,this.height)}let g=d.data;if(s)if(1===n)for(let t=0;t<this.width*this.height;t++)255===h.data[t]&&(g[4*t]=s.r,g[4*t+1]=s.g,g[4*t+2]=s.b,g[4*t+3]=255);else for(let t=0;t<this.width*this.height;t++)255===h.data[t]&&(g[4*t]=$2Eggz.BB.mix(g[4*t],s.r,n),g[4*t+1]=$2Eggz.BB.mix(g[4*t+1],s.g,n),g[4*t+2]=$2Eggz.BB.mix(g[4*t+2],s.b,n),g[4*t+3]=$2Eggz.BB.mix(g[4*t+3],255,n));else if(1===n)for(let t=0;t<this.width*this.height;t++)255===h.data[t]&&(g[4*t+3]=0);else for(let t=0;t<this.width*this.height;t++)255===h.data[t]&&(g[4*t+3]=$2Eggz.BB.mix(g[4*t+3],0,n));c.putImageData(d,0,0),this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:u.id,attributes:["tiles"],bounds:h.bounds})})}drawShape(t,e){if(e.x1===e.x2&&e.y1===e.y2)return;let i=this.layers[t],s=this.selection?new Path2D((0,$aXq9D.getSelectionPath2d)(this.selection)):void 0,n=(0,$8cWis.integerBounds)($583d130d11db85ad$export$71b514a25c47df50(i.context,e,s));this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],bounds:n})})}drawGradient(t,e){let i=this.layers[t],s=this.selection?new Path2D((0,$aXq9D.getSelectionPath2d)(this.selection)):void 0;$64881aa9f7f8f596$export$b1f70a113e3b5c1b(i.context,e,s),this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"]})})}text(t,e){let i=this.layers[t],s=$67e715fe604c9329$export$482c90f94eb9717c(i.canvas,$2Eggz.BB.copyObj(e),this.selection?new Path2D((0,$aXq9D.getSelectionPath2d)(this.selection)):void 0),n=2+(e.stroke?e.stroke.lineWidth/2:0),r=$bc9f0500a48e5dd5$export$7efa1f930df882cc({x1:s.x,y1:s.y,x2:s.x+s.width,y2:s.y+s.height},$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(e.x,e.y),$20520e5c69c4ad5d$export$bb628a54ab399bc9(-e.angleRad)));r=(0,$8cWis.integerBounds)({x1:r.x1-n,y1:r.y1-n,x2:r.x2+n,y2:r.y2+n}),this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],bounds:r})})}eraseLayer(t){let e,i=this.layers[t.layerIndex],s=i.context;if(s.save(),t.useSelection&&this.selection){let t=(0,$aXq9D.getSelectionPath2d)(this.selection);s.clip(t),e=(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection))}t.useAlphaLock?s.globalCompositeOperation="source-in":s.globalCompositeOperation="destination-out",s.fillStyle=$2Eggz.BB.ColorConverter.toRgbStr($7a2aeb795d64bafc$export$8627e24041b28589()),s.fillRect(0,0,this.width,this.height),s.restore();let n=!t.useAlphaLock&&!(t.useSelection&&this.selection);this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["tiles"],tiles:n?$ad14059c4ef400ae$export$9a1731baa7701cc7(this.width,this.height,"transparent"):void 0,bounds:e})})}getKlHistory(){return this.klHistory}getLayersRaw(){return this.layers}getLayers(){return this.layers.map(t=>({id:t.id,canvas:t.canvas,context:t.context,isVisible:t.isVisible,opacity:t.opacity,name:t.name,mixModeStr:t.mixModeStr}))}getLayersFast(){return this.layers.map(t=>(0,$wpIFA._)({canvas:t.canvas,isVisible:t.isVisible,opacity:t.opacity,name:t.name,mixModeStr:t.mixModeStr},t.compositeObj?{compositeObj:t.compositeObj}:{}))}getLayerIndex(t,e){for(let e=0;e<this.layers.length;e++)if(this.layers[e].canvas===t)return e;if(!e)throw Error("layer not found (in "+this.layers.length+" layers)");return null}getLayerOld(t,e){if(this.layers[t])return{context:this.layers[t].context,isVisible:this.layers[t].isVisible,opacity:this.layers[t].opacity,name:this.layers[t].name,id:t};if(!e)throw Error("layer of index "+t+" not found (in "+this.layers.length+" layers)");return null}getLayer(t){return this.layers[t]}getColorAt(t,e){return this.eyedropper.getColorAt(t,e,this.klHistory.getComposed())}getCompleteCanvas(t,e){return $2b8bf7b32e5ba51f$export$5f63a7b18dc4503a(this.getProject(),t,e?this.selection:void 0)}getProject(){return{projectId:this.klHistory.getComposed().projectId.value,width:this.width,height:this.height,layers:this.layers.map(t=>({name:t.name,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,image:t.canvas}))}}setMixMode(t,e){let i=this.layers[t];i.mixModeStr=e,this.klHistory.isPaused()||this.klHistory.push({layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(this.layers,{layerId:i.id,attributes:["mixModeStr"]})})}setComposite(t,e){if(!this.layers[t])throw Error("invalid layer");this.layers[t].compositeObj=e}setSelection(t){(this.selection||t)&&(this.selection=t,this.klHistory.push({selection:{value:t}}))}getSelection(){return this.selection}getSelectionArea(t){let e=this.layers[t];return $273e2af276df50c0$export$6be4733fa804854c(this.getSelectionOrFallback(),e.context)}updateViaComposed(t,e){this.width=e.size.width,this.height=e.size.height,this.selection=e.selection.value,this.layers=$44d5e766b59f1f60$export$cee5b735b1b9bad1(this.layers,t,e)}destroy(){this.isDestroyed||(this.layers.forEach(t=>{$2Eggz.BB.freeCanvas(t.canvas),t.canvas={},t.context={}}),this.layers=[],this.isDestroyed=!0)}constructor(t,e=0){this.layerNrOffset=e,this.isDestroyed=!1,this.selection=void 0,this.klHistory=t,this.layers=[],$d26b85e649dca02a$var$KL_CANVAS_DEBUGGING&&(window.getCanvasLayers=()=>this.layers),this.eyedropper=new $b3e5416e029154db$export$a8c18874b9331404,this.width=0,this.height=0,this.updateViaComposed({projectId:{value:(0,$VM6dD.randomUuid)()},size:{width:0,height:0},activeLayerId:"",selection:{value:[]},layerMap:{}},this.klHistory.getComposed())}}function $326f2f7e3662b29f$export$6e1bedb2a6cdff30(t){if(!t)return $63d0b335c576c718$export$ce37e184d908d785("layers-blend-normal");let e={"source-over":"layers-blend-normal",darken:"layers-blend-darken",multiply:"layers-blend-multiply","color-burn":"layers-blend-color-burn",lighten:"layers-blend-lighten",screen:"layers-blend-screen","color-dodge":"layers-blend-color-dodge",overlay:"layers-blend-overlay","soft-light":"layers-blend-soft-light","hard-light":"layers-blend-hard-light",difference:"layers-blend-difference",exclusion:"layers-blend-exclusion",hue:"layers-blend-hue",saturation:"layers-blend-saturation",color:"layers-blend-color",luminosity:"layers-blend-luminosity"};if(!(t in e))throw Error("unknown blend mode");return $63d0b335c576c718$export$ce37e184d908d785(e[t])}var $2Eggz=parcelRequire("2Eggz");function $22c3a0a9dd5ca668$export$28debfc111084e87(t,e,i){let s=$2Eggz.BB.el(),n=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("layers-rename-name")+":",css:{marginRight:"5px"}}),r=$2Eggz.BB.el({css:{display:"flex"}}),a=$2Eggz.BB.el({tagName:"input"});a.value=e,a.setAttribute("data-ignore-focus","true"),a.style.flexGrow="1";let o=$2Eggz.BB.el({tagName:"button",content:'<img src="'+$parcel$interopDefault($03e87c70019af696$exports)+'" height="20"/>',title:$63d0b335c576c718$export$ce37e184d908d785("layers-rename-clear"),css:{marginLeft:"10px"},onClick:()=>{a.value="",a.focus()}}),l=[$63d0b335c576c718$export$ce37e184d908d785("layers-rename-sketch"),$63d0b335c576c718$export$ce37e184d908d785("layers-rename-colors"),$63d0b335c576c718$export$ce37e184d908d785("layers-rename-shading"),$63d0b335c576c718$export$ce37e184d908d785("layers-rename-lines"),$63d0b335c576c718$export$ce37e184d908d785("layers-rename-effects"),$63d0b335c576c718$export$ce37e184d908d785("background"),$63d0b335c576c718$export$ce37e184d908d785("layers-rename-foreground")],h=[],c=$2Eggz.BB.el({css:{display:"flex",flexWrap:"wrap",marginTop:"5px",marginLeft:"-5px"}});l.forEach(t=>{let e=$2Eggz.BB.el({parent:c,tagName:"button",content:t,onClick:()=>{a.value=""+e.textContent},css:{margin:"5px 0 0 5px"}});h.push(e)}),s.append(n),n.append(r,c),r.append(a,o),setTimeout(()=>{a.focus(),a.select()},10),$2016c314bff36ab9$export$d7e8d4d4450c819c({target:t,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("layers-rename-title")}</b>`,div:s,buttons:[$63d0b335c576c718$export$ce37e184d908d785("layers-rename"),"Cancel"],primaries:[$63d0b335c576c718$export$ce37e184d908d785("layers-rename")],callback:t=>{$2Eggz.BB.destroyEl(o),h.forEach(t=>{$2Eggz.BB.destroyEl(t)}),h.splice(0,h.length),t===$63d0b335c576c718$export$ce37e184d908d785("layers-rename")?i(a.value):i(void 0)},clickOnEnter:$63d0b335c576c718$export$ce37e184d908d785("layers-rename")})}var $2Eggz=parcelRequire("2Eggz");function $e304a6ae1452211c$export$ee79aceabae6bb8a(t,e){let i=$2Eggz.BB.el();i.innerHTML=$63d0b335c576c718$export$ce37e184d908d785("layers-merge-description");let s=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:e.mixModeStr,label:$326f2f7e3662b29f$export$6e1bedb2a6cdff30(e.mixModeStr)},{id:"source-in",label:"source-in"},{id:"source-out",label:"source-out"},{id:"source-atop",label:"source-atop"},{id:"destination-in",label:"destination-in"},{id:"destination-out",label:"destination-out"},{id:"destination-atop",label:"destination-atop"},{id:"xor",label:"xor"}],initId:e.mixModeStr,onChange:()=>{l()},isSmall:!0,css:{marginTop:"5px"}});i.append(s.getElement());let n=$2Eggz.BB.fitInto(e.topCanvas.width,e.topCanvas.height,200,200,1),r=$2Eggz.BB.canvas(n.width,n.height);r.title=$63d0b335c576c718$export$ce37e184d908d785("preview"),r.className="kl-merge-preview";let a=$2Eggz.BB.el({content:"<br/>",css:{clear:"both"}});i.append(a,r);let o=$2Eggz.BB.copyCanvas(r);$2Eggz.BB.ctx(o).drawImage(e.topCanvas,0,0,o.width,o.height),$2Eggz.BB.convertToAlphaChannelCanvas(o);let l=()=>{let t=$2Eggz.BB.ctx(r);t.save(),t.clearRect(0,0,r.width,r.height),r.width>e.topCanvas.width&&(t.imageSmoothingEnabled=!1),t.drawImage(e.bottomCanvas,0,0,r.width,r.height),"as-alpha"===s.getValue()?(t.globalCompositeOperation="destination-in",t.globalAlpha=e.topOpacity,t.drawImage(o,0,0,r.width,r.height)):(t.globalCompositeOperation=s.getValue(),t.globalAlpha=e.topOpacity,t.drawImage(e.topCanvas,0,0,r.width,r.height)),t.restore()};l();let h=new $2Eggz.BB.KeyListener({onDown:t=>{"right"===t&&s.next(),"left"===t&&s.previous()}});$2016c314bff36ab9$export$d7e8d4d4450c819c({target:t,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("layers-merge-modal-title")}</b>`,div:i,buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:t=>{h.destroy(),s.destroy(),"Ok"===t&&e.callback(s.getValue())}})}var $VM6dD=parcelRequire("VM6dD"),$8oUKZ=parcelRequire("8oUKZ"),$jmKbV=parcelRequire("jmKbV");class $be599a9dc46f5101$export$e44a253a59704894{getElement(){return this.rootElement}setEnabled(t,e){this.onSetEnabled(t,e)}constructor(t){this.isExpanded=!1,this.onSetEnabled=()=>0;let e=$934e5f47c3374e21$export$db3b6bfb95261072("button,w-full,h-full",[t.button]);e.onclick=()=>{r(!this.isExpanded)},t.buttonTitle&&(e.title=t.buttonTitle),(0,$jmKbV.makeUnfocusable)(e);let i=[],s={};t.items.forEach(e=>{let n=$934e5f47c3374e21$export$db3b6bfb95261072("button",e[1]);(0,$jmKbV.makeUnfocusable)(n),n.onclick=()=>{r(!1),t.onItemClick(e[0])},i.push(n),s[e[0]]=n}),this.onSetEnabled=(t,e)=>{s[t].disabled=!e};let n=$934e5f47c3374e21$export$db3b6bfb95261072(".kl-dropdown-menu,right-0,top-full,nowrap,hidden",i);this.rootElement=$934e5f47c3374e21$export$db3b6bfb95261072(",pos-relative",[e,n]);let r=t=>{this.isExpanded=t,n.style.display=this.isExpanded?"":"none",this.isExpanded?(document.addEventListener("pointerdown",a,{passive:!1}),window.addEventListener("blur",o)):(document.removeEventListener("pointerdown",a),window.removeEventListener("blur",o))},a=t=>{let i=t.target;e.contains(i)||n.contains(i)||r(!1)},o=()=>r(!1)}}var $4dde6a6ccaabd5ab$exports={};$4dde6a6ccaabd5ab$exports=$parcel$resolve("gShQZ");var $0ecce9fc138ec1e3$exports={};$0ecce9fc138ec1e3$exports=$parcel$resolve("ldqtT");var $be3ab0e4c204533c$exports={};$be3ab0e4c204533c$exports=$parcel$resolve("apAfQ");var $7444ed87edb442c4$exports={};$7444ed87edb442c4$exports=$parcel$resolve("5E29d");var $7dc8b75d4dbc1df5$exports={};$7dc8b75d4dbc1df5$exports=$parcel$resolve("48B5J");var $2cf698fade3d7a89$exports={};$2cf698fade3d7a89$exports=$parcel$resolve("lI82b");var $jmKbV=parcelRequire("jmKbV");let $a4100dd1ad7b3844$var$paddingLeft=25;class $a4100dd1ad7b3844$export$c3bf51e04f391d6d{move(t,e){if(isNaN(t)||isNaN(e))throw"layers-ui - invalid move";for(let i=0;i<this.klCanvasLayerArr.length;i++)(i=>{let s=this.layerElArr[i].spot;this.layerElArr[i].spot===t?s=e:(this.layerElArr[i].spot>t&&s--,s>=e&&s++),this.layerElArr[i].spot=s,this.layerElArr[i].posY=(this.layerHeight+this.layerSpacing)*(this.klCanvasLayerArr.length-s-1),this.layerElArr[i].style.top=this.layerElArr[i].posY+"px"})(i);t!==e&&(this.applyUncommitted(),this.klCanvas.moveLayer(this.selectedSpotIndex,e-t),this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=e,this.mergeBtn.disabled=0===this.selectedSpotIndex)}posToSpot(t){let e=parseInt(""+(t/(this.layerHeight+this.layerSpacing)+.5));return e=Math.min(this.klCanvasLayerArr.length-1,Math.max(0,e)),e=this.klCanvasLayerArr.length-e-1}updateLayersVerticalPosition(t,e){if((e=Math.min(this.klCanvasLayerArr.length-1,Math.max(0,e)))!==this.lastpos){for(let i=0;i<this.klCanvasLayerArr.length;i++){if(this.layerElArr[i].spot===t)continue;let s=this.layerElArr[i].spot;this.layerElArr[i].spot>t&&s--,s>=e&&s++,this.layerElArr[i].posY=(this.layerHeight+this.layerSpacing)*(this.klCanvasLayerArr.length-s-1),this.layerElArr[i].style.top=this.layerElArr[i].posY+"px"}this.lastpos=e}}renameLayer(t){$22c3a0a9dd5ca668$export$28debfc111084e87(this.parentEl,this.klCanvas.getLayerOld(t).name,e=>{void 0!==e&&e!==this.klCanvas.getLayerOld(t).name&&(this.klCanvas.renameLayer(t,e),this.onSelect(t,!1))})}updateHeight(){this.layerListEl.style.height=35*this.layerElArr.length+"px"}createLayerList(t){if(this.klHistory.getChangeCount()===this.oldHistoryState&&!t)return;this.oldHistoryState=this.klHistory.getChangeCount(),this.klCanvasLayerArr=this.klCanvas.getLayers();let e=t=>{let e,i=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerOld(t)),s=i.name,n=this.klCanvasLayerArr[t].opacity,r=i.isVisible,a=this.klCanvasLayerArr[t].context.canvas,o=$2Eggz.BB.el({className:"kl-layer"});this.layerElArr[t]=o,o.posY=(this.klCanvasLayerArr.length-1)*35-35*t,(0,$VM6dD.css)(o,{top:o.posY+"px"});let l=$2Eggz.BB.el();(0,$VM6dD.css)(l,{position:"relative"});let h=$2Eggz.BB.el();(0,$VM6dD.css)(h,{width:"270px",height:"34px"});let c=$2Eggz.BB.el();o.append(l),l.append(h,c),o.spot=t;{let t=$2Eggz.BB.el({tagName:"label",parent:h,title:$63d0b335c576c718$export$ce37e184d908d785("layers-visibility-toggle"),css:{display:"flex",width:"25px",height:"100%",justifyContent:"right",alignItems:"center",cursor:"pointer"}}),e=$2Eggz.BB.el({tagName:"input",parent:t,custom:{type:"checkbox",tabindex:"-1",name:"layer-visibility"},css:{display:"block",cursor:"pointer",margin:"0",marginRight:"5px"}});e.checked=r,e.onchange=()=>{this.klCanvas.setLayerIsVisible(o.spot,e.checked),o.spot===this.selectedSpotIndex&&this.onSelect(this.selectedSpotIndex,!1)};let i=t=>{t.preventDefault(),t.stopPropagation()};$8oUKZ.HAS_POINTER_EVENTS?t.onpointerdown=i:t.onmousedown=i}{let t=$2Eggz.BB.fitInto(a.width,a.height,30,30,1);o.thumb=$2Eggz.BB.canvas(t.width,t.height);let e=$2Eggz.BB.ctx(o.thumb);e.save(),o.thumb.width>a.width&&(e.imageSmoothingEnabled=!1),e.drawImage(a,0,0,o.thumb.width,o.thumb.height),e.restore(),(0,$VM6dD.css)(o.thumb,{position:"absolute",left:(32-o.thumb.width)/2+$a4100dd1ad7b3844$var$paddingLeft+"px",top:(32-o.thumb.height)/2+1+"px",background:"var(--kl-checkerboard-background)"})}o.label=$2Eggz.BB.el({className:"kl-layer__label"}),o.layerName=s,o.label.append(o.layerName),(0,$VM6dD.css)(o.label,{position:"absolute",left:38+$a4100dd1ad7b3844$var$paddingLeft+"px",top:"1px",fontSize:"13px",width:"165px",height:"20px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),o.label.ondblclick=()=>{this.applyUncommitted(),this.renameLayer(o.spot)},o.opacityLabel=$2Eggz.BB.el({className:"kl-layer__opacity-label"}),o.opacity=n,o.opacityLabel.append(parseInt(""+100*o.opacity)+"%"),(0,$VM6dD.css)(o.opacityLabel,{position:"absolute",left:189+$a4100dd1ad7b3844$var$paddingLeft+"px",top:"1px",fontSize:"13px",textAlign:"right",width:"50px",transition:"color 0.2s ease-in-out",textDecoration:r?void 0:"line-through"});let d=new $867da577d723d824$export$ac00cea56cec3037({init:o.opacity,width:200,pointSize:14,callback:(t,i,s)=>{if(i){e=this.klCanvas.getLayerOld(o.spot).opacity,this.klHistory.pause(!0);return}if(s){this.klHistory.pause(!1),e!==t&&this.klCanvas.setOpacity(o.spot,t);return}o.opacityLabel.innerHTML=Math.round(100*t)+"%",this.klCanvas.setOpacity(o.spot,t),this.onUpdateProject()}});(0,$VM6dD.css)(d.getElement(),{position:"absolute",left:39+$a4100dd1ad7b3844$var$paddingLeft+"px",top:"17px"}),o.opacitySlider=d,o.thumb.onpointerover=t=>{if(0!==t.buttons&&(!t.pointerType||"touch"!==t.pointerType))return;let e=$2Eggz.BB.fitInto(a.width,a.height,250,250,1);(this.largeThumbCanvas.width!==e.width||this.largeThumbCanvas.height!==e.height)&&(this.largeThumbCanvas.width=e.width,this.largeThumbCanvas.height=e.height);let i=$2Eggz.BB.ctx(this.largeThumbCanvas);i.save(),this.largeThumbCanvas.width>a.width&&(i.imageSmoothingEnabled=!1),i.imageSmoothingQuality="high",i.clearRect(0,0,this.largeThumbCanvas.width,this.largeThumbCanvas.height),i.drawImage(a,0,0,this.largeThumbCanvas.width,this.largeThumbCanvas.height),i.restore(),(0,$VM6dD.css)(this.largeThumbDiv,{top:t.clientY-this.largeThumbCanvas.height/2+"px",opacity:"0"}),this.largeThumbInDocument||(document.body.append(this.largeThumbDiv),this.largeThumbInDocument=!0),clearTimeout(this.largeThumbInTimeout),this.largeThumbInTimeout=setTimeout(()=>{(0,$VM6dD.css)(this.largeThumbDiv,{opacity:"1"})},20),clearTimeout(this.largeThumbTimeout)},o.thumb.onpointerout=()=>{clearTimeout(this.largeThumbInTimeout),(0,$VM6dD.css)(this.largeThumbDiv,{opacity:"0"}),clearTimeout(this.largeThumbTimeout),this.largeThumbTimeout=setTimeout(()=>{this.largeThumbInDocument&&(this.largeThumbDiv.remove(),this.largeThumbInDocument=!1)},300)},h.append(o.thumb,o.label,o.opacityLabel,d.getElement());let p=!1,u=!1,g=t=>{if("pointerdown"===t.type&&"left"===t.button)(0,$VM6dD.css)(o,{transition:"box-shadow 0.3s ease-in-out",zIndex:"1"}),this.lastpos=o.spot,u=!1,o.isSelected||(u=!0,this.activateLayer(o.spot)),p=!0;else if("pointermove"===t.type&&"left"===t.button){p&&(p=!1,(0,$VM6dD.css)(o,{boxShadow:"1px 3px 5px rgba(0,0,0,0.4)"})),o.posY+=t.dY;let e=Math.max(0,Math.min((this.klCanvasLayerArr.length-1)*35,o.posY));o.style.top=e+"px",this.updateLayersVerticalPosition(o.spot,this.posToSpot(o.posY))}if("pointerup"===t.type){(0,$VM6dD.css)(o,{transition:"all 0.1s linear"}),setTimeout(()=>{(0,$VM6dD.css)(o,{boxShadow:""})},20),o.posY=Math.max(0,Math.min((this.klCanvasLayerArr.length-1)*35,o.posY)),o.style.zIndex="";let t=this.posToSpot(o.posY),e=o.spot;this.move(o.spot,t),e!=t&&this.onSelect(this.selectedSpotIndex,!1),e===t&&u&&(this.applyUncommitted(),this.onSelect(this.selectedSpotIndex,!0)),u=!1}};o.pointerListener=new $2Eggz.BB.PointerListener({target:h,onPointer:g}),this.layerListEl.append(o)};for(this.layerElArr=[];this.layerListEl.firstChild;){let t=this.layerListEl.firstChild;t.pointerListener.destroy(),t.opacitySlider.destroy(),t.remove()}for(let t=0;t<this.klCanvasLayerArr.length;t++)e(t);this.activateLayer(this.selectedSpotIndex),this.updateHeight()}updateButtons(){let t=this.klCanvasLayerArr.length===$d26b85e649dca02a$export$9f4f73b1bd7c2f26,e=1===this.klCanvasLayerArr.length;this.addBtn.disabled=t,this.removeBtn.disabled=e,this.duplicateBtn.disabled=t,this.mergeBtn.disabled=0===this.selectedSpotIndex,this.moreDropdown.setEnabled("advanced-merge",!e),this.moreDropdown.setEnabled("merge-all",!e)}update(t){this.klCanvasLayerArr=this.klCanvas.getLayers(),(t||0===t)&&(this.selectedSpotIndex=t),this.updateButtons(),setTimeout(()=>this.createLayerList(),1)}getSelected(){return this.selectedSpotIndex}activateLayer(t){if(t<0||t>this.layerElArr.length-1)throw"invalid spotIndex "+t+", layerElArr.length "+this.layerElArr.length;this.selectedSpotIndex=t,this.modeSelect.setValue(this.klCanvasLayerArr[this.selectedSpotIndex].mixModeStr);for(let t=0;t<this.layerElArr.length;t++){let e=this.layerElArr[t],i=this.selectedSpotIndex===e.spot;(0,$VM6dD.css)(e,{boxShadow:""}),e.classList.toggle("kl-layer--selected",i),e.opacitySlider.setActive(i),e.isSelected=i}this.mergeBtn.disabled=0===this.selectedSpotIndex}setUiState(t){this.uiState=t,"left"===this.uiState?(0,$VM6dD.css)(this.largeThumbDiv,{left:"280px",right:""}):(0,$VM6dD.css)(this.largeThumbDiv,{left:"",right:"280px"})}getElement(){return this.rootEl}constructor(t){let e;this.lastpos=0,this.layerHeight=35,this.layerSpacing=0,this.klCanvas=t.klCanvas,this.onSelect=t.onSelect,this.parentEl=t.parentEl,this.uiState=t.uiState,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.onUpdateProject=t.onUpdateProject,this.onClearLayer=t.onClearLayer,this.layerElArr=[],this.layerHeight=35,this.layerSpacing=0;let i=270;this.largeThumbDiv=$2Eggz.BB.el({onClick:$2Eggz.BB.handleClick,css:{position:"absolute",top:"500px",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",pointerEvents:"none",padding:"0",border:"1px solid #aaa",transition:"opacity 0.3s ease-out",userSelect:"none",background:"var(--kl-checkerboard-background)"}}),this.setUiState(this.uiState),this.largeThumbCanvas=$2Eggz.BB.canvas(200,200),this.largeThumbCanvas.style.display="block",this.largeThumbDiv.append(this.largeThumbCanvas),this.largeThumbInDocument=!1,this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=this.klCanvasLayerArr.length-1,this.rootEl=$2Eggz.BB.el({css:{marginRight:"10px",marginBottom:"10px",marginLeft:"10px",marginTop:"10px",cursor:"default",position:"relative",zIndex:"0"}});let s=$2Eggz.BB.el({css:{width:i+"px",position:"relative",margin:"0 -10px",zIndex:"0"}});this.layerListEl=$2Eggz.BB.el({parent:s}),this.addBtn=$2Eggz.BB.el({tagName:"button"}),this.duplicateBtn=$2Eggz.BB.el({tagName:"button"}),this.mergeBtn=$2Eggz.BB.el({tagName:"button"}),this.removeBtn=$2Eggz.BB.el({tagName:"button"});let n=$2Eggz.BB.el({tagName:"button"});this.moreDropdown=new $be599a9dc46f5101$export$e44a253a59704894({button:$2Eggz.BB.el({content:`<img src="${$parcel$interopDefault($7dc8b75d4dbc1df5$exports)}" width="13"/>`,css:{display:"flex",justifyContent:"center",opacity:"0.9"}}),buttonTitle:$63d0b335c576c718$export$ce37e184d908d785("more"),items:[["clear-layer",$63d0b335c576c718$export$ce37e184d908d785("layers-clear")],["advanced-merge",$63d0b335c576c718$export$ce37e184d908d785("layers-merge-advanced")],["merge-all",$63d0b335c576c718$export$ce37e184d908d785("layers-merge-all")]],onItemClick:t=>{if("clear-layer"===t&&(this.applyUncommitted(),this.onClearLayer()),"advanced-merge"===t){if(this.applyUncommitted(),this.selectedSpotIndex<=0)return;$e304a6ae1452211c$export$ee79aceabae6bb8a(this.parentEl,{topCanvas:this.klCanvasLayerArr[this.selectedSpotIndex].context.canvas,bottomCanvas:this.klCanvasLayerArr[this.selectedSpotIndex-1].context.canvas,topOpacity:this.klCanvas.getLayerOld(this.selectedSpotIndex).opacity,mixModeStr:this.klCanvasLayerArr[this.selectedSpotIndex].mixModeStr,callback:t=>{this.klCanvas.mergeLayers(this.selectedSpotIndex,this.selectedSpotIndex-1,t),this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex--,this.onSelect(this.selectedSpotIndex,!1),this.updateButtons()}})}if("merge-all"===t){this.applyUncommitted();let t=this.klCanvas.mergeAll();if(!1===t)return;this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=t,this.onSelect(this.selectedSpotIndex,!1),this.updateButtons()}}}),this.updateButtons();let r=()=>{let t=$2Eggz.BB.el();return setTimeout(()=>{(0,$jmKbV.makeUnfocusable)(this.addBtn),(0,$jmKbV.makeUnfocusable)(this.duplicateBtn),(0,$jmKbV.makeUnfocusable)(this.mergeBtn),(0,$jmKbV.makeUnfocusable)(this.removeBtn),(0,$jmKbV.makeUnfocusable)(n);let e={cssFloat:"left",paddingLeft:"5px",paddingRight:"3px"};(0,$VM6dD.css)(this.addBtn,e),(0,$VM6dD.css)(this.duplicateBtn,e),(0,$VM6dD.css)(this.mergeBtn,e),(0,$VM6dD.css)(this.removeBtn,e),(0,$VM6dD.css)(n,{cssFloat:"left",height:"30px",lineHeight:"20px"}),this.addBtn.title=$63d0b335c576c718$export$ce37e184d908d785("layers-new"),this.duplicateBtn.title=$63d0b335c576c718$export$ce37e184d908d785("layers-duplicate"),this.removeBtn.title=$63d0b335c576c718$export$ce37e184d908d785("layers-remove"),this.mergeBtn.title=$63d0b335c576c718$export$ce37e184d908d785("layers-merge"),n.title=$63d0b335c576c718$export$ce37e184d908d785("layers-rename-title"),this.addBtn.innerHTML="<img src='"+$parcel$interopDefault($4dde6a6ccaabd5ab$exports)+"' height='20'/>",this.duplicateBtn.innerHTML="<img src='"+$parcel$interopDefault($0ecce9fc138ec1e3$exports)+"' height='20'/>",this.mergeBtn.innerHTML="<img src='"+$parcel$interopDefault($be3ab0e4c204533c$exports)+"' height='20'/>",this.removeBtn.innerHTML="<img src='"+$parcel$interopDefault($03e87c70019af696$exports)+"' height='20'/>",n.innerHTML="<img src='"+$parcel$interopDefault($7444ed87edb442c4$exports)+"' height='20'/>",t.append($934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-5,mb-10",[this.addBtn,this.removeBtn,this.duplicateBtn,this.mergeBtn,$934e5f47c3374e21$export$db3b6bfb95261072({className:"kl-info-btn",onClick:()=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:document.body,message:'Advanced merge dialog moved to: <br> More > Advanced Merge<br><br><img src="'+$parcel$interopDefault($2cf698fade3d7a89$exports)+'">'})},noRef:!0,css:{marginTop:"5px",fontWeight:"normal"}},"i"),n,$934e5f47c3374e21$export$db3b6bfb95261072(",grow-1"),this.moreDropdown.getElement()])),this.addBtn.onclick=()=>{this.applyUncommitted(),!1!==this.klCanvas.addLayer(this.selectedSpotIndex)&&(this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex=this.selectedSpotIndex+1,this.onSelect(this.selectedSpotIndex,!1),this.updateButtons())},this.duplicateBtn.onclick=()=>{this.applyUncommitted(),!1!==this.klCanvas.duplicateLayer(this.selectedSpotIndex)&&(this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex++,this.onSelect(this.selectedSpotIndex,!1),this.updateButtons())},this.removeBtn.onclick=()=>{this.applyUncommitted(),this.layerElArr.length<=1||(this.klCanvas.removeLayer(this.selectedSpotIndex),this.selectedSpotIndex>0&&this.selectedSpotIndex--,this.klCanvasLayerArr=this.klCanvas.getLayers(),this.onSelect(this.selectedSpotIndex,!1),this.updateButtons())},this.mergeBtn.onclick=()=>{this.applyUncommitted(),this.selectedSpotIndex<=0||(this.klCanvas.mergeLayers(this.selectedSpotIndex,this.selectedSpotIndex-1),this.klCanvasLayerArr=this.klCanvas.getLayers(),this.selectedSpotIndex--,this.onSelect(this.selectedSpotIndex,!1),this.updateButtons())},n.onclick=()=>{this.applyUncommitted(),this.renameLayer(this.selectedSpotIndex)}},1),t};this.rootEl.append(r()),e=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("layers-blending")+"&nbsp;",css:{fontSize:"15px"}}),this.modeSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:["source-over",void 0,"darken","multiply","color-burn",void 0,"lighten","screen","color-dodge",void 0,"overlay","soft-light","hard-light",void 0,"difference","exclusion",void 0,"hue","saturation","color","luminosity"].map(t=>t?[t,$326f2f7e3662b29f$export$6e1bedb2a6cdff30(t)]:void 0),onChange:t=>{this.klCanvas.setMixMode(this.selectedSpotIndex,t),this.update(this.selectedSpotIndex)},css:{marginBottom:"10px"},name:"layer-blend-mode"}),e.append(this.modeSelect.getElement()),this.rootEl.append(e),this.rootEl.append(s),this.klHistory.addListener(()=>{"block"===this.rootEl.style.display&&this.createLayerList()}),this.createLayerList()}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $1ac505c1a3109a32$export$e258ade1648009b7{getElement(){return this.canvas}render(){if(this.ctx){this.ctx.save(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=0;t<this.layers.length;t++){let e=this.layers[t];e.isVisible&&0!==e.opacity&&(this.ctx.globalAlpha=this.layers[t].opacity,this.ctx.globalCompositeOperation=this.layers[t].mixModeStr,this.canvas.width>this.layers[t].image.width&&(this.ctx.imageSmoothingEnabled=!1),this.ctx.drawImage(this.layers[t].image,0,0,this.canvas.width,this.canvas.height))}this.ctx.restore()}}destroy(){}constructor(t){this.layers=t.layers;let e=t.width/t.layers[0].image.width,i=e>1?t.layers[0].image.width:t.width,s=e>1?t.layers[0].image.height:t.height;this.canvas=$2Eggz.BB.canvas(i,s),this.ctx=$2Eggz.BB.ctx(this.canvas),(0,$VM6dD.css)(this.canvas,{width:"100%",height:"100%",imageRendering:e>1?"pixelated":void 0,background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}),setTimeout(()=>this.render(),0)}}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$69ac20eb6dca0794$exports={};$69ac20eb6dca0794$exports=$parcel$resolve("8BBCz");var $2Eggz=parcelRequire("2Eggz");function $9e052f3767af1736$export$958c2bfe8d7142a9(t){if(Math.abs(t.angleDeg)%90!=0)return;t.width=Math.round(t.width),t.height=Math.round(t.height);let e=Math.abs(t.angleDeg-90)%180==0;t.x=(e?t.height:t.width)%2==0?Math.round(t.x):Math.round(t.x-.5)+.5,t.y=(e?t.width:t.height)%2==0?Math.round(t.y):Math.round(t.y-.5)+.5}function $9e052f3767af1736$export$6a4549ec4168874a(t,e,i){let s,n;s=t-i.x,n=e-i.y;let r=$2Eggz.BB.rotateAround({x:0,y:0},{x:s,y:n},-i.angleDeg);return{x:s=r.x,y:n=r.y}}function $9e052f3767af1736$export$3fba3b383c654cc6(t,e,i){let s=$2Eggz.BB.rotateAround({x:0,y:0},{x:t,y:e},i.angleDeg);return{x:s.x+i.x,y:s.y+i.y}}var $VM6dD=parcelRequire("VM6dD"),$8cWis=parcelRequire("8cWis");let $d42d1384577ab84d$var$gripSize=16,$d42d1384577ab84d$var$edgeSize=10;function $d42d1384577ab84d$var$angleDegToCursor(t){let e=["e","ne","n","nw","w","sw","s","se"];for(;t<0;)t+=360;let i=Math.round(t/45)%e.length;return e[i]+"-resize"}class $d42d1384577ab84d$export$79a74567acf241b0{updateScaled(){let t=$855520c81dfcb96a$export$9b20165a36586806($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),{x:this.value.x,y:this.value.y});this.rectInViewport.x=t.x,this.rectInViewport.y=t.y,this.rectInViewport.width=this.value.width*this.viewportTransform.scale,this.rectInViewport.height=this.value.height*this.viewportTransform.scale,this.rectInViewport.corners=this.corners.map(t=>({x:t.x*this.viewportTransform.scale,y:t.y*this.viewportTransform.scale}))}snapCorner(t,e){var i,s;let n;if(!this.snappingEnabled)return{x:t,y:e};let r={x:void 0,y:void 0,dist:{x:void 0,y:void 0}};for(let e=0;e<this.snapX.length;e++)(n=Math.abs(t-this.snapX[e]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===r.x||n<r.dist.x)&&(r.x=this.snapX[e],r.dist.x=n);for(let t=0;t<this.snapY.length;t++)(n=Math.abs(e-this.snapY[t]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===r.y||n<r.dist.y)&&(r.y=this.snapY[t],r.dist.y=n);return void 0===r.x&&void 0===r.y?{x:t,y:e}:{x:null!=(i=r.x)?i:t,y:null!=(s=r.y)?s:e}}constrainCorner(t,e,i){if(!this.isConstrained)return{x:e,y:i};let s=this.value.width*this.value.height<0?-1:1;return $2Eggz.BB.projectPointOnLine({x:this.value.x,y:this.value.y},$9e052f3767af1736$export$3fba3b383c654cc6(this.ratio,s*([0,2].includes(t)?1:-1),this.value),{x:e,y:i})}updateCornerPositions(){this.corners[0].x=-this.value.width/2,this.corners[0].y=-this.value.height/2,this.corners[1].x=this.value.width/2,this.corners[1].y=-this.value.height/2,this.corners[2].x=this.value.width/2,this.corners[2].y=this.value.height/2,this.corners[3].x=-this.value.width/2,this.corners[3].y=this.value.height/2}restoreRatio(t,e){if(!this.isConstrained)return;let i=Math.abs(this.value.angleDeg)%90==0,s=Math.abs(this.value.angleDeg-90)%180==0;if(e&&!t){let t=Math.abs(this.corners[3].y-this.corners[0].y),e=this.ratio*t;i&&(e=(s?this.value.y%1:this.value.x%1)==0?$2Eggz.BB.roundEven(e):$2Eggz.BB.roundUneven(e)),this.corners[1].x-this.corners[0].x<0&&(e*=-1),this.corners[0].x=-e/2,this.corners[3].x=-e/2,this.corners[1].x=e/2,this.corners[2].x=e/2}if(!e&&t){let t=Math.abs(this.corners[0].x-this.corners[1].x)/this.ratio;i&&(t=(s?this.value.x%1:this.value.y%1)==0?$2Eggz.BB.roundEven(t):$2Eggz.BB.roundUneven(t)),this.corners[3].y-this.corners[0].y<0&&(t*=-1),this.corners[0].y=-t/2,this.corners[1].y=-t/2,this.corners[2].y=t/2,this.corners[3].y=t/2}}updateTransformViaCorners(){let t=$2Eggz.BB.rotateAround({x:0,y:0},{x:(this.corners[0].x+this.corners[1].x)/2,y:(this.corners[0].y+this.corners[3].y)/2},this.value.angleDeg);this.value.x=t.x+this.value.x,this.value.y=t.y+this.value.y,this.value.width=this.corners[1].x-this.corners[0].x,this.value.height=this.corners[3].y-this.corners[0].y,this.updateCornerPositions(),this.updateDOM()}updateDOM(t){this.updateScaled(),(0,$VM6dD.css)(this.transEl,{left:this.rectInViewport.x+"px",top:this.rectInViewport.y+"px",transformOrigin:"0 0",transform:"rotate("+(this.value.angleDeg+this.viewportTransform.angleDeg)+"deg)"}),(0,$VM6dD.css)(this.boundsEl,{width:Math.abs(this.rectInViewport.width)+"px",height:Math.abs(this.rectInViewport.height)+"px",left:Math.min(this.rectInViewport.corners[0].x,this.rectInViewport.corners[1].x)+"px",top:Math.min(this.rectInViewport.corners[0].y,this.rectInViewport.corners[3].y)+"px"}),this.corners[0].updateDOM(),this.corners[1].updateDOM(),this.corners[2].updateDOM(),this.corners[3].updateDOM(),this.edges[0].updateDOM(),this.edges[1].updateDOM(),this.edges[2].updateDOM(),this.edges[3].updateDOM(),this.angleGrip.x=0,this.angleGrip.y=-Math.abs(this.value.height*this.viewportTransform.scale)/2-20,this.angleGrip.updateDOM(),!t&&this.callback&&this.callback((0,$wpIFA._)({},this.value))}getValue(){return(0,$wpIFA._)({},this.value)}setIsConstrained(t){this.isConstrained=t,t&&0!==this.value.width&&0!==this.value.height&&(this.ratio=Math.abs(this.value.width/this.value.height))}setSnapping(t){this.snappingEnabled=t}setSnappingPoints(t,e){this.snapX=t,this.snapY=e}setPos(t){this.value.x=t.x,this.value.y=t.y,this.updateDOM(!0)}move(t,e){this.value.x+=t,this.value.y+=e,this.updateDOM(!1)}setSize(t,e){this.value.width=t,this.value.height=e,Math.abs(this.value.angleDeg)%90==0&&$9e052f3767af1736$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions(),this.updateDOM(!1)}initialise(t){this.value.x=t.x,this.value.y=t.y,this.value.width=t.width,this.value.height=t.height,this.value.angleDeg=t.angleDeg,this.ratio=Math.abs(t.width/t.height),this.updateCornerPositions(),this.updateDOM(!0)}setAngleDeg(t){this.value.angleDeg=t,Math.abs(this.value.angleDeg)%90==0&&($9e052f3767af1736$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions()),this.updateDOM(!0)}setViewportTransform(t){this.viewportTransform=(0,$wpIFA._)({},t),this.updateScaled(),this.updateDOM()}getElement(){return this.rootEl}getRatio(){return this.ratio}destroy(){this.keyListener.destroy(),this.boundsPointerListener.destroy(),this.corners.forEach(t=>t.pointerListener.destroy()),this.edges.forEach(t=>t.pointerListener.destroy()),this.anglePointerListener.destroy()}constructor(t){let e;this.rectInViewport={x:0,y:0,width:0,height:0,corners:[{x:0,y:0}]},this.minSnapDist=7,this.corners=[],this.edges=[],this.viewportTransform=(0,$wpIFA._)({},t.viewportTransform),this.value={x:t.x,y:t.y,width:t.width,height:t.height,angleDeg:t.angleDeg},this.isConstrained=t.isConstrained,this.snapX=t.snapX,this.snapY=t.snapY,this.callback=t.callback,this.snappingEnabled=!0,this.ratio=this.value.width/this.value.height;let i=t.onWheel?e=>{if(!t.onWheel||!t.wheelParent)return;let i=t.wheelParent.getBoundingClientRect();e.relX=e.pageX-i.left,e.relY=e.pageY-i.top,t.onWheel(e)}:void 0;this.rootEl=$2Eggz.BB.el({className:"kl-free-transform",css:{userSelect:"none"}}),this.transEl=$2Eggz.BB.el({parent:this.rootEl,css:{position:"absolute"}}),this.boundsEl=$2Eggz.BB.el({css:{position:"absolute",cursor:"move",boxShadow:"rgba(255, 255, 255, 0.5) 0 0 0 1px inset, rgba(0, 0, 0, 0.5) 0 0 0 1px"}});let s={x:0,y:0};function n(){s.x=0,s.y=0}this.keyListener=new $2Eggz.BB.KeyListener({});let r={x:0,y:0};this.boundsPointerListener=new $2Eggz.BB.PointerListener({target:this.boundsEl,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointerdown"===t.type&&(r={x:this.value.x,y:this.value.y}),"pointermove"===t.type&&"left"===t.button){let e,i=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),s=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(i),{x:t.downPageX,y:t.downPageY}),n=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(i),{x:t.pageX,y:t.pageY}),a={x:n.x-s.x,y:n.y-s.y};this.value.x=r.x+a.x,this.value.y=r.y+a.y;let o={distX:-1,distY:-1};if(this.snappingEnabled){let t,i;for(t=0;t<this.snapX.length;t++)(e=Math.abs(this.value.x-this.snapX[t]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===o.x||e<o.distX)&&(o.x=this.snapX[t],o.distX=e);for(t=0;t<this.snapY.length;t++)(e=Math.abs(this.value.y-this.snapY[t]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===o.y||e<o.distY)&&(o.y=this.snapY[t],o.distY=e);for(t=0;t<4;t++){let s;for(s=0,i=$9e052f3767af1736$export$3fba3b383c654cc6(this.corners[t].x,this.corners[t].y,this.value);s<this.snapX.length;s++)(e=Math.abs(i.x-this.snapX[s]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===o.x||e<o.distX)&&(o.x=this.snapX[s]-(i.x-this.value.x),o.distX=e);for(s=0;s<this.snapY.length;s++)(e=Math.abs(i.y-this.snapY[s]))<this.minSnapDist/this.viewportTransform.scale&&(void 0===o.y||e<o.distY)&&(o.y=this.snapY[s]-(i.y-this.value.y),o.distY=e)}}if("shift"===this.keyListener.getComboStr()){let t=$2Eggz.BB.projectPointOnLine({x:0,y:r.y},{x:10,y:r.y},{x:this.value.x,y:this.value.y}),e=$2Eggz.BB.dist(t.x,t.y,this.value.x,this.value.y);o={x:t.x,y:t.y,distX:e,distY:e},t=$2Eggz.BB.projectPointOnLine({x:r.x,y:0},{x:r.x,y:10},{x:this.value.x,y:this.value.y}),(e=$2Eggz.BB.dist(t.x,t.y,this.value.x,this.value.y))<o.distX&&(o={x:t.x,y:t.y,distX:e,distY:e}),t=$2Eggz.BB.projectPointOnLine({x:r.x,y:r.y},{x:r.x+1,y:r.y+1},{x:this.value.x,y:this.value.y}),(e=$2Eggz.BB.dist(t.x,t.y,this.value.x,this.value.y))<o.distX&&(o={x:t.x,y:t.y,distX:e,distY:e}),t=$2Eggz.BB.projectPointOnLine({x:r.x,y:r.y},{x:r.x+1,y:r.y-1},{x:this.value.x,y:this.value.y}),(e=$2Eggz.BB.dist(t.x,t.y,this.value.x,this.value.y))<o.distX&&(o={x:t.x,y:t.y,distX:e,distY:e})}void 0!=o.x&&(this.value.x=o.x),void 0!=o.y&&(this.value.y=o.y),Math.abs(this.value.angleDeg)%90==0&&($9e052f3767af1736$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions()),this.updateDOM()}},useDirtyWheel:!0,onWheel:i});for(let t=0;t<4;t++)(t=>{let e=this.corners[t]={i:t,el:$2Eggz.BB.el({css:{width:$d42d1384577ab84d$var$gripSize+"px",height:$d42d1384577ab84d$var$gripSize+"px",background:"#fff",borderRadius:$d42d1384577ab84d$var$gripSize+"px",position:"absolute",border:"2px solid #000"}}),x:0,y:0,virtualPos:{x:0,y:0}};e.updateDOM=()=>{let i=[[-1,-1],[1,-1],[1,1],[-1,1]].map(t=>(t[0]*=this.value.width>0?1:-1,t[1]*=this.value.height>0?1:-1,t)),s=10*!!(20>Math.abs(this.rectInViewport.width)||20>Math.abs(this.rectInViewport.height));(0,$VM6dD.css)(e.el,{left:this.rectInViewport.corners[e.i].x-$d42d1384577ab84d$var$gripSize/2+i[t][0]*s+"px",top:this.rectInViewport.corners[e.i].y-$d42d1384577ab84d$var$gripSize/2+i[t][1]*s+"px"});let n=this.value.width<0?-1:1,r=this.value.height<0?-1:1,a=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],o={x:a[t].x*n,y:-(a[t].y*r*1)},l=(0,$8cWis.pointsToAngleDeg)({x:0,y:0},o)-this.value.angleDeg-this.viewportTransform.angleDeg;(0,$VM6dD.css)(e.el,{cursor:$d42d1384577ab84d$var$angleDegToCursor(l)})},e.pointerListener=new $2Eggz.BB.PointerListener({target:this.corners[t].el,fixScribble:!0,onPointer:e=>{if(e.eventPreventDefault(),"pointerdown"===e.type&&"left"===e.button)this.corners[t].virtualPos=$9e052f3767af1736$export$3fba3b383c654cc6(this.corners[t].x,this.corners[t].y,this.value);else if("pointermove"===e.type&&"left"===e.button){let i=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),s=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(i),{x:0,y:0}),n=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(i),{x:e.dX,y:e.dY}),r={x:n.x-s.x,y:n.y-s.y};this.corners[t].virtualPos.x+=r.x,this.corners[t].virtualPos.y+=r.y;let a={x:this.corners[t].virtualPos.x,y:this.corners[t].virtualPos.y};a=this.constrainCorner(t,a.x,a.y),this.isConstrained||(a=this.snapCorner(a.x,a.y)),Math.abs(this.value.angleDeg)%90==0&&(a.x=Math.round(a.x),a.y=Math.round(a.y));let o=$9e052f3767af1736$export$6a4549ec4168874a(a.x,a.y,this.value),l=o.x-this.corners[t].x,h=o.y-this.corners[t].y;this.corners[t].x=o.x,this.corners[t].y=o.y;let c=[];0===t?c=[3,1,2]:1===t?c=[2,0,3]:2===t?c=[1,3,0]:3===t&&(c=[0,2,1]),this.corners[c[0]].x=this.corners[t].x,this.corners[c[1]].y=this.corners[t].y,this.keyListener.isPressed("shift")&&(this.corners[c[2]].x-=l,this.corners[c[2]].y-=h,this.corners[c[1]].x=this.corners[c[2]].x,this.corners[c[0]].y=this.corners[c[2]].y),this.updateTransformViaCorners()}},useDirtyWheel:!0,onWheel:i})})(t);this.updateCornerPositions(),this.updateScaled();for(let t=0;t<4;t++)(t=>{this.edges[t]={el:$2Eggz.BB.el({css:{width:$d42d1384577ab84d$var$edgeSize+"px",height:$d42d1384577ab84d$var$edgeSize+"px",position:"absolute"}})};let r=this.edges[t];r.updateDOM=()=>{0===t?(0,$VM6dD.css)(r.el,{left:Math.min(this.rectInViewport.corners[0].x,this.rectInViewport.corners[1].x)+"px",top:Math.min(this.rectInViewport.corners[0].y,this.rectInViewport.corners[3].y)-$d42d1384577ab84d$var$edgeSize+"px",width:Math.abs(this.rectInViewport.width)+"px",height:$d42d1384577ab84d$var$edgeSize+"px"}):1===t?(0,$VM6dD.css)(r.el,{left:Math.max(this.rectInViewport.corners[0].x,this.rectInViewport.corners[1].x)+"px",top:Math.min(this.rectInViewport.corners[1].y,this.rectInViewport.corners[2].y)+"px",width:$d42d1384577ab84d$var$edgeSize+"px",height:Math.abs(this.rectInViewport.height)+"px"}):2===t?(0,$VM6dD.css)(r.el,{left:Math.min(this.rectInViewport.corners[3].x,this.rectInViewport.corners[2].x)+"px",top:Math.max(this.rectInViewport.corners[0].y,this.rectInViewport.corners[3].y)+"px",width:Math.abs(this.rectInViewport.width)+"px",height:$d42d1384577ab84d$var$edgeSize+"px"}):3===t&&(0,$VM6dD.css)(r.el,{left:Math.min(this.rectInViewport.corners[0].x,this.rectInViewport.corners[1].x)-$d42d1384577ab84d$var$edgeSize+"px",top:Math.min(this.rectInViewport.corners[0].y,this.rectInViewport.corners[3].y)+"px",width:$d42d1384577ab84d$var$edgeSize+"px",height:Math.abs(this.rectInViewport.height)+"px"});let e=this.value.width<0,i=this.value.height<0,s=[i?-90:90,180*!!e,i?90:-90,180*!e][t]-this.value.angleDeg-this.viewportTransform.angleDeg;(0,$VM6dD.css)(r.el,{cursor:$d42d1384577ab84d$var$angleDegToCursor(s)})};let a=[0,2].includes(t);r.pointerListener=new $2Eggz.BB.PointerListener({target:this.edges[t].el,fixScribble:!0,onPointer:i=>{if(i.eventPreventDefault(),"pointerdown"===i.type&&"left"===i.button&&(e=a?this.corners[0].y>=this.corners[3].y:this.corners[0].x>=this.corners[1].x,n()),"pointermove"===i.type&&"left"===i.button){let n=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),r=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(n),{x:0,y:0}),o=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(n),{x:i.dX,y:i.dY}),l=$9e052f3767af1736$export$6a4549ec4168874a(r.x,r.y,this.value),h=$9e052f3767af1736$export$6a4549ec4168874a(o.x,o.y,this.value),c={x:h.x-l.x,y:h.y-l.y},d={dX:c.x,dY:c.y};Math.abs(this.value.angleDeg)%90==0&&(d=$2Eggz.BB.intDxy(s,c.x,c.y));let p=[];0===t?p=[2,3,0,1]:1===t?p=[0,3,1,2]:2===t?p=[0,1,2,3]:3===t&&(p=[1,2,0,3]);let u=a?"y":"x",g=a?d.dY:d.dX;e?(this.corners[p[0]][u]+=g,this.corners[p[1]][u]+=g):(this.corners[p[2]][u]+=g,this.corners[p[3]][u]+=g),this.keyListener.isPressed("shift")&&(e?(this.corners[p[2]][u]-=g,this.corners[p[3]][u]-=g):(this.corners[p[0]][u]-=g,this.corners[p[1]][u]-=g)),a?this.restoreRatio(!1,!0):this.restoreRatio(!0,!1),this.updateTransformViaCorners()}},useDirtyWheel:!0,onWheel:i})})(t);this.angleGrip={el:$2Eggz.BB.el({css:{cursor:"url("+$parcel$interopDefault($69ac20eb6dca0794$exports)+") 10 10, move",width:$d42d1384577ab84d$var$gripSize+"px",height:$d42d1384577ab84d$var$gripSize+"px",background:"#0ff",borderRadius:$d42d1384577ab84d$var$gripSize+"px",position:"absolute",boxShadow:"inset 0 0 0 2px #000"}}),x:0,y:0,snap:!1,updateDOM:()=>{(0,$VM6dD.css)(this.angleGrip.el,{left:this.angleGrip.x-$d42d1384577ab84d$var$gripSize/2+"px",top:this.angleGrip.y-$d42d1384577ab84d$var$gripSize/2+"px"})}},$2Eggz.BB.el({parent:this.angleGrip.el,css:{width:"2px",height:"13px",left:$d42d1384577ab84d$var$gripSize/2-1+"px",top:$d42d1384577ab84d$var$gripSize+"px",background:"#0ff",position:"absolute"}}),this.anglePointerListener=new $2Eggz.BB.PointerListener({target:this.angleGrip.el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let e=$00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewportTransform),i=this.rootEl.getBoundingClientRect(),s={x:t.clientX-i.left,y:t.clientY-i.top},n=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(e),s),r=$2Eggz.BB.pointsToAngleDeg({x:this.value.x,y:this.value.y},n)+90;this.value.angleDeg=r;let a=45*Math.round(r/360*8);"shift"===this.keyListener.getComboStr()?this.value.angleDeg=a:this.snappingEnabled&&8>Math.abs(a-r)&&(this.value.angleDeg=a),this.updateDOM()}"pointerup"===t.type&&Math.abs(this.value.angleDeg)%90==0&&($9e052f3767af1736$export$958c2bfe8d7142a9(this.value),this.updateCornerPositions(),this.updateDOM())},useDirtyWheel:!0,onWheel:i}),$9e052f3767af1736$export$958c2bfe8d7142a9(this.value),this.updateDOM(!0),$2Eggz.BB.append(this.transEl,[this.boundsEl,this.edges[0].el,this.edges[1].el,this.edges[2].el,this.edges[3].el,this.corners[0].el,this.corners[1].el,this.corners[2].el,this.corners[3].el,this.angleGrip.el])}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $1fee4e0c7c231d15$export$205c2dd29f8a66b5{updatePreview(){let t=this.freeTransform.getValue(),e=$2Eggz.BB.ctx(this.previewCanvas);e.save(),e.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),$2Eggz.BB.drawTransformedImageWithBounds(e,this.layers[this.transformIndex].image,t,void 0,"pixelated"===this.algorithm||$2Eggz.BB.testShouldPixelate(t,t.width/this.initTransform.width,t.height/this.initTransform.height)),e.restore(),this.preview.render()}move(t,e){this.freeTransform.move(t,e)}reset(){let t=this.layers[this.transformIndex].image.width,e=this.layers[this.transformIndex].image.height;this.freeTransform.setSize(t,e),this.freeTransform.setPos({x:t/2,y:e/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}setTransformFit(){let t=$2Eggz.BB.fitInto(this.layers[this.transformIndex].image.width,this.layers[this.transformIndex].image.height,this.imageWidth,this.imageHeight,1);this.freeTransform.setSize(t.width,t.height),this.freeTransform.setPos({x:t.width/2,y:t.height/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}setTransformCenter(){this.freeTransform.setPos({x:this.imageWidth/2,y:this.imageHeight/2}),this.freeTransform.setAngleDeg(0),this.updatePreview()}setAlgorithm(t){this.algorithm=t,this.updatePreview()}getTransformation(){return this.freeTransform.getValue()}getIsPixelated(){let t=this.freeTransform.getValue();return"pixelated"===this.algorithm||$2Eggz.BB.testShouldPixelate(t,t.width/this.initTransform.width,t.height/this.initTransform.height)}getElement(){return this.rootEl}destroy(){this.freeTransform.destroy(),this.preview.destroy(),$2Eggz.BB.freeCanvas(this.previewCanvas)}constructor(t){this.algorithm="smooth",this.imageWidth=t.imageWidth,this.imageHeight=t.imageHeight,this.rootEl=$2Eggz.BB.el({className:"kl-preview-wrapper",css:{width:t.elementWidth+"px",height:t.elementHeight+"px"}}),this.rootEl.oncontextmenu=()=>!1,this.layers=t.layers,this.transformIndex=t.transformIndex,this.previewLayerArr=this.layers.map(t=>{var e;return{image:t.image,isVisible:t.isVisible,mixModeStr:null!=(e=t.mixModeStr)?e:"source-over",opacity:t.opacity,hasClipping:!1}}),this.previewCanvas=$2Eggz.BB.canvas(this.imageWidth,this.imageHeight),this.previewLayerArr[this.previewLayerArr.length-1].image=this.previewCanvas,this.preview=new $324add89932145ee$export$133773870222880f({width:t.elementWidth,height:t.elementHeight,project:{width:t.imageWidth,height:t.imageHeight,layers:this.previewLayerArr},hasEditMode:!0,onModeChange:t=>{(0,$VM6dD.css)(this.freeTransform.getElement(),{pointerEvents:"edit"===t?"":"none",opacity:"edit"===t?"":"0.5"})},onTransformChange:t=>{this.freeTransform.setViewportTransform(t)},padding:30}),(0,$VM6dD.css)(this.preview.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),this.rootEl.append(this.preview.getElement()),this.initTransform={x:this.imageWidth/2,y:this.imageHeight/2,width:this.layers[this.transformIndex].image.width,height:this.layers[this.transformIndex].image.height},this.freeTransform=new $d42d1384577ab84d$export$79a74567acf241b0({x:this.initTransform.x,y:this.initTransform.y,width:this.initTransform.width,height:this.initTransform.height,angleDeg:0,isConstrained:!0,snapX:[0,this.imageWidth],snapY:[0,this.imageHeight],viewportTransform:this.preview.getTransform(),callback:()=>{this.updatePreview()}}),this.preview.getElement().append(this.freeTransform.getElement()),(0,$VM6dD.css)(this.freeTransform.getElement(),{position:"absolute",left:"0",top:"0"}),setTimeout(()=>this.updatePreview(),0)}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $c4e8a5b20c195c16$export$71ed2b85d4ca43d3{update(){this.edges[0].update(),this.edges[1].update(),this.edges[2].update(),this.edges[3].update(),this.cornerElArr[0].update(),this.cornerElArr[1].update(),this.cornerElArr[2].update(),this.cornerElArr[3].update(),this.darken[0].update(),this.darken[1].update(),this.darken[2].update(),this.darken[3].update(),this.outline.update(),this.thirdsHorizontal.update(),this.thirdsVertical.update()}commit(){this.pointerRemainder.x=0,this.pointerRemainder.y=0,this.callback(this.getTransform())}getTransform(){return this.grips[1].x-=this.grips[0].x,this.grips[1].y-=this.grips[0].y,this.grips[2].x-=this.grips[0].x,this.grips[2].y-=this.grips[0].y,this.grips[3].x-=this.grips[0].x,this.grips[3].y-=this.grips[0].y,this.x+=this.grips[0].x,this.y+=this.grips[0].y,this.grips[0].x=0,this.grips[0].y=0,{x:this.x,y:this.y,width:this.grips[1].x,height:this.grips[2].y}}setTransform(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,(0,$VM6dD.css)(this.rootEl,{left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.grips[0].x=0,this.grips[0].y=0,this.grips[1].x=this.width,this.grips[1].y=0,this.grips[2].x=this.width,this.grips[2].y=this.height,this.grips[3].x=0,this.grips[3].y=this.height,this.update(),this.commit()}setScale(t){this.scale=t,(0,$VM6dD.css)(this.rootEl,{left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.update()}showThirds(t){this.thirdsHorizontal.el.style.display=t?"block":"none",this.thirdsVertical.el.style.display=t?"block":"none"}getElement(){return this.rootEl}destroy(){this.keyListener.destroy(),this.outlinePointerListener.destroy(),this.corner0PointerListener.destroy(),this.corner1PointerListener.destroy(),this.corner2PointerListener.destroy(),this.corner3PointerListener.destroy(),this.edge0PointerListener.destroy(),this.edge1PointerListener.destroy(),this.edge2PointerListener.destroy(),this.edge3PointerListener.destroy()}constructor(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.scale=t.scale,this.callback=t.callback;let e=t.maxW,i=t.maxW;this.rootEl=$2Eggz.BB.el();let s=["nw","n","ne","e","se","s","sw","w"];this.keyListener=new $2Eggz.BB.KeyListener({}),(0,$VM6dD.css)(this.rootEl,{position:"absolute",left:this.x*this.scale+"px",top:this.y*this.scale+"px"}),this.outline={el:$2Eggz.BB.el({css:{position:"absolute",border:"1px dashed #fff",cursor:"move"}}),update:()=>{(0,$VM6dD.css)(this.outline.el,{left:this.grips[0].x*this.scale-1+"px",top:this.grips[0].y*this.scale-1+"px",width:(this.grips[2].x-this.grips[0].x)*this.scale+"px",height:(this.grips[2].y-this.grips[0].y)*this.scale+"px"})}},this.pointerRemainder={x:0,y:0},this.outlinePointerListener=new $2Eggz.BB.PointerListener({target:this.outline.el,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);this.grips[0].x+=e,this.grips[0].y+=i,this.grips[1].x+=e,this.grips[1].y+=i,this.grips[2].x+=e,this.grips[2].y+=i,this.grips[3].x+=e,this.grips[3].y+=i,this.update()}"pointerup"===t.type&&this.commit()}}),this.thirdsHorizontal={el:$2Eggz.BB.el({css:{position:"absolute",borderTop:"1px solid #0ff",borderBottom:"1px solid #0ff"}}),update:()=>{(0,$VM6dD.css)(this.thirdsHorizontal.el,{left:this.grips[0].x*this.scale+"px",top:(this.grips[0].y+(this.grips[2].y-this.grips[0].y)/3)*this.scale+"px",width:(this.grips[2].x-this.grips[0].x)*this.scale+"px",height:(this.grips[2].y-this.grips[0].y)/3*this.scale+"px"})}},this.thirdsVertical={el:$2Eggz.BB.el({css:{position:"absolute",borderLeft:"1px solid #0ff",borderRight:"1px solid #0ff"}}),update:()=>{(0,$VM6dD.css)(this.thirdsVertical.el,{left:(this.grips[0].x+(this.grips[2].x-this.grips[0].x)/3)*this.scale+"px",top:this.grips[0].y*this.scale+"px",width:(this.grips[2].x-this.grips[0].x)/3*this.scale+"px",height:(this.grips[2].y-this.grips[0].y)*this.scale+"px"})}};let n=40,r=10;t.init?this.grips=[{x:t.init.x1,y:t.init.y1},{x:t.init.x2,y:t.init.y1},{x:t.init.x2,y:t.init.y2},{x:t.init.x1,y:t.init.y2}]:this.grips=[{x:0,y:0},{x:this.width,y:0},{x:this.width,y:this.height},{x:0,y:this.height}];let a=t=>{this.grips[0].y+=t,this.grips[0].y=$2Eggz.BB.clamp(this.grips[0].y,this.grips[3].y-i,this.grips[3].y-1),this.grips[1].y=this.grips[0].y},o=t=>{this.grips[1].x+=t,this.grips[1].x=$2Eggz.BB.clamp(this.grips[1].x,this.grips[0].x+1,this.grips[0].x+e),this.grips[2].x=this.grips[1].x},l=t=>{this.grips[2].y+=t,this.grips[2].y=$2Eggz.BB.clamp(this.grips[2].y,this.grips[1].y+1,this.grips[1].y+i),this.grips[3].y=this.grips[2].y},h=t=>{this.grips[0].x+=t,this.grips[0].x=$2Eggz.BB.clamp(this.grips[0].x,this.grips[1].x-e,this.grips[1].x-1),this.grips[3].x=this.grips[0].x};this.edges=[];for(let t=0;t<4;t++)(t=>{let e=$2Eggz.BB.el({css:{width:n+"px",height:n+"px",position:"absolute"}}),i=()=>{0===t?(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale+r+"px",top:this.grips[0].y*this.scale-2*n+r+"px",width:(this.grips[1].x-this.grips[0].x)*this.scale-2*r+"px",height:2*n+"px"}):1===t?(0,$VM6dD.css)(e,{left:this.grips[1].x*this.scale-r+"px",top:this.grips[1].y*this.scale+r+"px",width:2*n+"px",height:(this.grips[2].y-this.grips[1].y)*this.scale-2*r+"px"}):2===t?(0,$VM6dD.css)(e,{left:this.grips[3].x*this.scale+r+"px",top:this.grips[3].y*this.scale-r+"px",width:(this.grips[2].x-this.grips[3].x)*this.scale-2*r+"px",height:2*n+"px"}):3===t&&(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale-2*n+r+"px",top:this.grips[0].y*this.scale+r+"px",width:2*n+"px",height:(this.grips[3].y-this.grips[0].y)*this.scale-2*r+"px"});let i=2*t+1;e.style.cursor=s[i]+"-resize"};this.edges[t]={el:e,update:i}})(t);this.darken=[];for(let t=0;t<4;t++)(t=>{let e=$2Eggz.BB.el({css:{position:"absolute",background:"#000",opacity:"0.5"}}),i=()=>{0===t?(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale+"px",top:this.grips[0].y*this.scale-8e3+"px",width:(this.grips[1].x-this.grips[0].x)*this.scale+"px",height:"8000px"}):1===t?(0,$VM6dD.css)(e,{left:this.grips[1].x*this.scale+"px",top:this.grips[1].y*this.scale-8e3+"px",width:"8000px",height:"16000px"}):2===t?(0,$VM6dD.css)(e,{left:this.grips[3].x*this.scale+"px",top:this.grips[3].y*this.scale+"px",width:(this.grips[2].x-this.grips[3].x)*this.scale+"px",height:"8000px"}):3===t&&(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale-8e3+"px",top:this.grips[0].y*this.scale-8e3+"px",width:"8000px",height:"16000px"})};this.darken[t]={el:e,update:i}})(t);this.edge0PointerListener=new $2Eggz.BB.PointerListener({target:this.edges[0].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dY:e}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);a(e),this.keyListener.isPressed("shift")&&l(-e),this.update()}"pointerup"===t.type&&this.commit()}}),this.edge1PointerListener=new $2Eggz.BB.PointerListener({target:this.edges[1].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);o(e),this.keyListener.isPressed("shift")&&h(-e),this.update()}"pointerup"===t.type&&this.commit()}}),this.edge2PointerListener=new $2Eggz.BB.PointerListener({target:this.edges[2].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);l(i),this.keyListener.isPressed("shift")&&a(-i),this.update()}"pointerup"===t.type&&this.commit()}}),this.edge3PointerListener=new $2Eggz.BB.PointerListener({target:this.edges[3].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);h(e),this.keyListener.isPressed("shift")&&o(-e),this.update()}"pointerup"===t.type&&this.commit()}}),this.cornerElArr=[],(()=>{for(let t=0;t<4;t++)(t=>{let e=$2Eggz.BB.el({css:{width:2*n+"px",height:2*n+"px",position:"absolute",cursor:["nwse-resize","nesw-resize"][t%2]}}),i=()=>{0===t?(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale-2*n+r+"px",top:this.grips[0].y*this.scale-2*n+r+"px"}):1===t?(0,$VM6dD.css)(e,{left:this.grips[1].x*this.scale-r+"px",top:this.grips[1].y*this.scale-2*n+r+"px"}):2===t?(0,$VM6dD.css)(e,{left:this.grips[1].x*this.scale-r+"px",top:this.grips[2].y*this.scale-r+"px"}):3===t&&(0,$VM6dD.css)(e,{left:this.grips[0].x*this.scale-2*n+r+"px",top:this.grips[2].y*this.scale-r+"px"})};this.cornerElArr[t]={el:e,update:i}})(t)})(),this.corner0PointerListener=new $2Eggz.BB.PointerListener({target:this.cornerElArr[0].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);h(e),a(i),this.keyListener.isPressed("shift")&&(o(-e),l(-i)),this.update()}"pointerup"===t.type&&this.commit()}}),this.corner1PointerListener=new $2Eggz.BB.PointerListener({target:this.cornerElArr[1].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);o(e),a(i),this.keyListener.isPressed("shift")&&(h(-e),l(-i)),this.update()}"pointerup"===t.type&&this.commit()}}),this.corner2PointerListener=new $2Eggz.BB.PointerListener({target:this.cornerElArr[2].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);o(e),l(i),this.keyListener.isPressed("shift")&&(h(-e),a(-i)),this.update()}"pointerup"===t.type&&this.commit()}}),this.corner3PointerListener=new $2Eggz.BB.PointerListener({target:this.cornerElArr[3].el,fixScribble:!0,onPointer:t=>{if(t.eventPreventDefault(),"pointermove"===t.type&&"left"===t.button){let{dX:e,dY:i}=$2Eggz.BB.intDxy(this.pointerRemainder,t.dX/this.scale,t.dY/this.scale);h(e),l(i),this.keyListener.isPressed("shift")&&(o(-e),a(-i)),this.update()}"pointerup"===t.type&&this.commit()}}),this.rootEl.append(this.darken[1].el,this.darken[0].el,this.darken[2].el,this.darken[3].el,this.thirdsHorizontal.el,this.thirdsVertical.el,this.outline.el,this.edges[1].el,this.edges[0].el,this.edges[2].el,this.edges[3].el,this.cornerElArr[0].el,this.cornerElArr[1].el,this.cornerElArr[2].el,this.cornerElArr[3].el),this.update()}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $6f827bc527014b7f$export$d25420b53e16716f{updateCheckerPatterns(){let t=$2Eggz.BB.createCheckerCanvas(4,$74a507c74cfe9692$export$5714e40777c1bcc2.isDark());this.animationCanvasCheckerPattern=(0,$VM6dD.throwIfNull)(this.animationCanvasCtx.createPattern(t,"repeat")),this.largeCanvasCheckerPattern=(0,$VM6dD.throwIfNull)(this.canvasCtx.createPattern(t,"repeat"))}animate(){0!==this.animationCount&&(this.animationCount--,this.canvasCtx.save(),this.canvasCtx.globalAlpha=Math.pow((this.animationLength-this.animationCount)/this.animationLength,2),this.canvasCtx.drawImage(this.animationCanvas,0,0),this.canvasCtx.restore(),this.animationCount>0&&requestAnimationFrame(()=>this.animate()))}drawLargeCanvas(){if(!this.largeCanvasIsVisible||!this.layer)return;let t=this.layer.canvas,e=$2Eggz.BB.fitInto(t.width,t.height,this.largeCanvasSize,this.largeCanvasSize,1);this.largeCanvas.width=Math.round(e.width),this.largeCanvas.height=Math.round(e.height),this.largeCanvasCtx.save(),this.largeCanvas.width>t.width?this.largeCanvasCtx.imageSmoothingEnabled=!1:(this.largeCanvasCtx.imageSmoothingEnabled=!0,this.largeCanvasCtx.imageSmoothingQuality="high"),this.largeCanvasCtx.fillStyle=this.largeCanvasCheckerPattern,this.largeCanvasCtx.fillRect(0,0,this.largeCanvas.width,this.largeCanvas.height),this.largeCanvasCtx.drawImage(t,0,0,this.largeCanvas.width,this.largeCanvas.height),this.largeCanvasCtx.restore();let i=this.rootEl.getBoundingClientRect();(0,$VM6dD.css)(this.largeCanvasWrapper,{top:Math.max(10,i.top+this.height/2-this.largeCanvas.height/2)+"px"})}updateLabel(){if(!this.isPreviewVisible||!this.layer)return;let t=this.layer.isVisible;this.checkEl.parentElement.title=t?$63d0b335c576c718$export$ce37e184d908d785("layers-active-layer-visible"):$63d0b335c576c718$export$ce37e184d908d785("layers-active-layer-hidden"),this.checkEl.checked=t,this.checkEl.style.boxShadow=t?"":"0 0 0 1px red",this.nameLabelEl.textContent=this.layer.name,this.layer.isVisible?this.opacityEl.innerHTML=$63d0b335c576c718$export$ce37e184d908d785("opacity")+"<br>"+Math.round(100*this.layer.opacity)+"%":this.opacityEl.innerHTML=$63d0b335c576c718$export$ce37e184d908d785("opacity")+"<br><s>"+Math.round(100*this.layer.opacity)+"%</s>"}draw(t){if(!this.isPreviewVisible||!this.layer)return;this.updateLabel();let e=this.layer.canvas;if(e.width!==this.lastDrawnSize.width||e.height!==this.lastDrawnSize.height){let i=$2Eggz.BB.fitInto(e.width,e.height,this.canvasSize,this.canvasSize,1);this.canvas.width=Math.round(i.width),this.canvas.height=Math.round(i.height),t=!0}this.animationCanvas.width=this.canvas.width,this.animationCanvas.height=this.canvas.height,this.animationCanvasCtx.save(),this.animationCanvasCtx.imageSmoothingEnabled=!1,this.animationCanvasCtx.fillStyle=this.animationCanvasCheckerPattern,this.animationCanvasCtx.fillRect(0,0,this.animationCanvas.width,this.animationCanvas.height),this.animationCanvasCtx.drawImage(e,0,0,this.animationCanvas.width,this.animationCanvas.height),this.animationCanvasCtx.restore(),t?(this.animationCount=0,this.canvasCtx.save(),this.canvasCtx.drawImage(this.animationCanvas,0,0),this.canvasCtx.restore()):(this.animationCount=this.animationLength,this.animate()),this.drawLargeCanvas(),this.lastDrawnState=this.klHistory.getChangeCount(),this.lastDrawnSize.width=e.width,this.lastDrawnSize.height=e.height}getElement(){return this.rootEl}setIsVisible(t){if(this.isPreviewVisible===t)return;this.isPreviewVisible=t,this.contentWrapperEl.style.display=this.isPreviewVisible?"flex":"none",this.rootEl.style.marginBottom=this.isPreviewVisible?"":"10px";let e=this.klHistory.getChangeCount();t&&this.lastDrawnState!==e&&this.draw(!0)}setLayer(t){this.layer=t,this.draw(!0)}setUiState(t){this.uiState=t,"left"===this.uiState?(0,$VM6dD.css)(this.largeCanvasWrapper,{left:"280px",right:""}):(0,$VM6dD.css)(this.largeCanvasWrapper,{left:"",right:"280px"})}constructor(t){let e;this.animationCanvasCheckerPattern={},this.largeCanvasCheckerPattern={},this.rootEl=$2Eggz.BB.el({className:"kl-layer-preview"}),this.klHistory=t.klHistory,this.isPreviewVisible=!0,this.height=40,this.canvasSize=this.height-10,this.largeCanvasSize=300,this.lastDrawnState=-2,this.lastDrawnSize={width:0,height:0},this.animationCanvas=$2Eggz.BB.canvas(),this.animationCanvasCtx=$2Eggz.BB.ctx(this.animationCanvas),this.animationLength=30,this.animationCount=0,this.largeCanvasIsVisible=!1;let i=300;this.uiState=t.uiState,this.contentWrapperEl=$2Eggz.BB.el({css:{display:"flex",alignItems:"center",height:this.height+"px"}});let s=$2Eggz.BB.el({css:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"23px",flexShrink:"0"}});this.checkEl=$2Eggz.BB.el({parent:s,tagName:"input",css:{pointerEvents:"none"},custom:{type:"checkbox",disabled:"true",name:"layer-visible"}});let n=$2Eggz.BB.el({css:{minWidth:this.height+"px",height:this.height+"px",display:"flex",justifyContent:"center",alignItems:"center"}});this.canvas=$2Eggz.BB.canvas(this.canvasSize,this.canvasSize),this.canvasCtx=$2Eggz.BB.ctx(this.canvas),this.canvas.title=$63d0b335c576c718$export$ce37e184d908d785("layers-active-layer");let r=$2Eggz.BB.el({css:{flexGrow:"1",paddingLeft:"10px",fontSize:"13px",overflow:"hidden",position:"relative"}});this.nameLabelEl=$2Eggz.BB.el({content:"",css:{cssFloat:"left",whiteSpace:"nowrap"}});let a=$2Eggz.BB.el({css:{position:"absolute",left:"10px",top:"0",width:"90px",height:"100%"}});t.onClick&&(a.addEventListener("click",()=>t.onClick(),{passive:!1}),this.canvas.addEventListener("click",()=>t.onClick(),{passive:!1}),s.addEventListener("click",()=>t.onClick(),{passive:!1})),this.opacityEl=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("opacity")+"<br>100%",css:{minWidth:"60px",fontSize:"12px",textAlign:"center"}}),this.largeCanvasWrapper=$2Eggz.BB.el({onClick:$2Eggz.BB.handleClick,css:{pointerEvents:"none",background:"#fff",position:"absolute",right:"280px",top:"10px",border:"1px solid #aaa",boxShadow:"1px 1px 3px rgba(0,0,0,0.3)",transition:"opacity "+i+"ms ease-in-out",userSelect:"none",display:"block",webkitTouchCallout:"none"}}),this.largeCanvas=$2Eggz.BB.canvas(this.largeCanvasSize,this.largeCanvasSize),this.largeCanvasWrapper.append(this.largeCanvas),this.largeCanvasCtx=$2Eggz.BB.ctx(this.largeCanvas),(0,$VM6dD.css)(this.largeCanvas,{display:"block"}),n.append(this.canvas),r.append(this.nameLabelEl,a),this.contentWrapperEl.append(s,n,r,this.opacityEl),this.rootEl.append(this.contentWrapperEl),this.updateCheckerPatterns(),$74a507c74cfe9692$export$5714e40777c1bcc2.addIsDarkListener(()=>{this.updateCheckerPatterns(),this.draw(!0)}),this.klHistory.addListener(()=>{this.updateLabel()}),setInterval(()=>{this.layer&&this.klHistory.getChangeCount()!==this.lastDrawnState&&this.draw(!1)},2e3);let o=()=>{this.largeCanvasWrapper.remove()},l=s=>{this.largeCanvasIsVisible!==s&&(clearTimeout(e),this.largeCanvasIsVisible=s,s?e=setTimeout(()=>{this.drawLargeCanvas(),this.largeCanvasWrapper.style.opacity="0",t.klRootEl.append(this.largeCanvasWrapper),setTimeout(()=>{this.largeCanvasWrapper.style.opacity="1"},20)},250):(this.largeCanvasWrapper.style.opacity="0",e=setTimeout(o,i+20)))};new $2Eggz.BB.PointerListener({target:this.canvas,onEnterLeave:t=>{l(t)}})}}var $2Eggz=parcelRequire("2Eggz");function $8522c24dbe0f81fc$export$8f6817a932bf45cd(){return window.innerWidth<550}let $3ec5d4ed5944260f$export$ec2d17c6d3ae0768={width:340,height:220},$3ec5d4ed5944260f$export$3a4a74a7d8c44e62={width:540,height:300};function $3ec5d4ed5944260f$export$8b9199c1f5e4be8(t){return t?$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width:$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.width}function $3ec5d4ed5944260f$export$94cffdbcf128864a(t){return t?$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height:$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.height}var $VM6dD=parcelRequire("VM6dD");function $6be05b3a68464314$export$962af7e240721d88(t){let e=document.createElement("div");if($2Eggz.BB.appendTextDiv(e,$63d0b335c576c718$export$ce37e184d908d785("import-as-layer-description")),t.klCanvas.isLayerLimitReached()){let t=$2Eggz.BB.el({className:"kl-import-note",content:$63d0b335c576c718$export$ce37e184d908d785("import-as-layer-limit-reached")});e.append(t)}let i=$8522c24dbe0f81fc$export$8f6817a932bf45cd(),s=$2Eggz.BB.el({css:{display:"flex"}}),n=$2Eggz.BB.el({tagName:"button",content:"1:1",css:{marginRight:"10px"},onClick:function(){h.reset()}}),r=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("import-as-layer-fit"),css:{marginRight:"10px"},onClick:function(){h.setTransformFit()}}),a=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("center"),css:{marginRight:"10px"},onClick:function(){h.setTransformCenter()}}),o=new $b1ef42bd443626ca$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$63d0b335c576c718$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$63d0b335c576c718$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",title:$63d0b335c576c718$export$ce37e184d908d785("scaling-algorithm"),onChange:t=>{h.setAlgorithm(t)},name:"interpolation-algorithm"});s.append(n,r,a,$2Eggz.BB.el({css:{flexGrow:"1"}}),o.getElement()),e.append(s);let l=[];{let e=t.klCanvas.getLayers();for(let t=0;t<e.length;t++)l.push({image:e[t].context.canvas,isVisible:e[t].isVisible,opacity:e[t].opacity,mixModeStr:e[t].mixModeStr})}l.push({image:t.importImage,isVisible:!0,opacity:1,mixModeStr:"source-over"});let h=new $1fee4e0c7c231d15$export$205c2dd29f8a66b5({elementWidth:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(i),elementHeight:$3ec5d4ed5944260f$export$94cffdbcf128864a(i)+50,imageWidth:t.klCanvas.getLayerContext(0).canvas.width,imageHeight:t.klCanvas.getLayerContext(0).canvas.height,layers:l,transformIndex:l.length-1});function c(t,e){h.move(t,e)}(0,$VM6dD.css)(h.getElement(),{marginTop:"10px",marginLeft:"-20px"}),e.append(h.getElement());let d=new $2Eggz.BB.KeyListener({onDown:function(t){"left"===t&&c(-1,0),"right"===t&&c(1,0),"up"===t&&c(0,-1),"down"===t&&c(0,1)}});$2016c314bff36ab9$export$d7e8d4d4450c819c({target:t.target,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("import-as-layer-title")}</b>`,div:e,style:i?void 0:{width:"540px"},buttons:["Ok","Cancel"],clickOnEnter:"Ok",callback:function(e){d.destroy(),h.destroy(),$2Eggz.BB.destroyEl(n),$2Eggz.BB.destroyEl(r),$2Eggz.BB.destroyEl(a),"Ok"===e?t.callback(h.getTransformation(),h.getIsPixelated()):t.callback()}})}var $2Eggz=parcelRequire("2Eggz");class $71c20b9a25b8f899$export$e789742143ba5b1{constructor(t){this.rootEl=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("dropper-drop"),css:{paddingTop:"100px",position:"fixed",left:"0",top:"0",width:"100%",height:"100%",background:"rgba(50, 50, 50, 0.7)",color:"#fff",textShadow:"2px 2px #000",textAlign:"center",fontSize:"25px"}});let e=$2Eggz.BB.el({css:{marginTop:"50px",display:"flex",justifyContent:"center"}}),i={width:"200px",padding:"50px",margin:"10px",borderRadius:"20px",border:"1px dashed #fff",background:"#00aefe",fontWeight:"bold"},s=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("dropper-as-layer"),css:i}),n=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("dropper-as-image"),css:i});this.rootEl.append(e),e.append(s,n);let r=0,a=0,o=0,l=()=>{r=0,a=0,o=0,this.rootEl.remove()},h=t=>!!t.dataTransfer&&!t.dataTransfer.types.includes("text/plain"),c=()=>{let t="0 0 20px 4px #fff";a>0?(s.style.boxShadow=t,n.style.boxShadow=""):o>0?(s.style.boxShadow="",n.style.boxShadow=t):(s.style.boxShadow="",n.style.boxShadow="")};s.addEventListener("dragenter",()=>{a++,c()},{passive:!1}),s.addEventListener("dragleave",()=>{a--,c()},{passive:!1}),n.addEventListener("dragenter",()=>{o++,c()},{passive:!1}),n.addEventListener("dragleave",()=>{o--,c()},{passive:!1});let d=t=>{h(t)&&(t.stopPropagation(),t.preventDefault())},p=e=>{t.enabledTest()&&h(e)&&(0===r&&t.target.append(this.rootEl),r++)},u=t=>{h(t)&&0!==r&&0===(r=Math.max(0,r-1))&&this.rootEl.remove()},g=e=>{if(!h(e)||!e.dataTransfer||0===e.dataTransfer.files.length)return void l();e.stopPropagation(),e.preventDefault();let i="default";a>0?i="layer":o>0&&(i="image"),t.onDrop(e.dataTransfer.files,i),r>0&&this.rootEl.remove(),r=0,a=0,o=0,c()};window.addEventListener("dragover",d,{passive:!1}),window.addEventListener("dragenter",p,{passive:!1}),window.addEventListener("dragleave",u,{passive:!1}),window.addEventListener("drop",g,{passive:!1}),this.rootEl.addEventListener("pointerdown",()=>{l()},{passive:!1}),new $2Eggz.BB.KeyListener({onDown:t=>{r>0&&"esc"===t&&l()}})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $b80d451cabaa19d2$export$9f0da9b942594e99{getElement(){return this.rootEl}constructor(t){let e={width:150,svHeight:90,hHeight:20,sliderHeight:25},i=!1;this.rootEl=$2Eggz.BB.el({className:"kl-overlay-toolspace"});let s={color:null,size:null,opacity:null},n=$2Eggz.BB.el({parent:this.rootEl,className:"kl-overlay-toolspace__color"}),r=new $8f768338795db7a0$export$66306bf21a9ff39e({width:e.width,heightSV:e.svHeight,heightH:e.hHeight,color:t.brushSettingService.getColor(),callback:e=>{a.style.backgroundColor="rgb("+e.r+","+e.g+","+e.b+")",t.brushSettingService.setColor(e,c)}}),a=$2Eggz.BB.el({css:{width:e.width+"px",height:e.hHeight+"px",pointerEvents:"none"}});{let e=t.brushSettingService.getColor();a.style.backgroundColor="rgb("+e.r+","+e.g+","+e.b+")"}n.append(a,r.getElement());let o=t=>{r.setColor(t),a.style.backgroundColor="rgb("+t.r+","+t.g+","+t.b+")"},l=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:e.width,height:e.sliderHeight,min:0,max:500,value:50,resolution:225,eventResMs:1e3/30,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:e=>{t.brushSettingService.setSize(e)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t)});(0,$VM6dD.css)(l.getElement(),{marginTop:"2px"});let h=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:e.width,height:e.sliderHeight,min:0,max:1,value:1,resolution:225,eventResMs:1e3/30,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:e=>{t.brushSettingService.setOpacity(e)}});(0,$VM6dD.css)(h.getElement(),{margin:"2px 0"}),this.rootEl.append(l.getElement(),h.getElement());let c=t=>{"color"===t.type&&(i?o(t.value):s.color=t.value),"size"===t.type&&(i?l.setValue(t.value):s.size=t.value),"opacity"===t.type&&(i?h.setValue(t.value):s.opacity=t.value),"sliderConfig"===t.type&&(l.update(t.value.sizeSlider),h.update(t.value.opacitySlider))};t.brushSettingService.subscribe(c);{let e=t.brushSettingService.getSliderConfig();l.update(e.sizeSlider),h.update(e.opacitySlider),l.setValue(t.brushSettingService.getSize()),h.setValue(t.brushSettingService.getOpacity())}let d=()=>{$2Eggz.BB.unfocusAnyInput(),this.rootEl.style.display=i?"block":"none",i&&p&&(0,$VM6dD.css)(this.rootEl,{left:p.x-Math.round(e.width/2)+"px",top:p.y-Math.round(e.svHeight+3*e.hHeight/2)+"px"})},p=null;document.addEventListener("pointermove",t=>{p={x:t.pageX,y:t.pageY}},{passive:!1}),new $2Eggz.BB.KeyListener({onDown:(e,n,r,a)=>{if(!a){if(i){i=!1,d();return}t.enabledTest()&&p&&["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(r)&&(n.preventDefault(),i=!0,null!==s.color&&(o(s.color),s.color=null),null!==s.size&&(l.setValue(s.size),s.size=null),null!==s.opacity&&(h.setValue(s.opacity),s.opacity=null),d())}},onUp:(t,e,s)=>{["ctrl+alt","cmd+alt","alt+ctrl","alt+cmd"].includes(s)&&i&&(i=!1,r.end(),d())},onBlur:()=>{i&&(i=!1,r.end(),d())}})}}var $2Eggz=parcelRequire("2Eggz"),$d2b76ee5a41cc2d0$exports={};$d2b76ee5a41cc2d0$exports=$parcel$resolve("g2W7q");var $cecb4b55c8dd017e$exports={};$cecb4b55c8dd017e$exports=$parcel$resolve("7SFt9");var $375749381ca7b7b7$exports={};$375749381ca7b7b7$exports=$parcel$resolve("2Vvkk");var $d94e039749bb6ca4$exports={};$d94e039749bb6ca4$exports=$parcel$resolve("1zJpX");var $390be88d04af75ef$exports={};$390be88d04af75ef$exports=$parcel$resolve("9cKp0");var $1fbb59b08bf77b76$exports={};$1fbb59b08bf77b76$exports=$parcel$resolve("3iiTs");var $VM6dD=parcelRequire("VM6dD");class $50947f5db7d72ab3$export$665d2c76b1eb8459{getElement(){return this.rootEl}constructor(t){function e(t){let e=6+(t.extraPadding?t.extraPadding:0),i=$2Eggz.BB.el({className:"toolspace-row-button nohighlight",title:t.title,onClick:t.onClick,css:{padding:t.contain?e+"px 0":""}}),s=$2Eggz.BB.el({className:t.darkInvert?"dark-invert":void 0,css:{backgroundImage:"url('"+t.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:t.contain?"contain":"",height:"100%"}});s.style.pointerEvents="none",i.append(s);let n=new $2Eggz.BB.PointerListener({target:i,onEnterLeave:function(t){i.classList.toggle("toolspace-row-button-hover",t)}});return{el:i,pointerListener:n}}this.rootEl=$2Eggz.BB.el({className:"kl-toolspace-row",css:{height:"36px",display:"flex"}});let i=e({onClick:t.onLogo,title:$63d0b335c576c718$export$ce37e184d908d785("home"),image:t.logoImg?t.logoImg:$parcel$interopDefault($d2b76ee5a41cc2d0$exports),contain:!0,darkInvert:!0});i.el.classList.add("kl-tool-row-border-right"),(0,$VM6dD.css)(i.el,{width:"46px"});let s=e({onClick:t.onNew,title:$63d0b335c576c718$export$ce37e184d908d785("file-new"),image:$parcel$interopDefault($cecb4b55c8dd017e$exports),extraPadding:1,contain:!0}),n=e({onClick:t.onImport,title:$63d0b335c576c718$export$ce37e184d908d785("file-import"),image:$parcel$interopDefault($375749381ca7b7b7$exports),extraPadding:1,contain:!0}),r=e({onClick:t.onSave,title:$63d0b335c576c718$export$ce37e184d908d785("file-save"),image:$parcel$interopDefault($d94e039749bb6ca4$exports),extraPadding:1,contain:!0}),a=null;$2Eggz.BB.canShareFiles()&&(a=e({onClick:t.onShare,title:$63d0b335c576c718$export$ce37e184d908d785("file-share"),image:$parcel$interopDefault($390be88d04af75ef$exports),contain:!0,darkInvert:!0}));let o=e({onClick:t.onHelp,title:$63d0b335c576c718$export$ce37e184d908d785("help"),image:$parcel$interopDefault($1fbb59b08bf77b76$exports),contain:!0,darkInvert:!0});$2Eggz.BB.append(this.rootEl,[i.el,s.el,n.el,r.el,a?a.el:void 0,o.el])}}var $2Eggz=parcelRequire("2Eggz"),$4933c2551a80d49a$exports={};$4933c2551a80d49a$exports=$parcel$resolve("gGmfI");var $43ffa4c6f98eaf6b$exports={};$43ffa4c6f98eaf6b$exports=$parcel$resolve("67aEJ");var $c4a14de060935e98$exports={};$c4a14de060935e98$exports=$parcel$resolve("baTSW");var $821d1b86107d7d25$exports={};$821d1b86107d7d25$exports=$parcel$resolve("a2j2Q");var $fd406f4e4b510fcf$exports={};$fd406f4e4b510fcf$exports=$parcel$resolve("gZhDT");var $7783104c7d4a03b1$exports={};$7783104c7d4a03b1$exports=$parcel$resolve("2x0SU");var $iwR8S=parcelRequire("iwR8S"),$VM6dD=parcelRequire("VM6dD");class $d199831ecec4fae4$export$a0a40f8a0b8fee15{updateButton(){this.activeButton.title=this.titleArr[this.currentActiveIndex]+(this.isActive?" ("+$63d0b335c576c718$export$ce37e184d908d785("tool-more-tools-click-again")+")":""),this.activeButtonIm.style.backgroundImage="url('"+this.imArr[this.currentActiveIndex]+"')"}setIsSmall(t){this.activeButton.style.padding=t?this.smallMargin:"10px 0";for(let e=0;e<this.optionArr.length;e++)this.dropdownBtnArr[e].setIsSmall(t);(0,$VM6dD.css)(this.arrowButton,{width:t?"14px":"18px",height:t?"14px":"18px"})}setActive(t){if(this.optionArr.includes(t)){this.isActive=!0;for(let e=0;e<this.optionArr.length;e++)if(this.optionArr[e]===t){this.currentActiveIndex=e;break}this.activeButton.classList.add("toolspace-row-button-activated"),this.updateButton()}else this.isActive=!1,this.activeButton.classList.remove("toolspace-row-button-activated"),this.updateButton()}getActive(){return this.optionArr[this.currentActiveIndex]}getElement(){return this.rootEl}constructor(t){let e,i,s,n;this.smallMargin="6px 0",this.optionArr=["brush","paintBucket","gradient","text","shape","select"],this.imArr=[$parcel$interopDefault($4933c2551a80d49a$exports),$parcel$interopDefault($43ffa4c6f98eaf6b$exports),$parcel$interopDefault($c4a14de060935e98$exports),$parcel$interopDefault($821d1b86107d7d25$exports),$parcel$interopDefault($fd406f4e4b510fcf$exports),$parcel$interopDefault($7783104c7d4a03b1$exports)],this.titleArr=[`${$63d0b335c576c718$export$ce37e184d908d785("tool-brush")} [B]`,`${$63d0b335c576c718$export$ce37e184d908d785("tool-paint-bucket")} [G]`,`${$63d0b335c576c718$export$ce37e184d908d785("tool-gradient")} [G]`,`${$63d0b335c576c718$export$ce37e184d908d785("tool-text")} [T]`,`${$63d0b335c576c718$export$ce37e184d908d785("tool-shape")} [U]`,`${$63d0b335c576c718$export$ce37e184d908d785("tool-select")} [L]`],this.currentActiveIndex=0,this.isActive=!0;let r=!1;setTimeout(()=>{for(let t=1;t<this.imArr.length;t++)new Image().src=this.imArr[t]},100),this.rootEl=$2Eggz.BB.el({css:{position:"relative",flexGrow:"1"}});let a=!1;$2Eggz.BB.hasPointerEvents&&(n=new $2Eggz.BB.PointerListener({target:this.rootEl,onPointer:n=>{if("pointerdown"===n.type)r||(e=setTimeout(()=>{d()},400),a=!0,i=n.pageX,s=n.pageY);else if("pointermove"===n.type&&a)!r&&$2Eggz.BB.dist(i,s,n.pageX,n.pageY)>5&&(clearTimeout(e),d());else if("pointerup"===n.type&&a&&(clearTimeout(e),a=!1,r)){let e=document.elementFromPoint(n.pageX,n.pageY);for(let i=0;i<this.dropdownBtnArr.length;i++)if(e===this.dropdownBtnArr[i].wrapper){p(),this.isActive=!0,this.currentActiveIndex=i,this.updateButton(),t.onChange(this.optionArr[this.currentActiveIndex]);break}}}})),this.activeButton=$2Eggz.BB.el({parent:this.rootEl,className:"toolspace-row-button nohighlight toolspace-row-button-activated",title:this.titleArr[this.currentActiveIndex],onClick:e=>{if(this.isActive&&!r){e.preventDefault(),e.stopPropagation(),d();return}this.isActive=!0,t.onChange(this.optionArr[this.currentActiveIndex]),r&&p()},css:{padding:"10px 0",pointerEvents:"auto",height:"100%",boxSizing:"border-box",zIndex:"1"}}),new(0,$iwR8S.PointerListener)({target:this.activeButton,onEnterLeave:t=>{this.activeButton.classList.toggle("kl-tool-button--hover",t)}}),this.activeButtonIm=$2Eggz.BB.el({parent:this.activeButton,className:"dark-invert",css:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",width:"calc(100% - 7px)",height:"100%",pointerEvents:"none",opacity:"0.75"}}),this.arrowButton=$2Eggz.BB.el({parent:this.activeButton,className:"kl-tooldropdown-caret",content:$934e5f47c3374e21$export$db3b6bfb95261072(".dark-invert"),title:$63d0b335c576c718$export$ce37e184d908d785("tool-more-tools"),onClick:t=>{t.preventDefault(),t.stopPropagation(),d()}});let o=$2Eggz.BB.el({css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"}});new $2Eggz.BB.PointerListener({target:o,onPointer:t=>{"pointerdown"===t.type&&(t.eventPreventDefault(),p())}});let l=$2Eggz.BB.el({className:"tool-dropdown-wrapper",css:{position:"absolute",width:"100%",height:100*(this.optionArr.length-1)+"%",top:"100%",left:"0",zIndex:"-1",boxSizing:"border-box",cursor:"pointer",transition:"height 0.1s ease-in-out, opacity 0.1s ease-in-out",borderBottomLeftRadius:"5px",borderBottomRightRadius:"5px",overflow:"hidden"}});this.dropdownBtnArr=[];let h=t=>{let e=$2Eggz.BB.el({parent:l,className:"tool-dropdown-button",title:t.title,css:{padding:"10px 0",height:100/(this.optionArr.length-1)+"%",boxSizing:"border-box"},onClick:e=>{e.preventDefault(),e.stopPropagation(),t.onClick(t.index)}});$2Eggz.BB.el({parent:e,className:"dark-invert",css:{backgroundImage:"url('"+t.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",height:"100%",pointerEvents:"none",opacity:"0.75"}});let i=t=>{e.style.display=t?"block":"none"},s=t=>{e.style.padding=t?this.smallMargin:"10px 0"};return{wrapper:e,show:i,setIsSmall:s}},c=e=>{p(),this.isActive=!0,this.currentActiveIndex=e,this.updateButton(),t.onChange(this.optionArr[this.currentActiveIndex])};for(let t=0;t<this.optionArr.length;t++)this.dropdownBtnArr.push(h({index:t,id:this.optionArr[t],image:this.imArr[t],title:this.titleArr[t],onClick:c}));let d=()=>{if(!($6b37b427615ca1fa$export$d3d1650bc39c4419.get()>0)){$6b37b427615ca1fa$export$d3d1650bc39c4419.increase(.5),r=!0;for(let t=0;t<this.optionArr.length;t++)this.dropdownBtnArr[t].show(this.currentActiveIndex!==t);this.arrowButton.style.setProperty("opacity","0"),this.arrowButton.style.setProperty("pointer-events","none"),this.rootEl.style.zIndex="1",document.body.append(o),this.rootEl.append(l)}},p=()=>{$6b37b427615ca1fa$export$d3d1650bc39c4419.decrease(.5),r=!1,this.arrowButton.style.removeProperty("opacity"),this.arrowButton.style.removeProperty("pointer-events"),this.rootEl.style.removeProperty("z-index"),o.remove(),l.remove()};this.updateButton()}}var $2Eggz=parcelRequire("2Eggz"),$c6fbe1c307e83b0f$exports={};$c6fbe1c307e83b0f$exports=$parcel$resolve("j4HZO");var $VM6dD=parcelRequire("VM6dD");class $79297c17befec587$export$c744a22bef9e0b97{getElement(){return this.rootEl}setIsSmall(t){(0,$VM6dD.css)(this.rootEl,{height:t?"36px":"54px"}),this.toolDropdown.setIsSmall(t),this.handButton.setIsSmall(t),this.zoomInButton.setIsSmall(t),this.zoomOutButton.setIsSmall(t),this.undoButton.setIsSmall(t),this.redoButton.setIsSmall(t),t?(this.zoomInNOutButton.el.style.display="none",this.undoNRedoButton.el.style.display="none",this.zoomInButton.el.style.display="block",this.zoomOutButton.el.style.display="block",this.undoButton.el.style.display="block",this.redoButton.el.style.display="block"):(this.zoomInNOutButton.el.style.display="block",this.undoNRedoButton.el.style.display="block",this.zoomInButton.el.style.display="none",this.zoomOutButton.el.style.display="none",this.undoButton.el.style.display="none",this.redoButton.el.style.display="none")}setEnableZoomIn(t){this.zoomInButton.el.classList.toggle("toolspace-row-button-disabled",!t),this.zoomInNOutButton.setIsEnabledLeft(t)}setEnableZoomOut(t){this.zoomOutButton.el.classList.toggle("toolspace-row-button-disabled",!t),this.zoomInNOutButton.setIsEnabledRight(t)}setEnableUndo(t){this.undoButton.el.classList.toggle("toolspace-row-button-disabled",!t),this.undoNRedoButton.setIsEnabledLeft(t)}setEnableRedo(t){this.redoButton.el.classList.toggle("toolspace-row-button-disabled",!t),this.undoNRedoButton.setIsEnabledRight(t)}setActive(t,e){this.currentActiveStr!==t&&(this.currentActiveStr=t,this.toolDropdown.setActive(this.currentActiveStr),this.handButton.el.classList.toggle("toolspace-row-button-activated","hand"===this.currentActiveStr),e&&this.onActivate(this.currentActiveStr))}getActive(){return this.currentActiveStr}constructor(t){this.rootEl=$2Eggz.BB.el({className:"kl-toolspace-row",css:{height:"54px",display:"flex"}}),this.onActivate=t.onActivate,this.currentActiveStr="brush";let e=t=>{let e=t.doLighten?"6px 0":"8px 0",i=$2Eggz.BB.el({className:"toolspace-row-button nohighlight",onClick:t.onClick,css:{padding:t.contain?"10px 0":""}}),s=$2Eggz.BB.el({className:"dark-invert",css:{backgroundImage:"url('"+t.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:t.contain?"contain":"",height:"100%",transform:t.doMirror?"scale(-1, 1)":"",pointerEvents:"none",opacity:t.doLighten?"0.75":"1"}});i.append(s);let n=new $2Eggz.BB.PointerListener({target:i,onEnterLeave:t=>{i.classList.toggle("toolspace-row-button-hover",t)}}),r=s=>{i.style.padding=t.contain?s?e:"10px 0":""};return{el:i,pointerListener:n,setIsSmall:r}},i=t=>{let e=$2Eggz.BB.el({css:{flexGrow:"1",position:"relative"}}),i=$2Eggz.BB.createSvg({elementType:"svg",width:"67px",height:"54px",viewBox:"0 0 100 100",preserveAspectRatio:"none"});(0,$VM6dD.css)(i,{position:"absolute",left:"0",top:"0"});let s=10,n=2,r=2,a=$2Eggz.BB.createSvg({elementType:"defs",childrenArr:[{elementType:"filter",id:"innershadow",x0:"-50%",y0:"-50%",width:"200%",height:"200%",childrenArr:[{elementType:"feGaussianBlur",in:"SourceAlpha",stdDeviation:""+s,result:"blur"},{elementType:"feOffset",dx:""+n,dy:""+r},{elementType:"feComposite",in2:"SourceAlpha",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"SourceGraphic",operator:"over",result:"firstfilter"},{elementType:"feGaussianBlur",in:"firstfilter",stdDeviation:""+s,result:"blur2"},{elementType:"feOffset",dx:""+n,dy:""+r},{elementType:"feComposite",in2:"firstfilter",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowDiff"},{elementType:"feFlood","flood-color":"#000","flood-opacity":"0.2"},{elementType:"feComposite",in2:"shadowDiff",operator:"in"},{elementType:"feComposite",in2:"firstfilter",operator:"over"}]}]}),o=$2Eggz.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M0,0 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});o.onclick=()=>{t.onLeft(),o.classList.remove("toolspace-svg-triangle-button-hover")};let l=$2Eggz.BB.createSvg({elementType:"path","vector-effect":"non-scaling-stroke",d:"M100,100 L 100,0 0,100 z",fill:"rgba(0,0,0,0)",class:"toolspace-svg-triangle-button"});l.onclick=()=>{t.onRight(),l.classList.remove("toolspace-svg-triangle-button-hover")};let h=new $2Eggz.BB.PointerListener({target:o,onEnterLeave:t=>{o.classList.toggle("toolspace-svg-triangle-button-hover",t)}}),c=new $2Eggz.BB.PointerListener({target:l,onEnterLeave:t=>{l.classList.toggle("toolspace-svg-triangle-button-hover",t)}});i.append(a,o,l),e.append(i);let d=$2Eggz.BB.el({parent:e,className:"dark-invert",css:{backgroundImage:"url('"+t.leftImage+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",left:"10px",top:"8px",pointerEvents:"none"}});e.append(d);let p=$2Eggz.BB.el({parent:e,className:"dark-invert",css:{backgroundImage:"url('"+(t.rightImage?t.rightImage:t.leftImage)+"')",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"20px",height:"20px",position:"absolute",right:"10px",bottom:"8px",transform:t.rightImage?"":"scale(-1, 1)",pointerEvents:"none"}});return{el:e,setIsEnabledLeft:t=>{o.classList.toggle("toolspace-row-button-disabled",!t),d.classList.toggle("toolspace-row-button-disabled",!t)},setIsEnabledRight:t=>{l.classList.toggle("toolspace-row-button-disabled",!t),p.classList.toggle("toolspace-row-button-disabled",!t)},leftPointerListener:h,rightPointerListener:c}};this.toolDropdown=new $d199831ecec4fae4$export$a0a40f8a0b8fee15({onChange:t=>{this.setActive(t,!0)}}),this.rootEl.append(this.toolDropdown.getElement()),this.handButton=e({onClick:()=>{this.setActive("hand",!0)},image:$parcel$interopDefault($071c8859c903033f$exports),contain:!0,doLighten:!0}),this.handButton.el.classList.add("kl-tool-row-border-right"),this.handButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("tool-hand"),this.rootEl.append(this.handButton.el),this.zoomInNOutButton=i({onLeft:t.onZoomIn,onRight:t.onZoomOut,leftImage:$parcel$interopDefault($4ae8ffb159df37c1$exports),rightImage:$parcel$interopDefault($c1f95fb9358806e5$exports)}),this.zoomInNOutButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("tool-zoom"),this.rootEl.append(this.zoomInNOutButton.el),this.zoomInButton=e({onClick:t.onZoomIn,image:$parcel$interopDefault($4ae8ffb159df37c1$exports),contain:!0}),this.zoomInButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("zoom-in"),this.rootEl.append(this.zoomInButton.el),this.zoomOutButton=e({onClick:t.onZoomOut,image:$parcel$interopDefault($c1f95fb9358806e5$exports),contain:!0}),this.zoomOutButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("zoom-out"),this.rootEl.append(this.zoomOutButton.el),this.undoNRedoButton=i({onLeft:t.onUndo,onRight:t.onRedo,leftImage:$parcel$interopDefault($c6fbe1c307e83b0f$exports),rightImage:null}),this.undoNRedoButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("undo")+"/"+$63d0b335c576c718$export$ce37e184d908d785("redo"),this.undoNRedoButton.setIsEnabledLeft(!1),this.undoNRedoButton.setIsEnabledRight(!1),this.rootEl.append(this.undoNRedoButton.el),this.undoButton=e({onClick:t.onUndo,image:$parcel$interopDefault($c6fbe1c307e83b0f$exports),contain:!0}),this.undoButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("undo"),this.undoButton.el.classList.add("toolspace-row-button-disabled"),this.rootEl.append(this.undoButton.el),this.redoButton=e({onClick:t.onRedo,image:$parcel$interopDefault($c6fbe1c307e83b0f$exports),contain:!0,doMirror:!0}),this.redoButton.el.title=$63d0b335c576c718$export$ce37e184d908d785("redo"),this.redoButton.el.classList.add("toolspace-row-button-disabled"),this.rootEl.append(this.redoButton.el),this.zoomInButton.el.style.display="none",this.zoomOutButton.el.style.display="none",this.undoButton.el.style.display="none",this.redoButton.el.style.display="none"}}var $2Eggz=parcelRequire("2Eggz");class $6ae4f2a30e17169a$export$8162a66cd18867a7{getElement(){return this.rootEl}constructor(t){this.rootEl=$2Eggz.BB.el({tagName:"label",className:"kl-stabilizer",content:$63d0b335c576c718$export$ce37e184d908d785("stabilizer")+"&nbsp;",title:$63d0b335c576c718$export$ce37e184d908d785("stabilizer-title")});let e=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"]],initValue:""+t.smoothing,onChange:function(e){t.onSelect(parseInt(e))},name:"stabilizer-strength"});this.rootEl.append(e.getElement()),this.pointerListener=new $2Eggz.BB.PointerListener({target:this.rootEl,onWheel:function(t){e.setDeltaValue(t.deltaY)}})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $ae064bc6cfaee2ee$export$3c6d17ed0106bfb9{update(){for(let t=0;t<this.tabArr.length;t++)this.tabArr[t].update(this.activeTab)}getElement(){return this.rootEl}open(t){for(let e=0;e<this.tabArr.length;e++)if(this.tabArr[e].id===t){if(this.activeTab===this.tabArr[e])return;this.activeTab.onClose(),this.activeTab=this.tabArr[e],this.activeTab.onOpen(),this.activeTab.el.append(this.roundRight,this.roundLeft),this.update();return}throw"TabRow.open - invalid tabId"}getOpenedTabId(){return""+this.activeTab.id}setIsVisible(t,e){for(let i=0;i<this.tabArr.length;i++)if(this.tabArr[i].id===t){this.tabArr[i].isVisible=e,this.update();return}throw"TabRow.setIsVisible - invalid tabId"}destroy(){this.tabArr.forEach(t=>{$2Eggz.BB.destroyEl(t.el),t.pointerListener.destroy()})}constructor(t){var e;let i=null!=(e=t.height)?e:35;this.rootEl=$2Eggz.BB.el({className:"tabrow",css:{height:i+1+"px"}}),this.tabArr=[],this.roundRight=$2Eggz.BB.el({className:"tabrow__tab__rounding-left"}),this.roundLeft=$2Eggz.BB.el({className:"tabrow__tab__rounding-right"});let s=(t,e,s)=>{let n=!("isVisible"in t)||void 0===t.isVisible||t.isVisible,r={id:t.id,isVisible:n,onOpen:t.onOpen,onClose:t.onClose,update:t=>{r.el.className=t===r?s?"tabrow__tab tabrow__tab--opened-accented":"tabrow__tab tabrow__tab--opened":"tabrow__tab",r.el.style.display=r.isVisible?"block":"none"},el:$2Eggz.BB.el({parent:this.rootEl,content:"label"in t?t.label:"",title:"title"in t?t.title:void 0,className:e===t.id?s?"tabrow__tab tabrow__tab--opened-accented":"tabrow__tab tabrow__tab--opened":"tabrow__tab",css:{lineHeight:i+"px",display:n?"block":"none"},onClick:()=>{this.activeTab!==r&&this.open(r.id)}}),pointerListener:{}};return"image"in t&&$2Eggz.BB.el({tagName:"span",parent:r.el,className:"dark-invert",css:{backgroundImage:`url("${t.image}")`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",display:"flex",height:i-7+"px",justifyContent:"center",margin:"4px auto"}}),"css"in t&&void 0!==t.css&&(0,$VM6dD.css)(r.el,t.css),r.pointerListener=new $2Eggz.BB.PointerListener({target:r.el,onEnterLeave:t=>{r.el.classList.toggle("tabrow__tab-hover",t)}}),e===r.id?(r.onOpen(),r.el.append(this.roundRight,this.roundLeft)):r.onClose(),r},n=null;for(let e=0;e<t.tabArr.length;e++){let i=s(t.tabArr[e],t.initialId,t.useAccent||!1);i.id===t.initialId&&(n=i),this.tabArr.push(i)}if(!n)throw"invalid initialId";this.activeTab=n}}var $2Eggz=parcelRequire("2Eggz"),$457bbdb587ea898d$exports={};$457bbdb587ea898d$exports=$parcel$resolve("ea7ga");var $dGRuJ=parcelRequire("dGRuJ"),$VM6dD=parcelRequire("VM6dD"),$jmKbV=parcelRequire("jmKbV");let $d4c26c4eab3ed9b4$var$LS_INERTIA_KEY="kl-inertia-scroll";class $d4c26c4eab3ed9b4$export$cf20160367bae46c{updateUi(){this.scaleEl.innerHTML=Math.round(100*this.scale)+"%",this.angleEl.innerHTML=Math.round(this.angleDeg)+"",(0,$VM6dD.css)(this.angleIm,{transform:"rotate("+this.angleDeg+"deg)",boxShadow:this.angleDeg%90==0?"inset 0 0 0 1px rgba(255,255,255, 1), 0 0 0 1px rgba(0, 0, 0, 0.3)":""})}getElement(){return this.rootEl}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.updateUi()}update(t,e){this.scale=t,this.angleDeg=e,this.isVisible&&this.updateUi()}constructor(t){this.isVisible=!0,this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}}),this.scale=t.scale,this.angleDeg=t.angleDeg,this.onAngleChange=t.onAngleChange;let e=$2Eggz.BB.el({css:{marginBottom:"10px",display:"flex"}}),i=$2Eggz.BB.el({css:{display:"flex",marginBottom:"10px"}}),s=$2Eggz.BB.el({css:{display:"flex"}});this.rootEl.append(e,i,s),this.scaleEl=$2Eggz.BB.el({css:{width:"65px",userSelect:"none",fontFamily:"monospace"}}),e.append(this.scaleEl),this.angleIm=new Image,this.angleIm.src=$parcel$interopDefault($e64ad8a2a278ae06$exports),(0,$VM6dD.css)(this.angleIm,{verticalAlign:"bottom",width:"20px",height:"20px",marginRight:"5px",borderRadius:"10px",background:"rgba(0,0,0,0.2)",userSelect:"none"}),e.append(this.angleIm),this.angleEl=$2Eggz.BB.el({parent:e,css:{userSelect:"none"}}),this.updateUi();let n=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("hand-reset"),onClick:t.onReset});(0,$jmKbV.makeUnfocusable)(n);let r=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("hand-fit"),css:{marginLeft:"10px"},onClick:t.onFit});(0,$jmKbV.makeUnfocusable)(r),i.append(n,r);let a=new Image;a.height=20,a.src=$parcel$interopDefault($457bbdb587ea898d$exports),a.alt="Rotate",(0,$VM6dD.css)(a,{transform:"scale(-1, 1)"});let o=$2Eggz.BB.el({tagName:"button",content:a,onClick:function(){t.onAngleChange(-15,!0)}});(0,$jmKbV.makeUnfocusable)(o);let l=$2Eggz.BB.el({tagName:"button",content:"0",css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(0)}});(0,$jmKbV.makeUnfocusable)(l);let h=$2Eggz.BB.el({tagName:"button",content:'<img height="20" src="'+$parcel$interopDefault($457bbdb587ea898d$exports)+'" alt="Rotate"/>',css:{marginLeft:"10px"},onClick:function(){t.onAngleChange(15,!0)}});(0,$jmKbV.makeUnfocusable)(h),s.append(o,l,h);let c=new $213947897b67ec3a$export$48513f6b9f8ce62d({label:$63d0b335c576c718$export$ce37e184d908d785("hand-inertia-scrolling"),init:"true"===$dGRuJ.LocalStorage.getItem($d4c26c4eab3ed9b4$var$LS_INERTIA_KEY),callback:e=>{$dGRuJ.LocalStorage.setItem($d4c26c4eab3ed9b4$var$LS_INERTIA_KEY,""+e),t.onChangeUseInertiaScrolling(e)},name:"enable-inertia-scrolling"});setTimeout(()=>{t.onChangeUseInertiaScrolling(c.getValue())},500),(0,$VM6dD.css)(c.getElement(),{marginTop:"10px",display:"inline-block"}),this.rootEl.append(c.getElement())}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $274b5c24f0b5af79$export$1e63e3b0645421a2{getElement(){return this.rootEl}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}getTolerance(){return 0===Math.round(this.toleranceSlider.getDisplayValue())?0:this.toleranceSlider.getValue()}getOpacity(){return this.opacitySlider.getValue()}getSample(){return this.modeSelect.getValue()}getGrow(){return parseInt(this.growSelect.getValue(),10)}getContiguous(){return this.isContiguous}getIsEraser(){return this.eraserToggle.getValue()}constructor(t){this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$2Eggz.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.colorSlider=t.colorSlider,this.opacitySlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:1,toValue:t=>t/100,toDisplayValue:t=>100*t}),this.rootEl.append(this.opacitySlider.getElement()),this.toleranceSlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("bucket-tolerance"),width:250,height:30,min:0,max:255,value:51,toValue:t=>2.55*t,toDisplayValue:t=>t/2.55}),(0,$VM6dD.css)(this.toleranceSlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.toleranceSlider.getElement());let e=$2Eggz.BB.el({parent:this.rootEl,css:{display:"flex",marginTop:"10px"}}),i=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("bucket-sample")+"&nbsp;",title:$63d0b335c576c718$export$ce37e184d908d785("bucket-sample-title"),css:{fontSize:"15px"}});this.modeSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:[["all",$63d0b335c576c718$export$ce37e184d908d785("bucket-sample-all")],["current",$63d0b335c576c718$export$ce37e184d908d785("bucket-sample-active")],["above",$63d0b335c576c718$export$ce37e184d908d785("bucket-sample-above")]],initValue:"all",name:"sampling-mode"}),new $2Eggz.BB.PointerListener({target:this.modeSelect.getElement(),onWheel:t=>{this.modeSelect.setDeltaValue(t.deltaY)}}),i.append(this.modeSelect.getElement()),e.append(i);let s=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("bucket-grow")+"&nbsp;",title:$63d0b335c576c718$export$ce37e184d908d785("bucket-grow-title"),css:{fontSize:"15px",marginLeft:"10px"}});this.growSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"]],initValue:"0",name:"fill-growth"}),new $2Eggz.BB.PointerListener({target:this.growSelect.getElement(),onWheel:t=>{this.growSelect.setDeltaValue(t.deltaY)}}),s.append(this.growSelect.getElement()),e.append(s),this.isContiguous=!0;let n=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("bucket-contiguous"),title:$63d0b335c576c718$export$ce37e184d908d785("bucket-contiguous-title"),callback:t=>{this.isContiguous=t},name:"is-contiguous"});this.eraserToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("eraser"),name:"eraser-toggle"}),this.rootEl.append($2Eggz.BB.el({content:[n.getElement(),this.eraserToggle.getElement()],css:{display:"flex",marginTop:"10px",gap:"10px"}}))}}var $2Eggz=parcelRequire("2Eggz");class $a6bad5d4783f8133$export$32a22540e4b2f123{getElement(){return this.rootEl}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}constructor(t){this.isVisible=!0,this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}}),this.colorSlider=t.colorSlider,this.colorDiv=$2Eggz.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),$2Eggz.BB.el({parent:this.rootEl,content:$63d0b335c576c718$export$ce37e184d908d785("text-instruction")})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $f0a35036bcb542fb$export$a9387b1d4260d39c{getElement(){return this.rootEl}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&(this.colorDiv.append(this.colorSlider.getElement()),this.colorDiv.append(this.colorSlider.getOutputElement()))}getShape(){return this.shape}getMode(){return this.mode}getIsEraser(){return this.eraserToggle.getValue()}getOpacity(){return this.opacitySlider.getValue()}getLineWidth(){return this.lineWidthSlider.getValue()}getIsOutwards(){return this.outwardsToggle.getValue()}getIsFixed(){return this.fixedToggle.getValue()}getIsSnap(){return this.snapToggle.getValue()}getDoLockAlpha(){return this.lockAlphaToggle.getValue()}constructor(t){this.shape="rect",this.mode="stroke",this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$2Eggz.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.colorSlider=t.colorSlider;let e=35,i=8,s=$2Eggz.BB.createSvg({elementType:"rect",x:""+i,width:""+(e-2*i)}),n=$2Eggz.BB.createSvg({elementType:"svg",width:""+e,height:""+e});n.classList.add("dark-invert"),n.append(s),(0,$VM6dD.css)(n,{display:"block"});let r=$2Eggz.BB.createSvg({elementType:"rect",x:""+i,width:""+(e-2*i)}),a=$2Eggz.BB.createSvg({elementType:"svg",width:""+e,height:""+e});a.classList.add("dark-invert"),a.append(r),(0,$VM6dD.css)(a,{display:"block"});let o=$2Eggz.BB.createSvg({elementType:"ellipse",cx:""+e/2,cy:""+e/2,rx:""+(e/2-i)}),l=$2Eggz.BB.createSvg({elementType:"svg",width:""+e,height:""+e});l.classList.add("dark-invert"),l.append(o),(0,$VM6dD.css)(l,{display:"block"});let h=$2Eggz.BB.createSvg({elementType:"ellipse",cx:""+e/2,cy:""+e/2,rx:""+(e/2-i)}),c=$2Eggz.BB.createSvg({elementType:"svg",width:""+e,height:""+e});c.classList.add("dark-invert"),c.append(h),(0,$VM6dD.css)(c,{display:"block"});let d=$2Eggz.BB.createSvg({elementType:"line",x1:""+i,x2:""+(e-i)}),p=$2Eggz.BB.createSvg({elementType:"svg",width:""+e,height:""+e});p.classList.add("dark-invert"),p.append(d),(0,$VM6dD.css)(p,{display:"block"});let u=()=>{let t=$2Eggz.BB.clamp(Math.round(this.lineWidthSlider.getValue()/10),1,10)+"px",n=1.35;(0,$VM6dD.css)(s,{fill:"none",stroke:"black",strokeWidth:t}),(0,$VM6dD.css)(r,{fill:"black",stroke:"none"}),(0,$VM6dD.css)(o,{fill:"none",stroke:"black",strokeWidth:t}),(0,$VM6dD.css)(h,{fill:"black",stroke:"none"}),(0,$VM6dD.css)(d,{fill:"none",stroke:"black",strokeWidth:t}),this.fixedToggle.getValue()?(s.setAttribute("y",""+i),s.setAttribute("height",""+(e-2*i)),r.setAttribute("y",""+i),r.setAttribute("height",""+(e-2*i)),o.setAttribute("ry",""+(e/2-i)),h.setAttribute("ry",""+(e/2-i))):(s.setAttribute("y",""+i*n),s.setAttribute("height",""+(e-i*n*2)),r.setAttribute("y",""+i*n),r.setAttribute("height",""+(e-i*n*2)),o.setAttribute("ry",""+(e/2-i*n)),h.setAttribute("ry",""+(e/2-i*n))),this.snapToggle.getValue()?(d.setAttribute("y1",""+(e-i)),d.setAttribute("y2",""+i)):(d.setAttribute("y1",""+(e-i*n)),d.setAttribute("y2",""+i*n))},g=$2Eggz.BB.el({parent:this.rootEl,css:{display:"flex",justifyContent:"space-between",alignItems:"start"}}),m=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"rect-stroke",label:n,title:$63d0b335c576c718$export$ce37e184d908d785("shape-rect")+" "+$63d0b335c576c718$export$ce37e184d908d785("shape-stroke")},{id:"ellipse-stroke",label:l,title:$63d0b335c576c718$export$ce37e184d908d785("shape-ellipse")+" "+$63d0b335c576c718$export$ce37e184d908d785("shape-stroke")},{id:"line",label:p,title:$63d0b335c576c718$export$ce37e184d908d785("shape-line")},{id:"rect-fill",label:a,title:$63d0b335c576c718$export$ce37e184d908d785("shape-rect")+" "+$63d0b335c576c718$export$ce37e184d908d785("shape-fill")},{id:"ellipse-fill",label:c,title:$63d0b335c576c718$export$ce37e184d908d785("shape-ellipse")+" "+$63d0b335c576c718$export$ce37e184d908d785("shape-fill")}],initId:this.shape+" "+this.mode,onChange:t=>{let e=t.split("-");this.shape=e[0],this.mode=e[1],(0,$VM6dD.css)(this.fixedToggle.getElement(),{display:"line"===this.shape?"none":""}),(0,$VM6dD.css)(this.snapToggle.getElement(),{display:"line"===this.shape?"":"none"}),(0,$VM6dD.css)(this.lineWidthSlider.getElement(),{display:"line"!==this.shape&&"fill"===this.mode?"none":""})},changeOnInit:!0,css:{width:"120px"}});g.append(m.getElement()),this.eraserToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("eraser"),callback:()=>{u()},name:"enable-eraser"}),this.lockAlphaToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),doHighlight:!0,name:"enable-alpha-lock"}),this.lockAlphaToggle.getElement().style.marginTop="10px",this.panningToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("shape-auto-pan"),title:$63d0b335c576c718$export$ce37e184d908d785("shape-auto-pan-title"),callback:e=>t.onChangePanning(e),name:"enable-auto-pan"}),this.panningToggle.getElement().style.marginTop="10px",g.append($2Eggz.BB.el({content:[this.eraserToggle.getElement(),this.lockAlphaToggle.getElement(),this.panningToggle.getElement()]})),this.lineWidthSlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("shape-line-width"),width:250,height:30,min:1,max:200,value:4,curve:"quadratic",onChange:()=>{u()}}),(0,$VM6dD.css)(this.lineWidthSlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.lineWidthSlider.getElement()),this.opacitySlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:1,toValue:t=>t/100,toDisplayValue:t=>100*t}),(0,$VM6dD.css)(this.opacitySlider.getElement(),{marginTop:"10px"}),this.rootEl.append(this.opacitySlider.getElement());let f=$2Eggz.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px",gap:"10px"}});this.outwardsToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("shape-outwards"),name:"enable-outwards"}),f.append(this.outwardsToggle.getElement()),this.fixedToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("shape-fixed"),callback:()=>{u()},name:"enable-fixed-proportions"}),f.append(this.fixedToggle.getElement()),this.snapToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("angle-snap"),title:$63d0b335c576c718$export$ce37e184d908d785("angle-snap-title"),callback:()=>{u()},name:"enable-angle-snapping"}),f.append(this.snapToggle.getElement()),u()}}var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");function $1b372d80cb7a52ec$export$9852986a3ec5f6a0(t,e){let i=$2Eggz.BB.el({tagName:"table",className:"kl-table"});return t.forEach((t,s)=>{let n=$2Eggz.BB.el({tagName:"tr"});n.append(...t.map((t,i)=>{let n=$2Eggz.BB.el({tagName:"td",content:t}),r=s+"."+i;return void 0!==e&&r in e&&(n.rowSpan=e[r].rowspan),n})),i.append(n)}),i}var $VM6dD=parcelRequire("VM6dD");function $d43dc22de82019e6$export$f77a89101d7d6586(t){let e=t.currentColor,i=t.secondaryColor,s=t.maxCanvasSize,n=t.canvasWidth,r=t.canvasHeight,a=t.workspaceWidth,o=t.workspaceHeight,l=t.onConfirm,h=t.onCancel;function c(t,e,i,n,r){return $2Eggz.BB.fitInto(t,e,Math.min(s,i-r),Math.min(s,n-r),1)}let d=$2Eggz.BB.el(),p=$2Eggz.BB.el({tagName:"input",custom:{name:"image-width"}}),u={color:"#888",fontSize:"12px",marginLeft:"5px"},g=$2Eggz.BB.el({textContent:$63d0b335c576c718$export$ce37e184d908d785("new-px"),css:u}),m=$2Eggz.BB.el({tagName:"input",custom:{name:"image-height"}}),f=$2Eggz.BB.el({textContent:$63d0b335c576c718$export$ce37e184d908d785("new-px"),css:u});p.setAttribute("data-ignore-focus","true"),m.setAttribute("data-ignore-focus","true"),p.type="number",p.min="1",p.max=""+s,(0,$VM6dD.css)(p,{width:"70px"}),m.type="number",m.min="1",m.max=""+s,m.style.width="70px",p.value=""+n,m.value=""+r,p.onclick=()=>{p.focus(),A()},m.onclick=()=>{m.focus(),A()};let y=$1b372d80cb7a52ec$export$9852986a3ec5f6a0([[$63d0b335c576c718$export$ce37e184d908d785("width")+":&nbsp;",p,g],[$2Eggz.BB.el({css:{height:"5px"}}),"",""],[$63d0b335c576c718$export$ce37e184d908d785("height")+":&nbsp;",m,f]]);(0,$VM6dD.css)(y,{marginBottom:"10px"});let v=$2Eggz.BB.el({css:{marginTop:"5px",color:"#888"}}),x=$2Eggz.BB.el({css:{display:"flex",flexWrap:"wrap",gap:"5px",marginBottom:"10px"}}),b={tagName:"button",css:{flexGrow:"1"}},w=$2Eggz.BB.el(b),B=$2Eggz.BB.el(b),S=$2Eggz.BB.el(b),C=$2Eggz.BB.el(b),E=$2Eggz.BB.el(b),k=$2Eggz.BB.el(b);B.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-current"),w.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-fit"),k.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-oversize"),C.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-landscape"),E.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-portrait"),S.textContent=$63d0b335c576c718$export$ce37e184d908d785("new-square"),x.append(B,w,k,S,C,E);let I=0;B.onclick=function(){p.value=""+n,m.value=""+r,A()},w.onclick=function(){p.value=""+a,m.value=""+o,A()},k.onclick=function(){p.value=""+(a+500),m.value=""+(o+500),A()},S.onclick=function(){let t=c(1,1,a,o,I);p.value=""+Math.round(t.width),m.value=""+Math.round(t.height),A()},C.onclick=function(){let t=c(4,3,a,o,I);p.value=""+Math.round(t.width),m.value=""+Math.round(t.height),A()},E.onclick=function(){let t=c(3,4,a,o,I);p.value=""+Math.round(t.width),m.value=""+Math.round(t.height),A()};let T=new $b1ef42bd443626ca$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["screen",$63d0b335c576c718$export$ce37e184d908d785("new-screen")],["16 9",$63d0b335c576c718$export$ce37e184d908d785("new-video")+" 16:9"],["3 2","3:2"],["5 3","5:3"],["2 1","2:1"],["paper",$63d0b335c576c718$export$ce37e184d908d785("new-din-paper")+" 2:1"],["9 16","9:16"],["2 3","2:3"],["3 5","3:5"],["1 2","1:2"],["1 1.4142135623730951","1:2"]],onChange:function(t){if("screen"===t)p.value=""+window.screen.width,m.value=""+window.screen.height;else if("paper"===t){let t=c(Math.sqrt(2),1,a,o,I);p.value=""+Math.round(t.width),m.value=""+Math.round(t.height)}else{let e=t.split(" "),i=c(parseFloat(e[0]),parseFloat(e[1]),a,o,I);p.value=""+Math.round(i.width),m.value=""+Math.round(i.height)}A(),T.setValue(void 0)},name:"image-format"});setTimeout(()=>{T.setValue(void 0)},0),(0,$VM6dD.css)(T.getElement(),{width:"80px",flexGrow:"1"}),x.append(T.getElement());let M={r:255,g:255,b:255,a:1},P=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({colorArr:[{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1},{r:0,g:0,b:0,a:0},{r:e.r,g:e.g,b:e.b,a:1},{r:i.r,g:i.g,b:i.b,a:1}],initialIndex:0,onChange:function(t){M=t,R.style.backgroundColor="rgba("+t.r+","+t.g+","+t.b+", "+t.a+")"}}),L=$2Eggz.BB.el({className:"kl-transparent-preview",css:{boxSizing:"border-box",width:"340px",height:"140px",display:"table",padding:"10px",marginTop:"10px",marginLeft:"-20px",background:"var(--kl-checkerboard-background)"}}),R=$2Eggz.BB.el({className:"kl-transparent-preview__canvas",css:{width:"200px",height:"100px",backgroundColor:"rgba("+M.r+","+M.g+","+M.b+", "+M.a+")",marginLeft:"auto",marginRight:"auto",color:"#aaa",fontSize:"16px",fontWeight:"bold",textAlign:"center",verticalAlign:"center",display:"table",overflow:"hidden"}});function A(){function t(t,e){let i=t,s=e;for(;;){if(!(i%=s))return s;if(!(s%=i))return i}}p.value=""+Math.min(s,parseInt(p.value)),m.value=""+Math.min(s,parseInt(m.value));let e=parseInt(p.value),i=parseInt(m.value);(e<1||e>s||i<1||i>s)&&(e>s?e=s:i>s&&(i=s),p.value=""+e,m.value=""+i);let n=[[1,2],[2,1],[2,3],[3,2],[3,4],[4,3],[4,5],[5,4],[16,9],[9,16],[3,2],[2,3],[5,3],[3,5],[2,1],[1,2],[1.414,1],[1,1.414]],r=$2Eggz.BB.reduce(e,i),a=n[0],o=Math.abs(n[0][0]/n[0][1]-r[0]/r[1]);for(let t=0;t<n.length;t++)Math.abs(n[t][0]/n[t][1]-r[0]/r[1])<o&&(a=n[t],o=Math.abs(n[t][0]/n[t][1]-r[0]/r[1]));o>0&&o<.005?v.innerText=$63d0b335c576c718$export$ce37e184d908d785("new-ratio")+": ~"+a[0]+":"+a[1]:v.innerText=$63d0b335c576c718$export$ce37e184d908d785("new-ratio")+": "+r[0]+":"+r[1];let l=e,h=t(e,i);e/=h,i/=h,i*=260,(e*=260)>260&&(i=260/e*i,e=260),i>100&&(e=100/i*e,i=100),R.style.width=e+"px",R.style.height=i+"px",L.style.backgroundSize=Math.round(Math.max(4,e/l*60))+"px"}$2Eggz.BB.el({parent:L,content:R,css:{display:"table-cell",verticalAlign:"middle"}}),$2Eggz.BB.el({parent:R,css:{display:"table-cell",verticalAlign:"middle"}}),p.onchange=()=>{(""===p.value||0>parseInt(p.value))&&(p.value="1"),A()},p.onkeyup=()=>{A()},m.onchange=()=>{(""===m.value||0>parseFloat(m.value))&&(m.value="1"),A()},m.onkeyup=()=>{A()},A(),d.append(x);let D=$2Eggz.BB.el({parent:d,css:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}});$2Eggz.BB.el({parent:D}).append(y,v),D.append(P.getElement()),d.append(L),$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("new-title")}</b>`,div:d,buttons:["Ok","Cancel"],callback:function(t){($2Eggz.BB.unsetEventHandler(p,"onclick","onchange","onkeyup"),$2Eggz.BB.unsetEventHandler(p,"onclick","onchange","onkeyup"),$2Eggz.BB.unsetEventHandler(B,"onclick"),$2Eggz.BB.unsetEventHandler(w,"onclick"),$2Eggz.BB.unsetEventHandler(k,"onclick"),$2Eggz.BB.unsetEventHandler(S,"onclick"),$2Eggz.BB.unsetEventHandler(C,"onclick"),$2Eggz.BB.unsetEventHandler(E,"onclick"),T.destroy(),P.destroy(),"Cancel"===t||0>=parseInt(p.value)||0>=parseInt(m.value)||isNaN(parseInt(p.value))||isNaN(parseInt(m.value)))?h():l(parseInt(p.value),parseInt(m.value),M)},clickOnEnter:"Ok"})}var $2Eggz=parcelRequire("2Eggz"),$9117841db70813fe$exports={};$9117841db70813fe$exports=$parcel$resolve("gNPQL");class $da66208906376381$export$5b91f641162972fc{update(){"left"===this.orientation?this.icon.style.transform=this.stateIsOpen?"rotate(180deg)":"":this.icon.style.transform=this.stateIsOpen?"":"rotate(180deg)"}isOpen(){return this.stateIsOpen}setIsOpen(t){this.stateIsOpen=t,this.update()}setOrientation(t){this.orientation=t,this.update()}getElement(){return this.rootEl}constructor(t){this.stateIsOpen=!0,this.orientation="right",this.rootEl=$2Eggz.BB.el({className:"kl-toolspace-toggle",css:{width:"36px",height:"36px",background:"rgba(100, 100, 100, 0.9)",color:"#fff",textAlign:"center",lineHeight:"36px",cursor:"pointer",userSelect:"none",padding:"6px",boxSizing:"border-box"},title:$63d0b335c576c718$export$ce37e184d908d785("toggle-show-tools"),onClick:e=>{e.preventDefault(),this.stateIsOpen=!this.stateIsOpen,this.update(),t.onChange()}}),this.icon=$2Eggz.BB.el({parent:this.rootEl,css:{backgroundImage:`url(${$parcel$interopDefault($9117841db70813fe$exports)})`,width:"100%",height:"100%",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",userSelect:"none"}}),this.update(),this.rootEl.oncontextmenu=()=>!1}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$VM6dD=parcelRequire("VM6dD");class $5b663384e3b198ee$export$5cdfb22682d2a5dd{getElement(){return this.rootEl}getValues(){let t=this.colorOptions.getValue();return null===t||(null==t?void 0:t.a)===0?{fill:void 0}:{fill:{color:(0,$9FMZM._)((0,$wpIFA._)({},t),{a:this.opacitySlider.getValue()})}}}destroy(){this.colorOptions.destroy(),this.opacitySlider.destroy()}constructor(t){let e=()=>{t.onUpdate(this.getValues())},i=[null,t.fill?(0,$9FMZM._)((0,$wpIFA._)({},t.fill.color),{a:1}):null,(0,$9FMZM._)((0,$wpIFA._)({},t.primaryColor),{a:1}),(0,$9FMZM._)((0,$wpIFA._)({},t.secondaryColor),{a:1}),{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];this.colorOptions=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({colorArr:i,initialIndex:+!!t.fill,title:$63d0b335c576c718$export$ce37e184d908d785("shape-fill"),onChange:t=>{this.opacitySlider.getElement().style.display=null!==t?"":"none",e()}}),this.opacitySlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:150,height:30,min:.01,max:1,value:t.fill?t.fill.color.a:1,resolution:225,eventResMs:1e3/30,toValue:t=>t/100,toDisplayValue:t=>100*t,onChange:()=>e()}),this.opacitySlider.getElement().style.display=t.fill?"":"none";let s=(0,$VM6dD.createSvg)({elementType:"svg",class:"dark-invert",width:"25px",height:"25px",viewBox:"0 0 30 30",childrenArr:[{elementType:"polyline",points:"0,0 30,0 30,8 19,8 19,30 11,30 11,8 0,8 0,0 1,0","transform-origin":"15px 15px",transform:"scale(0.8)",fill:"#000c"}]});this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-10,items-center,flexWrap,minh-30",[s,this.colorOptions.getElement(),this.opacitySlider.getElement()])}}var $2Eggz=parcelRequire("2Eggz"),$315a705fa3433ae6$exports={};$315a705fa3433ae6$exports=$parcel$resolve("9Mrdl");var $e5df0b13d75826cd$exports={};$e5df0b13d75826cd$exports=$parcel$resolve("jc4S8");var $a1cea9aca69ddd68$exports={};$a1cea9aca69ddd68$exports=$parcel$resolve("cgtA2");var $041702a13c2910e6$exports={};$041702a13c2910e6$exports=$parcel$resolve("erfrN");var $bc84f5ada50c06b2$exports={};$bc84f5ada50c06b2$exports=$parcel$resolve("kdJe6");var $92c039c456df5a07$exports={};$92c039c456df5a07$exports=$parcel$resolve("ialpb");var $5eed4fe9e62e10f4$exports={};$5eed4fe9e62e10f4$exports=$parcel$resolve("4YP0p");var $a5133487986846a4$exports={};$a5133487986846a4$exports=$parcel$resolve("f9bZe");var $13dfbe8d2ff438cb$exports={};$13dfbe8d2ff438cb$exports=$parcel$resolve("dnR06");var $688a9de8d1071fcf$exports={};$688a9de8d1071fcf$exports=$parcel$resolve("lVw6N");var $7cf6bec9e2531e1f$exports={};$7cf6bec9e2531e1f$exports=$parcel$resolve("a0LKB");var $ba82ad4ee7b3ebd8$exports={};$ba82ad4ee7b3ebd8$exports=$parcel$resolve("eDCEO");var $cc5f7fec6c15577d$exports={};$cc5f7fec6c15577d$exports=$parcel$resolve("6nihP");var $1bcb94bbbc95f401$exports={};$1bcb94bbbc95f401$exports=$parcel$resolve("4rqd5");var $6522185860067a32$exports={};$6522185860067a32$exports=$parcel$resolve("isxTc");var $5028e011d7b584f5$exports={};$5028e011d7b584f5$exports=$parcel$resolve("9lp1S");var $69a66a6c9d6bd8fe$exports={};$69a66a6c9d6bd8fe$exports=$parcel$resolve("2yKB9");var $0d7c2eb8c0922891$exports={};$0d7c2eb8c0922891$exports=$parcel$resolve("jJcCY");var $8f14af5d029252e9$exports={};$8f14af5d029252e9$exports=$parcel$resolve("1JYDa");var $27cbd83f0cd9a873$exports={};$27cbd83f0cd9a873$exports=$parcel$resolve("kVDlu");var $7035b0d6c3ead178$exports={};$7035b0d6c3ead178$exports=$parcel$resolve("caTXQ");let $8e39776a1261b902$export$826128ff895ed268=[{name:"Caveat",url:$parcel$interopDefault($92c039c456df5a07$exports)},{name:"ClimateCrisis",url:$parcel$interopDefault($5eed4fe9e62e10f4$exports)},{name:"CorrectionBrush",url:$parcel$interopDefault($a5133487986846a4$exports)},{name:"DancingScript",url:$parcel$interopDefault($13dfbe8d2ff438cb$exports)},{name:"Diabolik",url:$parcel$interopDefault($688a9de8d1071fcf$exports)},{name:"FreckleFace",url:$parcel$interopDefault($7cf6bec9e2531e1f$exports)},{name:"Gloock",url:$parcel$interopDefault($ba82ad4ee7b3ebd8$exports)},{name:"GochiHand",url:$parcel$interopDefault($1bcb94bbbc95f401$exports)},{name:"Pacha",url:$parcel$interopDefault($cc5f7fec6c15577d$exports)},{name:"PassionOne",url:$parcel$interopDefault($6522185860067a32$exports)},{name:"PixeloidSans",url:$parcel$interopDefault($5028e011d7b584f5$exports)},{name:"PlaypenSans",url:$parcel$interopDefault($69a66a6c9d6bd8fe$exports)},{name:"Quicksand",url:$parcel$interopDefault($0d7c2eb8c0922891$exports)},{name:"Silkscreen",url:$parcel$interopDefault($8f14af5d029252e9$exports)},{name:"Tehroc",url:$parcel$interopDefault($27cbd83f0cd9a873$exports)},{name:"YUNGA",url:$parcel$interopDefault($7035b0d6c3ead178$exports)}],$0d66a3ca6c18ec8d$var$importedFonts=[{fontFamily:"sans-serif",fontName:"Sans-serif"},{fontFamily:"serif",fontName:"Serif"},{fontFamily:"monospace",fontName:"Monospace"},{fontFamily:"cursive",fontName:"Cursive"},{fontFamily:"fantasy",fontName:"Fantasy"},...$8e39776a1261b902$export$826128ff895ed268.map(t=>({fontFamily:t.name,fontName:t.name}))],$0d66a3ca6c18ec8d$var$didLoadBundledFonts=!1;async function $0d66a3ca6c18ec8d$var$loadBundledFonts(){if($0d66a3ca6c18ec8d$var$didLoadBundledFonts)return;$0d66a3ca6c18ec8d$var$didLoadBundledFonts=!0;let t=$8e39776a1261b902$export$826128ff895ed268.map(async t=>{let e=await fetch(t.url),i=await e.arrayBuffer(),s=new FontFace(t.name,i);document.fonts.add(s)});await Promise.all(t)}class $0d66a3ca6c18ec8d$export$2e7faedafda1fc85{loadBundledFonts(){$0d66a3ca6c18ec8d$var$didLoadBundledFonts||$0d66a3ca6c18ec8d$var$loadBundledFonts().then(()=>{this.onUpdate({font:this.fontSelect.getValue()})})}importFont(){let t=["ttf","otf","woff","woff2","eot"],e=document.createElement("input");e.type="file",e.multiple=!0,e.accept=t.map(t=>"."+t).join(", "),e.focus(),e.click(),e.onchange=async()=>{let i;if(!e.files||0===e.files.length)return;let s=[],n=!1,r=$0d66a3ca6c18ec8d$var$importedFonts.map(t=>t.fontFamily);for(let t=0;t<e.files.length;t++){let a=e.files[t],o="kl-"+$0d66a3ca6c18ec8d$var$importedFonts.length;if(r.includes(o))continue;i||(i=o,this.importButton.disabled=!0,this.importButton.innerText=$63d0b335c576c718$export$ce37e184d908d785("loading"));let l=a.name.split(".");l.pop(),$0d66a3ca6c18ec8d$var$importedFonts.push({fontFamily:o,fontName:l.join(".")});let h=new FontFace(o,await a.arrayBuffer());try{await h.load(),document.fonts.add(h),n=!0}catch(t){s.push(a.name)}}if(s.length>0&&$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("text-failed-import"),$934e5f47c3374e21$export$db3b6bfb95261072("br"),s.join(", "),$934e5f47c3374e21$export$db3b6bfb95261072("br"),$934e5f47c3374e21$export$db3b6bfb95261072("br"),$63d0b335c576c718$export$ce37e184d908d785("text-supported-formats"),$934e5f47c3374e21$export$db3b6bfb95261072("br"),t.join(", ")]}),type:"error"}),!n){this.importButton.disabled=!1,this.importButton.innerText=$63d0b335c576c718$export$ce37e184d908d785("file-import");return}setTimeout(()=>{this.fontSelect.setOptionArr($0d66a3ca6c18ec8d$var$importedFonts.map(t=>[t.fontFamily,t.fontName,{css:{fontFamily:t.fontFamily,fontSize:"1.2em"}}])),this.fontSelect.setValue(i),this.onUpdate({font:i}),this.importButton.disabled=!1,this.importButton.innerText=$63d0b335c576c718$export$ce37e184d908d785("file-import")})}}getElement(){return this.rootEl}getValues(){return{font:this.fontSelect.getValue(),size:+this.sizeInput.getValue(),letterSpacing:+this.letterSpacingInput.getValue(),lineHeight:+this.lineHeightInput.getValue(),align:this.alignRadioList.getValue(),isItalic:this.italicToggle.getValue(),isBold:this.boldToggle.getValue()}}destroy(){this.fontPointerListener.destroy(),this.fontSelect.getElement().removeEventListener("focus",this.onFocus),this.fontSelect.destroy(),$2Eggz.BB.destroyEl(this.importButton),this.sizeInput.destroy(),this.lineHeightInput.destroy(),this.letterSpacingInput.destroy(),this.alignRadioList.destroy(),this.italicToggle.destroy(),this.boldToggle.destroy()}constructor(t){var e,i;this.onUpdate=t.onUpdate,this.fontSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({initValue:t.font,optionArr:$0d66a3ca6c18ec8d$var$importedFonts.map(t=>[t.fontFamily,t.fontName,{css:{fontFamily:t.fontFamily,fontSize:"1.2em"}}]),isFocusable:!0,css:{width:"180px"},onChange:e=>{this.loadBundledFonts(),t.onUpdate({font:e})},name:"font"}),this.onFocus=()=>this.loadBundledFonts(),this.fontSelect.getElement().addEventListener("focus",this.onFocus),this.fontPointerListener=new $2Eggz.BB.PointerListener({target:this.fontSelect.getElement(),onWheel:t=>this.fontSelect.setDeltaValue(t.deltaY)}),this.importButton=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("file-import"),onClick:()=>{this.importFont()}});let s=$2Eggz.BB.el({content:[$2Eggz.BB.el({tagName:"span",content:"A",css:{fontSize:"0.6em"}}),"A"],css:{width:"25px",height:"25px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2em",userSelect:"none"}});this.sizeInput=new $760dd90d44275661$export$f5b8910cec6cf069({title:$63d0b335c576c718$export$ce37e184d908d785("text-size"),type:"number",min:0,max:1e3,init:t.size,onChange:e=>{t.onUpdate({size:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"70px"},name:"font-size"}),this.lineHeightInput=new $760dd90d44275661$export$f5b8910cec6cf069({label:$63d0b335c576c718$export$ce37e184d908d785("text-line-height"),type:"number",min:0,max:10,step:.1,init:null!=(e=t.lineHeight)?e:1,onChange:e=>{t.onUpdate({lineHeight:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"60px"},name:"line-height"}),this.letterSpacingInput=new $760dd90d44275661$export$f5b8910cec6cf069({label:$63d0b335c576c718$export$ce37e184d908d785("text-letter-spacing"),type:"number",min:-100,max:100,init:null!=(i=t.letterSpacing)?i:0,onChange:e=>{t.onUpdate({letterSpacing:parseFloat(e)})},doResetIfInvalid:!0,doScrollWithoutFocus:!0,css:{width:"60px"},name:"letter-spacing"}),this.alignRadioList=new $fa6faa989b2cc6b2$export$7cc1012a658e6ad8({optionArr:[{id:"left",title:$63d0b335c576c718$export$ce37e184d908d785("text-left"),image:$parcel$interopDefault($315a705fa3433ae6$exports),darkInvert:!0},{id:"center",title:$63d0b335c576c718$export$ce37e184d908d785("text-center"),image:$parcel$interopDefault($e5df0b13d75826cd$exports),darkInvert:!0},{id:"right",title:$63d0b335c576c718$export$ce37e184d908d785("text-right"),image:$parcel$interopDefault($a1cea9aca69ddd68$exports),darkInvert:!0}],initId:t.align,onChange:e=>t.onUpdate({align:e})}),this.italicToggle=new $a14a8e8cf8cc5885$export$b6d053cded550773({image:$parcel$interopDefault($041702a13c2910e6$exports),title:$63d0b335c576c718$export$ce37e184d908d785("text-italic"),initValue:t.isItalic,onChange:e=>t.onUpdate({isItalic:e}),darkInvert:!0}),this.boldToggle=new $a14a8e8cf8cc5885$export$b6d053cded550773({image:$parcel$interopDefault($bc84f5ada50c06b2$exports),title:$63d0b335c576c718$export$ce37e184d908d785("text-bold"),initValue:t.isBold,onChange:e=>t.onUpdate({isBold:e}),darkInvert:!0}),this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,flexWrap,gap-10-15,items-center",[$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-5,items-center",[s,this.sizeInput.getElement()]),$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-5",[this.fontSelect.getElement(),this.importButton]),$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-7",[this.alignRadioList.getElement(),this.italicToggle.getElement(),this.boldToggle.getElement()]),this.letterSpacingInput.getElement(),this.lineHeightInput.getElement()])}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $c73fdb6c21e3a26a$export$42bb0e3b48d549f6{getElement(){return this.rootEl}getValues(){let t=this.colorOptions.getValue();return null===t||(null==t?void 0:t.a)===0?{stroke:void 0}:{stroke:{color:(0,$9FMZM._)((0,$wpIFA._)({},t),{a:this.opacitySlider.getValue()}),lineWidth:this.lineWidthSlider.getValue()}}}destroy(){this.colorOptions.destroy(),this.opacitySlider.destroy(),this.lineWidthSlider.destroy()}constructor(t){this.rootEl=$2Eggz.BB.el({css:{boxShadow:"0 0 0 1px #aaa"}});let e=()=>{t.onUpdate(this.getValues())},i=[null,t.stroke?(0,$9FMZM._)((0,$wpIFA._)({},t.stroke.color),{a:1}):null,(0,$9FMZM._)((0,$wpIFA._)({},t.secondaryColor),{a:1}),(0,$9FMZM._)((0,$wpIFA._)({},t.primaryColor),{a:1}),{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1}];this.colorOptions=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({colorArr:i,initialIndex:+!!t.stroke,title:$63d0b335c576c718$export$ce37e184d908d785("shape-stroke"),onChange:t=>{this.opacitySlider.getElement().style.display=null!==t?"":"none",this.lineWidthSlider.getElement().style.display=null!==t?"":"none",e()}}),this.opacitySlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:150,height:30,min:.01,max:1,value:t.stroke?t.stroke.color.a:1,resolution:225,eventResMs:1e3/30,toValue:t=>t/100,toDisplayValue:t=>100*t,onChange:()=>e()}),this.lineWidthSlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("shape-line-width"),width:150,height:30,min:.5,max:100,value:t.stroke?t.stroke.lineWidth:2,eventResMs:1e3/30,curve:"quadratic",onChange:()=>e()}),this.opacitySlider.getElement().style.display=t.stroke?"":"none",this.lineWidthSlider.getElement().style.display=t.stroke?"":"none";let s=(0,$VM6dD.createSvg)({elementType:"svg",class:"dark-invert",width:"25px",height:"25px",viewBox:"0 0 30 30",childrenArr:[{elementType:"polyline",points:"0,0 30,0 30,8 19,8 19,30 11,30 11,8 0,8 0,0 1,0",fill:"none",stroke:"#000c","stroke-width":"3","transform-origin":"15px 15px",transform:"scale(0.8)"}]});this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-10,items-center,flexWrap,minh-30",[s,this.colorOptions.getElement(),this.opacitySlider.getElement(),this.lineWidthSlider.getElement()])}}var $2Eggz=parcelRequire("2Eggz");class $be275a032c52a6ed$export$c6656360602b35c2{emit(){let t=this.textInput.value;t!==this.lastEmittedText&&(this.lastEmittedText=t,this.onUpdate({text:t}))}getElement(){return this.rootEl}getValues(){return{text:this.textInput.value}}focus(){this.textInput.focus()}destroy(){$2Eggz.BB.destroyEl(this.textInput),this.textInput.removeEventListener("input",this.onInput)}constructor(t){this.onInput=()=>{this.emit()},this.lastEmittedText=t.text,this.onUpdate=t.onUpdate,this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072(""),this.textInput=$2Eggz.BB.el({tagName:"textarea",parent:this.rootEl,content:t.text,custom:{placeholder:$63d0b335c576c718$export$ce37e184d908d785("text-placeholder")},css:{whiteSpace:"pre",overflow:"auto",width:"100%",height:"70px",resize:"vertical"},onChange:()=>{this.emit()}}),this.textInput.addEventListener("input",this.onInput)}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD"),$aXq9D=parcelRequire("aXq9D");class $4ada09c4693c46d4$export$1d311696e0fb2158{canZoom(t){return this.zoomFac!==Math.min(2,Math.max(-2,this.zoomFac+t))}changeZoomFac(t){this.zoomFac=Math.min(2,Math.max(-2,this.zoomFac+t)),this.render(),this.zoomInBtn.disabled=!this.canZoom(1),this.zoomOutBtn.disabled=!this.canZoom(-1)}move(t,e){let i=$2Eggz.BB.rotate(t,e,-this.rotationSlider.getValue()/Math.PI*180);this.text.x+=i.x/this.scale,this.text.y+=i.y/this.scale,this.render()}render(){let t=this.rotationSlider.getValue();this.textCtx.clearRect(0,0,this.textCanvas.width,this.textCanvas.height);let e=$67e715fe604c9329$export$482c90f94eb9717c(this.textCanvas,(0,$9FMZM._)((0,$wpIFA._)({},this.text),{x:this.text.x,y:this.text.y,angleRad:this.rotationSlider.getValue()}),this.selectionPath);this.selectionPath&&(this.textCtx.save(),this.textCtx.setLineDash([4]),this.textCtx.strokeStyle="#000",this.textCtx.stroke(this.selectionPath),this.textCtx.lineDashOffset=4,this.textCtx.strokeStyle="#fff",this.textCtx.stroke(this.selectionPath),this.textCtx.restore());let i=$2Eggz.BB.Vec2.mul($2Eggz.BB.rotate(this.offset.x,this.offset.y,-t/Math.PI*180),1/this.scale);e.x-=3,e.y-=3,e.width+=6,e.height+=6;let s=$2Eggz.BB.rotate(e.x,e.y,-t/Math.PI*180),n=$2Eggz.BB.rotate(e.width,e.height,-t/Math.PI*180),r=this.text.x+s.x+n.x/2+i.x,a=this.text.y+s.y+n.y/2+i.y,o=100,l=$2Eggz.BB.fitInto(e.width,e.height,this.width-o,this.height-o);this.scale=Math.min(1,l.width/e.width),this.scale=Math.min(4,this.scale*Math.pow(2,this.zoomFac)),this.targetCtx.save(),this.scale>=4?this.targetCtx.imageSmoothingEnabled=!1:(this.targetCtx.imageSmoothingEnabled=!0,this.targetCtx.imageSmoothingQuality=this.scale>=1?"low":"medium"),this.targetCtx.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.targetCtx.translate(this.width/2,this.height/2),this.targetCtx.scale(this.scale,this.scale),this.targetCtx.rotate(t),this.targetCtx.drawImage(this.layerArr[this.layerIndex].canvas,-r,-a),this.targetCtx.drawImage(this.textCanvas,-r,-a),this.targetCtx.restore();let h=$74a507c74cfe9692$export$5714e40777c1bcc2.isDark();this.layersCtx.save(),this.layersCtx.fillStyle=h?"rgb(33,33,33)":"rgb(158,158,158)",this.layersCtx.fillRect(0,0,this.width,this.height);{this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(t),this.layersCtx.imageSmoothingEnabled=!1;let e=1/this.scale;this.layersCtx.globalAlpha=h?.25:.2,this.layersCtx.drawImage(h?this.emptyCanvasLight:this.emptyCanvas,-r-e,-a-e,this.textCanvas.width+2*e,this.textCanvas.height+2*e),this.layersCtx.globalAlpha=1,this.layersCtx.globalCompositeOperation="destination-out",this.layersCtx.drawImage(this.emptyCanvas,-r,-a,this.textCanvas.width,this.textCanvas.height),this.layersCtx.restore()}this.scale>=4?this.layersCtx.imageSmoothingEnabled=!1:(this.layersCtx.imageSmoothingEnabled=!0,this.layersCtx.imageSmoothingQuality=this.scale>=1?"low":"medium"),this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(t);for(let t=0;t<this.layerIndex;t++)this.layerArr[t].isVisible&&this.layerArr[t].opacity>0&&(this.layersCtx.globalAlpha=this.layerArr[t].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[t].mixModeStr,this.layersCtx.drawImage(this.layerArr[t].canvas,-r,-a));this.layersCtx.restore(),this.layersCtx.globalAlpha=!!this.layerArr[this.layerIndex].isVisible*this.layerArr[this.layerIndex].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[this.layerIndex].mixModeStr,this.layersCtx.drawImage(this.targetCanvas,0,0),this.layersCtx.save(),this.layersCtx.translate(this.width/2,this.height/2),this.layersCtx.scale(this.scale,this.scale),this.layersCtx.rotate(t);for(let t=this.layerIndex+1;t<this.layerArr.length;t++)this.layerArr[t].isVisible&&this.layerArr[t].opacity>0&&(this.layersCtx.globalAlpha=this.layerArr[t].opacity,this.layersCtx.globalCompositeOperation=this.layerArr[t].mixModeStr,this.layersCtx.drawImage(this.layerArr[t].canvas,-r,-a));this.layersCtx.restore(),this.layersCtx.restore(),this.previewCtx.save(),this.previewCtx.fillStyle=this.checkerPattern,this.previewCtx.fillRect(0,0,this.previewCanvas.width,this.previewCanvas.height),this.previewCtx.drawImage(this.layersCanvas,0,0),this.previewCtx.restore(),this.previewCtx.save(),this.previewCtx.globalCompositeOperation="difference",this.previewCtx.strokeStyle="#fff",this.previewCtx.lineWidth=.5,this.previewCtx.translate(-this.offset.x,-this.offset.y),this.previewCtx.strokeRect(Math.round(this.width/2-e.width/2*this.scale)+.5,Math.round(this.height/2-e.height/2*this.scale)+.5,Math.round(e.width*this.scale),Math.round(e.height*this.scale)),this.previewCtx.restore()}getElement(){return this.rootEl}getInputsElement(){return this.inputsRootEl}getValues(){return{x:this.text.x,y:this.text.y,angleRad:this.rotationSlider.getValue()}}setText(t){let e=this.text.x,i=this.text.y,s=this.text.angleRad;this.text=(0,$9FMZM._)((0,$wpIFA._)({},t),{x:e,y:i,angleRad:s}),this.render()}setSize(t,e){t=Math.max(1,t),e=Math.max(1,e),(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.targetCanvas.width=this.width,this.targetCanvas.height=this.height,this.layersCanvas.width=this.width,this.layersCanvas.height=this.height,this.previewCanvas.width=this.width,this.previewCanvas.height=this.height,this.previewWrapper.style.width=this.width+"px",this.render())}destroy(){$2Eggz.BB.destroyEl(this.rootEl),$2Eggz.BB.destroyEl(this.inputsRootEl),$2Eggz.BB.destroyEl(this.previewWrapper),clearInterval(this.interval),this.rotationSlider.destroy(),$2Eggz.BB.destroyEl(this.zoomInBtn),$2Eggz.BB.destroyEl(this.zoomOutBtn),this.eventCapture.remove(),this.previewPointerListener.destroy(),this.keyListener.destroy(),$74a507c74cfe9692$export$5714e40777c1bcc2.removeIsDarkListener(this.onDarkChange)}constructor(t){this.offset={x:0,y:0},this.zoomFac=0,this.scale=1,this.layerArr=[],this.onDarkChange=()=>{this.checkerPattern=(0,$VM6dD.throwIfNull)(this.previewCtx.createPattern($2Eggz.BB.createCheckerCanvas(8,$74a507c74cfe9692$export$5714e40777c1bcc2.isDark()),"repeat")),this.render()},this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072(),this.text=t.text,this.layerIndex=t.layerIndex;let e=t.klCanvas.getSelection();this.selectionPath=e?new Path2D((0,$aXq9D.getSelectionPath2d)(e)):void 0;let i=window.innerWidth<550,s=window.innerHeight<630;this.width=i?340:540,this.height=i?s?210:260:s?230:350,this.layerArr=t.klCanvas.getLayersFast(),this.textCanvas=$2Eggz.BB.canvas(t.klCanvas.getWidth(),t.klCanvas.getHeight()),this.textCtx=$2Eggz.BB.ctx(this.textCanvas),this.targetCanvas=$2Eggz.BB.canvas(this.width,this.height),this.targetCtx=$2Eggz.BB.ctx(this.targetCanvas),this.layersCanvas=$2Eggz.BB.canvas(this.width,this.height),this.layersCtx=$2Eggz.BB.ctx(this.layersCanvas),this.previewCanvas=$2Eggz.BB.canvas(this.width,this.height),this.previewCtx=$2Eggz.BB.ctx(this.previewCanvas),(0,$VM6dD.css)(this.previewCanvas,{display:"block"}),this.previewWrapper=$2Eggz.BB.el({parent:this.rootEl,css:{position:"relative",width:this.width+"px",cursor:"move",touchAction:"none"}}),$2Eggz.BB.el({parent:this.previewWrapper,className:"kl-text-preview-wrapper"}),this.previewWrapper.append(this.previewCanvas),this.checkerPattern=(0,$VM6dD.throwIfNull)(this.previewCtx.createPattern($2Eggz.BB.createCheckerCanvas(8,$74a507c74cfe9692$export$5714e40777c1bcc2.isDark()),"repeat")),this.emptyCanvas=$2Eggz.BB.canvas(1,1),this.emptyCanvasLight=$2Eggz.BB.canvas(1,1);{let t=$2Eggz.BB.ctx(this.emptyCanvas);t.fillRect(0,0,1,1),(t=$2Eggz.BB.ctx(this.emptyCanvasLight)).fillStyle="#fff",t.fillRect(0,0,1,1)}$74a507c74cfe9692$export$5714e40777c1bcc2.addIsDarkListener(this.onDarkChange),this.previewCanvas.oncontextmenu=t=>t.preventDefault();let n=!1,r=!1,a=!1;this.previewPointerListener=new $2Eggz.BB.PointerListener({target:this.previewCanvas,onPointer:e=>{if("pointerdown"===e.type&&(n=!1,r=!0),"pointermove"===e.type&&r&&(n=!0),"pointerup"===e.type&&(r&&n&&"mouse"===e.pointerType&&t.onDragEnd(),n=!1,r=!1),"pointermove"===e.type&&"left"===e.button&&(e.eventPreventDefault(),this.offset={x:0,y:0},this.move(-e.dX,-e.dY)),"pointerdown"===e.type&&"right"===e.button&&document.body.append(this.eventCapture),"pointerup"===e.type&&setTimeout(()=>this.eventCapture.remove(),20),"pointermove"===e.type&&"right"===e.button&&(a=!0,e.eventPreventDefault(),this.offset.x-=e.dX,this.offset.y-=e.dY,this.render()),"pointerup"===e.type&&a){let t=0;this.interval=setInterval(()=>{t>8&&(clearInterval(this.interval),this.offset={x:0,y:0},this.render()),this.offset={x:.6*this.offset.x,y:.6*this.offset.y},this.render(),t++},10),this.offset={x:.6*this.offset.x,y:.6*this.offset.y},this.render()}},onWheel:t=>{this.changeZoomFac(-t.deltaY)}});let o=t=>t.preventDefault();this.previewCanvas.addEventListener("wheel",o,{passive:!1}),this.rotationSlider=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-rotation"),width:150,height:30,min:-Math.PI,max:Math.PI,value:t.text.angleRad,resolution:225,toValue:t=>t*Math.PI/180,toDisplayValue:t=>t/Math.PI*180,onChange:()=>{this.offset={x:0,y:0},this.render()},unit:""}),this.zoomInBtn=$2Eggz.BB.el({tagName:"button",content:`<img height="20" src="${$parcel$interopDefault($4ae8ffb159df37c1$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("zoom-in"),onClick:()=>this.changeZoomFac(1),css:{fontWeight:"bold"}}),this.zoomOutBtn=$2Eggz.BB.el({tagName:"button",content:`<img height="20" src="${$parcel$interopDefault($c1f95fb9358806e5$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("zoom-out"),onClick:()=>this.changeZoomFac(-1),css:{fontWeight:"bold"}}),this.eventCapture=$2Eggz.BB.el({css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",zIndex:"999",cursor:"move"}}),this.eventCapture.oncontextmenu=t=>t.preventDefault(),this.keyListener=new $2Eggz.BB.KeyListener({onDown:t=>{if($2Eggz.BB.isInputFocused(!0))return;let e=this.keyListener.isPressed("shift")?4:1;"left"===t&&this.move(-e,0),"right"===t&&this.move(e,0),"up"===t&&this.move(0,-e),"down"===t&&this.move(0,e)}}),this.inputsRootEl=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-5",[this.rotationSlider.getElement(),$934e5f47c3374e21$export$db3b6bfb95261072(),this.zoomInBtn,this.zoomOutBtn])}}function $3217004ef102ca9c$export$e263e067d6140649(t){let e=$2Eggz.BB.el({}),i=$2Eggz.BB.copyObj(t.text),s=$2Eggz.BB.el({className:$d9aa3b7905088459$export$e114d13b1a258938}),n=new $4ada09c4693c46d4$export$1d311696e0fb2158({text:i,klCanvas:t.klCanvas,layerIndex:t.layerIndex,onDragEnd:()=>"text"===d.getOpenedTabId()?c.focus():0});function r(t){i=(0,$wpIFA._)({},i,t),n.setText(i)}n.render();let a=new $0d66a3ca6c18ec8d$export$2e7faedafda1fc85((0,$9FMZM._)((0,$wpIFA._)({},i),{onUpdate:t=>{r(t)}})),o=$2Eggz.BB.el({css:{display:"flex",gap:"10px",flexDirection:"column"}}),l=new $5b663384e3b198ee$export$5cdfb22682d2a5dd({fill:i.fill,primaryColor:t.primaryColor,secondaryColor:t.secondaryColor,onUpdate:t=>{r(t)}}),h=new $c73fdb6c21e3a26a$export$42bb0e3b48d549f6({stroke:i.stroke,primaryColor:t.primaryColor,secondaryColor:t.secondaryColor,onUpdate:t=>{r(t)}}),c=new $be275a032c52a6ed$export$c6656360602b35c2({text:i.text,onUpdate:t=>{void 0!==t.text&&m.setIgnoreBackground(t.text.length>0),r(t)}}),d=new $ae064bc6cfaee2ee$export$3c6d17ed0106bfb9({initialId:"text",height:40,tabArr:[{id:"text",label:$63d0b335c576c718$export$ce37e184d908d785("text-text"),onOpen:()=>{c.getElement().style.display="",c.focus()},onClose:()=>{c.getElement().style.display="none"}},{id:"font",label:$63d0b335c576c718$export$ce37e184d908d785("text-font"),onOpen:()=>{a.getElement().style.display="flex"},onClose:()=>{a.getElement().style.display="none"}},{id:"color",label:$63d0b335c576c718$export$ce37e184d908d785("text-color"),onOpen:()=>{o.style.display="flex"},onClose:()=>{o.style.display="none"}}]});d.getElement().classList.add($d9aa3b7905088459$export$62d58b1c91e8e902),e.append($934e5f47c3374e21$export$db3b6bfb95261072("",[$934e5f47c3374e21$export$db3b6bfb95261072(s,[n.getElement()]),$934e5f47c3374e21$export$db3b6bfb95261072("."+$d9aa3b7905088459$export$ee483a02838ec162,[n.getInputsElement()]),$934e5f47c3374e21$export$db3b6bfb95261072(".tabrow."+$d9aa3b7905088459$export$84aa927130f1a919,[$934e5f47c3374e21$export$db3b6bfb95261072(",w-240,h-40"),d.getElement()]),$934e5f47c3374e21$export$db3b6bfb95261072("."+$d9aa3b7905088459$export$7b388ca536128c6d,[$934e5f47c3374e21$export$db3b6bfb95261072(o,[l.getElement(),h.getElement()]),a.getElement(),c.getElement()])]));let p=()=>{let t=s.getBoundingClientRect(),e=Math.ceil(t.width),i=Math.ceil(t.height);n.setSize(e,i)};function u(){window.scrollTo(0,0)}window.addEventListener("resize",p),setTimeout(()=>{p()}),setTimeout(()=>{c.focus()},100),window.addEventListener("scroll",u,{passive:!1});let g=e=>{window.removeEventListener("resize",p),window.removeEventListener("scroll",u),n.destroy(),a.destroy(),l.destroy(),h.destroy(),c.destroy(),d.destroy(),"Ok"===e&&t.onConfirm((0,$wpIFA._)({},n.getValues(),a.getValues(),l.getValues(),h.getValues(),c.getValues()))},m=$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("text-title")}</b>`,div:e,buttons:["Ok","Cancel"],ignoreBackground:t.text.text.length>0,callback:g,style:{width:"calc(100% - 50px)",maxWidth:"1000px",minWidth:"300px",boxSizing:"border-box"},clickOnEnter:"Ok"})}$d9aa3b7905088459$export$7b388ca536128c6d="_5vlQAW_inputs",$d9aa3b7905088459$export$62d58b1c91e8e902="_5vlQAW_tab",$d9aa3b7905088459$export$84aa927130f1a919="_5vlQAW_tabWrapper",$d9aa3b7905088459$export$ee483a02838ec162="_5vlQAW_viewportInputs",$d9aa3b7905088459$export$e114d13b1a258938="_5vlQAW_viewportWrapper";var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $aa951ef8a5f9de6d$export$1bf16d9bd59fd8f9(t){let e,i,s=$2Eggz.BB.el(),n=window.innerWidth<550||window.innerHeight<550,r=n?{}:{width:"540px"},a=$2Eggz.BB.el({css:{marginTop:"10px",textAlign:"center",color:"#888",lineHeight:"20px"}}),o=new $c5a9090dbc3ef918$export$40175a5948a88a57({width:n?340:540,height:n?300:400,canvas:t.image.canvas,enableRightClickCopy:!1,onChange:(t,e)=>{a&&l(t,e)}});function l(e,i){let s=$2Eggz.BB.fitInto(e,i,t.maxSize,t.maxSize);s.width<e?(a.innerHTML=`<span class="kl-text-error">${e} X ${i}</span> \u{27F6} ${Math.round(s.width)} X ${Math.round(s.height)}`,a.title=$63d0b335c576c718$export$ce37e184d908d785("import-too-large")):(a.innerHTML=`${e} X ${i}`,a.title="")}(0,$VM6dD.css)(o.getElement(),{marginLeft:"-20px"}),o.getElement().title=$63d0b335c576c718$export$ce37e184d908d785("crop-drag-to-crop"),s.append(o.getElement(),a),l(t.image.width,t.image.height);let h=!1;function c(t){let e=[],i={mask:"Masks not supported. Mask was applied.",clipping:"Clipping not supported. Clipping layers were merged.",group:"Groups not supported. Layers were ungrouped.",adjustment:"Adjustment layers not supported.","layer-effect":"Layer effects not supported.","smart-object":"Smart objects not supported.","blend-mode":"Unsupported layer blend mode.","bits-per-channel":"Unsupported color depth. Only 8bit per channel supported."};for(let s=0;s<t.length;s++)e.push("- "+i[t[s]]);alert(e.join("\n"))}if("psd"===t.image.type)if(t.image.layers){if(e=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:h,label:$63d0b335c576c718$export$ce37e184d908d785("import-flatten"),callback:t=>{h=t},name:"flatten-image"}),s.append(e.getElement()),t.image.warningArr){let e=$2Eggz.BB.el({className:"kl-import-note",content:$63d0b335c576c718$export$ce37e184d908d785("import-psd-limited-support")}),n=t.image.warningArr;i=$2Eggz.BB.el({parent:e,tagName:"a",content:"Details",css:{marginLeft:"5px"},onClick:()=>c(n)}),s.append(e)}}else{let t=$2Eggz.BB.el({className:"kl-import-note",content:$63d0b335c576c718$export$ce37e184d908d785("import-psd-unsupported")});s.append(t)}function d(s){let n=o.getCroppedCanvas(),r=o.getCropRect(),a=t.image.width!==r.width||t.image.height!==r.height;o.destroy(),$2Eggz.BB.destroyEl(i),e&&e.destroy(),s===$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-layer")?(t.callback({type:"as-layer",image:a?n:t.image.canvas}),a||$2Eggz.BB.freeCanvas(n)):s===$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-image")?"psd"===t.image.type?(h&&delete t.image.layers,t.callback({type:"as-image-psd",image:t.image,cropObj:r}),$2Eggz.BB.freeCanvas(n)):"image"===t.image.type&&t.callback({type:"as-image",image:n}):(t.callback({type:"cancel"}),$2Eggz.BB.freeCanvas(n))}$2016c314bff36ab9$export$d7e8d4d4450c819c({target:t.target,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("import-title")}</b>`,div:s,style:r,buttons:[$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-layer"),$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-image"),"Cancel"],primaries:[$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-layer"),$63d0b335c576c718$export$ce37e184d908d785("import-btn-as-image")],callback:d,autoFocus:"As Image"})}var $e9d04a247aa46c18$exports={};$parcel$export($e9d04a247aa46c18$exports,"blendPsdToKl",function(){return $e9d04a247aa46c18$export$6df36f0c42d2440f}),$parcel$export($e9d04a247aa46c18$exports,"blendKlToPsd",function(){return $e9d04a247aa46c18$export$4e3b1f7d3ad623b4}),$parcel$export($e9d04a247aa46c18$exports,"readPsd",function(){return $e9d04a247aa46c18$export$3d649861c4b13fa2}),$parcel$export($e9d04a247aa46c18$exports,"klPsdToKlProject",function(){return $e9d04a247aa46c18$export$56493bf279c387b3});var $f5ug2=parcelRequire("f5ug2"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $e9d04a247aa46c18$var$init(){$e9d04a247aa46c18$var$kl2PsdMap||($e9d04a247aa46c18$var$psd2KlMap=Object.fromEntries(Object.entries($e9d04a247aa46c18$var$kl2PsdMap={"source-over":"normal",darken:"darken",multiply:"multiply","color-burn":"color burn",lighten:"lighten",screen:"screen","color-dodge":"color dodge",overlay:"overlay","soft-light":"soft light","hard-light":"hard light",difference:"difference",exclusion:"exclusion",hue:"hue",saturation:"saturation",color:"color",luminosity:"luminosity"}).map(t=>t.reverse())))}function $e9d04a247aa46c18$export$6df36f0c42d2440f(t){return $e9d04a247aa46c18$var$init(),$e9d04a247aa46c18$var$psd2KlMap[t]}function $e9d04a247aa46c18$export$4e3b1f7d3ad623b4(t){return $e9d04a247aa46c18$var$init(),$e9d04a247aa46c18$var$kl2PsdMap[t]}function $e9d04a247aa46c18$export$3d649861c4b13fa2(t){let e;if(!t.canvas)throw Error("psdObj.canvas undefined");let i={type:"psd",canvas:t.canvas,width:t.width,height:t.height};function s(t){i.warningArr||(i.warningArr=[]),i.warningArr.includes(t)||i.warningArr.push(t)}function n(t){let e=$e9d04a247aa46c18$export$6df36f0c42d2440f(t);return e||(s("blend-mode"),e="source-over"),e}if(8!==t.bitsPerChannel&&s("bits-per-channel"),!t.children)return i.error=!0,i;let r=$d26b85e649dca02a$export$9f4f73b1bd7c2f26;function a(t){let e=0;if(t.blendMode){let e=$e9d04a247aa46c18$export$6df36f0c42d2440f(t.blendMode);if(e&&"source-over"!==e)return 1}if(t.children)for(let i=0;i<t.children.length;i++){let n=t.children[i];!n.clipping&&!n.adjustment&&(n.children?(s("group"),e+=a(n)):e++)}return e}if((e=0+a(t))>r)return i.error=!0,i;function o(t,e){let i=$2Eggz.BB.ctx(t),s=i.getImageData(0,0,t.width,t.height);if(0===e)for(let t=0;t<s.data.length;t+=4)s.data[t+3]=s.data[t];else for(let t=0;t<s.data.length;t+=4)s.data[t+3]=255-s.data[t];i.putImageData(s,0,0)}function l(t){let e,r,a=[],h=!t.hidden,c=(0,$VM6dD.throwIfUndefined)(t.opacity,"groupOpacity is undefined"),d=n(t.blendMode);if("source-over"!==d&&(e=(0,$f5ug2.createCanvas)(i.width,i.height),r=$2Eggz.BB.ctx(e)),t.mask&&(s("mask"),o(t.mask.canvas,t.mask.defaultColor)),t.children)for(let d=0;d<t.children.length;d++){let p=t.children[d];if(p.clipping)continue;if(p.adjustment){s("adjustment");continue}let u=(p.children||p.canvas)&&t.children[d+1]&&t.children[d+1].clipping;if(u&&s("clipping"),p.children){let s=l(p);for(let o=0;o<s.length;o++){let l=s[o],h=$2Eggz.BB.ctx(l.image);if(u){let e=(0,$f5ug2.createCanvas)(i.width,i.height),s=$2Eggz.BB.ctx(e);s.drawImage(l.image,0,0);for(let e=d+1;e<t.children.length&&t.children[e].clipping;e++){let i=t.children[e];if(0!==i.opacity&&!i.hidden){if(void 0===i.blendMode)throw Error("clippingItem.blendMode undefined");if(void 0===i.opacity)throw Error("clippingItem.opacity undefined");if(void 0===i.canvas)throw Error("clippingItem.canvas undefined");if(void 0===i.left)throw Error("clippingItem.left undefined");if(void 0===i.top)throw Error("clippingItem.top undefined");s.globalCompositeOperation=n(i.blendMode),s.globalAlpha=i.opacity,s.drawImage(i.canvas,i.left,i.top)}}h.globalCompositeOperation="source-atop",h.drawImage(e,0,0)}if(t.mask){if(h.globalCompositeOperation=0===t.mask.defaultColor?"destination-in":"destination-out",void 0===t.mask.canvas)throw Error("psdGroupObj.mask.canvas undefined");if(void 0===t.mask.left)throw Error("psdGroupObj.mask.left undefined");if(void 0===t.mask.top)throw Error("psdGroupObj.mask.top undefined");h.drawImage(t.mask.canvas,t.mask.left,t.mask.top)}if(e){if(void 0===r)throw Error("groupCtx undefined");r.globalCompositeOperation=l.mixModeStr,r.globalAlpha=l.opacity,r.drawImage(l.image,0,0)}else l.opacity=l.opacity*c,a.push(l)}continue}let g=(0,$f5ug2.createCanvas)(i.width,i.height),m=$2Eggz.BB.ctx(g);if(p.canvas){if(void 0===p.top)throw Error("item.top undefined");if(void 0===p.left)throw Error("item.left undefined");m.drawImage(p.canvas,p.left,p.top)}if(p.effects&&s("layer-effect"),p.mask){if(s("mask"),void 0===p.mask.canvas)throw Error("item.mask.canvas undefined");if(void 0===p.mask.defaultColor)throw Error("item.mask.defaultColor undefined");if(void 0===p.mask.left)throw Error("item.mask.left undefined");if(void 0===p.mask.top)throw Error("item.mask.top undefined");o(p.mask.canvas,p.mask.defaultColor),m.globalCompositeOperation=0===p.mask.defaultColor?"destination-in":"destination-out",m.drawImage(p.mask.canvas,p.mask.left,p.mask.top)}if(u){if(void 0===p.right)throw Error("item.right undefined");if(void 0===p.left)throw Error("item.left undefined");if(void 0===p.bottom)throw Error("item.bottom undefined");if(void 0===p.top)throw Error("item.top undefined");if(void 0===p.canvas)throw Error("item.canvas undefined");let e=(0,$f5ug2.createCanvas)(p.right-p.left,p.bottom-p.top),i=$2Eggz.BB.ctx(e);i.drawImage(p.canvas,0,0);for(let e=d+1;e<t.children.length&&t.children[e].clipping;e++){let s=t.children[e];if(0!==s.opacity&&!s.hidden){if(void 0===s.blendMode)throw Error("clippingItem.blendMode undefined");if(void 0===s.opacity)throw Error("clippingItem.opacity undefined");if(void 0===s.canvas)throw Error("clippingItem.canvas undefined");if(void 0===s.left)throw Error("clippingItem.left undefined");if(void 0===s.top)throw Error("clippingItem.top undefined");i.globalCompositeOperation=n(s.blendMode),i.globalAlpha=s.opacity,i.drawImage(s.canvas,s.left-p.left,s.top-p.top)}}m.globalCompositeOperation="source-atop",m.drawImage(e,p.left,p.top)}if(t.mask){if(m.globalCompositeOperation=0===t.mask.defaultColor?"destination-in":"destination-out",void 0===t.mask.canvas)throw Error("psdGroupObj.mask.canvas undefined");if(void 0===t.mask.left)throw Error("psdGroupObj.mask.left undefined");if(void 0===t.mask.top)throw Error("psdGroupObj.mask.top undefined");m.drawImage(t.mask.canvas,t.mask.left,t.mask.top)}if(void 0===p.blendMode)throw Error("item.blendMode undefined");if(void 0===p.hidden)throw Error("item.hidden  undefined");if(void 0===p.opacity)throw Error("item.opacity undefined");if(e&&r)c>0&&(r.globalCompositeOperation=n(p.blendMode),r.globalAlpha=p.hidden?0:p.opacity,r.drawImage(g,0,0));else{if(void 0===p.name)throw Error("item.name undefined");a.push({name:p.name,isVisible:!p.hidden&&h,opacity:p.opacity*c,mixModeStr:n(p.blendMode),image:g})}}if(e){if(void 0===t.name)throw Error("psdGroupObj.name undefined");a=[{name:t.name,isVisible:h,opacity:c,mixModeStr:d,image:e}]}return a}return i.layers=[],i.layers=l({name:"root",opacity:1,blendMode:"normal",children:t.children}),i}function $e9d04a247aa46c18$export$56493bf279c387b3(t){let e={projectId:(0,$VM6dD.randomUuid)(),width:t.width,height:t.height,layers:[]};return t.layers?e.layers=t.layers.map(t=>({name:t.name,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,image:t.image})):e.layers=[{name:$63d0b335c576c718$export$ce37e184d908d785("background"),isVisible:!0,opacity:1,mixModeStr:"source-over",image:t.canvas}],e}var $c19704f4e70546aa$exports={};$c19704f4e70546aa$exports=$parcel$resolve("gJYYq");var $971718e1b87cb4cf$exports={};$971718e1b87cb4cf$exports=$parcel$resolve("fDGND");var $225f2fa0a90eb49a$exports={};$225f2fa0a90eb49a$exports=$parcel$resolve("8f0bW");var $a8802b2c46821c4c$exports={};$a8802b2c46821c4c$exports=$parcel$resolve("fAhTF");var $d687c20280145495$exports={};$d687c20280145495$exports=$parcel$resolve("lTNVM");var $d9bd1d2bff1f74cf$exports={};$d9bd1d2bff1f74cf$exports=$parcel$resolve("2mMxs");var $efa7f1c37f31dc78$exports={};$efa7f1c37f31dc78$exports=$parcel$resolve("lkhcY");var $ae8d4d20fe1b476f$exports={};$ae8d4d20fe1b476f$exports=$parcel$resolve("c9hFy");var $289cf9e086264f67$exports={};$289cf9e086264f67$exports=$parcel$resolve("297B8");var $2f2430cc582e1c11$exports={};$2f2430cc582e1c11$exports=$parcel$resolve("jxtUn");var $c2c4adc0fdf54ba1$exports={};$c2c4adc0fdf54ba1$exports=$parcel$resolve("lfC0f");var $038b7f7d23f79349$exports={};$038b7f7d23f79349$exports=$parcel$resolve("cDstS");var $ee963b5db9745aca$exports={};$ee963b5db9745aca$exports=$parcel$resolve("arfqb");var $f0e1c23f0e4f72a7$exports={};$f0e1c23f0e4f72a7$exports=$parcel$resolve("jz2is");var $20d70891ea1a59f6$exports={};$20d70891ea1a59f6$exports=$parcel$resolve("aeV12");var $51d846f6e7415a7b$exports={};$51d846f6e7415a7b$exports=$parcel$resolve("cFLos");var $515bac1c8139a974$exports={};$515bac1c8139a974$exports=$parcel$resolve("abcn9");let $aa2ca71db1de8ae6$export$24724bc1f91cba3={isLoaded:!1},$aa2ca71db1de8ae6$export$bac24f240bb7727d={brightnessContrast:{lang:{name:"filter-bright-contrast-title",button:"filter-bright-contrast",description:"filter-bright-contrast-description"},icon:$parcel$interopDefault($c19704f4e70546aa$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},cropExtend:{lang:{name:"filter-crop-title",button:"filter-crop-extend",description:"filter-crop-description"},icon:$parcel$interopDefault($2d3a7d1efb01840c$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},curves:{lang:{name:"filter-curves-title",button:"filter-curves",description:"filter-curves-description"},icon:$parcel$interopDefault($971718e1b87cb4cf$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},distort:{lang:{name:"filter-distort",button:"filter-distort",description:"filter-distort-description"},icon:$parcel$interopDefault($515bac1c8139a974$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},flip:{lang:{name:"filter-flip-title",button:"filter-flip",description:"filter-flip-description"},icon:$parcel$interopDefault($225f2fa0a90eb49a$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},hueSaturation:{lang:{name:"filter-hue-sat-title",button:"filter-hue-sat",description:"filter-hue-sat-description"},icon:$parcel$interopDefault($a8802b2c46821c4c$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},invert:{lang:{name:"filter-invert",button:"filter-invert"},icon:$parcel$interopDefault($d687c20280145495$exports),updatePos:!1,isInstant:!0,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},perspective:{lang:{name:"filter-perspective-title",button:"filter-perspective",description:"filter-perspective-description"},icon:$parcel$interopDefault($d9bd1d2bff1f74cf$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},resize:{lang:{name:"filter-resize-title",button:"filter-resize",description:"filter-resize-description"},icon:$parcel$interopDefault($efa7f1c37f31dc78$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},rotate:{lang:{name:"filter-rotate-title",button:"filter-rotate",description:"filter-rotate-description"},icon:$parcel$interopDefault($457bbdb587ea898d$exports),updatePos:!0,getDialog:null,apply:null,inEmbed:!1},tiltShift:{lang:{name:"filter-tilt-shift-title",button:"filter-tilt-shift",description:"filter-tilt-shift-description"},icon:$parcel$interopDefault($ae8d4d20fe1b476f$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},toAlpha:{lang:{name:"filter-to-alpha-title",button:"filter-to-alpha",description:"filter-to-alpha-description"},icon:$parcel$interopDefault($289cf9e086264f67$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},transform:{lang:{name:"filter-transform-title",button:"filter-transform",description:"filter-transform-description"},icon:$parcel$interopDefault($2f2430cc582e1c11$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},blur:{lang:{name:"filter-triangle-blur-title",button:"filter-triangle-blur",description:"filter-triangle-blur-description"},icon:$parcel$interopDefault($c2c4adc0fdf54ba1$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},unsharpMask:{lang:{name:"filter-unsharp-mask-title",button:"filter-unsharp-mask",description:"filter-unsharp-mask-description"},icon:$parcel$interopDefault($038b7f7d23f79349$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,darkNoInvert:!0,webGL:!0},grid:{lang:{name:"filter-grid",button:"filter-grid",description:"filter-grid-description"},icon:$parcel$interopDefault($ee963b5db9745aca$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},noise:{lang:{name:"filter-noise",button:"filter-noise",description:"filter-noise-description"},icon:$parcel$interopDefault($f0e1c23f0e4f72a7$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0,webGL:!0},pattern:{lang:{name:"filter-pattern",button:"filter-pattern",description:"filter-pattern-description"},icon:$parcel$interopDefault($20d70891ea1a59f6$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0},vanishPoint:{lang:{name:"filter-vanish-point-title",button:"filter-vanish-point",description:"filter-vanish-point-description"},icon:$parcel$interopDefault($51d846f6e7415a7b$exports),updatePos:!1,getDialog:null,apply:null,inEmbed:!0}};var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");let $f49636f27554dab5$var$myModule={};class $f49636f27554dab5$var$Grad{dot2(t,e){return this.x*t+this.y*e}constructor(t,e,i){this.x=t,this.y=e,this.z=i}}let $f49636f27554dab5$var$grad3=[new $f49636f27554dab5$var$Grad(1,1,0),new $f49636f27554dab5$var$Grad(-1,1,0),new $f49636f27554dab5$var$Grad(1,-1,0),new $f49636f27554dab5$var$Grad(-1,-1,0),new $f49636f27554dab5$var$Grad(1,0,1),new $f49636f27554dab5$var$Grad(-1,0,1),new $f49636f27554dab5$var$Grad(1,0,-1),new $f49636f27554dab5$var$Grad(-1,0,-1),new $f49636f27554dab5$var$Grad(0,1,1),new $f49636f27554dab5$var$Grad(0,-1,1),new $f49636f27554dab5$var$Grad(0,1,-1),new $f49636f27554dab5$var$Grad(0,-1,-1)],$f49636f27554dab5$var$p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],$f49636f27554dab5$var$perm=Array(512),$f49636f27554dab5$var$gradP=Array(512);$f49636f27554dab5$var$myModule.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(let e=0;e<256;e++){let i;i=1&e?$f49636f27554dab5$var$p[e]^255&t:$f49636f27554dab5$var$p[e]^t>>8&255,$f49636f27554dab5$var$perm[e]=$f49636f27554dab5$var$perm[e+256]=i,$f49636f27554dab5$var$gradP[e]=$f49636f27554dab5$var$gradP[e+256]=$f49636f27554dab5$var$grad3[i%12]}},$f49636f27554dab5$var$myModule.seed(0);let $f49636f27554dab5$var$F2=.5*(Math.sqrt(3)-1),$f49636f27554dab5$var$G2=(3-Math.sqrt(3))/6;$f49636f27554dab5$var$myModule.simplex2=function(t,e){let i,s,n,r,a,o=(t+e)*$f49636f27554dab5$var$F2,l=Math.floor(t+o),h=Math.floor(e+o),c=(l+h)*$f49636f27554dab5$var$G2,d=t-l+c,p=e-h+c;d>p?(r=1,a=0):(r=0,a=1);let u=d-r+$f49636f27554dab5$var$G2,g=p-a+$f49636f27554dab5$var$G2,m=d-1+2*$f49636f27554dab5$var$G2,f=p-1+2*$f49636f27554dab5$var$G2,y=$f49636f27554dab5$var$gradP[(l&=255)+$f49636f27554dab5$var$perm[h&=255]],v=$f49636f27554dab5$var$gradP[l+r+$f49636f27554dab5$var$perm[h+a]],x=$f49636f27554dab5$var$gradP[l+1+$f49636f27554dab5$var$perm[h+1]],b=.5-d*d-p*p;b<0?i=0:(b*=b,i=b*b*y.dot2(d,p));let w=.5-u*u-g*g;w<0?s=0:(w*=w,s=w*w*v.dot2(u,g));let B=.5-m*m-f*f;return B<0?n=0:(B*=B,n=B*B*x.dot2(m,f)),70*(i+s+n)};let $f49636f27554dab5$export$d3022aad56692482=$f49636f27554dab5$var$myModule;function $be08c7e8caa49ffa$export$74a44bbc21d06a28(t){let e=t/500,i=t,s=$2Eggz.BB.canvas(t,i),n=$2Eggz.BB.ctx(s),r=n.createImageData(t,i);for(let s=0;s<t;s++)for(let n=0;n<i;n++){let a=(n*t+s)*4,o=e+.04*$f49636f27554dab5$export$d3022aad56692482.simplex2(s/50/e,n/50/e),l=100+($f49636f27554dab5$export$d3022aad56692482.simplex2(s/50/o,n/50/o)+1)/2*100;l-=($f49636f27554dab5$export$d3022aad56692482.simplex2(s/10/e,n/10/e)+1)/2*100;let h=$2Eggz.BB.dist(t/2,i/2,s,n);l*=$2Eggz.BB.clamp(1-((h-t/2.5)/(t/14)+$f49636f27554dab5$export$d3022aad56692482.simplex2(s/22/o,n/22/o)),0,1)*(2*$2Eggz.BB.clamp(1-h/t,0,1)),r.data[a]=0,r.data[a+1]=0,r.data[a+2]=0,r.data[a+3]=$2Eggz.BB.clamp(l,0,255)}return n.putImageData(r,0,0),s}function $be08c7e8caa49ffa$var$udSegment(t,e,i){let s=$2Eggz.BB.Vec2.sub(i,e),n=$2Eggz.BB.Vec2.sub(t,e),r=$2Eggz.BB.clamp($2Eggz.BB.Vec2.dot(n,s)/$2Eggz.BB.Vec2.dot(s,s),0,1);return $2Eggz.BB.Vec2.len($2Eggz.BB.Vec2.sub(n,$2Eggz.BB.Vec2.mul(s,r)))}function $be08c7e8caa49ffa$export$eaa218d5d17c8f1c(t){let e,i;e=2/3*(1/4),i=1/3*(1/4);let s={x:1/4*t,y:t-1/4*t},n={x:t-1/4*t,y:1/4*t},r=t,a=$2Eggz.BB.canvas(t,r),o=$2Eggz.BB.ctx(a),l=o.createImageData(t,r);for(let a=0;a<t;a++)for(let o=0;o<r;o++){let r=(o*t+a)*4,h=$be08c7e8caa49ffa$var$udSegment({x:a,y:o},s,n);h=$2Eggz.BB.clamp(255-(h-t*e)/(t*i)*255,0,255),l.data[r]=0,l.data[r+1]=0,l.data[r+2]=0,l.data[r+3]=h}return o.putImageData(l,0,0),a}let $f1a560137f603778$export$67a3081d7cc6182d=[];function $fc7b31422a41da93$export$263fa670dc037098(t,e){let i=t.activeLayerId;return{layerMap:Object.fromEntries(Object.entries(t.layerMap).map(([t,s])=>t===i?[t,{tiles:e instanceof HTMLCanvasElement?$a262f7e0a9f5e4af$export$7b1ba44282f9a519(e):[...e]}]:[t,{}]))}}$f1a560137f603778$export$67a3081d7cc6182d[1]=$be08c7e8caa49ffa$export$74a44bbc21d06a28(128),$f1a560137f603778$export$67a3081d7cc6182d[2]=$be08c7e8caa49ffa$export$eaa218d5d17c8f1c(128);var $aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");let $ab3d0b0688f50842$var$ALPHA_CIRCLE=0,$ab3d0b0688f50842$var$ALPHA_CHALK=1,$ab3d0b0688f50842$var$ALPHA_CAL=2,$ab3d0b0688f50842$var$ALPHA_SQUARE=3,$ab3d0b0688f50842$var$TWO_PI=2*Math.PI;class $ab3d0b0688f50842$export$6f96c8f9e6ae7341{updateChangedTiles(t){let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);e&&(this.changedTiles=$b37280925142c567$export$1774f90c6da5013c(this.changedTiles,$b37280925142c567$export$2098fe43203ddd32(e,this.context.canvas.width,this.context.canvas.height)))}updateAlphaCanvas(){let t;if(this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_CIRCLE||this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_SQUARE)return;let e=[[this.alphaCanvas128,128],[this.alphaCanvas64,64],[this.alphaCanvas32,32]];for(let i=0;i<e.length;i++)(t=$2Eggz.BB.ctx(e[i][0])).save(),t.clearRect(0,0,e[i][1],e[i][1]),t.fillStyle="rgba("+this.settingColor.r+", "+this.settingColor.g+", "+this.settingColor.b+", "+this.alphaOpacityArr[this.settingAlphaId]+")",t.fillRect(0,0,e[i][1],e[i][1]),t.globalCompositeOperation="destination-in",t.imageSmoothingQuality="high",t.drawImage($f1a560137f603778$export$67a3081d7cc6182d[this.settingAlphaId],0,0,e[i][1],e[i][1]),t.restore()}calcOpacity(t){return this.settingOpacity*(this.settingHasOpacityPressure?t*t:1)}calcScatter(t){return this.settingScatter*this.settingSize*(this.settingHasScatterPressure?t:1)}drawDot(t,e,i,s,n,r,a){if(i<=0)return;if(this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),a&&a[3]===s||(this.context.globalAlpha=s),a||this.settingAlphaId!==$ab3d0b0688f50842$var$ALPHA_CIRCLE&&this.settingAlphaId!==$ab3d0b0688f50842$var$ALPHA_SQUARE||(this.context.fillStyle=this.settingColorStr),n>0){let i=2*Math.random()*Math.PI,s=Math.sqrt(Math.random())*n;t+=Math.cos(i)*s,e+=Math.sin(i)*s}let o=this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_CIRCLE||this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_CAL?i:i*Math.sqrt(2);if(this.updateChangedTiles({x1:Math.floor(t-o),y1:Math.floor(e-o),x2:Math.ceil(t+o),y2:Math.ceil(e+o)}),this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_CIRCLE)this.context.beginPath(),this.context.arc(t,e,i,0,$ab3d0b0688f50842$var$TWO_PI),this.context.closePath(),this.context.fill(),this.hasDrawnDot=!0;else if(this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_SQUARE)void 0!==r&&(this.context.save(),this.context.translate(t,e),this.context.rotate(r/180*Math.PI),this.context.fillRect(-i,-i,2*i,2*i),this.context.restore(),this.hasDrawnDot=!0);else{this.context.save(),this.context.translate(t,e);let s=this.alphaCanvas128;i<=32&&i>16?s=this.alphaCanvas64:i<=16&&(s=this.alphaCanvas32),this.context.scale(i,i),this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_CHALK&&this.context.rotate((t+e)*53123%$ab3d0b0688f50842$var$TWO_PI),this.context.drawImage(s,-1,-1,2,2),this.context.restore(),this.hasDrawnDot=!0}}continueLine(t,e,i,s){let n;null===this.bezierLine&&(this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,()=>{}));let r=[],a=t=>{let e=$2Eggz.BB.mix(this.lastInput2.pressure,s,t.t),i=this.calcOpacity(e),n=Math.max(.1,this.settingSize*(this.settingHasSizePressure?e:1)),a=this.calcScatter(e);r.push([t.x,t.y,n,i,a,t.angle])},o=i*this.settingSpacing;null===t||null===e?this.bezierLine.addFinal(o,a):this.bezierLine.add(t,e,o,a),this.context.save();for(let t=0;t<r.length;t++){let e=r[t];this.drawDot(e[0],e[1],e[2],e[3],e[4],e[5],n),n=e}this.context.restore()}startLine(t,e,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],i=$2Eggz.BB.clamp(i,0,1);let s=this.calcOpacity(i),n=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize),r=this.calcScatter(i);this.hasDrawnDot=!1,this.inputIsDrawing=!0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(t,e,n,s,r),this.context.restore(),this.lineToolLastDot=n*this.settingSpacing,this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.inputArr=[{x:t,y:e,pressure:i}]}goLine(t,e,i){if(!this.inputIsDrawing)return;let s=$2Eggz.BB.clamp(i,0,1),n=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(t,e,n,this.lastInput.pressure),this.context.restore(),this.lastInput.x=t,this.lastInput.y=e,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=s,this.inputArr.push({x:t,y:e,pressure:i})}endLine(){let t=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);if(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(null,null,t,this.lastInput.pressure),this.context.restore(),this.inputIsDrawing=!1,this.settingAlphaId===$ab3d0b0688f50842$var$ALPHA_SQUARE&&!this.hasDrawnDot){let e=this.inputArr[0];this.inputArr.forEach(t=>{t.pressure>e.pressure&&(e=t)}),this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);let i=$2Eggz.BB.clamp(e.pressure,0,1),s=this.calcOpacity(i),n=this.calcScatter(i);this.drawDot(e.x,e.y,t,s,n,0),this.context.restore()}this.bezierLine=null,this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles))),this.hasDrawnDot=!1,this.inputArr=[]}drawLineSegment(t,e,i,s){let n;if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.lastInput.x=i,this.lastInput.y=s,this.lastInput.pressure=1,this.inputIsDrawing||void 0===t)return;let r=$2Eggz.BB.pointsToAngleDeg({x:t,y:e},{x:i,y:s}),a=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2)),o=(i-t)/a,l=(s-e)/a,h=this.settingSize*this.settingSpacing;this.lineToolLastDot=this.settingSize*this.settingSpacing,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);let c=this.calcScatter(1);for(n=this.lineToolLastDot;n<=a;n+=h)this.drawDot(t+o*n,e+l*n,this.settingSize,this.settingOpacity,c,r);this.context.restore(),this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}isDrawing(){return this.inputIsDrawing}setAlpha(t){this.settingAlphaId!==t&&(this.settingAlphaId=t,this.updateAlphaCanvas())}setColor(t){this.settingColor!==t&&(this.settingColor={r:t.r,g:t.g,b:t.b},this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")",this.updateAlphaCanvas())}setContext(t){this.context=t}setHistory(t){this.klHistory=t}setSize(t){this.settingSize=t}setOpacity(t){this.settingOpacity=t}setScatter(t){this.settingScatter=t}setSpacing(t){this.settingSpacing=t}sizePressure(t){this.settingHasSizePressure=t}opacityPressure(t){this.settingHasOpacityPressure=t}scatterPressure(t){this.settingHasScatterPressure=t}setLockAlpha(t){this.settingLockLayerAlpha=t}getSpacing(){return this.settingSpacing}getSize(){return this.settingSize}getOpacity(){return this.settingOpacity}getScatter(){return this.settingScatter}getLockAlpha(){return this.settingLockLayerAlpha}constructor(){this.context={},this.klHistory={},this.settingHasOpacityPressure=!1,this.settingHasScatterPressure=!1,this.settingHasSizePressure=!0,this.settingSize=2,this.settingSpacing=.8489,this.settingOpacity=1,this.settingScatter=0,this.settingColor={},this.settingColorStr="",this.settingAlphaId=$ab3d0b0688f50842$var$ALPHA_CIRCLE,this.settingLockLayerAlpha=!1,this.hasDrawnDot=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.inputArr=[],this.inputIsDrawing=!1,this.bezierLine=null,this.alphaCanvas128=$2Eggz.BB.canvas(128,128),this.alphaCanvas64=$2Eggz.BB.canvas(64,64),this.alphaCanvas32=$2Eggz.BB.canvas(32,32),this.alphaOpacityArr=[1,.9,1,1],this.changedTiles=[]}}var $2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis"),$VM6dD=parcelRequire("VM6dD");class $2beac24702a6836b$export$9659db8d01dd5313{updateRedrawBounds(t){let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);e&&(this.redrawBounds=$2Eggz.BB.updateBounds(this.redrawBounds,e))}getCellsWidth(){return Math.ceil(this.context.canvas.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6)}drawCells(t){let e=this.getCellsWidth();t.forEach((t,i)=>{if(!t)return;let s=i%e*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,n=Math.floor(i/e)*$d2dccce11beb16cf$export$f7bc58374d6bc9b6;this.context.putImageData(t,s,n)})}drawChangedCells(){if(!this.redrawBounds)return;let t=this.cells.map(()=>void 0);this.getTouchedCells(this.redrawBounds).forEach((e,i)=>{e&&(t[i]=this.cells[i])}),this.drawCells(t),this.redrawBounds=void 0}getTouchedCells(t){let e=this.cells.map(()=>!1),i=this.getCellsWidth();t={x1:Math.floor(t.x1/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),y1:Math.floor(t.y1/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),x2:Math.floor(t.x2/$d2dccce11beb16cf$export$f7bc58374d6bc9b6),y2:Math.floor(t.y2/$d2dccce11beb16cf$export$f7bc58374d6bc9b6)};for(let s=t.x1;s<=t.x2;s++)for(let n=t.y1;n<=t.y2;n++)e[n*i+s]=!0;return e}sliceBounds(t){let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);if(!e)return[];let i=this.getCellsWidth(),s=[];return this.getTouchedCells(e).forEach((t,n)=>{if(!t)return;let r=n%i*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,a=Math.floor(n/i)*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,o=this.cells[n].width,l=this.cells[n].height,h={x1:Math.max(0,e.x1-r),y1:Math.max(0,e.y1-a),x2:Math.min(o-1,e.x2-r),y2:Math.min(l-1,e.y2-a)};h.x1>h.x2||h.y1>h.y2||s.push({index:n,bounds:h})}),s}copyFromCanvas(t){if(!t)return;let e=this.getTouchedCells(t),i=this.klHistory.getComposed().layerMap[this.layerId];e.forEach((t,e)=>{if(!t||this.cells[e])return;let s=i.tiles[e];if($15ded6c5722f2bc8$export$dba0834b723f37f4(s)){let t=$2Eggz.BB.canvas($d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),i=$2Eggz.BB.ctx(t);i.fillStyle=s.fill,i.fillRect(0,0,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),this.cells[e]=i.getImageData(0,0,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6)}else this.cells[e]=$2946cfe57170d555$export$3d7bd55e322555b1(s.data)})}getAverage(t,e,i){let s=Math.max(0,Math.floor(t-(i=Math.max(.5,.75*i)))),n=Math.max(0,Math.floor(e-i)),r=Math.min(this.context.canvas.width-1,Math.ceil(t+i)),a=Math.min(this.context.canvas.height-1,Math.ceil(e+i));if(s>r||n>a)return{r:0,g:0,b:0,a:0};let o=0,l=0,h=0,c=0,d=this.sliceBounds({x1:s,y1:n,x2:r,y2:a}),p=this.getCellsWidth();return d.forEach(t=>{let e=t.index%p*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,i=Math.floor(t.index/p)*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,s=this.cells[t.index].width,n=this.cells[t.index].data,r=t.bounds;for(let t=r.y1,a=t+i;t<=r.y2;t++,a++)for(let i=r.x1,d=i+e,p=(t*s+r.x1)*4;i<=r.x2;i++,d++,p+=4){if(this.mask&&0===this.mask[a*this.context.canvas.width+d])continue;let t=n[p+3]/255;0!==t&&(o+=n[p]*t,l+=n[p+1]*t,h+=n[p+2]*t,c+=t)}}),0!==c&&(o/=c,l/=c,h/=c,c=Math.min(1,c)),{r:o,g:l,b:h,a:c}}getDotBounds(t,e,i){let s=Math.max(0,Math.floor(t-(i=Math.max(.5,i)))),n=Math.max(0,Math.floor(e-i)),r=Math.min(this.context.canvas.width-1,Math.ceil(t+i)),a=Math.min(this.context.canvas.height-1,Math.ceil(e+i));if(!(s>r)&&!(n>a))return{x1:s,y1:n,x2:r,y2:a}}drawDot(t){let e=0,i=t.size>30?1024:512,s=[];for(let t=0;t<i;t++)s[t]=(Math.random()-.5)/1.001+.5;let n=[8,4,4,4,2,2,2,2,2,2][Math.floor(2*t.size)],r=n?n*n:0,a=[];if(n){let t=0;for(let e=0;e<n;e++)for(let i=0;i<n;i++,t+=2)a[t]=(e+1)/n,a[t+1]=(i+1)/n}let o=.8*Math.pow(t.opacity,2),l=1-o,h=o/l,c=t.size*t.size,d=c*l/t.opacity,p=(1+h)*t.opacity,u=this.sliceBounds({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),g=this.getCellsWidth();u.forEach(n=>{let o=n.index%g*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,l=Math.floor(n.index/g)*$d2dccce11beb16cf$export$f7bc58374d6bc9b6,h=this.cells[n.index].width,u=this.cells[n.index].data;for(let g=n.bounds.y1,m=g+l-t.y;g<=n.bounds.y2;g++,m++)for(let f=n.bounds.x1,y=(g+l)*this.context.canvas.width+(n.bounds.x1+o),v=(g*h+n.bounds.x1)*4,x=f+o-t.x;f<=n.bounds.x2;f++,y++,v+=4,x++){if(this.mask&&0===this.mask[y])continue;let n=0;if(r){for(let e=0;e<a.length;e+=2){let i=$2Eggz.BB.lenSquared(x+a[e],m+a[e+1]);i>=c||(n+=(0,$8cWis.clamp)(p-i/d,0,t.opacity))}if(!n)continue;n/=r}else{let e=Math.pow(x,2)+Math.pow(m,2);if(e>=c)continue;n=(0,$8cWis.clamp)(p-e/d,0,t.opacity)}let o=1-n,l=u[v+3]/255;if(this.settingLockLayerAlpha){let i=t.r*n+u[v]*o,r=t.g*n+u[v+1]*o,a=t.b*n+u[v+2]*o;l&&(u[v]=Math.floor(i+s[e]),u[v+1]=Math.floor(r+s[e]),u[v+2]=Math.floor(a+s[e]))}else{let i=t.r*n+u[v]*l*o,r=t.g*n+u[v+1]*l*o,a=t.b*n+u[v+2]*l*o,h=1-o*(1-l);u[v+3]=Math.floor(Math.min(255,255*h)+.5),h&&(u[v]=Math.floor(i/h+s[e]),u[v+1]=Math.floor(r/h+s[e]),u[v+2]=Math.floor(a/h+s[e]))}e=(e+1)%i}})}calcSpacing(t){return $2Eggz.BB.mix(2*t/2,2*t/9,(0,$8cWis.clamp)((t-2.7)/9.3,0,1))}continueLine(t,e,i,s){let n,r,a;this.drawBuffer=[];let o=this.settingSizePressure?Math.max(1,i*this.size):Math.max(1,this.size),l=this.calcSpacing(o),h=void 0===t?this.lastInput.x:t,c=void 0===e?this.lastInput.y:e;if(0===this.blending)this.mixCol.r=this.color.r,this.mixCol.g=this.color.g,this.mixCol.b=this.color.b;else{let t;if(s)t={r:this.localColOld.r,g:this.localColOld.g,b:this.localColOld.b,a:0};else{let e=[h,c,this.settingSizePressure?Math.max(.5,i*this.size):Math.max(.5,this.size)],s=this.getDotBounds(e[0],e[1],e[2]);s&&this.copyFromCanvas(s),t=this.getAverage(e[0],e[1],e[2])}a={r:0,g:0,b:0,a:0},t.a>0&&0===this.blendCol.a?(this.blendCol.r=t.r,this.blendCol.g=t.g,this.blendCol.b=t.b,this.blendCol.a=t.a):(0===t.a&&(t.r=this.color.r,t.g=this.color.g,t.b=this.color.b,t.a=1-this.blending),this.blendCol.r=$2Eggz.BB.mix(this.blendCol.r,$2Eggz.BB.mix(this.blendCol.r,t.r,this.blendMix),t.a),this.blendCol.g=$2Eggz.BB.mix(this.blendCol.g,$2Eggz.BB.mix(this.blendCol.g,t.g,this.blendMix),t.a),this.blendCol.b=$2Eggz.BB.mix(this.blendCol.b,$2Eggz.BB.mix(this.blendCol.b,t.b,this.blendMix),t.a),this.blendCol.a=Math.min(1,this.blendCol.a+t.a)),a.r=this.blendCol.r,a.g=this.blendCol.g,a.b=this.blendCol.b,a.a=this.blendCol.a}let d=t=>{if(this.blending>=1&&this.blendCol.a<=0)return;let e=t.t;n=this.lastInput2.pressure*(1-e)+i*e,r=this.settingOpacityPressure?this.opacity*n*n:this.opacity,o=this.settingSizePressure?Math.max(.1,n*this.size):Math.max(.1,this.size),0!=this.blending&&(this.mixCol.r=$2Eggz.BB.mix(this.localColOld.r,a.r,e),this.mixCol.g=$2Eggz.BB.mix(this.localColOld.g,a.g,e),this.mixCol.b=$2Eggz.BB.mix(this.localColOld.b,a.b,e)),1===this.blending&&0===this.localColOld.a&&(this.mixCol.r=a.r,this.mixCol.g=a.g,this.mixCol.b=a.b);let s=this.getDotBounds(t.x,t.y,o);s&&(this.updateRedrawBounds(s),this.drawBuffer.push({x:t.x,y:t.y,size:o,opacity:r,x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,r:$2Eggz.BB.mix(this.color.r,this.mixCol.r,this.blending),g:$2Eggz.BB.mix(this.color.g,this.mixCol.g,this.blending),b:$2Eggz.BB.mix(this.color.b,this.mixCol.b,this.blending)}))};void 0===t||void 0===e?this.bezierLine.addFinal(l,d):this.bezierLine.add(t,e,l,d),this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach(t=>{this.drawDot(t)}),this.drawBuffer=[],this.localColOld=a}setHistory(t){this.klHistory=t}getSize(){return this.size}setSize(t){this.size=t}getOpacity(){return this.opacity}setOpacity(t){this.opacity=t}getBlending(){return this.blending}setBlending(t){this.blending=t}setColor(t){this.color=$2Eggz.BB.copyObj(t)}setContext(t,e){this.context=t,this.layerId=e}setSizePressure(t){this.settingSizePressure=t}setOpacityPressure(t){this.settingOpacityPressure=t}getLockAlpha(){return this.settingLockLayerAlpha}setLockAlpha(t){this.settingLockLayerAlpha=t}getIsDrawing(){return this.isDrawing}setIsTesting(t){this.isTesting=t}startLine(t,e,i){let s=this.klHistory.getComposed().selection.value;this.selectionBounds=s?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(s)):void 0,this.mask=s?$12e0dda7c62dd122$export$820c5732ce56544(s,this.context.canvas.width,this.context.canvas.height):void 0;let n=Math.ceil(this.context.canvas.width/$d2dccce11beb16cf$export$f7bc58374d6bc9b6)*Math.ceil(this.context.canvas.height/$d2dccce11beb16cf$export$f7bc58374d6bc9b6);this.cells=(0,$VM6dD.createArray)(n,void 0),this.isDrawing=!0,i=Math.max(0,Math.min(1,i));let r=this.settingOpacityPressure?this.opacity*i*i:this.opacity,a=this.settingSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size);if(0===this.blending)this.mixCol.r=this.color.r,this.mixCol.g=this.color.g,this.mixCol.b=this.color.b;else{this.copyFromCanvas(this.getDotBounds(t,e,a));let s=this.getAverage(t,e,this.settingSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size));0===s.a?this.blendCol={r:this.color.r,g:this.color.g,b:this.color.b,a:1-this.blending}:this.blendCol={r:s.r,g:s.g,b:s.b,a:s.a},this.mixCol.r=this.blendCol.r,this.mixCol.g=this.blendCol.g,this.mixCol.b=this.blendCol.b}if(this.localColOld={r:this.mixCol.r,g:this.mixCol.g,b:this.mixCol.b,a:this.blendCol.a},this.redrawBounds=void 0,this.drawBuffer=[],this.blending<1||this.blendCol.a>0){let i=this.getDotBounds(t,e,a);i&&(this.updateRedrawBounds(i),this.drawBuffer.push({x:t,y:e,size:a,opacity:r,x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,r:$2Eggz.BB.mix(this.color.r,this.mixCol.r,this.blending),g:$2Eggz.BB.mix(this.color.g,this.mixCol.g,this.blending),b:$2Eggz.BB.mix(this.color.b,this.mixCol.b,this.blending)}))}this.copyFromCanvas(this.redrawBounds),this.drawBuffer.forEach(t=>{this.drawDot(t)}),this.drawBuffer=[],this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(t,e,0,function(){}),this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.isTesting||this.drawChangedCells()}goLine(t,e,i,s){this.isDrawing&&(this.continueLine(t,e,this.lastInput.pressure,s),this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.isTesting||this.drawChangedCells())}endLine(){if(this.bezierLine&&this.continueLine(void 0,void 0,this.lastInput.pressure,!1),this.isDrawing=!1,this.bezierLine=void 0,this.drawChangedCells(),this.cells.some(t=>t)){let t=this.cells;if(this.selectionBounds){let e=$b37280925142c567$export$2098fe43203ddd32(this.selectionBounds,this.context.canvas.width,this.context.canvas.height);t=t.map((t,i)=>e[i]?t:void 0)}this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),t.map(t=>t?$96d94f28640c04c3$export$55941c74c8f934(t):void 0)))}this.cells=[]}drawLineSegment(t,e,i,s){let n=i-t,r=s-e,a=Math.ceil(Math.sqrt(n*n+r*r)/10);this.startLine(t,e,1);for(let i=1;i<=a;i++){let s=i/a,o=t+n*s,l=e+r*s;this.goLine(o,l,1,!1)}this.endLine()}constructor(){this.isTesting=!1,this.context={},this.layerId="NOT_SET",this.color={},this.size=29,this.opacity=.6,this.blending=.65,this.settingLockLayerAlpha=!1,this.settingSizePressure=!0,this.settingOpacityPressure=!1,this.blendCol={r:0,g:0,b:0,a:1},this.blendMix=.45,this.mixCol={r:0,g:0,b:0},this.localColOld={},this.isDrawing=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.klHistory={},this.cells=[],this.drawBuffer=[]}}var $2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");let $ec1ed8bc550ccd88$var$sampleCanvas=$2Eggz.BB.canvas(32,32),$ec1ed8bc550ccd88$var$sampleCtx=$2Eggz.BB.ctx($ec1ed8bc550ccd88$var$sampleCanvas);class $ec1ed8bc550ccd88$export$566f9061f0f5ba33{rand(){return this.sketchySeed++,.5*Math.sin(6324634.2345*Math.cos(5342.3423*this.sketchySeed))+.5}setHistory(t){this.klHistory=t}setSeed(t){this.sketchySeed=parseInt(""+t)}getSeed(){return parseInt(""+this.sketchySeed)}getSize(){return this.settingSize/2}setColor(t){this.settingColor=t}getOpacity(){return this.settingOpacity}setOpacity(t){this.settingOpacity=t}getBlending(){return this.settingBlending}setBlending(t){this.settingBlending=t}setSize(t){this.settingSize=2*t}getScale(){return this.settingScale}setScale(t){this.settingScale=t}setContext(t){this.context=t}startLine(t,e,i,s){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedBounds=void 0,s&&this.lastInput.x?(this.inputIsDrawing=!0,this.endLine()):(this.inputIsDrawing=!0,this.lastX=t,this.lastY=e,this.lastInput.x=t,this.lastInput.y=e)}goLine(t,e,i,s){let n,r,a,o;if(!this.inputIsDrawing||t===this.lastInput.x&&e===this.lastInput.y)return;let l=parseInt(""+t),h=parseInt(""+e);this.points.push([l,h]);let c=this.settingColor.r,d=this.settingColor.g,p=this.settingColor.b;if(s)c=s.r,d=s.g,p=s.b;else if(0!==this.settingBlending&&l+5>=0&&h+5>=0&&l-5<this.context.canvas.width-1&&h-5<this.context.canvas.height-1){c=0,d=0,p=0;let t=Math.min(this.context.canvas.width-1,Math.max(0,l-5)),e=Math.min(this.context.canvas.height-1,Math.max(0,h-5)),i=Math.min(this.context.canvas.width-1,Math.max(0,l+5)),s=Math.min(this.context.canvas.height-1,Math.max(0,h+5));if(i-=t,s-=e,i>0&&s>0){let n=this.context.getImageData(t,e,i,s),r=0;for(let t=0;t<n.data.length;t+=4)c+=n.data[t+0],d+=n.data[t+1],p+=n.data[t+2],r++;c/=r,d/=r,p/=r}let n=this.mixMode[0](new $2Eggz.BB.RGB(c,d,p),this.settingColor);c=parseInt(""+$2Eggz.BB.mix(this.settingColor.r,n.r,this.settingBlending)),d=parseInt(""+$2Eggz.BB.mix(this.settingColor.g,n.g,this.settingBlending)),p=parseInt(""+$2Eggz.BB.mix(this.settingColor.b,n.b,this.settingBlending))}for(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.context.strokeStyle="rgba("+c+", "+d+", "+p+", "+this.settingOpacity+")",this.context.lineWidth=this.settingSize,this.context.beginPath(),this.context.moveTo(this.lastX,this.lastY),this.context.lineTo(l,h),n=0;n<this.points.length;n++)(o=(r=this.points[n][0]-this.points[this.count][0])*r+(a=this.points[n][1]-this.points[this.count][1])*a)<4e3*this.settingScale*this.settingScale&&this.rand()>o/2e3/this.settingScale/this.settingScale&&(this.context.moveTo(this.points[this.count][0]+.3*r,this.points[this.count][1]+.3*a),this.context.lineTo(this.points[n][0]-.3*r,this.points[n][1]-.3*a));this.context.stroke(),this.context.restore(),this.count++,this.lastX=l,this.lastY=h,this.lastInput.x=l,this.lastInput.y=h,this.changedBounds=$2Eggz.BB.updateBounds(this.changedBounds,{x1:Math.floor(l-this.settingSize/2),y1:Math.floor(h-this.settingSize/2),x2:Math.ceil(l+this.settingSize/2),y2:Math.ceil(h+this.settingSize/2)})}endLine(){if(this.inputIsDrawing=!1,this.count=0,this.points=[],this.changedBounds){let t=(0,$8cWis.boundsOverlap)(this.changedBounds,this.selectionBounds),e=$a262f7e0a9f5e4af$export$7b1ba44282f9a519(this.context.canvas,t);e.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),e))}}drawLineSegment(t,e,i,s){if(this.changedBounds=void 0,this.lastInput.x=i,this.lastInput.y=s,this.inputIsDrawing||void 0===t)return;this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.context.lineWidth=this.settingSize;let n={r:this.settingColor.r,g:this.settingColor.g,b:this.settingColor.b};if(t+5>=0&&e+5>=0&&t-5<this.context.canvas.width-1&&e-5<this.context.canvas.height-1){n.r=0,n.g=0,n.b=0;let i=Math.min(this.context.canvas.width-1,Math.max(0,t-5)),s=Math.min(this.context.canvas.height-1,Math.max(0,e-5)),r=Math.min(this.context.canvas.width-1,Math.max(0,t+5)),a=Math.min(this.context.canvas.height-1,Math.max(0,e+5));if(r-=i,a-=s,r>0&&a>0){let t=Math.min($ec1ed8bc550ccd88$var$sampleCanvas.width,r),e=Math.min($ec1ed8bc550ccd88$var$sampleCanvas.height,a);$ec1ed8bc550ccd88$var$sampleCtx.save(),$ec1ed8bc550ccd88$var$sampleCtx.globalCompositeOperation="copy",$ec1ed8bc550ccd88$var$sampleCtx.drawImage(this.context.canvas,i,s,r,a,0,0,t,e),$ec1ed8bc550ccd88$var$sampleCtx.restore();let o=$ec1ed8bc550ccd88$var$sampleCtx.getImageData(i,s,r,a),l=0;for(let t=0;t<o.data.length;t+=4)n.r+=o.data[t+0],n.g+=o.data[t+1],n.b+=o.data[t+2],l++;n.r/=l,n.g/=l,n.b/=l}}let r=this.mixMode[0](new $2Eggz.BB.RGB(n.r,n.g,n.b),this.settingColor);if(n.r=parseInt(""+(this.settingBlending*r.r+this.settingColor.r*(1-this.settingBlending))),n.g=parseInt(""+(this.settingBlending*r.g+this.settingColor.g*(1-this.settingBlending))),n.b=parseInt(""+(this.settingBlending*r.b+this.settingColor.b*(1-this.settingBlending))),this.context.strokeStyle="rgba("+n.r+", "+n.g+", "+n.b+", "+this.settingOpacity+")",this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(i,s),this.context.stroke(),this.context.strokeStyle="rgba("+n.r+", "+n.g+", "+n.b+", "+this.settingOpacity+")",this.context.restore(),this.changedBounds=$2Eggz.BB.updateBounds(this.changedBounds,{x1:Math.floor(t-this.settingSize/2),y1:Math.floor(e-this.settingSize/2),x2:Math.ceil(t+this.settingSize/2),y2:Math.ceil(e+this.settingSize/2)}),this.changedBounds=$2Eggz.BB.updateBounds(this.changedBounds,{x1:Math.floor(i-this.settingSize/2),y1:Math.floor(s-this.settingSize/2),x2:Math.ceil(i+this.settingSize/2),y2:Math.ceil(s+this.settingSize/2)}),this.changedBounds){let t=(0,$8cWis.boundsOverlap)(this.changedBounds,this.selectionBounds),e=$a262f7e0a9f5e4af$export$7b1ba44282f9a519(this.context.canvas,t);e.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),e))}}isDrawing(){return this.inputIsDrawing}constructor(){this.context={},this.settingColor={},this.settingSize=1,this.settingOpacity=.2,this.settingBlending=.5,this.settingScale=1,this.lastX=0,this.lastY=0,this.inputIsDrawing=!1,this.lastInput={x:0,y:0,pressure:0},this.klHistory={},this.sketchySeed=0,this.points=[],this.count=0,this.mixMode=[t=>t,(t,e)=>{let i=new $2Eggz.BB.RGB(t.r,t.g,t.b);return i.r*=e.r/255,i.g*=e.g/255,i.b*=e.b/255,i}]}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");class $f01b5e3bd1be2f34$export$4de5ef8eecde6f12{updateChangedTiles(t){t={x1:Math.min(t.x1,t.x2),y1:Math.min(t.y1,t.y2),x2:Math.max(t.x1,t.x2),y2:Math.max(t.y1,t.y2)};let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);if(!e)return;let i=$b37280925142c567$export$2098fe43203ddd32(e,this.context.canvas.width,this.context.canvas.height);this.redrawBounds=this.redrawBounds?(0,$8cWis.updateBounds)(this.redrawBounds,e):e,this.historyTiles=$b37280925142c567$export$1774f90c6da5013c(this.historyTiles,i)}initClone(){this.canvasClone=$2Eggz.BB.canvas(this.context.canvas.width,this.context.canvas.height),this.ctxClone=$2Eggz.BB.ctx(this.canvasClone),this.ctxClone.drawImage(this.context.canvas,0,0)}freeClone(){$2Eggz.BB.freeCanvas(this.canvasClone),this.ctxClone={}}redrawToCanvas(){if(!this.redrawBounds)return;let t=(0,$8cWis.boundsToRect)(this.redrawBounds,!0);this.context.save(),this.context.clearRect(t.x,t.y,t.width,t.height),this.context.drawImage(this.canvasClone,t.x,t.y,t.width,t.height,t.x,t.y,t.width,t.height),this.context.restore(),this.redrawBounds=void 0}updateDither(){this.ditherCtx.clearRect(0,0,4,4),this.ditherCtx.fillStyle=this.settingIsEraser?`rgb(${$7a2aeb795d64bafc$export$e4203cb02d5e5b28},${$7a2aeb795d64bafc$export$e4203cb02d5e5b28},${$7a2aeb795d64bafc$export$e4203cb02d5e5b28})`:this.settingColorStr;for(let t=0;t<Math.max(1,Math.round(this.settingOpacity*this.ditherArr.length));t++)this.ditherCtx.fillRect(this.ditherArr[t][0],this.ditherArr[t][1],1,1);this.ditherPattern=(0,$VM6dD.throwIfNull)(this.context.createPattern(this.ditherCanvas,"repeat"))}cubicCurveOverThreshold(t,e,i,s,n){let r=$2Eggz.BB.Vec2.nor({x:s.x-t.x,y:s.y-t.y}),a=$2Eggz.BB.Vec2.nor({x:e.x-t.x,y:e.y-t.y}),o=$2Eggz.BB.Vec2.nor({x:s.x-i.x,y:s.y-i.y});return Math.max($2Eggz.BB.Vec2.dist(r,a),$2Eggz.BB.Vec2.dist(r,o))>n}plotCubicBezierLine(t,e,i,s){let n=this.cubicCurveOverThreshold(t,e,i,s,.1);t.x=Math.floor(t.x),t.y=Math.floor(t.y),s.x=Math.floor(s.x),s.y=Math.floor(s.y);let r=$2Eggz.BB.dist(t.x,t.y,s.x,s.y);if(!n||r<7){this.updateChangedTiles({x1:t.x,y1:t.y,x2:s.x,y2:s.y}),this.plotLine(t.x,t.y,s.x,s.y,!0);return}let a=Math.max(2,Math.round(r/4)),o=[];for(let n=0;n<=a;n++){let r=n/a,l=Math.pow(1-r,3),h=3*r*Math.pow(1-r,2),c=3*Math.pow(r,2)*(1-r),d=Math.pow(r,3);o.push({x:l*t.x+h*e.x+c*i.x+d*s.x,y:l*t.y+h*e.y+c*i.y+d*s.y})}for(let t=0;t<a;t++)this.updateChangedTiles({x1:Math.round(o[t].x),y1:Math.round(o[t].y),x2:Math.round(o[t+1].x),y2:Math.round(o[t+1].y)}),this.plotLine(Math.round(o[t].x),Math.round(o[t].y),Math.round(o[t+1].x),Math.round(o[t+1].y),!0)}drawDot(t,e,i,s){let n={x:Math.round(t+-i),y:Math.round(e+-i),width:Math.round(2*i),height:Math.round(2*i)};this.updateChangedTiles({x1:n.x,y1:n.y,x2:n.x+n.width,y2:n.y+n.height}),this.ctxClone.save(),this.settingIsEraser?(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:"#fff",this.settingLockLayerAlpha?this.ctxClone.globalCompositeOperation="source-atop":this.ctxClone.globalCompositeOperation="destination-out"):(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:this.settingColorStr,this.settingLockLayerAlpha&&(this.ctxClone.globalCompositeOperation="source-atop")),this.ctxClone.globalAlpha=this.settingUseDither?1:s,this.ctxClone.fillRect(n.x,n.y,n.width,n.height),this.ctxClone.restore()}continueLine(t,e,i,s){null===this.bezierLine&&(this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,()=>{})),this.ctxClone.save(),this.selectionPath&&this.ctxClone.clip(this.selectionPath);let n=t=>{let e=$2Eggz.BB.mix(this.lastInput2.pressure,s,t.t),i=this.settingOpacity*(this.settingHasOpacityPressure?e*e:1),n=Math.max(.5,this.settingSize*(this.settingHasSizePressure?e:1));this.drawDot(t.x,t.y,n,i)},r=t=>{this.plotCubicBezierLine(t.p1,t.p2,t.p3,t.p4)};if(1===Math.round(2*this.settingSize))this.bresenheimPath=new Path2D,null===t||null===e?this.bezierLine.addFinal(4,void 0,r):this.bezierLine.add(t,e,4,void 0,r),this.settingIsEraser?(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:"#fff",this.settingLockLayerAlpha?this.ctxClone.globalCompositeOperation="source-atop":this.ctxClone.globalCompositeOperation="destination-out"):(this.ctxClone.fillStyle=this.settingUseDither?this.ditherPattern:this.settingColorStr,this.settingLockLayerAlpha&&(this.ctxClone.globalCompositeOperation="source-atop")),this.ctxClone.globalAlpha=this.settingUseDither?1:this.settingOpacity,this.ctxClone.fill(this.bresenheimPath),this.bresenheimPath=void 0;else{let s=i*this.settingSpacing;null===t||null===e?this.bezierLine.addFinal(s,n):this.bezierLine.add(t,e,s,n)}this.ctxClone.restore()}plotLine(t,e,i,s,n){t=Math.floor(t),e=Math.floor(e);let r=Math.abs((i=Math.floor(i))-t),a=t<i?1:-1,o=-Math.abs((s=Math.floor(s))-e),l=e<s?1:-1,h=r+o;for(;;){var c;if(n?n=!1:null==(c=this.bresenheimPath)||c.rect(t,e,1,1),t===i&&e===s)break;let d=2*h;d>=o&&(h+=o,t+=a),d<=r&&(h+=r,e+=l)}}startLine(t,e,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.historyTiles=[],this.redrawBounds=void 0,this.settingUseDither&&this.updateDither(),this.initClone(),i=Math.max(0,Math.min(1,i));let s=this.settingHasOpacityPressure?this.settingOpacity*i*i:this.settingOpacity,n=this.settingHasSizePressure?Math.max(.5,i*this.settingSize):Math.max(.5,this.settingSize);this.inputIsDrawing=!0,this.ctxClone.save(),this.selectionPath&&this.ctxClone.clip(this.selectionPath),this.drawDot(t,e,n,s),this.ctxClone.restore(),this.lineToolLastDot=n*this.settingSpacing,this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.redrawToCanvas()}goLine(t,e,i){if(!this.inputIsDrawing)return;let s=$2Eggz.BB.clamp(i,0,1),n=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(t,e,n,this.lastInput.pressure),this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=s,this.redrawToCanvas()}endLine(){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0;let t=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(null,null,t,this.lastInput.pressure),this.inputIsDrawing=!1,this.bezierLine=null,this.redrawToCanvas(),this.historyTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.canvasClone,this.historyTiles))),this.freeClone()}drawLineSegment(t,e,i,s){this.startLine(t,e,1),this.goLine(i,s,1),this.endLine()}isDrawing(){return this.inputIsDrawing}setColor(t){this.settingColor!==t&&(this.settingColor=t,this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")")}setContext(t){this.context=t}setHistory(t){this.klHistory=t}setSize(t){this.settingSize=Math.round(2*t)/2}setOpacity(t){this.settingOpacity=t}setSpacing(t){this.settingSpacing=t}sizePressure(t){this.settingHasSizePressure=t}opacityPressure(t){this.settingHasOpacityPressure=t}setLockAlpha(t){this.settingLockLayerAlpha=t}setIsEraser(t){this.settingIsEraser=t}setUseDither(t){this.settingUseDither=t}getSpacing(){return this.settingSpacing}getSize(){return this.settingSize}getOpacity(){return this.settingOpacity}getLockAlpha(){return this.settingLockLayerAlpha}getIsEraser(){return this.settingIsEraser}getUseDither(){return this.settingUseDither}constructor(){this.klHistory={},this.context={},this.settingHasSizePressure=!0,this.settingHasOpacityPressure=!1,this.settingSize=.5,this.settingSpacing=.9,this.settingOpacity=1,this.settingColor={},this.settingColorStr="",this.settingLockLayerAlpha=!1,this.settingIsEraser=!1,this.settingUseDither=!0,this.inputIsDrawing=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.bezierLine=null,this.ditherArr=[[3,2],[1,0],[3,0],[1,2],[2,1],[0,3],[0,1],[2,3],[2,0],[0,2],[0,0],[2,2],[1,1],[3,3],[3,1],[1,3]],this.ditherPattern={},this.canvasClone={},this.ctxClone={},this.historyTiles=[],this.ditherCanvas=$2Eggz.BB.canvas(4,4),this.ditherCtx=$2Eggz.BB.ctx(this.ditherCanvas)}}var $2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");class $6debbe598e970932$export$fe52c90afd1cf5ba{updateChangedTiles(t){(0,$8cWis.boundsOverlap)(t,this.selectionBounds)&&(this.changedTiles=$b37280925142c567$export$1774f90c6da5013c(this.changedTiles,$b37280925142c567$export$2098fe43203ddd32(t,this.context.canvas.width,this.context.canvas.height)))}drawDot(t,e,i,s){this.context.save(),this.isBaseLayer?this.isTransparentBG?this.context.globalCompositeOperation="destination-out":this.context.globalCompositeOperation="source-atop":this.context.globalCompositeOperation="destination-out";let n=this.context.createRadialGradient(i,i,0,i,i,i),r=Math.pow(s,2);r=Math.max(0,Math.min((i-1)/i,r));let a=Math.max(0,Math.min(1,s)),o=2*a-a*a;n.addColorStop(r,`rgba(${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, ${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, ${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, `+o+")"),n.addColorStop(1,`rgba(${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, ${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, ${$7a2aeb795d64bafc$export$e4203cb02d5e5b28}, 0)`),this.context.fillStyle=n,this.context.translate(t-i,e-i),this.context.fillRect(0,0,2*i,2*i),this.context.restore(),this.updateChangedTiles({x1:Math.floor(t-i),y1:Math.floor(e-i),x2:Math.ceil(t+i),y2:Math.ceil(e+i)})}continueLine(t,e,i){let s,n;i=Math.max(0,Math.min(1,i));let r=this.useSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size),a=Math.max(1,Math.max(.5,1-this.opacity)*r*this.spacing),o=t=>{let e=t.t;s=this.lastInput2.pressure*(1-e)+i*e,n=this.useOpacityPressure?this.opacity*s*s:this.opacity,r=this.useSizePressure?Math.max(.1,s*this.size):Math.max(.1,this.size),this.drawDot(t.x,t.y,r,n)};this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),void 0===t||void 0===e?this.bezierLine.addFinal(a,o):this.bezierLine.add(t,e,a,o),this.context.restore()}startLine(t,e,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.isBaseLayer=0===this.layer.index,i=Math.max(0,Math.min(1,i));let s=this.useOpacityPressure?this.opacity*i*i:this.opacity,n=this.useSizePressure?Math.max(.1,i*this.size):Math.max(.1,this.size);this.started=!0,n>1&&(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(t,e,n,s),this.context.restore()),this.lastDot=n*this.spacing,this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(t,e,0,()=>void 0)}goLine(t,e,i){this.started&&(this.continueLine(t,e,this.lastInput.pressure),this.lastInput2=$2Eggz.BB.copyObj(this.lastInput),this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i)}endLine(){this.bezierLine&&this.continueLine(void 0,void 0,this.lastInput.pressure),this.started=!1,this.bezierLine=void 0,this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}drawLineSegment(t,e,i,s){let n;if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.isBaseLayer=0===this.layer.index,this.lastInput.x=i,this.lastInput.y=s,this.started||void 0===t)return;let r=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2)),a=(i-t)/r,o=(s-e)/r,l=Math.max(1,Math.max(.5,1-this.opacity)*this.size*this.spacing);for(this.lastDot=0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),n=this.lastDot;n<=r;n+=l)this.drawDot(t+a*n,e+o*n,this.size,this.opacity);this.context.restore(),this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}isDrawing(){return this.started}setLayer(t){this.layer=t,this.context=t.context}setHistory(t){this.klHistory=t}setSize(t){this.size=t}setOpacity(t){this.opacity=t}sizePressure(t){this.useSizePressure=t}opacityPressure(t){this.useOpacityPressure=t}setTransparentBG(t){this.isTransparentBG=t}getSize(){return this.size}getOpacity(){return this.opacity}constructor(){this.size=30,this.spacing=.4,this.opacity=1,this.useSizePressure=!0,this.useOpacityPressure=!1,this.isTransparentBG=!1,this.klHistory={},this.isBaseLayer=!1,this.layer={},this.context={},this.started=!1,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.changedTiles=[]}}var $2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis"),$VM6dD=parcelRequire("VM6dD");let $baef4a032d46c3b8$var$CELL_SIZE=256;function $baef4a032d46c3b8$var$prepSmudge(t,e,i,s,n){if(i.x===s.x&&i.y===s.y)return null;i=$2Eggz.BB.copyObj(i),s=$2Eggz.BB.copyObj(s),n=$2Eggz.BB.copyObj(n);{let r=0,a=0,o=0,l=0;if(i.x<0&&(l=-i.x),i.y<0&&(r=-i.y),s.x<0&&(l=Math.max(l,-s.x)),s.y<0&&(r=Math.max(r,-s.y)),i.x+n.w>t&&(a=i.x+n.w-t),i.y+n.h>e&&(o=i.y+n.h-e),s.x+n.w>t&&(a=Math.max(a,s.x+n.w-t)),s.y+n.h>e&&(o=Math.max(o,s.y+n.h-e)),i.x+=l,s.x+=l,i.y+=r,s.y+=r,n.w=n.w-l-a,n.h=n.h-r-o,n.w<=0||n.h<=0)return null}return{aP:{x:i.x,y:i.y},bP:{x:s.x,y:s.y},size:{w:n.w,h:n.h}}}function $baef4a032d46c3b8$var$smudge(t,e,i){let s=(i=$2Eggz.BB.copyObj(i)).brush.size,n=i.brush.center.x,r=i.brush.center.y,a=i.aP.y*t.width+i.aP.x,o=(i.bP.y*t.width+i.bP.x-a)*4,l=0,h=s>30?1024:512,c=[];for(let t=0;t<h;t++)c[t]=(Math.random()-.5)/1.001+.5;let d=Math.max(3,Math.min(8,i.brush.size-8)),p=(a,o,p,u)=>{let g=$2Eggz.BB.dist(n,r,p,u),m=1-i.brush.opacity*(1-(0,$8cWis.clamp)((g-(s-d))/d,0,1));if(1!==m&&(!e||0!==e[a/4]&&0!==e[o/4])){if(t.data[a+3])if(t.data[o+3]){let e;e=t.data[a+3]<t.data[o+3]?1-t.data[a+3]/t.data[o+3]*(1-m):t.data[o+3]/t.data[a+3]*m,t.data[o]=Math.floor($2Eggz.BB.mix(t.data[a],t.data[o+0],e)+c[l]),t.data[o+1]=Math.floor($2Eggz.BB.mix(t.data[a+1],t.data[o+1],e)+c[l]),t.data[o+2]=Math.floor($2Eggz.BB.mix(t.data[a+2],t.data[o+2],e)+c[l]),l=(l+1)%h}else t.data[o]=t.data[a],t.data[o+1]=t.data[a+1],t.data[o+2]=t.data[a+2];i.brush.alphaLock||(t.data[o+3]=Math.floor($2Eggz.BB.mix(t.data[a+3],t.data[o+3],m)+.5))}},u=4*i.bP.x,g=u+(i.size.w-1)*4;if(i.aP.y<i.bP.y)for(let e=i.size.h-1,s=i.bP.y+i.size.h-1;e>=0;e--,s--){let n=(e+i.bP.y)*t.width*4;for(let t=g+n,e=g+n-o,r=i.bP.x+i.size.w-1;t>=u+n;t-=4,e-=4,r--)p(e,t,r,s)}else if(i.aP.y>i.bP.y)for(let e=0,s=i.bP.y;e<i.size.h;e++,s++){let n=(e+i.bP.y)*t.width*4;for(let t=g+n,e=g+n-o,r=i.bP.x+i.size.w-1;t>=u+n;t-=4,e-=4,r--)p(e,t,r,s)}else if(i.aP.x<i.bP.x)for(let e=i.size.h-1,s=i.bP.y+i.size.h-1;e>=0;e--,s--){let n=(e+i.bP.y)*t.width*4;for(let t=g+n,e=g+n-o,r=i.bP.x+i.size.w-1;t>=u+n;t-=4,e-=4,r--)p(e,t,r,s)}else for(let e=0,s=i.bP.y;e<i.size.h;e++,s++){let n=(e+i.bP.y)*t.width*4;for(let t=u+n,e=u+n-o,r=i.bP.x;t<g+n;t+=4,e+=4,r++)p(e,t,r,s)}}class $baef4a032d46c3b8$export$c9f800961903deab{resetRedrawBounds(){this.redrawBounds=void 0}updateRedrawBounds(t){let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);e&&(this.redrawBounds=$2Eggz.BB.updateBounds(this.redrawBounds,e))}updateCompleteRedrawBounds(t,e,i,s){this.completeRedrawBounds=$2Eggz.BB.updateBounds(this.completeRedrawBounds,{x1:t,y1:e,x2:i,y2:s})}copyFromCanvas(){let t=this.copiedCells.map(()=>!1),e=[],i=Math.ceil(this.copyImageData.width/$baef4a032d46c3b8$var$CELL_SIZE);this.redrawBounds&&(e.push({x1:Math.floor(this.redrawBounds.x1/$baef4a032d46c3b8$var$CELL_SIZE),y1:Math.floor(this.redrawBounds.y1/$baef4a032d46c3b8$var$CELL_SIZE),x2:Math.floor(this.redrawBounds.x2/$baef4a032d46c3b8$var$CELL_SIZE),y2:Math.floor(this.redrawBounds.y2/$baef4a032d46c3b8$var$CELL_SIZE)}),e.forEach(e=>{for(let s=e.x1;s<=e.x2;s++)for(let n=e.y1;n<=e.y2;n++)t[n*i+s]=!0}),t.forEach((t,e)=>{if(!t||this.copiedCells[e])return;this.copiedCells[e]=!0;let s=e%i,n=Math.floor(e/i),r=(Math.min(s*$baef4a032d46c3b8$var$CELL_SIZE+$baef4a032d46c3b8$var$CELL_SIZE,this.copyImageData.width)-1)%$baef4a032d46c3b8$var$CELL_SIZE+1,a=(Math.min(n*$baef4a032d46c3b8$var$CELL_SIZE+$baef4a032d46c3b8$var$CELL_SIZE,this.copyImageData.height)-1)%$baef4a032d46c3b8$var$CELL_SIZE+1,o=$2Eggz.BB.canvas(r,a),l=$2Eggz.BB.ctx(o);l.drawImage(this.context.canvas,-s*$baef4a032d46c3b8$var$CELL_SIZE,-n*$baef4a032d46c3b8$var$CELL_SIZE);let h=l.getImageData(0,0,r,a);for(let t=0;t<a;t++)for(let e=0,i=t*r*4,a=((n*$baef4a032d46c3b8$var$CELL_SIZE+t)*this.copyImageData.width+s*$baef4a032d46c3b8$var$CELL_SIZE)*4;e<r;e++,i+=4,a+=4)this.copyImageData.data[a]=h.data[i],this.copyImageData.data[a+1]=h.data[i+1],this.copyImageData.data[a+2]=h.data[i+2],this.copyImageData.data[a+3]=h.data[i+3]}))}prepDot(t,e,i,s){if(!this.lastDot){this.lastDot={x:t,y:e};return}let n=Math.round(2*(i=Math.round(i))),r=Math.round(2*i),a=$baef4a032d46c3b8$var$prepSmudge(this.copyImageData.width,this.copyImageData.height,{x:Math.round(this.lastDot.x-i),y:Math.round(this.lastDot.y-i)},{x:Math.round(t-i),y:Math.round(e-i)},{w:n,h:r});if(a){let n={aP:a.aP,bP:a.bP,size:a.size,brush:{center:{x:t,y:e},size:i,opacity:s,alphaLock:this.settingLockLayerAlpha}};this.updateRedrawBounds({x1:n.bP.x,y1:n.bP.y,x2:n.bP.x+2*n.brush.size,y2:n.bP.y+2*n.brush.size}),this.drawBuffer.push(n)}this.lastDot={x:t,y:e}}continueLine(t,e,i,s){this.drawBuffer=[],this.bezierLine||(this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,function(){}));let n=[],r=t=>{let e=$2Eggz.BB.mix(this.lastInput2.pressure,s,t.t),i=this.settingOpacity*(this.settingHasOpacityPressure?e*e:1),r=Math.max(.1,this.settingSize*(this.settingHasSizePressure?e:1));n.push([t.x,t.y,r,i])},a=i*this.settingSpacing/3;void 0===t||void 0===e?this.bezierLine.addFinal(a,r):this.bezierLine.add(t,e,a,r);for(let t=0;t<n.length;t++){let e=n[t];this.prepDot(e[0],e[1],e[2],e[3])}this.copyFromCanvas();for(let t=0;t<this.drawBuffer.length;t++)$baef4a032d46c3b8$var$smudge(this.copyImageData,this.mask,this.drawBuffer[t])}startLine(t,e,i){let s=this.klHistory.getComposed().selection.value;this.selectionBounds=s?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(s)):void 0,this.mask=s?$12e0dda7c62dd122$export$820c5732ce56544(s,this.context.canvas.width,this.context.canvas.height):void 0,i=$2Eggz.BB.clamp(i,0,1);let n=this.settingHasOpacityPressure?this.settingOpacity*i*i:this.settingOpacity,r=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize);this.lastDot=void 0,this.isDrawing=!0,this.copyImageData=new ImageData(this.context.canvas.width,this.context.canvas.height);let a=Math.ceil(this.context.canvas.width/$baef4a032d46c3b8$var$CELL_SIZE)*Math.ceil(this.context.canvas.height/$baef4a032d46c3b8$var$CELL_SIZE);this.copiedCells=(0,$VM6dD.createArray)(a,!1),this.prepDot(t,e,r,n),this.lineToolLastDot=r*this.settingSpacing,this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.completeRedrawBounds=void 0}goLine(t,e,i){if(!this.isDrawing)return;this.resetRedrawBounds();let s=$2Eggz.BB.clamp(i,0,1),n=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.continueLine(t,e,n,this.lastInput.pressure),this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1,this.redrawBounds.y2-this.redrawBounds.y1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.lastInput.x=t,this.lastInput.y=e,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=s}endLine(){this.resetRedrawBounds();let t=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.continueLine(void 0,void 0,t,this.lastInput.pressure),this.context.restore(),this.isDrawing=!1,this.bezierLine=void 0,this.redrawBounds&&(this.context.putImageData(this.copyImageData,0,0,this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2-this.redrawBounds.x1,this.redrawBounds.y2-this.redrawBounds.y1),this.updateCompleteRedrawBounds(this.redrawBounds.x1,this.redrawBounds.y1,this.redrawBounds.x2,this.redrawBounds.y2)),this.completeRedrawBounds&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$7b1ba44282f9a519(this.context.canvas,this.completeRedrawBounds))),this.copyImageData={}}drawImage(t,e,i){t instanceof ImageData?this.context.putImageData(t,e,i):(this.context.clearRect(e,i,t.width,t.height),this.context.drawImage(t,e,i))}drawLineSegment(t,e,i,s){}getIsDrawing(){return this.isDrawing}setColor(t){(this.settingColor.r!==t.r||this.settingColor.g!==t.g||this.settingColor.b!==t.b)&&(this.settingColor={r:t.r,g:t.g,b:t.b})}setContext(t){this.context=t}setHistory(t){this.klHistory=t}setSize(t){this.settingSize=t}setOpacity(t){this.settingOpacity=t}setSpacing(t){this.settingSpacing=t}sizePressure(t){this.settingHasSizePressure=t}opacityPressure(t){this.settingHasOpacityPressure=t}setLockAlpha(t){this.settingLockLayerAlpha=t}getSpacing(){return this.settingSpacing}getSize(){return this.settingSize}getOpacity(){return this.settingOpacity}getLockAlpha(){return this.settingLockLayerAlpha}constructor(){this.context={},this.klHistory={},this.settingColor={r:0,g:0,b:0},this.settingSize=35,this.settingSpacing=.20446882736951905,this.settingOpacity=.8,this.settingHasSizePressure=!1,this.settingHasOpacityPressure=!1,this.settingLockLayerAlpha=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.isDrawing=!1,this.copyImageData={},this.drawBuffer=[],this.copiedCells=[]}}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");class $458de7145dc8d2d0$export$38b08aa4ea8f61c6{updateCompleteRedrawBounds(t,e){let i={x1:t,y1:e,x2:t,y2:e};this.settingXSymmetry&&(i=$2Eggz.BB.updateBounds(i,{x1:-t+this.copyCanvas.width,y1:e,x2:-t+this.copyCanvas.width,y2:e})),this.settingYSymmetry&&(i=$2Eggz.BB.updateBounds(i,{x1:t,y1:-e+this.copyCanvas.height,x2:t,y2:-e+this.copyCanvas.height}));let s="stroke"===this.settingMode?this.settingSize+1:1;i.x1=Math.floor(i.x1-s),i.y1=Math.floor(i.y1-s),i.x2=Math.ceil(i.x2+s),i.y2=Math.ceil(i.y2+s),this.completeRedrawBounds=$2Eggz.BB.updateBounds(this.completeRedrawBounds,i)}drawShape(){this.context.save(),this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.context.drawImage(this.copyCanvas,0,0),this.selectionPath&&this.context.clip(this.selectionPath);let t=(0,$wpIFA._)({},this.settingColor);if(this.settingIsEraser?(t.r=$7a2aeb795d64bafc$export$e4203cb02d5e5b28,t.g=$7a2aeb795d64bafc$export$e4203cb02d5e5b28,t.b=$7a2aeb795d64bafc$export$e4203cb02d5e5b28,this.settingLockLayerAlpha?this.context.globalCompositeOperation="source-atop":this.context.globalCompositeOperation="destination-out"):this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),this.path.length>1){let e=new Path2D;this.path.forEach((t,i)=>{0===i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)});let i=$2Eggz.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:this.settingOpacity});if(this.settingGradient){let e=this.path[0].x>this.path[this.path.length-1].x,s=this.context.createLinearGradient(0,e?this.minY:this.maxY,0,e?this.maxY:this.minY);s.addColorStop(0,$2Eggz.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:this.settingOpacity})),s.addColorStop(1,$2Eggz.BB.ColorConverter.toRgbaStr({r:t.r,g:t.g,b:t.b,a:0})),i=s}"fill"===this.settingMode?this.context.fillStyle=i:(this.context.lineWidth=2*this.settingSize,this.context.lineJoin="bevel",this.context.strokeStyle=i);let s=()=>{"fill"===this.settingMode?this.context.fill(e):this.context.stroke(e)};s(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,0),this.context.scale(-1,1),this.context.translate(-this.context.canvas.width/2,0),s(),this.context.restore()),this.settingYSymmetry&&(this.context.save(),this.context.translate(0,this.context.canvas.height/2),this.context.scale(1,-1),this.context.translate(0,-this.context.canvas.height/2),s(),this.context.restore(),this.settingXSymmetry&&(this.context.save(),this.context.translate(this.context.canvas.width/2,this.context.canvas.height/2),this.context.scale(-1,-1),this.context.translate(-this.context.canvas.width/2,-this.context.canvas.height/2),s(),this.context.restore()))}this.context.restore()}setHistory(t){this.klHistory=t}getSize(){return"stroke"===this.settingMode?this.settingSize:0}setSize(t){this.settingSize=t}getOpacity(){return this.settingOpacity}setOpacity(t){this.settingOpacity=t}setColor(t){this.settingColor=$2Eggz.BB.copyObj(t)}setContext(t){this.context=t}setMode(t){this.settingMode=t}getMode(){return this.settingMode}setDistort(t){this.settingDistort=$2Eggz.BB.clamp(t,0,1)}getDistort(){return this.settingDistort}setXSymmetry(t){this.settingXSymmetry=t}getXSymmetry(){return this.settingXSymmetry}setYSymmetry(t){this.settingYSymmetry=t}getYSymmetry(){return this.settingYSymmetry}setGradient(t){this.settingGradient=t}getGradient(){return this.settingGradient}getLockAlpha(){return this.settingLockLayerAlpha}setLockAlpha(t){this.settingLockLayerAlpha=t}getIsEraser(){return this.settingIsEraser}setIsEraser(t){this.settingIsEraser=t}getIsDrawing(){return this.isDrawing}startLine(t,e){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.isDrawing=!0,this.path=[{x:t,y:e}],this.minY=e,this.maxY=e,this.copyCanvas=$2Eggz.BB.canvas(this.context.canvas.width,this.context.canvas.height),$2Eggz.BB.ctx(this.copyCanvas).drawImage(this.context.canvas,0,0),this.completeRedrawBounds=void 0,this.updateCompleteRedrawBounds(t,e)}goLine(t,e){if(!this.isDrawing)return;let i={x:t,y:e};this.settingDistort>0&&(i.x+=(Math.random()-.5)*this.settingDistort*80,i.y+=(Math.random()-.5)*this.settingDistort*80),this.minY=Math.min(this.minY,i.y),this.maxY=Math.max(this.maxY,i.y),this.path.push(i),this.updateCompleteRedrawBounds(t,e),this.drawShape()}endLine(){if(this.isDrawing=!1,this.completeRedrawBounds=$2Eggz.BB.boundsInArea(this.completeRedrawBounds,this.copyCanvas.width,this.copyCanvas.height),this.selectionBounds&&(this.completeRedrawBounds=(0,$8cWis.boundsOverlap)(this.completeRedrawBounds,this.selectionBounds)),this.path.length>1&&this.completeRedrawBounds){let t=$a262f7e0a9f5e4af$export$7b1ba44282f9a519(this.context.canvas,this.completeRedrawBounds);this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),t))}this.path=[],this.copyCanvas={}}drawLineSegment(t,e,i,s){}constructor(){this.context={},this.settingColor={},this.settingSize=.25,this.settingOpacity=1,this.settingLockLayerAlpha=!1,this.settingIsEraser=!1,this.settingMode="fill",this.settingDistort=0,this.settingXSymmetry=!1,this.settingYSymmetry=!1,this.settingGradient=!1,this.isDrawing=!1,this.klHistory={},this.copyCanvas={},this.path=[],this.minY=0,this.maxY=0}}var $2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");let $c9c3248b3c6a9599$export$4a278486528d5cfb="generated",$c9c3248b3c6a9599$export$9ffd73c9a0e32c34="pointerdown",$c9c3248b3c6a9599$export$9fb0268ce1bdbca0="pointerup",$c9c3248b3c6a9599$export$f4b184a85a586f8a="pointerleave",$c9c3248b3c6a9599$export$55cc1d6a692feb2b="pointerout",$c9c3248b3c6a9599$export$1ffe551d7d33cd33="pointermove",$c9c3248b3c6a9599$export$d5353b6c79bbcc70="touchstart",$c9c3248b3c6a9599$export$11164630b85c192d="touchend",$c9c3248b3c6a9599$export$d28a82874c0e6212="touchmove",$c9c3248b3c6a9599$export$65db1c69591947a7="touchcancel",$c9c3248b3c6a9599$export$8b3d73c91cd7cc65="resize",$c9c3248b3c6a9599$export$73536144dc68dd0f="visibilitychange",$c9c3248b3c6a9599$export$adea4917e02d93dc="tsParticles - Error",$c9c3248b3c6a9599$export$9519bca7a9fbeccd=100,$c9c3248b3c6a9599$export$3ced024fb15e6103=.5,$c9c3248b3c6a9599$export$f64c3bfbc58eec0f=1e3,$c9c3248b3c6a9599$export$8a573f14667e8170={x:0,y:0,z:0},$c9c3248b3c6a9599$export$d8a7bebef127c134={a:1,b:0,c:0,d:1},$c9c3248b3c6a9599$export$2f8238aef5a0a8eb="random",$c9c3248b3c6a9599$export$7b3cbda67be88f5f=2,$c9c3248b3c6a9599$export$99aad4f300723eb5=Math.PI*$c9c3248b3c6a9599$export$7b3cbda67be88f5f,$c9c3248b3c6a9599$export$a58a85a1d96b5da5=60,$c9c3248b3c6a9599$export$f4379e05d59339d2="true",$c9c3248b3c6a9599$export$c392cf7a2bd47e88="false",$c9c3248b3c6a9599$export$af8f840c6caca708="canvas",$c9c3248b3c6a9599$export$b0d937bb246b1db5=0,$c9c3248b3c6a9599$export$69af1894d00750e2=2,$c9c3248b3c6a9599$export$ff9931f04b025271=4,$c9c3248b3c6a9599$export$1f93977e73a42602=1,$c9c3248b3c6a9599$export$728175ae61348876=1,$c9c3248b3c6a9599$export$7e2d520c66b9f331=1,$c9c3248b3c6a9599$export$857680dbc0592f23=4,$c9c3248b3c6a9599$export$6a43a0894b8f8dd4=1,$c9c3248b3c6a9599$export$7bf8bd2b1c3673be=255,$c9c3248b3c6a9599$export$80d6dd9687da66fc=360,$c9c3248b3c6a9599$export$d6110320394e154a=100,$c9c3248b3c6a9599$export$9f8a886f88503d81=100,$c9c3248b3c6a9599$export$59af4a43228d42f9=0,$c9c3248b3c6a9599$export$6d036dc8238eb540=0,$c9c3248b3c6a9599$export$4639db465b79e483=60,$c9c3248b3c6a9599$export$6e22c362a0406a2c=0,$c9c3248b3c6a9599$export$813f5834b9d5379d=.25,$c9c3248b3c6a9599$export$9f9801c27507097c=$c9c3248b3c6a9599$export$3ced024fb15e6103+$c9c3248b3c6a9599$export$813f5834b9d5379d,$c9c3248b3c6a9599$export$1f10c01143b9f089=1,$c9c3248b3c6a9599$export$4b0ea52aa81e1ca2=0,$c9c3248b3c6a9599$export$920ec94752436dad=0,$c9c3248b3c6a9599$export$6ca59ab71c007a1b=1,$c9c3248b3c6a9599$export$7395e4cb572e863b=1,$c9c3248b3c6a9599$export$ed597c6eb324bc8f=1,$c9c3248b3c6a9599$export$7a917036bd0c18e0=1,$c9c3248b3c6a9599$export$17c6bab6aae4c3d=0,$c9c3248b3c6a9599$export$310c6557edf6330f=1,$c9c3248b3c6a9599$export$6347387141f4c7b9=0,$c9c3248b3c6a9599$export$a1db07711c3c21cf=120,$c9c3248b3c6a9599$export$1f9ec247b9f4a442=0,$c9c3248b3c6a9599$export$878d5c9fc03f6a6f=0,$c9c3248b3c6a9599$export$d20f7c11146fd35=1e4,$c9c3248b3c6a9599$export$a0a8145c86a935c7=0,$c9c3248b3c6a9599$export$80bf7733f1207381=1,$c9c3248b3c6a9599$export$f883a24d5edde77c=0,$c9c3248b3c6a9599$export$a05b467d53228ab9=1,$c9c3248b3c6a9599$export$c6a00718c1294b26=1,$c9c3248b3c6a9599$export$9ad4c81d91619fd0=0,$c9c3248b3c6a9599$export$40d4bf4da5fab6a3=1,$c9c3248b3c6a9599$export$ce94e349d95a214c=0,$c9c3248b3c6a9599$export$7dab3a147ef97e31=0,$c9c3248b3c6a9599$export$3824525d016aa873=-$c9c3248b3c6a9599$export$813f5834b9d5379d,$c9c3248b3c6a9599$export$59892a8b616aa484=1.5,$c9c3248b3c6a9599$export$e82fde291e144b99=0,$c9c3248b3c6a9599$export$1fe1264f46963094=1,$c9c3248b3c6a9599$export$da4e5697b3441fa1=0,$c9c3248b3c6a9599$export$e410eba367ce792b=0,$c9c3248b3c6a9599$export$4a5b9680be542cf8=1,$c9c3248b3c6a9599$export$9b262e3383f198e7=1,$c9c3248b3c6a9599$export$346cdd8493ece6c8=1,$c9c3248b3c6a9599$export$a31a053ae1bfc10e=500,$c9c3248b3c6a9599$export$d4e77d4b7e9933c7=50,$c9c3248b3c6a9599$export$573f1d3d887db8cc=0,$c9c3248b3c6a9599$export$f0954fd7d5368655=1,$c9c3248b3c6a9599$export$1f010363d1c40031=0,$c9c3248b3c6a9599$export$6438bad23c977d39=1,$c9c3248b3c6a9599$export$d13fc714138cfb02=0;function $80a7397a4771a67f$export$71511d61b312f219(t,e){if(null==t)return{};var i,s,n={},r=Object.keys(t);for(s=0;s<r.length;s++)i=r[s],e.indexOf(i)>=0||(n[i]=t[i]);return n}function $1e62c2216e99d845$export$71511d61b312f219(t,e){if(null==t)return{};var i,s,n=$80a7397a4771a67f$export$71511d61b312f219(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function $a968daecb9ed97f0$export$f9ce7b637dfbe238(t){return"boolean"==typeof t}function $a968daecb9ed97f0$export$844ec244b1367d54(t){return"string"==typeof t}function $a968daecb9ed97f0$export$7e4aa119212bc614(t){return"number"==typeof t}function $a968daecb9ed97f0$export$a6cdc56e425d0d0a(t){return"object"==typeof t&&null!==t}function $a968daecb9ed97f0$export$43bee75e5e14138e(t){return Array.isArray(t)}function $a968daecb9ed97f0$export$630801d484da15df(t){return null==t}!function(t){t.bottom="bottom",t.bottomLeft="bottom-left",t.bottomRight="bottom-right",t.left="left",t.none="none",t.right="right",t.top="top",t.topLeft="top-left",t.topRight="top-right",t.outside="outside",t.inside="inside"}($219efb580e609ac5$export$cc1a246adca07dd4||($219efb580e609ac5$export$cc1a246adca07dd4={}));class $dba6a6bdb7cfdc8a$export$ece015703618ce3d{static get origin(){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create($c9c3248b3c6a9599$export$8a573f14667e8170.x,$c9c3248b3c6a9599$export$8a573f14667e8170.y,$c9c3248b3c6a9599$export$8a573f14667e8170.z)}get angle(){return Math.atan2(this.y,this.x)}set angle(t){this._updateFromAngle(t,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(t){this._updateFromAngle(this.angle,t)}static clone(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(t.x,t.y,t.z)}static create(t,e,i){return new $dba6a6bdb7cfdc8a$export$ece015703618ce3d(t,e,i)}add(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(this.x+t.x,this.y+t.y,this.z+t.z)}addTo(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}copy(){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.clone(this)}distanceTo(t){return this.sub(t).length}distanceToSq(t){return this.sub(t).getLengthSq()}div(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(this.x/t,this.y/t,this.z/t)}divTo(t){this.x/=t,this.y/=t,this.z/=t}getLengthSq(){return this.x**$c9c3248b3c6a9599$export$69af1894d00750e2+this.y**$c9c3248b3c6a9599$export$69af1894d00750e2}mult(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(this.x*t,this.y*t,this.z*t)}multTo(t){this.x*=t,this.y*=t,this.z*=t}normalize(){let t=this.length;t!=$c9c3248b3c6a9599$export$f883a24d5edde77c&&this.multTo($c9c3248b3c6a9599$export$6a43a0894b8f8dd4/t)}rotate(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t),$c9c3248b3c6a9599$export$8a573f14667e8170.z)}setTo(t){this.x=t.x,this.y=t.y;let e=t;this.z=e.z?e.z:$c9c3248b3c6a9599$export$8a573f14667e8170.z}sub(t){return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(this.x-t.x,this.y-t.y,this.z-t.z)}subFrom(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}constructor(t,e,i){if(this._updateFromAngle=(t,e)=>{this.x=Math.cos(t)*e,this.y=Math.sin(t)*e},!$a968daecb9ed97f0$export$7e4aa119212bc614(t)&&t){this.x=t.x,this.y=t.y;let e=t;this.z=e.z?e.z:$c9c3248b3c6a9599$export$8a573f14667e8170.z}else if(void 0!==t&&void 0!==e)this.x=t,this.y=e,this.z=null!=i?i:$c9c3248b3c6a9599$export$8a573f14667e8170.z;else throw Error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} Vector3d not initialized correctly`)}}class $dba6a6bdb7cfdc8a$export$9b781de7bf37bf48 extends $dba6a6bdb7cfdc8a$export$ece015703618ce3d{static get origin(){return $dba6a6bdb7cfdc8a$export$9b781de7bf37bf48.create($c9c3248b3c6a9599$export$8a573f14667e8170.x,$c9c3248b3c6a9599$export$8a573f14667e8170.y)}static clone(t){return $dba6a6bdb7cfdc8a$export$9b781de7bf37bf48.create(t.x,t.y)}static create(t,e){return new $dba6a6bdb7cfdc8a$export$9b781de7bf37bf48(t,e)}constructor(t,e){super(t,e,$c9c3248b3c6a9599$export$8a573f14667e8170.z)}}let $b56e0d3a102cc459$var$_random=Math.random,$b56e0d3a102cc459$var$_animationLoop={nextFrame:t=>requestAnimationFrame(t),cancel:t=>cancelAnimationFrame(t)};function $b56e0d3a102cc459$export$1a76347094524b3b(){let t=0,e=1;return $b56e0d3a102cc459$export$7d15b64cf5a3a4c4($b56e0d3a102cc459$var$_random(),t,e-Number.EPSILON)}function $b56e0d3a102cc459$export$e3607ec2d7a891c4(t){return $b56e0d3a102cc459$var$_animationLoop.nextFrame(t)}function $b56e0d3a102cc459$export$623ab1da75e685de(t){$b56e0d3a102cc459$var$_animationLoop.cancel(t)}function $b56e0d3a102cc459$export$7d15b64cf5a3a4c4(t,e,i){return Math.min(Math.max(t,e),i)}function $b56e0d3a102cc459$export$8b958c8ecd94a804(t){let e=$b56e0d3a102cc459$export$27d2c76f835d583d(t),i=0,s=$b56e0d3a102cc459$export$71c94d28c0fa4bfe(t);return e===s&&(s=i),$b56e0d3a102cc459$export$1a76347094524b3b()*(e-s)+s}function $b56e0d3a102cc459$export$e70c64b68236cb4e(t){return $a968daecb9ed97f0$export$7e4aa119212bc614(t)?t:$b56e0d3a102cc459$export$8b958c8ecd94a804(t)}function $b56e0d3a102cc459$export$71c94d28c0fa4bfe(t){return $a968daecb9ed97f0$export$7e4aa119212bc614(t)?t:t.min}function $b56e0d3a102cc459$export$27d2c76f835d583d(t){return $a968daecb9ed97f0$export$7e4aa119212bc614(t)?t:t.max}function $b56e0d3a102cc459$export$6dcd5a07b989db7(t,e){if(t===e||void 0===e&&$a968daecb9ed97f0$export$7e4aa119212bc614(t))return t;let i=$b56e0d3a102cc459$export$71c94d28c0fa4bfe(t),s=$b56e0d3a102cc459$export$27d2c76f835d583d(t);return void 0!==e?{min:Math.min(i,e),max:Math.max(s,e)}:$b56e0d3a102cc459$export$6dcd5a07b989db7(i,s)}function $b56e0d3a102cc459$export$c76b58cfe053f228(t,e){let i=t.x-e.x,s=t.y-e.y,n=2;return{dx:i,dy:s,distance:Math.sqrt(i**n+s**n)}}function $b56e0d3a102cc459$export$79376507b09a66f(t,e){return $b56e0d3a102cc459$export$c76b58cfe053f228(t,e).distance}function $b56e0d3a102cc459$export$e6bfdeff8bfc94f9(t){return t*Math.PI/180}function $b56e0d3a102cc459$export$2045f76df51d18c4(t,e,i){if($a968daecb9ed97f0$export$7e4aa119212bc614(t))return $b56e0d3a102cc459$export$e6bfdeff8bfc94f9(t);switch(t){case $219efb580e609ac5$export$cc1a246adca07dd4.top:return-Math.PI*$c9c3248b3c6a9599$export$3ced024fb15e6103;case $219efb580e609ac5$export$cc1a246adca07dd4.topRight:return-Math.PI*$c9c3248b3c6a9599$export$813f5834b9d5379d;case $219efb580e609ac5$export$cc1a246adca07dd4.right:return $c9c3248b3c6a9599$export$6e22c362a0406a2c;case $219efb580e609ac5$export$cc1a246adca07dd4.bottomRight:return Math.PI*$c9c3248b3c6a9599$export$813f5834b9d5379d;case $219efb580e609ac5$export$cc1a246adca07dd4.bottom:return Math.PI*$c9c3248b3c6a9599$export$3ced024fb15e6103;case $219efb580e609ac5$export$cc1a246adca07dd4.bottomLeft:return Math.PI*$c9c3248b3c6a9599$export$9f9801c27507097c;case $219efb580e609ac5$export$cc1a246adca07dd4.left:return Math.PI;case $219efb580e609ac5$export$cc1a246adca07dd4.topLeft:return-Math.PI*$c9c3248b3c6a9599$export$9f9801c27507097c;case $219efb580e609ac5$export$cc1a246adca07dd4.inside:return Math.atan2(i.y-e.y,i.x-e.x);case $219efb580e609ac5$export$cc1a246adca07dd4.outside:return Math.atan2(e.y-i.y,e.x-i.x);default:return $b56e0d3a102cc459$export$1a76347094524b3b()*$c9c3248b3c6a9599$export$99aad4f300723eb5}}function $b56e0d3a102cc459$export$cce6f12debc4024a(t){let e=$dba6a6bdb7cfdc8a$export$9b781de7bf37bf48.origin;return e.length=1,e.angle=t,e}function $b56e0d3a102cc459$export$a3c87c98a736c457(t){var e,i,s,n;return{x:null!=(s=null==(e=t.position)?void 0:e.x)?s:$b56e0d3a102cc459$export$1a76347094524b3b()*t.size.width,y:null!=(n=null==(i=t.position)?void 0:i.y)?n:$b56e0d3a102cc459$export$1a76347094524b3b()*t.size.height}}!function(t){t.auto="auto",t.increase="increase",t.decrease="decrease",t.random="random"}($1f6c98f1bc1611d6$export$6bf57c7f0219f07d||($1f6c98f1bc1611d6$export$6bf57c7f0219f07d={})),function(t){t.increasing="increasing",t.decreasing="decreasing"}($c9ea12bc676afcc7$export$a2d3d93c57d16a1a||($c9ea12bc676afcc7$export$a2d3d93c57d16a1a={})),function(t){t.none="none",t.max="max",t.min="min"}($25b07e12db1a9da9$export$41a461248611663e||($25b07e12db1a9da9$export$41a461248611663e={})),function(t){t.bottom="bottom",t.left="left",t.right="right",t.top="top"}($70f4c2ccd9f1fc4e$export$56c1e4693edf08f9||($70f4c2ccd9f1fc4e$export$56c1e4693edf08f9={})),function(t){t.precise="precise",t.percent="percent"}($646f0f1b6fd77518$export$1009f0178778a981||($646f0f1b6fd77518$export$1009f0178778a981={})),function(t){t.max="max",t.min="min",t.random="random"}($7a43ac3a337343a6$export$5385b9a82993d2c8||($7a43ac3a337343a6$export$5385b9a82993d2c8={}));let $b45a95be606465d1$var$_logger={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function $b45a95be606465d1$export$2b1d391cd05230fd(){return $b45a95be606465d1$var$_logger}function $b45a95be606465d1$var$memoize(t){let e=new Map;return(...i)=>{let s=JSON.stringify(i);if(e.has(s))return e.get(s);let n=t(...i);return e.set(s,n),n}}function $b45a95be606465d1$export$460b6777813d3d86(){return"undefined"==typeof window||!window||void 0===window.document||!window.document}function $b45a95be606465d1$export$c242851ed0beda6c(){return!$b45a95be606465d1$export$460b6777813d3d86()&&"undefined"!=typeof matchMedia}function $b45a95be606465d1$export$db32b9574e21e00f(t){if($b45a95be606465d1$export$c242851ed0beda6c())return matchMedia(t)}function $b45a95be606465d1$export$d97d2a93dce76cc2(t){if(!$b45a95be606465d1$export$460b6777813d3d86()&&"undefined"!=typeof IntersectionObserver)return new IntersectionObserver(t)}function $b45a95be606465d1$export$c2f9084a48da0641(t){if(!$b45a95be606465d1$export$460b6777813d3d86()&&"undefined"!=typeof MutationObserver)return new MutationObserver(t)}function $b45a95be606465d1$export$5e9bb4359042e24b(t,e){let i=-1;return t===e||$a968daecb9ed97f0$export$43bee75e5e14138e(e)&&e.indexOf(t)>i}function $b45a95be606465d1$export$aab6d48e027939d7(t){return Math.floor($b56e0d3a102cc459$export$1a76347094524b3b()*t.length)}function $b45a95be606465d1$export$3a5d12ca7137122f(t,e,i=!0){return t[void 0!==e&&i?e%t.length:$b45a95be606465d1$export$aab6d48e027939d7(t)]}function $b45a95be606465d1$export$54e9fb29908872fa(t,...e){for(let i of e){if(null==i)continue;if(!$a968daecb9ed97f0$export$a6cdc56e425d0d0a(i)){t=i;continue}let e=Array.isArray(i);for(let s in e&&($a968daecb9ed97f0$export$a6cdc56e425d0d0a(t)||!t||!Array.isArray(t))?t=[]:!e&&($a968daecb9ed97f0$export$a6cdc56e425d0d0a(t)||!t||Array.isArray(t))&&(t={}),i){if("__proto__"===s)continue;let e=i[s],n=t;n[s]=$a968daecb9ed97f0$export$a6cdc56e425d0d0a(e)&&Array.isArray(e)?e.map(t=>$b45a95be606465d1$export$54e9fb29908872fa(n[s],t)):$b45a95be606465d1$export$54e9fb29908872fa(n[s],e)}}return t}function $b45a95be606465d1$export$8e5dc47097396754(t,e){let i=0;return $a968daecb9ed97f0$export$43bee75e5e14138e(t)?t.map((t,i)=>e(t,i)):e(t,i)}function $b45a95be606465d1$export$3fbf39566d3ee62e(t,e,i){return $a968daecb9ed97f0$export$43bee75e5e14138e(t)?$b45a95be606465d1$export$3a5d12ca7137122f(t,e,i):t}function $b45a95be606465d1$export$bebd78259cce4fd(t,e){let i=t.value,s=t.animation,n={delayTime:$b56e0d3a102cc459$export$e70c64b68236cb4e(s.delay)*$c9c3248b3c6a9599$export$f64c3bfbc58eec0f,enable:s.enable,value:$b56e0d3a102cc459$export$e70c64b68236cb4e(t.value)*e,max:$b56e0d3a102cc459$export$27d2c76f835d583d(i)*e,min:$b56e0d3a102cc459$export$71c94d28c0fa4bfe(i)*e,loops:0,maxLoops:$b56e0d3a102cc459$export$e70c64b68236cb4e(s.count),time:0},r=1;if(s.enable){switch(n.decay=r-$b56e0d3a102cc459$export$e70c64b68236cb4e(s.decay),s.mode){case $1f6c98f1bc1611d6$export$6bf57c7f0219f07d.increase:n.status=$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.increasing;break;case $1f6c98f1bc1611d6$export$6bf57c7f0219f07d.decrease:n.status=$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.decreasing;break;case $1f6c98f1bc1611d6$export$6bf57c7f0219f07d.random:n.status=$b56e0d3a102cc459$export$1a76347094524b3b()>=$c9c3248b3c6a9599$export$3ced024fb15e6103?$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.increasing:$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.decreasing}let t=s.mode===$1f6c98f1bc1611d6$export$6bf57c7f0219f07d.auto;switch(s.startValue){case $7a43ac3a337343a6$export$5385b9a82993d2c8.min:n.value=n.min,t&&(n.status=$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.increasing);break;case $7a43ac3a337343a6$export$5385b9a82993d2c8.max:n.value=n.max,t&&(n.status=$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.decreasing);break;case $7a43ac3a337343a6$export$5385b9a82993d2c8.random:default:n.value=$b56e0d3a102cc459$export$8b958c8ecd94a804(n),t&&(n.status=$b56e0d3a102cc459$export$1a76347094524b3b()>=$c9c3248b3c6a9599$export$3ced024fb15e6103?$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.increasing:$c9ea12bc676afcc7$export$a2d3d93c57d16a1a.decreasing)}}return n.initialValue=n.value,n}function $b45a95be606465d1$var$getPositionOrSize(t,e){if(t.mode!==$646f0f1b6fd77518$export$1009f0178778a981.percent){let{mode:e}=t;return $1e62c2216e99d845$export$71511d61b312f219(t,["mode"])}return"x"in t?{x:t.x/$c9c3248b3c6a9599$export$9519bca7a9fbeccd*e.width,y:t.y/$c9c3248b3c6a9599$export$9519bca7a9fbeccd*e.height}:{width:t.width/$c9c3248b3c6a9599$export$9519bca7a9fbeccd*e.width,height:t.height/$c9c3248b3c6a9599$export$9519bca7a9fbeccd*e.height}}function $b45a95be606465d1$export$1690e12b840569b9(t,e){return $b45a95be606465d1$var$getPositionOrSize(t,e)}function $b45a95be606465d1$export$667e8f3bfe6278b7(t){let e=document.createElement("div").style;if(!t)return e;for(let a in t){var i,s,n,r;let o=t[a];if(!Object.prototype.hasOwnProperty.call(t,a)||$a968daecb9ed97f0$export$630801d484da15df(o))continue;let l=null==(i=t.getPropertyValue)?void 0:i.call(t,o);if(!l)continue;let h=null==(s=t.getPropertyPriority)?void 0:s.call(t,o);h?null==(r=e.setProperty)||r.call(e,o,l,h):null==(n=e.setProperty)||n.call(e,o,l)}return e}function $b45a95be606465d1$var$computeFullScreenStyle(t){let e=document.createElement("div").style,i=10,s={width:"100%",height:"100%",margin:"0",padding:"0",borderWidth:"0",position:"fixed",zIndex:t.toString(i),"z-index":t.toString(i),top:"0",left:"0"};for(let t in s){let i=s[t];e.setProperty(t,i)}return e}let $b45a95be606465d1$export$10d1829d88c10e6a=$b45a95be606465d1$var$memoize($b45a95be606465d1$var$computeFullScreenStyle);var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$wpIFA=parcelRequire("wpIFA");function $18414f5f1f9fa88c$var$stringToRgba(t,e){if(e){for(let i of t.colorManagers.values())if(e.startsWith(i.stringPrefix))return i.parseString(e)}}function $18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(t,e,i,s=!0){if(!e)return;let n=$a968daecb9ed97f0$export$844ec244b1367d54(e)?{value:e}:e;if($a968daecb9ed97f0$export$844ec244b1367d54(n.value))return $18414f5f1f9fa88c$export$170d64abcc52d97a(t,n.value,i,s);if($a968daecb9ed97f0$export$43bee75e5e14138e(n.value))return $18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(t,{value:$b45a95be606465d1$export$3a5d12ca7137122f(n.value,i,s)});for(let e of t.colorManagers.values()){let t=e.handleRangeColor(n);if(t)return t}}function $18414f5f1f9fa88c$export$170d64abcc52d97a(t,e,i,s=!0){if(!e)return;let n=$a968daecb9ed97f0$export$844ec244b1367d54(e)?{value:e}:e;if($a968daecb9ed97f0$export$844ec244b1367d54(n.value))return n.value===$c9c3248b3c6a9599$export$2f8238aef5a0a8eb?$18414f5f1f9fa88c$export$ac4fc8e9144a1018():$18414f5f1f9fa88c$export$d2c5ec93815c4391(t,n.value);if($a968daecb9ed97f0$export$43bee75e5e14138e(n.value))return $18414f5f1f9fa88c$export$170d64abcc52d97a(t,{value:$b45a95be606465d1$export$3a5d12ca7137122f(n.value,i,s)});for(let e of t.colorManagers.values()){let t=e.handleColor(n);if(t)return t}}function $18414f5f1f9fa88c$export$79a89086521c0f12(t,e,i,s=!0){let n=$18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(t,e,i,s);return n?$18414f5f1f9fa88c$export$c85ca4f4753af384(n):void 0}function $18414f5f1f9fa88c$export$c85ca4f4753af384(t){let e=t.r/$c9c3248b3c6a9599$export$7bf8bd2b1c3673be,i=t.g/$c9c3248b3c6a9599$export$7bf8bd2b1c3673be,s=t.b/$c9c3248b3c6a9599$export$7bf8bd2b1c3673be,n=Math.max(e,i,s),r=Math.min(e,i,s),a={h:$c9c3248b3c6a9599$export$59af4a43228d42f9,l:(n+r)*$c9c3248b3c6a9599$export$3ced024fb15e6103,s:$c9c3248b3c6a9599$export$6d036dc8238eb540};return n!==r&&(a.s=a.l<$c9c3248b3c6a9599$export$3ced024fb15e6103?(n-r)/(n+r):(n-r)/($c9c3248b3c6a9599$export$7b3cbda67be88f5f-n-r),a.h=e===n?(i-s)/(n-r):a.h=i===n?$c9c3248b3c6a9599$export$7b3cbda67be88f5f+(s-e)/(n-r):$c9c3248b3c6a9599$export$7b3cbda67be88f5f*$c9c3248b3c6a9599$export$7b3cbda67be88f5f+(e-i)/(n-r)),a.l*=$c9c3248b3c6a9599$export$9f8a886f88503d81,a.s*=$c9c3248b3c6a9599$export$d6110320394e154a,a.h*=$c9c3248b3c6a9599$export$4639db465b79e483,a.h<$c9c3248b3c6a9599$export$59af4a43228d42f9&&(a.h+=$c9c3248b3c6a9599$export$80d6dd9687da66fc),a.h>=$c9c3248b3c6a9599$export$80d6dd9687da66fc&&(a.h-=$c9c3248b3c6a9599$export$80d6dd9687da66fc),a}function $18414f5f1f9fa88c$export$d2c5ec93815c4391(t,e){return $18414f5f1f9fa88c$var$stringToRgba(t,e)}function $18414f5f1f9fa88c$export$ac4fc8e9144a1018(t){let e=null!=t?t:$c9c3248b3c6a9599$export$d13fc714138cfb02,i=$c9c3248b3c6a9599$export$7bf8bd2b1c3673be+$c9c3248b3c6a9599$export$f0954fd7d5368655;return{b:Math.floor($b56e0d3a102cc459$export$8b958c8ecd94a804($b56e0d3a102cc459$export$6dcd5a07b989db7(e,i))),g:Math.floor($b56e0d3a102cc459$export$8b958c8ecd94a804($b56e0d3a102cc459$export$6dcd5a07b989db7(e,i))),r:Math.floor($b56e0d3a102cc459$export$8b958c8ecd94a804($b56e0d3a102cc459$export$6dcd5a07b989db7(e,i)))}}function $18414f5f1f9fa88c$export$2476af37e47fcae2(t,e){return`rgba(${t.r}, ${t.g}, ${t.b}, ${null!=e?e:$c9c3248b3c6a9599$export$7395e4cb572e863b})`}function $18414f5f1f9fa88c$export$9d057e59c7b0a82d(t,e){return`hsla(${t.h}, ${t.s}%, ${t.l}%, ${null!=e?e:$c9c3248b3c6a9599$export$7395e4cb572e863b})`}function $18414f5f1f9fa88c$export$c90768c73bc1d7ab(t){return void 0!==t?{h:t.h.value,s:t.s.value,l:t.l.value}:void 0}function $9351e8aae3844c9d$export$2837cdf5427f767e(t,e,i){t.fillStyle=null!=i?i:"rgba(0,0,0,0)",t.fillRect($c9c3248b3c6a9599$export$8a573f14667e8170.x,$c9c3248b3c6a9599$export$8a573f14667e8170.y,e.width,e.height)}function $9351e8aae3844c9d$export$a17334b9431a8cb2(t,e,i,s){i&&(t.globalAlpha=s,t.drawImage(i,$c9c3248b3c6a9599$export$8a573f14667e8170.x,$c9c3248b3c6a9599$export$8a573f14667e8170.y,e.width,e.height),t.globalAlpha=1)}function $9351e8aae3844c9d$export$42ffd38884aecdac(t,e){t.clearRect($c9c3248b3c6a9599$export$8a573f14667e8170.x,$c9c3248b3c6a9599$export$8a573f14667e8170.y,e.width,e.height)}function $9351e8aae3844c9d$export$fca8f175741ef351(t){var e,i,s,n,r,a,o;let{container:l,context:h,particle:c,delta:d,colorStyles:p,backgroundMask:u,composite:g,radius:m,opacity:f,shadow:y,transform:v}=t,x=c.getPosition(),b=c.rotation+(c.pathRotation?c.velocity.angle:$c9c3248b3c6a9599$export$573f1d3d887db8cc),w={sin:Math.sin(b),cos:Math.cos(b)},B=!!b,S={a:w.cos*(null!=(e=v.a)?e:$c9c3248b3c6a9599$export$d8a7bebef127c134.a),b:B?w.sin*(null!=(i=v.b)?i:$c9c3248b3c6a9599$export$f0954fd7d5368655):null!=(s=v.b)?s:$c9c3248b3c6a9599$export$d8a7bebef127c134.b,c:B?-w.sin*(null!=(n=v.c)?n:$c9c3248b3c6a9599$export$f0954fd7d5368655):null!=(r=v.c)?r:$c9c3248b3c6a9599$export$d8a7bebef127c134.c,d:w.cos*(null!=(a=v.d)?a:$c9c3248b3c6a9599$export$d8a7bebef127c134.d)};h.setTransform(S.a,S.b,S.c,S.d,x.x,x.y),u&&(h.globalCompositeOperation=g);let C=c.shadowColor;y.enable&&C&&(h.shadowBlur=y.blur,h.shadowColor=$18414f5f1f9fa88c$export$2476af37e47fcae2(C),h.shadowOffsetX=y.offset.x,h.shadowOffsetY=y.offset.y),p.fill&&(h.fillStyle=p.fill);let E=null!=(o=c.strokeWidth)?o:$c9c3248b3c6a9599$export$1f010363d1c40031;h.lineWidth=E,p.stroke&&(h.strokeStyle=p.stroke);let k={container:l,context:h,particle:c,radius:m,opacity:f,delta:d,transformData:S,strokeWidth:E};$9351e8aae3844c9d$export$71b514a25c47df50(k),$9351e8aae3844c9d$export$2808702213c51f09(k),$9351e8aae3844c9d$export$27b58ff3abda0f8e(k),h.globalCompositeOperation="source-over",h.resetTransform()}function $9351e8aae3844c9d$export$27b58ff3abda0f8e(t){let{container:e,context:i,particle:s,radius:n,opacity:r,delta:a,transformData:o}=t;if(!s.effect)return;let l=e.effectDrawers.get(s.effect);l&&l.draw({context:i,particle:s,radius:n,opacity:r,delta:a,pixelRatio:e.retina.pixelRatio,transformData:(0,$wpIFA._)({},o)})}function $9351e8aae3844c9d$export$71b514a25c47df50(t){let{container:e,context:i,particle:s,radius:n,opacity:r,delta:a,strokeWidth:o,transformData:l}=t;if(!s.shape)return;let h=e.shapeDrawers.get(s.shape);h&&(i.beginPath(),h.draw({context:i,particle:s,radius:n,opacity:r,delta:a,pixelRatio:e.retina.pixelRatio,transformData:(0,$wpIFA._)({},l)}),s.shapeClose&&i.closePath(),o>$c9c3248b3c6a9599$export$1f010363d1c40031&&i.stroke(),s.shapeFill&&i.fill())}function $9351e8aae3844c9d$export$2808702213c51f09(t){let{container:e,context:i,particle:s,radius:n,opacity:r,delta:a,transformData:o}=t;if(!s.shape)return;let l=e.shapeDrawers.get(s.shape);(null==l?void 0:l.afterDraw)&&l.afterDraw({context:i,particle:s,radius:n,opacity:r,delta:a,pixelRatio:e.retina.pixelRatio,transformData:(0,$wpIFA._)({},o)})}function $9351e8aae3844c9d$export$ee9933e1bf4ba142(t,e,i){e.draw&&e.draw(t,i)}function $9351e8aae3844c9d$export$3493f6d6277d918a(t,e,i,s){e.drawParticle&&e.drawParticle(t,i,s)}function $9351e8aae3844c9d$export$fe1d034b0e82666(t,e,i){return{h:t.h,s:t.s,l:t.l+(e===$7d2e2ca9f0011a18$export$d3c0448523aecc2e.darken?-$c9c3248b3c6a9599$export$6438bad23c977d39:$c9c3248b3c6a9599$export$6438bad23c977d39)*i}}function $3f9ba00c5b85c46c$var$setTransformValue(t,e,i){var s;let n=e[i];void 0!==n&&(t[i]=(null!=(s=t[i])?s:$c9c3248b3c6a9599$export$1f10c01143b9f089)*n)}function $3f9ba00c5b85c46c$var$setStyle(t,e,i=!1){if(!e)return;let s=t;if(!s)return;let n=s.style;if(!n)return;let r=new Set;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&r.add(n[t]);for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.add(e[t]);for(let t of r){let s=e.getPropertyValue(t);s?n.setProperty(t,s,i?"important":""):n.removeProperty(t)}}!function(t){t.darken="darken",t.enlighten="enlighten"}($7d2e2ca9f0011a18$export$d3c0448523aecc2e||($7d2e2ca9f0011a18$export$d3c0448523aecc2e={}));class $3f9ba00c5b85c46c$export$8d01c972ee8b14a9{get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){let t=this.container.actualOptions,e=t.particles.move.trail,i=this._trailFill;t.backgroundMask.enable?this.paint():e.enable&&e.length>$c9c3248b3c6a9599$export$920ec94752436dad&&i?i.color?this._paintBase($18414f5f1f9fa88c$export$2476af37e47fcae2(i.color,i.opacity)):i.image&&this._paintImage(i.image,i.opacity):t.clear&&this.draw(t=>{$9351e8aae3844c9d$export$42ffd38884aecdac(t,this.size)})}destroy(){if(this.stop(),this._generated){let t=this.element;null==t||t.remove(),this.element=void 0}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(t){let e=this._context;if(e)return t(e)}drawAsync(t){let e=this._context;if(e)return t(e)}drawParticle(t,e){var i;if(t.spawning||t.destroyed)return;let s=t.getRadius();if(s<=$c9c3248b3c6a9599$export$4b0ea52aa81e1ca2)return;let n=t.getFillColor(),r=null!=(i=t.getStrokeColor())?i:n,[a,o]=this._getPluginParticleColors(t);a||(a=n),o||(o=r),(a||o)&&this.draw(i=>{var n,r,l,h;let c=this.container,d=c.actualOptions,p=t.options.zIndex,u=$c9c3248b3c6a9599$export$6ca59ab71c007a1b-t.zIndexFactor,g=u**p.opacityRate,m=null!=(l=null!=(r=t.bubble.opacity)?r:null==(n=t.opacity)?void 0:n.value)?l:$c9c3248b3c6a9599$export$7395e4cb572e863b,f=null!=(h=t.strokeOpacity)?h:m,y=m*g,v=f*g,x={},b={fill:a?$18414f5f1f9fa88c$export$9d057e59c7b0a82d(a,y):void 0};b.stroke=o?$18414f5f1f9fa88c$export$9d057e59c7b0a82d(o,v):b.fill,this._applyPreDrawUpdaters(i,t,s,y,b,x),$9351e8aae3844c9d$export$fca8f175741ef351({container:c,context:i,particle:t,delta:e,colorStyles:b,backgroundMask:d.backgroundMask.enable,composite:d.backgroundMask.composite,radius:s*u**p.sizeRate,opacity:y,shadow:t.options.shadow,transform:x}),this._applyPostDrawUpdaters(t)})}drawParticlePlugin(t,e,i){this.draw(s=>$9351e8aae3844c9d$export$3493f6d6277d918a(s,t,e,i))}drawPlugin(t,e){this.draw(i=>$9351e8aae3844c9d$export$ee9933e1bf4ba142(i,t,e))}async init(){this._safeMutationObserver(t=>t.disconnect()),this._mutationObserver=$b45a95be606465d1$export$c2f9084a48da0641(t=>{for(let e of t)"attributes"===e.type&&"style"===e.attributeName&&this._repairStyle()}),this.resize(),this._initStyle(),await this._initCover();try{await this._initTrail()}catch(t){$b45a95be606465d1$export$2b1d391cd05230fd().error(t)}this.initBackground(),this._safeMutationObserver(t=>{this.element&&this.element instanceof Node&&t.observe(this.element,{attributes:!0})}),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){let t=this.container.actualOptions.background,e=this.element;if(!e)return;let i=e.style;if(i){if(t.color){let e=$18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(this._engine,t.color);i.backgroundColor=e?$18414f5f1f9fa88c$export$2476af37e47fcae2(e,t.opacity):""}else i.backgroundColor="";i.backgroundImage=t.image||"",i.backgroundPosition=t.position||"",i.backgroundRepeat=t.repeat||"",i.backgroundSize=t.size||""}}initPlugins(){for(let e of(this._resizePlugins=[],this.container.plugins.values())){var t;e.resize&&this._resizePlugins.push(e),(null!=(t=e.particleFillColor)?t:e.particleStrokeColor)&&this._colorPlugins.push(e)}}initUpdaters(){for(let i of(this._preDrawUpdaters=[],this._postDrawUpdaters=[],this.container.particles.updaters)){var t,e;i.afterDraw&&this._postDrawUpdaters.push(i),(null!=(e=null!=(t=i.getColorStyles)?t:i.getTransformValues)?e:i.beforeDraw)&&this._preDrawUpdaters.push(i)}}loadCanvas(t){this._generated&&this.element&&this.element.remove(),this._generated=t.dataset&&$c9c3248b3c6a9599$export$4a278486528d5cfb in t.dataset?"true"===t.dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]:this._generated,this.element=t,this.element.ariaHidden="true",this._originalStyle=$b45a95be606465d1$export$667e8f3bfe6278b7(this.element.style);let e=this._standardSize;e.height=t.offsetHeight,e.width=t.offsetWidth;let i=this.container.retina.pixelRatio,s=this.size;t.height=s.height=e.height*i,t.width=s.width=e.width*i,this._context=this.element.getContext("2d"),this._safeMutationObserver(t=>t.disconnect()),this.container.retina.init(),this.initBackground(),this._safeMutationObserver(t=>{this.element&&this.element instanceof Node&&t.observe(this.element,{attributes:!0})})}paint(){let t=this.container.actualOptions;this.draw(e=>{t.backgroundMask.enable&&t.backgroundMask.cover?($9351e8aae3844c9d$export$42ffd38884aecdac(e,this.size),this._coverImage?this._paintImage(this._coverImage.image,this._coverImage.opacity):this._coverColorStyle?this._paintBase(this._coverColorStyle):this._paintBase()):this._paintBase()})}resize(){if(!this.element)return!1;let t=this.container,e=t.canvas._standardSize,i={width:this.element.offsetWidth,height:this.element.offsetHeight},s=t.retina.pixelRatio,n={width:i.width*s,height:i.height*s};if(i.height===e.height&&i.width===e.width&&n.height===this.element.height&&n.width===this.element.width)return!1;let r=(0,$wpIFA._)({},e);e.height=i.height,e.width=i.width;let a=this.size;return this.element.width=a.width=n.width,this.element.height=a.height=n.height,this.container.started&&t.particles.setResizeFactor({width:e.width/r.width,height:e.height/r.height}),!0}setPointerEvents(t){this.element&&(this._pointerEvents=t,this._repairStyle())}stop(){this._safeMutationObserver(t=>t.disconnect()),this._mutationObserver=void 0,this.draw(t=>$9351e8aae3844c9d$export$42ffd38884aecdac(t,this.size))}async windowResize(){if(!this.element||!this.resize())return;let t=this.container,e=t.updateActualOptions();t.particles.setDensity(),this._applyResizePlugins(),e&&await t.refresh()}constructor(t,e){this.container=t,this._applyPostDrawUpdaters=t=>{var e;for(let i of this._postDrawUpdaters)null==(e=i.afterDraw)||e.call(i,t)},this._applyPreDrawUpdaters=(t,e,i,s,n,r)=>{for(let o of this._preDrawUpdaters){var a;if(o.getColorStyles){let{fill:r,stroke:a}=o.getColorStyles(e,t,i,s);r&&(n.fill=r),a&&(n.stroke=a)}if(o.getTransformValues){let t=o.getTransformValues(e);for(let e in t)$3f9ba00c5b85c46c$var$setTransformValue(r,t,e)}null==(a=o.beforeDraw)||a.call(o,e)}},this._applyResizePlugins=()=>{var t;for(let e of this._resizePlugins)null==(t=e.resize)||t.call(e)},this._getPluginParticleColors=t=>{let e,i;for(let s of this._colorPlugins)if(!e&&s.particleFillColor&&(e=$18414f5f1f9fa88c$export$79a89086521c0f12(this._engine,s.particleFillColor(t))),!i&&s.particleStrokeColor&&(i=$18414f5f1f9fa88c$export$79a89086521c0f12(this._engine,s.particleStrokeColor(t))),e&&i)break;return[e,i]},this._initCover=async()=>{let t=this.container.actualOptions.backgroundMask.cover,e=t.color;if(e){let i=$18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(this._engine,e);if(i){let e=(0,$9FMZM._)((0,$wpIFA._)({},i),{a:t.opacity});this._coverColorStyle=$18414f5f1f9fa88c$export$2476af37e47fcae2(e,e.a)}}else await new Promise((e,i)=>{if(!t.image)return;let s=document.createElement("img");s.addEventListener("load",()=>{this._coverImage={image:s,opacity:t.opacity},e()}),s.addEventListener("error",t=>{i(t.error)}),s.src=t.image})},this._initStyle=()=>{let t=this.element,e=this.container.actualOptions;if(t)for(let i in this._fullScreen?this._setFullScreenStyle():this._resetOriginalStyle(),e.style){if(!i||!e.style||!Object.prototype.hasOwnProperty.call(e.style,i))continue;let s=e.style[i];s&&t.style.setProperty(i,s,"important")}},this._initTrail=async()=>{let t=this.container.actualOptions.particles.move.trail,e=t.fill;if(!t.enable)return;let i=$c9c3248b3c6a9599$export$6a43a0894b8f8dd4/t.length;if(e.color){let t=$18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(this._engine,e.color);if(!t)return;this._trailFill={color:(0,$wpIFA._)({},t),opacity:i}}else await new Promise((t,s)=>{if(!e.image)return;let n=document.createElement("img");n.addEventListener("load",()=>{this._trailFill={image:n,opacity:i},t()}),n.addEventListener("error",t=>{s(t.error)}),n.src=e.image})},this._paintBase=t=>{this.draw(e=>$9351e8aae3844c9d$export$2837cdf5427f767e(e,this.size,t))},this._paintImage=(t,e)=>{this.draw(i=>$9351e8aae3844c9d$export$a17334b9431a8cb2(i,this.size,t,e))},this._repairStyle=()=>{let t=this.element;if(!t)return;this._safeMutationObserver(t=>t.disconnect()),this._initStyle(),this.initBackground();let e=this._pointerEvents;t.style.pointerEvents=e,t.setAttribute("pointer-events",e),this._safeMutationObserver(e=>{t&&t instanceof Node&&e.observe(t,{attributes:!0})})},this._resetOriginalStyle=()=>{let t=this.element,e=this._originalStyle;t&&e&&$3f9ba00c5b85c46c$var$setStyle(t,e,!0)},this._safeMutationObserver=t=>{this._mutationObserver&&t(this._mutationObserver)},this._setFullScreenStyle=()=>{let t=this.element;t&&$3f9ba00c5b85c46c$var$setStyle(t,$b45a95be606465d1$export$10d1829d88c10e6a(this.container.actualOptions.fullScreen.zIndex),!0)},this._engine=e,this._standardSize={height:0,width:0};let i=t.retina.pixelRatio,s=this._standardSize;this.size={height:s.height*i,width:s.width*i},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[],this._pointerEvents="none"}}var $wpIFA=parcelRequire("wpIFA");function $44a3ba61fee319fe$var$manageListener(t,e,i,s,n){if(s){let s={passive:!0};$a968daecb9ed97f0$export$f9ce7b637dfbe238(n)?s.capture=n:void 0!==n&&(s=n),t.addEventListener(e,i,s)}else{let s=n;t.removeEventListener(e,i,s)}}!function(t){t.canvas="canvas",t.parent="parent",t.window="window"}($a824238dd90318d5$export$a061a4a5d124ecc0||($a824238dd90318d5$export$a061a4a5d124ecc0={}));class $44a3ba61fee319fe$export$b20b719ec758a20f{addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}constructor(t){this.container=t,this._doMouseTouchClick=t=>{let e=this.container,i=e.actualOptions;if(this._canPush){let t=e.interactivity.mouse,s=t.position;if(!s)return;t.clickPosition=(0,$wpIFA._)({},s),t.clickTime=new Date().getTime(),$b45a95be606465d1$export$8e5dc47097396754(i.interactivity.events.onClick.mode,t=>this.container.handleClickMode(t))}"touchend"===t.type&&setTimeout(()=>this._mouseTouchFinish(),$c9c3248b3c6a9599$export$a31a053ae1bfc10e)},this._handleThemeChange=t=>{let e=t,i=this.container,s=i.options,n=s.defaultThemes,r=e.matches?n.dark:n.light,a=s.themes.find(t=>t.name===r);(null==a?void 0:a.default.auto)&&i.loadTheme(r)},this._handleVisibilityChange=()=>{var t;let e=this.container,i=e.actualOptions;this._mouseTouchFinish(),i.pauseOnBlur&&((null==(t=document)?void 0:t.hidden)?(e.pageHidden=!0,e.pause()):(e.pageHidden=!1,e.animationStatus?e.play(!0):e.draw(!0)))},this._handleWindowResize=()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout);let t=async()=>{let t=this.container.canvas;await (null==t?void 0:t.windowResize())};this._resizeTimeout=setTimeout(()=>void t(),this.container.actualOptions.interactivity.events.resize.delay*$c9c3248b3c6a9599$export$f64c3bfbc58eec0f)},this._manageInteractivityListeners=(t,e)=>{let i=this._handlers,s=this.container,n=s.actualOptions,r=s.interactivity.element;if(!r)return;let a=r,o=s.canvas;o.setPointerEvents(a===o.element?"initial":"none"),(n.interactivity.events.onHover.enable||n.interactivity.events.onClick.enable)&&($44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$1ffe551d7d33cd33,i.mouseMove,e),$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$d5353b6c79bbcc70,i.touchStart,e),$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$d28a82874c0e6212,i.touchMove,e),n.interactivity.events.onClick.enable?($44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$11164630b85c192d,i.touchEndClick,e),$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$9fb0268ce1bdbca0,i.mouseUp,e),$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$9ffd73c9a0e32c34,i.mouseDown,e)):$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$11164630b85c192d,i.touchEnd,e),$44a3ba61fee319fe$var$manageListener(r,t,i.mouseLeave,e),$44a3ba61fee319fe$var$manageListener(r,$c9c3248b3c6a9599$export$65db1c69591947a7,i.touchCancel,e))},this._manageListeners=t=>{var e;let i=this._handlers,s=this.container,n=s.actualOptions.interactivity.detectsOn,r=s.canvas.element,a=$c9c3248b3c6a9599$export$f4b184a85a586f8a;n===$a824238dd90318d5$export$a061a4a5d124ecc0.window?(s.interactivity.element=window,a=$c9c3248b3c6a9599$export$55cc1d6a692feb2b):n===$a824238dd90318d5$export$a061a4a5d124ecc0.parent&&r?s.interactivity.element=null!=(e=r.parentElement)?e:r.parentNode:s.interactivity.element=r,this._manageMediaMatch(t),this._manageResize(t),this._manageInteractivityListeners(a,t),document&&$44a3ba61fee319fe$var$manageListener(document,$c9c3248b3c6a9599$export$73536144dc68dd0f,i.visibilityChange,t,!1)},this._manageMediaMatch=t=>{let e=this._handlers,i=$b45a95be606465d1$export$db32b9574e21e00f("(prefers-color-scheme: dark)");i&&(void 0!==i.addEventListener?$44a3ba61fee319fe$var$manageListener(i,"change",e.themeChange,t):void 0!==i.addListener&&(t?i.addListener(e.oldThemeChange):i.removeListener(e.oldThemeChange)))},this._manageResize=t=>{let e=this._handlers,i=this.container;if(!i.actualOptions.interactivity.events.resize)return;if("undefined"==typeof ResizeObserver)return void $44a3ba61fee319fe$var$manageListener(window,$c9c3248b3c6a9599$export$8b3d73c91cd7cc65,e.resize,t);let s=i.canvas.element;this._resizeObserver&&!t?(s&&this._resizeObserver.unobserve(s),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&t&&s&&(this._resizeObserver=new ResizeObserver(t=>{t.find(t=>t.target===s)&&this._handleWindowResize()}),this._resizeObserver.observe(s))},this._mouseDown=()=>{let{interactivity:t}=this.container;if(!t)return;let{mouse:e}=t;e.clicking=!0,e.downPosition=e.position},this._mouseTouchClick=t=>{let e=this.container,i=e.actualOptions,{mouse:s}=e.interactivity;s.inside=!0;let n=!1,r=s.position;if(r&&i.interactivity.events.onClick.enable){for(let t of e.plugins.values())if(t.clickPositionValid&&(n=t.clickPositionValid(r)))break;n||this._doMouseTouchClick(t),s.clicking=!1}},this._mouseTouchFinish=()=>{let t=this.container.interactivity;if(!t)return;let e=t.mouse;delete e.position,delete e.clickPosition,delete e.downPosition,t.status=$c9c3248b3c6a9599$export$f4b184a85a586f8a,e.inside=!1,e.clicking=!1},this._mouseTouchMove=t=>{var e,i,s,n,r,a;let o,l=this.container,h=l.actualOptions,c=l.interactivity,d=l.canvas.element;if(!(null==c?void 0:c.element))return;if(c.mouse.inside=!0,t.type.startsWith("pointer")){this._canPush=!0;let r=t;if(c.element===window){if(d){let t=d.getBoundingClientRect();o={x:r.clientX-t.left,y:r.clientY-t.top}}}else if(h.interactivity.detectsOn===$a824238dd90318d5$export$a061a4a5d124ecc0.parent){let t=r.target,e=r.currentTarget;if(t&&e&&d){let i=t.getBoundingClientRect(),s=e.getBoundingClientRect(),n=d.getBoundingClientRect();o={x:r.offsetX+$c9c3248b3c6a9599$export$7b3cbda67be88f5f*i.left-(s.left+n.left),y:r.offsetY+$c9c3248b3c6a9599$export$7b3cbda67be88f5f*i.top-(s.top+n.top)}}else o={x:null!=(s=r.offsetX)?s:r.clientX,y:null!=(n=r.offsetY)?n:r.clientY}}else r.target===d&&(o={x:null!=(e=r.offsetX)?e:r.clientX,y:null!=(i=r.offsetY)?i:r.clientY})}else if(this._canPush="touchmove"!==t.type,d){let e=t,i=e.touches[e.touches.length-$c9c3248b3c6a9599$export$4a5b9680be542cf8],s=d.getBoundingClientRect();o={x:i.clientX-(null!=(r=s.left)?r:$c9c3248b3c6a9599$export$17c6bab6aae4c3d),y:i.clientY-(null!=(a=s.top)?a:$c9c3248b3c6a9599$export$17c6bab6aae4c3d)}}let p=l.retina.pixelRatio;o&&(o.x*=p,o.y*=p),c.mouse.position=o,c.status=$c9c3248b3c6a9599$export$1ffe551d7d33cd33},this._touchEnd=t=>{for(let e of Array.from(t.changedTouches))this._touches.delete(e.identifier);this._mouseTouchFinish()},this._touchEndClick=t=>{for(let e of Array.from(t.changedTouches))this._touches.delete(e.identifier);this._mouseTouchClick(t)},this._touchStart=t=>{for(let e of Array.from(t.changedTouches))this._touches.set(e.identifier,performance.now());this._mouseTouchMove(t)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:t=>this._mouseTouchMove(t),mouseUp:t=>this._mouseTouchClick(t),touchStart:t=>this._touchStart(t),touchMove:t=>this._mouseTouchMove(t),touchEnd:t=>this._touchEnd(t),touchCancel:t=>this._touchEnd(t),touchEndClick:t=>this._touchEndClick(t),visibilityChange:()=>this._handleVisibilityChange(),themeChange:t=>this._handleThemeChange(t),oldThemeChange:t=>this._handleThemeChange(t),resize:()=>{this._handleWindowResize()}}}}!function(t){t.configAdded="configAdded",t.containerInit="containerInit",t.particlesSetup="particlesSetup",t.containerStarted="containerStarted",t.containerStopped="containerStopped",t.containerDestroyed="containerDestroyed",t.containerPaused="containerPaused",t.containerPlay="containerPlay",t.containerBuilt="containerBuilt",t.particleAdded="particleAdded",t.particleDestroyed="particleDestroyed",t.particleRemoved="particleRemoved"}($caa94592e0101c24$export$3d7865934588d77e||($caa94592e0101c24$export$3d7865934588d77e={}));class $0cc4121bb3790d13$export$c2b08aa25660fcaa{static create(t,e){let i=new $0cc4121bb3790d13$export$c2b08aa25660fcaa;return i.load(t),void 0!==e&&($a968daecb9ed97f0$export$844ec244b1367d54(e)||$a968daecb9ed97f0$export$43bee75e5e14138e(e)?i.load({value:e}):i.load(e)),i}load(t){!$a968daecb9ed97f0$export$630801d484da15df(t)&&($a968daecb9ed97f0$export$630801d484da15df(t.value)||(this.value=t.value))}constructor(){this.value=""}}class $c0bc863d09255fa5$export$668799e4797757a8{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.color&&(this.color=$0cc4121bb3790d13$export$c2b08aa25660fcaa.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image),void 0!==t.position&&(this.position=t.position),void 0!==t.repeat&&(this.repeat=t.repeat),void 0!==t.size&&(this.size=t.size),void 0!==t.opacity&&(this.opacity=t.opacity))}constructor(){this.color=new $0cc4121bb3790d13$export$c2b08aa25660fcaa,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}}class $1001b0c9088027d6$export$83d45d4584162ec0{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.color&&(this.color=$0cc4121bb3790d13$export$c2b08aa25660fcaa.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image),void 0!==t.opacity&&(this.opacity=t.opacity))}constructor(){this.opacity=1}}class $5c7d750620b3a538$export$36a2fa1e47ffeebc{load(t){if(!$a968daecb9ed97f0$export$630801d484da15df(t)){if(void 0!==t.composite&&(this.composite=t.composite),void 0!==t.cover){let e=t.cover,i=$a968daecb9ed97f0$export$844ec244b1367d54(t.cover)?{color:t.cover}:t.cover;this.cover.load(void 0!==e.color||void 0!==e.image?e:{color:i})}void 0!==t.enable&&(this.enable=t.enable)}}constructor(){this.composite="destination-out",this.cover=new $1001b0c9088027d6$export$83d45d4584162ec0,this.enable=!1}}class $b1896af52c8fc284$export$f885b95b3f0be76d{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.zIndex&&(this.zIndex=t.zIndex))}constructor(){this.enable=!0,this.zIndex=0}}class $5be117cd432db59f$export$8d82f6df2d02cd91{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode))}constructor(){this.enable=!1,this.mode=[]}}!function(t){t.circle="circle",t.rectangle="rectangle"}($c5bce1325a5b7ff7$export$9e83d65c7ba90739||($c5bce1325a5b7ff7$export$9e83d65c7ba90739={}));class $223b665d74fcc811$export$54136f11f358067a{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.selectors&&(this.selectors=t.selectors),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.type&&(this.type=t.type))}constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type=$c5bce1325a5b7ff7$export$9e83d65c7ba90739.circle}}class $97f57ec892c2d3a9$export$1bc430945f060dd1{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.force&&(this.force=t.force),void 0!==t.smooth&&(this.smooth=t.smooth))}constructor(){this.enable=!1,this.force=2,this.smooth=10}}class $0890d20511a2c7b0$export$2f13ede603111372{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode),this.parallax.load(t.parallax))}constructor(){this.enable=!1,this.mode=[],this.parallax=new $97f57ec892c2d3a9$export$1bc430945f060dd1}}class $1f9d9dac5be56ec8$export$4a407cdeed472cd5{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.delay&&(this.delay=t.delay),void 0!==t.enable&&(this.enable=t.enable))}constructor(){this.delay=.5,this.enable=!0}}class $005cd0555c872f5b$export$ada873a34909da65{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;this.onClick.load(t.onClick);let e=t.onDiv;void 0!==e&&(this.onDiv=$b45a95be606465d1$export$8e5dc47097396754(e,t=>{let e=new $223b665d74fcc811$export$54136f11f358067a;return e.load(t),e})),this.onHover.load(t.onHover),this.resize.load(t.resize)}constructor(){this.onClick=new $5be117cd432db59f$export$8d82f6df2d02cd91,this.onDiv=new $223b665d74fcc811$export$54136f11f358067a,this.onHover=new $0890d20511a2c7b0$export$2f13ede603111372,this.resize=new $1f9d9dac5be56ec8$export$4a407cdeed472cd5}}class $30891e36886d8c02$export$43660d87cb080eb{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t)||!this._container)return;let e=this._engine.interactors.get(this._container);if(e)for(let i of e)i.loadModeOptions&&i.loadModeOptions(this,t)}constructor(t,e){this._engine=t,this._container=e}}class $00f6eb0d03377349$export$865458a3ba269c4a{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.detectsOn;void 0!==e&&(this.detectsOn=e),this.events.load(t.events),this.modes.load(t.modes)}constructor(t,e){this.detectsOn=$a824238dd90318d5$export$a061a4a5d124ecc0.window,this.events=new $005cd0555c872f5b$export$ada873a34909da65,this.modes=new $30891e36886d8c02$export$43660d87cb080eb(t,e)}}class $7d530095dcdc0fa3$export$4f41a3ab9fa8cdf{load(t){var e,i,s;!$a968daecb9ed97f0$export$630801d484da15df(t)&&(t.position&&(this.position={x:null!=(e=t.position.x)?e:$c9c3248b3c6a9599$export$d4e77d4b7e9933c7,y:null!=(i=t.position.y)?i:$c9c3248b3c6a9599$export$d4e77d4b7e9933c7,mode:null!=(s=t.position.mode)?s:$646f0f1b6fd77518$export$1009f0178778a981.percent}),t.options&&(this.options=$b45a95be606465d1$export$54e9fb29908872fa({},t.options)))}}!function(t){t.screen="screen",t.canvas="canvas"}($b6970044e814ff87$export$73c2705cb2da08ab||($b6970044e814ff87$export$73c2705cb2da08ab={}));class $3e078b33d8dd4ed7$export$49b67f1c7ac91d9b{load(t){!$a968daecb9ed97f0$export$630801d484da15df(t)&&($a968daecb9ed97f0$export$630801d484da15df(t.maxWidth)||(this.maxWidth=t.maxWidth),$a968daecb9ed97f0$export$630801d484da15df(t.mode)||(t.mode===$b6970044e814ff87$export$73c2705cb2da08ab.screen?this.mode=$b6970044e814ff87$export$73c2705cb2da08ab.screen:this.mode=$b6970044e814ff87$export$73c2705cb2da08ab.canvas),$a968daecb9ed97f0$export$630801d484da15df(t.options)||(this.options=$b45a95be606465d1$export$54e9fb29908872fa({},t.options)))}constructor(){this.maxWidth=1/0,this.options={},this.mode=$b6970044e814ff87$export$73c2705cb2da08ab.canvas}}!function(t){t.any="any",t.dark="dark",t.light="light"}($daa049cf342b91a4$export$cd01a11ba097c64c||($daa049cf342b91a4$export$cd01a11ba097c64c={}));class $ff099d4a24cb0cec$export$4bc81bcab6354024{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.auto&&(this.auto=t.auto),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.value&&(this.value=t.value))}constructor(){this.auto=!1,this.mode=$daa049cf342b91a4$export$cd01a11ba097c64c.any,this.value=!1}}class $026e400106b52d32$export$14faa19a0f3bbeb2{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.name&&(this.name=t.name),this.default.load(t.default),void 0!==t.options&&(this.options=$b45a95be606465d1$export$54e9fb29908872fa({},t.options)))}constructor(){this.name="",this.default=new $ff099d4a24cb0cec$export$4bc81bcab6354024}}class $c72165fe30f2e09c$export$e293c31e7176ae39{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.count&&(this.count=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.count)),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.speed&&(this.speed=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.speed)),void 0!==t.decay&&(this.decay=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.decay)),void 0!==t.delay&&(this.delay=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.delay)),void 0!==t.sync&&(this.sync=t.sync))}constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}}class $c72165fe30f2e09c$export$664e182a9c83d6f5 extends $c72165fe30f2e09c$export$e293c31e7176ae39{load(t){super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.mode&&(this.mode=t.mode),void 0!==t.startValue&&(this.startValue=t.startValue))}constructor(){super(),this.mode=$1f6c98f1bc1611d6$export$6bf57c7f0219f07d.auto,this.startValue=$7a43ac3a337343a6$export$5385b9a82993d2c8.random}}class $303851cdf06ab6c5$export$3cc8aa7a0c621de0 extends $c72165fe30f2e09c$export$e293c31e7176ae39{load(t){super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t)||void 0!==t.offset&&(this.offset=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.offset))}constructor(){super(),this.offset=0,this.sync=!0}}class $bf69f65c67da52be$export$b4c56f18acc5f2f4{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(this.h.load(t.h),this.s.load(t.s),this.l.load(t.l))}constructor(){this.h=new $303851cdf06ab6c5$export$3cc8aa7a0c621de0,this.s=new $303851cdf06ab6c5$export$3cc8aa7a0c621de0,this.l=new $303851cdf06ab6c5$export$3cc8aa7a0c621de0}}class $337ab9fc72734f0d$export$6f79b6ff75533155 extends $0cc4121bb3790d13$export$c2b08aa25660fcaa{static create(t,e){let i=new $337ab9fc72734f0d$export$6f79b6ff75533155;return i.load(t),void 0!==e&&($a968daecb9ed97f0$export$844ec244b1367d54(e)||$a968daecb9ed97f0$export$43bee75e5e14138e(e)?i.load({value:e}):i.load(e)),i}load(t){if(super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.animation;void 0!==e&&(void 0!==e.enable?this.animation.h.load(e):this.animation.load(t.animation))}constructor(){super(),this.animation=new $bf69f65c67da52be$export$b4c56f18acc5f2f4}}!function(t){t.absorb="absorb",t.bounce="bounce",t.destroy="destroy"}($6ca36586b626e950$export$c17cb29bf4746ec8||($6ca36586b626e950$export$c17cb29bf4746ec8={}));class $dba52d412b31c5f2$export$dbafb70800ee3f9b{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||void 0!==t.speed&&(this.speed=t.speed)}constructor(){this.speed=2}}class $20e15a11ce0151a9$export$7dac291125fc16da{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.retries&&(this.retries=t.retries))}constructor(){this.enable=!0,this.retries=0}}class $326575e6158e73eb$export$2f74c042fca0b66d{load(t){!$a968daecb9ed97f0$export$630801d484da15df(t)&&($a968daecb9ed97f0$export$630801d484da15df(t.value)||(this.value=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.value)))}constructor(){this.value=0}}class $326575e6158e73eb$export$a0fda83b6e14e586 extends $326575e6158e73eb$export$2f74c042fca0b66d{load(t){if(super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.animation;void 0!==e&&this.animation.load(e)}constructor(){super(),this.animation=new $c72165fe30f2e09c$export$e293c31e7176ae39}}class $326575e6158e73eb$export$8d0da1142c209427 extends $326575e6158e73eb$export$a0fda83b6e14e586{load(t){super.load(t)}constructor(){super(),this.animation=new $c72165fe30f2e09c$export$664e182a9c83d6f5}}class $904ef5b0f40d6490$export$855823db9a0085c extends $326575e6158e73eb$export$2f74c042fca0b66d{constructor(){super(),this.value=1}}class $2214d3206335440e$export$e6dd54c89cd6ac88{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(this.horizontal.load(t.horizontal),this.vertical.load(t.vertical))}constructor(){this.horizontal=new $904ef5b0f40d6490$export$855823db9a0085c,this.vertical=new $904ef5b0f40d6490$export$855823db9a0085c}}class $a98cc03184daec47$export$97ff58b0eb9a5ed0{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(this.absorb.load(t.absorb),this.bounce.load(t.bounce),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.maxSpeed&&(this.maxSpeed=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.maxSpeed)),void 0!==t.mode&&(this.mode=t.mode),this.overlap.load(t.overlap))}constructor(){this.absorb=new $dba52d412b31c5f2$export$dbafb70800ee3f9b,this.bounce=new $2214d3206335440e$export$e6dd54c89cd6ac88,this.enable=!1,this.maxSpeed=50,this.mode=$6ca36586b626e950$export$c17cb29bf4746ec8.bounce,this.overlap=new $20e15a11ce0151a9$export$7dac291125fc16da}}class $abdc6044d8a6cbed$export$a32b0b1c1ac59d04{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.options;if(void 0!==e)for(let t in e){var i;let s=e[t];s&&(this.options[t]=$b45a95be606465d1$export$54e9fb29908872fa(null!=(i=this.options[t])?i:{},s))}void 0!==t.close&&(this.close=t.close),void 0!==t.fill&&(this.fill=t.fill),void 0!==t.type&&(this.type=t.type)}constructor(){this.close=!0,this.fill=!0,this.options={},this.type=[]}}var $wpIFA=parcelRequire("wpIFA");class $33a9f2bb1634f2f6$export$128f6c8d329dc399{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.offset&&(this.offset=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.offset)),void 0!==t.value&&(this.value=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.value)))}constructor(){this.offset=0,this.value=90}}class $f71accdd30d737f9$export$6c54633883102b4b{load(t){if(!$a968daecb9ed97f0$export$630801d484da15df(t)&&(void 0!==t.distance&&(this.distance=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.distance)),void 0!==t.enable&&(this.enable=t.enable),t.rotate)){let e=t.rotate.x;void 0!==e&&(this.rotate.x=e);let i=t.rotate.y;void 0!==i&&(this.rotate.y=i)}}constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}}class $9d34b5d8964f044a$export$7b60622f06eeec06{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.radius&&(this.radius=t.radius))}constructor(){this.x=50,this.y=50,this.mode=$646f0f1b6fd77518$export$1009f0178778a981.percent,this.radius=0}}class $e2481919af8d1a4b$export$c6d1f1b3593b164c{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.acceleration&&(this.acceleration=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.acceleration)),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.inverse&&(this.inverse=t.inverse),void 0!==t.maxSpeed&&(this.maxSpeed=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.maxSpeed)))}constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}}class $9f599de0f13e931d$export$bcc70636a6a97e73{load(t){!$a968daecb9ed97f0$export$630801d484da15df(t)&&(void 0!==t.clamp&&(this.clamp=t.clamp),this.delay.load(t.delay),void 0!==t.enable&&(this.enable=t.enable),this.generator=t.generator,t.options&&(this.options=$b45a95be606465d1$export$54e9fb29908872fa(this.options,t.options)))}constructor(){this.clamp=!0,this.delay=new $326575e6158e73eb$export$2f74c042fca0b66d,this.enable=!1,this.options={}}}class $57f8260a15a7e176$export$7518c5bd39f0f31a{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.color&&(this.color=$0cc4121bb3790d13$export$c2b08aa25660fcaa.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image))}}class $a5f1ef567633ec49$export$e428bb3fcf53809d{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.fill&&this.fill.load(t.fill),void 0!==t.length&&(this.length=t.length))}constructor(){this.enable=!1,this.length=10,this.fill=new $57f8260a15a7e176$export$7518c5bd39f0f31a}}!function(t){t.bounce="bounce",t.none="none",t.out="out",t.destroy="destroy",t.split="split"}($082579e39391a6a4$export$cf5942d9a76b7ae2||($082579e39391a6a4$export$cf5942d9a76b7ae2={}));class $73157a96f553c2e5$export$647cf31ffff2d3{load(t){var e,i,s,n;$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.default&&(this.default=t.default),this.bottom=null!=(e=t.bottom)?e:t.default,this.left=null!=(i=t.left)?i:t.default,this.right=null!=(s=t.right)?s:t.default,this.top=null!=(n=t.top)?n:t.default)}constructor(){this.default=$082579e39391a6a4$export$cf5942d9a76b7ae2.out}}class $ec5a4faf3521206c$export$fcd783eeafc305c0{load(t){!$a968daecb9ed97f0$export$630801d484da15df(t)&&(void 0!==t.acceleration&&(this.acceleration=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.acceleration)),void 0!==t.enable&&(this.enable=t.enable),t.position&&(this.position=$b45a95be606465d1$export$54e9fb29908872fa({},t.position)))}constructor(){this.acceleration=0,this.enable=!1}}class $a520def3cb57325c$export$e49a5ad3dd6df925{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;this.angle.load($a968daecb9ed97f0$export$7e4aa119212bc614(t.angle)?{value:t.angle}:t.angle),this.attract.load(t.attract),this.center.load(t.center),void 0!==t.decay&&(this.decay=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.decay)),void 0!==t.direction&&(this.direction=t.direction),void 0!==t.distance&&(this.distance=$a968daecb9ed97f0$export$7e4aa119212bc614(t.distance)?{horizontal:t.distance,vertical:t.distance}:(0,$wpIFA._)({},t.distance)),void 0!==t.drift&&(this.drift=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.drift)),void 0!==t.enable&&(this.enable=t.enable),this.gravity.load(t.gravity);let e=t.outModes;void 0!==e&&($a968daecb9ed97f0$export$a6cdc56e425d0d0a(e)?this.outModes.load(e):this.outModes.load({default:e})),this.path.load(t.path),void 0!==t.random&&(this.random=t.random),void 0!==t.size&&(this.size=t.size),void 0!==t.speed&&(this.speed=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.speed)),this.spin.load(t.spin),void 0!==t.straight&&(this.straight=t.straight),this.trail.load(t.trail),void 0!==t.vibrate&&(this.vibrate=t.vibrate),void 0!==t.warp&&(this.warp=t.warp)}constructor(){this.angle=new $33a9f2bb1634f2f6$export$128f6c8d329dc399,this.attract=new $f71accdd30d737f9$export$6c54633883102b4b,this.center=new $9d34b5d8964f044a$export$7b60622f06eeec06,this.decay=0,this.distance={},this.direction=$219efb580e609ac5$export$cc1a246adca07dd4.none,this.drift=0,this.enable=!1,this.gravity=new $e2481919af8d1a4b$export$c6d1f1b3593b164c,this.path=new $9f599de0f13e931d$export$bcc70636a6a97e73,this.outModes=new $73157a96f553c2e5$export$647cf31ffff2d3,this.random=!1,this.size=!1,this.speed=2,this.spin=new $ec5a4faf3521206c$export$fcd783eeafc305c0,this.straight=!1,this.trail=new $a5f1ef567633ec49$export$e428bb3fcf53809d,this.vibrate=!1,this.warp=!1}}class $7eef88f3a2cd5e75$export$3e55dc49e2356209 extends $c72165fe30f2e09c$export$664e182a9c83d6f5{load(t){super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t)||void 0!==t.destroy&&(this.destroy=t.destroy)}constructor(){super(),this.destroy=$25b07e12db1a9da9$export$41a461248611663e.none,this.speed=2}}class $5d0f79bab682490f$export$588760baa0f6108e extends $326575e6158e73eb$export$8d0da1142c209427{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;super.load(t);let e=t.animation;void 0!==e&&this.animation.load(e)}constructor(){super(),this.animation=new $7eef88f3a2cd5e75$export$3e55dc49e2356209,this.value=1}}class $2318fe2236eddfbe$export$c11b1f56b7022ac8{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;void 0!==t.enable&&(this.enable=t.enable);let e=t.width;void 0!==e&&(this.width=e);let i=t.height;void 0!==i&&(this.height=i)}constructor(){this.enable=!1,this.width=1920,this.height=1080}}!function(t){t.delete="delete",t.wait="wait"}($c92fcd34ca9c4923$export$e9c6a0495dc4055f||($c92fcd34ca9c4923$export$e9c6a0495dc4055f={}));class $a16d75f4ddf23dc0$export$924e931bcf950072{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.mode&&(this.mode=t.mode),void 0!==t.value&&(this.value=t.value))}constructor(){this.mode=$c92fcd34ca9c4923$export$e9c6a0495dc4055f.delete,this.value=0}}class $102fa49e58184e05$export$2335cf7e85f36cfd{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(this.density.load(t.density),this.limit.load(t.limit),void 0!==t.value&&(this.value=t.value))}constructor(){this.density=new $2318fe2236eddfbe$export$c11b1f56b7022ac8,this.limit=new $a16d75f4ddf23dc0$export$924e931bcf950072,this.value=0}}class $a18aec8c47830178$export$a24c14443968327c{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.blur&&(this.blur=t.blur),this.color=$0cc4121bb3790d13$export$c2b08aa25660fcaa.create(this.color,t.color),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.offset&&(void 0!==t.offset.x&&(this.offset.x=t.offset.x),void 0!==t.offset.y&&(this.offset.y=t.offset.y)))}constructor(){this.blur=0,this.color=new $0cc4121bb3790d13$export$c2b08aa25660fcaa,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}}class $ab81e9a3ab801753$export$6428a7f2611ef1fa{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.options;if(void 0!==e)for(let t in e){var i;let s=e[t];s&&(this.options[t]=$b45a95be606465d1$export$54e9fb29908872fa(null!=(i=this.options[t])?i:{},s))}void 0!==t.close&&(this.close=t.close),void 0!==t.fill&&(this.fill=t.fill),void 0!==t.type&&(this.type=t.type)}constructor(){this.close=!0,this.fill=!0,this.options={},this.type="circle"}}class $4623cced83305045$export$231e08f1693c0669 extends $c72165fe30f2e09c$export$664e182a9c83d6f5{load(t){super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t)||void 0!==t.destroy&&(this.destroy=t.destroy)}constructor(){super(),this.destroy=$25b07e12db1a9da9$export$41a461248611663e.none,this.speed=5}}class $3bcfe5983840bdc3$export$cb6da89c6af1a8ec extends $326575e6158e73eb$export$8d0da1142c209427{load(t){if(super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t))return;let e=t.animation;void 0!==e&&this.animation.load(e)}constructor(){super(),this.animation=new $4623cced83305045$export$231e08f1693c0669,this.value=3}}class $5c0fd158e69038b6$export$18d19c7a3aa33064{load(t){$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.color&&(this.color=$337ab9fc72734f0d$export$6f79b6ff75533155.create(this.color,t.color)),void 0!==t.width&&(this.width=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.width)),void 0!==t.opacity&&(this.opacity=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.opacity)))}constructor(){this.width=0}}class $8605ad220374fddc$export$ccb31788083e2069 extends $326575e6158e73eb$export$2f74c042fca0b66d{load(t){super.load(t),$a968daecb9ed97f0$export$630801d484da15df(t)||(void 0!==t.opacityRate&&(this.opacityRate=t.opacityRate),void 0!==t.sizeRate&&(this.sizeRate=t.sizeRate),void 0!==t.velocityRate&&(this.velocityRate=t.velocityRate))}constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}}class $0916a959da75fe35$export$b4f1619131f0bce9{load(t){if($a968daecb9ed97f0$export$630801d484da15df(t))return;if(void 0!==t.groups)for(let i of Object.keys(t.groups)){var e;if(!Object.hasOwn(t.groups,i))continue;let s=t.groups[i];void 0!==s&&(this.groups[i]=$b45a95be606465d1$export$54e9fb29908872fa(null!=(e=this.groups[i])?e:{},s))}void 0!==t.reduceDuplicates&&(this.reduceDuplicates=t.reduceDuplicates),this.bounce.load(t.bounce),this.color.load($337ab9fc72734f0d$export$6f79b6ff75533155.create(this.color,t.color)),this.effect.load(t.effect),this.move.load(t.move),this.number.load(t.number),this.opacity.load(t.opacity),this.shape.load(t.shape),this.size.load(t.size),this.shadow.load(t.shadow),this.zIndex.load(t.zIndex),this.collisions.load(t.collisions),void 0!==t.interactivity&&(this.interactivity=$b45a95be606465d1$export$54e9fb29908872fa({},t.interactivity));let i=t.stroke;if(i&&(this.stroke=$b45a95be606465d1$export$8e5dc47097396754(i,t=>{let e=new $5c0fd158e69038b6$export$18d19c7a3aa33064;return e.load(t),e})),this._container){let e=this._engine.updaters.get(this._container);if(e)for(let i of e)i.loadOptions&&i.loadOptions(this,t);let i=this._engine.interactors.get(this._container);if(i)for(let e of i)e.loadParticlesOptions&&e.loadParticlesOptions(this,t)}}constructor(t,e){this._engine=t,this._container=e,this.bounce=new $2214d3206335440e$export$e6dd54c89cd6ac88,this.collisions=new $a98cc03184daec47$export$97ff58b0eb9a5ed0,this.color=new $337ab9fc72734f0d$export$6f79b6ff75533155,this.color.value="#fff",this.effect=new $abdc6044d8a6cbed$export$a32b0b1c1ac59d04,this.groups={},this.move=new $a520def3cb57325c$export$e49a5ad3dd6df925,this.number=new $102fa49e58184e05$export$2335cf7e85f36cfd,this.opacity=new $5d0f79bab682490f$export$588760baa0f6108e,this.reduceDuplicates=!1,this.shadow=new $a18aec8c47830178$export$a24c14443968327c,this.shape=new $ab81e9a3ab801753$export$6428a7f2611ef1fa,this.size=new $3bcfe5983840bdc3$export$cb6da89c6af1a8ec,this.stroke=new $5c0fd158e69038b6$export$18d19c7a3aa33064,this.zIndex=new $8605ad220374fddc$export$ccb31788083e2069}}function $d7cf199807e58f42$export$cad72087bded938(t,...e){for(let i of e)t.load(i)}function $d7cf199807e58f42$export$3e14721506027822(t,e,...i){let s=new $0916a959da75fe35$export$b4f1619131f0bce9(t,e);return $d7cf199807e58f42$export$cad72087bded938(s,...i),s}class $756c40782ae1b7f7$export$c019608e5b5bb4cb{load(t){var e,i;if($a968daecb9ed97f0$export$630801d484da15df(t))return;void 0!==t.preset&&$b45a95be606465d1$export$8e5dc47097396754(t.preset,t=>this._importPreset(t)),void 0!==t.autoPlay&&(this.autoPlay=t.autoPlay),void 0!==t.clear&&(this.clear=t.clear),void 0!==t.key&&(this.key=t.key),void 0!==t.name&&(this.name=t.name),void 0!==t.delay&&(this.delay=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.delay));let s=t.detectRetina;void 0!==s&&(this.detectRetina=s),void 0!==t.duration&&(this.duration=$b56e0d3a102cc459$export$6dcd5a07b989db7(t.duration));let n=t.fpsLimit;void 0!==n&&(this.fpsLimit=n),void 0!==t.pauseOnBlur&&(this.pauseOnBlur=t.pauseOnBlur),void 0!==t.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=t.pauseOnOutsideViewport),void 0!==t.zLayers&&(this.zLayers=t.zLayers),this.background.load(t.background);let r=t.fullScreen;$a968daecb9ed97f0$export$f9ce7b637dfbe238(r)?this.fullScreen.enable=r:this.fullScreen.load(r),this.backgroundMask.load(t.backgroundMask),this.interactivity.load(t.interactivity),t.manualParticles&&(this.manualParticles=t.manualParticles.map(t=>{let e=new $7d530095dcdc0fa3$export$4f41a3ab9fa8cdf;return e.load(t),e})),this.particles.load(t.particles),this.style=$b45a95be606465d1$export$54e9fb29908872fa(this.style,t.style),this._engine.loadOptions(this,t),void 0!==t.smooth&&(this.smooth=t.smooth);let a=this._engine.interactors.get(this._container);if(a)for(let e of a)e.loadOptions&&e.loadOptions(this,t);if(void 0!==t.responsive)for(let e of t.responsive){let t=new $3e078b33d8dd4ed7$export$49b67f1c7ac91d9b;t.load(e),this.responsive.push(t)}if(this.responsive.sort((t,e)=>t.maxWidth-e.maxWidth),void 0!==t.themes)for(let e of t.themes){let t=this.themes.find(t=>t.name===e.name);if(t)t.load(e);else{let t=new $026e400106b52d32$export$14faa19a0f3bbeb2;t.load(e),this.themes.push(t)}}this.defaultThemes.dark=null==(e=this._findDefaultTheme($daa049cf342b91a4$export$cd01a11ba097c64c.dark))?void 0:e.name,this.defaultThemes.light=null==(i=this._findDefaultTheme($daa049cf342b91a4$export$cd01a11ba097c64c.light))?void 0:i.name}setResponsive(t,e,i){this.load(i);let s=this.responsive.find(i=>i.mode===$b6970044e814ff87$export$73c2705cb2da08ab.screen&&screen?i.maxWidth>screen.availWidth:i.maxWidth*e>t);return this.load(null==s?void 0:s.options),null==s?void 0:s.maxWidth}setTheme(t){if(t){let e=this.themes.find(e=>e.name===t);e&&this.load(e.options)}else{let t=$b45a95be606465d1$export$db32b9574e21e00f("(prefers-color-scheme: dark)"),e=null==t?void 0:t.matches,i=this._findDefaultTheme(e?$daa049cf342b91a4$export$cd01a11ba097c64c.dark:$daa049cf342b91a4$export$cd01a11ba097c64c.light);i&&this.load(i.options)}}constructor(t,e){this._findDefaultTheme=t=>{var e;return null!=(e=this.themes.find(e=>e.default.value&&e.default.mode===t))?e:this.themes.find(t=>t.default.value&&t.default.mode===$daa049cf342b91a4$export$cd01a11ba097c64c.any)},this._importPreset=t=>{this.load(this._engine.getPreset(t))},this._engine=t,this._container=e,this.autoPlay=!0,this.background=new $c0bc863d09255fa5$export$668799e4797757a8,this.backgroundMask=new $5c7d750620b3a538$export$36a2fa1e47ffeebc,this.clear=!0,this.defaultThemes={},this.delay=0,this.fullScreen=new $b1896af52c8fc284$export$f885b95b3f0be76d,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new $00f6eb0d03377349$export$865458a3ba269c4a(t,e),this.manualParticles=[],this.particles=$d7cf199807e58f42$export$3e14721506027822(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}}!function(t){t.external="external",t.particles="particles"}($f046497a552209d8$export$143a800d561d28fd||($f046497a552209d8$export$143a800d561d28fd={}));class $69079d0bdb3d38a9$export$aaa80641d584351c{externalInteract(t){for(let e of this._externalInteractors)e.isEnabled()&&e.interact(t)}handleClickMode(t){var e;for(let i of this._externalInteractors)null==(e=i.handleClickMode)||e.call(i,t)}async init(){for(let t of(this._interactors=await this._engine.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[],this._interactors)){switch(t.type){case $f046497a552209d8$export$143a800d561d28fd.external:this._externalInteractors.push(t);break;case $f046497a552209d8$export$143a800d561d28fd.particles:this._particleInteractors.push(t)}t.init()}}particlesInteract(t,e){for(let i of this._externalInteractors)i.clear(t,e);for(let i of this._particleInteractors)i.isEnabled(t)&&i.interact(t,e)}reset(t){for(let e of this._externalInteractors)e.isEnabled()&&e.reset(t);for(let e of this._particleInteractors)e.isEnabled(t)&&e.reset(t)}constructor(t,e){this.container=e,this._engine=t,this._interactors=[],this._externalInteractors=[],this._particleInteractors=[]}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM");function $f132da2704a9b279$var$loadEffectData(t,e,i,s){let n=e.options[t];if(n)return $b45a95be606465d1$export$54e9fb29908872fa({close:e.close,fill:e.fill},$b45a95be606465d1$export$3fbf39566d3ee62e(n,i,s))}function $f132da2704a9b279$var$loadShapeData(t,e,i,s){let n=e.options[t];if(n)return $b45a95be606465d1$export$54e9fb29908872fa({close:e.close,fill:e.fill},$b45a95be606465d1$export$3fbf39566d3ee62e(n,i,s))}function $f132da2704a9b279$var$fixOutMode(t){if(!$b45a95be606465d1$export$5e9bb4359042e24b(t.outMode,t.checkModes))return;let e=t.radius*$c9c3248b3c6a9599$export$7b3cbda67be88f5f;t.coord>t.maxCoord-e?t.setCb(-t.radius):t.coord<e&&t.setCb(t.radius)}!function(t){t.normal="normal",t.inside="inside",t.outside="outside"}($fddb00d16107a6f8$export$2e559b10bdb6bb80||($fddb00d16107a6f8$export$2e559b10bdb6bb80={}));class $f132da2704a9b279$export$c36c68baa13912a5{destroy(t){var e,i,s;if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;let n=this.container,r=this.pathGenerator,a=n.shapeDrawers.get(this.shape);for(let s of(null==a||null==(e=a.particleDestroy)||e.call(a,this),n.plugins.values()))null==(i=s.particleDestroyed)||i.call(s,this,t);for(let e of n.particles.updaters)null==(s=e.particleDestroyed)||s.call(e,this,t);null==r||r.reset(this),this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.particleDestroyed,{container:this.container,data:{particle:this}})}draw(t){let e=this.container,i=e.canvas;for(let s of e.plugins.values())i.drawParticlePlugin(s,this,t);i.drawParticle(this,t)}getFillColor(){var t;return this._getRollColor(null!=(t=this.bubble.color)?t:$18414f5f1f9fa88c$export$c90768c73bc1d7ab(this.color))}getMass(){return this.getRadius()**$c9c3248b3c6a9599$export$69af1894d00750e2*Math.PI*$c9c3248b3c6a9599$export$3ced024fb15e6103}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){var t;return null!=(t=this.bubble.radius)?t:this.size.value}getStrokeColor(){var t;return this._getRollColor(null!=(t=this.bubble.color)?t:$18414f5f1f9fa88c$export$c90768c73bc1d7ab(this.strokeColor))}init(t,e,i,s){var n,r,a,o,l,h,c,d,p,u;let g=this.container,m=this._engine;this.id=t,this.group=s,this.effectClose=!0,this.effectFill=!0,this.shapeClose=!0,this.shapeFill=!0,this.pathRotation=!1,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.isRotating=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType=$fddb00d16107a6f8$export$2e559b10bdb6bb80.normal,this.ignoresResizeRatio=!0;let f=g.retina.pixelRatio,y=g.actualOptions,v=$d7cf199807e58f42$export$3e14721506027822(this._engine,g,y.particles),{reduceDuplicates:x}=v,b=v.effect.type,w=v.shape.type;this.effect=$b45a95be606465d1$export$3fbf39566d3ee62e(b,this.id,x),this.shape=$b45a95be606465d1$export$3fbf39566d3ee62e(w,this.id,x);let B=v.effect,S=v.shape;if(i){if(null==(l=i.effect)?void 0:l.type){let t=$b45a95be606465d1$export$3fbf39566d3ee62e(i.effect.type,this.id,x);t&&(this.effect=t,B.load(i.effect))}if(null==(h=i.shape)?void 0:h.type){let t=$b45a95be606465d1$export$3fbf39566d3ee62e(i.shape.type,this.id,x);t&&(this.shape=t,S.load(i.shape))}}if(this.effect===$c9c3248b3c6a9599$export$2f8238aef5a0a8eb){let t=[...this.container.effectDrawers.keys()];this.effect=t[Math.floor($b56e0d3a102cc459$export$1a76347094524b3b()*t.length)]}if(this.shape===$c9c3248b3c6a9599$export$2f8238aef5a0a8eb){let t=[...this.container.shapeDrawers.keys()];this.shape=t[Math.floor($b56e0d3a102cc459$export$1a76347094524b3b()*t.length)]}this.effectData=$f132da2704a9b279$var$loadEffectData(this.effect,B,this.id,x),this.shapeData=$f132da2704a9b279$var$loadShapeData(this.shape,S,this.id,x),v.load(i);let C=this.effectData;C&&v.load(C.particles);let E=this.shapeData;E&&v.load(E.particles);let k=new $00f6eb0d03377349$export$865458a3ba269c4a(m,g);k.load(g.actualOptions.interactivity),k.load(v.interactivity),this.interactivity=k,this.effectFill=null!=(c=null==C?void 0:C.fill)?c:v.effect.fill,this.effectClose=null!=(d=null==C?void 0:C.close)?d:v.effect.close,this.shapeFill=null!=(p=null==E?void 0:E.fill)?p:v.shape.fill,this.shapeClose=null!=(u=null==E?void 0:E.close)?u:v.shape.close,this.options=v;let I=this.options.move.path;this.pathDelay=$b56e0d3a102cc459$export$e70c64b68236cb4e(I.delay.value)*$c9c3248b3c6a9599$export$f64c3bfbc58eec0f,I.generator&&(this.pathGenerator=this._engine.getPathGenerator(I.generator),this.pathGenerator&&g.addPath(I.generator,this.pathGenerator)&&this.pathGenerator.init(g)),g.retina.initParticle(this),this.size=$b45a95be606465d1$export$bebd78259cce4fd(this.options.size,f),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(e),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=$c9c3248b3c6a9599$export$a05b467d53228ab9-$b56e0d3a102cc459$export$e70c64b68236cb4e(this.options.move.decay);let T=g.particles;T.setLastZIndex(this.position.z),this.zIndexFactor=this.position.z/g.zLayers,this.sides=24;let M=g.effectDrawers.get(this.effect);!M&&(M=this._engine.getEffectDrawer(this.effect))&&g.effectDrawers.set(this.effect,M),(null==M?void 0:M.loadEffect)&&M.loadEffect(this);let P=g.shapeDrawers.get(this.shape);!P&&(P=this._engine.getShapeDrawer(this.shape))&&g.shapeDrawers.set(this.shape,P),(null==P?void 0:P.loadShape)&&P.loadShape(this);let L=null==P?void 0:P.getSidesCount;for(let t of(L&&(this.sides=L(this)),this.spawning=!1,this.shadowColor=$18414f5f1f9fa88c$export$fbf0bf3cc1fc0cc4(this._engine,this.options.shadow.color),T.updaters))t.init(this);for(let t of T.movers)null==(n=t.init)||n.call(t,this);for(let t of(null==M||null==(r=M.particleInit)||r.call(M,g,this),null==P||null==(a=P.particleInit)||a.call(P,g,this),g.plugins.values()))null==(o=t.particleCreated)||o.call(t,this)}isInsideCanvas(){let t=this.getRadius(),e=this.container.canvas.size,i=this.position;return i.x>=-t&&i.y>=-t&&i.y<=e.height+t&&i.x<=e.width+t}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){var t;for(let e of this.container.particles.updaters)null==(t=e.reset)||t.call(e,this)}constructor(t,e){this.container=e,this._calcPosition=(t,e,i,s=$c9c3248b3c6a9599$export$b0d937bb246b1db5)=>{var n,r,a,o;for(let s of t.plugins.values()){let t=void 0!==s.particlePosition?s.particlePosition(e,this):void 0;if(t)return $dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(t.x,t.y,i)}let l=$b56e0d3a102cc459$export$a3c87c98a736c457({size:t.canvas.size,position:e}),h=$dba6a6bdb7cfdc8a$export$ece015703618ce3d.create(l.x,l.y,i),c=this.getRadius(),d=this.options.move.outModes,p=e=>{$f132da2704a9b279$var$fixOutMode({outMode:e,checkModes:[$082579e39391a6a4$export$cf5942d9a76b7ae2.bounce],coord:h.x,maxCoord:t.canvas.size.width,setCb:t=>h.x+=t,radius:c})},u=e=>{$f132da2704a9b279$var$fixOutMode({outMode:e,checkModes:[$082579e39391a6a4$export$cf5942d9a76b7ae2.bounce],coord:h.y,maxCoord:t.canvas.size.height,setCb:t=>h.y+=t,radius:c})};return(p(null!=(n=d.left)?n:d.default),p(null!=(r=d.right)?r:d.default),u(null!=(a=d.top)?a:d.default),u(null!=(o=d.bottom)?o:d.default),this._checkOverlap(h,s))?this._calcPosition(t,void 0,i,s+$c9c3248b3c6a9599$export$c6a00718c1294b26):h},this._calculateVelocity=()=>{let t=$b56e0d3a102cc459$export$cce6f12debc4024a(this.direction).copy(),e=this.options.move;if(e.direction===$219efb580e609ac5$export$cc1a246adca07dd4.inside||e.direction===$219efb580e609ac5$export$cc1a246adca07dd4.outside)return t;let i=$b56e0d3a102cc459$export$e6bfdeff8bfc94f9($b56e0d3a102cc459$export$e70c64b68236cb4e(e.angle.value)),s=$b56e0d3a102cc459$export$e6bfdeff8bfc94f9($b56e0d3a102cc459$export$e70c64b68236cb4e(e.angle.offset)),n={left:s-i*$c9c3248b3c6a9599$export$3ced024fb15e6103,right:s+i*$c9c3248b3c6a9599$export$3ced024fb15e6103};return e.straight||(t.angle+=$b56e0d3a102cc459$export$8b958c8ecd94a804($b56e0d3a102cc459$export$6dcd5a07b989db7(n.left,n.right))),e.random&&"number"==typeof e.speed&&(t.length*=$b56e0d3a102cc459$export$1a76347094524b3b()),t},this._checkOverlap=(t,e=$c9c3248b3c6a9599$export$b0d937bb246b1db5)=>{let i=this.options.collisions,s=this.getRadius();if(!i.enable)return!1;let n=i.overlap;if(n.enable)return!1;let r=n.retries;if(r>=$c9c3248b3c6a9599$export$9ad4c81d91619fd0&&e>r)throw Error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} particle is overlapping and can't be placed`);return!!this.container.particles.find(e=>$b56e0d3a102cc459$export$79376507b09a66f(t,e.position)<s+e.getRadius())},this._getRollColor=t=>{var e;if(!t||!this.roll||!this.backColor&&!this.roll.alter)return t;let i=this.roll.horizontal&&this.roll.vertical?$c9c3248b3c6a9599$export$7b3cbda67be88f5f*$c9c3248b3c6a9599$export$40d4bf4da5fab6a3:$c9c3248b3c6a9599$export$40d4bf4da5fab6a3,s=this.roll.horizontal?Math.PI*$c9c3248b3c6a9599$export$3ced024fb15e6103:$c9c3248b3c6a9599$export$f883a24d5edde77c;return Math.floor(((null!=(e=this.roll.angle)?e:$c9c3248b3c6a9599$export$f883a24d5edde77c)+s)/(Math.PI/i))%$c9c3248b3c6a9599$export$7b3cbda67be88f5f?this.backColor?this.backColor:this.roll.alter?$9351e8aae3844c9d$export$fe1d034b0e82666(t,this.roll.alter.type,this.roll.alter.value):t:t},this._initPosition=t=>{var e,i;let s=this.container,n=$b56e0d3a102cc459$export$e70c64b68236cb4e(this.options.zIndex.value);this.position=this._calcPosition(s,t,$b56e0d3a102cc459$export$7d15b64cf5a3a4c4(n,$c9c3248b3c6a9599$export$ce94e349d95a214c,s.zLayers)),this.initialPosition=this.position.copy();let r=s.canvas.size;switch(this.moveCenter=(0,$9FMZM._)((0,$wpIFA._)({},$b45a95be606465d1$export$1690e12b840569b9(this.options.move.center,r)),{radius:null!=(e=this.options.move.center.radius)?e:$c9c3248b3c6a9599$export$7dab3a147ef97e31,mode:null!=(i=this.options.move.center.mode)?i:$646f0f1b6fd77518$export$1009f0178778a981.percent}),this.direction=$b56e0d3a102cc459$export$2045f76df51d18c4(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case $219efb580e609ac5$export$cc1a246adca07dd4.inside:this.outType=$fddb00d16107a6f8$export$2e559b10bdb6bb80.inside;break;case $219efb580e609ac5$export$cc1a246adca07dd4.outside:this.outType=$fddb00d16107a6f8$export$2e559b10bdb6bb80.outside}this.offset=$dba6a6bdb7cfdc8a$export$9b781de7bf37bf48.origin},this._engine=t}}class $8cb701b15c7295b4$export$baf26146a414f24a{constructor(t,e){this.position=t,this.particle=e}}!function(t){t.circle="circle",t.rectangle="rectangle"}($b3e19d81d874cda5$export$2ede450fbdbb4e4c||($b3e19d81d874cda5$export$2ede450fbdbb4e4c={}));class $025b869a51baaf34$export$f237afe0deab98f9{constructor(t,e,i){this.position={x:t,y:e},this.type=i}}class $025b869a51baaf34$export$c89a927ffc67e6fa extends $025b869a51baaf34$export$f237afe0deab98f9{contains(t){return $b56e0d3a102cc459$export$79376507b09a66f(t,this.position)<=this.radius}intersects(t){let e=this.position,i=t.position,s={x:Math.abs(i.x-e.x),y:Math.abs(i.y-e.y)},n=this.radius;if(t instanceof $025b869a51baaf34$export$c89a927ffc67e6fa||t.type===$b3e19d81d874cda5$export$2ede450fbdbb4e4c.circle)return n+t.radius>Math.sqrt(s.x**$c9c3248b3c6a9599$export$69af1894d00750e2+s.y**$c9c3248b3c6a9599$export$69af1894d00750e2);if(t instanceof $025b869a51baaf34$export$4617fb02663045ef||t.type===$b3e19d81d874cda5$export$2ede450fbdbb4e4c.rectangle){let{width:e,height:i}=t.size;return Math.pow(s.x-e,$c9c3248b3c6a9599$export$69af1894d00750e2)+Math.pow(s.y-i,$c9c3248b3c6a9599$export$69af1894d00750e2)<=n**$c9c3248b3c6a9599$export$69af1894d00750e2||s.x<=n+e&&s.y<=n+i||s.x<=e||s.y<=i}return!1}constructor(t,e,i){super(t,e,$b3e19d81d874cda5$export$2ede450fbdbb4e4c.circle),this.radius=i}}class $025b869a51baaf34$export$4617fb02663045ef extends $025b869a51baaf34$export$f237afe0deab98f9{contains(t){let e=this.size.width,i=this.size.height,s=this.position;return t.x>=s.x&&t.x<=s.x+e&&t.y>=s.y&&t.y<=s.y+i}intersects(t){if(t instanceof $025b869a51baaf34$export$c89a927ffc67e6fa)return t.intersects(this);let e=this.size.width,i=this.size.height,s=this.position,n=t.position,r=t instanceof $025b869a51baaf34$export$4617fb02663045ef?t.size:{width:0,height:0},a=r.width,o=r.height;return n.x<s.x+e&&n.x+a>s.x&&n.y<s.y+i&&n.y+o>s.y}constructor(t,e,i,s){super(t,e,$b3e19d81d874cda5$export$2ede450fbdbb4e4c.rectangle),this.size={height:s,width:i}}}class $9e1ab5ba27924a87$export$b82688eb02220411{insert(t){return!!this.rectangle.contains(t.position)&&(this._points.length<this.capacity?(this._points.push(t),!0):(this._divided||this._subdivide(),this._subs.some(e=>e.insert(t))))}query(t,e){let i=[];if(!t.intersects(this.rectangle))return[];for(let s of this._points)!t.contains(s.position)&&$b56e0d3a102cc459$export$79376507b09a66f(t.position,s.position)>s.particle.getRadius()&&(!e||e(s.particle))||i.push(s.particle);if(this._divided)for(let s of this._subs)i.push(...s.query(t,e));return i}queryCircle(t,e,i){return this.query(new $025b869a51baaf34$export$c89a927ffc67e6fa(t.x,t.y,e),i)}queryRectangle(t,e,i){return this.query(new $025b869a51baaf34$export$4617fb02663045ef(t.x,t.y,e.width,e.height),i)}constructor(t,e){this.rectangle=t,this.capacity=e,this._subdivide=()=>{let{x:t,y:e}=this.rectangle.position,{width:i,height:s}=this.rectangle.size,{capacity:n}=this;for(let r=0;r<$c9c3248b3c6a9599$export$857680dbc0592f23;r++){let a=r%$c9c3248b3c6a9599$export$7b3cbda67be88f5f;this._subs.push(new $9e1ab5ba27924a87$export$b82688eb02220411(new $025b869a51baaf34$export$4617fb02663045ef(t+i*$c9c3248b3c6a9599$export$3ced024fb15e6103*a,e+s*$c9c3248b3c6a9599$export$3ced024fb15e6103*(Math.round(r*$c9c3248b3c6a9599$export$3ced024fb15e6103)-a),i*$c9c3248b3c6a9599$export$3ced024fb15e6103,s*$c9c3248b3c6a9599$export$3ced024fb15e6103),n))}this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}}let $e3626c2f1acf57c9$var$qTreeRectangle=t=>{let{height:e,width:i}=t;return new $025b869a51baaf34$export$4617fb02663045ef($c9c3248b3c6a9599$export$3824525d016aa873*i,$c9c3248b3c6a9599$export$3824525d016aa873*e,$c9c3248b3c6a9599$export$59892a8b616aa484*i,$c9c3248b3c6a9599$export$59892a8b616aa484*e)};class $e3626c2f1acf57c9$export$ec4bceef241d2e36{get count(){return this._array.length}addManualParticles(){let t=this._container;t.actualOptions.manualParticles.forEach(e=>this.addParticle(e.position?$b45a95be606465d1$export$1690e12b840569b9(e.position,t.canvas.size):void 0,e.options))}addParticle(t,e,i,s){var n;let r=this._container.actualOptions.particles.number.limit.mode,a=void 0===i?this._limit:null!=(n=this._groupLimits.get(i))?n:this._limit,o=this.count;if(a>$c9c3248b3c6a9599$export$e82fde291e144b99)switch(r){case $c92fcd34ca9c4923$export$e9c6a0495dc4055f.delete:{let t=o+$c9c3248b3c6a9599$export$1fe1264f46963094-a;t>$c9c3248b3c6a9599$export$da4e5697b3441fa1&&this.removeQuantity(t);break}case $c92fcd34ca9c4923$export$e9c6a0495dc4055f.wait:if(o>=a)return}return this._pushParticle(t,e,i,s)}clear(){this._array=[],this._zArray=[],this._pluginsInitialized=!1}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}draw(t){let e=this._container,i=e.canvas;for(let s of(i.clear(),this.update(t),e.plugins.values()))i.drawPlugin(s,t);for(let e of this._zArray)e.draw(t)}filter(t){return this._array.filter(t)}find(t){return this._array.find(t)}get(t){return this._array[t]}handleClickMode(t){this._interactionManager.handleClickMode(t)}async init(){var t,e,i;let s=this._container,n=s.actualOptions;this._lastZIndex=0,this._needsSort=!1,await this.initPlugins();let r=!1;for(let i of s.plugins.values())if(r=null!=(e=null==(t=i.particlesInitialization)?void 0:t.call(i))?e:r)break;if(this.addManualParticles(),!r){let t=n.particles,e=t.groups;for(let s in e){let n=e[s];for(let e=this.count,r=0;r<(null==(i=n.number)?void 0:i.value)&&e<t.number.value;e++,r++)this.addParticle(void 0,n,s)}for(let e=this.count;e<t.number.value;e++)this.addParticle()}}async initPlugins(){if(this._pluginsInitialized)return;let t=this._container;for(let e of(this.movers=await this._engine.getMovers(t,!0),this.updaters=await this._engine.getUpdaters(t,!0),await this._interactionManager.init(),t.pathGenerators.values()))e.init(t)}push(t,e,i,s){for(let n=0;n<t;n++)this.addParticle(null==e?void 0:e.position,i,s)}async redraw(){this.clear(),await this.init(),this.draw({value:0,factor:0})}remove(t,e,i){this.removeAt(this._array.indexOf(t),void 0,e,i)}removeAt(t,e=$c9c3248b3c6a9599$export$1f93977e73a42602,i,s){if(t<$c9c3248b3c6a9599$export$e410eba367ce792b||t>this.count)return;let n=0;for(let r=t;n<e&&r<this.count;r++)this._removeParticle(r,i,s)&&(r--,n++)}removeQuantity(t,e){this.removeAt($c9c3248b3c6a9599$export$e410eba367ce792b,t,e)}setDensity(){let t=this._container.actualOptions,e=t.particles.groups,i=t.manualParticles.length;for(let t in e)this._applyDensity(e[t],i,t);this._applyDensity(t.particles,i)}setLastZIndex(t){this._lastZIndex=t,this._needsSort=this._needsSort||this._lastZIndex<t}setResizeFactor(t){this._resizeFactor=t}update(t){var e,i;let s=this._container,n=new Set;for(let t of(this.quadTree=new $9e1ab5ba27924a87$export$b82688eb02220411($e3626c2f1acf57c9$var$qTreeRectangle(s.canvas.size),$c9c3248b3c6a9599$export$ff9931f04b025271),s.pathGenerators.values()))t.update();for(let i of s.plugins.values())null==(e=i.update)||e.call(i,t);let r=this._resizeFactor;for(let e of this._array){for(let s of(r&&!e.ignoresResizeRatio&&(e.position.x*=r.width,e.position.y*=r.height,e.initialPosition.x*=r.width,e.initialPosition.y*=r.height),e.ignoresResizeRatio=!1,this._interactionManager.reset(e),this._container.plugins.values())){if(e.destroyed)break;null==(i=s.particleUpdate)||i.call(s,e,t)}for(let i of this.movers)i.isEnabled(e)&&i.move(e,t);if(e.destroyed){n.add(e);continue}this.quadTree.insert(new $8cb701b15c7295b4$export$baf26146a414f24a(e.getPosition(),e))}if(n.size){let t=t=>!n.has(t);for(let e of(this._array=this.filter(t),this._zArray=this._zArray.filter(t),n))this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.particleRemoved,{container:this._container,data:{particle:e}});this._addToPool(...n)}for(let e of(this._interactionManager.externalInteract(t),this._array)){for(let i of this.updaters)i.update(e,t);e.destroyed||e.spawning||this._interactionManager.particlesInteract(e,t)}if(delete this._resizeFactor,this._needsSort){let t=this._zArray;t.sort((t,e)=>e.position.z-t.position.z||t.id-e.id),this._lastZIndex=t[t.length-$c9c3248b3c6a9599$export$4a5b9680be542cf8].position.z,this._needsSort=!1}}constructor(t,e){this._addToPool=(...t)=>{this._pool.push(...t)},this._applyDensity=(t,e,i,s)=>{var n,r,a,o,l;let h=t.number;if(!(null==(n=t.number.density)?void 0:n.enable))return void(void 0===i?this._limit=h.limit.value:(null!=(o=null==s||null==(r=s.number.limit)?void 0:r.value)?o:h.limit.value)&&this._groupLimits.set(i,null!=(l=null==s||null==(a=s.number.limit)?void 0:a.value)?l:h.limit.value));let c=this._initDensityFactor(h.density),d=h.value,p=h.limit.value>$c9c3248b3c6a9599$export$e82fde291e144b99?h.limit.value:d,u=Math.min(d,p)*c+e,g=Math.min(this.count,this.filter(t=>t.group===i).length);void 0===i?this._limit=h.limit.value*c:this._groupLimits.set(i,h.limit.value*c),g<u?this.push(Math.abs(u-g),void 0,t,i):g>u&&this.removeQuantity(g-u,i)},this._initDensityFactor=t=>{let e=this._container;if(!e.canvas.element||!t.enable)return $c9c3248b3c6a9599$export$9b262e3383f198e7;let i=e.canvas.element,s=e.retina.pixelRatio;return i.width*i.height/(t.height*t.width*s**$c9c3248b3c6a9599$export$69af1894d00750e2)},this._pushParticle=(t,e,i,s)=>{try{let n=this._pool.pop();n||(n=new $f132da2704a9b279$export$c36c68baa13912a5(this._engine,this._container)),n.init(this._nextId,t,e,i);let r=!0;if(s&&(r=s(n)),!r)return;return this._array.push(n),this._zArray.push(n),this._nextId++,this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.particleAdded,{container:this._container,data:{particle:n}}),n}catch(t){$b45a95be606465d1$export$2b1d391cd05230fd().warning(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} adding particle: ${t}`)}},this._removeParticle=(t,e,i)=>{let s=this._array[t];if(!s||s.group!==e)return!1;let n=this._zArray.indexOf(s);return this._array.splice(t,$c9c3248b3c6a9599$export$346cdd8493ece6c8),this._zArray.splice(n,$c9c3248b3c6a9599$export$346cdd8493ece6c8),s.destroy(i),this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.particleRemoved,{container:this._container,data:{particle:s}}),this._addToPool(s),!0},this._engine=t,this._container=e,this._nextId=0,this._array=[],this._zArray=[],this._pool=[],this._limit=0,this._groupLimits=new Map,this._needsSort=!1,this._lastZIndex=0,this._interactionManager=new $69079d0bdb3d38a9$export$aaa80641d584351c(t,e),this._pluginsInitialized=!1;let i=e.canvas.size;this.quadTree=new $9e1ab5ba27924a87$export$b82688eb02220411($e3626c2f1acf57c9$var$qTreeRectangle(i),$c9c3248b3c6a9599$export$ff9931f04b025271),this.movers=[],this.updaters=[]}}class $8482ed70c92d4f24$export$b7a992a6d33e9eff{init(){let t=this.container,e=t.actualOptions;this.pixelRatio=!e.detectRetina||$b45a95be606465d1$export$460b6777813d3d86()?$c9c3248b3c6a9599$export$728175ae61348876:devicePixelRatio,this.reduceFactor=$c9c3248b3c6a9599$export$7e2d520c66b9f331;let i=this.pixelRatio,s=t.canvas;if(s.element){let t=s.element;s.size.width=t.offsetWidth*i,s.size.height=t.offsetHeight*i}let n=e.particles,r=n.move;this.maxSpeed=$b56e0d3a102cc459$export$e70c64b68236cb4e(r.gravity.maxSpeed)*i,this.sizeAnimationSpeed=$b56e0d3a102cc459$export$e70c64b68236cb4e(n.size.animation.speed)*i}initParticle(t){let e=t.options,i=this.pixelRatio,s=e.move,n=s.distance,r=t.retina;r.moveDrift=$b56e0d3a102cc459$export$e70c64b68236cb4e(s.drift)*i,r.moveSpeed=$b56e0d3a102cc459$export$e70c64b68236cb4e(s.speed)*i,r.sizeAnimationSpeed=$b56e0d3a102cc459$export$e70c64b68236cb4e(e.size.animation.speed)*i;let a=r.maxDistance;a.horizontal=void 0!==n.horizontal?n.horizontal*i:void 0,a.vertical=void 0!==n.vertical?n.vertical*i:void 0,r.maxSpeed=$b56e0d3a102cc459$export$e70c64b68236cb4e(s.gravity.maxSpeed)*i}constructor(t){this.container=t,this.pixelRatio=$c9c3248b3c6a9599$export$728175ae61348876,this.reduceFactor=$c9c3248b3c6a9599$export$7e2d520c66b9f331}}function $570112e41b53c4df$var$guardCheck(t){return t&&!t.destroyed}function $570112e41b53c4df$var$initDelta(t,e=$c9c3248b3c6a9599$export$a58a85a1d96b5da5,i=!1){return{value:t,factor:i?$c9c3248b3c6a9599$export$a58a85a1d96b5da5/e:$c9c3248b3c6a9599$export$a58a85a1d96b5da5*t/$c9c3248b3c6a9599$export$f64c3bfbc58eec0f}}function $570112e41b53c4df$var$loadContainerOptions(t,e,...i){let s=new $756c40782ae1b7f7$export$c019608e5b5bb4cb(t,e);return $d7cf199807e58f42$export$cad72087bded938(s,...i),s}class $570112e41b53c4df$export$42a852a2b6b56249{get animationStatus(){return!this._paused&&!this.pageHidden&&$570112e41b53c4df$var$guardCheck(this)}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(t){if(!$570112e41b53c4df$var$guardCheck(this))return;let e=this.interactivity.element;if(!e)return;let i=(e,i,s)=>{if(!$570112e41b53c4df$var$guardCheck(this))return;let n=this.retina.pixelRatio,r={x:i.x*n,y:i.y*n};t(e,this.particles.quadTree.queryCircle(r,s*n))},s=t=>{if(!$570112e41b53c4df$var$guardCheck(this))return;let e=t;i(t,{x:e.offsetX||e.clientX,y:e.offsetY||e.clientY},$c9c3248b3c6a9599$export$ed597c6eb324bc8f)},n=()=>{$570112e41b53c4df$var$guardCheck(this)&&(l=!0,h=!1)},r=()=>{$570112e41b53c4df$var$guardCheck(this)&&(h=!0)},a=t=>{if($570112e41b53c4df$var$guardCheck(this)){if(l&&!h){let e=t,s=e.touches[e.touches.length-$c9c3248b3c6a9599$export$7a917036bd0c18e0];if(!s&&!(s=e.changedTouches[e.changedTouches.length-$c9c3248b3c6a9599$export$7a917036bd0c18e0]))return;let n=this.canvas.element,r=n?n.getBoundingClientRect():void 0;i(t,{x:s.clientX-(r?r.left:$c9c3248b3c6a9599$export$17c6bab6aae4c3d),y:s.clientY-(r?r.top:$c9c3248b3c6a9599$export$17c6bab6aae4c3d)},Math.max(s.radiusX,s.radiusY))}l=!1,h=!1}},o=()=>{$570112e41b53c4df$var$guardCheck(this)&&(l=!1,h=!1)},l=!1,h=!1;for(let[t,i]of(this._clickHandlers.set("click",s),this._clickHandlers.set("touchstart",n),this._clickHandlers.set("touchmove",r),this._clickHandlers.set("touchend",a),this._clickHandlers.set("touchcancel",o),this._clickHandlers))e.addEventListener(t,i)}addLifeTime(t){this._lifeTime+=t}addPath(t,e,i=!1){return!(!$570112e41b53c4df$var$guardCheck(this)||!i&&this.pathGenerators.has(t))&&(this.pathGenerators.set(t,e),!0)}alive(){return!this._duration||this._lifeTime<=this._duration}clearClickHandlers(){var t;if($570112e41b53c4df$var$guardCheck(this)){for(let[e,i]of this._clickHandlers)null==(t=this.interactivity.element)||t.removeEventListener(e,i);this._clickHandlers.clear()}}destroy(t=!0){var e,i;if($570112e41b53c4df$var$guardCheck(this)){for(let t of(this.stop(),this.clearClickHandlers(),this.particles.destroy(),this.canvas.destroy(),this.effectDrawers.values()))null==(e=t.destroy)||e.call(t,this);for(let t of this.shapeDrawers.values())null==(i=t.destroy)||i.call(t,this);for(let t of this.effectDrawers.keys())this.effectDrawers.delete(t);for(let t of this.shapeDrawers.keys())this.shapeDrawers.delete(t);if(this._engine.clearPlugins(this),this.destroyed=!0,t){let t=this._engine.items,e=t.findIndex(t=>t===this);e>=$c9c3248b3c6a9599$export$6347387141f4c7b9&&t.splice(e,$c9c3248b3c6a9599$export$310c6557edf6330f)}this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerDestroyed,{container:this})}}draw(t){if(!$570112e41b53c4df$var$guardCheck(this))return;let e=t,i=t=>{e&&(this._lastFrameTime=void 0,e=!1),this._nextFrame(t)};this._drawAnimationFrame=$b56e0d3a102cc459$export$e3607ec2d7a891c4(t=>i(t))}async export(t,e={}){for(let i of this.plugins.values()){if(!i.export)continue;let s=await i.export(t,e);if(s.supported)return s.blob}$b45a95be606465d1$export$2b1d391cd05230fd().error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} - Export plugin with type ${t} not found`)}handleClickMode(t){var e;if($570112e41b53c4df$var$guardCheck(this))for(let i of(this.particles.handleClickMode(t),this.plugins.values()))null==(e=i.handleClickMode)||e.call(i,t)}async init(){var t,e,i,s;if(!$570112e41b53c4df$var$guardCheck(this))return;for(let t of this._engine.getSupportedEffects()){let e=this._engine.getEffectDrawer(t);e&&this.effectDrawers.set(t,e)}for(let t of this._engine.getSupportedShapes()){let e=this._engine.getShapeDrawer(t);e&&this.shapeDrawers.set(t,e)}for(let[t,e]of(await this.particles.initPlugins(),this._options=$570112e41b53c4df$var$loadContainerOptions(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=$570112e41b53c4df$var$loadContainerOptions(this._engine,this,this._options),await this._engine.getAvailablePlugins(this)))this.plugins.set(t,e);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize();let{zLayers:n,duration:r,delay:a,fpsLimit:o,smooth:l}=this.actualOptions;for(let e of(this.zLayers=n,this._duration=$b56e0d3a102cc459$export$e70c64b68236cb4e(r)*$c9c3248b3c6a9599$export$f64c3bfbc58eec0f,this._delay=$b56e0d3a102cc459$export$e70c64b68236cb4e(a)*$c9c3248b3c6a9599$export$f64c3bfbc58eec0f,this._lifeTime=0,this.fpsLimit=o>$c9c3248b3c6a9599$export$1f9ec247b9f4a442?o:$c9c3248b3c6a9599$export$a1db07711c3c21cf,this._smooth=l,this.effectDrawers.values()))await (null==(t=e.init)?void 0:t.call(e,this));for(let t of this.shapeDrawers.values())await (null==(e=t.init)?void 0:e.call(t,this));for(let t of this.plugins.values())await (null==(i=t.init)?void 0:i.call(t));for(let t of(this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerInit,{container:this}),await this.particles.init(),this.particles.setDensity(),this.plugins.values()))null==(s=t.particlesSetup)||s.call(t);this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.particlesSetup,{container:this})}async loadTheme(t){$570112e41b53c4df$var$guardCheck(this)&&(this._currentTheme=t,await this.refresh())}pause(){var t;if($570112e41b53c4df$var$guardCheck(this)&&(void 0!==this._drawAnimationFrame&&($b56e0d3a102cc459$export$623ab1da75e685de(this._drawAnimationFrame),delete this._drawAnimationFrame),!this._paused)){for(let e of this.plugins.values())null==(t=e.pause)||t.call(e);this.pageHidden||(this._paused=!0),this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerPaused,{container:this})}}play(t){if(!$570112e41b53c4df$var$guardCheck(this))return;let e=this._paused||t;if(this._firstStart&&!this.actualOptions.autoPlay){this._firstStart=!1;return}if(this._paused&&(this._paused=!1),e)for(let t of this.plugins.values())t.play&&t.play();this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerPlay,{container:this}),this.draw(null!=e&&e)}async refresh(){if($570112e41b53c4df$var$guardCheck(this))return this.stop(),this.start()}async reset(t){if($570112e41b53c4df$var$guardCheck(this))return this._initialSourceOptions=t,this._sourceOptions=t,this._options=$570112e41b53c4df$var$loadContainerOptions(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=$570112e41b53c4df$var$loadContainerOptions(this._engine,this,this._options),this.refresh()}async start(){$570112e41b53c4df$var$guardCheck(this)&&!this.started&&(await this.init(),this.started=!0,await new Promise(t=>{let e=async()=>{var e;for(let t of(this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element),this.plugins.values()))await (null==(e=t.start)?void 0:e.call(t));this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerStarted,{container:this}),this.play(),t()};this._delayTimeout=setTimeout(()=>void e(),this._delay)}))}stop(){var t;if($570112e41b53c4df$var$guardCheck(this)&&this.started){for(let e of(this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element),this.plugins.values()))null==(t=e.stop)||t.call(e);for(let t of this.plugins.keys())this.plugins.delete(t);this._sourceOptions=this._options,this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerStopped,{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];let t=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this._responsiveMaxWidth!==t&&(this._responsiveMaxWidth=t,!0)}constructor(t,e,i){this._intersectionManager=t=>{if($570112e41b53c4df$var$guardCheck(this)&&this.actualOptions.pauseOnOutsideViewport)for(let e of t)e.target===this.interactivity.element&&(e.isIntersecting?this.play():this.pause())},this._nextFrame=t=>{try{var e;if(!this._smooth&&void 0!==this._lastFrameTime&&t<this._lastFrameTime+$c9c3248b3c6a9599$export$f64c3bfbc58eec0f/this.fpsLimit)return void this.draw(!1);null!=(e=this._lastFrameTime)||(this._lastFrameTime=t);let i=$570112e41b53c4df$var$initDelta(t-this._lastFrameTime,this.fpsLimit,this._smooth);if(this.addLifeTime(i.value),this._lastFrameTime=t,i.value>$c9c3248b3c6a9599$export$f64c3bfbc58eec0f)return void this.draw(!1);if(this.particles.draw(i),!this.alive())return void this.destroy();this.animationStatus&&this.draw(!1)}catch(t){$b45a95be606465d1$export$2b1d391cd05230fd().error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} in animation loop`,t)}},this._engine=t,this.id=Symbol(e),this.fpsLimit=120,this._smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this._lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._clickHandlers=new Map,this._sourceOptions=i,this._initialSourceOptions=i,this.retina=new $8482ed70c92d4f24$export$b7a992a6d33e9eff(this),this.canvas=new $3f9ba00c5b85c46c$export$8d01c972ee8b14a9(this,this._engine),this.particles=new $e3626c2f1acf57c9$export$ec4bceef241d2e36(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this._options=$570112e41b53c4df$var$loadContainerOptions(this._engine,this),this.actualOptions=$570112e41b53c4df$var$loadContainerOptions(this._engine,this),this._eventListeners=new $44a3ba61fee319fe$export$b20b719ec758a20f(this),this._intersectionObserver=$b45a95be606465d1$export$d97d2a93dce76cc2(t=>this._intersectionManager(t)),this._engine.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.containerBuilt,{container:this})}}class $d1dc8d8a09d89fb4$export$ec8b666c5fe2c75a{addEventListener(t,e){this.removeEventListener(t,e);let i=this._listeners.get(t);i||(i=[],this._listeners.set(t,i)),i.push(e)}dispatchEvent(t,e){let i=this._listeners.get(t);null==i||i.forEach(t=>t(e))}hasEventListener(t){return!!this._listeners.get(t)}removeAllEventListeners(t){t?this._listeners.delete(t):this._listeners=new Map}removeEventListener(t,e){let i=this._listeners.get(t);if(!i)return;let s=i.length,n=i.indexOf(e);n<$c9c3248b3c6a9599$export$e410eba367ce792b||(s===$c9c3248b3c6a9599$export$346cdd8493ece6c8?this._listeners.delete(t):i.splice(n,$c9c3248b3c6a9599$export$346cdd8493ece6c8))}constructor(){this._listeners=new Map}}async function $70eb51998383d737$var$getItemsFromInitializer(t,e,i,s=!1){let n=e.get(t);return(!n||s)&&(n=await Promise.all([...i.values()].map(e=>e(t))),e.set(t,n)),n}async function $70eb51998383d737$var$getDataFromUrl(t){let e=$b45a95be606465d1$export$3fbf39566d3ee62e(t.url,t.index);if(!e)return t.fallback;let i=await fetch(e);return i.ok?await i.json():($b45a95be606465d1$export$2b1d391cd05230fd().error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} ${i.status} while retrieving config file`),t.fallback)}let $70eb51998383d737$var$getCanvasFromContainer=t=>{let e;if(t instanceof HTMLCanvasElement||t.tagName.toLowerCase()===$c9c3248b3c6a9599$export$af8f840c6caca708)(e=t).dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]||(e.dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]=$c9c3248b3c6a9599$export$c392cf7a2bd47e88);else{let i=t.getElementsByTagName($c9c3248b3c6a9599$export$af8f840c6caca708);i.length?(e=i[$c9c3248b3c6a9599$export$878d5c9fc03f6a6f]).dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]=$c9c3248b3c6a9599$export$c392cf7a2bd47e88:((e=document.createElement($c9c3248b3c6a9599$export$af8f840c6caca708)).dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]=$c9c3248b3c6a9599$export$f4379e05d59339d2,t.appendChild(e))}let i="100%";return e.style.width||(e.style.width=i),e.style.height||(e.style.height=i),e},$70eb51998383d737$var$getDomContainer=(t,e)=>{let i=null!=e?e:document.getElementById(t);return i||((i=document.createElement("div")).id=t,i.dataset[$c9c3248b3c6a9599$export$4a278486528d5cfb]=$c9c3248b3c6a9599$export$f4379e05d59339d2,document.body.append(i)),i};class $70eb51998383d737$export$2c3b404bf3a77a1f{get configs(){let t={};for(let[e,i]of this._configs)t[e]=i;return t}get items(){return this._domArray}get version(){return"3.9.1"}async addColorManager(t,e=!0){this.colorManagers.set(t.key,t),await this.refresh(e)}addConfig(t){var e,i;let s=null!=(i=null!=(e=t.key)?e:t.name)?i:"default";this._configs.set(s,t),this._eventDispatcher.dispatchEvent($caa94592e0101c24$export$3d7865934588d77e.configAdded,{data:{name:s,config:t}})}async addEasing(t,e,i=!0){this.getEasing(t)||(this.easingFunctions.set(t,e),await this.refresh(i))}async addEffect(t,e,i=!0){$b45a95be606465d1$export$8e5dc47097396754(t,t=>{this.getEffectDrawer(t)||this.effectDrawers.set(t,e)}),await this.refresh(i)}addEventListener(t,e){this._eventDispatcher.addEventListener(t,e)}async addInteractor(t,e,i=!0){this._initializers.interactors.set(t,e),await this.refresh(i)}async addMover(t,e,i=!0){this._initializers.movers.set(t,e),await this.refresh(i)}async addParticleUpdater(t,e,i=!0){this._initializers.updaters.set(t,e),await this.refresh(i)}async addPathGenerator(t,e,i=!0){this.getPathGenerator(t)||this.pathGenerators.set(t,e),await this.refresh(i)}async addPlugin(t,e=!0){this.getPlugin(t.id)||this.plugins.push(t),await this.refresh(e)}async addPreset(t,e,i=!1,s=!0){(i||!this.getPreset(t))&&this.presets.set(t,e),await this.refresh(s)}async addShape(t,e=!0){for(let e of t.validTypes)this.getShapeDrawer(e)||this.shapeDrawers.set(e,t);await this.refresh(e)}checkVersion(t){if(this.version!==t)throw Error(`The tsParticles version is different from the loaded plugins version. Engine version: ${this.version}. Plugin version: ${t}`)}clearPlugins(t){this.updaters.delete(t),this.movers.delete(t),this.interactors.delete(t)}dispatchEvent(t,e){this._eventDispatcher.dispatchEvent(t,e)}dom(){return this.items}domItem(t){return this.item(t)}async getAvailablePlugins(t){let e=new Map;for(let i of this.plugins)i.needsPlugin(t.actualOptions)&&e.set(i.id,await i.getPlugin(t));return e}getEasing(t){var e;return null!=(e=this.easingFunctions.get(t))?e:t=>t}getEffectDrawer(t){return this.effectDrawers.get(t)}async getInteractors(t,e=!1){return $70eb51998383d737$var$getItemsFromInitializer(t,this.interactors,this._initializers.interactors,e)}async getMovers(t,e=!1){return $70eb51998383d737$var$getItemsFromInitializer(t,this.movers,this._initializers.movers,e)}getPathGenerator(t){return this.pathGenerators.get(t)}getPlugin(t){return this.plugins.find(e=>e.id===t)}getPreset(t){return this.presets.get(t)}getShapeDrawer(t){return this.shapeDrawers.get(t)}getSupportedEffects(){return this.effectDrawers.keys()}getSupportedShapes(){return this.shapeDrawers.keys()}async getUpdaters(t,e=!1){return $70eb51998383d737$var$getItemsFromInitializer(t,this.updaters,this._initializers.updaters,e)}init(){this._initialized||(this._initialized=!0)}item(t){let{items:e}=this,i=e[t];return!i||i.destroyed?void e.splice(t,$c9c3248b3c6a9599$export$310c6557edf6330f):i}async load(t){var e,i,s;let n=null!=(s=null!=(i=t.id)?i:null==(e=t.element)?void 0:e.id)?s:`tsparticles${Math.floor($b56e0d3a102cc459$export$1a76347094524b3b()*$c9c3248b3c6a9599$export$d20f7c11146fd35)}`,{index:r,url:a}=t,o=$b45a95be606465d1$export$3fbf39566d3ee62e(a?await $70eb51998383d737$var$getDataFromUrl({fallback:t.options,url:a,index:r}):t.options,r),{items:l}=this,h=l.findIndex(t=>t.id.description===n),c=new $570112e41b53c4df$export$42a852a2b6b56249(this,n,o);if(h>=$c9c3248b3c6a9599$export$a0a8145c86a935c7){let t=this.item(h),e=t?$c9c3248b3c6a9599$export$80bf7733f1207381:$c9c3248b3c6a9599$export$f883a24d5edde77c;t&&!t.destroyed&&t.destroy(!1),l.splice(h,e,c)}else l.push(c);let d=$70eb51998383d737$var$getCanvasFromContainer($70eb51998383d737$var$getDomContainer(n,t.element));return c.canvas.loadCanvas(d),await c.start(),c}loadOptions(t,e){this.plugins.forEach(i=>{var s;return null==(s=i.loadOptions)?void 0:s.call(i,t,e)})}loadParticlesOptions(t,e,...i){let s=this.updaters.get(t);s&&s.forEach(t=>{var s;return null==(s=t.loadOptions)?void 0:s.call(t,e,...i)})}async refresh(t=!0){t&&await Promise.all(this.items.map(t=>t.refresh()))}removeEventListener(t,e){this._eventDispatcher.removeEventListener(t,e)}setOnClickHandler(t){let{items:e}=this;if(!e.length)throw Error(`${$c9c3248b3c6a9599$export$adea4917e02d93dc} can only set click handlers after calling tsParticles.load()`);e.forEach(e=>e.addClickHandler(t))}constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new $d1dc8d8a09d89fb4$export$ec8b666c5fe2c75a,this._initialized=!1,this.plugins=[],this.colorManagers=new Map,this.easingFunctions=new Map,this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this.pathGenerators=new Map}}function $31debd41048883f3$export$2cd8252107eb640b(){let t=new $70eb51998383d737$export$2c3b404bf3a77a1f;return t.init(),t}!function(t){t.clockwise="clockwise",t.counterClockwise="counter-clockwise",t.random="random"}($5b16a89e54ff4835$export$9506977ce2a96a5b||($5b16a89e54ff4835$export$9506977ce2a96a5b={})),function(t){t.linear="linear",t.radial="radial",t.random="random"}($8f2d2240b8e15785$export$20d70ee9873a8ba||($8f2d2240b8e15785$export$20d70ee9873a8ba={})),function(t){t.easeInBack="ease-in-back",t.easeInCirc="ease-in-circ",t.easeInCubic="ease-in-cubic",t.easeInLinear="ease-in-linear",t.easeInQuad="ease-in-quad",t.easeInQuart="ease-in-quart",t.easeInQuint="ease-in-quint",t.easeInExpo="ease-in-expo",t.easeInSine="ease-in-sine",t.easeOutBack="ease-out-back",t.easeOutCirc="ease-out-circ",t.easeOutCubic="ease-out-cubic",t.easeOutLinear="ease-out-linear",t.easeOutQuad="ease-out-quad",t.easeOutQuart="ease-out-quart",t.easeOutQuint="ease-out-quint",t.easeOutExpo="ease-out-expo",t.easeOutSine="ease-out-sine",t.easeInOutBack="ease-in-out-back",t.easeInOutCirc="ease-in-out-circ",t.easeInOutCubic="ease-in-out-cubic",t.easeInOutLinear="ease-in-out-linear",t.easeInOutQuad="ease-in-out-quad",t.easeInOutQuart="ease-in-out-quart",t.easeInOutQuint="ease-in-out-quint",t.easeInOutExpo="ease-in-out-expo",t.easeInOutSine="ease-in-out-sine"}($6a6d4ee2903f5490$export$483bfb5d033dec0c||($6a6d4ee2903f5490$export$483bfb5d033dec0c={}));let $c799c23b2ca4e26f$export$218c38ca7c058037=$31debd41048883f3$export$2cd8252107eb640b();$b45a95be606465d1$export$460b6777813d3d86()||(window.tsParticles=$c799c23b2ca4e26f$export$218c38ca7c058037);let $9019d248e1db55d5$var$defaultInset=2,$9019d248e1db55d5$var$origin={x:0,y:0};function $9019d248e1db55d5$export$ca57b923902a3c0(t){var e;let{context:i,particle:s,radius:n}=t,r=s.sides,a=null!=(e=s.starInset)?e:$9019d248e1db55d5$var$defaultInset;i.moveTo($9019d248e1db55d5$var$origin.x,$9019d248e1db55d5$var$origin.y-n);for(let t=0;t<r;t++)i.rotate(Math.PI/r),i.lineTo($9019d248e1db55d5$var$origin.x,$9019d248e1db55d5$var$origin.y-n*a),i.rotate(Math.PI/r),i.lineTo($9019d248e1db55d5$var$origin.x,$9019d248e1db55d5$var$origin.y-n)}let $78de9af42cabd340$var$defaultInset=2,$78de9af42cabd340$var$defaultSides=5;class $78de9af42cabd340$export$9353a030aedd2caa{draw(t){$9019d248e1db55d5$export$ca57b923902a3c0(t)}getSidesCount(t){var e;let i=t.shapeData;return Math.round($b56e0d3a102cc459$export$e70c64b68236cb4e(null!=(e=null==i?void 0:i.sides)?e:$78de9af42cabd340$var$defaultSides))}particleInit(t,e){var i;let s=e.shapeData;e.starInset=$b56e0d3a102cc459$export$e70c64b68236cb4e(null!=(i=null==s?void 0:s.inset)?i:$78de9af42cabd340$var$defaultInset)}constructor(){this.validTypes=["star"]}}async function $0174f43e0af71473$export$f283471236cef89e(t,e=!0){t.checkVersion("3.9.1"),await t.addShape(new $78de9af42cabd340$export$9353a030aedd2caa,e)}let $9c75575532cd9c0a$var$ALPHA_CIRCLE=0,$9c75575532cd9c0a$var$ALPHA_CHALK=1,$9c75575532cd9c0a$var$ALPHA_SQUARE=3,$9c75575532cd9c0a$var$TWO_PI=2*Math.PI;class $9c75575532cd9c0a$export$acbb57e7d21b5855{updateChangedTiles(t){let e=(0,$8cWis.boundsOverlap)(t,this.selectionBounds);e&&(this.changedTiles=$b37280925142c567$export$1774f90c6da5013c(this.changedTiles,$b37280925142c567$export$2098fe43203ddd32(e,this.context.canvas.width,this.context.canvas.height)))}updateAlphaCanvas(){let t;if(this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_CIRCLE||this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_SQUARE)return;let e=[[this.alphaCanvas128,128],[this.alphaCanvas64,64],[this.alphaCanvas32,32]];for(let i=0;i<e.length;i++)(t=$2Eggz.BB.ctx(e[i][0])).save(),t.clearRect(0,0,e[i][1],e[i][1]),t.fillStyle="rgba("+this.settingColor.r+", "+this.settingColor.g+", "+this.settingColor.b+", "+this.alphaOpacityArr[this.settingAlphaId]+")",t.fillRect(0,0,e[i][1],e[i][1]),t.globalCompositeOperation="destination-in",t.imageSmoothingQuality="high",t.drawImage($f1a560137f603778$export$67a3081d7cc6182d[this.settingAlphaId],0,0,e[i][1],e[i][1]),t.restore()}calcOpacity(t){return this.settingOpacity*(this.settingHasOpacityPressure?t*t:1)}calcScatter(t){return this.settingScatter*this.settingSize*(this.settingHasScatterPressure?t:1)}drawDot(t,e,i,s,n,r,a){if(!(i<=0))if(this.settingLockLayerAlpha&&(this.context.globalCompositeOperation="source-atop"),a&&a[3]===s||(this.context.globalAlpha=s),a||this.settingAlphaId!==$9c75575532cd9c0a$var$ALPHA_CIRCLE&&this.settingAlphaId!==$9c75575532cd9c0a$var$ALPHA_SQUARE||(this.context.fillStyle=this.settingColorStr),this.particleContainer){let r=Math.max(.5,i/4),a=i/2,o=[];for(let i=0;i<this.settingSparkleCount;i++){let i=t,l=e;if(n>0){let t=2*Math.random()*Math.PI,e=Math.sqrt(Math.random())*n;i+=Math.cos(t)*e,l+=Math.sin(t)*e}let h=Math.random()*$9c75575532cd9c0a$var$TWO_PI,c=Math.random()*a;i+=Math.cos(h)*c,l+=Math.sin(h)*c,o.push({position:{x:i,y:l},size:r,color:this.settingColor,opacity:s});let d=r;this.updateChangedTiles({x1:Math.floor(i-d),y1:Math.floor(l-d),x2:Math.ceil(i+d),y2:Math.ceil(l+d)})}this.renderParticlesToCanvas(o),this.hasDrawnDot=!0}else{let s=Math.max(.5,i/4),a=i/2;for(let i=0;i<this.settingSparkleCount;i++){let i=t,o=e;if(n>0){let t=2*Math.random()*Math.PI,e=Math.sqrt(Math.random())*n;i+=Math.cos(t)*e,o+=Math.sin(t)*e}let l=Math.random()*$9c75575532cd9c0a$var$TWO_PI,h=Math.random()*a;i+=Math.cos(l)*h,o+=Math.sin(l)*h;let c=s;if(this.updateChangedTiles({x1:Math.floor(i-c),y1:Math.floor(o-c),x2:Math.ceil(i+c),y2:Math.ceil(o+c)}),this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_CIRCLE)this.context.beginPath(),this.context.arc(i,o,s,0,$9c75575532cd9c0a$var$TWO_PI),this.context.closePath(),this.context.fill(),this.hasDrawnDot=!0;else if(this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_SQUARE)void 0!==r&&(this.context.save(),this.context.translate(i,o),this.context.rotate(r/180*Math.PI),this.context.fillRect(-s,-s,2*s,2*s),this.context.restore(),this.hasDrawnDot=!0);else{this.context.save(),this.context.translate(i,o);let t=this.alphaCanvas128;s<=32&&s>16?t=this.alphaCanvas64:s<=16&&(t=this.alphaCanvas32),this.context.scale(s,s),this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_CHALK&&this.context.rotate((i+o)*53123%$9c75575532cd9c0a$var$TWO_PI),this.context.drawImage(t,-1,-1,2,2),this.context.restore(),this.hasDrawnDot=!0}}}}continueLine(t,e,i,s){let n;null===this.bezierLine&&(this.bezierLine=new $2Eggz.BB.BezierLine,this.bezierLine.add(this.lastInput.x,this.lastInput.y,0,()=>{}));let r=[],a=t=>{let e=$2Eggz.BB.mix(this.lastInput2.pressure,s,t.t),i=this.calcOpacity(e),n=Math.max(.1,this.settingSize*(this.settingHasSizePressure?e:1)),a=this.calcScatter(e);r.push([t.x,t.y,n,i,a,t.angle])},o=i*this.settingSpacing;null===t||null===e?this.bezierLine.addFinal(o,a):this.bezierLine.add(t,e,o,a),this.context.save();for(let t=0;t<r.length;t++){let e=r[t];this.drawDot(e[0],e[1],e[2],e[3],e[4],e[5],n),n=e}this.context.restore()}async initializeParticles(){if(!this.particleContainer)try{this.particleContainer=await $c799c23b2ca4e26f$export$218c38ca7c058037.load({id:"glitter-brush",options:{background:{color:{value:"transparent"}},fpsLimit:60,particles:{number:{value:0},color:{value:`rgb(${this.settingColor.r}, ${this.settingColor.g}, ${this.settingColor.b})`},shape:{type:"star"},opacity:{value:1},size:{value:2},move:{enable:!1}},detectRetina:!0}}),await $0174f43e0af71473$export$f283471236cef89e($c799c23b2ca4e26f$export$218c38ca7c058037)}catch(t){console.warn("Failed to initialize tsparticles for glitter brush:",t),this.particleContainer=void 0}}renderParticlesToCanvas(t){this.particleContainer&&(this.context.save(),this.context.globalCompositeOperation=this.settingLockLayerAlpha?"source-atop":"source-over",t.forEach(t=>{this.context.save(),this.context.globalAlpha=t.opacity,this.context.fillStyle=`rgb(${t.color.r}, ${t.color.g}, ${t.color.b})`,this.drawStar(t.position.x,t.position.y,t.size),this.context.restore()}),this.context.restore())}drawStar(t,e,i){let s=5,n=i,r=.5*i,a=Math.PI/2*3,o=t,l=e,h=Math.PI/5;this.context.beginPath(),this.context.moveTo(t,e-n);for(let i=0;i<s;i++)o=t+Math.cos(a)*n,l=e+Math.sin(a)*n,this.context.lineTo(o,l),a+=h,o=t+Math.cos(a)*r,l=e+Math.sin(a)*r,this.context.lineTo(o,l),a+=h;this.context.lineTo(t,e-n),this.context.closePath(),this.context.fill()}startLine(t,e,i){this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],i=$2Eggz.BB.clamp(i,0,1);let s=this.calcOpacity(i),n=this.settingHasSizePressure?Math.max(.1,i*this.settingSize):Math.max(.1,this.settingSize),r=this.calcScatter(i);this.hasDrawnDot=!1,this.inputIsDrawing=!0,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.drawDot(t,e,n,s,r),this.context.restore(),this.lineToolLastDot=n*this.settingSpacing,this.lastInput.x=t,this.lastInput.y=e,this.lastInput.pressure=i,this.lastInput2.pressure=i,this.inputArr=[{x:t,y:e,pressure:i}]}goLine(t,e,i){if(!this.inputIsDrawing)return;let s=$2Eggz.BB.clamp(i,0,1),n=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(t,e,n,this.lastInput.pressure),this.context.restore(),this.lastInput.x=t,this.lastInput.y=e,this.lastInput2.pressure=this.lastInput.pressure,this.lastInput.pressure=s,this.inputArr.push({x:t,y:e,pressure:i})}endLine(){let t=this.settingHasSizePressure?Math.max(.1,this.lastInput.pressure*this.settingSize):Math.max(.1,this.settingSize);if(this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath),this.continueLine(null,null,t,this.lastInput.pressure),this.context.restore(),this.inputIsDrawing=!1,this.settingAlphaId===$9c75575532cd9c0a$var$ALPHA_SQUARE&&!this.hasDrawnDot){let e=this.inputArr[0];this.inputArr.forEach(t=>{t.pressure>e.pressure&&(e=t)}),this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);let i=$2Eggz.BB.clamp(e.pressure,0,1),s=this.calcOpacity(i),n=this.calcScatter(i);this.drawDot(e.x,e.y,t,s,n,0),this.context.restore()}this.bezierLine=null,this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles))),this.hasDrawnDot=!1,this.inputArr=[]}drawLineSegment(t,e,i,s){let n;if(this.selection=this.klHistory.getComposed().selection.value,this.selectionPath=this.selection?(0,$aXq9D.getSelectionPath2d)(this.selection):void 0,this.selectionBounds=this.selection?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)):void 0,this.changedTiles=[],this.lastInput.x=i,this.lastInput.y=s,this.lastInput.pressure=1,this.inputIsDrawing||void 0===t)return;let r=$2Eggz.BB.pointsToAngleDeg({x:t,y:e},{x:i,y:s}),a=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-e,2)),o=(i-t)/a,l=(s-e)/a,h=this.settingSize*this.settingSpacing;this.lineToolLastDot=this.settingSize*this.settingSpacing,this.context.save(),this.selectionPath&&this.context.clip(this.selectionPath);let c=this.calcScatter(1);for(n=this.lineToolLastDot;n<=a;n+=h)this.drawDot(t+o*n,e+l*n,this.settingSize,this.settingOpacity,c,r);this.context.restore(),this.changedTiles.some(t=>t)&&this.klHistory.push($fc7b31422a41da93$export$263fa670dc037098(this.klHistory.getComposed(),$a262f7e0a9f5e4af$export$6706c882ea9c3dbd(this.context.canvas,this.changedTiles)))}isDrawing(){return this.inputIsDrawing}setAlpha(t){this.settingAlphaId!==t&&(this.settingAlphaId=t,this.updateAlphaCanvas())}setColor(t){this.settingColor!==t&&(this.settingColor={r:t.r,g:t.g,b:t.b},this.settingColorStr="rgb("+this.settingColor.r+","+this.settingColor.g+","+this.settingColor.b+")",this.updateAlphaCanvas())}setContext(t){this.context=t}setHistory(t){this.klHistory=t}setSize(t){this.settingSize=t}setOpacity(t){this.settingOpacity=t}setScatter(t){this.settingScatter=t}setSpacing(t){this.settingSpacing=t}sizePressure(t){this.settingHasSizePressure=t}opacityPressure(t){this.settingHasOpacityPressure=t}scatterPressure(t){this.settingHasScatterPressure=t}setLockAlpha(t){this.settingLockLayerAlpha=t}setSparkleCount(t){this.settingSparkleCount=Math.max(1,Math.min(20,t))}getSpacing(){return this.settingSpacing}getSize(){return this.settingSize}getOpacity(){return this.settingOpacity}getScatter(){return this.settingScatter}getLockAlpha(){return this.settingLockLayerAlpha}getSparkleCount(){return this.settingSparkleCount}constructor(){this.context={},this.klHistory={},this.particleContainer=void 0,this.settingHasOpacityPressure=!1,this.settingHasScatterPressure=!1,this.settingHasSizePressure=!0,this.settingSize=2,this.settingSpacing=.8489,this.settingOpacity=1,this.settingScatter=0,this.settingColor={},this.settingColorStr="",this.settingAlphaId=$9c75575532cd9c0a$var$ALPHA_CIRCLE,this.settingLockLayerAlpha=!1,this.settingSparkleCount=5,this.hasDrawnDot=!1,this.lineToolLastDot=0,this.lastInput={x:0,y:0,pressure:0},this.lastInput2={x:0,y:0,pressure:0},this.inputArr=[],this.inputIsDrawing=!1,this.bezierLine=null,this.alphaCanvas128=$2Eggz.BB.canvas(128,128),this.alphaCanvas64=$2Eggz.BB.canvas(64,64),this.alphaCanvas32=$2Eggz.BB.canvas(32,32),this.alphaOpacityArr=[1,.9,1,1],this.changedTiles=[],this.initializeParticles()}}let $8baf89d70f3487eb$export$32510733a89b2eab={PenBrush:$ab3d0b0688f50842$export$6f96c8f9e6ae7341,BlendBrush:$2beac24702a6836b$export$9659db8d01dd5313,SketchyBrush:$ec1ed8bc550ccd88$export$566f9061f0f5ba33,PixelBrush:$f01b5e3bd1be2f34$export$4de5ef8eecde6f12,ChemyBrush:$458de7145dc8d2d0$export$38b08aa4ea8f61c6,SmudgeBrush:$baef4a032d46c3b8$export$c9f800961903deab,EraserBrush:$6debbe598e970932$export$fe52c90afd1cf5ba,GlitterBrush:$9c75575532cd9c0a$export$acbb57e7d21b5855};var $2Eggz=parcelRequire("2Eggz");let $718ed62694aada15$export$f02de051ab70b20e=20;var $589cd84fd65b9f5a$exports={};$589cd84fd65b9f5a$exports=$parcel$resolve("efRnq");let $74487dc42eb45244$export$a0d4983f3b0b5c8e=function(){let t={image:$parcel$interopDefault($589cd84fd65b9f5a$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-pen"),sizeSlider:{min:.5,max:100,curve:$2Eggz.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]},scatterSlider:{min:0,max:100,curve:$2Eggz.BB.powerSplineInput(0,100,.1,2.5)}},e=[$63d0b335c576c718$export$ce37e184d908d785("brush-pen-circle"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-chalk"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-calligraphy"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-square")];return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-pen"),e=[$63d0b335c576c718$export$ce37e184d908d785("brush-pen-circle"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-chalk"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-calligraphy"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-square")]}),t.Ui=function(i){let s,n,r,a=document.createElement("div"),o=new $8baf89d70f3487eb$export$32510733a89b2eab.PenBrush;o.setHistory(i.klHistory),i.onSizeChange(o.getSize());let l=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[0,1,2,3].map(t=>{let i=$2Eggz.BB.el({className:"dark-invert",css:{width:"31px",height:"31px",backgroundSize:"contain",margin:"2px"}}),s=$2Eggz.BB.canvas(70,70),n=$2Eggz.BB.ctx(s);return 0===t||3===t?0===t?(n.beginPath(),n.arc(35,35,30,0,2*Math.PI),n.closePath(),n.fill()):n.fillRect(5,5,60,60):1===t?n.drawImage($be08c7e8caa49ffa$export$74a44bbc21d06a28(60),5,5):2===t&&n.drawImage($be08c7e8caa49ffa$export$eaa218d5d17c8f1c(60),5,5),i.style.backgroundImage="url("+s.toDataURL("image/png")+")",{id:t,label:i,title:e[t]}}),initId:0,onChange:t=>{o.setAlpha(t)}}),h=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:o.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){o.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),c=new $2Eggz.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function d(t){o.setSize(t),o.setSpacing(Math.max(2,c.interpolate(t))/15)}(function(){s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:o.getSize(),curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{d(t),i.onSizeChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),n=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:t.opacitySlider.max,curve:t.opacitySlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{o.setOpacity(t),i.onOpacityChange(t)}}),r=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("scatter"),width:225,height:30,min:t.scatterSlider.min,max:t.scatterSlider.max,value:t.scatterSlider.min,curve:t.scatterSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,onChange:t=>{o.setScatter(t),i.onScatterChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1});let e=$218f70778c2bf652$export$9da2e8821e6cbb57(!0,function(t){o.sizePressure(t)}),c=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){o.opacityPressure(t)}),p=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){o.scatterPressure(t)});a.append($2Eggz.BB.el({content:[s.getElement(),e],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[n.getElement(),c],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[r.getElement(),p],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),$2Eggz.BB.el({content:l.getElement(),css:{marginTop:"10px"}}),$2Eggz.BB.el({content:h.getElement(),css:{marginTop:"10px"}}))})(),this.increaseSize=function(t){o.isDrawing()||s.changeSliderValue(t)},this.decreaseSize=function(t){o.isDrawing()||s.changeSliderValue(-t)},this.getSize=function(){return o.getSize()},this.setSize=function(t){d(t),s.setValue(t)},this.getOpacity=function(){return o.getOpacity()},this.setOpacity=function(t){o.setOpacity(t),n.setValue(t)},this.getScatter=function(){return o.getScatter()},this.setScatter=function(t){o.setScatter(t),r.setValue(t)},this.setColor=function(t){o.setColor(t)},this.setLayer=function(t){o.setContext(t.context)},this.startLine=function(t,e,i){o.startLine(t,e,i)},this.goLine=function(t,e,i){o.goLine(t,e,i)},this.endLine=function(){o.endLine()},this.getBrush=function(){return o},this.isDrawing=function(){return o.isDrawing()},this.getElement=function(){return a}},t}();var $2Eggz=parcelRequire("2Eggz"),$66a76d3dbebc04df$exports={};$66a76d3dbebc04df$exports=$parcel$resolve("lGY8s");let $389b24b4f03b3a27$export$156bb4fe8f4bcb4b=function(){let t={image:$parcel$interopDefault($66a76d3dbebc04df$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-blend"),sizeSlider:{min:.5,max:100,curve:$2Eggz.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-blend")}),t.Ui=function(e){let i,s,n=document.createElement("div"),r=new $8baf89d70f3487eb$export$32510733a89b2eab.BlendBrush;function a(t){r.setSize(t)}r.setHistory(e.klHistory),e.onSizeChange(r.getSize()),function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:58,curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{a(t),e.onSizeChange(t)}}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:r.getOpacity(),curve:t.opacitySlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{r.setOpacity(t),e.onOpacityChange(t)}});let o=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-blending"),width:225,height:30,min:0,max:1,value:r.getBlending(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:function(t){r.setBlending(t)}});o.getElement().style.marginTop="10px";let l=$218f70778c2bf652$export$9da2e8821e6cbb57(!0,function(t){r.setSizePressure(t)}),h=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){r.setOpacityPressure(t)}),c=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:r.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){r.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),css:{marginTop:"10px",display:"inline-block"},name:"lock-alpha"});n.append($2Eggz.BB.el({content:[i.getElement(),l],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[s.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),o.getElement(),c.getElement())}(),this.increaseSize=function(t){r.getIsDrawing()||i.changeSliderValue(t)},this.decreaseSize=function(t){r.getIsDrawing()||i.changeSliderValue(-t)},this.getSize=function(){return r.getSize()},this.setSize=function(t){a(t),i.setValue(t)},this.getOpacity=function(){return r.getOpacity()},this.setOpacity=function(t){r.setOpacity(t),s.setValue(t)},this.setColor=function(t){r.setColor(t)},this.setLayer=function(t){r.setContext(t.context,t.id)},this.startLine=function(t,e,i){r.startLine(t,e,i)},this.goLine=function(t,e,i,s){r.goLine(t,e,i,!1)},this.endLine=function(){r.endLine()},this.getBrush=function(){return r},this.isDrawing=function(){return r.getIsDrawing()},this.getElement=function(){return n}},t}();var $072de38d598ac8ca$exports={};$072de38d598ac8ca$exports=$parcel$resolve("jDXzO");var $2Eggz=parcelRequire("2Eggz");let $ed2b11ff6c0e7481$export$ffae56164d1bde68=function(){let t={image:$parcel$interopDefault($072de38d598ac8ca$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-sketchy"),sizeSlider:{min:.5,max:10},opacitySlider:{min:.01,max:1}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-sketchy")}),t.Ui=function(e){let i,s,n=document.createElement("div"),r=new $8baf89d70f3487eb$export$32510733a89b2eab.SketchyBrush;function a(t){r.setSize(t)}r.setHistory(e.klHistory),e.onSizeChange(r.getSize()),function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:250,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:2*r.getSize(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:function(t){r.setSize(t),e.onSizeChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:250,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:r.getOpacity(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{r.setOpacity(t),e.onOpacityChange(t)}});let a=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-blending"),width:250,height:30,min:0,max:1,value:r.getBlending(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:function(t){r.setBlending(t)}}),o=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-sketchy-scale"),width:250,height:30,min:1,max:20,value:r.getScale(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,onChange:function(t){r.setScale(t)}});s.getElement().style.marginTop="10px",a.getElement().style.marginTop="10px",o.getElement().style.marginTop="10px",n.append(i.getElement(),s.getElement(),a.getElement(),o.getElement())}(),this.increaseSize=function(t){r.isDrawing()||i.changeSliderValue(t)},this.decreaseSize=function(t){r.isDrawing()||i.changeSliderValue(-t)},this.getSize=function(){return r.getSize()},this.setSize=function(t){a(t),i.setValue(t)},this.getOpacity=function(){return r.getOpacity()},this.setOpacity=function(t){r.setOpacity(t),s.setValue(t)},this.setColor=function(t){r.setColor(t)},this.setLayer=function(t){r.setContext(t.context)},this.startLine=function(t,e,i){r.startLine(t,e,i)},this.goLine=function(t,e,i){r.goLine(t,e,i,void 0)},this.endLine=function(){r.endLine()},this.getSeed=function(){return parseInt(""+r.getSeed())},this.setSeed=function(t){r.setSeed(parseInt(""+t))},this.getBrush=function(){return r},this.isDrawing=function(){return r.isDrawing()},this.getElement=function(){return n}},t}();var $2Eggz=parcelRequire("2Eggz"),$a35d2108566d015a$exports={};$a35d2108566d015a$exports=$parcel$resolve("hkoNI");let $c8f3acddc3f49bc0$export$d001f3406562d07=function(){let t={image:$parcel$interopDefault($a35d2108566d015a$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-pixel"),sizeSlider:{min:.5,max:100,curve:$2Eggz.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-pixel")}),t.Ui=function(e){let i,s,n=document.createElement("div"),r=new $8baf89d70f3487eb$export$32510733a89b2eab.PixelBrush;r.setHistory(e.klHistory),e.onSizeChange(r.getSize());let a=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:r.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){r.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),name:"lock-alpha-toggle"}),o=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:r.getIsEraser(),label:$63d0b335c576c718$export$ce37e184d908d785("eraser"),callback:function(t){r.setIsEraser(t)},name:"eraser-toggle"}),l=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:r.getUseDither(),label:$63d0b335c576c718$export$ce37e184d908d785("brush-pixel-dither"),callback:function(t){r.setUseDither(t)},name:"dither-toggle"}),h=new $2Eggz.BB.SplineInterpolator([[.5,.45],[100,4]]);function c(t){r.setSize(t),r.setSpacing(h.interpolate(t)/t)}(function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:r.getSize(),curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{c(t),e.onSizeChange(t)}}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:t.opacitySlider.max,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{r.setOpacity(t),e.onOpacityChange(t)}});let h=$218f70778c2bf652$export$9da2e8821e6cbb57(!0,function(t){r.sizePressure(t)});n.append($2Eggz.BB.el({content:[i.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),s.getElement()),$2Eggz.BB.el({parent:n,css:{display:"flex",marginTop:"10px",gap:"10px",flexWrap:"wrap"}}).append(a.getElement(),o.getElement(),l.getElement())})(),this.increaseSize=function(t){r.isDrawing()||i.changeSliderValue(t)},this.decreaseSize=function(t){r.isDrawing()||i.changeSliderValue(-t)},this.getSize=function(){return r.getSize()},this.setSize=function(t){c(t),i.setValue(2*t)},this.getOpacity=function(){return r.getOpacity()},this.setOpacity=function(t){r.setOpacity(t),s.setValue(100*t)},this.setColor=function(t){r.setColor(t)},this.setLayer=function(t){r.setContext(t.context)},this.startLine=function(t,e,i){r.startLine(t,e,i)},this.goLine=function(t,e,i){r.goLine(t,e,i)},this.endLine=function(){r.endLine()},this.getBrush=function(){return r},this.isDrawing=function(){return r.isDrawing()},this.toggleEraser=()=>{o.setValue(!o.getValue()),r.setIsEraser(o.getValue())},this.getElement=function(){return n}},t}();var $2Eggz=parcelRequire("2Eggz"),$224bfe309e7ff70b$exports={};$224bfe309e7ff70b$exports=$parcel$resolve("baIZM");let $411f23605301883c$export$cf481ecf227135a8=function(){let t={image:$parcel$interopDefault($224bfe309e7ff70b$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("eraser")+" [E]",sizeSlider:{min:.5,max:200,curve:$2Eggz.BB.powerSplineInput(.5,200,.1)},opacitySlider:{min:.01,max:1}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("eraser")+" [E]"}),t.Ui=function(e){let i,s,n=document.createElement("div"),r=new $8baf89d70f3487eb$export$32510733a89b2eab.EraserBrush;r.setHistory(e.klHistory),e.onSizeChange(r.getSize());let a=!1;function o(t){r.setSize(t)}(function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:30,curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{o(t),e.onSizeChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:t.opacitySlider.max,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{r.setOpacity(t),e.onOpacityChange(t)}});let l=$218f70778c2bf652$export$9da2e8821e6cbb57(!0,function(t){r.sizePressure(t)}),h=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){r.opacityPressure(t)});n.append($2Eggz.BB.el({content:[i.getElement(),l],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[s.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}));let c=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("brush-eraser-transparent-bg"),callback:function(t){a=t,r.setTransparentBG(t)},css:{marginTop:"10px"},name:"transparency-toggle"});n.append(c.getElement())})(),this.increaseSize=function(t){r.isDrawing()||i.changeSliderValue(t)},this.decreaseSize=function(t){r.isDrawing()||i.changeSliderValue(-t)},this.getSize=function(){return r.getSize()},this.setSize=function(t){o(t),i.setValue(t)},this.getOpacity=function(){return r.getOpacity()},this.setOpacity=function(t){r.setOpacity(t),s.setValue(t)},this.setColor=function(){},this.setLayer=function(t){r.setLayer(t)},this.startLine=function(t,e,i){r.startLine(t,e,i)},this.goLine=function(t,e,i){r.goLine(t,e,i)},this.endLine=function(){r.endLine()},this.getBrush=function(){return r},this.getIsTransparentBg=function(){return a},this.isDrawing=function(){return r.isDrawing()},this.getElement=function(){return n}},t}();var $2Eggz=parcelRequire("2Eggz"),$77f4910ba5bfb2ef$exports={};$77f4910ba5bfb2ef$exports=$parcel$resolve("91Av5");let $4218d17c2806f1f8$export$84831662ba707e7a=function(){let t={image:$parcel$interopDefault($77f4910ba5bfb2ef$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-smudge"),sizeSlider:{min:.5,max:100,curve:$2Eggz.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-smudge")}),t.Ui=function(e){let i,s,n=document.createElement("div"),r=new $8baf89d70f3487eb$export$32510733a89b2eab.SmudgeBrush;r.setHistory(e.klHistory),e.onSizeChange(r.getSize());let a=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:r.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){r.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),o=new $2Eggz.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function l(t){r.setSize(t),r.setSpacing(Math.max(2,o.interpolate(t))/15)}(function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:r.getSize(),curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{l(t),e.onSizeChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:r.getOpacity(),curve:t.opacitySlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{r.setOpacity(t),e.onOpacityChange(t)}});let o=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){r.sizePressure(t)}),h=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){r.opacityPressure(t)});n.append($2Eggz.BB.el({content:[i.getElement(),o],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[s.getElement(),h],css:{display:"flex",justifyContent:"space-between",alignItems:"center"}})),$2Eggz.BB.el({parent:n,css:{marginTop:"10px"}}).append(a.getElement())})(),this.increaseSize=function(t){r.getIsDrawing()||i.changeSliderValue(t)},this.decreaseSize=function(t){r.getIsDrawing()||i.changeSliderValue(-t)},this.getSize=function(){return r.getSize()},this.setSize=function(t){l(t),i.setValue(t)},this.getOpacity=function(){return r.getOpacity()},this.setOpacity=function(t){r.setOpacity(t),s.setValue(t)},this.setColor=function(t){r.setColor(t)},this.setLayer=function(t){r.setContext(t.context)},this.startLine=function(t,e,i){r.startLine(t,e,i)},this.goLine=function(t,e,i){r.goLine(t,e,i)},this.endLine=function(){r.endLine()},this.getBrush=function(){return r},this.isDrawing=function(){return r.getIsDrawing()},this.getElement=function(){return n}},t}();var $2Eggz=parcelRequire("2Eggz"),$017f6a414a9f5faf$exports={};$017f6a414a9f5faf$exports=$parcel$resolve("aI6cE");var $VM6dD=parcelRequire("VM6dD");let $720edf36b0105568$export$80819a93636ebb04=function(){let t={image:$parcel$interopDefault($017f6a414a9f5faf$exports),tooltip:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy"),sizeSlider:{min:.25,max:25,curve:$2Eggz.BB.powerSplineInput(.25,25,.1),isDisabled:!0},opacitySlider:{min:.01,max:1}};return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-chemy")}),t.Ui=function(e){let i,s,n,r=document.createElement("div"),a=new $8baf89d70f3487eb$export$32510733a89b2eab.ChemyBrush;function o(t){a.setSize(t)}a.setHistory(e.klHistory),e.onSizeChange(a.getSize()),function(){i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:250,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:a.getSize(),curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,isEnabled:"stroke"===a.getMode(),toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{o(t),e.onSizeChange(t)},formatFunc:t=>t<5?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:250,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:a.getOpacity(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{a.setOpacity(t),e.onOpacityChange(t)}}),(0,$VM6dD.css)(s.getElement(),{marginTop:"10px"}),n=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:a.getIsEraser(),label:$63d0b335c576c718$export$ce37e184d908d785("eraser"),callback:function(t){a.setIsEraser(t)},css:{marginTop:"10px",marginLeft:"10px"},name:"eraser-toggle"});let l=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:a.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){a.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),css:{marginTop:"10px"},name:"lock-alpha-toggle"}),h=$2Eggz.BB.el({css:{display:"flex",marginTop:"10px"}}),c=35,d=8,p=19,u=9.5,g=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"fill",label:$2Eggz.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"#000",css:{transformOrigin:"0 0",transform:`translate(-0.5px, -0.5px) scale(${p}, ${p}) translate(0.5px, 0.5px)`},d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy-fill")},{id:"stroke",label:$2Eggz.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"0.12px",transformOrigin:"0 0",transform:`translate(-0.5px, -0.5px) scale(${p}, ${p}) translate(0.5px, 0.5px)`},d:"M 0,0 C 1.5,0 -0.5,1 1,1"}]}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy-stroke")}],initId:a.getMode(),onChange:s=>{a.setMode(s),t.sizeSlider.isDisabled="fill"===a.getMode(),i.setIsEnabled(!t.sizeSlider.isDisabled);let n=a.getSize();i.setValue(n),e.onSizeChange(n),e.onConfigChange()}}),m=new $8d99bd5fadaac7f9$export$2358c75ad3c15b2d({label:$2Eggz.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"1px"},d:`M ${u+d},${d} ${u+d},${p+d}`}]}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy-mirror-x"),init:a.getXSymmetry(),onChange:t=>{a.setXSymmetry(t)}}),f=new $8d99bd5fadaac7f9$export$2358c75ad3c15b2d({label:$2Eggz.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"path",fill:"none",stroke:"#000",css:{strokeWidth:"1px"},d:`M ${d},${u+d} ${p+d},${u+d}`}]}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy-mirror-y"),init:a.getYSymmetry(),onChange:t=>{a.setYSymmetry(t)}}),y=new $8d99bd5fadaac7f9$export$2358c75ad3c15b2d({label:$2Eggz.BB.createSvg({class:"dark-invert",elementType:"svg",width:c+"",height:c+"",childrenArr:[{elementType:"defs",childrenArr:[{elementType:"linearGradient",id:"gradient",x1:"0",y1:"0",x2:"0",y2:"1",childrenArr:[{elementType:"stop",offset:"0%","stop-color":"rgba(0,0,0,0)"},{elementType:"stop",offset:"100%","stop-color":"rgba(0,0,0,1)"}]}]},{elementType:"rect",fill:"url('#gradient')",x:""+d,y:""+d,width:""+p,height:""+p}]}),title:$63d0b335c576c718$export$ce37e184d908d785("brush-chemy-gradient"),init:a.getGradient(),onChange:t=>{a.setGradient(t)}});(0,$VM6dD.css)(m.getElement(),{marginLeft:"10px"});{let t={marginLeft:"4px"};(0,$VM6dD.css)(f.getElement(),t),(0,$VM6dD.css)(y.getElement(),t)}h.append(g.getElement(),m.getElement(),f.getElement(),y.getElement()),r.append(i.getElement(),s.getElement(),h,$2Eggz.BB.el({content:[l.getElement(),n.getElement()],css:{display:"flex"}}))}(),this.increaseSize=function(t){a.getIsDrawing()||"stroke"!==a.getMode()||i.changeSliderValue(t)},this.decreaseSize=function(t){a.getIsDrawing()||"stroke"!==a.getMode()||i.changeSliderValue(-t)},this.getSize=function(){return a.getSize()},this.setSize=function(t){o(t),i.setValue(t)},this.getOpacity=function(){return a.getOpacity()},this.setOpacity=function(t){a.setOpacity(t),s.setValue(t)},this.setColor=function(t){a.setColor(t)},this.setLayer=function(t){a.setContext(t.context)},this.startLine=function(t,e,i){a.startLine(t,e)},this.goLine=function(t,e,i,s){a.goLine(t,e)},this.endLine=function(){a.endLine()},this.getBrush=function(){return a},this.isDrawing=function(){return a.getIsDrawing()},this.toggleEraser=()=>{n.setValue(!n.getValue()),a.setIsEraser(n.getValue())},this.getElement=function(){return r}},t}();var $2Eggz=parcelRequire("2Eggz");let $eb67af38588821f0$export$7e5dfa86b6697bf5=function(){let t={image:$parcel$interopDefault($589cd84fd65b9f5a$exports),tooltip:"Glitter Brush",sizeSlider:{min:.5,max:100,curve:$2Eggz.BB.powerSplineInput(.5,100,.1)},opacitySlider:{min:.01,max:1,curve:[[0,.01],[.5,.3],[1,1]]},scatterSlider:{min:0,max:100,curve:$2Eggz.BB.powerSplineInput(0,100,.1,2.5)}},e=[$63d0b335c576c718$export$ce37e184d908d785("brush-pen-circle"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-chalk"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-calligraphy"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-square")];return $63d0b335c576c718$export$e4ce066d17694649.subscribe(()=>{t.tooltip=$63d0b335c576c718$export$ce37e184d908d785("brush-glitter"),e=[$63d0b335c576c718$export$ce37e184d908d785("brush-pen-circle"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-chalk"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-calligraphy"),$63d0b335c576c718$export$ce37e184d908d785("brush-pen-square")]}),t.Ui=function(i){let s,n,r,a,o=document.createElement("div"),l=new $8baf89d70f3487eb$export$32510733a89b2eab.GlitterBrush;l.setHistory(i.klHistory),i.onSizeChange(l.getSize());let h=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[0,1,2,3].map(t=>{let i=$2Eggz.BB.el({className:"dark-invert",css:{width:"31px",height:"31px",backgroundSize:"contain",margin:"2px"}}),s=$2Eggz.BB.canvas(70,70),n=$2Eggz.BB.ctx(s);return 0===t||3===t?0===t?(n.beginPath(),n.arc(35,35,30,0,2*Math.PI),n.closePath(),n.fill()):n.fillRect(5,5,60,60):1===t?n.drawImage($be08c7e8caa49ffa$export$74a44bbc21d06a28(60),5,5):2===t&&n.drawImage($be08c7e8caa49ffa$export$eaa218d5d17c8f1c(60),5,5),i.style.backgroundImage="url("+s.toDataURL("image/png")+")",{id:t,label:i,title:e[t]}}),initId:0,onChange:t=>{l.setAlpha(t)}}),c=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:l.getLockAlpha(),label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),callback:function(t){l.setLockAlpha(t)},doHighlight:!0,title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),css:{display:"inline-block"},name:"lock-alpha-toggle"}),d=new $2Eggz.BB.SplineInterpolator([[0,15],[8,7],[14,4],[30,3],[50,2.7],[100,2]]);function p(t){l.setSize(t),l.setSpacing(Math.max(2,d.interpolate(t))/15)}(function(){s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-size"),width:225,height:30,min:t.sizeSlider.min,max:t.sizeSlider.max,value:l.getSize(),curve:t.sizeSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>2*t,toValue:t=>t/2,onChange:t=>{p(t),i.onSizeChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),n=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:225,height:30,min:t.opacitySlider.min,max:t.opacitySlider.max,value:t.opacitySlider.max,curve:t.opacitySlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,toDisplayValue:t=>100*t,toValue:t=>t/100,onChange:t=>{l.setOpacity(t),i.onOpacityChange(t)}}),r=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("scatter"),width:225,height:30,min:t.scatterSlider.min,max:t.scatterSlider.max,value:t.scatterSlider.min,curve:t.scatterSlider.curve,eventResMs:$718ed62694aada15$export$f02de051ab70b20e,onChange:t=>{l.setScatter(t),i.onScatterChange(t)},formatFunc:t=>t<10?$2Eggz.BB.round(t,1):Math.round(t),manualInputRoundDigits:1}),a=new $cd73d123a4560ac3$export$a1855b925e534de7({label:"Sparkle Count",width:225,height:30,min:1,max:20,value:l.getSparkleCount(),eventResMs:$718ed62694aada15$export$f02de051ab70b20e,onChange:t=>{l.setSparkleCount(Math.round(t))},formatFunc:t=>Math.round(t),manualInputRoundDigits:0});let e=$218f70778c2bf652$export$9da2e8821e6cbb57(!0,function(t){l.sizePressure(t)}),d=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){l.opacityPressure(t)}),u=$218f70778c2bf652$export$9da2e8821e6cbb57(!1,function(t){l.scatterPressure(t)});o.append($2Eggz.BB.el({content:[s.getElement(),e],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[n.getElement(),d],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:[r.getElement(),u],css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),$2Eggz.BB.el({content:a.getElement(),css:{marginBottom:"10px"}}),$2Eggz.BB.el({content:h.getElement(),css:{marginTop:"10px"}}),$2Eggz.BB.el({content:c.getElement(),css:{marginTop:"10px"}}))})(),this.increaseSize=function(t){l.isDrawing()||s.changeSliderValue(t)},this.decreaseSize=function(t){l.isDrawing()||s.changeSliderValue(-t)},this.getSize=function(){return l.getSize()},this.setSize=function(t){p(t),s.setValue(t)},this.getOpacity=function(){return l.getOpacity()},this.setOpacity=function(t){l.setOpacity(t),n.setValue(t)},this.getScatter=function(){return l.getScatter()},this.setScatter=function(t){l.setScatter(t),r.setValue(t)},this.setColor=function(t){l.setColor(t)},this.setLayer=function(t){l.setContext(t.context)},this.startLine=function(t,e,i){l.startLine(t,e,i)},this.goLine=function(t,e,i){l.goLine(t,e,i)},this.endLine=function(){l.endLine()},this.getBrush=function(){return l},this.isDrawing=function(){return l.isDrawing()},this.getElement=function(){return o}},t}(),$b2f1ee6bcab52d93$export$d1a79a5ce7e46547={penBrush:$74487dc42eb45244$export$a0d4983f3b0b5c8e,blendBrush:$389b24b4f03b3a27$export$156bb4fe8f4bcb4b,sketchyBrush:$ed2b11ff6c0e7481$export$ffae56164d1bde68,pixelBrush:$c8f3acddc3f49bc0$export$d001f3406562d07,chemyBrush:$720edf36b0105568$export$80819a93636ebb04,smudgeBrush:$4218d17c2806f1f8$export$84831662ba707e7a,eraserBrush:$411f23605301883c$export$cf481ecf227135a8,glitterBrush:$eb67af38588821f0$export$7e5dfa86b6697bf5};var $2Eggz=parcelRequire("2Eggz");function $165d2995997b2f9b$export$35fa34e5af64bd4a(t,e){let i;if(!e&&(window.innerHeight<500||window.innerWidth<700))return void window.open(t);let s=$2Eggz.BB.el({tagName:"iframe",custom:{src:t},css:{width:"100%",height:"100%",opacity:"0"}});setTimeout(()=>{s.style.opacity=""},500);let n=$2Eggz.BB.el();e||(i=$2Eggz.BB.el({tagName:"a",parent:n,content:$63d0b335c576c718$export$ce37e184d908d785("modal-new-tab"),custom:{href:"help",target:"_blank"},onClick:function(){r.close()}}),s.onload=()=>{if(i&&s.contentWindow)try{$2Eggz.BB.setAttributes(i,{href:""+s.contentWindow.location})}catch(t){}s.style.opacity=""});let r=new $18361e3f5d6257e8$export$185108a9b725b68({title:n,content:s,width:880,isMaxHeight:!0,onClose:()=>{i&&(s.src="about:blank",$2Eggz.BB.destroyEl(i),i=void 0)}})}var $2Eggz=parcelRequire("2Eggz");class $f734cb8286217c3c$export$3dff5655255b5729{getValue(){for(let t=0;t<this.inputs.length;t++)if(this.inputs[t].checked)return this.inputs[t].value;return null}getElement(){return this.el}constructor({name:t,init:e,items:i,ignoreFocus:s}){this.inputs=[],this.el=$2Eggz.BB.el({className:"kl-radio"}),i.forEach(i=>{let n=$2Eggz.BB.el({tagName:"label"}),r=$2Eggz.BB.el({tagName:"input",parent:n,custom:{name:t,value:i.value,type:"radio"}});s&&r.setAttribute("data-ignore-focus","true"),e===i.value&&(r.checked=!0),n.append(i.label),this.el.append(n),this.inputs.push(r)})}}var $2Eggz=parcelRequire("2Eggz");function $61cd8b4e4101a623$export$1b9ca798405c9eb6(t){let e,i=new Date().getTime()-t;return i=Math.floor(i/1e3/60),e=$63d0b335c576c718$export$ce37e184d908d785("file-storage-min-ago").replace("{x}",""+i),i>60&&(i=Math.floor(i/60),e=$63d0b335c576c718$export$ce37e184d908d785("file-storage-hours-ago").replace("{x}",""+i),i>24&&(i=Math.floor(i/24),e=$63d0b335c576c718$export$ce37e184d908d785("file-storage-days-ago").replace("{x}",""+i),i>31&&(e=$63d0b335c576c718$export$ce37e184d908d785("file-storage-month-ago")))),e}var $2Eggz=parcelRequire("2Eggz");class $744217e5b2377ce2$export$852ebaa1b01c8b5a{getElement(){return this.rootEl}show(){}destroy(){$2Eggz.BB.destroyEl(this.infoButton)}constructor(){this.infoButton=$2Eggz.BB.el({content:"?",className:"kl-info-btn",title:$63d0b335c576c718$export$ce37e184d908d785("file-storage-about"),onClick:()=>{$165d2995997b2f9b$export$35fa34e5af64bd4a("./help/#help-browser-storage",!1)}}),this.rootEl=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("file-storage"),css:{display:"flex",margin:"-5px 0",gap:"6px"}}),this.rootEl.append(this.infoButton)}}$41907456dd919c99$export$b5381822af66064b="a9LdEW_animEl";var $jmKbV=parcelRequire("jmKbV");async function $2e574af1dfdb7def$export$f565b71ad023b7df(){"storage"in navigator&&"persist"in navigator.storage&&await navigator.storage.persist()}var $ao0qX=parcelRequire("ao0qX");class $1a83f3b0ed28fe18$export$9c72cf485ef46673{updateAge(){this.timestamp&&(this.ageEl.textContent=$61cd8b4e4101a623$export$1b9ca798405c9eb6(this.timestamp))}resetButtons(){this.previewEl.classList.remove("kl-storage-preview--disabled"),this.timestamp?(this.openButtonEl&&(this.openButtonEl.disabled=!1),this.storeButtonEl.textContent=$63d0b335c576c718$export$ce37e184d908d785("file-storage-overwrite"),this.storeButtonEl.disabled=!1,this.clearButtonEl.disabled=!1):(this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.textContent=$63d0b335c576c718$export$ce37e184d908d785("file-storage-store"),this.storeButtonEl.disabled=!1,this.clearButtonEl.disabled=!0)}updateThumb(t,e){var i;this.timestamp=t,null==(i=this.thumbnail)||i.remove(),this.thumbnail=e?(0,$ao0qX.copyCanvas)(e):void 0;let s=this.thumbnail;if(s&&t){if(s.classList.add("kl-storage-preview__im"),this.ageEl.remove(),this.emptyEl.remove(),this.updateAge(),this.previewEl.append(s,this.ageEl),this.previewEl.style.pointerEvents=this.onOpen?"":"none","undefined"!=typeof performance&&t>performance.timeOrigin){let t=$2Eggz.BB.el({parent:this.previewEl,className:$41907456dd919c99$export$b5381822af66064b});setTimeout(()=>{t.remove()},500)}}else this.ageEl.remove(),this.previewEl.append(this.emptyEl),this.previewEl.style.pointerEvents="none";this.resetButtons()}async store(){let t=this.projectStore.getCurrentMeta(),e=this.getProject();if(!t||t.projectId===e.projectId||await new Promise((t,e)=>{$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-overwrite-confirm"),buttons:[$63d0b335c576c718$export$ce37e184d908d785("file-storage-overwrite"),"Cancel"],callback:async e=>{"Cancel"===e?t(!1):t(!0)}})})){this.applyUncommitted(),await $2e574af1dfdb7def$export$f565b71ad023b7df(),this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.textContent=$63d0b335c576c718$export$ce37e184d908d785("file-storage-storing"),this.storeButtonEl.disabled=!0,this.clearButtonEl.disabled=!0,this.previewEl.classList.add("kl-storage-preview--disabled"),await new Promise(t=>{setTimeout(()=>t(null),20)});try{await this.projectStore.store(e),this.onStored()}catch(t){this.resetButtons(),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:`${$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed-1")}<ul><li>${$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed-2")}</li><li>${$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed-3")}</li><li>${$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed-4")}</li></ul>`,buttons:["Ok"]}),setTimeout(()=>{throw Error("storage-ui: failed to store browser storage, "+t)},0)}}}async clear(){$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-clear-prompt"),buttons:[$63d0b335c576c718$export$ce37e184d908d785("file-storage-clear"),"Cancel"],deleteButtonName:$63d0b335c576c718$export$ce37e184d908d785("file-storage-clear"),callback:async t=>{if("Cancel"!==t){this.openButtonEl&&(this.openButtonEl.disabled=!0),this.storeButtonEl.disabled=!0,this.clearButtonEl.disabled=!0;try{await this.projectStore.clear()}catch(t){this.resetButtons(),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed-clear"),buttons:["Ok"]}),setTimeout(()=>{throw Error("storage-ui: failed to clear browser storage, "+t)},0)}}}})}showError(){this.contentEl.innerHTML="",$2Eggz.BB.el({parent:this.contentEl,content:" "+$63d0b335c576c718$export$ce37e184d908d785("file-storage-cant-access"),css:{marginTop:"10px"}})}getElement(){return this.rootEl}show(){this.isFirst&&(this.isFirst=!1,this.projectStore.getIsAvailable()?(async()=>{try{await this.projectStore.update();let t=this.projectStore.getCurrentMeta();t?this.updateThumb(t.timestamp,t.thumbnail):this.updateThumb()}catch(t){throw this.showError(),Error("browser-storage-ui: failed initial read browser storage, "+t)}})():this.showError())}hide(){}destroy(){this.header.destroy(),$2Eggz.BB.destroyEl(this.storeButtonEl),$2Eggz.BB.destroyEl(this.clearButtonEl),clearInterval(this.updateAgeInterval),this.projectStore.unsubscribe(this.storeListener)}constructor(t){var e,i;if(this.previewEl={},this.ageEl={},this.emptyEl={},this.storeButtonEl={},this.clearButtonEl={},this.storeListener={},this.isFirst=!0,this.updateAgeInterval=setInterval(()=>this.updateAge(),6e4),this.projectStore=t.projectStore,this.getProject=t.getProject,this.onStored=t.onStored,this.klRootEl=t.klRootEl,this.applyUncommitted=t.applyUncommitted,this.options=t.options,this.onOpen=t.onOpen,this.rootEl=$2Eggz.BB.el({}),this.header=new $744217e5b2377ce2$export$852ebaa1b01c8b5a,this.rootEl.append(this.header.getElement()),this.contentEl=$2Eggz.BB.el({parent:this.rootEl}),!this.projectStore.getIsAvailable())return void this.showError();this.previewEl=$2Eggz.BB.el({className:"kl-storage-preview",onClick:()=>{var t,e;return null==(t=(e=this).onOpen)?void 0:t.call(e)},title:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open"),noRef:!0}),this.emptyEl=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("file-storage-empty")}),this.ageEl=$2Eggz.BB.el({css:{position:"absolute",right:"0",bottom:"0",width:"100%",textAlign:"center",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"13px"}}),this.onOpen&&(this.openButtonEl=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open"),css:{margin:"0"},onClick:()=>{var t,e;return null==(t=(e=this).onOpen)?void 0:t.call(e)},noRef:!0})),this.storeButtonEl=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$63d0b335c576c718$export$ce37e184d908d785("file-storage-store"),css:{margin:"0"},onClick:()=>this.store(),noRef:!0}),this.clearButtonEl=$2Eggz.BB.el({tagName:"button",className:"grid-button kl-button-delete",content:'<img src="'+$parcel$interopDefault($03e87c70019af696$exports)+'" height="20"/> '+$63d0b335c576c718$export$ce37e184d908d785("file-storage-clear"),css:{margin:"0"},onClick:()=>this.clear(),noRef:!0}),(null==(e=this.options)?void 0:e.isFocusable)||(this.openButtonEl&&(0,$jmKbV.makeUnfocusable)(this.openButtonEl),(0,$jmKbV.makeUnfocusable)(this.storeButtonEl),(0,$jmKbV.makeUnfocusable)(this.clearButtonEl)),(null==(i=this.options)?void 0:i.hideClearButton)&&(this.clearButtonEl.style.visibility="hidden"),this.contentEl.append($2Eggz.BB.el({content:[$2Eggz.BB.el({content:this.previewEl,css:{alignSelf:"stretch",flexGrow:"1"}}),$2Eggz.BB.el({content:[this.openButtonEl,this.storeButtonEl,this.clearButtonEl],css:{display:"flex",gap:"10px",flexDirection:"column"}})],css:{marginTop:"10px",display:"flex",gap:"10px"}})),this.storeListener={onUpdate:t=>{this.updateThumb(null==t?void 0:t.timestamp,null==t?void 0:t.thumbnail)}},this.projectStore.subscribe(this.storeListener),this.updateThumb()}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$ao0qX=parcelRequire("ao0qX");let $c39dea662ab37110$export$f14c2a28fc1e9841=240;function $c39dea662ab37110$export$fe58198efe02b173(t){return new Promise((e,i)=>{let s=new Image;try{s.src=$2Eggz.BB.imageBlobToUrl(t)}catch(t){i("imageBlobToUrl, "+(t instanceof Error?t.message:""));return}s.onload=()=>{URL.revokeObjectURL(s.src),e(s)},s.onabort=()=>{URL.revokeObjectURL(s.src),i("layer image failed loading (abort)")},s.onerror=()=>{URL.revokeObjectURL(s.src),i("layer image failed loading (error)")}})}class $c39dea662ab37110$export$f3c1ac6650038646{static createThumbnail(t){let e=$2Eggz.BB.fitInto(t.width,t.height,$c39dea662ab37110$export$f14c2a28fc1e9841,$c39dea662ab37110$export$f14c2a28fc1e9841).width/t.width;return $2b8bf7b32e5ba51f$export$5f63a7b18dc4503a(t,e)}static async createStorageProject(t){let e=[];for(let s of t.layers){var i;let t;if(s.image instanceof HTMLCanvasElement)t=await (0,$ao0qX.canvasToBlob)(s.image,"image/png");else throw Error("Not implemented");e.push({name:s.name,isVisible:s.isVisible,opacity:s.opacity,mixModeStr:null!=(i=s.mixModeStr)?i:"source-over",blob:t})}return{id:1,projectId:t.projectId,timestamp:new Date().getTime(),thumbnail:await (0,$ao0qX.canvasToBlob)($c39dea662ab37110$export$f3c1ac6650038646.createThumbnail(t),"image/png"),width:t.width,height:t.height,layers:e}}static async readStorageProject(t){if(!t.width||!t.height||isNaN(t.width)||isNaN(t.height)||t.width<1||t.height<1)throw Error("readStorageProject invalid canvas size: "+t.width+", "+t.height);return{project:{projectId:t.projectId,width:t.width,height:t.height,layers:(await Promise.all(t.layers.map(e=>e.blob?$c39dea662ab37110$export$fe58198efe02b173(e.blob).catch(()=>new Image(t.width,t.height)):new Image(t.width,t.height)))).map((e,i)=>{let s=t.layers[i];return{name:s.name,isVisible:s.isVisible,opacity:s.opacity,mixModeStr:s.mixModeStr,image:e}})},timestamp:t.timestamp,thumbnail:await $c39dea662ab37110$export$fe58198efe02b173(t.thumbnail).catch(()=>new Image($c39dea662ab37110$export$f14c2a28fc1e9841,$c39dea662ab37110$export$f14c2a28fc1e9841))}}static async readStorageMeta(t){return{projectId:t.projectId,timestamp:t.timestamp,thumbnail:t.thumbnail?await $c39dea662ab37110$export$fe58198efe02b173(t.thumbnail).catch(()=>new Image($c39dea662ab37110$export$f14c2a28fc1e9841,$c39dea662ab37110$export$f14c2a28fc1e9841)):$2Eggz.BB.canvas(10,10)}}}var $dGRuJ=parcelRequire("dGRuJ"),$VM6dD=parcelRequire("VM6dD");let $4371a4d2eefbd53f$var$areBlobUrlsSupported=async function(){let t=!0,e="kl-blob-url-test";try{let t=new Blob(["test"],{type:"text/plain"}),i=await (0,$VM6dD.timeoutWrapper)(new Promise((t,i)=>{let s=indexedDB.open(e,1);s.onerror=()=>i(s.error),s.onsuccess=()=>t(s.result),s.onupgradeneeded=t=>{t.target.result.createObjectStore("testStore")}}),"areBlobUrlsSupported.createDb");await (0,$VM6dD.timeoutWrapper)(new Promise((e,s)=>{let n=i.transaction("testStore","readwrite"),r=n.objectStore("testStore").put(t,"testStore");n.onabort=()=>e(),r.onsuccess=()=>e(),r.onerror=()=>s(r.error)}),"areBlobUrlsSupported.storeBlob"),i.close()}catch(e){t=!1}try{indexedDB.deleteDatabase(e)}catch(t){}return t};class $4371a4d2eefbd53f$export$7d13d7c63364db4b{disconnect(){var t;null==(t=this.db)||t.close(),this.db=void 0}async autoDisconnectWrapper(t){try{return this.openTransactionCount++,clearTimeout(this.disconnectTimeout),await t()}finally{this.openTransactionCount--,0===this.openTransactionCount&&(clearTimeout(this.disconnectTimeout),this.disconnectTimeout=setTimeout(()=>this.disconnect(),1e3))}}async openDb(){if(!this.db)return new Promise((t,e)=>{let i=indexedDB.open(this.dbName,this.dbVersion);i.onupgradeneeded=t=>{this.upgrader(t)},i.onsuccess=e=>{this.db=e.target.result,this.db.onversionchange=()=>{throw this.isAvailable=!1,this.disconnect(),Error("idb onversionchange")},t()},i.onerror=t=>{this.isAvailable=!1,e(t.target.error)}})}getTransaction(t,e){if(!this.storeNames.includes(t))throw Error(`indexedDb store "${t}" not found in "${this.dbName}"`);let i=this.db.transaction(t,e);return{transaction:i,objectStore:i.objectStore(t)}}init(t,e,i,s){if(""!==this.dbName)throw Error("IndexedDb already initialized");this.dbName=t,this.storeNames=[...e],this.dbVersion=i,this.upgrader=s}async testConnection(){if(this.isAvailable=this.isAvailable&&await $4371a4d2eefbd53f$var$areBlobUrlsSupported(),!this.isAvailable)return this.isAvailable;try{for(let t of this.storeNames){await (0,$VM6dD.timeoutWrapper)(this.openDb(),"indexed-db.testConnection.openDb");let{transaction:e}=this.getTransaction(t,"readonly");e.abort()}}catch(t){this.isAvailable=!1}return this.isAvailable}async set(t,e,i){return this.autoDisconnectWrapper(async()=>(await this.openDb(),await new Promise((s,n)=>{let{transaction:r,objectStore:a}=this.getTransaction(t,"readwrite");r.onabort=()=>n(r.error);let o=a.put(i,e);o.onsuccess=()=>{s()},o.onerror=()=>n(o.error)})))}async get(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),await new Promise((i,s)=>{let{transaction:n,objectStore:r}=this.getTransaction(t,"readonly");n.onabort=()=>s(n.error);let a=r.get(e);a.onsuccess=()=>i(a.result),a.onerror=()=>s(a.error)})))}async has(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),await new Promise((i,s)=>{let{transaction:n,objectStore:r}=this.getTransaction(t,"readonly");n.onabort=()=>s(n.error);let a=r.getKey(e);a.onsuccess=()=>i(!!a.result),a.onerror=()=>s(a.error)})))}async getKeys(t){return this.autoDisconnectWrapper(async()=>(await this.openDb(),await new Promise((e,i)=>{let{transaction:s,objectStore:n}=this.getTransaction(t,"readonly");s.onabort=()=>i(s.error);let r=n.getAllKeys();r.onsuccess=()=>e(r.result.map(t=>t.toString())),r.onerror=()=>i(r.error)})))}async remove(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),await new Promise((i,s)=>{let{transaction:n,objectStore:r}=this.getTransaction(t,"readwrite");n.onabort=()=>s(n.error);let a=r.delete(e);a.onsuccess=()=>{i()},a.onerror=()=>s(a.error)})))}async bulkSet(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),new Promise((i,s)=>{let{transaction:n,objectStore:r}=this.getTransaction(t,"readwrite");for(let{key:t,value:a}of(n.onabort=()=>s(n.error),n.onerror=()=>s(n.error),n.oncomplete=()=>i(),e)){let e=r.put(a,t);e.onerror=()=>s(e.error)}})))}async bulkGet(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),new Promise((i,s)=>{let n={},{transaction:r,objectStore:a}=this.getTransaction(t,"readonly");r.onabort=()=>s(r.error),r.onerror=()=>s(r.error),r.oncomplete=()=>i(n),e.forEach((t,e)=>{let i=a.get(t);i.onsuccess=()=>n[""+t]=i.result,i.onerror=()=>s(i.error)})})))}async bulkRemove(t,e){return this.autoDisconnectWrapper(async()=>(await this.openDb(),new Promise((i,s)=>{let{transaction:n,objectStore:r}=this.getTransaction(t,"readwrite");for(let t of(n.onabort=()=>s(n.error),n.onerror=()=>s(n.error),n.oncomplete=()=>i(),e)){let e=r.delete(t);e.onerror=()=>s(e.error)}})))}getIsAvailable(){return this.isAvailable}destroy(){this.disconnect()}constructor(t){this.dbVersion=-1,this.dbName="",this.storeNames=[],this.upgrader=()=>{},this.isAvailable=!0,this.openTransactionCount=0}}let $2a3419e253354ddb$var$dbName="Klecks";function $2a3419e253354ddb$export$620c18ffd80459f1(){return $2a3419e253354ddb$var$dbName}let $2a3419e253354ddb$export$aa8c311c20a0e91f="RecoveryStore",$2a3419e253354ddb$export$ca20f3c4ac3fef1e="ImageDataStore",$2a3419e253354ddb$export$2ca9aea562746b89="ProjectStore",$2a3419e253354ddb$export$94f2205ed1af0024=[$2a3419e253354ddb$export$aa8c311c20a0e91f,$2a3419e253354ddb$export$ca20f3c4ac3fef1e,$2a3419e253354ddb$export$2ca9aea562746b89],$2a3419e253354ddb$export$889f6d04a9c72786=2,$2a3419e253354ddb$export$a11d3f631bfac1e6=t=>{let e=t.oldVersion,i=t.target.result;e<1&&i.createObjectStore($2a3419e253354ddb$export$2ca9aea562746b89,{keyPath:"id"}).createIndex("id","id",{unique:!0}),e<2&&(i.createObjectStore($2a3419e253354ddb$export$ca20f3c4ac3fef1e),i.createObjectStore($2a3419e253354ddb$export$aa8c311c20a0e91f))},$2a3419e253354ddb$export$8d693ea241b9d9a6=new $4371a4d2eefbd53f$export$7d13d7c63364db4b({});var $VM6dD=parcelRequire("VM6dD"),$2Eggz=parcelRequire("2Eggz"),$ao0qX=parcelRequire("ao0qX");function $e42d359db0fc5c76$export$96cc750ad8f2b8b0(t){return"object"==typeof t&&null!==t&&"id"in t&&"string"==typeof t.id}async function $e42d359db0fc5c76$var$createFallbackThumbnail(){return await (0,$ao0qX.canvasToBlob)($2Eggz.BB.canvas($c39dea662ab37110$export$f14c2a28fc1e9841,$c39dea662ab37110$export$f14c2a28fc1e9841),"image/png")}class $e42d359db0fc5c76$export$93d91060b9af7e2a{async lowLevelStore(t){let e=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$2ca9aea562746b89,1),i=[];if(e)for(let t of($e42d359db0fc5c76$export$96cc750ad8f2b8b0(e.thumbnail)&&i.push(e.thumbnail.id),e.layers))$e42d359db0fc5c76$export$96cc750ad8f2b8b0(t.blob)&&i.push(t.blob.id);let s=[],n={id:(0,$VM6dD.randomUuid)()};s.push({id:n.id,data:t.thumbnail});let r=[];for(let e of t.layers){let t={id:(0,$VM6dD.randomUuid)()};s.push({id:t.id,data:e.blob}),r.push((0,$9FMZM._)((0,$wpIFA._)({},e),{blob:t}))}let a=(0,$9FMZM._)((0,$wpIFA._)({},t),{thumbnail:n,layers:r});for(let t of s)await $2a3419e253354ddb$export$8d693ea241b9d9a6.set($2a3419e253354ddb$export$ca20f3c4ac3fef1e,t.id,t.data);for(let t of(await $2a3419e253354ddb$export$8d693ea241b9d9a6.set($2a3419e253354ddb$export$2ca9aea562746b89,void 0,a),i))await $2a3419e253354ddb$export$8d693ea241b9d9a6.remove($2a3419e253354ddb$export$ca20f3c4ac3fef1e,t)}async lowLevelReadMeta(){var t;let e,i=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$2ca9aea562746b89,1);if(i){if($e42d359db0fc5c76$export$96cc750ad8f2b8b0(i.thumbnail)){let t=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$ca20f3c4ac3fef1e,i.thumbnail.id);(0,$VM6dD.isBlob)(t)&&(e=t)}else e=i.thumbnail;return e=null!=e?e:await $e42d359db0fc5c76$var$createFallbackThumbnail(),{projectId:null!=(t=i.projectId)?t:(0,$VM6dD.randomUuid)(),timestamp:i.timestamp,thumbnail:e}}}async lowLevelRead(){var t,e,i;let s,n=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$2ca9aea562746b89,1);if(!n)return;if($e42d359db0fc5c76$export$96cc750ad8f2b8b0(n.thumbnail)){let t=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$ca20f3c4ac3fef1e,n.thumbnail.id);(0,$VM6dD.isBlob)(t)&&(s=t)}else s=n.thumbnail;s=null!=s?s:await $e42d359db0fc5c76$var$createFallbackThumbnail();let r=[];for(let i of n.layers){let s;if($e42d359db0fc5c76$export$96cc750ad8f2b8b0(i.blob)){let t=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$ca20f3c4ac3fef1e,i.blob.id);(0,$VM6dD.isBlob)(t)&&(s=t)}else s=i.blob;r.push((0,$9FMZM._)((0,$wpIFA._)({},i),{isVisible:null==(t=i.isVisible)||t,mixModeStr:null!=(e=i.mixModeStr)?e:"source-over",blob:s}))}return(0,$9FMZM._)((0,$wpIFA._)({},n),{projectId:null!=(i=n.projectId)?i:(0,$VM6dD.randomUuid)(),thumbnail:s,layers:r})}async lowLevelClear(){let t=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$2ca9aea562746b89,1),e=[];if(t)for(let i of($e42d359db0fc5c76$export$96cc750ad8f2b8b0(t.thumbnail)&&e.push(t.thumbnail.id),t.layers))$e42d359db0fc5c76$export$96cc750ad8f2b8b0(i.blob)&&e.push(i.blob.id);for(let t of(await $2a3419e253354ddb$export$8d693ea241b9d9a6.remove($2a3419e253354ddb$export$2ca9aea562746b89,1),e))await $2a3419e253354ddb$export$8d693ea241b9d9a6.remove($2a3419e253354ddb$export$ca20f3c4ac3fef1e,t)}emit(t){this.currentMeta=t?(0,$wpIFA._)({},t):void 0,this.listeners.forEach(e=>{e.onUpdate(t)})}updateTimestamp(){$dGRuJ.LocalStorage.setItem("indexedDbUpdatedAt",""+new Date().getTime())}async update(){try{this.emit(await this.readMeta())}catch(t){t instanceof Error&&0===t.message.indexOf("db-error")&&(this.isAvailable=!1)}}async read(){let t,e;try{t=await this.lowLevelRead()}catch(t){throw this.isAvailable=!1,Error("db-error: "+t)}if(t){try{e=await $c39dea662ab37110$export$f3c1ac6650038646.readStorageProject(t)}catch(t){throw Error("format-error: "+t)}return e}}async readMeta(){let t,e;try{t=await this.lowLevelReadMeta()}catch(t){throw this.isAvailable=!1,Error("db-error: "+t)}if(t){try{e=await $c39dea662ab37110$export$f3c1ac6650038646.readStorageMeta(t)}catch(t){throw Error("format-error: "+t)}return e}}async store(t){try{let e=await $c39dea662ab37110$export$f3c1ac6650038646.createStorageProject(t);await this.lowLevelStore(e)}catch(t){throw this.isAvailable=!1,Error("db-error: "+t)}this.updateTimestamp(),setTimeout(async()=>{let t=await this.readMeta();this.emit(t)})}async clear(){await this.lowLevelClear(),this.updateTimestamp(),setTimeout(()=>this.emit(),0)}subscribe(t){this.listeners.includes(t)||this.listeners.push(t)}unsubscribe(t){for(let e=0;e<this.listeners.length;e++)if(t===this.listeners[e])return void this.listeners.splice(e,1)}getIsAvailable(){return this.isAvailable=this.isAvailable&&$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable(),this.isAvailable}getCurrentMeta(){return this.currentMeta}constructor(){if(this.listeners=[],this.isAvailable=!0,!$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable()){this.isAvailable=!1;return}window.addEventListener("storage",async t=>{"indexedDbUpdatedAt"===t.key&&0!==this.listeners.length&&await this.update()})}}var $2Eggz=parcelRequire("2Eggz"),$3be8226e2ed33509$exports={};$3be8226e2ed33509$exports=$parcel$resolve("k0KEP");var $dGRuJ=parcelRequire("dGRuJ"),$2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");async function $9a850f0c4a7704d4$export$151da384cc114748(){return(await $2a3419e253354ddb$export$8d693ea241b9d9a6.getKeys($2a3419e253354ddb$export$aa8c311c20a0e91f)).map(t=>+t)}async function $9a850f0c4a7704d4$export$1fabc8133caf46e2(){return await $2a3419e253354ddb$export$8d693ea241b9d9a6.getKeys($2a3419e253354ddb$export$ca20f3c4ac3fef1e)}async function $9a850f0c4a7704d4$export$907f896f070645af(){let t=await $2a3419e253354ddb$export$8d693ea241b9d9a6.getKeys($2a3419e253354ddb$export$aa8c311c20a0e91f),e=await Promise.all(t.map(t=>$2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,t)));await Promise.all(e.map((e,i)=>e.timestamp<new Date().getTime()-$b2aa268a64dedc9f$export$9c6f65e1c28cc08e?$9a850f0c4a7704d4$export$9c7685b8d5826628(t[i]):Promise.resolve()))}async function $9a850f0c4a7704d4$var$loadFromImageDataStore(t,e){let i=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$ca20f3c4ac3fef1e,t);if(!i)return e.clearRect(0,0,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),e.getImageData(0,0,$d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6);if((0,$VM6dD.isBlob)(i)){var s,n;let t;try{t=await $c39dea662ab37110$export$fe58198efe02b173(i)}catch(t){}return e.canvas.width=null!=(s=null==t?void 0:t.width)?s:e.canvas.width,e.canvas.height=null!=(n=null==t?void 0:t.height)?n:e.canvas.height,t&&e.drawImage(t,0,0),e.getImageData(0,0,e.canvas.width,e.canvas.height)}return i}async function $9a850f0c4a7704d4$var$getRawRecoveryProject(t){return await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,""+t)}async function $9a850f0c4a7704d4$export$4484d7cddf79b0c1(t){let e=null!=t?t:await $9a850f0c4a7704d4$export$1fabc8133caf46e2(),i=new Set;for(let t of(await $9a850f0c4a7704d4$export$151da384cc114748())){let e=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,""+t);if(e){for(let t of e.layers)for(let e of t.image)$15ded6c5722f2bc8$export$dba0834b723f37f4(e)||i.add(e.id);i.add(e.thumbnail)}}let s=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$2ca9aea562746b89,1);if(s)for(let t of($e42d359db0fc5c76$export$96cc750ad8f2b8b0(s.thumbnail)&&i.add(s.thumbnail.id),s.layers))$e42d359db0fc5c76$export$96cc750ad8f2b8b0(t.blob)&&i.add(t.blob.id);await $2a3419e253354ddb$export$8d693ea241b9d9a6.bulkRemove($2a3419e253354ddb$export$ca20f3c4ac3fef1e,e.filter(t=>!i.has(t)))}async function $9a850f0c4a7704d4$export$a6d4bfb7a7d18ef3(t){var e;let i=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,""+t);if(void 0===i)return;let s=$2Eggz.BB.canvas($d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),n=$2Eggz.BB.ctx(s),r=[];return await Promise.all(i.layers.map(async(t,e)=>{let i=[];for(let e=0;e<t.image.length;e++){let s=t.image[e];$15ded6c5722f2bc8$export$dba0834b723f37f4(s)?i.push(s):i.push({id:s.id,data:await $9a850f0c4a7704d4$var$loadFromImageDataStore(s.id,n)})}r[e]=(0,$9FMZM._)((0,$wpIFA._)({},t),{image:i})})),{project:{projectId:null!=(e=i.projectId)?e:(0,$VM6dD.randomUuid)(),width:i.width,height:i.height,layers:r},timestamp:0,thumbnail:await $9a850f0c4a7704d4$var$getThumbnail(i.thumbnail)}}async function $9a850f0c4a7704d4$var$getThumbnail(t){let e=$2Eggz.BB.canvas($d2dccce11beb16cf$export$f7bc58374d6bc9b6,$d2dccce11beb16cf$export$f7bc58374d6bc9b6),i=$2Eggz.BB.ctx(e),s=await $9a850f0c4a7704d4$var$loadFromImageDataStore(t,i);return e.width=s.width,e.height=s.height,i.putImageData(s,0,0),e}async function $9a850f0c4a7704d4$export$896fee2a85b1fc93(t,e){let i=await $9a850f0c4a7704d4$var$getRawRecoveryProject(t);return!!i&&(i.timestamp=new Date().getTime(),await $2a3419e253354ddb$export$8d693ea241b9d9a6.set($2a3419e253354ddb$export$aa8c311c20a0e91f,""+e,i),await $2a3419e253354ddb$export$8d693ea241b9d9a6.remove($2a3419e253354ddb$export$aa8c311c20a0e91f,""+t),!0)}async function $9a850f0c4a7704d4$export$b9ecabbf4820fa1b(t,e,i){let s;try{let n=(0,$VM6dD.fitInto)(e.size.width,e.size.height,$b2aa268a64dedc9f$export$b5a0d0be1c619a31,$b2aa268a64dedc9f$export$c9c3d910b57c6d44),r=i(n.width/e.size.width),a=Object.values(e.layerMap).sort($a57b9cfc6d913e03$export$87eabc555ccfbb9f),o=await (0,$VM6dD.timeoutWrapper)($9a850f0c4a7704d4$var$getRawRecoveryProject(t),"storeRecovery.getRawRecoveryProject"),l=new Set(null==o?void 0:o.layers.flatMap(t=>t.image.map(t=>$15ded6c5722f2bc8$export$dba0834b723f37f4(t)?void 0:t.id).filter(t=>void 0!==t)));o&&l.add(o.thumbnail);let h={};o&&o.layers.forEach(t=>{t.image.forEach(t=>{$15ded6c5722f2bc8$export$dba0834b723f37f4(t)||(h[t.id]=t.sizeBytes||0)})});let c=new Set(a.flatMap(t=>t.tiles.flatMap(t=>$15ded6c5722f2bc8$export$dba0834b723f37f4(t)?[]:[t.id])));s=[...l].filter(t=>!c.has(t));let d=[],p=[],u=0;for(let t of a)d.push({name:t.name,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,image:await (async()=>{let e=[];for(let i of t.tiles)if($15ded6c5722f2bc8$export$dba0834b723f37f4(i))e.push(i),u+=i.fill.length;else{let t=0;l.has(i.id)?t=h[i.id]:(p.push({id:i.id,data:i.data}),t=i.data.width*i.data.height*4),u+=t,e.push({id:i.id,sizeBytes:t})}return e})()});let g={id:(0,$VM6dD.randomUuid)(),data:$2Eggz.BB.ctx(r).getImageData(0,0,r.width,r.height)};p.push(g),u+=g.data.width*g.data.height*4;let m={projectId:e.projectId.value,width:e.size.width,height:e.size.height,timestamp:new Date().getTime(),thumbnail:g.id,layers:d,memoryEstimateBytes:u},f=await (0,$VM6dD.timeoutWrapper)($9a850f0c4a7704d4$var$getTotalMemoryExceptCurrentDrawing(t),"storeRecovery.getTotalMemory");if(f+u>$b2aa268a64dedc9f$export$2740edb783d24e35){let t=f+u-$b2aa268a64dedc9f$export$2740edb783d24e35,e=0,i=[];for(let s of((await $9a850f0c4a7704d4$var$getAllMeta()).sort((t,e)=>t.timestamp>e.timestamp?1:t.timestamp<e.timestamp?-1:0).forEach(s=>{e>=t||(i.push(s.id),e+=s.memoryEstimateBytes)}),i))await $9a850f0c4a7704d4$export$9c7685b8d5826628(s)}await (0,$VM6dD.timeoutWrapper)($2a3419e253354ddb$export$8d693ea241b9d9a6.bulkSet($2a3419e253354ddb$export$ca20f3c4ac3fef1e,p.map(t=>({key:t.id,value:t.data}))),"storeRecovery.storeTile",3e4),await (0,$VM6dD.timeoutWrapper)($2a3419e253354ddb$export$8d693ea241b9d9a6.set($2a3419e253354ddb$export$aa8c311c20a0e91f,""+t,m),"storeRecovery.storeRecovery")}finally{await (0,$VM6dD.timeoutWrapper)($9a850f0c4a7704d4$export$4484d7cddf79b0c1(s),"storeRecovery.removeOrphans",8e3)}}async function $9a850f0c4a7704d4$export$9c7685b8d5826628(t){let e=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,t);if(!e)return;await $2a3419e253354ddb$export$8d693ea241b9d9a6.remove($2a3419e253354ddb$export$aa8c311c20a0e91f,t);let i=[e.thumbnail];for(let t of e.layers)for(let e of t.image)$15ded6c5722f2bc8$export$dba0834b723f37f4(e)||i.push(e.id);await $9a850f0c4a7704d4$export$4484d7cddf79b0c1(i)}async function $9a850f0c4a7704d4$var$getAllMeta(){let t=await $9a850f0c4a7704d4$export$151da384cc114748(),e=[];for(let i of t)e.push(await $9a850f0c4a7704d4$export$8548546c0aa631e6(""+i));return e}async function $9a850f0c4a7704d4$var$getTotalMemoryExceptCurrentDrawing(t){let e=await $9a850f0c4a7704d4$export$151da384cc114748(),i=0;for(let s of e)s!==t&&(i+=(await $9a850f0c4a7704d4$export$8548546c0aa631e6(""+s)).memoryEstimateBytes);return i}async function $9a850f0c4a7704d4$export$8548546c0aa631e6(t,e){let i=await $2a3419e253354ddb$export$8d693ea241b9d9a6.get($2a3419e253354ddb$export$aa8c311c20a0e91f,t);if(void 0===i)throw Error("drawing not found");let s=i;return{id:t,width:s.width,height:s.height,thumbnail:e?await $9a850f0c4a7704d4$var$getThumbnail(s.thumbnail):void 0,timestamp:s.timestamp,memoryEstimateBytes:s.memoryEstimateBytes}}var $VM6dD=parcelRequire("VM6dD"),$dGRuJ=parcelRequire("dGRuJ"),$VM6dD=parcelRequire("VM6dD");let $a12bfee0fab37a82$var$originId=(0,$VM6dD.randomUuid)();class $a12bfee0fab37a82$export$84f7c9d87f70395e{getLsKey(){return this.localStoragePrefix+this.name}postMessage(t){if(this.broadcastChannel)this.broadcastChannel.postMessage(t);else{let e=new Date().getTime(),i=null;try{i=$dGRuJ.LocalStorage.getItem(this.getLsKey())}catch(t){}let s=null===i?[]:JSON.parse(i);(s=s.filter(t=>t.timestamp>e-this.maxAgeMs)).push({timestamp:e,originId:$a12bfee0fab37a82$var$originId,message:t}),$dGRuJ.LocalStorage.setItem(this.getLsKey(),JSON.stringify(s))}}subscribe(t){if(this.broadcastChannel){let e=e=>t(e.data);this.broadcastChannelListeners.push({preListener:e,listener:t}),this.broadcastChannel.addEventListener("message",e)}else 0===this.localStorageListeners.size&&window.addEventListener("storage",this.onLocalStorageChange),this.localStorageListeners.add(t)}unsubscribe(t){if(this.broadcastChannel){let e=this.broadcastChannelListeners.find(e=>e.listener===t);e&&this.broadcastChannel.removeEventListener("message",e.preListener)}else this.localStorageListeners.delete(t),0===this.localStorageListeners.size&&window.removeEventListener("storage",this.onLocalStorageChange)}close(){this.broadcastChannel&&this.broadcastChannel.close()}constructor(t){this.name=t,this.broadcastChannelListeners=[],this.lastReadTimestamp=new Date().getTime(),this.maxAgeMs=1e4,this.localStoragePrefix="cross-tab-channel--",this.localStorageListeners=new Set,this.onLocalStorageChange=t=>{if(t.key===this.getLsKey()&&null!==t.newValue)try{JSON.parse(t.newValue).forEach(t=>{t.originId===$a12bfee0fab37a82$var$originId||t.timestamp<=this.lastReadTimestamp||(this.lastReadTimestamp=t.timestamp,this.localStorageListeners.forEach(e=>e(t.message)))})}catch(t){$dGRuJ.LocalStorage.removeItem(this.getLsKey())}},"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel(t))}}let $b2aa268a64dedc9f$export$b5a0d0be1c619a31=300,$b2aa268a64dedc9f$export$c9c3d910b57c6d44=180,$b2aa268a64dedc9f$export$9c6f65e1c28cc08e=6048e5,$b2aa268a64dedc9f$export$2740edb783d24e35=1e9,$b2aa268a64dedc9f$var$FIRST_RECOVERY_AFTER_MS=3e5,$b2aa268a64dedc9f$export$9bd5f64d90351bc8=8,$b2aa268a64dedc9f$var$SUBSEQUENT_RECOVERY_AFTER_MS=6e4,$b2aa268a64dedc9f$var$SUBSEQUENT_RECOVERY_AFTER_CHANGES=4,$b2aa268a64dedc9f$export$c72bbe997bb2ffd=!1,$b2aa268a64dedc9f$export$fc41dada2b63b3f2=!1;function $b2aa268a64dedc9f$export$42c3f3255a992e7(t){void 0===t?history.replaceState(null,""," "):history.replaceState(null,"",window.location.origin+window.location.pathname+window.location.search+"#"+t)}function $b2aa268a64dedc9f$var$getHash(){return window.location.hash?window.location.hash.substring(1):void 0}let $b2aa268a64dedc9f$var$ignoredHashes=["licenses"];function $b2aa268a64dedc9f$var$hashToTabId(t){if(void 0===t||$b2aa268a64dedc9f$var$ignoredHashes.includes(t))return;let e=+t;if(!isNaN(e)&&!(e<0)&&e%1==0)return e}function $b2aa268a64dedc9f$var$genNewId(t){let e=1e3;if(t.length>=e)throw Error("No available IDs");let i=new Set(t),s=(0,$VM6dD.createArray)(e,0).map((t,e)=>e).filter(t=>!i.has(t)),n=Math.floor(Math.random()*s.length);if(void 0===s[n])throw Error("No available IDs");return s[n]}class $b2aa268a64dedc9f$export$36c5c4b26ead79bd{announceTabId(){this.crossTabChannel.postMessage({type:"new-tab"})}initListeners(){document.addEventListener("visibilitychange",()=>{document.hidden||setTimeout(()=>{this.update()},500)}),window.addEventListener("focus",()=>{setTimeout(()=>{this.update()},500)}),this.crossTabChannel.subscribe(t=>{if("new-tab"===t.type){if(document.hidden)return;setTimeout(()=>{this.update()},500)}"request-ids"===t.type&&void 0!==this.tabId&&this.crossTabChannel.postMessage({type:"response-ids",id:this.tabId})})}async emitUpdate(){if(!$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable())return;let t=await $9a850f0c4a7704d4$export$151da384cc114748(),e=await this.getIdsFromTabs(),i=$b2aa268a64dedc9f$export$c72bbe997bb2ffd?t:t.filter(t=>!e.includes(t)&&t!==this.tabId),s=await Promise.all(i.map(t=>$9a850f0c4a7704d4$export$8548546c0aa631e6(""+t,!0))),n=await this.getTotalMemoryUsedBytes();this.listeners.forEach(t=>{t(s,n)})}setHash(t){$b2aa268a64dedc9f$export$42c3f3255a992e7(void 0===t?void 0:""+t),this.announceTabId()}async getIdsFromTabs(){this.crossTabChannel.postMessage({type:"request-ids"});let t=[],e=e=>{"response-ids"===e.type&&t.push(+e.id)};return this.crossTabChannel.subscribe(e),await (0,$VM6dD.sleep)(100),this.crossTabChannel.unsubscribe(e),t}async getTotalMemoryUsedBytes(){let t=await $9a850f0c4a7704d4$export$151da384cc114748(),e=0;for(let i of t)e+=(await $9a850f0c4a7704d4$export$8548546c0aa631e6(""+i)).memoryEstimateBytes;return e}async getRecovery(){let t=$b2aa268a64dedc9f$var$hashToTabId($b2aa268a64dedc9f$var$getHash());if(void 0===t){this.noRecoveryReason="noTabIdHash";return}if((await this.getIdsFromTabs()).includes(t)){this.noRecoveryReason="alreadyOpened",this.setHash(void 0);return}let e=await $9a850f0c4a7704d4$export$151da384cc114748();if(!e.includes(t)){this.noRecoveryReason="idNotFound",this.setHash(void 0);return}let i=$b2aa268a64dedc9f$var$genNewId(e);if(!await $9a850f0c4a7704d4$export$896fee2a85b1fc93(t,i)){this.noRecoveryReason="idChangeFailed",this.setHash(void 0);return}this.setHash(i);let s=await $9a850f0c4a7704d4$export$a6d4bfb7a7d18ef3(i);return s&&(this.tabId=i),setTimeout(()=>{$9a850f0c4a7704d4$export$4484d7cddf79b0c1()}),s}setKlHistory(t){this.klHistory=t;let e=new Date().getTime(),i=0;this.klHistory.addListener(async()=>{if(this.isStoring)return;let t=this.klHistory.getChangeCount();if(!$b2aa268a64dedc9f$export$fc41dada2b63b3f2){let s=new Date().getTime()-e;if(void 0===this.tabId&&(s<$b2aa268a64dedc9f$var$FIRST_RECOVERY_AFTER_MS||t<$b2aa268a64dedc9f$export$9bd5f64d90351bc8)||void 0!==this.tabId&&(s<$b2aa268a64dedc9f$var$SUBSEQUENT_RECOVERY_AFTER_MS||t-i<$b2aa268a64dedc9f$var$SUBSEQUENT_RECOVERY_AFTER_CHANGES))return}let s=!1;if(!this.tabId){let t=await (0,$VM6dD.timeoutWrapper)($9a850f0c4a7704d4$export$151da384cc114748(),"setKlHistory.getIdsFromStore");this.tabId=$b2aa268a64dedc9f$var$genNewId(t),s=!0}this.isStoring=!0;try{await $9a850f0c4a7704d4$export$b9ecabbf4820fa1b(this.tabId,this.klHistory.getComposed(),this.getThumbnail),e=new Date().getTime()}catch(t){setTimeout(()=>{throw t})}s&&(this.setHash(this.tabId),await $9a850f0c4a7704d4$export$907f896f070645af()),e=new Date().getTime(),i=t,this.isStoring=!1})}setGetThumbnail(t){this.getThumbnail=t}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}async update(){this.listeners.size>0&&await this.emitUpdate()}async remove(t){await $9a850f0c4a7704d4$export$9c7685b8d5826628(""+t),this.update()}getTabId(){return this.tabId}getNoRecoveryReason(){return this.noRecoveryReason}destroy(){}constructor(t){this.klHistory={},this.isStoring=!1,this.listeners=new Set,this.crossTabChannel=new $a12bfee0fab37a82$export$84f7c9d87f70395e("kl-tab-communication"),this.initListeners()}}var $ao0qX=parcelRequire("ao0qX");$aa54b3f0adef983e$export$48c2d0f2f545ac27="-c3MRW_preview";var $VM6dD=parcelRequire("VM6dD");class $aa79ddb31a9becd1$export$feb3da9ac0115d49{async update(t,e){let i=[];t.sort((t,e)=>t.timestamp>e.timestamp?-1:+(t.timestamp<e.timestamp)).forEach(t=>{let e=$2Eggz.BB.el({tagName:"a",className:"kl-button kl-button-link",content:$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-recover"),custom:{href:"#"+t.id,target:"_blank"}}),s=$2Eggz.BB.el({tagName:"button",className:"kl-button-delete",content:`<img src="${$parcel$interopDefault($03e87c70019af696$exports)}" height="20"/>${$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-delete")}`,onClick:()=>{s.blur();let e=(0,$ao0qX.copyCanvas)(t.thumbnail);(0,$VM6dD.css)(e,{alignSelf:"start",background:"var(--kl-checkerboard-background)",maxWidth:"100%"}),$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-delete-confirmation"),e],css:{display:"flex",flexDirection:"column",gap:"10px"}}),buttons:[$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-delete"),"Cancel"],deleteButtonName:$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-delete"),callback:async e=>{"Cancel"!==e&&await this.klRecoveryManager.remove(+t.id)}})},noRef:!0}),n=t.thumbnail,r=$2Eggz.BB.el({tagName:"a",content:n,className:$aa54b3f0adef983e$export$48c2d0f2f545ac27,title:$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-recover"),css:{minHeight:$b2aa268a64dedc9f$export$c9c3d910b57c6d44+"px"},custom:{href:"#"+t.id,target:"_blank"}}),a=$2Eggz.BB.el({content:[$61cd8b4e4101a623$export$1b9ca798405c9eb6(t.timestamp),", "+$2Eggz.BB.round(t.memoryEstimateBytes/1e6,1)+" MB"],css:{textAlign:"center"}});i.push($2Eggz.BB.el({content:[r,a,e,s],css:{display:"flex",flexDirection:"column",gap:"5px",maxWidth:"100%"}}))}),this.rootEl.innerHTML="",$b2aa268a64dedc9f$export$c72bbe997bb2ffd&&this.rootEl.append($2Eggz.BB.el({content:"Debug On - SHOWING ALL TABS",css:{background:"red"}})),this.rootEl.append($2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-explanation"),className:"kl-toolspace-note"}),$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-total-quota-label")+" "+$2Eggz.BB.round(e/1e6,1)+" MB / "+$2Eggz.BB.round($b2aa268a64dedc9f$export$2740edb783d24e35/1e6,1)+" MB",css:{margin:"10px 0"}}),$2Eggz.BB.el({content:[...i],css:{display:"flex",flexWrap:"wrap",gap:"20px 10px",justifyContent:"space-evenly"}})),0===i.length&&this.rootEl.append($63d0b335c576c718$export$ce37e184d908d785("tab-recovery-empty"))}getElement(){return this.rootEl}destroy(){this.klRecoveryManager.unsubscribe(this.recoveryListener)}constructor(t){this.recoveryListener=(t,e)=>{this.update(t,e)},this.klRecoveryManager=t.klRecoveryManager,this.rootEl=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("loading")}),this.klRecoveryManager.subscribe(this.recoveryListener),setTimeout(async()=>{try{await this.klRecoveryManager.update()}catch(t){setTimeout(()=>{throw t}),this.rootEl.innerHTML="error"}})}}function $64bb13f3226311c9$export$abc0e2c9b0afece1(t){if(!t||!$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable())return void $49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:document.body,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-cant-access"),buttons:["Ok"]});let e=new $aa79ddb31a9becd1$export$feb3da9ac0115d49({klRecoveryManager:t}),i=$2Eggz.BB.el({content:[e.getElement()]}),s=t=>{e.destroy()};$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-recover-tabs")}</b>`,div:i,buttons:[$63d0b335c576c718$export$ce37e184d908d785("modal-close")],callback:s,style:{width:"calc(100% - 50px)",maxWidth:"1000px",minWidth:"300px",boxSizing:"border-box"},clickOnEnter:"Ok"})}$26979e340e24ad46$export$bd7a7a9fa7e7f04b="Tt6aiG_recoveryBubble";var $VM6dD=parcelRequire("VM6dD");let $dad163782d7c02d0$var$LS_SHOW_SAVE_DIALOG="kl-save-dialog",$dad163782d7c02d0$var$createSpacer=()=>{let t=document.createElement("div"),e=document.createElement("div"),i=$2Eggz.BB.el({className:"grid-hr"});return t.append(e,i),(0,$VM6dD.css)(e,{clear:"both"}),t},$dad163782d7c02d0$var$createButtonContent=(t,e,i)=>`<img ${i?'class="dark-no-invert"':""} src='${e}' alt='icon' height='20'/>${t}`;class $dad163782d7c02d0$export$409b892ffe02580b{refresh(){}getElement(){return this.rootEl}setIsVisible(t){if(t){var e;this.refresh(),null==(e=this.browserStorageUi)||e.show(),this.klRecoveryManager&&(this.klRecoveryManager.subscribe(this.recoveryListener),this.klRecoveryManager.update())}else this.klRecoveryManager&&this.klRecoveryManager.unsubscribe(this.recoveryListener)}triggerImport(){this.importInput&&this.importInput.click()}constructor(t){this.recoveryListener=t=>{if(!this.recoveryCountBubble)return;let e=t.length;0===e?this.recoveryCountBubble.style.display="none":(this.recoveryCountBubble.textContent=""+e,this.recoveryCountBubble.style.display="inline-block")},this.exportType=t.exportType,this.applyUncommitted=t.applyUncommitted,this.rootEl=document.createElement("div"),setTimeout(()=>{var e;let i,s=$2Eggz.BB.el({className:"kl-toolspace-note",textContent:$63d0b335c576c718$export$ce37e184d908d785("file-no-autosave"),css:{margin:"10px 10px 0 10px"}}),n=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$dad163782d7c02d0$var$createButtonContent($63d0b335c576c718$export$ce37e184d908d785("file-new"),$parcel$interopDefault($cecb4b55c8dd017e$exports),!0),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:()=>t.onNewImage()}),r=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$dad163782d7c02d0$var$createButtonContent($63d0b335c576c718$export$ce37e184d908d785("file-import"),$parcel$interopDefault($375749381ca7b7b7$exports),!0),css:{position:"relative",cursor:"pointer",cssFloat:"left"},custom:{tabIndex:"-1"},onClick:()=>this.importInput.click()});this.importInput=$2Eggz.BB.el({tagName:"input",css:{display:"none"},onChange:()=>{this.applyUncommitted(),this.importInput.files&&t.onFileSelect(this.importInput.files,"default"),this.importInput.value=""},custom:{tabIndex:"-1"}}),this.importInput.type="file",this.importInput.multiple=!0,this.importInput.accept="image/*,.psd";let a=$2Eggz.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:$dad163782d7c02d0$var$createButtonContent($63d0b335c576c718$export$ce37e184d908d785("file-save"),$parcel$interopDefault($d94e039749bb6ca4$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left",flex:"1 0 0",margin:"0"},onClick:()=>t.onSaveImageToComputer()}),o="showSaveFilePicker"in window,l=$dGRuJ.LocalStorage.getItem($dad163782d7c02d0$var$LS_SHOW_SAVE_DIALOG),h=null!==l&&"true"===l,c=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:h,label:$63d0b335c576c718$export$ce37e184d908d785("file-show-save-dialog"),callback:e=>{e?$dGRuJ.LocalStorage.setItem($dad163782d7c02d0$var$LS_SHOW_SAVE_DIALOG,"true"):$dGRuJ.LocalStorage.removeItem($dad163782d7c02d0$var$LS_SHOW_SAVE_DIALOG),t.onChangeShowSaveDialog(e)},css:{maxWidth:"fit-content"},name:"show-save-dialog"});t.onChangeShowSaveDialog(h);let d=new $49faab2330529a96$export$6e4a713ddcda1e5e.Select({optionArr:[["png","PNG"],["psd","PSD"],["layers",$63d0b335c576c718$export$ce37e184d908d785("layers")+" (PNG)"]],initValue:this.exportType,onChange:e=>{this.exportType=e,t.onExportTypeChange(this.exportType),t.onSaveImageToComputer()},title:$63d0b335c576c718$export$ce37e184d908d785("file-format"),name:"export-type"});if((0,$VM6dD.css)(d.getElement(),{height:"30px",width:"calc(50% - 10px)",flex:"1 0 0"}),t.projectStore)this.browserStorageUi=new $1a83f3b0ed28fe18$export$9c72cf485ef46673({projectStore:t.projectStore,getProject:t.getProject,klRootEl:t.klRootEl,applyUncommitted:this.applyUncommitted,onOpen:t.onOpenBrowserStorage,onStored:()=>t.onStoredToBrowserStorage()}),(0,$VM6dD.css)(this.browserStorageUi.getElement(),{margin:"10px"});else{let t=new $744217e5b2377ce2$export$852ebaa1b01c8b5a;i=$2Eggz.BB.el({content:[t.getElement(),$2Eggz.BB.el({content:" "+$63d0b335c576c718$export$ce37e184d908d785("file-storage-cant-access"),css:{marginTop:"10px"}})],css:{margin:"10px 10px 0 10px"}})}let p=$2Eggz.BB.el({content:[$2Eggz.BB.el({content:[a,d.getElement()],css:{display:"flex",gap:"10px"}}),...o?[c.getElement()]:[]],css:{display:"flex",flexDirection:"column",gap:"10px",margin:"10px 10px 0 10px"}});this.klRecoveryManager=t.klRecoveryManager;let u=$2Eggz.BB.el({});this.recoveryCountBubble=$2Eggz.BB.el({className:$26979e340e24ad46$export$bd7a7a9fa7e7f04b});let g=$2Eggz.BB.el({tagName:"button",content:[$63d0b335c576c718$export$ce37e184d908d785("tab-recovery-recover-tabs"),this.recoveryCountBubble],onClick:()=>$64bb13f3226311c9$export$abc0e2c9b0afece1(this.klRecoveryManager),custom:{tabIndex:"-1"},css:{margin:"10px 0 0 10px",width:"calc(100% - 20px)"}});u.append(g,$dad163782d7c02d0$var$createSpacer()),(async()=>{this.klRecoveryManager&&(this.klRecoveryManager.subscribe(this.recoveryListener),await this.klRecoveryManager.update(),this.klRecoveryManager.unsubscribe(this.recoveryListener))})();let m=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$dad163782d7c02d0$var$createButtonContent($63d0b335c576c718$export$ce37e184d908d785("file-share"),$parcel$interopDefault($390be88d04af75ef$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:()=>{m.disabled=!0,t.onShareImage(()=>{m.disabled=!1})}}),f=$2Eggz.BB.el({tagName:"button",className:"grid-button",content:$dad163782d7c02d0$var$createButtonContent($63d0b335c576c718$export$ce37e184d908d785("file-upload"),$parcel$interopDefault($3be8226e2ed33509$exports)),custom:{tabIndex:"-1"},css:{cssFloat:"left"},onClick:()=>{t.onUpload()}});$2Eggz.BB.append(this.rootEl,[s,n,r,$2Eggz.BB.el({css:{clear:"both"}}),p,$dad163782d7c02d0$var$createSpacer(),null==(e=this.browserStorageUi)?void 0:e.getElement(),i,$dad163782d7c02d0$var$createSpacer(),u,f,$2Eggz.BB.canShareFiles()?m:void 0,$2Eggz.BB.el({css:{clear:"both"}})])},1)}}var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");function $ed5eddfb5f6912a0$export$d731e22ecd0c25d3(t,e,i,s){(i||this._.texture).use(),this._.spareTexture.drawTo(function(){t.uniforms(e).drawRect()}),this._.spareTexture.swapWith(s||this._.texture)}function $ca843f6dd01906cb$export$b59c6427db8463f4(t){$ca843f6dd01906cb$export$5822a9d0880a5d82=t}var $2Eggz=parcelRequire("2Eggz");let $ba022370a1e95297$var$defaultVertexSource="    attribute vec2 vertex;    attribute vec2 _texCoord;    varying vec2 texCoord;    void main() {        texCoord = _texCoord;        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);    }",$ba022370a1e95297$var$defaultFragmentSource="    uniform sampler2D texture;    varying vec2 texCoord;    void main() {        gl_FragColor = texture2D(texture, texCoord);    }";function $ba022370a1e95297$var$isArray(t){return"[object Array]"==Object.prototype.toString.call(t)}function $ba022370a1e95297$var$isNumber(t){return"[object Number]"==Object.prototype.toString.call(t)}class $ba022370a1e95297$export$7d9b0d118d0c4108{static getDefaultShader(){return $ca843f6dd01906cb$export$5822a9d0880a5d82.defaultShader=$ca843f6dd01906cb$export$5822a9d0880a5d82.defaultShader||new $ba022370a1e95297$export$7d9b0d118d0c4108,$ca843f6dd01906cb$export$5822a9d0880a5d82.defaultShader}compileSource(t,e,i){let s=$2Eggz.BB.throwIfNull($ca843f6dd01906cb$export$5822a9d0880a5d82.createShader(t));if($ca843f6dd01906cb$export$5822a9d0880a5d82.shaderSource(s,e.replace(/#define.*/,"")),$ca843f6dd01906cb$export$5822a9d0880a5d82.compileShader(s),!$ca843f6dd01906cb$export$5822a9d0880a5d82.getShaderParameter(s,$ca843f6dd01906cb$export$5822a9d0880a5d82.COMPILE_STATUS))throw"compile error: "+i+" - "+$ca843f6dd01906cb$export$5822a9d0880a5d82.getShaderInfoLog(s);return s}testPrecisionSupport(t){let e=$ca843f6dd01906cb$export$5822a9d0880a5d82.getShaderPrecisionFormat($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAGMENT_SHADER,t);return null!==e&&0!==e.precision}destroy(){$ca843f6dd01906cb$export$5822a9d0880a5d82.deleteProgram(this.program),this.program=null}uniforms(t){return $ca843f6dd01906cb$export$5822a9d0880a5d82.useProgram(this.program),Object.entries(t).forEach(([t,e])=>{let i=$ca843f6dd01906cb$export$5822a9d0880a5d82.getUniformLocation(this.program,t);if(null!==i)if($ba022370a1e95297$var$isArray(e))switch(e.length){case 1:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform1fv(i,new Float32Array(e));break;case 2:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform2fv(i,new Float32Array(e));break;case 3:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform3fv(i,new Float32Array(e));break;case 4:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform4fv(i,new Float32Array(e));break;case 9:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniformMatrix3fv(i,!1,new Float32Array(e));break;case 16:$ca843f6dd01906cb$export$5822a9d0880a5d82.uniformMatrix4fv(i,!1,new Float32Array(e));break;default:throw"dont't know how to load uniform \""+t+'" of length '+e.length}else if($ba022370a1e95297$var$isNumber(e))$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform1f(i,e);else throw'attempted to set uniform "'+t+'" to invalid value '+(e||"undefined").toString()}),this}textures(t){return $ca843f6dd01906cb$export$5822a9d0880a5d82.useProgram(this.program),Object.entries(t).forEach(([t,e])=>{$ca843f6dd01906cb$export$5822a9d0880a5d82.uniform1i($ca843f6dd01906cb$export$5822a9d0880a5d82.getUniformLocation(this.program,t),e)}),this}drawRect(t,e,i,s){let n,r=$ca843f6dd01906cb$export$5822a9d0880a5d82.getParameter($ca843f6dd01906cb$export$5822a9d0880a5d82.VIEWPORT);e=e!==n?(e-r[1])/r[3]:0,t=t!==n?(t-r[0])/r[2]:0,i=i!==n?(i-r[0])/r[2]:1,s=s!==n?(s-r[1])/r[3]:1,($ca843f6dd01906cb$export$5822a9d0880a5d82.vertexBuffer===n||null===$ca843f6dd01906cb$export$5822a9d0880a5d82.vertexBuffer)&&($ca843f6dd01906cb$export$5822a9d0880a5d82.vertexBuffer=$2Eggz.BB.throwIfNull($ca843f6dd01906cb$export$5822a9d0880a5d82.createBuffer())),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindBuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.vertexBuffer),$ca843f6dd01906cb$export$5822a9d0880a5d82.bufferData($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,new Float32Array([t,e,t,s,i,e,i,s]),$ca843f6dd01906cb$export$5822a9d0880a5d82.STATIC_DRAW),null==$ca843f6dd01906cb$export$5822a9d0880a5d82.texCoordBuffer&&($ca843f6dd01906cb$export$5822a9d0880a5d82.texCoordBuffer=$2Eggz.BB.throwIfNull($ca843f6dd01906cb$export$5822a9d0880a5d82.createBuffer()),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindBuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.texCoordBuffer),$ca843f6dd01906cb$export$5822a9d0880a5d82.bufferData($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),$ca843f6dd01906cb$export$5822a9d0880a5d82.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=$ca843f6dd01906cb$export$5822a9d0880a5d82.getAttribLocation(this.program,"vertex"),$ca843f6dd01906cb$export$5822a9d0880a5d82.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=$ca843f6dd01906cb$export$5822a9d0880a5d82.getAttribLocation(this.program,"_texCoord"),$ca843f6dd01906cb$export$5822a9d0880a5d82.enableVertexAttribArray(this.texCoordAttribute)),$ca843f6dd01906cb$export$5822a9d0880a5d82.useProgram(this.program),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindBuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.vertexBuffer),$ca843f6dd01906cb$export$5822a9d0880a5d82.vertexAttribPointer(this.vertexAttribute,2,$ca843f6dd01906cb$export$5822a9d0880a5d82.FLOAT,!1,0,0),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindBuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.ARRAY_BUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.texCoordBuffer),$ca843f6dd01906cb$export$5822a9d0880a5d82.vertexAttribPointer(this.texCoordAttribute,2,$ca843f6dd01906cb$export$5822a9d0880a5d82.FLOAT,!1,0,0),$ca843f6dd01906cb$export$5822a9d0880a5d82.drawArrays($ca843f6dd01906cb$export$5822a9d0880a5d82.TRIANGLE_STRIP,0,4)}constructor(t,e,i){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=$2Eggz.BB.throwIfNull($ca843f6dd01906cb$export$5822a9d0880a5d82.createProgram()),t=t||$ba022370a1e95297$var$defaultVertexSource,e=e||$ba022370a1e95297$var$defaultFragmentSource,$ba022370a1e95297$var$floatPrecision||($ba022370a1e95297$var$floatPrecision=this.testPrecisionSupport($ca843f6dd01906cb$export$5822a9d0880a5d82.HIGH_FLOAT)?"highp":this.testPrecisionSupport($ca843f6dd01906cb$export$5822a9d0880a5d82.MEDIUM_FLOAT)?"mediump":"lowp"),e="precision "+$ba022370a1e95297$var$floatPrecision+" float;"+e,$ca843f6dd01906cb$export$5822a9d0880a5d82.attachShader(this.program,this.compileSource($ca843f6dd01906cb$export$5822a9d0880a5d82.VERTEX_SHADER,t,i+"(vertex)")),$ca843f6dd01906cb$export$5822a9d0880a5d82.attachShader(this.program,this.compileSource($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAGMENT_SHADER,e,i+"(fragment)")),$ca843f6dd01906cb$export$5822a9d0880a5d82.linkProgram(this.program),!$ca843f6dd01906cb$export$5822a9d0880a5d82.getProgramParameter(this.program,$ca843f6dd01906cb$export$5822a9d0880a5d82.LINK_STATUS))throw"link error: "+$ca843f6dd01906cb$export$5822a9d0880a5d82.getProgramInfoLog(this.program)}}let $7aae3f183f304a55$export$6408eeb1703e74b8=function(t,e){return $ca843f6dd01906cb$export$5822a9d0880a5d82.brightnessContrast=$ca843f6dd01906cb$export$5822a9d0880a5d82.brightnessContrast||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float brightness;        uniform float contrast;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb += brightness;            if (contrast > 0.0) {                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;            } else {                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;            }            gl_FragColor = clamp(color, 0.0, 1.0);        }    ","brightnessContrast"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.brightnessContrast,{brightness:$2Eggz.BB.clamp(t,-1,1),contrast:$2Eggz.BB.clamp(e,-1,1)}),this};var $2Eggz=parcelRequire("2Eggz");class $4f7270b6400c73d7$export$7e6fd232cff50dd1{static fromElement(t){let e=new $4f7270b6400c73d7$export$7e6fd232cff50dd1(0,0,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,$ca843f6dd01906cb$export$5822a9d0880a5d82.UNSIGNED_BYTE);return e.loadContentsOf(t),e}loadContentsOf(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$ca843f6dd01906cb$export$5822a9d0880a5d82.texImage2D($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,this.format,this.type,t)}initFromBytes(t,e,i){this.width=t,this.height=e,this.format=$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,this.type=$ca843f6dd01906cb$export$5822a9d0880a5d82.UNSIGNED_BYTE,$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$ca843f6dd01906cb$export$5822a9d0880a5d82.texImage2D($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,0,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,t,e,0,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,this.type,new Uint8Array(i))}destroy(){$ca843f6dd01906cb$export$5822a9d0880a5d82.deleteTexture(this.id),this.id=null}use(t){$ca843f6dd01906cb$export$5822a9d0880a5d82.activeTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE0+(t||0)),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id)}unuse(t){$ca843f6dd01906cb$export$5822a9d0880a5d82.activeTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE0+(t||0)),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,null)}ensureFormat(t,e,i,s){(t!=this.width||e!=this.height||i!=this.format||s!=this.type)&&(this.width=t,this.height=e,this.format=i,this.type=s,$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$ca843f6dd01906cb$export$5822a9d0880a5d82.texImage2D($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))}ensureFormatViaTexture(t){this.ensureFormat(t.width,t.height,t.format,t.type)}drawTo(t){if($ca843f6dd01906cb$export$5822a9d0880a5d82.framebuffer=$ca843f6dd01906cb$export$5822a9d0880a5d82.framebuffer||$ca843f6dd01906cb$export$5822a9d0880a5d82.createFramebuffer(),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindFramebuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAMEBUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.framebuffer),$ca843f6dd01906cb$export$5822a9d0880a5d82.framebufferTexture2D($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAMEBUFFER,$ca843f6dd01906cb$export$5822a9d0880a5d82.COLOR_ATTACHMENT0,$ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id,0),$ca843f6dd01906cb$export$5822a9d0880a5d82.checkFramebufferStatus($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAMEBUFFER)!==$ca843f6dd01906cb$export$5822a9d0880a5d82.FRAMEBUFFER_COMPLETE)throw Error("incomplete framebuffer");$ca843f6dd01906cb$export$5822a9d0880a5d82.viewport(0,0,this.width,this.height),t(),$ca843f6dd01906cb$export$5822a9d0880a5d82.bindFramebuffer($ca843f6dd01906cb$export$5822a9d0880a5d82.FRAMEBUFFER,null)}swapWith(t){let e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e}constructor(t,e,i,s){this.gl=$ca843f6dd01906cb$export$5822a9d0880a5d82,this.id=$2Eggz.BB.throwIfNull($ca843f6dd01906cb$export$5822a9d0880a5d82.createTexture()),this.width=t,this.height=e,this.format=i,this.type=s,this.canvas=null,$ca843f6dd01906cb$export$5822a9d0880a5d82.bindTexture($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,this.id),$ca843f6dd01906cb$export$5822a9d0880a5d82.texParameteri($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,$ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_MAG_FILTER,$ca843f6dd01906cb$export$5822a9d0880a5d82.LINEAR),$ca843f6dd01906cb$export$5822a9d0880a5d82.texParameteri($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,$ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_MIN_FILTER,$ca843f6dd01906cb$export$5822a9d0880a5d82.LINEAR),$ca843f6dd01906cb$export$5822a9d0880a5d82.texParameteri($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,$ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_WRAP_S,$ca843f6dd01906cb$export$5822a9d0880a5d82.CLAMP_TO_EDGE),$ca843f6dd01906cb$export$5822a9d0880a5d82.texParameteri($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,$ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_WRAP_T,$ca843f6dd01906cb$export$5822a9d0880a5d82.CLAMP_TO_EDGE),t&&e&&$ca843f6dd01906cb$export$5822a9d0880a5d82.texImage2D($ca843f6dd01906cb$export$5822a9d0880a5d82.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}}var $2Eggz=parcelRequire("2Eggz");function $6d7ade6aa4027844$export$4f237735eca1f248(t){let e=new $2Eggz.BB.SplineInterpolator(t),i=[];for(let t=0;t<256;t++)i.push($2Eggz.BB.clamp(Math.floor(256*e.interpolate(t/255)),0,255));return i}let $38704cd148486d5a$export$6894093bf294bea5=function(t,e,i){let s=$6d7ade6aa4027844$export$4f237735eca1f248(t),n=$6d7ade6aa4027844$export$4f237735eca1f248(e),r=$6d7ade6aa4027844$export$4f237735eca1f248(i),a=[];for(let t=0;t<256;t++)a.splice(a.length,0,s[t],n[t],r[t],255);return this._.extraTexture.initFromBytes(256,1,a),this._.extraTexture.use(1),$ca843f6dd01906cb$export$5822a9d0880a5d82.curves=$ca843f6dd01906cb$export$5822a9d0880a5d82.curves||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform sampler2D map;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r = texture2D(map, vec2(color.r)).r;            color.g = texture2D(map, vec2(color.g)).g;            color.b = texture2D(map, vec2(color.b)).b;            gl_FragColor = color;        }    ","curves"),$ca843f6dd01906cb$export$5822a9d0880a5d82.curves.textures({map:1}),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.curves,{}),this};var $2Eggz=parcelRequire("2Eggz");let $f13b1fa3c138ed02$export$ef28bbbd731e79bf=function(t,e){return $ca843f6dd01906cb$export$5822a9d0880a5d82.hueSaturation=$ca843f6dd01906cb$export$5822a9d0880a5d82.hueSaturation||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float hue;        uniform float saturation;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */            float angle = hue * 3.14159265;            float s = sin(angle), c = cos(angle);            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;            float len = length(color.rgb);            color.rgb = vec3(                dot(color.rgb, weights.xyz),                dot(color.rgb, weights.zxy),                dot(color.rgb, weights.yzx)            );                        /* saturation adjustment */            float average = (color.r + color.g + color.b) / 3.0;            if (saturation > 0.0) {                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));            } else {                color.rgb += (average - color.rgb) * (-saturation);            }                        gl_FragColor = color;        }    ","hueSaturation"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.hueSaturation,{hue:$2Eggz.BB.clamp(t,-1,1),saturation:$2Eggz.BB.clamp(e,-1,1)}),this};var $c0f1e1206ce9bdf1$exports={};$c0f1e1206ce9bdf1$exports="#define GLSLIFY 1\nuniform sampler2D texture;\nvarying vec2 texCoord;\nuniform vec2 texSize;\n\nuniform float seed;\nuniform float type;\nuniform vec2 scale;\nuniform vec2 offset;\nuniform float octaves;\nuniform float samples;\n\nuniform float peaks;\nuniform float contrast;\nuniform float brightness;\nuniform float isReversed;\n\nuniform vec3 colA;\nuniform vec3 colB;\n\nuniform float channels; // 0 - rgb, 1 - alpha\n\n// fbm, cellular_noise based on\n// https://github.com/Gonkee/Gonkees-Shaders\n// MIT, Copyright  Gonkee\n\n// hash & simplex based on\n// https://www.shadertoy.com/view/Msf3WH\n// MIT, Copyright  2013 Inigo Quilez\n// https://www.youtube.com/c/InigoQuilez\n// https://iquilezles.org\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat value_noise(vec2 coord){\n    return rand(floor(coord) / 100.0);\n}\n\nfloat cellular_noise(vec2 coord) {\n    vec2 i = floor(coord);\n    vec2 f = fract(coord);\n\n    float min_dist = 99999.0;\n    for (float x = -1.0; x <= 1.0; x++) {\n        for (float y = -1.0; y <= 1.0; y++) {\n            vec2 node = rand(i + vec2(x, y)) + vec2(x, y);\n            float dist = sqrt((f - node).x * (f - node).x + (f - node).y * (f - node).y);\n            min_dist = min(min_dist, dist);\n        }\n    }\n    return min_dist;\n}\n\n// ---------- Simplex Alternative ---------------------\n\nvec3 hash(vec3 p)\n{ p=vec3(dot(p, vec3(127.1, 311.7, 74.7))\n, dot(p, vec3(269.5, 183.3, 246.1))\n, dot(p, vec3(113.5, 271.9, 124.6)))\n;return fract(sin(p)*43758.5453123)*2.-1.; }\n\nmat3 hash(mat3 p)\n{ return mat3(hash(p[0]), hash(p[1]), hash(p[2])); }\n\nvec3 dots(mat3 a, vec3 w, mat3 b){ return vec3\n(dot(a[0], w-b[0]), dot(a[1], w-b[1]), dot(a[2], w-b[2])); }\n\n//return noiseGra13dx as .x, and its derivatives as .yzw\n// https://www.shadertoy.com/view/llByD1\nvec3 noiseGra13dx(in vec3 x) {\n    vec3 p=floor(x), w=fract(x)\n    #if 1\n    , u=w*w*w*(w*(w*6.-15.)+10.), v=30.*w*w*(w*(w-2.)+1.)//quintic hermite\n    #else\n    , u=w*w*(3.-2.*w), v=6.*w*(1.-w)//cubic hermite\n    #endif\n    //gradients\n    , G=hash(p+vec3(0)), F=hash(p+vec3(1))\n    ;mat3 D=hash(mat3(p, p, p)+mat3(1)), E=hash(mat3(p, p, p)+1.-mat3(1));\n    //projections\n    vec3 d=dots(D, w, mat3(1)), e=dots(E, w, 1.-mat3(1));\n    //interpolations\n    float g=dot(G, w), f=dot(F, w-vec3(1));\n    vec3 h=u.yzx*(g-d.xyx-d.yzz+e.zxy)+d-g, U=u*h, a=d-e;\n    mat3 S=D-mat3(G, G, G), W=D-E;\n    a.x=(a.x+a.y+a.z)+f-g;\n    ;float b=u.x*u.y*u.z;\n\n    vec4 result = vec4(g+U.x+U.y+U.z+a.x*b// value\n    , G*(1.-b)+b*(W[0]+W[1]+W[2]+F)//https://www.shadertoy.com/view/llByD1\n    +u.x*(S[0]+u.y*(G-D[0]-D[1]+E[2]))// derivatives\n    +u.y*(S[1]+u.z*(G-D[1]-D[2]+E[0]))\n    +u.z*(S[2]+u.x*(G-D[0]-D[2]+E[1]))\n    +v*(u.zxy*(g-d.xxy-d.zyz+e.yzx)+h+u.yzx*u.zxy*a.x));\n    return 0.5 + 0.5 * result.xxx;\n}\n\nfloat fbm(vec2 coord) {\n    float normalize_factor = 0.0;\n    float value = 0.0;\n    float scale = 0.5;\n\n    for (float i = 0.0; i < 7.0; i++){\n        if (i < octaves) {\n            if (type == 0.0) {\n                value += value_noise(coord) * scale;\n            } else if (type == 1.0) {\n                value += noiseGra13dx(vec3(coord.x, coord.y, 0.0)).r * scale;\n            } else if (type == 2.0) {\n                value += cellular_noise(coord) * scale;\n            }\n            normalize_factor += scale;\n            coord *= 2.0;\n            scale *= 0.5;\n        }\n    }\n    return value / normalize_factor;\n}\n\nfloat render (vec2 pos) {\n    float result = fbm(pos);\n    //\n\n    if (peaks > 0.0) {\n        result = abs(mod(result * peaks - 0.5, 1.0) - 0.5) * 2.0;// triangle\n        //result = mod(result * (peaks + 1.0), 1.0); // sawtooth\n    }\n\n    result += brightness;\n    if (contrast > 0.0) {\n        result = clamp((result - 0.5) / (1.0 - contrast) + 0.5, 0.0, 1.0);\n    } else if (contrast < 0.0) {\n        result = clamp((result - 0.5) * (1.0 + contrast) + 0.5, 0.0, 1.0);\n    }\n\n    if (isReversed == 1.0) {\n        result = 1.0 - result;\n    }\n    return result;\n}\n\nvoid main() {\n    vec4 color;\n\n    vec2 seedOffset;\n    seedOffset.x = (rand(vec2(seed, 0.0)) * 100.0 - 50.0);\n    seedOffset.y = (rand(vec2(0.0, seed)) * 100.0 - 50.0);\n\n    float val = 0.0;\n    vec2 basePos = texCoord * texSize / scale - offset / scale + seedOffset;\n\n    if (samples == 1.0) {\n        val = render(basePos);\n\n    }/* else if (samples == 4.0) {\n        for (float i = 0.0; i < 2.0; i++) {\n            for (float e = 0.0; e < 2.0; e++) {\n                val += render(basePos + (vec2(i, e) - 0.5) * 0.5 / scale);\n            }\n        }\n        val /= 4.0;\n\n    }*/ else if (samples == 16.0) {\n        for (float i = 0.0; i < 4.0; i++) {\n            for (float e = 0.0; e < 4.0; e++) {\n                val += render(basePos + (vec2(i, e) - 0.25) * 0.25 / scale);\n            }\n        }\n        val /= 16.0;\n    }\n\n    if (channels == 0.0) {\n        gl_FragColor = vec4(vec3(mix(colA, colB, val)), 1.0);\n    } else {\n        gl_FragColor = vec4(vec3(1.0), val);\n    }\n}";let $615309a02e3c3ec4$export$d3022aad56692482=function(t,e,i,s,n,r,a,o,l,h,c,d,p){return $ca843f6dd01906cb$export$5822a9d0880a5d82.noise=$ca843f6dd01906cb$export$5822a9d0880a5d82.noise||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,$parcel$interopDefault($c0f1e1206ce9bdf1$exports).replace(/#define.*/,""),"noise"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.noise,{seed:t||0,type:e,scale:[i[0],i[1]],offset:s,octaves:n,samples:r,texSize:[this.width,this.height],peaks:a,brightness:o,contrast:l,isReversed:+!!h,colA:c?[c.r/255,c.g/255,c.b/255]:[0,0,0],colB:d?[d.r/255,d.g/255,d.b/255]:[1,1,1],channels:+("rgb"!==p)}),this},$aec050322e5cb9b9$export$af69f7ca07da04c9="    float random(vec3 scale, float seed) {        /* use the fragment position for a different seed per-pixel */        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);    }",$c794506a27d0c6d6$export$6e852234f1597a14=function(t){return $ca843f6dd01906cb$export$5822a9d0880a5d82.triangleBlur=$ca843f6dd01906cb$export$5822a9d0880a5d82.triangleBlur||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+$aec050322e5cb9b9$export$af69f7ca07da04c9+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta * percent);                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;        }    ","triangleBlur"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.triangleBlur,{delta:[t/this.width,0]}),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.triangleBlur,{delta:[0,t/this.height]}),this},$caa405d6896c91bf$export$4545acb2b6bb8f22=function(t,e,i,s,n,r){$ca843f6dd01906cb$export$5822a9d0880a5d82.tiltShift=$ca843f6dd01906cb$export$5822a9d0880a5d82.tiltShift||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D texture;        uniform float blurRadius;        uniform float gradientRadius;        uniform vec2 start;        uniform vec2 end;        uniform vec2 delta;        uniform vec2 texSize;        varying vec2 texCoord;        "+$aec050322e5cb9b9$export$af69f7ca07da04c9+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;            for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;        }    ","tiltShift");let a=i-t,o=s-e,l=Math.sqrt(a*a+o*o);return $ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.tiltShift,{blurRadius:n,gradientRadius:r,start:[t,e],end:[i,s],delta:[a/l,o/l],texSize:[this.width,this.height]}),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.tiltShift,{blurRadius:n,gradientRadius:r,start:[t,e],end:[i,s],delta:[-o/l,a/l],texSize:[this.width,this.height]}),this};function $83fc0aef7d823507$export$820b3a44cb7b2b21(t,e){return new $ba022370a1e95297$export$7d9b0d118d0c4108(null,t+"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;    void main() {        vec2 coord = texCoord * texSize;        "+e+"        gl_FragColor = texture2D(texture, coord / texSize);        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);        if (coord != clampedCoord) {            /* fade to transparent if we are outside the image */            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));        }    }","warp")}function $a7bdfb25622fe8b9$export$1c447127d27d7be4(t,e,i,s,n,r,a,o){let l=i-n,h=s-r,c=a-n,d=o-r,p=t-i+n-a,u=e-s+r-o,g=l*d-c*h,m=(p*d-c*u)/g,f=(l*u-p*h)/g;return[i-t+m*i,s-e+m*s,m,a-t+f*a,o-e+f*o,f,t,e,1]}function $a7bdfb25622fe8b9$export$68b3343017e80691(t){let e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=e*r*h-e*a*l-i*n*h+i*a*o+s*n*l-s*r*o;return[(r*h-a*l)/c,(s*l-i*h)/c,(i*a-s*r)/c,(a*o-n*h)/c,(e*h-s*o)/c,(s*n-e*a)/c,(n*l-r*o)/c,(i*o-e*l)/c,(e*r-i*n)/c]}function $a7bdfb25622fe8b9$export$2060d2db72cce88f(t,e){return[t[0]*e[0]+t[1]*e[3]+t[2]*e[6],t[0]*e[1]+t[1]*e[4]+t[2]*e[7],t[0]*e[2]+t[1]*e[5]+t[2]*e[8],t[3]*e[0]+t[4]*e[3]+t[5]*e[6],t[3]*e[1]+t[4]*e[4]+t[5]*e[7],t[3]*e[2]+t[4]*e[5]+t[5]*e[8],t[6]*e[0]+t[7]*e[3]+t[8]*e[6],t[6]*e[1]+t[7]*e[4]+t[8]*e[7],t[6]*e[2]+t[7]*e[5]+t[8]*e[8]]}let $4f209890e041e7d6$export$a93b0222aeadc54b=function(t,e,i){if($ca843f6dd01906cb$export$5822a9d0880a5d82.matrixWarp=$ca843f6dd01906cb$export$5822a9d0880a5d82.matrixWarp||$83fc0aef7d823507$export$820b3a44cb7b2b21("        uniform mat3 matrix;        uniform bool useTextureSpace;    ","        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;        vec3 warp = matrix * vec3(coord, 1.0);        coord = warp.xy / warp.z;        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;    "),4==(t=t.flat()).length)t=[t[0],t[1],0,t[2],t[3],0,0,0,1];else if(9!=t.length)throw"can only warp with 2x2 or 3x3 matrix";return $ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.matrixWarp,{matrix:e?$a7bdfb25622fe8b9$export$68b3343017e80691(t):t,texSize:[this.width,this.height],useTextureSpace:+!!i}),this},$41fe2bf18cc268d3$export$915fb7313c578ba2=function(t,e){return $ca843f6dd01906cb$export$5822a9d0880a5d82.unsharpMask=$ca843f6dd01906cb$export$5822a9d0880a5d82.unsharpMask||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"        uniform sampler2D blurredTexture;        uniform sampler2D originalTexture;        uniform float strength;        uniform float threshold;        varying vec2 texCoord;        void main() {            vec4 blurred = texture2D(blurredTexture, texCoord);            vec4 original = texture2D(originalTexture, texCoord);            gl_FragColor = mix(blurred, original, 1.0 + strength);        }    ","unsharpMask"),this._.extraTexture.ensureFormatViaTexture(this._.texture),this._.texture.use(),this._.extraTexture.drawTo(function(){$ba022370a1e95297$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),this._.extraTexture.use(1),this.triangleBlur(t),$ca843f6dd01906cb$export$5822a9d0880a5d82.unsharpMask.textures({originalTexture:1}),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.unsharpMask,{strength:e}),this._.extraTexture.unuse(1),this},$12b73c4d8c20eb5a$export$be1ee5ea42904fdc=function(t,e){return $ca843f6dd01906cb$export$5822a9d0880a5d82.toAlpha=$ca843f6dd01906cb$export$5822a9d0880a5d82.toAlpha||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"    uniform bool isInverted;    uniform vec4 replace;    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        float alpha = (color.r + color.g + color.b) / 3.0;        if (isInverted) alpha = 1.0 - alpha;        alpha = min(color.a, alpha);        if (replace.a > 0.0) color = replace;        gl_FragColor = vec4(color.r, color.g, color.b, alpha);    }","toAlpha"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.toAlpha,{isInverted:+!!t,replace:e?[e.r/255,e.g/255,e.b/255,e.a]:[0,0,0,0],texSize:[this.width,this.height]}),this},$6109e928236947f2$export$6897c284b6f9f4dc=function(){return $ca843f6dd01906cb$export$5822a9d0880a5d82.invert=$ca843f6dd01906cb$export$5822a9d0880a5d82.invert||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        color.rgb = 1.0 - color.rgb;        gl_FragColor = color;    }","invert"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.invert,{texSize:[this.width,this.height]}),this},$7d03762724365e43$export$541149539f3a4684=function(t,e){let i=$a7bdfb25622fe8b9$export$1c447127d27d7be4(...e),s=$a7bdfb25622fe8b9$export$1c447127d27d7be4(...t),n=$a7bdfb25622fe8b9$export$2060d2db72cce88f($a7bdfb25622fe8b9$export$68b3343017e80691(i),s);return this.matrixWarp(n)},$1b7199a5e15fe4d8$export$b324c80262feb891=function(){return $ca843f6dd01906cb$export$5822a9d0880a5d82.unmultiplyAlpha=$ca843f6dd01906cb$export$5822a9d0880a5d82.unmultiplyAlpha||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        if(color.a > 0.0) {            color.rgb /= color.a;        }        gl_FragColor = color;    }","unmultiplyAlpha"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.unmultiplyAlpha,{texSize:[this.width,this.height]}),this},$8f4949fd56b66485$export$7c9b924528782480=function(t){return $ca843f6dd01906cb$export$5822a9d0880a5d82.distort=$ca843f6dd01906cb$export$5822a9d0880a5d82.distort||$83fc0aef7d823507$export$820b3a44cb7b2b21(`
    uniform float stepSize;
    uniform vec2 scale;
    uniform vec2 strength;
    uniform vec2 phase;
    uniform float type;
    uniform vec2 offset;
`,`
    const float PI = 3.14159265;
    float x = coord.x + offset.x;
    float y = coord.y + offset.y;
    if (stepSize > 1.0) {
        x = floor(x / stepSize) * stepSize;
        y = floor(y / stepSize) * stepSize;
    }
    float distortX = sin((x/scale.x + phase.x) * PI * 2.0) * strength.x;
    float distortY = sin((y/scale.y + phase.y) * PI * 2.0) * strength.y;
    if (type == 0.0) {
        coord.y += distortX;
        coord.x += distortY;
    } else if (type == 1.0) {
        coord.x += distortX;
        coord.y += distortY;
    } else if (type == 2.0) {
        x -= offset.x;
        y -= offset.y;
        gl_FragColor = texture2D(texture, vec2(x, y) / texSize);
        coord.y += sin(gl_FragColor.r/scale.x*200.0 + phase.x * PI * 2.0) * strength.x;
        coord.x += cos(gl_FragColor.g/scale.y*200.0 + phase.y * PI * 2.0) * strength.y;
    }
    coord.x = mod(coord.x, texSize.x);
    coord.y = mod(coord.y, texSize.y);
`),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.distort,{stepSize:t.stepSize,type:t.distortType,scale:[t.scale.x,t.scale.y],strength:[t.strength.x,t.strength.y],phase:[t.phase.x,t.phase.y],offset:[t.offset.x,t.offset.y],texSize:[this.width,this.height]}),this},$7b72315ed3e98576$export$57b05c961ff98d6a=function(){return $ca843f6dd01906cb$export$5822a9d0880a5d82.multiplyAlpha=$ca843f6dd01906cb$export$5822a9d0880a5d82.multiplyAlpha||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;        void main() {        vec4 color = texture2D(texture, texCoord);        color.rgb *= color.a;        gl_FragColor = color;    }","multiplyAlpha"),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.multiplyAlpha,{texSize:[this.width,this.height]}),this};var $2Eggz=parcelRequire("2Eggz");let $b8a2de52955396f1$export$d99f0801a68bbcf1=function(t,e){return t._.use(1),e?e._.use(2):(this._.extraTexture.use(2),this._.extraTexture.initFromBytes(1,1,[0,0,0,0])),$ca843f6dd01906cb$export$5822a9d0880a5d82.mask=$ca843f6dd01906cb$export$5822a9d0880a5d82.mask||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,`
        uniform sampler2D texture;
        uniform sampler2D mask;
        uniform sampler2D original;
        varying vec2 texCoord;

        void main() {
            vec4 filteredCol = texture2D(texture, texCoord);
            vec4 originalCol = texture2D(original, texCoord);
            float maskStrength = texture2D(mask, texCoord).r;
            gl_FragColor = mix(originalCol, filteredCol, maskStrength);
        }
        `,"mask"),$ca843f6dd01906cb$export$5822a9d0880a5d82.mask.textures({mask:1,original:2}),$ed5eddfb5f6912a0$export$d731e22ecd0c25d3.call(this,$ca843f6dd01906cb$export$5822a9d0880a5d82.mask,{}),this},$03f71ba115904ed2$export$a04cfca62fd2892f=function(){function t(t){return{_:t,loadContentsOf:function(t){$ca843f6dd01906cb$export$b59c6427db8463f4(this._.gl),this._.loadContentsOf(t)},destroy:function(){$ca843f6dd01906cb$export$b59c6427db8463f4(this._.gl),this._.destroy()}}}function e(e){return t($4f7270b6400c73d7$export$7e6fd232cff50dd1.fromElement(e))}function i(){let t=$ca843f6dd01906cb$export$5822a9d0880a5d82.UNSIGNED_BYTE;if($ca843f6dd01906cb$export$5822a9d0880a5d82.getExtension("WEBGL_color_buffer_float")&&$ca843f6dd01906cb$export$5822a9d0880a5d82.getExtension("OES_texture_float")&&$ca843f6dd01906cb$export$5822a9d0880a5d82.getExtension("OES_texture_float_linear")){let e=new $4f7270b6400c73d7$export$7e6fd232cff50dd1(100,100,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,$ca843f6dd01906cb$export$5822a9d0880a5d82.FLOAT);try{e.drawTo(function(){t=$ca843f6dd01906cb$export$5822a9d0880a5d82.FLOAT})}catch(t){}e.destroy()}return t}function s(t,e){let s=i();this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=e,this._.texture=new $4f7270b6400c73d7$export$7e6fd232cff50dd1(t,e,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,s),this._.spareTexture=new $4f7270b6400c73d7$export$7e6fd232cff50dd1(t,e,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,s),this._.extraTexture=this._.extraTexture||new $4f7270b6400c73d7$export$7e6fd232cff50dd1(0,0,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,s),this._.flippedShader=this._.flippedShader||new $ba022370a1e95297$export$7d9b0d118d0c4108(null,`
uniform sampler2D texture;
varying vec2 texCoord;
void main() {
    gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));
}
        `,"flippedShader"),this._.isInitialized=!0}function n(t,e,i){return this._.isInitialized&&t._.width==this.width&&t._.height==this.height||s.call(this,e||t._.width,i||t._.height),t._.use(),this._.texture.drawTo(function(){$ba022370a1e95297$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),this}function r(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function a(){let e=new $4f7270b6400c73d7$export$7e6fd232cff50dd1(this._.texture.width,this._.texture.height,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,$ca843f6dd01906cb$export$5822a9d0880a5d82.UNSIGNED_BYTE);return this._.texture.use(),e.drawTo(function(){$ba022370a1e95297$export$7d9b0d118d0c4108.getDefaultShader().drawRect()}),t(e)}function o(){let t=this._.texture.width,e=this._.texture.height,i=new Uint8Array(t*e*4);return this._.texture.drawTo(function(){$ca843f6dd01906cb$export$5822a9d0880a5d82.readPixels(0,0,t,e,$ca843f6dd01906cb$export$5822a9d0880a5d82.RGBA,$ca843f6dd01906cb$export$5822a9d0880a5d82.UNSIGNED_BYTE,i)}),i}function l(t){return function(...e){return $ca843f6dd01906cb$export$b59c6427db8463f4(this._.gl),t.apply(this,e)}}function h(t,e){let i=null;return["webgl","experimental-webgl","webgl2"].forEach(s=>{if(!i)try{i=t.getContext(s,e)}catch(t){}}),i}return()=>{if(!window.WebGLRenderingContext)throw"WebGLRenderingContext not set. Browser does not support WebGL.";let t=$2Eggz.BB.canvas(1,1),i=h(t,{premultipliedAlpha:!1});if(!i)throw"This browser does not support WebGL";return $ca843f6dd01906cb$export$b59c6427db8463f4(i),t._={gl:$ca843f6dd01906cb$export$5822a9d0880a5d82,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=l(e),t.initialize=l(s),t.draw=l(n),t.update=l(r),t.contents=l(a),t.getPixelArray=l(o),t.brightnessContrast=l($7aae3f183f304a55$export$6408eeb1703e74b8),t.hueSaturation=l($f13b1fa3c138ed02$export$ef28bbbd731e79bf),t.triangleBlur=l($c794506a27d0c6d6$export$6e852234f1597a14),t.unsharpMask=l($41fe2bf18cc268d3$export$915fb7313c578ba2),t.perspective=l($7d03762724365e43$export$541149539f3a4684),t.matrixWarp=l($4f209890e041e7d6$export$a93b0222aeadc54b),t.tiltShift=l($caa405d6896c91bf$export$4545acb2b6bb8f22),t.noise=l($615309a02e3c3ec4$export$d3022aad56692482),t.curves=l($38704cd148486d5a$export$6894093bf294bea5),t.invert=l($6109e928236947f2$export$6897c284b6f9f4dc),t.multiplyAlpha=l($7b72315ed3e98576$export$57b05c961ff98d6a),t.unmultiplyAlpha=l($1b7199a5e15fe4d8$export$b324c80262feb891),t.toAlpha=l($12b73c4d8c20eb5a$export$be1ee5ea42904fdc),t.distort=l($8f4949fd56b66485$export$7c9b924528782480),t.mask=l($b8a2de52955396f1$export$d99f0801a68bbcf1),t}}(),$5caaf17bca0749c7$var$failed=!1,$5caaf17bca0749c7$var$fx=null;function $5caaf17bca0749c7$export$8c4423af32b21158(){if($5caaf17bca0749c7$var$failed)return $5caaf17bca0749c7$var$fx;if(!$5caaf17bca0749c7$var$fx||$5caaf17bca0749c7$var$fx._.gl.isContextLost())try{$5caaf17bca0749c7$var$fx=$03f71ba115904ed2$export$a04cfca62fd2892f()}catch(t){$5caaf17bca0749c7$var$failed=!0,$5caaf17bca0749c7$var$fx=null,setTimeout(()=>{throw t})}return $5caaf17bca0749c7$var$fx}var $jmKbV=parcelRequire("jmKbV");class $bc1f03f9e593bc1c$export$aeb1a0a0e64541b5{testHasWebGL(){return!!$5caaf17bca0749c7$export$8c4423af32b21158()}init(){let t=$49faab2330529a96$export$6e4a713ddcda1e5e.FILTER_LIB,e=[];if(!$49faab2330529a96$export$6e4a713ddcda1e5e.FILTER_LIB_STATUS.isLoaded)throw Error("filters not loaded");let i=this.testHasWebGL();if(!i){let t=$2Eggz.BB.el({parent:this.rootEl,className:"kl-toolspace-note",content:"Features disabled because WebGL is failing.",css:{margin:"10px",marginBottom:"0"}});$2Eggz.BB.el({parent:t,tagName:"button",textContent:"Learn More",css:{marginLeft:"5px"}}).onclick=()=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:"<b>WebGL is not working</b>",div:$2Eggz.BB.el({content:`
See if your browser supports WebGL and has it enabled: <a href="https://get.webgl.org" target="_blank" rel="noopener noreferrer">get.webgl.org</a><br>
<br>
Recently (2023-05) a number of Chrome users on Chrome OS reported that WebGL fails, although it is enabled & supported.
This has been reported to Google.
`}),buttons:["Ok"],clickOnEnter:"Ok"})}}let s=s=>{let n=t[s],r=$2Eggz.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[(0,$jmKbV.createImage)({alt:"icon",src:n.icon,width:18,height:20,className:n.darkNoInvert?"dark-no-invert":"",css:{marginRight:"3px"}}),$63d0b335c576c718$export$ce37e184d908d785(n.lang.button)],css:{lineHeight:"20px",fontSize:"12px"},custom:{tabIndex:"-1"}}),a=$63d0b335c576c718$export$ce37e184d908d785(n.lang.name),o=!0;return n.webGL&&!i&&(o=!1),o?r.onclick=()=>{this.applyUncommitted();let e=["Ok","Cancel"],i=(t,e)=>{let i;if(!("error"in e)){if("Cancel"==t){e.destroy&&e.destroy();return}try{i=e.getInput()}catch(t){if(-1!==t.message.indexOf(".getInput is not a function"))throw"filterDialog.getInput is not a function, filter: "+a;throw t}o(i)}};if(!("apply"in t[s]))return void $49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:"Application not fully loaded",type:"error"});let o=e=>{t[s].apply({layer:this.getCurrentLayer(),klCanvas:this.klCanvas,klHistory:this.klHistory,input:e})||$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:"Couldn't apply the edit action",type:"error"}),t[s].updatePos&&this.onCanvasChanged(),this.layersUi.update()};if(t[s].isInstant)r.blur(),o(null),this.statusOverlay.out('"'+a+'" '+$63d0b335c576c718$export$ce37e184d908d785("filter-applied"),!0);else{let r,o,l,h=this.klColorSlider.getSecondaryRGB();try{l=t[s].getDialog({context:this.getCurrentLayer().context,klCanvas:this.klCanvas,maxWidth:this.maxCanvasSize,maxHeight:this.maxCanvasSize,currentColorRgb:{r:this.getCurrentColor().r,g:this.getCurrentColor().g,b:this.getCurrentColor().b},secondaryColorRgb:{r:h.r,g:h.g,b:h.b},composed:this.klHistory.getComposed()})}catch(t){setTimeout(()=>{throw t})}if(!l||"error"in l)return void $49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:l?l.error:"Error: Could not perform action.",type:"error"});l.errorCallback=t=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:"Error: Could not perform action.",type:"error"}),setTimeout(()=>{throw t},0),r()};let c={};"width"in l&&(c.width=l.width+"px");{let t=[$934e5f47c3374e21$export$db3b6bfb95261072("b",a)];void 0!==n.lang.description&&t.push($934e5f47c3374e21$export$db3b6bfb95261072({className:"kl-info-btn",onClick:()=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:$63d0b335c576c718$export$ce37e184d908d785(n.lang.description)})},title:$63d0b335c576c718$export$ce37e184d908d785(n.lang.description),noRef:!0},"?")),o=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,gap-5",t)}$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:o,div:l.element,style:c,buttons:e,clickOnEnter:"Ok",callback:t=>{i(t,l)},closeFunc:t=>{r=t}})}}:r.disabled=!0,e.push(r),r},n=e=>{Object.entries(t).forEach(([t,i])=>{e.includes(t)&&(!this.isEmbed||i.inEmbed)&&this.rootEl.append(s(t))})},r=["cropExtend","flip","perspective","resize","rotate","transform"],a=["brightnessContrast","curves","distort","hueSaturation","invert","tiltShift","toAlpha","blur","unsharpMask"],o=["grid","noise","pattern","vanishPoint"];if(!this.isEmbed){let t=$2Eggz.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[(0,$jmKbV.createImage)({alt:"icon",src:$parcel$interopDefault($895204cb2449c455$exports),width:18,height:20,css:{marginRight:"3px"}}),$63d0b335c576c718$export$ce37e184d908d785("file-copy")],onClick:()=>this.onCopyToClipboard(),title:$63d0b335c576c718$export$ce37e184d908d785("file-copy-title"),custom:{tabIndex:"-1"},css:{lineHeight:"20px"}}),e=$2Eggz.BB.el({tagName:"button",className:"grid-button grid-button--filter",content:[$2Eggz.BB.el({css:{height:"20px",cssFloat:"left"}}),$63d0b335c576c718$export$ce37e184d908d785("file-paste")],custom:{tabIndex:"-1"},css:{lineHeight:"20px"},onClick:()=>this.onPaste()});this.rootEl.append(t,e,$2Eggz.BB.el({className:"grid-hr"}))}n(r),this.rootEl.append($2Eggz.BB.el({className:"grid-hr"})),n(a),this.rootEl.append($2Eggz.BB.el({className:"grid-hr"})),n(o),this.isInit=!0}getElement(){return this.rootEl}show(){this.isInit||this.init(),this.rootEl.style.display="block"}hide(){this.rootEl.style.display="none"}constructor(t){this.isInit=!1,this.klRootEl=t.klRootEl,this.klColorSlider=t.klColorSlider,this.layersUi=t.layersUi,this.getCurrentColor=t.getCurrentColor,this.maxCanvasSize=t.maxCanvasSize,this.klCanvas=t.klCanvas,this.getCurrentLayer=t.getCurrentLayer,this.isEmbed=t.isEmbed,this.statusOverlay=t.statusOverlay,this.onCanvasChanged=t.onCanvasChanged,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.onCopyToClipboard=t.onCopyToClipboard,this.onPaste=t.onPaste,this.rootEl=$2Eggz.BB.el()}}var $2Eggz=parcelRequire("2Eggz"),$c993ffd3ce3393ac$exports={};$c993ffd3ce3393ac$exports=$parcel$resolve("28TVy");var $ao0qX=parcelRequire("ao0qX"),$VM6dD=parcelRequire("VM6dD");async function $1acd53d54391923e$var$upload(t,e,i,s,n){let r,a=await (0,$ao0qX.canvasToBlob)(t,"image/"+s),o=window.open();if(!o)throw Error("could not create new tab");let l=o.document.createElement("div"),h=o.document.createElement("img");h.src=$parcel$interopDefault($c993ffd3ce3393ac$exports),l.append(h),(0,$VM6dD.css)(h,{filter:"invert(1)"}),(0,$VM6dD.css)(o.document.body,{backgroundColor:"#121211",backgroundImage:"linear-gradient(#2b2b2b 0%, #121211 50%)",backgroundRepeat:"no-repeat"});let c=o.document.createElement("div");c.style.marginTop="10px",l.append(c),c.textContent=$63d0b335c576c718$export$ce37e184d908d785("upload-uploading"),o.document.body.append(l),(0,$VM6dD.css)(l,{marginLeft:"auto",marginRight:"auto",marginTop:"100px",fontFamily:"system-ui, sans-serif",fontSize:"20px",textAlign:"center",transition:"opacity 0.3s ease-in-out",opacity:"0",color:"#ccc"}),setTimeout(function(){l.style.opacity="1"},20);try{let t=new FormData;t.append("title",e),t.append("description",i),t.append("image",a),r=await fetch("https://api.imgur.com/3/image",{method:"POST",headers:{Authorization:"Client-ID "+n},body:t})}catch(t){throw o.close(),t}if(!r.ok)throw o.close(),Error();let d=(await r.json()).data;return o.location.href=d.link.replace(/\.(jpg|png)/,""),d}function $1acd53d54391923e$export$b1dd62fa0b5f32f5(t,e,i,s){if(!i)throw Error("imgur key missing");let n=$2Eggz.BB.el({tagName:"input",custom:{name:"image-title"}});n.type="text",n.value=$63d0b335c576c718$export$ce37e184d908d785("upload-title-untitled");let r=$2Eggz.BB.el({tagName:"textarea",custom:{rows:"2",name:"image-description"},css:{width:"100%",maxWidth:"100%"}}),a=$2Eggz.BB.el({textContent:$63d0b335c576c718$export$ce37e184d908d785("upload-name")+":"}),o=$2Eggz.BB.el({textContent:$63d0b335c576c718$export$ce37e184d908d785("upload-caption")+":",css:{marginTop:"10px"}}),l=$2Eggz.BB.el({content:`<br/><a href="https://imgur.com/tos" target="_blank" rel="noopener noreferrer">${$63d0b335c576c718$export$ce37e184d908d785("terms-of-service")}</a>`}),h=new $49faab2330529a96$export$6e4a713ddcda1e5e.RadioList({name:"filetype",init:"jpeg",items:[{label:"JPG",value:"jpeg"},{label:"PNG",value:"png"}],ignoreFocus:!0});(0,$VM6dD.css)(h.getElement(),{marginBottom:"10px"});let c=$2Eggz.BB.el(),d=$2Eggz.BB.el({className:"info-hint",textContent:$63d0b335c576c718$export$ce37e184d908d785("upload-link-notice")});c.append(d,h.getElement(),a,n,o,r,l),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:e,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("upload-title")}</b>`,type:"upload",div:c,buttons:[$63d0b335c576c718$export$ce37e184d908d785("upload-submit"),"Cancel"],clickOnEnter:$63d0b335c576c718$export$ce37e184d908d785("upload-submit"),primaries:[$63d0b335c576c718$export$ce37e184d908d785("upload-submit")],autoFocus:$63d0b335c576c718$export$ce37e184d908d785("upload-submit"),callback:async function(a){if(a===$63d0b335c576c718$export$ce37e184d908d785("upload-submit")||"Yes"===a||"Ok"===a)try{let a=await $1acd53d54391923e$var$upload(t.getCompleteCanvas(1),n.value,r.value,h.getValue(),i);$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:e,type:"ok",message:`<h3>${$63d0b335c576c718$export$ce37e184d908d785("upload-success")}</h3><br>${$63d0b335c576c718$export$ce37e184d908d785("upload-delete")}<br><a target='_blank' rel="noopener noreferrer" href='https://imgur.com/delete/${a.deletehash}'>imgur.com/delete/${a.deletehash}</a><br><br>`,buttons:["Ok"]}),s()}catch(t){$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:e,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("upload-failed"),buttons:["Ok"]})}}})}async function $e4b3248b4ce95ea5$export$ab3d838b1d336b38(){return $e4b3248b4ce95ea5$var$agPsdLazy||($e4b3248b4ce95ea5$var$agPsdLazy=await parcelRequire("2UvqW")),$e4b3248b4ce95ea5$var$agPsdLazy}var $2Eggz=parcelRequire("2Eggz"),$dGRuJ=parcelRequire("dGRuJ");$095683c145b0ace5$export$d4ef1ef99f1461a4="WKn-vG_psdWrapper";let $5ecc5a61dcd332b6$var$DEBUG_TIME_LIMIT_MS,$5ecc5a61dcd332b6$var$DEBUG_UNSAVED_ACTIONS_LIMIT,$5ecc5a61dcd332b6$var$UNSAVED_ACTIONS_LIMIT=null!=$5ecc5a61dcd332b6$var$DEBUG_UNSAVED_ACTIONS_LIMIT?$5ecc5a61dcd332b6$var$DEBUG_UNSAVED_ACTIONS_LIMIT:100,$5ecc5a61dcd332b6$var$LS_REMINDER_KEY="kl-save-reminder";class $5ecc5a61dcd332b6$export$befc6437ad34b28a{showPopup(){let t=Math.round((performance.now()-this.lastSavedAt)/1e3/60),e=$2Eggz.BB.el();e.append($2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("save-reminder-text",{a:"<strong>"+t,b:"</strong>"}),css:{marginBottom:"20px"}}));let i=$2Eggz.BB.el({className:$095683c145b0ace5$export$d4ef1ef99f1461a4}),s=$2Eggz.BB.el({css:{margin:"0 -20px",padding:"20px",paddingBottom:"0"}});e.append(i,s);let n=$2Eggz.BB.el({tagName:"button",className:"kl-button kl-button-primary kl-button--extra-focus",content:$63d0b335c576c718$export$ce37e184d908d785("save-reminder-save-psd"),onClick:()=>{this.applyUncommitted(),this.onSaveAsPsd()},css:{padding:"14px"},noRef:!0});i.append(n,$2Eggz.BB.el({content:" "+$63d0b335c576c718$export$ce37e184d908d785("save-reminder-psd-layers"),css:{marginTop:"10px"}}));let r=new $1a83f3b0ed28fe18$export$9c72cf485ef46673({projectStore:this.projectStore,getProject:this.getProject,klRootEl:document.body,applyUncommitted:this.applyUncommitted,options:{hideClearButton:!0,isFocusable:!0},onStored:()=>this.onStored()});r.show(),s.append(r.getElement()),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({type:"warning",target:document.body,message:`<b>${$63d0b335c576c718$export$ce37e184d908d785("save-reminder-title")}</b>`,div:e,ignoreBackground:!0,callback:()=>{r.destroy(),$2Eggz.BB.destroyEl(n),this.closeFunc=void 0,this.lastReminderShownAt=performance.now()},closeFunc:t=>{this.closeFunc=t}}),setTimeout(()=>{n.focus()},40)}init(){void 0===this.lastSavedHistoryIndex&&(this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),setInterval(()=>{if("visible"!==document.visibilityState)return;let t=Math.abs(this.klHistory.getTotalIndex()-this.lastSavedHistoryIndex),e=null!=$5ecc5a61dcd332b6$var$DEBUG_TIME_LIMIT_MS?$5ecc5a61dcd332b6$var$DEBUG_TIME_LIMIT_MS:6e4*({"20min":20,"40min":40,disabled:0})[this.setting];e>0&&0===$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()&&!this.isDrawing()&&this.lastReminderShownAt+e<performance.now()&&t>=$5ecc5a61dcd332b6$var$UNSAVED_ACTIONS_LIMIT&&this.showPopup()},5e3))}reset(){void 0!==this.lastSavedHistoryIndex&&(this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),this.lastReminderShownAt=performance.now(),this.lastSavedAt=performance.now(),window.onbeforeunload=null,this.closeFunc&&this.closeFunc())}getSetting(){return this.setting}setSetting(t){this.setting=t,$dGRuJ.LocalStorage.setItem($5ecc5a61dcd332b6$var$LS_REMINDER_KEY,this.setting)}constructor(t){var e;this.klHistory={},this.lastSavedAt=0,this.lastReminderShownAt=0,this.onSaveAsPsd=t.onSaveAsPsd,this.isDrawing=t.isDrawing,this.projectStore=t.projectStore,this.getProject=t.getProject,this.onStored=t.onStored,this.applyUncommitted=t.applyUncommitted,this.klHistory=t.klHistory,this.setting=null!=(e=$dGRuJ.LocalStorage.getItem($5ecc5a61dcd332b6$var$LS_REMINDER_KEY))?e:"40min"}}var $2Eggz=parcelRequire("2Eggz");let $39ab97e4ee30a834$var$types={"image/png":{description:"PNG Image",accept:{"image/png":[".png"]}},"image/vnd.adobe.photoshop":{description:"Adobe Photoshop Document",accept:{"image/vnd.adobe.photoshop":[".psd"]}}};async function $39ab97e4ee30a834$var$saveViaFilePicker(t,e){let i=t.type;if(!("showSaveFilePicker"in window))return!1;{let s;if(!$39ab97e4ee30a834$var$types[i])return console.error("unknown mime type:",i),!1;try{s=await window.showSaveFilePicker({suggestedName:e,types:[$39ab97e4ee30a834$var$types[i]]})}catch(t){if(t instanceof Error&&"AbortError"===t.name)return!0;return console.log("unpredicted error",t),!1}if(!s)return!1;let n=await s.createWritable();return await n.write(t),await n.close(),!0}}async function $39ab97e4ee30a834$export$2bc2a80e311129ac(t,e,i=!1){if(i&&await $39ab97e4ee30a834$var$saveViaFilePicker(t,e))return;let s=document.createElementNS("http://www.w3.org/1999/xhtml","a");s.download=e,s.rel="noopener";let n=URL.createObjectURL(t);s.href=n,setTimeout(()=>URL.revokeObjectURL(n),4e4),setTimeout(()=>{document.body.appendChild(s),s.click(),document.body.removeChild(s)},1)}let $5a2f7ed66bdaf6a4$export$67ac20532b9ededa={filenameBase:"Klecks"};var $ao0qX=parcelRequire("ao0qX");class $f853515918de2fdb$export$75e7b60500bb415b{async saveImage(t,e,i,s=!1){let n=await (0,$ao0qX.canvasToBlob)(t,i);await $39ab97e4ee30a834$export$2bc2a80e311129ac(n,e,s)}async save(t){if(t||(t=this.getExportType()),"png"===t){let t="png",e="image/png",i=$2Eggz.BB.getDate()+$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.filenameBase+"."+t,s=this.klCanvas.getCompleteCanvas(1);try{await this.saveImage(s,i,e,this.showSaveDialog)}catch(t){throw alert("could not save"),Error("failed png export")}}else if("layers"===t){let t="png",e="image/png",i=$2Eggz.BB.getDate()+$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.filenameBase,s=this.klCanvas.getLayersFast();for(let n=0;n<s.length;n++){let r=s[n],a=[i,"_",(""+(n+1)).padStart(2,"0"),"_",r.name,".",t];await this.saveImage(r.canvas,a.join(""),e)}}else if("psd"===t){let t=this.klCanvas.getLayersFast(),e={width:this.klCanvas.getWidth(),height:this.klCanvas.getHeight(),children:[],canvas:this.klCanvas.getCompleteCanvas(1)};for(let i=0;i<t.length;i++){let s=t[i];e.children.push({name:s.name,hidden:!s.isVisible,opacity:s.opacity,canvas:s.canvas,blendMode:$49faab2330529a96$export$6e4a713ddcda1e5e.PSD.blendKlToPsd(s.mixModeStr),left:0,top:0})}$49faab2330529a96$export$6e4a713ddcda1e5e.loadAgPsd().then(t=>{$39ab97e4ee30a834$export$2bc2a80e311129ac(new Blob([t.writePsdBuffer(e)],{type:"image/vnd.adobe.photoshop"}),$2Eggz.BB.getDate()+$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.filenameBase+".psd",this.showSaveDialog)}).catch(()=>{alert("Error: failed to load PSD library")})}this.onSaved()}setShowSaveDialog(t){this.showSaveDialog=t}constructor(t,e,i){this.getExportType=t,this.klCanvas=e,this.onSaved=i,this.showSaveDialog=!0}}class $2cc9052c3f36f7f1$export$272bfd3ef9ef2f48{emit(t,e){for(let i=0;i<this.subscriberArr.length;i++)this.subscriberArr[i]!==e&&this.subscriberArr[i](t)}emitColor(t,e){this.emit({type:"color",value:t},e)}emitSize(t,e){this.emit({type:"size",value:t},e)}emitOpacity(t,e){this.emit({type:"opacity",value:t},e)}emitScatter(t,e){this.emit({type:"scatter",value:t},e)}emitSliderConfig(t,e){this.emit({type:"sliderConfig",value:t},e)}setColor(t,e){this.onSetColor(t),this.emitColor(t,e)}setSize(t,e){this.onSetSize(t)}setOpacity(t,e){this.onSetOpacity(t)}setScatter(t,e){this.onSetScatter(t)}getColor(){return this.onGetColor()}getSize(){return this.onGetSize()}getOpacity(){return this.onGetOpacity()}getScatter(){return this.onGetScatter()}getSliderConfig(){return this.onGetSliderConfig()}subscribe(t){this.subscriberArr.includes(t)||this.subscriberArr.push(t)}unsubscribe(t){for(let e=0;e<this.subscriberArr.length;e++)t===this.subscriberArr[e]&&(this.subscriberArr.splice(e,1),e--)}constructor(t){if(this.subscriberArr=[],this.onSetColor=t.onSetColor,this.onSetSize=t.onSetSize,this.onSetOpacity=t.onSetOpacity,this.onSetScatter=t.onSetScatter,this.onGetColor=t.onGetColor,this.onGetSize=t.onGetSize,this.onGetOpacity=t.onGetOpacity,this.onGetScatter=t.onGetScatter,this.onGetSliderConfig=t.onGetSliderConfig,$2cc9052c3f36f7f1$export$272bfd3ef9ef2f48.instance)throw Error("BrushSettingService already instantiated");$2cc9052c3f36f7f1$export$272bfd3ef9ef2f48.instance=this}}var $2Eggz=parcelRequire("2Eggz"),$ad3e45d1c2d7a6be$exports={};$ad3e45d1c2d7a6be$exports=$parcel$resolve("8EUal");var $125579f7a33d840c$exports={};$125579f7a33d840c$exports=$parcel$resolve("lQWO9");var $dGRuJ=parcelRequire("dGRuJ"),$VM6dD=parcelRequire("VM6dD");$3a83d9f064170ff2$export$1c6ca1c73436aa3c="ttl1Ia_licenses";var $2Eggz=parcelRequire("2Eggz");function $385afea81bc7341b$export$d3fe39c7bff44f23(){let t=$934e5f47c3374e21$export$db3b6bfb95261072("."+$3a83d9f064170ff2$export$1c6ca1c73436aa3c,$63d0b335c576c718$export$ce37e184d908d785("loading")),e=$934e5f47c3374e21$export$db3b6bfb95261072("."+$3a83d9f064170ff2$export$1c6ca1c73436aa3c,$63d0b335c576c718$export$ce37e184d908d785("loading")),i=$934e5f47c3374e21$export$db3b6bfb95261072(",flex,flexCol,gap-10",[t,e]);new $18361e3f5d6257e8$export$185108a9b725b68({title:$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("licenses")}),content:$2Eggz.BB.el({content:i,css:{height:"100%",overflowY:"auto",padding:"10px",boxSizing:"border-box"}}),width:800,isMaxHeight:!0,onClose:()=>{"#licenses"===window.location.hash&&history.replaceState("",document.title,window.location.pathname+window.location.search)}}),parcelRequire("62C6p").then(e=>{t.innerHTML="",e.LICENSES.forEach(e=>{t.append($934e5f47c3374e21$export$db3b6bfb95261072("details",[$934e5f47c3374e21$export$db3b6bfb95261072("summary",e.title),$934e5f47c3374e21$export$db3b6bfb95261072("",e.full.replace(/\n/g,"<br>"))]))})}),parcelRequire("9vuYc").then(t=>{e.innerHTML="",t.FONT_LICENSES.forEach(t=>{e.append($934e5f47c3374e21$export$db3b6bfb95261072("details",[$934e5f47c3374e21$export$db3b6bfb95261072("summary","Font: "+t.title),$934e5f47c3374e21$export$db3b6bfb95261072("",t.full.replace(/\n/g,"<br>"))]))})})}var $jmKbV=parcelRequire("jmKbV");class $4c0471ae90bf93cd$export$ad7f6c626a2cdfad{getElement(){return this.rootEl}constructor({onLeftRight:t,saveReminder:e,customAbout:i}){this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}});let s=$63d0b335c576c718$export$e4ce066d17694649.getAutoLanguage(),n=$2Eggz.BB.el({parent:this.rootEl,content:$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("settings-language")+":",css:{marginRight:"5px",marginBottom:"2px"}}),css:{display:"flex",alignItems:"center",flexWrap:"wrap"}}),r=[["auto",$63d0b335c576c718$export$ce37e184d908d785("auto")+` \u{2192} ${s.name} (${s.code})`],...$970d7af44d8b8038$export$d0d68bb9ed2c643d.map(t=>[t.code,t.name+` (${t.code})`])],a=new $49faab2330529a96$export$6e4a713ddcda1e5e.Select({initValue:(0,$VM6dD.nullToUndefined)($dGRuJ.LocalStorage.getItem($63d0b335c576c718$export$991796128b2ca217)?$dGRuJ.LocalStorage.getItem($63d0b335c576c718$export$991796128b2ca217):"auto"),optionArr:r,onChange:t=>{"auto"===t?$dGRuJ.LocalStorage.removeItem($63d0b335c576c718$export$991796128b2ca217):$dGRuJ.LocalStorage.setItem($63d0b335c576c718$export$991796128b2ca217,t),o.style.display="block"},name:"language"});(0,$VM6dD.css)(a.getElement(),{flexGrow:"1"});let o=$2Eggz.BB.el({className:"kl-toolspace-note",content:$63d0b335c576c718$export$ce37e184d908d785("settings-language-reload"),css:{display:"none",marginTop:"5px",flexGrow:"1"}});function l(t){return"dark"===t?" "+$63d0b335c576c718$export$ce37e184d908d785("theme-dark"):" "+$63d0b335c576c718$export$ce37e184d908d785("theme-light")}n.append(a.getElement(),o);let h=new $49faab2330529a96$export$6e4a713ddcda1e5e.Select({optionArr:[["auto",$63d0b335c576c718$export$ce37e184d908d785("auto")+"  "+l($74a507c74cfe9692$export$5714e40777c1bcc2.getMediaQueryTheme())],["light",l("light")],["dark",l("dark")]],initValue:$74a507c74cfe9692$export$5714e40777c1bcc2.getStoredTheme()||"auto",onChange:t=>{$74a507c74cfe9692$export$5714e40777c1bcc2.setStoredTheme("auto"===t?void 0:t)},name:"ui-theme"});if((0,$VM6dD.css)(h.getElement(),{flexGrow:"1"}),(0,$VM6dD.addIsDarkListener)(()=>{h.updateLabel("auto",$63d0b335c576c718$export$ce37e184d908d785("auto")+"  "+l($74a507c74cfe9692$export$5714e40777c1bcc2.getMediaQueryTheme()))}),$2Eggz.BB.el({parent:this.rootEl,content:[$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("settings-theme")+":",css:{marginRight:"5px",marginBottom:"2px"}}),h.getElement()],css:{marginTop:"15px",display:"flex",alignItems:"center",flexWrap:"wrap"}}),e){let t=new $49faab2330529a96$export$6e4a713ddcda1e5e.Select({optionArr:[["20min",$63d0b335c576c718$export$ce37e184d908d785("x-minutes",{x:"20"})],["40min",$63d0b335c576c718$export$ce37e184d908d785("x-minutes",{x:"40"})],["disabled"," "+$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-disabled")]],initValue:e.getSetting(),onChange:i=>{if("disabled"!==i)return void e.setSetting(i);let s=$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-confirm-disable");$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:""+$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-confirm-title"),div:$934e5f47c3374e21$export$db3b6bfb95261072("",[$934e5f47c3374e21$export$db3b6bfb95261072(".info-hint",$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-confirm-a")),$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-confirm-b")]),buttons:[s,"Cancel"],callback:n=>{n===s?e.setSetting(i):t.setValue(e.getSetting())}})},name:"save-reminder-interval"});t.getElement().style.flexGrow="1",this.rootEl.append($934e5f47c3374e21$export$db3b6bfb95261072(",flex,items-center,gap-5,mt-15,flexWrap",[$63d0b335c576c718$export$ce37e184d908d785("settings-save-reminder-label")+":",t.getElement()]))}function c(){return $2Eggz.BB.el({tagName:"a",content:$63d0b335c576c718$export$ce37e184d908d785("licenses"),onClick:()=>$385afea81bc7341b$export$d3fe39c7bff44f23()})}$2Eggz.BB.el({tagName:"button",parent:this.rootEl,content:[(0,$jmKbV.createImage)({alt:"icon",src:$parcel$interopDefault($125579f7a33d840c$exports),width:18,height:20,css:{marginRight:"5px"}}),$63d0b335c576c718$export$ce37e184d908d785("switch-ui-left-right")],onClick:()=>t(),css:{marginTop:"15px"},custom:{tabIndex:"-1"}}),this.rootEl.append($2Eggz.BB.el({className:"grid-hr",css:{margin:"10px 0"}})),i?(this.rootEl.append(i),i.innerHTML||$2Eggz.BB.el({parent:i,css:{textAlign:"center"}}).append($2Eggz.BB.el({content:[(0,$jmKbV.createImage)({alt:"icon",height:20,src:$parcel$interopDefault($ad3e45d1c2d7a6be$exports),css:{verticalAlign:"middle"}})," ",$2Eggz.BB.el({tagName:"a",content:"bitbof",custom:{href:"https://bitbof.com",target:"_blank",tabIndex:"-1"}}),"  2025",$2Eggz.BB.el({tagName:"br"})]}),c())):$2Eggz.BB.el({parent:this.rootEl,css:{textAlign:"center"},content:[(0,$jmKbV.createImage)({alt:"Klecks",className:"dark-invert",height:25,src:$parcel$interopDefault($d2b76ee5a41cc2d0$exports)}),$2Eggz.BB.el({tagName:"br"}),(0,$jmKbV.createImage)({alt:"icon",height:20,src:$parcel$interopDefault($ad3e45d1c2d7a6be$exports),css:{verticalAlign:"middle"}})," ",$2Eggz.BB.el({tagName:"a",content:"bitbof",custom:{href:"https://bitbof.com",target:"_blank",tabIndex:"-1"}}),"  2025",$2Eggz.BB.el({tagName:"br"})]}).append(c(),document.createTextNode(" | "),$2Eggz.BB.el({tagName:"a",content:$63d0b335c576c718$export$ce37e184d908d785("donate"),custom:{href:"https://kleki.com/donate/",target:"_blank"}}),document.createTextNode(" | "),$2Eggz.BB.el({tagName:"a",content:$63d0b335c576c718$export$ce37e184d908d785("source-code"),custom:{href:"https://klecks.org",target:"_blank"}})),window.addEventListener("storage",t=>{t.key===$63d0b335c576c718$export$991796128b2ca217&&a.setValue((0,$VM6dD.nullToUndefined)($dGRuJ.LocalStorage.getItem($63d0b335c576c718$export$991796128b2ca217)?$dGRuJ.LocalStorage.getItem($63d0b335c576c718$export$991796128b2ca217):"auto"))})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $6395dd91f6160304$export$42a534af7eb650e8{update(){let t=this.upBtn.style.display,e=this.downBtn.style.display;this.toolspace.scrollHeight>this.toolspace.offsetHeight+3?(this.upInterval||(t=0===this.toolspace.scrollTop?"none":"block"),this.downInterval||(e=this.toolspace.scrollTop+this.toolspace.offsetHeight+1>=this.toolspace.scrollHeight?"none":"block")):(t="none",e="none"),t!==this.upBtn.style.display&&(this.upBtn.style.display=t),e!==this.downBtn.style.display&&(this.downBtn.style.display=e)}updateUiState(t){(0,$VM6dD.css)(this.upBtn,{left:"left"===t?"0":"",right:"right"===t?"0":""}),(0,$VM6dD.css)(this.downBtn,{left:"left"===t?"0":"",right:"right"===t?"0":""})}constructor(t){this.toolspace=t.toolspace,this.upBtn=$2Eggz.BB.el({parent:this.toolspace,title:$63d0b335c576c718$export$ce37e184d908d785("scroll"),className:"kl-scroller",css:{top:"0",transform:"rotate(180deg)"}}),this.downBtn=$2Eggz.BB.el({parent:this.toolspace,title:$63d0b335c576c718$export$ce37e184d908d785("scroll"),className:"kl-scroller",css:{bottom:"0"}}),this.updateUiState(t.uiState),new $2Eggz.BB.PointerListener({target:this.upBtn,onPointer:t=>{"pointerdown"===t.type&&(this.upInterval=setInterval(()=>{this.toolspace.scrollBy(0,-13),this.update()},20)),"pointerup"===t.type&&(clearInterval(this.upInterval),setTimeout(()=>{this.upInterval=null,this.update()},50))}}),new $2Eggz.BB.PointerListener({target:this.downBtn,onPointer:t=>{"pointerdown"===t.type&&(this.downInterval=setInterval(()=>{this.toolspace.scrollBy(0,13),this.update()},20)),"pointerup"===t.type&&(clearInterval(this.downInterval),setTimeout(()=>{this.downInterval=null,this.update()},50))}});let e=t=>{this.toolspace.scrollBy(0,Math.round(.7*t.deltaY)),this.update()};this.upBtn.addEventListener("wheel",e,{passive:!1}),this.downBtn.addEventListener("wheel",e,{passive:!1}),this.update(),new MutationObserver(()=>this.update()).observe(this.toolspace,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("resize",()=>this.update()),$6b37b427615ca1fa$export$d3d1650bc39c4419.subscribe(t=>{this.upBtn.style.opacity=t>=1?"0":"",this.downBtn.style.opacity=t>=1?"0":""})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $2ae4a5af5e108b3d$export$7fa03d1ef9d3489e{updateIcons(){let t=this.settings.isReversed?"#0000":"#000",e=this.settings.isReversed?"#000":"#0000";this.iconArr[0].style.background=`linear-gradient(${t}, ${e})`,this.iconArr[1].style.background=`linear-gradient(${e}, ${t}, ${e})`,this.iconArr[2].style.background=`radial-gradient(${t}, ${e})`}getElement(){return this.rootEl}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=t?"block":"none",t&&this.colorDiv.append(this.colorSlider.getElement(),this.colorSlider.getOutputElement())}getSettings(){return $2Eggz.BB.copyObj(this.settings)}constructor(t){this.settings={opacity:1,type:"linear",doLockAlpha:!1,doSnap:!1,isReversed:!1,isEraser:!1},this.colorSlider=t.colorSlider,this.rootEl=$2Eggz.BB.el({css:{margin:"10px"}}),this.isVisible=!0,this.colorDiv=$2Eggz.BB.el({parent:this.rootEl,css:{marginBottom:"10px"}}),this.iconArr=[];{let t=33;[0,1,2].forEach(()=>{let e=$2Eggz.BB.el({className:"dark-invert",css:{width:t+"px",height:t+"px",borderRadius:"3px",margin:"1px"}});this.iconArr.push(e)})}this.updateIcons();let e=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"linear",label:this.iconArr[0],title:$63d0b335c576c718$export$ce37e184d908d785("gradient-linear")},{id:"linear-mirror",label:this.iconArr[1],title:$63d0b335c576c718$export$ce37e184d908d785("gradient-linear-mirror")},{id:"radial",label:this.iconArr[2],title:$63d0b335c576c718$export$ce37e184d908d785("gradient-radial")}],initId:"linear",onChange:t=>{this.settings.type=t}});this.rootEl.append(e.getElement());let i=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:250,height:30,min:.01,max:1,value:this.settings.opacity,toValue:t=>t/100,toDisplayValue:t=>100*t,onChange:t=>{this.settings.opacity=t}});(0,$VM6dD.css)(i.getElement(),{marginTop:"10px"}),this.rootEl.append(i.getElement());let s=$2Eggz.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px"}}),n=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("reverse"),callback:t=>{this.settings.isReversed=t,this.updateIcons()},css:{width:"50%"},name:"reverse-gradient"}),r=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("angle-snap"),title:$63d0b335c576c718$export$ce37e184d908d785("angle-snap-title"),callback:t=>{this.settings.doSnap=t},css:{width:"50%"},name:"enable-snapping"});s.append(n.getElement(),r.getElement());let a=$2Eggz.BB.el({parent:this.rootEl,css:{display:"flex",alignItems:"center",marginTop:"10px"}}),o=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:this.settings.isEraser,label:$63d0b335c576c718$export$ce37e184d908d785("eraser"),callback:t=>{this.settings.isEraser=t},css:{width:"50%"},name:"enable-eraser"}),l=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha"),title:$63d0b335c576c718$export$ce37e184d908d785("lock-alpha-title"),callback:t=>{this.settings.doLockAlpha=t},doHighlight:!0,css:{width:"50%"},name:"enable-alpha-lock"});a.append(o.getElement(),l.getElement())}}let $49faab2330529a96$export$6e4a713ddcda1e5e={BRUSHES:$8baf89d70f3487eb$export$32510733a89b2eab,BRUSHES_UI:$b2f1ee6bcab52d93$export$d1a79a5ce7e46547,BrushSettingService:$2cc9052c3f36f7f1$export$272bfd3ef9ef2f48,KlCanvas:$d26b85e649dca02a$export$4a819bde91671014,KlCanvasPreview:$1ac505c1a3109a32$export$e258ade1648009b7,FILTER_LIB_STATUS:$aa2ca71db1de8ae6$export$24724bc1f91cba3,FILTER_LIB:$aa2ca71db1de8ae6$export$bac24f240bb7727d,ShapeTool:$583d130d11db85ad$export$27550cc14d7ae85a,drawShape:$583d130d11db85ad$export$71b514a25c47df50,GradientTool:$64881aa9f7f8f596$export$74d12f09ff9f1956,drawGradient:$64881aa9f7f8f596$export$b1f70a113e3b5c1b,PSD:$e9d04a247aa46c18$exports,ProjectStore:$e42d359db0fc5c76$export$93d91060b9af7e2a,loadAgPsd:$e4b3248b4ce95ea5$export$ab3d838b1d336b38,SaveToComputer:$f853515918de2fdb$export$75e7b60500bb415b,Checkbox:$213947897b67ec3a$export$48513f6b9f8ce62d,input:$760dd90d44275661$export$b7e3ae3d7c15e42e,Select:$b1ef42bd443626ca$export$ef9b1a59e592288f,ImageToggle:$a14a8e8cf8cc5885$export$b6d053cded550773,ImageRadioList:$fa6faa989b2cc6b2$export$7cc1012a658e6ad8,RadioList:$f734cb8286217c3c$export$3dff5655255b5729,createPenPressureToggle:$218f70778c2bf652$export$9da2e8821e6cbb57,KlSlider:$cd73d123a4560ac3$export$a1855b925e534de7,HexColorDialog:$49ce344532144fcf$export$cc42e119007cb939,KlColorSlider:$90a88670cfc900e0$export$4e5102252876c5d7,KlColorSliderSmall:$8f768338795db7a0$export$66306bf21a9ff39e,PointSlider:$867da577d723d824$export$ac00cea56cec3037,ColorOptions:$3032e23fa8f3a9e5$export$24ba9b81662d4366,Options:$1166276dc18d3ea9$export$c019608e5b5bb4cb,BoxToggle:$8d99bd5fadaac7f9$export$2358c75ad3c15b2d,StatusOverlay:$7ed35ae008fa6be6$export$5ee0af1d5c87e856,CropCopy:$c5a9090dbc3ef918$export$40175a5948a88a57,FreeTransform:$d42d1384577ab84d$export$79a74567acf241b0,FreeTransformCanvas:$1fee4e0c7c231d15$export$205c2dd29f8a66b5,Cropper:$c4e8a5b20c195c16$export$71ed2b85d4ca43d3,LayerPreview:$6f827bc527014b7f$export$d25420b53e16716f,KlImageDropper:$71c20b9a25b8f899$export$e789742143ba5b1,OverlayToolspace:$b80d451cabaa19d2$export$9f0da9b942594e99,ToolspaceTopRow:$50947f5db7d72ab3$export$665d2c76b1eb8459,ToolDropdown:$d199831ecec4fae4$export$a0a40f8a0b8fee15,ToolspaceToolRow:$79297c17befec587$export$c744a22bef9e0b97,ToolspaceStabilizerRow:$6ae4f2a30e17169a$export$8162a66cd18867a7,TabRow:$ae064bc6cfaee2ee$export$3c6d17ed0106bfb9,ToolspaceCollapser:$da66208906376381$export$5b91f641162972fc,BrowserStorageUi:$1a83f3b0ed28fe18$export$9c72cf485ef46673,SaveReminder:$5ecc5a61dcd332b6$export$befc6437ad34b28a,ToolspaceScroller:$6395dd91f6160304$export$42a534af7eb650e8,DIALOG_COUNTER:$6b37b427615ca1fa$export$d3d1650bc39c4419,popup:$2016c314bff36ab9$export$d7e8d4d4450c819c,Popup:$18361e3f5d6257e8$export$185108a9b725b68,clipboardDialog:$5e9fef22bb47992b$export$32b89bc9bb92706a,showImportAsLayerDialog:$6be05b3a68464314$export$962af7e240721d88,newImageDialog:$d43dc22de82019e6$export$f77a89101d7d6586,textToolDialog:$3217004ef102ca9c$export$e263e067d6140649,showImportImageDialog:$aa951ef8a5f9de6d$export$1bf16d9bd59fd8f9,showIframePopup:$165d2995997b2f9b$export$35fa34e5af64bd4a,imgurUpload:$1acd53d54391923e$export$b1dd62fa0b5f32f5,HandUi:$d4c26c4eab3ed9b4$export$cf20160367bae46c,FillUi:$274b5c24f0b5af79$export$1e63e3b0645421a2,GradientUi:$2ae4a5af5e108b3d$export$7fa03d1ef9d3489e,TextUi:$a6bad5d4783f8133$export$32a22540e4b2f123,ShapeUi:$f0a35036bcb542fb$export$a9387b1d4260d39c,FileUi:$dad163782d7c02d0$export$409b892ffe02580b,EditUi:$bc1f03f9e593bc1c$export$aeb1a0a0e64541b5,SettingsUi:$4c0471ae90bf93cd$export$ad7f6c626a2cdfad,LayersUi:$a4100dd1ad7b3844$export$c3bf51e04f391d6d};Object.keys($49faab2330529a96$export$6e4a713ddcda1e5e);var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");class $db287580a54bd175$export$ce26cd3db18613a3{getElement(){return this.rootEl}constructor(t){function e(t){let e=6+(t.extraPadding?t.extraPadding:0),i=$2Eggz.BB.el({className:"toolspace-row-button nohighlight",title:t.title,onClick:t.onClick,css:{padding:t.content?"":t.contain?e+"px 0":""}});if(t.content)i.append(t.content);else{let e=$2Eggz.BB.el({className:"dark-invert",css:{backgroundImage:"url('"+t.image+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:t.contain?"contain":"",height:"100%"}});e.style.pointerEvents="none",i.append(e)}let s=new $2Eggz.BB.PointerListener({target:i,onEnterLeave:function(t){i.classList.toggle("toolspace-row-button-hover",t)}});return{el:i,pointerListener:s}}this.rootEl=$2Eggz.BB.el({className:"kl-toolspace-row",css:{height:"36px",display:"flex"}});let i=e({onClick:t.onSubmit,title:$63d0b335c576c718$export$ce37e184d908d785("submit-title"),content:$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("submit"),className:"toolspace-row-button__submit",css:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}}),contain:!0});i.el.style.width="45px";let s=e({onClick:t.onHelp,title:$63d0b335c576c718$export$ce37e184d908d785("help"),image:$parcel$interopDefault($1fbb59b08bf77b76$exports),contain:!0}),n=e({onClick:t.onLeftRight,title:$63d0b335c576c718$export$ce37e184d908d785("switch-ui-left-right"),image:$parcel$interopDefault($125579f7a33d840c$exports),contain:!0});this.rootEl.append(i.el,n.el,s.el)}}let $21a9e2eeab18749b$export$f02de051ab70b20e=60;var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD"),$ao0qX=parcelRequire("ao0qX");class $7f838dbc615d3028$export$94ec999f33a691e3{setPostMix(t){this.postMix=t}destroy(){var t;$2Eggz.BB.freeCanvas(this.textureSource),this.maskCanvas&&$2Eggz.BB.freeCanvas(this.maskCanvas),this.texture&&(this.texture=this.fxCanvas.texture(this.textureSource),this.fxCanvas.draw(this.texture).update(),this.texture&&this.texture.destroy()),null==(t=this.maskTexture)||t.destroy()}constructor(t){this.texture=void 0,this.maskCanvas=void 0,this.maskTexture=void 0,this.oldOnUpdateProps={textureWidth:0,textureHeight:0,transform:{scaleX:0,scaleY:0,angleDeg:0,x:0,y:0}},this.render=(t,e,i)=>{let s,n=$00bfc001d6438b5d$export$ad1d215dd03fe75a(t),r=0,a=$5c473edaf09eadd3$export$f0954fd7d5368655();{let t=$855520c81dfcb96a$export$9b20165a36586806(n,{x:0,y:0}),a=$855520c81dfcb96a$export$9b20165a36586806(n,{x:this.original.width,y:this.original.height});a.x=Math.round(a.x),a.y=Math.round(a.y);let o={x:Math.max(r,t.x),y:Math.max(r,t.y)},l={x:Math.min(e-r,a.x),y:Math.min(i-r,a.y)};if((s={x:o.x,y:o.y,width:l.x-o.x,height:l.y-o.y}).width<=0||s.height<=0)return this.textureSource.width=1,this.textureSource.height=1,this.textureSource}let o=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($077740f52fe6870e$export$70ae2c07e401031b(n),$cf0617f9860dc277$export$d73ee8ef04f5226a(r,r),$cf0617f9860dc277$export$d73ee8ef04f5226a(s.x-r,s.y-r)),l={textureWidth:Math.ceil(s.width),textureHeight:Math.ceil(s.height),transform:{scaleX:t.scaleX,scaleY:t.scaleY,angleDeg:t.angleDeg,x:t.x-s.x,y:t.y-s.y}},h=0,c=0;if(t.scaleX>1){let e=$855520c81dfcb96a$export$9b20165a36586806(o,{x:0,y:0});h=-e.x,c=-e.y,e.x=Math.max(0,Math.floor(e.x)),e.y=Math.max(0,Math.floor(e.y)),h+=e.x,c+=e.y;let i=$855520c81dfcb96a$export$9b20165a36586806(o,{x:s.width,y:s.height});i.x=Math.min(this.original.width,Math.ceil(i.x)),i.y=Math.min(this.original.height,Math.ceil(i.y));let n=i.x-e.x,r=i.y-e.y;l.textureWidth=n,l.textureHeight=r,l.transform={scaleX:1,scaleY:1,angleDeg:0,x:-e.x,y:-e.y},o=$611d5fdbbcda65d9$export$f672e0b6f7222cd7(o,$a78c550eaaca7cca$export$dcdf75081b88279d(t.scaleX,t.scaleY),$cf0617f9860dc277$export$d73ee8ef04f5226a(h,c))}if(!this.texture||JSON.stringify(l)!==JSON.stringify(this.oldOnUpdateProps)||this.postMix){this.textureSource.width=l.textureWidth,this.textureSource.height=l.textureHeight,this.ctx.save(),this.ctx.imageSmoothingEnabled=!1,a=t.scaleX>1?$00bfc001d6438b5d$export$ad1d215dd03fe75a(l.transform):$077740f52fe6870e$export$70ae2c07e401031b(o),this.ctx.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(a)),this.ctx.drawImage(this.original,0,0),this.ctx.restore();let e=JSON.stringify(l)!==JSON.stringify(this.oldOnUpdateProps);if((!this.texture||e)&&(this.texture?this.texture.loadContentsOf(this.textureSource):this.texture=this.fxCanvas.texture(this.textureSource)),this.selection&&(!this.maskTexture||e)){this.maskCanvas?(this.maskCanvas.width=l.textureWidth,this.maskCanvas.height=l.textureHeight):this.maskCanvas=$2Eggz.BB.canvas(l.textureWidth,l.textureHeight);let t=$2Eggz.BB.ctx(this.maskCanvas),e=$1d9e27e0466b80f7$export$aa391dbbf8073422(this.selection,a);(0,$ao0qX.drawSelectionMask)(e,t),this.maskTexture?this.maskTexture.loadContentsOf(this.maskCanvas):this.maskTexture=this.fxCanvas.texture(this.maskCanvas)}this.postMix||(this.textureSource.width=1,this.textureSource.height=1)}return(this.oldOnUpdateProps=l,this.onUpdate(this.fxCanvas.draw(this.texture),l.transform),this.maskTexture&&this.fxCanvas.multiplyAlpha().mask(this.maskTexture,this.isMaskingWithEmptyOriginal?void 0:this.texture).unmultiplyAlpha(),this.fxCanvas.update(),this.postMix)?(this.ctx.save(),this.ctx.globalAlpha=this.postMix.opacity,this.ctx.globalCompositeOperation=this.postMix.operation,this.ctx.drawImage(this.fxCanvas,0,0),this.ctx.restore(),{image:this.textureSource,transform:o}):{image:this.fxCanvas,transform:o}},this.original=t.original,this.onUpdate=t.onUpdate,this.textureSource=$2Eggz.BB.canvas(1,1),this.ctx=$2Eggz.BB.ctx(this.textureSource),this.fxCanvas=(0,$VM6dD.throwIfNull)($5caaf17bca0749c7$export$8c4423af32b21158()),this.postMix=t.postMix,this.selection=t.selection,this.isMaskingWithEmptyOriginal=!!t.isMaskingWithEmptyOriginal}}var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz"),$ao0qX=parcelRequire("ao0qX"),$8cWis=parcelRequire("8cWis");function $31c92ae106360499$export$66c6ccb6bcae2c94(t,e,i,s){let n,r=$5caaf17bca0749c7$export$8c4423af32b21158();if(!r)return!1;if(e){let i=$2Eggz.BB.canvas(t.canvas.width,t.canvas.height),s=$2Eggz.BB.ctx(i);(0,$ao0qX.drawSelectionMask)(e,s),n=r.texture(i),$2Eggz.BB.freeCanvas(i)}let a=r.texture(t.canvas);return r.draw(a),i(r),n&&(r.multiplyAlpha().mask(n,a).unmultiplyAlpha(),n.destroy()),a.destroy(),r.update(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(r,0,0),s.push($fc7b31422a41da93$export$263fa670dc037098(s.getComposed(),$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.canvas,e?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(e)):void 0))),!0}var $VM6dD=parcelRequire("VM6dD");let $257cfc293f7e7cb2$export$af433fb90aa90a38={getDialog(t){let e=$2Eggz.BB.el(),i={element:e},s=$8522c24dbe0f81fc$export$8f6817a932bf45cd();s||(i.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(s));let n=t.context,r=t.klCanvas;if(!n||!r)return!1;let a=r.getLayers(),o=r.getLayerIndex(n.canvas),l=0,h=0,c=new $7f838dbc615d3028$export$94ec999f33a691e3({original:n.canvas,onUpdate:t=>t.brightnessContrast(l,h),selection:r.getSelection()}),d=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-bright-contrast-brightness"),width:300,height:30,min:0,max:100,value:(l+1)*50,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){l=t/50-1,g.render()}}),p=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-bright-contrast-contrast"),width:300,height:30,min:0,max:100,value:(h+1)*50,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){h=t/50-1,g.render()}});d.getElement().style.marginBottom="10px",p.getElement().style.marginBottom="10px",e.append(d.getElement(),p.getElement());let u=[];for(let t=0;t<a.length;t++)u.push({image:t===o?c.render:a[t].context.canvas,isVisible:a[t].isVisible,opacity:a[t].opacity,mixModeStr:a[t].mixModeStr,hasClipping:!1});let g=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(s),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(s),project:{width:n.canvas.width,height:n.canvas.height,layers:u},selection:r.getSelection()});return g.render(),(0,$VM6dD.css)(g.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),e.append(g.getElement()),i.destroy=()=>{d.destroy(),p.destroy(),c.destroy(),g.destroy()},i.getInput=function(){return i.destroy(),{brightness:l,contrast:h}},i},apply(t){let e=t.layer.context,i=t.input.brightness,s=t.input.contrast,n=t.klHistory;return!!e&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.brightnessContrast(i,s)},n)}};var $2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis");let $979e97880c50429e$export$e5937df51b9e1d86={getDialog(t){let e=t.klCanvas;if(!e)return!1;let i=$2Eggz.BB.canvas();{let t=$2Eggz.BB.fitInto(e.getWidth(),e.getHeight(),560,400,1),s=parseInt(""+t.width),n=parseInt(""+t.height),r=s/e.getWidth();i.width=s,i.height=n,i.style.display="block",$2Eggz.BB.ctx(i).drawImage(e.getCompleteCanvas(r),0,0,s,n)}let s=$2Eggz.BB.el(),n={element:s},r=0,a=0,o=0,l=0,h=!1,c=!1,d=!1,p=!1,u=t.maxWidth,g=t.maxHeight,m=1,f=e.getSelection(),y=f?(0,$8cWis.intBoundsWithinArea)($b6390a4afb7d8067$export$a04a50ae6d6450f8(f),e.getWidth(),e.getHeight()):void 0;if(y){let t=y.x2-y.x1,i=y.y2-y.y1;t<=u&&i<=g?(o=y.y1,a=y.x2-e.getWidth(),l=y.y2-e.getHeight(),r=y.x1):y=void 0}let v=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:r,type:"number",min:-e.getWidth(),max:u,css:{width:"75px"},callback:function(){h=!0,T()}}),x=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:a,type:"number",min:-e.getWidth(),max:u,css:{width:"75px"},callback:function(){c=!0,T()}}),b=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:o,type:"number",min:-e.getHeight(),max:g,css:{width:"75px"},callback:function(){d=!0,T()}}),w=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l,type:"number",min:-e.getHeight(),max:g,css:{width:"75px"},callback:function(){p=!0,T()}}),B={display:"flex",flexDirection:"column",width:"calc(50% - 5px)",gap:"3px"},S=$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("filter-crop-left")+":",v],css:B}),C=$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("filter-crop-right")+":",x],css:B}),E=$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("filter-crop-top")+":",b],css:B}),k=$2Eggz.BB.el({content:[$63d0b335c576c718$export$ce37e184d908d785("filter-crop-bottom")+":",w],css:B}),I=$2Eggz.BB.el({css:{display:"flex",flexWrap:"wrap",gap:"10px"}});function T(){r=parseInt(v.value),a=parseInt(x.value),o=parseInt(b.value),l=parseInt(w.value);let t=e.getWidth()+r+a,i=e.getHeight()+o+l;t<=0&&(h&&(v.value=""+(r=-e.getWidth()-a+1)),c&&(x.value=""+(a=-e.getWidth()-r+1)),t=1),t>u&&(h&&(v.value=""+(r=-e.getWidth()-a+u)),c&&(x.value=""+(a=-e.getWidth()-r+u)),t=u),i<=0&&(d&&(b.value=""+(o=-e.getHeight()-l+1)),p&&(w.value=""+(l=-e.getHeight()-o+1)),i=1),i>g&&(d&&(b.value=""+(o=-e.getHeight()-l+g)),p&&(w.value=""+(l=-e.getHeight()-o+g)),i=g),F.setTransform({x:-r,y:-o,width:t,height:i}),h=!1,c=!1,d=!1,p=!1}I.append(S,C,E,k),s.append(I);let M=!0,P=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-crop-rule-thirds"),allowTab:!0,callback:function(t){M=t,F.showThirds(M)},name:"rule-of-thirds"});s.append($2Eggz.BB.el({css:{clear:"both"}}));let L={r:0,g:0,b:0,a:0},R=[{r:0,g:0,b:0,a:0},{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:1}];R.push({r:t.currentColorRgb.r,g:t.currentColorRgb.g,b:t.currentColorRgb.b,a:1}),R.push({r:t.secondaryColorRgb.r,g:t.secondaryColorRgb.g,b:t.secondaryColorRgb.b,a:1});let A=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({label:$63d0b335c576c718$export$ce37e184d908d785("filter-crop-fill"),colorArr:R,onChange:function(t){L=t,U()}}),D=$2Eggz.BB.el({css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"}});function z(t){let s=$2Eggz.BB.fitInto(t.width,t.height,260,180,1);m=s.width/t.width;let n=$2Eggz.BB.centerWithin($3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width,_,s.width,s.height);i.style.width=e.getWidth()*m+"px",i.style.height=e.getHeight()*m+"px",V.style.left=n.x-t.x*m+"px",V.style.top=n.y-t.y*m+"px",r=parseInt(""+-t.x),o=parseInt(""+-t.y),a=parseInt(""+(t.x+t.width-e.getWidth())),l=parseInt(""+(t.y+t.height-e.getHeight())),v.value=""+r,b.value=""+o,x.value=""+a,w.value=""+l,0!==L.a&&(i.style.background="var(--kl-checkerboard-background)",i.style.backgroundSize=100*m+"px"),O.style.backgroundPosition=n.x+"px "+n.y+"px",O.style.backgroundSize=100*m+"px",F.setScale(m)}s.append(D),D.append(P.getElement(),A.getElement());let _=$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height-2,O=$2Eggz.BB.el({className:"kl-edit-crop-preview",css:{width:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width+"px",marginTop:"10px",marginLeft:"-20px",height:_+"px",backgroundColor:"#9e9e9e",position:"relative",borderTop:"1px solid rgb(144,144,144)",borderBottom:"1px solid rgb(144,144,144)",overflow:"hidden",userSelect:"none",touchAction:"none",background:"var(--kl-checkerboard-background)"}});O.oncontextmenu=function(){return!1};let H=$2Eggz.BB.el({css:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0"}});O.append(H);let V=$2Eggz.BB.el({parent:O,css:{position:"absolute",left:"0",top:"0"}});$2Eggz.BB.el({parent:V,content:i,css:{boxShadow:"0 0 0px 1px rgb(130,130,130)",position:"absolute",left:"0px",top:"0px"}}),s.append(O);let F=new $c4e8a5b20c195c16$export$71ed2b85d4ca43d3({x:0,y:0,width:e.getWidth(),height:e.getHeight(),scale:m,callback:z,maxW:u,maxH:g,init:y});function U(){0===L.a?(H.style.background="",i.style.background=""):(H.style.background=$2Eggz.BB.ColorConverter.toRgbStr(L),i.style.background="var(--kl-checkerboard-background)",i.style.backgroundSize=100*m+"px")}return z(F.getTransform()),V.append(F.getElement()),n.destroy=()=>{F.destroy(),P.destroy(),A.destroy()},n.getInput=function(){return n.destroy(),{left:r,right:a,top:o,bottom:l,fillColor:0===L.a?void 0:L}},n},apply(t){let e=t.klCanvas;return!(!e||isNaN(t.input.left)||isNaN(t.input.right)||isNaN(t.input.top)||isNaN(t.input.bottom))&&(e.resizeCanvas(t.input),!0)}};var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $160131d78cb8ea88$export$4300cf0a0df418a6(){return $2Eggz.BB.copyObj({r:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],g:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]],b:[[0,0],[1/3,1/3],[2/3,2/3],[1,1]]})}class $160131d78cb8ea88$export$1c43bf66c2a2e4da{getElement(){return this.rootEl}getModeButtons(){return this.modeButtons}destroy(){this.p0.pointerListener.destroy(),this.p1.pointerListener.destroy(),this.p2.pointerListener.destroy(),this.p3.pointerListener.destroy()}constructor(t){this.rootEl=$2Eggz.BB.el({css:{position:"relative",marginBottom:"10px"}}),this.rootEl.oncontextmenu=()=>!1;let e="All",i=t.curves;this.modeButtons=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"All",label:$63d0b335c576c718$export$ce37e184d908d785("filter-curves-all")},{id:"Red",label:$63d0b335c576c718$export$ce37e184d908d785("red")},{id:"Green",label:$63d0b335c576c718$export$ce37e184d908d785("green")},{id:"Blue",label:$63d0b335c576c718$export$ce37e184d908d785("blue")}],initId:"All",onChange:t=>{"All"===(e=t)&&(i=$160131d78cb8ea88$export$4300cf0a0df418a6());let s=i.r;"Green"===e&&(s=i.g),"Blue"===e&&(s=i.b),this.p0.setPos(0,r-s[0][1]*r),this.p1.setPos(s[1][0]*n,r-s[1][1]*r),this.p2.setPos(s[2][0]*n,r-s[2][1]*r),this.p3.setPos(n,r-s[3][1]*r),d()}}),this.rootEl.append(this.modeButtons.getElement());let s=$2Eggz.BB.el({parent:this.rootEl,className:"kl-curves-graph",css:{position:"relative",marginTop:"10px"}}),n=300,r=100,a=$2Eggz.BB.canvas(n,r),o=$2Eggz.BB.ctx(a);s.append(a);let l=t=>Math.max(0,Math.min(1,t)),h=(t,e,i,a)=>{let o=14,l=e,h=t,c=$2Eggz.BB.el({className:"kl-curves-graph__grip",css:{left:t-o/2+"px",top:e-o/2+"px",width:o+"px",height:o+"px",borderRadius:o+"px"}}),d=()=>{(0,$VM6dD.css)(c,{left:t-o/2+"px",top:e-o/2+"px"})},p=new $2Eggz.BB.PointerListener({target:c,onPointer:s=>{s.eventPreventDefault(),"pointerdown"===s.type&&(h=t,l=e),"left"===s.button&&"pointermove"===s.type&&(a||(h+=s.dX),t=Math.max(0,Math.min(n,h)),l+=s.dY,e=Math.max(0,Math.min(r,l)),d(),i({x:t,y:e}))}});s.append(c);let u=(i,s)=>{t=i,l=e=s,h=t,(0,$VM6dD.css)(c,{left:t-o/2+"px",top:e-o/2+"px"})};return{el:c,setPos:u,pointerListener:p}},c=(t,s,a)=>{"All"===e&&(i.r[t]=[l(s/n),l(1-a/r)],i.g[t]=[l(s/n),l(1-a/r)],i.b[t]=[l(s/n),l(1-a/r)]),"Red"===e&&(i.r[t]=[l(s/n),l(1-a/r)]),"Green"===e&&(i.g[t]=[l(s/n),l(1-a/r)]),"Blue"===e&&(i.b[t]=[l(s/n),l(1-a/r)])};this.p0=h(0,r,t=>{c(0,t.x,t.y),d()},!0),this.p1=h(n/3,r/3*2,t=>{c(1,t.x,t.y),d()}),this.p2=h(n/3*2,r/3,t=>{c(2,t.x,t.y),d()}),this.p3=h(n,0,t=>{c(3,t.x,t.y),d()},!0);let d=()=>{(o=$2Eggz.BB.ctx(a)).clearRect(0,0,a.width,a.height);let s={r:[],g:[],b:[]};for(let t=0;t<i.r.length;t++)s.r.push(i.r[t]),s.g.push(i.g[t]),s.b.push(i.b[t]);let l=t=>{o.beginPath();let e=new $2Eggz.BB.SplineInterpolator(t);for(let t=0;t<100;t++){let i=e.interpolate(t/100);i=Math.max(0,Math.min(1,i)),0===t?o.moveTo(t/100*n,r-i*r):o.lineTo(t/100*n,r-i*r)}o.stroke()};o.save(),"All"===e?(o.strokeStyle="black",l(s.r)):(o.globalAlpha=.5,o.strokeStyle="red",l(s.r),o.strokeStyle="green",l(s.g),o.strokeStyle="blue",l(s.b)),o.restore(),t.callback(s)};d()}}var $VM6dD=parcelRequire("VM6dD");let $eafcde4f99931bb4$export$309483fcb6d5c7ca={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=$160131d78cb8ea88$export$4300cf0a0df418a6(),h=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:t=>t.curves(l.r,l.g,l.b),selection:i.getSelection()}),c=[];for(let t=0;t<s.length;t++)c.push({image:t===n?h.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let d=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:c},selection:i.getSelection()});(0,$VM6dD.css)(d.getElement(),{marginLeft:"-20px",marginRight:"-20px"});let p=new $160131d78cb8ea88$export$1c43bf66c2a2e4da({curves:l,callback:function(t){l=t,d.render()}}),u=p.getModeButtons();return r.append(p.getElement(),d.getElement()),a.destroy=()=>{p.destroy(),u.destroy(),h.destroy(),d.destroy()},a.getInput=function(){return a.destroy(),{curves:l}},a},apply(t){let e=t.layer.context,i=t.input.curves,s=t.klHistory;return!!e&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.curves(i.r,i.g,i.b)},s)}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $ca7e2a3c6a0e8777$export$9b1b7b3985b9625a={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.fitInto(e.canvas.width,e.canvas.height,280,200,1),a=parseInt(""+r.width),o=parseInt(""+r.height),l=$2Eggz.BB.el(),h={element:l},c=!0,d=!1,p=!0,u=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-flip-horizontal")+" ",allowTab:!0,callback:function(t){c=t,b()},css:{marginBottom:"10px"},name:"flip-horizontal"}),g=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:d,label:$63d0b335c576c718$export$ce37e184d908d785("filter-flip-vertical")+" ",allowTab:!0,callback:function(t){d=t,b()},css:{marginBottom:"10px"},name:"flip-vertical"});l.append(u.getElement()),l.append(g.getElement());let m=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-flip-image")},{id:!1,label:$63d0b335c576c718$export$ce37e184d908d785("filter-flip-layer")}],onChange:t=>{p=t,b()}});l.append(m.getElement());let f=$2Eggz.BB.el({className:"kl-preview-wrapper",css:{width:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width+"px",height:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height+"px"}}),y={image:$2Eggz.BB.canvas(Math.round(a),Math.round(o)),isVisible:!0,opacity:1,mixModeStr:"source-over"},v=new $1ac505c1a3109a32$export$e258ade1648009b7({width:Math.round(a),height:Math.round(o),layers:[y]}),x=$2Eggz.BB.el({className:"kl-preview-wrapper__canvas",css:{width:parseInt(""+a)+"px",height:parseInt(""+o)+"px"}});function b(){let t=$2Eggz.BB.ctx(y.image);t.save(),t.clearRect(0,0,y.image.width,y.image.height),p&&(c&&(t.translate(y.image.width,0),t.scale(-1,1)),d&&(t.translate(0,y.image.height),t.scale(1,-1)));for(let e=0;e<s.length;e++)s[e].isVisible&&(t.save(),!p&&n===e&&(c&&(t.translate(y.image.width,0),t.scale(-1,1)),d&&(t.translate(0,y.image.height),t.scale(1,-1))),t.canvas.width>s[e].context.canvas.width&&(t.imageSmoothingEnabled=!1),t.globalAlpha=s[e].opacity,t.globalCompositeOperation=s[e].mixModeStr,t.drawImage(s[e].context.canvas,0,0,y.image.width,y.image.height),t.restore());v.render(),t.restore()}return x.append(v.getElement()),f.append(x),setTimeout(b,0),l.append(f),h.destroy=()=>{u.destroy(),g.destroy(),m.destroy(),v.destroy()},h.getInput=function(){return h.destroy(),{horizontal:c,vertical:d,flipCanvas:p}},h},apply(t){let e=t.layer.context,i=t.klCanvas,s=t.input.horizontal,n=t.input.vertical,r=t.input.flipCanvas;return!!e&&!!i&&(i.flip(s,n,r?void 0:(0,$VM6dD.throwIfNull)(i.getLayerIndex(e.canvas))),!0)}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $345ea86e35fe44da$export$2aa46bd5587f0eb={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=0,h=0,c=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:t=>t.hueSaturation(l,h),selection:i.getSelection()}),d=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-hue-sat-hue"),width:300,height:30,min:-100,max:100,value:100*l,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){l=t/100,g.render()}}),p=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-hue-sat-saturation"),width:300,height:30,min:0,max:100,value:(h+1)*50,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){h=t/50-1,g.render()}});d.getElement().style.marginBottom="10px",p.getElement().style.marginBottom="10px",r.append(d.getElement(),p.getElement());let u=[];for(let t=0;t<s.length;t++)u.push({image:t===n?c.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let g=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:u},selection:i.getSelection()});return g.render(),(0,$VM6dD.css)(g.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),r.append(g.getElement()),a.destroy=()=>{d.destroy(),p.destroy(),c.destroy(),g.destroy()},a.getInput=function(){return a.destroy(),{hue:l,saturation:h}},a},apply(t){let e=t.layer.context,i=t.input.hue,s=t.klHistory,n=t.input.saturation;return!!e&&null!==i&&null!==n&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.hueSaturation(i,n)},s)}},$19cea8caa4f1f54e$export$b7ebcfbdc840ef76={apply(t){let e=t.layer.context,i=t.klHistory;return!!e&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.invert()},i)}};var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");class $db258f044f5ffd5c$export$b1241e74876d9bbe{update(){this.leftTab.classList.toggle("kl-2-tabs--active",0===this.value),this.rightTab.classList.toggle("kl-2-tabs--active",1===this.value)}getElement(){return this.rootEl}constructor(t){this.value=t.init,this.rootEl=$2Eggz.BB.el({className:"kl-2-tabs"}),this.leftTab=$2Eggz.BB.el({parent:this.rootEl,content:t.left,className:"kl-2-tabs__left"}),this.leftTab.onpointerdown=()=>!1,this.rightTab=$2Eggz.BB.el({parent:this.rootEl,content:t.right,className:"kl-2-tabs__right"}),this.rightTab.onpointerdown=()=>!1,this.update(),this.leftTab.onclick=()=>{0!==this.value&&(this.value=0,this.update(),t.onChange(this.value))},this.rightTab.onclick=()=>{1!==this.value&&(this.value=1,this.update(),t.onChange(this.value))}}}var $VM6dD=parcelRequire("VM6dD"),$wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $d90200485e14eee7$var$SIZE=16;class $d90200485e14eee7$export$87247fc399965417{update(){let t=$855520c81dfcb96a$export$9b20165a36586806($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.transform),this.value);(0,$VM6dD.css)(this.rootEl,{left:t.x-$d90200485e14eee7$var$SIZE/2+"px",top:t.y-$d90200485e14eee7$var$SIZE/2+"px"})}setTransform(t){JSON.stringify(this.transform)!==JSON.stringify(t)&&(this.transform=t,this.update())}getValue(){return this.value}setValue(t){this.value=(0,$wpIFA._)({},t),this.update()}getElement(){return this.rootEl}destroy(){this.rootEl.remove(),this.pointerListener.destroy()}constructor(t){this.value=(0,$wpIFA._)({},t.value),this.transform={x:0,y:0,scale:1,angleDeg:0},this.rootEl=$2Eggz.BB.el({css:{width:$d90200485e14eee7$var$SIZE+"px",height:$d90200485e14eee7$var$SIZE+"px",backgroundColor:"#fff",border:"2px solid #000",borderRadius:$d90200485e14eee7$var$SIZE+"px",position:"absolute",cursor:"move",userSelect:"none",touchAction:"none"}}),this.pointerListener=new $2Eggz.BB.PointerListener({target:this.rootEl,onPointer:e=>{e.eventPreventDefault(),"left"===e.button&&"pointermove"===e.type&&(this.value.x+=e.dX/this.transform.scale,this.value.y+=e.dY/this.transform.scale,this.update(),t.onChange(this.value))}})}}let $68cd0c4958325f46$export$a76d798fa7d85e4e={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=$8522c24dbe0f81fc$export$8f6817a932bf45cd(),n=i.getLayers(),r=i.getLayerIndex(e.canvas),a=$2Eggz.BB.el(),o={element:a};s||(o.width=$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.width);let l=(0,$VM6dD.throwIfNull)($5caaf17bca0749c7$export$8c4423af32b21158()),h=(0,$VM6dD.throwIfUndefined)(null==l?void 0:l.texture(e.canvas));function c(){m?l.draw(h).update():l.draw(h).perspective(g(p),g(u)).update(),v.render()}let d=[{x:0,y:0},{x:e.canvas.width,y:0},{x:e.canvas.width,y:e.canvas.height},{x:0,y:e.canvas.height}],p=d.map(t=>new $d90200485e14eee7$export$87247fc399965417({value:t,onChange:()=>{c()}}));p.forEach(t=>t.getElement().style.display="none");let u=d.map(t=>new $d90200485e14eee7$export$87247fc399965417({value:t,onChange:()=>{c()}}));function g(t,e){return t.flatMap(t=>{let i=t.getValue();return e&&(i=$855520c81dfcb96a$export$9b20165a36586806(e,i)),[i.x,i.y]})}let m=!1,f=new $db258f044f5ffd5c$export$b1241e74876d9bbe({left:$63d0b335c576c718$export$ce37e184d908d785("compare-before"),right:$63d0b335c576c718$export$ce37e184d908d785("compare-after"),init:1,onChange:t=>{(m=0===t)?(p.forEach(t=>t.getElement().style.display="block"),u.forEach(t=>t.getElement().style.display="none")):(p.forEach((t,e)=>{u[e].setValue(t.getValue())}),p.forEach(t=>t.getElement().style.display="none"),u.forEach(t=>t.getElement().style.display="block")),c()}});a.append(f.getElement());let y=[];for(let t=0;t<n.length;t++)y.push({image:t===r?l:n[t].context.canvas,isVisible:n[t].isVisible,opacity:n[t].opacity,mixModeStr:n[t].mixModeStr,hasClipping:!1});let v=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(s),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(s),project:{width:e.canvas.width,height:e.canvas.height,layers:y},onTransformChange:t=>{p.forEach(e=>e.setTransform(t)),u.forEach(e=>e.setTransform(t))}});return(0,$VM6dD.css)(v.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),v.getElement().append(...p.map(t=>t.getElement()),...u.map(t=>t.getElement())),a.append(v.getElement()),c(),o.destroy=()=>{v.destroy(),h.destroy(),p.forEach(t=>t.destroy()),u.forEach(t=>t.destroy())},o.getInput=()=>(o.destroy(),{before:g(p),after:g(u)}),o},apply(t){let e=t.layer.context,i=t.klHistory,s=t.input.before,n=t.input.after;if(!e||!s||!n)return!1;let r=$5caaf17bca0749c7$export$8c4423af32b21158();if(!r)return!1;let a=r.texture(e.canvas);r.draw(a).multiplyAlpha().perspective(s,n).unmultiplyAlpha().update(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(r,0,0),a.destroy();{let e=Object.fromEntries(t.klCanvas.getLayers().map(e=>e.id===t.layer.id?[e.id,{tiles:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.layer.canvas)}]:[e.id,{}]));i.push({layerMap:e})}return!0}};var $2Eggz=parcelRequire("2Eggz"),$f8b38569e2ea4e10$exports={};$f8b38569e2ea4e10$exports=$parcel$resolve("2xc61");var $VM6dD=parcelRequire("VM6dD");let $7bec11dd1272a23d$export$5705240d31427a82={getDialog(t){let e=t.klCanvas;if(!e)return!1;let i=$2Eggz.BB.fitInto(e.getWidth(),e.getHeight(),280,200,1),s=parseInt(""+i.width),n=parseInt(""+i.height),r=s/e.getWidth(),a=e.getCompleteCanvas(1),o=$2Eggz.BB.el(),l={element:o},h=e.getWidth(),c=e.getHeight(),d=t.maxWidth,p=t.maxHeight,u=$2Eggz.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),g=$2Eggz.BB.el({css:{width:"150px",height:"35px",lineHeight:"30px"}}),m=$2Eggz.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+d,value:""+e.getWidth()}}),f=$2Eggz.BB.el({tagName:"input",css:{cssFloat:"right",width:"90px"},custom:{type:"number",min:"1",max:""+p,value:""+e.getHeight()}});m.onclick=function(){this.focus(),b=!0,M()},f.onclick=function(){this.focus(),x=!0,M()},m.onchange=function(){b=!0,M()},f.onchange=function(){x=!0,M()},u.append($63d0b335c576c718$export$ce37e184d908d785("width")+": ",m),g.append($63d0b335c576c718$export$ce37e184d908d785("height")+": ",f),$2Eggz.BB.el({css:{background:"url("+$parcel$interopDefault($f8b38569e2ea4e10$exports)+") no-repeat 140px 5px",backgroundSize:"50px 52px"}}).append(u,g);let y=new Image;y.src=$parcel$interopDefault($f8b38569e2ea4e10$exports),y.height=40;let v=$1b372d80cb7a52ec$export$9852986a3ec5f6a0([[$63d0b335c576c718$export$ce37e184d908d785("width")+":&nbsp;",m,y],[$2Eggz.BB.el({css:{height:"5px"}}),"",""],[$63d0b335c576c718$export$ce37e184d908d785("height")+":&nbsp;",f]],{"0.2":{rowspan:3}});(0,$VM6dD.css)(v,{marginBottom:"10px"}),o.append(v);let x=!1,b=!1,w=e.getWidth()/e.getHeight();function B(){y.style.display=S?"":"none",S&&(m.value=""+e.getWidth(),f.value=""+e.getHeight(),M())}let S=!0,C=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("constrain-proportions"),allowTab:!0,callback:function(t){S=t,B()},name:"constrain-proportions"});o.append($2Eggz.BB.el({css:{clear:"both"}}));let E=new $b1ef42bd443626ca$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$63d0b335c576c718$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$63d0b335c576c718$export$ce37e184d908d785("algorithm-pixelated")]],title:$63d0b335c576c718$export$ce37e184d908d785("scaling-algorithm"),initValue:"smooth",onChange:()=>{M()},name:"interpolation-algorithm"});$2Eggz.BB.el({parent:o,css:{display:"flex",justifyContent:"space-between",alignItems:"center"}}).append(C.getElement(),E.getElement());let k=$2Eggz.BB.canvas(s,n);k.style.imageRendering="pixelated";let I=$2Eggz.BB.ctx(k);function T(){"smooth"===E.getValue()?(k.style.imageRendering=r>1?"pixelated":"",k.width=e.getWidth(),k.height=e.getHeight(),I.save(),I.imageSmoothingQuality="high",I.drawImage(a,0,0),$2Eggz.BB.resizeCanvas(k,h,c)):(k.style.imageRendering="pixelated",k.width=h,k.height=c,I.save(),I.imageSmoothingEnabled=!1,I.drawImage(a,0,0,k.width,k.height)),I.restore()}function M(){if(0===m.value.length&&b||0===f.value.length&&x){x=!1,b=!1;return}if(m.value=""+Math.max(1,parseInt(m.value)),f.value=""+Math.max(1,parseInt(f.value)),S&&(x&&(m.value=""+parseInt(""+parseInt(f.value)*w)),b&&(f.value=""+parseInt(""+parseInt(m.value)/w)),parseInt(m.value)>d||parseInt(f.value)>p)){let t=$2Eggz.BB.fitInto(parseInt(m.value),parseInt(f.value),d,p,1);m.value=""+parseInt(""+t.width),f.value=""+parseInt(""+t.height)}parseInt(m.value)>d&&(m.value=""+d),parseInt(f.value)>p&&(f.value=""+p),x=!1,b=!1,h=parseInt(m.value),c=parseInt(f.value);let t=$2Eggz.BB.fitInto(h,c,280,200,1),e=parseInt(""+t.width),i=parseInt(""+t.height);r=e/h;let s=$2Eggz.BB.centerWithin($3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width,$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height,e,i);T(),k.style.width=Math.max(1,e)+"px",k.style.height=Math.max(1,i)+"px",L.style.left=s.x+"px",L.style.top=s.y+"px",L.style.width=Math.max(1,e)+"px",L.style.height=Math.max(1,i)+"px"}let P=$2Eggz.BB.el({className:"kl-transparent-preview",css:{width:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width+"px",height:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height+"px",marginLeft:"-20px",display:"table",marginTop:"10px",position:"relative",userSelect:"none",background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}}),L=$2Eggz.BB.el({parent:P,content:k,className:"kl-transparent-preview__canvas",css:{width:s+"px",height:n+"px",position:"absolute",overflow:"hidden"}});return o.append(P),M(),l.destroy=()=>{C.destroy()},l.getInput=function(){return l.destroy(),{width:h,height:c,algorithm:E.getValue()}},l},apply(t){let e=t.klCanvas,i=t.input.width,s=t.input.height,n=t.input.algorithm;return!!e&&(e.resize(i,s,n),!0)}};var $2Eggz=parcelRequire("2Eggz");let $4e52484ae64ee478$export$ac7e9efc751d5791={getDialog(t){let e=t.klCanvas;if(!e)return!1;let i=$2Eggz.BB.fitInto(e.getWidth(),e.getHeight(),280,200,1),s=parseInt(""+i.width),n=parseInt(""+i.height),r=s/e.getWidth(),a=$2Eggz.BB.canvas(s,n);a.style.display="block",$2Eggz.BB.ctx(a).drawImage(e.getCompleteCanvas(r),0,0,s,n);let o=$2Eggz.BB.el(),l={element:o},h=0;function c(){if(m.style.transform="rotate("+h+"deg)",90===Math.abs(h%180)){let t=parseInt(""+$2Eggz.BB.fitInto(n,s,280,200,1).height)/s;m.style.transform="rotate("+h+"deg) scale("+t+")"}}let d=$2Eggz.BB.el({tagName:"button",content:[$2Eggz.BB.el({tagName:"span",content:"",css:{fontSize:"1.3em"}})," 90"],onClick:()=>{h-=90,c()},noRef:!0}),p=$2Eggz.BB.el({tagName:"button",content:[$2Eggz.BB.el({tagName:"span",content:"",css:{fontSize:"1.3em"}})," 90"],onClick:()=>{h+=90,c()},noRef:!0,css:{marginLeft:"5px"}});o.append(d,p);let u=$2Eggz.BB.el({className:"kl-preview-wrapper",css:{width:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.width+"px",height:$3ec5d4ed5944260f$export$ec2d17c6d3ae0768.height+"px",display:"table"}}),g=$2Eggz.BB.el({parent:u,css:{display:"table-cell",verticalAlign:"middle"}}),m=$2Eggz.BB.el({parent:g,content:a,className:"kl-preview-wrapper__canvas",css:{width:s+"px",height:n+"px",marginLeft:"auto",marginRight:"auto",overflow:"hidden",background:"var(--kl-checkerboard-background)",backgroundSize:"16px"}});return m.style.transition="transform 0.2s ease-out",o.append(u),c(),l.destroy=()=>{},l.getInput=function(){return l.destroy(),{deg:h}},l},apply(t){let e=t.klCanvas;return!!e&&(e.rotate(t.input.deg),!0)}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $5aa2347b5ccd9148$export$1b8796b18b7c19ed={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=20,h=200,c={destroy:()=>{}};function d(){y.render()}c=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:(t,e)=>{p.setTransform(y.getTransform()),u.setTransform(y.getTransform());let i=$00bfc001d6438b5d$export$ad1d215dd03fe75a(e),s=$855520c81dfcb96a$export$9b20165a36586806(i,p.getValue()),n=$855520c81dfcb96a$export$9b20165a36586806(i,u.getValue());return t.multiplyAlpha().tiltShift(s.x,s.y,n.x,n.y,l*e.scaleX,h*e.scaleX).unmultiplyAlpha()},selection:i.getSelection()});let p=new $d90200485e14eee7$export$87247fc399965417({value:{x:e.canvas.width/4,y:e.canvas.height/2},onChange:()=>{d()}}),u=new $d90200485e14eee7$export$87247fc399965417({value:{x:3*e.canvas.width/4,y:e.canvas.height/2},onChange:()=>{d()}}),g=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-tilt-shift-gradient"),width:300,height:30,min:0,max:1e3,value:h,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){h=t,d()}});g.getElement().style.marginBottom="10px",r.append(g.getElement());let m=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-tilt-shift-blur"),width:300,height:30,min:0,max:200,value:l,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){l=t,d()}});m.getElement().style.marginBottom="10px",r.append(m.getElement());let f=[];for(let t=0;t<s.length;t++)f.push({image:t===n?c.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let y=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:f},selection:i.getSelection()});return y.render(),(0,$VM6dD.css)(y.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),y.getElement().append(p.getElement(),u.getElement()),r.append(y.getElement()),a.destroy=()=>{m.destroy(),g.destroy(),p.destroy(),u.destroy(),c.destroy(),y.destroy()},a.getInput=function(){return a.destroy(),{a:p.getValue(),b:u.getValue(),blur:l,gradient:h}},a},apply(t){let e=t.layer.context,i=t.klHistory,s=t.input.a,n=t.input.b,r=t.input.blur,a=t.input.gradient;return!!e&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.multiplyAlpha().tiltShift(s.x,s.y,n.x,n.y,r,a).unmultiplyAlpha()},i)}};var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD"),$aXq9D=parcelRequire("aXq9D");function $31d0877b7a0bd896$var$getIsTransparentBg(t,e,i){return!t||(void 0!==i?i:e)}function $31d0877b7a0bd896$var$parseCssColor(t){if(t.startsWith("#")){let e=t.slice(1);3===e.length&&(e=e.split("").map(t=>t+t).join("")),6===e.length&&(e+="ff");let i=parseInt(e,16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:(255&i)/255}}let e=t.match(/rgba?\(([^)]+)\)/);if(e){let[t,i,s,n=1]=e[1].split(",").map(t=>parseFloat(t.trim()));return{r:t,g:i,b:s,a:n}}}function $31d0877b7a0bd896$export$d7a217b118c790a6(t){for(let e of t.tiles)if($15ded6c5722f2bc8$export$dba0834b723f37f4(e)){let t=$31d0877b7a0bd896$var$parseCssColor(e.fill);if(t&&t.a<1)return!0}else{let t=e.data.data;for(let e=3;e<t.length;e+=4)if(t[e]<255)return!0}return!1}function $31d0877b7a0bd896$var$drawTransform(t,e,i,s,n,r,a,o){let l,h=t.canvas.width,c=t.canvas.height;if(t.save(),t.clearRect(0,0,h,c),t.save(),n){if(t.drawImage(e,0,0),!a){let e=(0,$aXq9D.getSelectionPath2d)(n);t.clip(e),t.globalCompositeOperation=o?"destination-out":"source-atop",t.fillStyle="white",t.fillRect(0,0,h,c)}}else o?a&&t.drawImage(e,0,0):(t.drawImage(e,0,0),a||(t.fillStyle="white",t.globalCompositeOperation="source-atop",t.fillRect(0,0,h,c)));if(t.restore(),n){let a=null!=r?r:{x:0,y:0,width:t.canvas.width,height:t.canvas.height};i||$2Eggz.BB.testShouldPixelate(s,s.width/a.width,s.height/a.height)?t.imageSmoothingEnabled=!1:(t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high"),l=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(s.x,s.y),$20520e5c69c4ad5d$export$bb628a54ab399bc9(s.angleDeg/180*Math.PI),$a78c550eaaca7cca$export$dcdf75081b88279d(s.width>0?1:-1,s.height>0?1:-1),$cf0617f9860dc277$export$d73ee8ef04f5226a(-Math.abs(s.width)/2,-Math.abs(s.height)/2),$a78c550eaaca7cca$export$dcdf75081b88279d(Math.abs(s.width/a.width),Math.abs(s.height/a.height)),$cf0617f9860dc277$export$d73ee8ef04f5226a(-a.x,-a.y)),t.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(l));let o=(0,$aXq9D.getSelectionPath2d)(n);t.clip(o),t.drawImage(e,0,0)}else $2Eggz.BB.drawTransformedImageWithBounds(t,e,s,r,i);return t.restore(),l}let $31d0877b7a0bd896$export$dc15474d94cdc2b3={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=$8522c24dbe0f81fc$export$8f6817a932bf45cd(),n=i.getLayers(),r=(0,$VM6dD.throwIfNull)(i.getLayerIndex(e.canvas)),a=0===r,o=!1;a&&(o=$31d0877b7a0bd896$export$d7a217b118c790a6(Object.entries(t.composed.layerMap).find(([t,e])=>e.index===r)[1]));let l=i.getSelection(),h=l?$273e2af276df50c0$export$6be4733fa804854c(l,e):$2Eggz.BB.canvasBounds(e);if(!h)return{error:$63d0b335c576c718$export$ce37e184d908d785(l?"filter-transform-empty-selection":"filter-transform-empty")};let c={x:h.x+h.width/2,y:h.y+h.height/2,width:h.width,height:h.height,angleDeg:0},d=$2Eggz.BB.el(),p={element:d};s||(p.width=$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.width);let u=new $2Eggz.BB.KeyListener({onDown:function(t){$2Eggz.BB.isInputFocused(!0)||("left"===t&&(v.value=""+(parseFloat(v.value)-1),Y()),"right"===t&&(v.value=""+(parseFloat(v.value)+1),Y()),"up"===t&&(y.value=""+(parseFloat(y.value)-1),Y()),"down"===t&&(y.value=""+(parseFloat(y.value)+1),Y()))}}),g=$2Eggz.BB.el({css:{width:"100px",height:"30px",display:"inline-block"}}),m=$2Eggz.BB.el({css:{width:"100px",height:"30px",display:"inline-block"}}),f=$2Eggz.BB.el({css:{width:"150px",height:"30px",display:"inline-block"}}),y=$2Eggz.BB.el({tagName:"input"}),v=$2Eggz.BB.el({tagName:"input"}),x=$2Eggz.BB.el({tagName:"input"});y.type="number",v.type="number",x.type="number",v.style.width="70px",y.style.width="70px",x.style.width="70px",y.value="0",v.value="0",x.value="0",y.onclick=function(){y.focus(),Y()},v.onclick=function(){v.focus(),Y()},x.onclick=function(){x.focus(),Y()},y.onchange=function(){Y()},v.onchange=function(){Y()},x.onchange=function(){Y()},y.onkeyup=function(){Y()},v.onkeyup=function(){Y()},x.onkeyup=function(){Y()},g.append("X: ",v),m.append("Y: ",y),f.append($63d0b335c576c718$export$ce37e184d908d785("filter-transform-rotation")+": ",x),s||$2Eggz.BB.el({parent:d,css:{marginTop:"10px"}}).append(g,m,f);let b=$2Eggz.BB.el({parent:d,css:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",marginTop:"10px"}}),w=$2Eggz.BB.el({parent:b,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-flip")+" X",onClick:()=>{let t=X.getValue();X.setSize(-t.width,t.height)}}),B=$2Eggz.BB.el({parent:b,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-flip")+" Y",onClick:()=>{let t=X.getValue();X.setSize(t.width,-t.height)}}),S=$2Eggz.BB.el({parent:b,tagName:"button",content:"-90",onClick:()=>{let t=X.getValue();t.angleDeg-=90,t.angleDeg%=360,X.setAngleDeg(t.angleDeg),x.value=""+Math.round(t.angleDeg),W()}}),C=$2Eggz.BB.el({parent:b,tagName:"button",content:"+90",onClick:()=>{let t=X.getValue();t.angleDeg+=90,t.angleDeg%=360,X.setAngleDeg(t.angleDeg),x.value=""+Math.round(t.angleDeg),W()}}),E=$2Eggz.BB.el({parent:b,tagName:"button",content:"2&times;",onClick:()=>{let t=X.getValue();D.getValue()?X.setSize((t.width<0?-1:1)*X.getRatio()*Math.abs(t.height)*2,2*t.height):X.setSize(2*t.width,2*t.height)}}),k=$2Eggz.BB.el({parent:b,tagName:"button",content:"&frac12;&times;",onClick:()=>{let t=X.getValue();X.setSize(Math.round(t.width/2),Math.round(t.height/2))}}),I=$2Eggz.BB.el({parent:b,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("center"),onClick:()=>{let t=X.getValue();X.setPos({x:e.canvas.width/2,y:e.canvas.height/2}),X.setAngleDeg(t.angleDeg),W()}}),T=!1,M=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!1,label:$63d0b335c576c718$export$ce37e184d908d785("select-transform-clone"),allowTab:!0,callback:function(t){T=t,W(!0)},css:{display:"inline-block"},name:"clone-before-transforming"}),P=$31d0877b7a0bd896$var$getIsTransparentBg(a,o,$31d0877b7a0bd896$var$preferenceIsTransparentBg),L=!1,R=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:P,label:$63d0b335c576c718$export$ce37e184d908d785("brush-eraser-transparent-bg"),allowTab:!0,callback:function(t){L=!0,P=t,W(!0)},css:{display:"inline-block"},name:"transparent-background"});b.append(M.getElement()),a&&b.append(R.getElement());let A=!0,D=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-constrain"),title:$63d0b335c576c718$export$ce37e184d908d785("constrain-proportions"),allowTab:!0,callback:function(t){A=t,X.setIsConstrained(A)},css:{display:"inline-block"},name:"constrain-proportions"}),z=!1,_=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-snap"),title:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-snap-title"),allowTab:!0,callback:function(t){z=t,X.setSnapping(z)},css:{display:"inline-block",marginLeft:"10px"},name:"enable-snapping"}),O=$2Eggz.BB.el();O.append(D.getElement(),_.getElement()),d.append($2Eggz.BB.el({css:{clear:"both",height:"10px"}}));let H=$2Eggz.BB.el({parent:d,css:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}}),V=new $b1ef42bd443626ca$export$ef9b1a59e592288f({isFocusable:!0,optionArr:[["smooth",$63d0b335c576c718$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$63d0b335c576c718$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",title:$63d0b335c576c718$export$ce37e184d908d785("scaling-algorithm"),onChange:()=>{W(!0)},name:"interpolation-algorithm"});H.append(O,V.getElement());let F=$2Eggz.BB.canvas(e.canvas.width,e.canvas.height),U=[];for(let t=0;t<n.length;t++)U.push({image:t===r?F:n[t].context.canvas,isVisible:n[t].isVisible,opacity:n[t].opacity,mixModeStr:n[t].mixModeStr,hasClipping:!1});let j=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(s),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(s),project:{width:e.canvas.width,height:e.canvas.height,layers:U},hasEditMode:!0,onModeChange:t=>{X.getElement().style.pointerEvents="edit"===t?"":"none",X.getElement().style.opacity="edit"===t?"":"0.5"},onTransformChange:t=>{X.setViewportTransform(t)},padding:30});j.render(),(0,$VM6dD.css)(j.getElement(),{overflow:"hidden",marginLeft:"-20px",marginRight:"-20px"}),d.append(j.getElement());let N="";function W(t=!1){if(!X)return;let e=X.getValue();(JSON.stringify(e)!==N||t)&&(N=JSON.stringify(e),$31d0877b7a0bd896$var$drawTransform($2Eggz.BB.ctx(F),n[r].context.canvas,"pixelated"===V.getValue(),e,l,h,T,P||r>0),j.render())}let X=new $d42d1384577ab84d$export$79a74567acf241b0({x:c.x,y:c.y,width:c.width,height:c.height,angleDeg:c.angleDeg,isConstrained:!0,snapX:[0,e.canvas.width],snapY:[0,e.canvas.height],callback:function(t){v.value=""+Math.round(t.x-c.x),y.value=""+Math.round(t.y-c.y),x.value=""+Math.round(t.angleDeg),W()},viewportTransform:j.getTransform()});function Y(){X.setPos({x:parseInt(v.value)+c.x,y:parseInt(y.value)+c.y}),X.setAngleDeg(parseInt(x.value)),W()}return(0,$VM6dD.css)(X.getElement(),{position:"absolute",left:"0",top:"0"}),j.getElement().append(X.getElement()),W(),p.destroy=()=>{u.destroy(),X.destroy(),D.destroy(),_.destroy(),$2Eggz.BB.destroyEl(w),$2Eggz.BB.destroyEl(B),$2Eggz.BB.destroyEl(S),$2Eggz.BB.destroyEl(C),$2Eggz.BB.destroyEl(E),$2Eggz.BB.destroyEl(k),$2Eggz.BB.destroyEl(I),j.destroy(),$2Eggz.BB.freeCanvas(F)},p.getInput=function(){let t=X.getValue();L&&($31d0877b7a0bd896$var$preferenceIsTransparentBg=P);let e={transform:t,bounds:h,isPixelated:"pixelated"===V.getValue(),doClone:T,isTransparentBg:P};return p.destroy(),$2Eggz.BB.copyObj(e)},p},apply(t){let e=t.layer.context,i=t.klHistory;if(!e)return!1;i.pause(!0);let s=t.input,n=t.klCanvas.getLayerIndex(e.canvas),r=$2Eggz.BB.copyCanvas(e.canvas),a=t.klCanvas.getSelection(),o=$31d0877b7a0bd896$var$drawTransform(e,r,s.isPixelated,s.transform,a,s.bounds,s.doClone,s.isTransparentBg||n>0);a&&o&&(a=$1d9e27e0466b80f7$export$aa391dbbf8073422(a,o),t.klCanvas.setSelection(a)),i.pause(!1);{let e=Object.fromEntries(t.klCanvas.getLayers().map(e=>e.id===t.layer.id?[e.id,{tiles:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.layer.canvas)}]:[e.id,{}]));i.push((0,$wpIFA._)({layerMap:e},a?{selection:{value:a}}:void 0))}return!0}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $b3e717c77532e1e1$export$55e7eb2ebd0db869={getDialog(t){let e=t.klCanvas,i=t.context;if(!e||!i)return!1;let s=e.getLayers(),n=e.getLayerIndex(i.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=10,h=new $7f838dbc615d3028$export$94ec999f33a691e3({original:i.canvas,onUpdate:(t,e)=>t.multiplyAlpha().triangleBlur(l*e.scaleX).unmultiplyAlpha(),selection:e.getSelection()}),c=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("radius"),width:300,height:30,min:1,max:200,value:l,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:t=>{l=t,p.render()}});c.getElement().style.marginBottom="10px",r.append(c.getElement());let d=[];for(let t=0;t<s.length;t++)d.push({image:t===n?h.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let p=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:i.canvas.width,height:i.canvas.height,layers:d},selection:e.getSelection()});return p.render(),(0,$VM6dD.css)(p.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),r.append(p.getElement()),a.destroy=()=>{c.destroy(),h.destroy(),p.destroy()},a.getInput=function(){return a.destroy(),{radius:l}},a},apply(t){let e=t.layer.context,i=t.klHistory,s=t.input.radius;return!!e&&!!s&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.multiplyAlpha().triangleBlur(s).unmultiplyAlpha()},i)}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $a392dfa9711a1868$export$62ac74a5ea43bd5c={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=2,h=.51,c=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:(t,e)=>t.unsharpMask(l*e.scaleX,h),selection:i.getSelection()});function d(){m.render()}let p=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("radius"),width:300,height:30,min:0,max:200,value:2,onChange:function(t){l=t,d()},curve:[[0,0],[.1,2],[.5,50],[1,200]]}),u=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-unsharp-mask-strength"),width:300,height:30,min:0,max:50,value:5.1,onChange:function(t){h=t/10,d()},curve:[[0,0],[.1,2],[.5,10],[1,50]]});p.getElement().style.marginBottom="10px",u.getElement().style.marginBottom="10px",r.append(p.getElement()),r.append(u.getElement());let g=[];for(let t=0;t<s.length;t++)g.push({image:t===n?c.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let m=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:g},selection:i.getSelection()});return d(),(0,$VM6dD.css)(m.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),r.append(m.getElement()),a.destroy=()=>{p.destroy(),u.destroy(),c.destroy(),m.destroy()},a.getInput=function(){return a.destroy(),{radius:l,strength:h}},a},apply(t){let e=t.layer.context,i=t.klHistory,s=t.input.radius,n=t.input.strength;return!!e&&null!==s&&null!==n&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.unsharpMask(s,n)},i)}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $125e47ad063697cb$export$6158ed2b22ebf4d9={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=i.getLayerIndex(e.canvas),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:t=>t.toAlpha("inverted-luminance"===h,d),selection:i.getSelection()}),h="inverted-luminance",c=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"inverted-luminance",label:$63d0b335c576c718$export$ce37e184d908d785("filter-to-alpha-inverted-lum")},{id:"luminance",label:$63d0b335c576c718$export$ce37e184d908d785("filter-to-alpha-lum")}],initId:h,onChange:function(t){h=t,m.render()}});r.append(c.getElement());let d={r:0,g:0,b:0,a:1},p=[null,{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1},{r:t.currentColorRgb.r,g:t.currentColorRgb.g,b:t.currentColorRgb.b,a:1},{r:t.secondaryColorRgb.r,g:t.secondaryColorRgb.g,b:t.secondaryColorRgb.b,a:1}],u=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({label:$63d0b335c576c718$export$ce37e184d908d785("filter-to-alpha-replace"),colorArr:p,initialIndex:1,onChange:function(t){d=t,m.render()},css:{margin:"10px 0"}});r.append(u.getElement());let g=[];for(let t=0;t<s.length;t++)g.push({image:t===n?l.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let m=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:g},selection:i.getSelection()});return m.render(),(0,$VM6dD.css)(m.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),r.append(m.getElement()),a.destroy=()=>{c.destroy(),u.destroy(),l.destroy(),m.destroy()},a.getInput=function(){return a.destroy(),{sourceId:h,selectedRgbaObj:d}},a},apply(t){let e=t.layer.context,i=t.klHistory,s=t.input.sourceId,n=t.input.selectedRgbaObj;return!!e&&!!s&&$31c92ae106360499$export$66c6ccb6bcae2c94(e,t.klCanvas.getSelection(),t=>{t.toAlpha("inverted-luminance"===s,n)},i)}};var $2Eggz=parcelRequire("2Eggz");function $074907f5bc61bd8c$export$20d2db9c68afeac(t,e,i,s,n,r){t.save();let a=t.canvas.width,o=t.canvas.height,l=(s=Math.round(s))%2==0;t.beginPath(),t.lineWidth=s,t.strokeStyle=n,t.globalAlpha=r;for(let i=0;i<e-1;i++){let s=a/e*(i+1);s=l?Math.round(s):Math.round(s+.5)-.5,t.moveTo(s,0),t.lineTo(s,o)}for(let e=0;e<i-1;e++){let s=o/i*(e+1);s=l?Math.round(s):Math.round(s+.5)-.5,t.moveTo(0,s),t.lineTo(a,s)}t.stroke(),t.restore()}var $VM6dD=parcelRequire("VM6dD");let $3e2f8fc3797db2c6$export$50020de79e1bc23={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=(0,$VM6dD.throwIfNull)(i.getLayerIndex(e.canvas)),r=$2Eggz.BB.el(),a={element:r},o=$8522c24dbe0f81fc$export$8f6817a932bf45cd();o||(a.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o));let l={x:2,y:2,thickness:8,color:"#000",opacity:1},h=$2Eggz.BB.el({parent:r,css:{display:"flex",alignItems:"center"}}),c=$2Eggz.BB.el({parent:r,css:{display:"flex",alignItems:"center",marginTop:"10px",marginBottom:"10px"}}),d=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(t){l.x=parseFloat(t),B()}}),p=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(t){l.y=parseFloat(t),B()}}),u=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l.thickness,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(t){l.thickness=parseFloat(t),B()}}),g={r:0,g:0,b:0,a:1},m=[{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];m.push({r:t.currentColorRgb.r,g:t.currentColorRgb.g,b:t.currentColorRgb.b,a:1}),m.push({r:t.secondaryColorRgb.r,g:t.secondaryColorRgb.g,b:t.secondaryColorRgb.b,a:1}),l.color=$2Eggz.BB.ColorConverter.toRgbStr(g);let f=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({label:$63d0b335c576c718$export$ce37e184d908d785("shape-stroke"),colorArr:m,onChange:function(t){g=t,l.color=$2Eggz.BB.ColorConverter.toRgbStr(g),B()}}),y={display:"inline-block",marginRight:"5px"};h.append($2Eggz.BB.el({content:"X:",css:y}),d,$2Eggz.BB.el({content:"Y:",css:y}),p),c.append($2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("shape-line-width")+":",css:y}),u,$2Eggz.BB.el({css:{flexGrow:"1"}}),f.getElement());let v=$2Eggz.BB.canvas(e.canvas.width,e.canvas.height),x=$2Eggz.BB.ctx(v),b=s.map((t,e)=>({image:e===n?v:t.context.canvas,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,hasClipping:!1})),w=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(o),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(o),project:{width:e.canvas.width,height:e.canvas.height,layers:b}});function B(){let t=x;t.save(),t.clearRect(0,0,v.width,v.height),t.drawImage(e.canvas,0,0),$074907f5bc61bd8c$export$20d2db9c68afeac(t,l.x,l.y,Math.max(l.thickness,1),l.color,l.opacity),t.restore(),w.render()}return(0,$VM6dD.css)(w.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),r.append(w.getElement()),B(),w.render(),a.destroy=()=>{w.destroy(),$2Eggz.BB.freeCanvas(v),f.destroy()},a.getInput=function(){return a.destroy(),$2Eggz.BB.copyObj(l)},a},apply(t){let e=t.layer.context,i=t.klCanvas,s=t.klHistory;if(!e||!i)return!1;$074907f5bc61bd8c$export$20d2db9c68afeac(e,t.input.x,t.input.y,t.input.thickness,t.input.color,t.input.opacity);{let e=Object.fromEntries(t.klCanvas.getLayers().map(e=>e.id===t.layer.id?[e.id,{tiles:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.layer.canvas)}]:[e.id,{}]));s.push({layerMap:e})}return!0}};var $2Eggz=parcelRequire("2Eggz"),$5EmwV=parcelRequire("5EmwV"),$VM6dD=parcelRequire("VM6dD"),$ao0qX=parcelRequire("ao0qX"),$8cWis=parcelRequire("8cWis");let $f4f1194f773d88e8$var$presetArr=[{type:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0,octaves:1,samples:1,peaks:0,brightness:0,contrast:0,isReversed:!0},{type:1,scaleX:166,scaleY:164,offsetX:105,offsetY:30,octaves:6,samples:1,peaks:0,brightness:.055,contrast:.23,isReversed:!0},{type:1,scaleX:235,scaleY:190,offsetX:3227,offsetY:2156,octaves:4,samples:16,peaks:22,brightness:-.375,contrast:1,isReversed:!1},{type:1,scaleX:40,scaleY:40,offsetX:0,offsetY:0,octaves:1,samples:1,peaks:0,brightness:0,contrast:0,isReversed:!1},{type:0,scaleX:26,scaleY:26,offsetX:557,offsetY:365,octaves:1,samples:1,peaks:0,brightness:.02,contrast:1,isReversed:!0},{type:1,scaleX:1500,scaleY:1500,offsetX:745,offsetY:2871,octaves:5,samples:16,peaks:156.02,brightness:.03,contrast:1,isReversed:!0},{type:1,scaleX:11,scaleY:11,offsetX:2940,offsetY:2045,octaves:1,samples:16,peaks:1,brightness:-.045,contrast:1,isReversed:!0},{type:2,scaleX:74,scaleY:74,offsetX:4816,offsetY:1304,octaves:3,samples:1,peaks:2.78,brightness:0,contrast:0,isReversed:!1}];function $f4f1194f773d88e8$var$createNoiseSettings(t){let e=$2Eggz.BB.copyObj($f4f1194f773d88e8$var$presetArr[t.presetIndex]);return e.seed=t.seed,e.scaleX=e.scaleX*t.scale/50,e.scaleY=e.scaleY*t.scale/50,e.colA=t.colA,e.colB=t.colB,e.isReversed=t.isReversed?!e.isReversed:e.isReversed,e.channels=t.channels,e}function $f4f1194f773d88e8$var$createNoiseParameters(t){return[t.seed,t.type,[t.scaleX,t.scaleY],[t.offsetX,t.offsetY],t.octaves,t.samples,t.peaks,t.brightness,t.contrast,t.isReversed,t.colA,t.colB,t.channels?t.channels:"rgb"]}let $f4f1194f773d88e8$export$1dab0536099042f5={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=(0,$VM6dD.throwIfNull)(i.getLayerIndex(e.canvas)),r=[],a=32;{let t=(0,$VM6dD.throwIfNull)($5caaf17bca0749c7$export$8c4423af32b21158()),e=$2Eggz.BB.canvas(a,a),i=$2Eggz.BB.ctx(e),s=t.texture(e);t.draw(s).update(),s.destroy(),$f4f1194f773d88e8$var$presetArr.forEach(s=>{let n=new Image,a=$2Eggz.BB.copyObj(s);a.scaleX/=10,a.scaleY/=10,t.noise(...$f4f1194f773d88e8$var$createNoiseParameters(a)).update(),i.drawImage(t,0,0),n.src=e.toDataURL("image/png"),r.push(n)}),s.destroy()}let o=$2Eggz.BB.el(),l={element:o},h=$8522c24dbe0f81fc$export$8f6817a932bf45cd();h||(l.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(h));let c={seed:300*Math.random(),presetIndex:0,scale:50,opacity:.5,isReversed:!1,channels:"rgb",mixModeStr:"source-over",colA:{r:0,g:0,b:0},colB:{r:255,g:255,b:255}},d=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:r.map((t,e)=>((0,$VM6dD.css)(t,{margin:"1px",borderRadius:"3px",transition:"all 0.1s ease-in-out"}),{id:""+e,label:t})),initId:"0",onChange:t=>{c.presetIndex=Number(t),k()},css:{marginBottom:"10px"}});o.append(d.getElement());let p=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-noise-scale"),width:300,height:30,min:1,max:1e3,value:c.scale,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,curve:$2Eggz.BB.powerSplineInput(1,1e3,.1),onChange:t=>{c.scale=t,k()}});p.getElement().style.marginBottom="10px";let u=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("opacity"),width:300,height:30,min:.01,max:1,value:c.opacity,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,toValue:t=>t/100,toDisplayValue:t=>100*t,onChange:t=>{c.opacity=t,k()}});u.getElement().style.marginBottom="10px";let g=$2Eggz.BB.el({css:{display:"flex",alignItems:"center",marginBottom:"10px"}}),m=$2Eggz.BB.el({css:{display:"flex",marginBottom:"10px"}}),f=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"rgb",label:"RGB"},{id:"alpha",label:$63d0b335c576c718$export$ce37e184d908d785("filter-noise-alpha")}],initId:"rgb",onChange:t=>{c.channels=t,"rgb"===t?m.style.visibility="":m.style.visibility="hidden",k()}}),y=new $213947897b67ec3a$export$48513f6b9f8ce62d({label:$63d0b335c576c718$export$ce37e184d908d785("reverse"),callback:t=>{c.isReversed=t,k()},allowTab:!0,name:"reverse-gradient"}),v=new $b1ef42bd443626ca$export$ef9b1a59e592288f({isFocusable:!0,optionArr:["source-over",void 0,"darken","multiply","color-burn",void 0,"lighten","screen","color-dodge",void 0,"overlay","soft-light","hard-light",void 0,"difference","exclusion",void 0,"hue","saturation","color","luminosity"].map(t=>t?[t,$326f2f7e3662b29f$export$6e1bedb2a6cdff30(t)]:void 0),initValue:c.mixModeStr,onChange:t=>{c.mixModeStr=t,k()},name:"blend-mode"});v.getElement().title=$63d0b335c576c718$export$ce37e184d908d785("layers-blending");let x=$2Eggz.BB.el({css:{display:"flex"}}),b={width:"34px",height:"34px",marginRight:"5px"},w=$49faab2330529a96$export$6e4a713ddcda1e5e.input({type:"color",init:"#"+$5EmwV.ColorConverter.toHexString(c.colA),callback:t=>{let e=$5EmwV.ColorConverter.hexToRGB(t);e&&(c.colA=e,k())},css:b}),B=$49faab2330529a96$export$6e4a713ddcda1e5e.input({type:"color",init:"#"+$5EmwV.ColorConverter.toHexString(c.colB),callback:t=>{let e=$5EmwV.ColorConverter.hexToRGB(t);e&&(c.colB=e,k())},css:b});x.append(w,B),g.append(f.getElement(),$2Eggz.BB.el({css:{flexGrow:"1"}}),y.getElement()),m.append(v.getElement(),$2Eggz.BB.el({css:{flexGrow:"1"}}),x),o.append(p.getElement(),u.getElement(),g,m);let S=new $7f838dbc615d3028$export$94ec999f33a691e3({original:e.canvas,onUpdate:(t,i)=>{let s=$f4f1194f773d88e8$var$createNoiseSettings(c);return s.scaleX*=i.scaleX,s.scaleY*=i.scaleY,s.offsetX=e.canvas.width/2*i.scaleX+i.x,s.offsetY=e.canvas.height/2*i.scaleY+i.y,t.noise(...$f4f1194f773d88e8$var$createNoiseParameters(s))},postMix:{opacity:c.opacity,operation:"alpha"===c.channels?"destination-out":c.mixModeStr},selection:i.getSelection(),isMaskingWithEmptyOriginal:!0}),C=[];for(let t=0;t<s.length;t++)C.push({image:t===n?S.render:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let E=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(h),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(h),project:{width:e.canvas.width,height:e.canvas.height,layers:C},selection:i.getSelection()});function k(){S.setPostMix({opacity:c.opacity,operation:"alpha"===c.channels?"destination-out":c.mixModeStr}),E.render()}return E.render(),(0,$VM6dD.css)(E.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),o.append(E.getElement()),l.destroy=()=>{d.destroy(),p.destroy(),u.destroy(),y.destroy(),f.destroy(),v.destroy(),E.destroy(),S.destroy()},l.getInput=function(){return l.destroy(),$2Eggz.BB.copyObj(c)},l},apply(t){let e,i=t.layer.context,s=t.klCanvas,n=t.klHistory;if(!i||!s)return!1;let r=$5caaf17bca0749c7$export$8c4423af32b21158();if(!r)return!1;let a=t.input,o=s.getSelection();if(o){let t=$2Eggz.BB.canvas(i.canvas.width,i.canvas.height),s=$2Eggz.BB.ctx(t);(0,$ao0qX.drawSelectionMask)(o,s),e=r.texture(t),$2Eggz.BB.freeCanvas(t)}r.initialize(i.canvas.width,i.canvas.height);{let t=$f4f1194f773d88e8$var$createNoiseSettings(a);t.offsetX=i.canvas.width/2,t.offsetY=i.canvas.height/2,r.noise(...$f4f1194f773d88e8$var$createNoiseParameters(t)).update()}return e&&(r.multiplyAlpha().mask(e).unmultiplyAlpha(),e.destroy()),r.update(),i.save(),i.globalAlpha=a.opacity,"alpha"===a.channels?i.globalCompositeOperation="destination-out":i.globalCompositeOperation=a.mixModeStr,i.drawImage(r,0,0),i.restore(),n.push($fc7b31422a41da93$export$263fa670dc037098(n.getComposed(),$a262f7e0a9f5e4af$export$7b1ba44282f9a519(i.canvas,o?(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(o)):void 0))),!0}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $0fd8ddcd0821b85a$var$drawPattern(t,e){let i=e.blend?Math.round(e.blend*e.width/2):0,s=e.blend?Math.round(e.blend*e.height/2):0,n=$2Eggz.BB.canvas(e.width,e.height);if(e.blend){let r=$2Eggz.BB.canvas(2*e.width,2*e.height),a=$2Eggz.BB.ctx(r),o="#0000",l="#000";a.drawImage(t.canvas,-e.x+i,-e.y+s),a.save();let h=a.createLinearGradient(0,e.height,0,2*e.height);h.addColorStop(0,l),h.addColorStop(e.blend,o),a.globalCompositeOperation="destination-in",a.fillStyle=h,a.fillRect(0,0,r.width,r.height),a.restore(),a.save(),(h=a.createLinearGradient(0,0,0,e.height)).addColorStop(0,o),h.addColorStop(e.blend,l),a.globalCompositeOperation="destination-in",a.fillStyle=h,a.fillRect(0,0,2*e.width,2*e.height),a.restore(),a.save(),a.globalCompositeOperation="lighter",a.drawImage(r,0,-e.height),a.restore(),a.save(),(h=a.createLinearGradient(e.width,0,2*e.width,0)).addColorStop(0,l),h.addColorStop(e.blend,o),a.globalCompositeOperation="destination-in",a.fillStyle=h,a.fillRect(0,0,r.width,r.height),a.restore(),a.save(),(h=a.createLinearGradient(0,0,e.width,0)).addColorStop(0,o),h.addColorStop(e.blend,l),a.globalCompositeOperation="destination-in",a.fillStyle=h,a.fillRect(0,0,2*e.width,2*e.height),a.restore(),a.save(),a.globalCompositeOperation="lighter",a.drawImage(r,-e.width,0),a.restore(),$2Eggz.BB.ctx(n).drawImage(r,0,0)}else $2Eggz.BB.ctx(n).drawImage(t.canvas,-e.x,-e.y);t.save(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.translate(e.offsetX-i,e.offsetY-s),t.fillStyle=(0,$VM6dD.throwIfNull)(t.createPattern(n,"repeat")),t.fillRect(-e.offsetX+i,-e.offsetY+s,t.canvas.width,t.canvas.height),t.restore()}let $0fd8ddcd0821b85a$export$5b48b77a483d9b33={getDialog(t){let e,i=$8522c24dbe0f81fc$export$8f6817a932bf45cd(),s=1024,n=$2Eggz.BB.el(),r=t.context,a=r.canvas.width,o=r.canvas.height,l={x:0,y:0,width:a<=250?Math.round(a/4):200,height:o<=250?Math.round(o/4):200,blend:0,offsetX:0,offsetY:0},h=$2Eggz.BB.canvasBounds(r);h&&h.width<=s&&h.height<=s&&(h.width<.75*a||h.height<.75*o)?(l.x=h.x,l.y=h.y,l.width=h.width,l.height=h.height):(l.x=Math.round(a/2-l.width/2),l.y=Math.round(o/2-l.height/2));let c=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l.x,type:"number",min:0,max:a,css:{width:"100%"},callback:function(t){l.x=Number(t),V()}}),d=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l.y,type:"number",min:0,max:o,css:{width:"100%"},callback:function(t){l.y=Number(t),V()}}),p=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l.width,type:"number",min:1,max:Math.min(s,a),css:{width:"100%"},callback:function(t){l.width=Number(t),V()}}),u=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:l.height,type:"number",min:1,max:Math.min(s,o),css:{width:"100%"},callback:function(t){l.height=Number(t),V()}}),g={marginLeft:"5px",flex:"1"};n.append($2Eggz.BB.el({content:[$2Eggz.BB.el({tagName:"label",content:["X:",c],css:g}),$2Eggz.BB.el({tagName:"label",content:["Y:",d],css:g}),$2Eggz.BB.el({tagName:"label",content:[$63d0b335c576c718$export$ce37e184d908d785("width")+":",p],css:g}),$2Eggz.BB.el({tagName:"label",content:[$63d0b335c576c718$export$ce37e184d908d785("height")+":",u],css:g})],css:{display:"flex",marginLeft:"-5px"}}));let m=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("brush-blending"),width:300,height:30,min:0,max:1,value:l.blend,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){l.blend=t,V()},formatFunc:t=>$2Eggz.BB.round(t,2),manualInputRoundDigits:2});(0,$VM6dD.css)(m.getElement(),{margin:"10px 0"}),n.append(m.getElement());let f=1,y=new $db258f044f5ffd5c$export$b1241e74876d9bbe({left:$63d0b335c576c718$export$ce37e184d908d785("compare-before"),right:$63d0b335c576c718$export$ce37e184d908d785("compare-after"),init:f,onChange:t=>{f=t,P.style.display=0===t?"block":"none",V(!0)}});n.append(y.getElement());let v=t.klCanvas,x=v.getLayers(),b=(0,$VM6dD.throwIfNull)(v.getLayerIndex(r.canvas)),w=$2Eggz.BB.fitInto(r.canvas.width,r.canvas.height,i?280:490,i?200:240,1),B=parseInt(""+w.width),S=parseInt(""+w.height),C=Math.min(B,r.canvas.width),E=Math.min(S,r.canvas.height),k=B/r.canvas.width,I=$2Eggz.BB.el({className:"kl-preview-wrapper",css:{width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(i)+"px",height:$3ec5d4ed5944260f$export$94cffdbcf128864a(i)+"px",marginTop:"0"}}),T={image:$2Eggz.BB.canvas(C,E),isVisible:x[b].isVisible,opacity:x[b].opacity,mixModeStr:x[b].mixModeStr},M=new $1ac505c1a3109a32$export$e258ade1648009b7({width:Math.round(B),height:Math.round(S),layers:x.map((t,e)=>e===b?T:{image:t.context.canvas,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr})}),P=$2Eggz.BB.canvas(B,S);(0,$VM6dD.css)(P,{position:"absolute",left:"0",top:"0",mixBlendMode:"difference",imageRendering:"pixelated"});let L=$2Eggz.BB.el({className:"kl-preview-wrapper__canvas",css:{width:parseInt(""+B)+"px",height:parseInt(""+S)+"px"}});L.append(M.getElement(),P),I.append(L),n.append(I);let R={};function A(){c.value=""+l.x,d.value=""+l.y,p.value=""+l.width,u.value=""+l.height}let D=new $2Eggz.BB.KeyListener({});I.oncontextmenu=function(){return!1},L.style.touchAction="none";let z=new $2Eggz.BB.PointerListener({target:L,onPointer:t=>{if(0===f)if("pointerdown"===t.type){if(!R.state){R.oldSettings=$2Eggz.BB.copyObj(l);let e=t.relX/k,i=t.relY/k;$2Eggz.BB.isInsideRect({x:e,y:i},{x:l.x,y:l.y,width:l.width,height:l.height})?R.state="move":R.state="select",R.start={x:e,y:i}}}else if("pointermove"===t.type){let e=t.relX/k,i=t.relY/k;if("select"===R.state){R.end={x:e,y:i};let t=Math.max(0,Math.min(R.start.x,R.end.x)),n=Math.max(0,Math.min(R.start.y,R.end.y)),r=Math.min(a,Math.max(R.start.x,R.end.x)),h=Math.min(o,Math.max(R.start.y,R.end.y));l.x=Math.floor(t),l.y=Math.floor(n),l.width=Math.min(s,Math.ceil(r-l.x)),l.height=Math.min(s,Math.ceil(h-l.y)),D.isPressed("shift")&&(l.width=Math.min(l.width,l.height),l.height=Math.min(l.width,l.height)),(0===l.width||0===l.height)&&(l=$2Eggz.BB.copyObj(R.oldSettings)),A(),V()}else if("move"===R.state){let t=Math.round(e-R.start.x),s=Math.round(i-R.start.y);l.x=$2Eggz.BB.clamp(R.oldSettings.x+t,0,a-l.width),l.y=$2Eggz.BB.clamp(R.oldSettings.y+s,0,o-l.height),A(),V()}}else"pointerup"===t.type&&R.state&&(R.state=null);else"pointerdown"===t.type?R.state||(R.state="move",R.oldSettings=$2Eggz.BB.copyObj(l),R.start={x:t.relX/k,y:t.relY/k},R.end=null):"pointermove"===t.type?R.state&&(R.end={x:t.relX/k,y:t.relY/k},l.offsetX=Math.round(R.end.x-R.start.x)+R.oldSettings.offsetX,l.offsetY=Math.round(R.end.y-R.start.y)+R.oldSettings.offsetY,V()):"pointerup"===t.type&&R.state&&(R.end||(l.offsetX=0,l.offsetY=0,V()),R.state=null)}}),_=$2Eggz.BB.canvas(a,o),O=$2Eggz.BB.ctx(_);function H(t,e,i,s,n){let r=Math.round(e+.5)-.5,a=Math.round(i+.5)-.5,o=Math.round(e+s-r),l=Math.round(i+n-a);t.strokeRect(r,a,o,l)}function V(t){if(t||!e||JSON.stringify(e)!==JSON.stringify(l)){if(0===f){O.clearRect(0,0,a,o),O.drawImage(r.canvas,0,0);let t=T.image,e=$2Eggz.BB.ctx(t);e.save(),e.clearRect(0,0,C,E),e.drawImage(_,0,0,C,E),e.restore();let i=l.width*k,s=l.height*k,n=$2Eggz.BB.ctx(P);n.save(),n.clearRect(0,0,B,S),n.strokeStyle="#fff",H(n,l.x*k,l.y*k,i,s),l.blend>.05&&(n.strokeStyle="#f0f",H(n,l.x*k-i/2*l.blend,l.y*k-s/2*l.blend,i*(1+l.blend),s*(1+l.blend))),n.restore()}else{O.clearRect(0,0,a,o),O.drawImage(r.canvas,0,0),$0fd8ddcd0821b85a$var$drawPattern(O,l);let t=T.image,e=$2Eggz.BB.ctx(t);e.clearRect(0,0,C,E),e.drawImage(_,0,0,C,E)}M.render(),e=$2Eggz.BB.copyObj(l)}}V();let F=()=>{m.destroy(),D.destroy(),z.destroy(),M.destroy()},U={element:n,destroy:F,getInput:()=>(F(),$2Eggz.BB.copyObj(l))};return i||(U.width=$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.width),U},apply(t){let e=t.klCanvas,i=t.layer.context,s=t.klHistory;if(!e)return!1;$0fd8ddcd0821b85a$var$drawPattern(i,t.input);{let e=Object.fromEntries(t.klCanvas.getLayers().map(e=>e.id===t.layer.id?[e.id,{tiles:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.layer.canvas)}]:[e.id,{}]));s.push({layerMap:e})}return!0}};var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");let $9fcfd66886ad70ef$export$77c344cc65ad0ed2={getDialog(t){let e=$8522c24dbe0f81fc$export$8f6817a932bf45cd(),i=$2Eggz.BB.el(),s=t.context,n=!0,r={stepSize:1,distortType:0,scale:{x:100,y:100},strength:{x:20,y:20},phase:{x:0,y:0},offset:{x:0,y:0}},a=[],o=32;{let t=$2Eggz.BB.canvas(o,o),e=$2Eggz.BB.ctx(t);e.beginPath(),e.arc(o/2,o/2,o/2.5,0,2*Math.PI),e.fill();let i=e.createLinearGradient(0,0,o,o);i.addColorStop(0,"#00f"),i.addColorStop(.5,"#f00"),i.addColorStop(1,"#fff"),e.fillStyle=i,e.globalCompositeOperation="source-atop",e.fillRect(0,0,o,o),(i=e.createLinearGradient(o,0,0,o)).addColorStop(0,"#000"),i.addColorStop(1,"#000"),e.fillStyle=i,e.globalCompositeOperation="destination-atop",e.fillRect(0,0,o,o);let s=(0,$VM6dD.throwIfNull)($5caaf17bca0749c7$export$8c4423af32b21158()),n=s.texture(t);s.draw(n).update();let l=20;[0,1,2].forEach(i=>{let h=new Image,c=$2Eggz.BB.copyObj(r);c.distortType=i,c.scale.x/=l,c.scale.y/=l,c.strength.x/=l,c.strength.y/=l,s.draw(n).multiplyAlpha().distort(c).unmultiplyAlpha().update(),e.clearRect(0,0,o,o),e.drawImage(s,0,0),h.src=t.toDataURL("image/png"),a.push(h)}),n.destroy()}let l=$2Eggz.BB.el({parent:i,css:{display:"flex",alignItems:"center"}}),h=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:a.map((t,e)=>((0,$VM6dD.css)(t,{margin:"1px",borderRadius:"3px",transition:"all 0.1s ease-in-out"}),{id:""+e,label:t})),initId:"0",onChange:t=>{r.distortType=Number(t),S.render()}});function c(t){"x"===t?(r.scale.y=r.scale.x,r.strength.y=r.strength.x,r.phase.y=r.phase.x,f[3].setValue(r.scale.y),f[4].setValue(r.strength.y),f[5].setValue(r.phase.y)):(r.scale.x=r.scale.y,r.strength.x=r.strength.y,r.phase.x=r.phase.y,f[0].setValue(r.scale.x),f[1].setValue(r.strength.x),f[2].setValue(r.phase.x)),S.render()}let d=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-distort-sync-xy"),callback:t=>{(n=t)&&c("x")},name:"sync-xy"});l.append(h.getElement(),$2Eggz.BB.el({css:{flexGrow:"1"}}),d.getElement());let p=$2Eggz.BB.el({parent:i,css:{display:"flex",flexWrap:"wrap"}}),u=$2Eggz.BB.el({parent:p,css:{marginRight:"10px"}}),g=$2Eggz.BB.el({parent:p}),m=e?300:245,f=[];["x","y"].forEach((t,e)=>{let i=0===e?u:g,s=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-noise-scale")+" "+t.toUpperCase(),width:m,height:30,min:1,max:1e3,curve:"quadratic",value:r.scale[t],eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:e=>{r.scale[t]=e,n?c(t):S.render()}});s.getElement().style.marginTop="20px",i.append(s.getElement());let a=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-unsharp-mask-strength")+" "+t.toUpperCase(),width:m,height:30,min:0,max:200,curve:"quadratic",value:r.strength[t],eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:e=>{r.strength[t]=e,n?c(t):S.render()}});a.getElement().style.marginTop="10px",i.append(a.getElement());let o=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-distort-phase")+" "+t.toUpperCase(),width:m,height:30,min:0,max:1,value:r.phase[t],manualInputRoundDigits:2,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,formatFunc:t=>$2Eggz.BB.round(t,2),onChange:e=>{r.phase[t]=e,n?c(t):S.render()}});o.getElement().style.marginTop="10px",i.append(o.getElement()),f.push(s),f.push(a),f.push(o)});let y=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-distort-stepsize"),width:300,height:30,min:1,max:300,curve:"quadratic",value:r.stepSize,eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:t=>{r.stepSize=Math.round(t),S.render()}});y.getElement().style.marginTop="20px",y.getElement().style.marginBottom="10px",i.append(y.getElement());let v=t.klCanvas,x=v.getLayers(),b=(0,$VM6dD.throwIfNull)(v.getLayerIndex(s.canvas)),w=new $7f838dbc615d3028$export$94ec999f33a691e3({original:s.canvas,onUpdate:(t,e)=>{let i=$2Eggz.BB.copyObj(r);return i.stepSize*=e.scaleX,i.strength.x*=e.scaleX,i.strength.y*=e.scaleY,2!==i.distortType&&(i.scale.x*=e.scaleX,i.scale.y*=e.scaleY),i.offset.x=-e.x,i.offset.y=-e.y,t.multiplyAlpha().distort(i).unmultiplyAlpha()},selection:v.getSelection()}),B=x.map((t,e)=>({image:e===b?w.render:t.context.canvas,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,hasClipping:!1})),S=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(e),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(e),project:{width:s.canvas.width,height:s.canvas.height,layers:B},selection:v.getSelection()});S.render(),(0,$VM6dD.css)(S.getElement(),{marginLeft:"-20px",marginRight:"-20px"}),i.append(S.getElement());let C=()=>{h.destroy(),f.forEach(t=>t.destroy()),y.destroy(),d.destroy(),w.destroy(),S.destroy()},E={element:i,destroy:C,getInput:()=>(C(),$2Eggz.BB.copyObj(r))};return e||(E.width=$3ec5d4ed5944260f$export$3a4a74a7d8c44e62.width),E},apply(t){let e=t.klCanvas,i=t.layer.context,s=t.klHistory;return!!e&&$31c92ae106360499$export$66c6ccb6bcae2c94(i,t.klCanvas.getSelection(),e=>{e.multiplyAlpha().distort(t.input).unmultiplyAlpha()},s)}};var $2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");function $9ccc4f1680c2a511$export$8f57d6bdbceb36d0(t,e,i,s,n,r,a){t.save();let o=180/s;for(let s=0;s<180;s+=o){let o=$2Eggz.BB.rotateAround({x:e,y:i},{x:e+9999,y:i},s);$583d130d11db85ad$export$71b514a25c47df50(t,{type:"line",x1:e,y1:i,x2:o.x,y2:o.y,isOutwards:!0,opacity:a,strokeRgb:r,lineWidth:n})}t.restore()}var $VM6dD=parcelRequire("VM6dD");let $f20653d322f43e28$export$a77e8ecd2a7fa9a5={getDialog(t){let e=t.context,i=t.klCanvas;if(!e||!i)return!1;let s=i.getLayers(),n=(0,$VM6dD.throwIfNull)(i.getLayerIndex(e.canvas)),r=$2Eggz.BB.canvas(e.canvas.width,e.canvas.height),a=$2Eggz.BB.ctx(r),o=$2Eggz.BB.el(),l={element:o},h=$8522c24dbe0f81fc$export$8f6817a932bf45cd();h||(l.width=$3ec5d4ed5944260f$export$8b9199c1f5e4be8(h));let c={x:e.canvas.width/2,y:e.canvas.height/2,lines:8,thickness:2,color:{r:0,g:0,b:0},opacity:1},d=new $cd73d123a4560ac3$export$a1855b925e534de7({label:$63d0b335c576c718$export$ce37e184d908d785("filter-vanish-point-lines"),width:300,height:30,min:2,max:20,value:c.lines,curve:"quadratic",eventResMs:$21a9e2eeab18749b$export$f02de051ab70b20e,onChange:function(t){c.lines=Math.round(t),B()}});d.getElement().style.marginBottom="10px",o.append(d.getElement());let p=$2Eggz.BB.el({parent:o,css:{display:"flex",alignItems:"center"}}),u=$2Eggz.BB.el({parent:o,css:{display:"flex",alignItems:"center",marginTop:"10px",marginBottom:"10px"}}),g=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:c.x,type:"number",css:{width:"75px",marginRight:"20px"},callback:function(t){c.x=parseFloat(t),k.setValue({x:c.x,y:c.y}),B()}}),m=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:c.y,type:"number",css:{width:"75px",marginRight:"20px"},callback:function(t){c.y=parseFloat(t),k.setValue({x:c.x,y:c.y}),B()}}),f=$760dd90d44275661$export$b7e3ae3d7c15e42e({init:2,type:"number",min:1,css:{width:"75px",marginRight:"20px"},callback:function(t){c.thickness=parseFloat(t),B()}}),y={r:0,g:0,b:0,a:1},v=[{r:0,g:0,b:0,a:1},{r:255,g:255,b:255,a:1}];v.push({r:t.currentColorRgb.r,g:t.currentColorRgb.g,b:t.currentColorRgb.b,a:1}),v.push({r:t.secondaryColorRgb.r,g:t.secondaryColorRgb.g,b:t.secondaryColorRgb.b,a:1}),c.color=$2Eggz.BB.copyObj(y);let x=new $3032e23fa8f3a9e5$export$24ba9b81662d4366({label:$63d0b335c576c718$export$ce37e184d908d785("shape-stroke"),colorArr:v,onChange:function(t){y=t,c.color=$2Eggz.BB.copyObj(y),B()}}),b={display:"inline-block",marginRight:"5px"};function w(){g.value=""+c.x,m.value=""+c.y}function B(){let t=a,i=r.width,s=r.height;t.save(),t.clearRect(0,0,i,s),t.drawImage(e.canvas,0,0,i,s),$9ccc4f1680c2a511$export$8f57d6bdbceb36d0(t,c.x,c.y,c.lines,Math.max(c.thickness,1),c.color,c.opacity),t.restore(),E.render()}p.append($2Eggz.BB.el({content:"X:",css:b}),g,$2Eggz.BB.el({content:"Y:",css:b}),m),u.append($2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("shape-line-width")+":",css:b}),f,$2Eggz.BB.el({css:{flexGrow:"1"}}),x.getElement());let S=()=>(k.setTransform(E.getTransform()),r),C=[];for(let t=0;t<s.length;t++)C.push({image:t===n?S:s[t].context.canvas,isVisible:s[t].isVisible,opacity:s[t].opacity,mixModeStr:s[t].mixModeStr,hasClipping:!1});let E=new $324add89932145ee$export$133773870222880f({width:$3ec5d4ed5944260f$export$8b9199c1f5e4be8(h),height:$3ec5d4ed5944260f$export$94cffdbcf128864a(h),project:{width:e.canvas.width,height:e.canvas.height,layers:C}});(0,$VM6dD.css)(E.getElement(),{marginLeft:"-20px",marginRight:"-20px",overflow:"hidden"});let k=new $d90200485e14eee7$export$87247fc399965417({value:{x:c.x,y:c.y},onChange:t=>{c.x=Math.round(t.x),c.y=Math.round(t.y),w(),B()}});return B(),E.getElement().append(k.getElement()),o.append(E.getElement()),l.destroy=()=>{d.destroy(),x.destroy(),E.destroy()},l.getInput=function(){return l.destroy(),$2Eggz.BB.copyObj(c)},l},apply(t){let e=t.layer.context,i=t.klCanvas,s=t.klHistory;if(!e||!i)return!1;$9ccc4f1680c2a511$export$8f57d6bdbceb36d0(e,t.input.x,t.input.y,t.input.lines,t.input.thickness,t.input.color,t.input.opacity);{let e=Object.fromEntries(t.klCanvas.getLayers().map(e=>e.id===t.layer.id?[e.id,{tiles:$a262f7e0a9f5e4af$export$7b1ba44282f9a519(t.layer.canvas)}]:[e.id,{}]));s.push({layerMap:e})}return!0}};function $a5bdfa66fb1ba8cd$var$importFilter(t,e){e.getDialog&&(t.getDialog=e.getDialog),t.apply=e.apply}function $a5bdfa66fb1ba8cd$export$4283b00eae4a6956(){$aa2ca71db1de8ae6$export$24724bc1f91cba3.isLoaded||($a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.brightnessContrast,$257cfc293f7e7cb2$export$af433fb90aa90a38),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.cropExtend,$979e97880c50429e$export$e5937df51b9e1d86),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.curves,$eafcde4f99931bb4$export$309483fcb6d5c7ca),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.flip,$ca7e2a3c6a0e8777$export$9b1b7b3985b9625a),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.hueSaturation,$345ea86e35fe44da$export$2aa46bd5587f0eb),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.invert,$19cea8caa4f1f54e$export$b7ebcfbdc840ef76),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.perspective,$68cd0c4958325f46$export$a76d798fa7d85e4e),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.resize,$7bec11dd1272a23d$export$5705240d31427a82),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.rotate,$4e52484ae64ee478$export$ac7e9efc751d5791),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.tiltShift,$5aa2347b5ccd9148$export$1b8796b18b7c19ed),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.transform,$31d0877b7a0bd896$export$dc15474d94cdc2b3),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.blur,$b3e717c77532e1e1$export$55e7eb2ebd0db869),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.unsharpMask,$a392dfa9711a1868$export$62ac74a5ea43bd5c),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.toAlpha,$125e47ad063697cb$export$6158ed2b22ebf4d9),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.grid,$3e2f8fc3797db2c6$export$50020de79e1bc23),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.noise,$f4f1194f773d88e8$export$1dab0536099042f5),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.pattern,$0fd8ddcd0821b85a$export$5b48b77a483d9b33),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.distort,$9fcfd66886ad70ef$export$77c344cc65ad0ed2),$a5bdfa66fb1ba8cd$var$importFilter($aa2ca71db1de8ae6$export$bac24f240bb7727d.vanishPoint,$f20653d322f43e28$export$a77e8ecd2a7fa9a5),$aa2ca71db1de8ae6$export$24724bc1f91cba3.isLoaded=!0)}async function $3ccac2760787e643$export$92433b641be3f7a(t){let e=t.getLayersFast(),i={width:t.getWidth(),height:t.getHeight(),children:e.map(t=>({name:t.name,hidden:!t.isVisible,opacity:t.opacity,canvas:t.canvas,blendMode:$49faab2330529a96$export$6e4a713ddcda1e5e.PSD.blendKlToPsd(t.mixModeStr),left:0,top:0}))};return new Blob([(await $e4b3248b4ce95ea5$export$ab3d838b1d336b38()).writePsdBuffer(i)],{type:"application/octet-stream"})}var $dGRuJ=parcelRequire("dGRuJ"),$2Eggz=parcelRequire("2Eggz");class $2d79f7f8e2e2d334$export$c57e2ed65bcf4d6a{chainIn(t){if(t=$2Eggz.BB.copyObj(t),clearTimeout(this.timeout),clearInterval(this.interval),"down"===t.type&&(this.lastMixedInput={x:t.x,y:t.y,pressure:t.pressure}),"move"===t.type){let e=t.x,i=t.y,s=t.pressure;t.x=$2Eggz.BB.mix(t.x,this.lastMixedInput.x,this.smoothing),t.y=$2Eggz.BB.mix(t.y,this.lastMixedInput.y,this.smoothing),t.pressure=$2Eggz.BB.mix(t.pressure,this.lastMixedInput.pressure,this.smoothing),this.lastMixedInput={x:t.x,y:t.y,pressure:t.pressure},this.smoothing>0&&(this.timeout=setTimeout(()=>{this.interval=setInterval(()=>{var n,r;(t=JSON.parse(JSON.stringify(t))).x=$2Eggz.BB.mix(e,this.lastMixedInput.x,this.smoothing),t.y=$2Eggz.BB.mix(i,this.lastMixedInput.y,this.smoothing),t.pressure=$2Eggz.BB.mix(s,this.lastMixedInput.pressure,this.smoothing),this.lastMixedInput={x:t.x,y:t.y,pressure:t.pressure},null==(n=(r=this).chainOut)||n.call(r,t)},35)},80))}return t}setChainOut(t){this.chainOut=t}setSmoothing(t){this.smoothing=$2Eggz.BB.clamp(t,0,1)}constructor(t){this.smoothing=$2Eggz.BB.clamp(t.smoothing,0,1)}}class $b47927ff4e129b10$export$91dcf4209534d21f{chainIn(t){return("down"===t.type&&(this.isDrawing?this.chainOut&&this.chainOut({type:"up",scale:t.scale,shiftIsPressed:t.shiftIsPressed,isCoalesced:!1}):this.isDrawing=!0),this.isDrawing||"move"!==t.type&&"up"!==t.type)?("up"===t.type&&this.isDrawing&&(this.isDrawing=!1),t):null}setChainOut(t){this.chainOut=t}getIsDrawing(){return this.isDrawing}constructor(){this.isDrawing=!1}}function $b2e5423e81cbdb22$export$bcd109042a2e4bb5(t){return 1==t?.5:2==t?.84:3==t?.965:4==t?.9825:5==t?.99125:t}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");function $2b81f395a2c93f97$var$isBufferMatch(t,e){return e.every((e,i)=>void 0===e||t[i]===e)}async function $2b81f395a2c93f97$export$16b40d0fc7becfe6(t){let e=t.name.split("."),i=e[e.length-1].toLowerCase();if(t.type.match("image/vnd.adobe.photoshop")||"psd"===i)return"psd";if(t.type.match("image.*"))return"image";try{let e=await new Promise((e,i)=>{let s=new FileReader;s.onload=()=>{null===s.result?i():e(new Uint8Array(s.result))},s.onerror=i,s.readAsArrayBuffer(t.slice(0,12))});if($2b81f395a2c93f97$var$isBufferMatch(e,[56,66,80,83]))return"psd";if($2b81f395a2c93f97$var$isBufferMatch(e,[137,80,78,71,13,10,26,10])||$2b81f395a2c93f97$var$isBufferMatch(e,[255,216])||$2b81f395a2c93f97$var$isBufferMatch(e,[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]))return"image"}catch(t){}}class $d4355fc62c3bbadf$export$1ec1306c0c05d48d{importFinishedLoading(t,e,i){if(!t||isNaN(t.width)||isNaN(t.height)||t.width<=0||t.height<=0)return void $49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("import-broken-file"),buttons:["Ok"]});let s=(t,e)=>{let i=parseInt(""+t),s=parseInt(""+e);return i>this.klMaxCanvasSize&&(s=this.klMaxCanvasSize/i*s,i=this.klMaxCanvasSize),s>this.klMaxCanvasSize&&(i=this.klMaxCanvasSize/s*i,s=this.klMaxCanvasSize),{width:i=parseInt(""+i),height:s=parseInt(""+s)}},n=t=>{this.applyUncommitted();let i=s(t.width,t.height),n=$2Eggz.BB.canvas(t.width,t.height);$2Eggz.BB.ctx(n).drawImage(t,0,0),$2Eggz.BB.resizeCanvas(n,i.width,i.height),this.klCanvas.reset({width:i.width,height:i.height,image:n,layerName:e}),this.layersUi.update(0),this.setCurrentLayer(this.klCanvas.getLayer(0)),this.onImportConfirm()},r=(t,e)=>{let i;this.applyUncommitted();let n=(t,e,i)=>{e.width=e.width,$2Eggz.BB.ctx(e).drawImage(t,-i.x,-i.y),t.width=i.width,t.height=i.height,$2Eggz.BB.ctx(t).drawImage(e,0,0)};if(e&&(e.width!==t.width||e.height!==t.height)){let i=$2Eggz.BB.canvas(e.width,e.height);if(t.width=e.width,t.height=e.height,t.layers||n(t.canvas,i,e),t.layers)for(let s=0;s<t.layers.length;s++)n(t.layers[s].image,i,e)}let r=s(t.width,t.height);if(t.width=r.width,t.height=r.height,t.layers||$2Eggz.BB.resizeCanvas(t.canvas,t.width,t.height),t.layers)for(let e=0;e<t.layers.length;e++){let i=t.layers[e];$2Eggz.BB.resizeCanvas(i.image,t.width,t.height)}i=t.layers?this.klCanvas.reset({width:t.width,height:t.height,layers:t.layers.map(t=>({id:$07b32ff703dd0314$export$b2ce7a8a096070e2(),name:t.name,isVisible:t.isVisible,opacity:t.opacity,mixModeStr:t.mixModeStr,image:t.image}))}):this.klCanvas.reset({width:t.width,height:t.height,image:t.canvas}),this.layersUi.update(i),this.setCurrentLayer(this.klCanvas.getLayer(i)),this.onImportConfirm()},a=t=>{this.applyUncommitted(),$49faab2330529a96$export$6e4a713ddcda1e5e.showImportAsLayerDialog({target:this.klRootEl,klCanvas:this.klCanvas,importImage:t,callback:(i,s)=>{if(!i)return;let n=e=>{$2Eggz.BB.drawTransformedImageWithBounds(e,t,i,void 0,s)};this.klCanvas.addLayer(void 0,{name:e,isVisible:!0,opacity:1,image:n})||this.klCanvas.drawOperation(this.klCanvas.getLayers().length-1,n);let r=this.klCanvas.getLayers().length-1;this.setCurrentLayer(this.klCanvas.getLayer(r)),this.layersUi.update(r)}})};"default"!==i&&i||$49faab2330529a96$export$6e4a713ddcda1e5e.showImportImageDialog({image:t,target:this.klRootEl,maxSize:this.klMaxCanvasSize,callback:t=>{"as-image"===t.type?n(t.image):"as-image-psd"===t.type?r(t.image,t.cropObj):"as-layer"===t.type?a(t.image):t.type}}),"layer"===i&&a(t.canvas),"image"===i&&("psd"===t.type?r(t):n(t.canvas))}async readClipboard(){try{let t=await navigator.clipboard.read(),e=!1;for(let i of t)for(let t of i.types)if(t.startsWith("image")){e=!0;let s=await i.getType(t),n=new Image;n.onload=()=>{URL.revokeObjectURL(n.src),this.importFinishedLoading({type:"image",width:n.width,height:n.height,canvas:n},void 0,"default")},n.src=URL.createObjectURL(s);return}e||$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("clipboard-no-image"),buttons:["Ok"]})}catch(t){$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("clipboard-read-fail"),buttons:["Ok"]})}}onPaste(t){if($49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0)return;let e=(t,e)=>{if(t)for(let i=0;i<t.length;i++){if(-1==t[i].type.indexOf("image"))continue;let s=t[i].getAsFile();s&&e(s)}};t.stopPropagation(),t.preventDefault(),t.clipboardData&&(t.clipboardData.files[0]?e(t.clipboardData.items,t=>{let e=new Image;e.onload=()=>{URL.revokeObjectURL(e.src),this.importFinishedLoading({type:"image",width:e.width,height:e.height,canvas:e},void 0,"default")},e.src=(window.URL||window.webkitURL).createObjectURL(t)}):t.clipboardData.items[0]&&t.clipboardData.items[0].getAsString(t=>{if((t=t.trim()).match(/^https?/)){let e=new Image;e.onload=()=>{this.importFinishedLoading({type:"image",width:e.width,height:e.height,canvas:e},void 0,"default")},e.onerror=t=>{console.log("error loading",t)},e.crossOrigin="Anonymous",e.src=t}else if(t.match(/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)){let e=$2Eggz.BB.ColorConverter.hexToRGB(t.replace("#",""));e&&this.onColor(e)}}))}async handleFileSelect(t,e){let i=()=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"warning",message:$63d0b335c576c718$export$ce37e184d908d785("import-psd-unsupported")+"<br /><br />",buttons:["Ok"]})},s=!1,n=[...t];for(let t=0;t<n.length;t++){let r=n[t],a=await $2b81f395a2c93f97$export$16b40d0fc7becfe6(r);"image"===a?(t=>{window.URL=window.URL||window.webkitURL;let i=window.URL.createObjectURL(t),s=new Image;s.src=i,$2Eggz.BB.loadImage(s,()=>{URL.revokeObjectURL(i),this.importFinishedLoading({type:"image",width:s.width,height:s.height,canvas:s},t.name,e)})})(r):"psd"===a?(t=>{let s,r=0x1900000,a=0x40000000,o=4096;if(t.size>=a)return $49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:"File too big. Unable to import.<br /><br />",buttons:["Ok"]});let l=1===n.length&&t.size>=r,h=!0;l&&$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:$63d0b335c576c718$export$ce37e184d908d785("import-opening"),callback:t=>{h=!1,s=null},closeFunc:t=>{s=t}});let c=new FileReader;c.onload=n=>{let r=(0,$VM6dD.throwIfNull)(n.target);$49faab2330529a96$export$6e4a713ddcda1e5e.loadAgPsd().then(n=>{if(!l||h)try{let a;if((a=n.readPsd(r.result,{skipLayerImageData:!0,skipThumbnail:!0,skipCompositeImageData:!0})).width>o||a.height>o){s&&s(),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:$63d0b335c576c718$export$ce37e184d908d785("import-psd-too-large").replace(/{x}/g,""+o)+"<br /><br />"+$63d0b335c576c718$export$ce37e184d908d785("import-psd-size")+": "+a.width+" x "+a.height+" pixels<br /><br />",buttons:["Ok"]});return}a=null;try{a=n.readPsd(r.result)}catch(t){}if(a){let n=$49faab2330529a96$export$6e4a713ddcda1e5e.PSD.readPsd(a);"image"===e&&n.error&&i(),s&&s(),this.importFinishedLoading(n,t.name,e)}else a=n.readPsd(r.result,{skipLayerImageData:!0,skipThumbnail:!0}),"image"===e&&i(),s&&s(),this.importFinishedLoading({type:"psd",width:a.width,height:a.height,canvas:(0,$VM6dD.throwIfUndefined)(a.canvas),error:!0},t.name,e)}catch(t){null==s||s(),$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,type:"error",message:"Failed to load PSD.<br /><br />",buttons:["Ok"]}),console.log(t),setTimeout(()=>{throw Error("psd load error")})}}).catch(t=>{null==s||s(),alert("Error: failed to load PSD library")})},c.readAsArrayBuffer(t)})(r):s=!0}s&&$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.klRootEl,message:$63d0b335c576c718$export$ce37e184d908d785("import-unsupported-file"),type:"error",buttons:["OK"]})}constructor(t,e){this.klRootEl=t.klRootEl,this.klMaxCanvasSize=t.maxCanvasSize,this.layersUi=t.layersUi,this.setCurrentLayer=t.setCurrentLayer,this.klCanvas=t.klCanvas,this.onImportConfirm=t.onImportConfirm,this.applyUncommitted=t.applyUncommitted,this.onColor=e.onColor}}var $b1066d3ce24bdbb8$exports={};$b1066d3ce24bdbb8$exports=$parcel$resolve("gXLuy");var $4c22caf787ef90d3$exports={};$4c22caf787ef90d3$exports=$parcel$resolve("ll6eH");var $a4d127e6391465c0$exports={};$a4d127e6391465c0$exports=$parcel$resolve("elaiI");var $4byZX=parcelRequire("4byZX");function $1050fcf084a1ca84$export$982e7602957287fa(t){let e=["Draw via the console! Learn more: %cKL.help()","background: #000; color: #0f0;"];return"info"in console?console.info(...e):console.log(...e),Object.freeze({draw:e=>{t.onDraw(e)},recognizeShape:t=>{console.log("Shape recognition triggered with",t.length,"points");let e=$4byZX.ShapeRecognition.recognizeShapeFromPoints(t);return console.log(`Recognized shape: ${e||"unknown"}`),e},help:()=>{console.log(`KL.draw({x: number; y: number}[]) // draw a line
KL.recognizeShape({x: number; y: number}[]) // recognize shape from points
KL.help() // print help
`)}})}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$iwR8S=parcelRequire("iwR8S"),$2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz"),$VbzD9=parcelRequire("VbzD9");class $6f9f66a6815f0457$export$ae7d5b5c7fa00e77{chainIn(t){this.pointerEventChain.chainIn(t)}setDoubleTapPointerTypes(t){this.mainDoubleTapper.setAllowedPointerTypeArr(t)}destroy(){}constructor(t){let e=[];t.onUndo&&(this.twoFingerTap=new $2Eggz.BB.NFingerTapper({fingers:2,onTap:t.onUndo}),e.push(this.twoFingerTap)),t.onRedo&&(this.threeFingerTap=new $2Eggz.BB.NFingerTapper({fingers:3,onTap:t.onRedo}),e.push(this.threeFingerTap)),this.mainDoubleTapper=new $2Eggz.BB.DoubleTapper({onDoubleTap:t.onDoubleTap}),this.mainDoubleTapper.setAllowedPointerTypeArr(["touch"]),this.middleDoubleTapper=new $2Eggz.BB.DoubleTapper({onDoubleTap:t.onDoubleTap}),this.middleDoubleTapper.setAllowedButtonArr(["middle"]),this.pinchZoomer=new $2Eggz.BB.PinchZoomer({onPinch:t.onPinch}),this.pointerEventChain=new(0,$VbzD9.EventChain)({chainArr:[...e,this.mainDoubleTapper,this.middleDoubleTapper,this.pinchZoomer,new $2Eggz.BB.OnePointerLimiter]}),this.pointerEventChain.setChainOut(t.onChainOut)}}var $27fCv=parcelRequire("27fCv"),$8cWis=parcelRequire("8cWis");let $3757e4eb154d55dd$export$31ee023005d8c68f=["touch"],$3757e4eb154d55dd$export$4f41ddbc92f66d7d=["space","alt","r","z"],$3757e4eb154d55dd$export$c5299001bfb7de59=["mouse-middle","mouse-right",...$3757e4eb154d55dd$export$4f41ddbc92f66d7d],$3757e4eb154d55dd$export$5e2c057e240c0b8c=1/16,$3757e4eb154d55dd$export$ac82c07320907c00=128;function $9c9e0831687a01d5$export$296b597c2b22784a(t,e){let i=t.x!==e.x||t.y!==e.y,s=t.scale!==e.scale||t.angleDeg!==e.angleDeg;return!i&&!s}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz");function $1f3a5022d3c168fe$export$e5cb90f7d2eee96c(t,e,i,s,n){if($9c9e0831687a01d5$export$296b597c2b22784a(t,e)||(t.x===e.x||2>Math.abs(t.x-e.x))&&(t.y===e.y||2>Math.abs(t.y-e.y))&&(t.scale===e.scale||Math.abs(t.scale-e.scale)<.08*e.scale))return(0,$wpIFA._)({},e);if(t.angleDeg===e.angleDeg)return{x:$2Eggz.BB.mix(t.x,e.x,n),y:$2Eggz.BB.mix(t.y,e.y,n),angleDeg:e.angleDeg,scale:$2Eggz.BB.mix(t.scale,e.scale,n)};let r=$bfc75b1b92419309$export$935bc53f7df03c95(t,s),a=$bfc75b1b92419309$export$935bc53f7df03c95(e,s);if(1>$2Eggz.BB.Vec2.dist(r.canvasP,a.canvasP)){let i=r.angleDeg,o=a.angleDeg-r.angleDeg;o>180&&(i+=360),o<-180&&(i-=360);let l={viewportP:s,canvasP:a.canvasP,scale:$2Eggz.BB.mix(t.scale,e.scale,n),angleDeg:$2Eggz.BB.mix(i,e.angleDeg,n)};return $68a5ab3e745a3a87$export$99c68a89351e15c0(l.viewportP,l.canvasP,l.scale,l.angleDeg)}let o={x:i.width/2,y:i.height/2},l=$00bfc001d6438b5d$export$ad1d215dd03fe75a(t),h=$00bfc001d6438b5d$export$ad1d215dd03fe75a(e),c=$855520c81dfcb96a$export$9b20165a36586806(l,o),d=$855520c81dfcb96a$export$9b20165a36586806(h,o),p={x:$2Eggz.BB.mix(c.x,d.x,n),y:$2Eggz.BB.mix(c.y,d.y,n)},u=$2Eggz.BB.mix(t.scale,e.scale,n),g=$2Eggz.BB.mix(t.angleDeg,e.angleDeg,n),m=Math.PI/180*g,f=-o.x*u,y=-o.y*u,v=f*Math.cos(m)-y*Math.sin(m),x=f*Math.sin(m)+y*Math.cos(m),b={x:p.x+v,y:p.y+x};return{x:b.x,y:b.y,scale:u,angleDeg:g}}var $VM6dD=parcelRequire("VM6dD");function $ef524340be1400ac$var$getToolEntries(t){return Object.entries(t)}class $ef524340be1400ac$export$2732362bcaeb02c2{setTargetTransform(t,e){e&&this.viewport.setTransform(t),this.targetTransform=t,this.doRender=!0}updateToolSvgs(){var t;let e=null!=(t=this.tempToolId)?t:this.toolId;Object.keys(this.toolsMap).forEach(t=>{this.toolsMap[t].getSvgElement().style.display=t===e?"":"none"})}updateDoubleTapPointerTypes(){var t,e;let i=null!=(e=this.toolsMap[null!=(t=this.tempToolId)?t:this.toolId].doubleTapPointerTypes)?e:$3757e4eb154d55dd$export$31ee023005d8c68f;this.pointerPreprocessor.setDoubleTapPointerTypes(i)}renderLoop(){let t=performance.now(),e=t-this.lastFrameTimestamp;if(this.lastFrameTimestamp=t,this.animationFrameId=requestAnimationFrame(()=>this.renderLoop()),!this.doRender)return;let i=this.getActiveTool(),s=this.viewport.getTransform(),n=s;if($9c9e0831687a01d5$export$296b597c2b22784a(s,this.targetTransform))this.doRender=!1;else{let t=e/(1e3/60),i=1-.7**t;n=$1f3a5022d3c168fe$export$e5cb90f7d2eee96c(s,this.targetTransform,{width:this.project.width,height:this.project.height},{x:this.width/2,y:this.height/2},i),this.viewport.setTransform(n)}let r=n.x!==this.lastRenderedTransform.x||n.y!==this.lastRenderedTransform.y,a=n.scale!==this.lastRenderedTransform.scale||n.angleDeg!==this.lastRenderedTransform.angleDeg;if(this.viewport.render(!$9c9e0831687a01d5$export$296b597c2b22784a(s,n)),r||a){var o;null==(o=i.onUpdateTransform)||o.call(i,n),this.selectionRenderer.setTransform(n),this.onTransformChange(this.targetTransform,a),this.lastRenderedTransform=n}}pushTempTool(t){var e,i,s;if(void 0!==this.tempToolId||void 0===t)return;let n=this.toolsMap[this.toolId];if(null==(e=n.getIsLocked)?void 0:e.call(n))return;this.tempToolId=t;let r=this.getActiveToolId();null==(i=(s=this.toolsMap[r]).activate)||i.call(s,this.cursorPos),Object.values(this.toolsMap).forEach(t=>{var e;return null==(e=t.onTool)?void 0:e.call(t,r)}),this.updateToolSvgs(),this.updateDoubleTapPointerTypes()}popTempTool(t){var e,i;if(this.tempToolId!==t||void 0===t)return;this.tempToolId=void 0,null==(e=(i=this.getActiveTool()).activate)||e.call(i,this.cursorPos,!0);let s=this.getActiveToolId();Object.values(this.toolsMap).forEach(t=>{var e;return null==(e=t.onTool)?void 0:e.call(t,s)}),this.updateToolSvgs(),this.updateDoubleTapPointerTypes()}getActiveToolId(){var t;return null!=(t=this.tempToolId)?t:this.toolId}getActiveTool(){return this.toolsMap[this.getActiveToolId()]}getResetTransform(){return $68a5ab3e745a3a87$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},{x:this.project.width/2,y:this.project.height/2},1,0)}getFitTransform(){let t=this.viewport.getTransform().angleDeg;45===t&&(t=0),t=(0,$8cWis.snapAngleDeg)(t,90,90);let e=this.project.width,i=this.project.height,s=[[0,0],[e,0],[e,i],[0,i],[e/2,i/2]],n=$2Eggz.BB.Matrix.getIdentity();n=$2Eggz.BB.Matrix.multiplyMatrices(n,$2Eggz.BB.Matrix.createRotationMatrix(t/180*Math.PI));for(let t=0;t<s.length;t++){let e=[s[t][0],s[t][1],0,1];e=$2Eggz.BB.Matrix.multiplyMatrixAndPoint(n,e),s[t][0]=e[0],s[t][1]=e[1]}let r={};for(let t=0;t<s.length;t++)(void 0===r.x1||s[t][0]<r.x1)&&(r.x1=s[t][0]),(void 0===r.y1||s[t][1]<r.y1)&&(r.y1=s[t][1]),(void 0===r.x2||s[t][0]>r.x2)&&(r.x2=s[t][0]),(void 0===r.y2||s[t][1]>r.y2)&&(r.y2=s[t][1]);let a=r.x2-r.x1,o=r.y2-r.y1,l=0,{width:h}=$2Eggz.BB.fitInto(a,o,this.width-l,this.height-l,1),c=Math.min($3757e4eb154d55dd$export$ac82c07320907c00,h/a),d={width:this.width,height:this.height};return $68a5ab3e745a3a87$export$99c68a89351e15c0({x:d.width/2,y:d.height/2},{x:e/2,y:i/2},c,t)}setProject(t){var e,i;this.project=t,this.viewport.setProject({width:this.project.width,height:this.project.height,layers:this.project.layers}),this.selectionRenderer.setSelection(this.project.selection),null==(e=(i=this.getActiveTool()).onUpdateSelection)||e.call(i,this.project.selection),this.requestRender()}setSize(t,e){var i,s;let n=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.viewport.getTransform())),{x:this.width/2,y:this.height/2});this.width=t,this.height=e,$2Eggz.BB.setAttributes(this.svgEl,{width:""+this.width,height:""+this.height}),this.selectionRenderer.setSize(t,e),null==(i=(s=this.getActiveTool()).onResize)||i.call(s,t,e),this.viewport.setSize(t,e);let r=this.viewport.getTransform();this.setTargetTransform($68a5ab3e745a3a87$export$99c68a89351e15c0({x:this.width/2,y:this.height/2},n,r.scale,r.angleDeg),!0),this.requestRender()}requestRender(){this.doRender=!0}getTransform(){return this.viewport.getTransform()}setTransform(t){this.setTargetTransform(t,!0)}setTool(t){var e,i;t!==this.toolId&&(this.toolId=t,null==(e=(i=this.toolsMap[this.toolId]).activate)||e.call(i,this.cursorPos),Object.values(this.toolsMap).forEach(t=>{var e;return null==(e=t.onTool)?void 0:e.call(t,this.toolId)}),this.onChangeTool(t),this.updateToolSvgs(),this.updateDoubleTapPointerTypes(),this.requestRender())}getTool(){return this.toolId}translate(t,e){let i=this.targetTransform;this.setTargetTransform((0,$9FMZM._)((0,$wpIFA._)({},i),{x:i.x+t,y:i.y+e}))}scale(t,e,i){let s=this.targetTransform,n={width:this.width,height:this.height};e=null!=e?e:n.width/2,i=null!=i?i:n.height/2;let r=$bfc75b1b92419309$export$935bc53f7df03c95(s,{x:e,y:i});r.scale=$2Eggz.BB.clamp(r.scale*t,$3757e4eb154d55dd$export$5e2c057e240c0b8c,$3757e4eb154d55dd$export$ac82c07320907c00),this.setTargetTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(r.viewportP,r.canvasP,r.scale,r.angleDeg))}resetTransform(t){let e=this.getResetTransform();this.setTargetTransform(e,t),this.requestRender()}fitTransform(t){let e=this.viewport.getTransform(),i=this.getFitTransform(),s=i.x!==e.x||i.y!==e.y,n=i.scale!==e.scale||i.angleDeg!==e.angleDeg;return(!!s||!!n)&&(this.setTargetTransform(i,t),!0)}resetOrFitTransform(t){let e=4;!$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.disableAutoFit&&this.project.width<=this.width/e&&this.project.height<=this.height/e?this.fitTransform(t):this.resetTransform(t)}setAngleDeg(t,e){let i=this.targetTransform,s=$00bfc001d6438b5d$export$ad1d215dd03fe75a(i),n={width:this.width,height:this.height},r={x:n.width/2,y:n.height/2},a=(0,$8cWis.minimizeAngleDeg)(e?i.angleDeg+t:t),o=$68a5ab3e745a3a87$export$99c68a89351e15c0(r,$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(s),r),i.scale,a);this.setTargetTransform(o)}getIsLocked(){var t,e,i;return null!=(i=null==(t=(e=this.getActiveTool()).getIsLocked)?void 0:t.call(e))&&i}setIsFrozen(t){this.isFrozen=t}getElement(){return this.rootEl}destroy(){this.viewport.destroy(),this.pointerListener.destroy(),this.keyListener.destroy(),void 0!==this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.selectionRenderer.destroy(),window.removeEventListener("pointerdown",this.windowPointerListener)}constructor(t){var e,i;this.doRender=!1,this.isFrozen=!1,this.lastRenderedTransform={},this.targetTransform={},this.easelInterface={setCursor:t=>this.rootEl.style.cursor=t,getTransform:()=>this.viewport.getTransform(),getTargetTransform:()=>this.targetTransform,getSize:()=>({width:this.width,height:this.height}),getProjectSize:()=>({width:this.project.width,height:this.project.height}),setTransform:(t,e)=>this.setTargetTransform(t,e),requestRender:()=>this.requestRender(),isKeyPressed:t=>this.keyListener.isPressed(t),minScale:$3757e4eb154d55dd$export$5e2c057e240c0b8c,maxScale:$3757e4eb154d55dd$export$ac82c07320907c00,setAngleDeg:(...t)=>this.setAngleDeg(...t),keyListener:{},updateDoubleTapPointerTypes:()=>this.updateDoubleTapPointerTypes(),setRenderedSelection:t=>this.selectionRenderer.setRenderedSelection(t),clearRenderedSelection:t=>this.selectionRenderer.clearRenderedSelection(t),onWheel:t=>this.onWheel(t),getElement:()=>this.rootEl},this.lastFrameTimestamp=0,this.onWheel=t=>{var e;null==(e=t.event)||e.preventDefault();let i=!1;if(.8>Math.abs(t.deltaY)&&(i=!0),t.event&&t.event.ctrlKey&&!this.keyListener.isPressed("ctrl")){i=!0;let e=1;0===t.event.deltaMode&&(e=6),t.deltaY*=e}this.keyListener.isPressed("shift")&&(t.deltaY/=4);let s=this.targetTransform,n={x:t.relX,y:t.relY},r=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(s)),n),a=$2Eggz.BB.clamp(s.scale*Math.pow(1.4,-t.deltaY),$3757e4eb154d55dd$export$5e2c057e240c0b8c,$3757e4eb154d55dd$export$ac82c07320907c00);this.setTargetTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(n,r,a,s.angleDeg),i)},this.project=t.project,this.width=t.width,this.height=t.height,this.toolId=t.tool,this.toolsMap=(0,$wpIFA._)({},t.tools),this.onChangeTool=t.onChangeTool,this.onTransformChange=t.onTransformChange,this.onUndo=t.onUndo,this.onRedo=t.onRedo,this.tempTools=Object.fromEntries($3757e4eb154d55dd$export$c5299001bfb7de59.map(t=>[t,$ef524340be1400ac$var$getToolEntries(this.toolsMap).filter(([e,i])=>i.tempTriggers&&i.tempTriggers.includes(t)).map(t=>t[0])[0]])),this.viewport=new $0ca7fca685ce788f$export$a140ed60c2ca052c({width:this.width,height:this.height,project:{width:this.project.width,height:this.project.height,layers:this.project.layers},transform:this.getResetTransform(),renderAfter:(t,e)=>{var i;let s=this.getActiveTool();null==(i=s.renderAfterViewport)||i.call(s,t,e)}}),Object.values(this.toolsMap).forEach(t=>{var e,i;null==(e=t.setEaselInterface)||e.call(t,this.easelInterface),null==(i=t.onResize)||i.call(t,this.width,this.height)});let s=!1,n=!1,r=!1;this.pointerPreprocessor=new $6f9f66a6815f0457$export$ae7d5b5c7fa00e77({onUndo:this.onUndo,onRedo:this.onRedo,onPinch:t=>{if("move"===t.type){let e=this.viewport.getTransform();this.pinchInitialTransform||(this.pinchInitialTransform=$2Eggz.BB.copyObj(e),r=this.pinchInitialTransform.angleDeg%180==0);let i=this.pinchInitialTransform.angleDeg+t.angleRad/Math.PI*180;(i=(0,$8cWis.minimizeAngleDeg)((0,$8cWis.snapAngleDeg)(i,90,r?12:4)))%90!=0&&(r=!1);let s=$bfc75b1b92419309$export$935bc53f7df03c95(this.pinchInitialTransform,{x:t.downRelX,y:t.downRelY});s.scale=$2Eggz.BB.clamp(this.pinchInitialTransform.scale*t.scale,$3757e4eb154d55dd$export$5e2c057e240c0b8c,$3757e4eb154d55dd$export$ac82c07320907c00),s.viewportP.x+=t.relX-t.downRelX,s.viewportP.y+=t.relY-t.downRelY,s.angleDeg=i,this.setTargetTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(s.viewportP,s.canvasP,s.scale,s.angleDeg),!0),this.requestRender()}else"end"===t.type&&(this.pinchInitialTransform=void 0)},onDoubleTap:t=>{this.fitTransform()?this.requestRender():this.scale(2,t.relX,t.relY)},onChainOut:t=>{if(this.cursorPos={x:t.relX,y:t.relY},"pointerdown"===t.type)"middle"===t.button&&(s=!0,this.pushTempTool(this.tempTools["mouse-middle"])),"right"===t.button&&(n=!0,this.pushTempTool(this.tempTools["mouse-right"]));else if("pointermove"===t.type);else if("pointerup"===t.type){if(s){s=!1,this.getActiveTool().onPointer(t),this.popTempTool(this.tempTools["mouse-middle"]);return}if(n){n=!1,this.getActiveTool().onPointer(t),this.popTempTool(this.tempTools["mouse-right"]);return}}this.getActiveTool().onPointer(t)}}),this.pointerListener=new(0,$iwR8S.PointerListener)({target:this.viewport.getElement(),onPointer:t=>{this.pointerPreprocessor.chainIn(t)},onWheel:this.onWheel,onEnterLeave:t=>{let e=this.getActiveTool();if(!t){var i;this.cursorPos=void 0,null==(i=e.onPointerLeave)||i.call(e)}},useDirtyWheel:!0,isWheelPassive:!1,maxPointers:3}),this.windowPointerListener=t=>{var e,i;!this.isFrozen&&(this.rootEl.contains(t.target)||null==(e=(i=this.getActiveTool()).onClickOutside)||e.call(i))},window.addEventListener("pointerdown",this.windowPointerListener),this.keyListener=new(0,$27fCv.KeyListener)({onDown:(t,e,i,s)=>{var n,r,a;if(this.isFrozen)return;if("plus"===i){let t=this.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,this.keyListener.isPressed("shift")?1/8:.5);this.scale(e/t)}if("minus"===i){let t=this.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,this.keyListener.isPressed("shift")?-1/8:-.5);this.scale(e/t)}if(this.keyListener.comboOnlyContains(["shift","left","right","up","down"])){let e=this.getActiveTool();if(!(null==(r=e.onArrowKeys)?void 0:r.call(e,t))){let e=40;"left"===t&&this.translate(e,0),"right"===t&&this.translate(-e,0),"up"===t&&this.translate(0,e),"down"===t&&this.translate(0,-e)}}$3757e4eb154d55dd$export$4f41ddbc92f66d7d.forEach(t=>{i===t&&this.toolsMap[this.toolId].blockTrigger!==t&&this.pushTempTool(this.tempTools[t])});let o=this.toolsMap[null!=(a=this.tempToolId)?a:this.toolId];null==(n=o.onKeyDown)||n.call(o,t,e,i,s)},onUp:(t,e,i)=>{var s,n;if(this.isFrozen)return;$3757e4eb154d55dd$export$4f41ddbc92f66d7d.forEach(e=>{t===e&&this.toolsMap[this.toolId].blockTrigger!==e&&this.popTempTool(this.tempTools[e])});let r=this.toolsMap[null!=(n=this.tempToolId)?n:this.toolId];null==(s=r.onKeyUp)||s.call(r,t,e,i)},onBlur:()=>{var t,e;let i=this.toolsMap[null!=(e=this.tempToolId)?e:this.toolId];null==(t=i.onBlur)||t.call(i)}}),this.easelInterface.keyListener=this.keyListener,this.selectionRenderer=new $af70c2e1b3c35649$export$c61ab90e0d3eb9b1({transform:this.viewport.getTransform(),selection:this.project.selection,width:this.width,height:this.height}),this.svgEl=$2Eggz.BB.createSvg({elementType:"svg",width:""+this.width,height:""+this.height}),(0,$VM6dD.css)(this.svgEl,{position:"absolute",left:"0",top:"0",pointerEvents:"none"}),this.svgEl.append(this.selectionRenderer.getElement(),...Object.values(this.toolsMap).map(t=>t.getSvgElement())),this.htmlOverlayEl=$2Eggz.BB.el({css:{position:"absolute",left:"0",top:"0"}}),this.htmlOverlayEl.append(...Object.values(this.toolsMap).map(t=>{var e;return(null==(e=t.getHtmlOverlayElement)?void 0:e.call(t))||void 0}).filter(t=>void 0!==t)),this.updateToolSvgs(),this.rootEl=$934e5f47c3374e21$export$db3b6bfb95261072({css:{userSelect:"none",touchAction:"none",overscrollBehaviorX:"none"}},[this.viewport.getElement(),this.svgEl,this.htmlOverlayEl]),this.rootEl.addEventListener("contextmenu",t=>(t.preventDefault(),!1),{passive:!1}),this.rootEl.addEventListener("touchend",t=>(t.preventDefault(),!1)),this.rootEl.addEventListener("dragstart",t=>(t.preventDefault(),!1)),null==(e=(i=this.toolsMap[this.toolId]).activate)||e.call(i,this.cursorPos),Object.values(this.toolsMap).forEach(t=>{var e;return null==(e=t.onTool)?void 0:e.call(t,this.toolId)}),this.renderLoop()}}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$2Eggz=parcelRequire("2Eggz");class $7c395458bbf78292$export$6c14c4cb1f26a0eb{stop(){void 0!==this.animationFrameHandle&&(cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0)}dampen(t){let e=$2Eggz.BB.Vec2.len(this.momentum);e<.3?(this.momentum.x=0,this.momentum.y=0,this.stop()):e<5?(this.momentum.x*=.85**t,this.momentum.y*=.85**t):(this.momentum.x*=.95**t,this.momentum.y*=.95**t)}physicsLoop(){this.animationFrameHandle=requestAnimationFrame(()=>this.physicsLoop());let t=performance.now(),e=(t-this.lastTimestamp)/this.defaultDeltaMs;if(this.lastTimestamp=t,0===this.momentum.x&&0===this.momentum.y||this.isDragging)return void(this.isDragging?this.dampen(e):this.stop());let i=this.getTransform();if(this.lastTransform&&(this.lastTransform.x!==i.x||this.lastTransform.y!==i.y||this.lastTransform.x!==i.x||this.lastTransform.x!==i.x)){this.momentum.x=0,this.momentum.y=0,this.lastTransform=void 0,this.stop();return}i.x+=this.momentum.x,i.y+=this.momentum.y,this.lastTransform=i,this.dampen(e),this.setTransform(i)}dragStart(){this.isEnabled&&(this.isDragging=!0,this.momentum.x=0,this.momentum.y=0,this.stop())}dragMove(t,e){this.isEnabled&&(this.momentum={x:$2Eggz.BB.mix(this.momentum.x,t,.6),y:$2Eggz.BB.mix(this.momentum.y,e,.6)},this.lastDragTimestamp=new Date().getTime())}dragEnd(){this.isEnabled&&(new Date().getTime()-this.lastDragTimestamp>80?(this.momentum.x=0,this.momentum.y=0):(this.lastTimestamp=performance.now(),this.animationFrameHandle=requestAnimationFrame(()=>this.physicsLoop())),this.lastTransform=void 0,this.lastDragTimestamp=0,this.isDragging=!1)}setIsEnabled(t){this.isEnabled=t}constructor(t){this.defaultDeltaMs=1e3/60,this.momentum={x:0,y:0},this.isDragging=!1,this.lastDragTimestamp=0,this.lastTimestamp=0,this.isEnabled=!1,this.getTransform=t.getTransform,this.setTransform=t.setTransform}}class $d8c027c12d076d23$export$8202a4a90789f655{getSvgElement(){return this.svgEl}onPointer(t){if(this.easel.setCursor("grab"),"pointerdown"===t.type&&["left","middle"].includes(t.button)&&(this.inertiaScrolling.dragStart(),this.easel.setCursor("grabbing")),"pointermove"===t.type&&["left","middle"].includes(t.button)){let e=(0,$wpIFA._)({},this.easel.getTransform());e.x+=t.dX,e.y+=t.dY,this.easel.setTransform(e,!0),this.easel.requestRender(),this.easel.setCursor("grabbing"),this.inertiaScrolling.dragMove(t.dX,t.dY)}"pointerup"===t.type&&void 0===t.button&&this.inertiaScrolling.dragEnd()}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("grab")}setUseInertiaScrolling(t){this.inertiaScrolling.setIsEnabled(t)}constructor(t){this.easel={},this.doubleTapPointerTypes=["touch","mouse","pen"],this.tempTriggers=["space","mouse-middle"],this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.inertiaScrolling=new $7c395458bbf78292$export$6c14c4cb1f26a0eb({getTransform:()=>this.easel.getTransform(),setTransform:t=>this.easel.setTransform(t,!0)})}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$h5jm6=parcelRequire("h5jm6"),$VbzD9=parcelRequire("VbzD9"),$2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $a79112c6366113fa$export$e91d1e53efcc28e3{update(t,e,i){let s=$00bfc001d6438b5d$export$ad1d215dd03fe75a(t),n=Math.round(2*(i=Math.round(2*i)/2)),r=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(s),e);r.x=n%2==0?Math.round(r.x):Math.floor(r.x)+.5,r.y=n%2==0?Math.round(r.y):Math.floor(r.y)+.5;{let t=[[r.x-i,r.y-i],[r.x+i,r.y-i],[r.x+i,r.y+i],[r.x-i,r.y+i],[r.x-i,r.y-i]].map(t=>$855520c81dfcb96a$export$9b20165a36586806(s,t)),e="M ";t.forEach(t=>{e+=t.join(",")+" "}),(0,$VM6dD.setAttributes)(this.rootEl.children[1],{d:e})}{let e=1/t.scale,n=[[r.x-i+e,r.y-i+e],[r.x+i-e,r.y-i+e],[r.x+i-e,r.y+i-e],[r.x-i+e,r.y+i-e],[r.x-i+e,r.y-i+e]].map(t=>$855520c81dfcb96a$export$9b20165a36586806(s,t)),a="M ";n.forEach(t=>{a+=t.join(",")+" "}),(0,$VM6dD.setAttributes)(this.rootEl.firstChild,{d:a})}}getElement(){return this.rootEl}constructor(){this.rootEl=$2Eggz.BB.createSvg({elementType:"g",childrenArr:[{elementType:"path",fill:"none",stroke:"rgba(255,255,255,0.7)","stroke-width":"1"},{elementType:"path",fill:"none",stroke:"rgba(0,0,0,0.7)","stroke-width":"1"}]})}}var $2Eggz=parcelRequire("2Eggz");class $2b394378f1de843c$export$249b9041c848ec46{update(t,e,i){$2Eggz.BB.setAttributes(this.rootEl.children[0],{r:""+Math.max(0,i*t.scale-1)}),$2Eggz.BB.setAttributes(this.rootEl.children[1],{r:""+i*t.scale}),$2Eggz.BB.setAttributes(this.rootEl,{transform:`translate(${e.x} ${e.y})`})}getElement(){return this.rootEl}constructor(){this.rootEl=$2Eggz.BB.createSvg({elementType:"g",childrenArr:[{elementType:"circle",cx:"0",cy:"0",fill:"none",stroke:"rgba(255,255,255,0.7)","stroke-width":"1"},{elementType:"circle",cx:"0",cy:"0",fill:"none",stroke:"rgba(0,0,0,0.7)","stroke-width":"1"}]})}}var $4byZX=parcelRequire("4byZX");class $d5398ba9251670c1$export$dfeedd8879a1038a{onExplodedPointer(t){var e;let i=this.easel.getTransform(),s=$00bfc001d6438b5d$export$ad1d215dd03fe75a(i),n=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(s),{x:t.relX,y:t.relY}),r=n.x,a=n.y;i.scale!==this.oldScale&&(this.oldScale=i.scale),!t.isCoalesced&&(this.lastPos.x=t.relX,this.lastPos.y=t.relY,this.currentCursor.update(this.easel.getTransform(),{x:t.relX,y:t.relY},this.radius),this.isOver||"pointerup"===t.type||this._onPointerEnter());let o=null!=(e=t.pressure)?e:1,l=t.isCoalesced,h=this.easel.keyListener.isPressed("shift");if(!h&&this.onShapeDetected){let e={pressure:o,isCoalesced:l,shiftIsPressed:h,scale:i.scale};"pointerdown"===t.type&&"left"===t.button?this.shapeRecognition.chainIn((0,$wpIFA._)({type:"down",x:r,y:a},e)):"pointermove"===t.type&&"left"===t.button?this.shapeRecognition.chainIn((0,$wpIFA._)({type:"move",x:r,y:a},e)):"pointerup"===t.type&&this.shapeRecognition.chainIn({type:"up",isCoalesced:l,shiftIsPressed:h,scale:i.scale})}if(h&&!this.firstShiftPos&&(this.firstShiftPos={x:t.relX,y:t.relY}),h||(this.firstShiftPos=void 0,this.lineToolDirection=void 0),"pointerdown"===t.type&&"left"===t.button){if(h){this.lastLineEnd&&this.onLine(this.lastLineEnd,{x:r,y:a});return}this.onLineStart({x:r,y:a,pressure:o,isCoalesced:l}),this.isDragging=!0}if("pointermove"===t.type&&"left"===t.button)if(h){if(!this.lineToolDirection){let e=Math.abs(t.relX-this.firstShiftPos.x),i=Math.abs(t.relY-this.firstShiftPos.y);(e>5||i>5)&&(this.lineToolDirection=e>i?"x":"y")}if(this.lineToolDirection){let e={x:"x"===this.lineToolDirection?t.relX:this.firstShiftPos.x,y:"y"===this.lineToolDirection?t.relY:this.firstShiftPos.y},i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b(s),e);this.onLineGo((0,$9FMZM._)((0,$wpIFA._)({},i),{pressure:o,isCoalesced:l}))}}else this.onLineGo({x:r,y:a,pressure:o,isCoalesced:l});"pointerup"===t.type&&void 0===t.button&&this.isDragging&&(this.onLineEnd(),this.isDragging=!1,"touch"===t.pointerType&&this.onPointerLeave())}_onPointerEnter(){clearTimeout(this.hideCursorTimeout),this.svgEl.setAttribute("opacity","1"),this.isOver=!0}getSvgElement(){return this.svgEl}onPointer(t){this.eventChain.chainIn(t)}onPointerLeave(){clearTimeout(this.hideCursorTimeout),this.svgEl.setAttribute("opacity","0"),this.isOver=!1}setEaselInterface(t){this.easel=t}onUpdateTransform(t){this.currentCursor.update(t,{x:this.lastPos.x,y:this.lastPos.y},this.radius)}getIsLocked(){return this.isDragging}setBrush(t){if(void 0!==t.radius){this.radius=t.radius,this.isOver||(this.svgEl.setAttribute("opacity","1"),clearTimeout(this.hideCursorTimeout),this.hideCursorTimeout=setTimeout(()=>{this.svgEl.setAttribute("opacity","0")},500));let{width:e,height:i}=this.easel.getSize();this.currentCursor.update(this.easel.getTransform(),this.isOver?this.lastPos:{x:e/2,y:i/2},this.radius)}if(void 0!==t.type){let e="round"===t.type?this.brushCursorRound:this.brushCursorPixelSquare;e!==this.currentCursor&&(this.currentCursor.getElement().remove(),this.currentCursor=e,this.getSvgElement().append(this.currentCursor.getElement()))}}setLastDrawEvent(t){this.lastLineEnd=t?(0,$wpIFA._)({},t):void 0}activate(t){this.easel.setCursor("crosshair"),this.isDragging=!1,t?(this.lastPos.x=t.x,this.lastPos.y=t.y,this.currentCursor.update(this.easel.getTransform(),{x:t.x,y:t.y},this.radius)):this.onPointerLeave()}constructor(t){this.easel={},this.oldScale=1,this.isDragging=!1,this.lastPos={x:0,y:0},this.isOver=!1,this.radius=t.radius,this.onLineStart=t.onLineStart,this.onLineGo=t.onLineGo,this.onLineEnd=t.onLineEnd,this.onLine=t.onLine,this.onShapeDetected=t.onShapeDetected,console.log("EaselBrush: Initializing Shape Recogniton"),this.shapeRecognition=new(0,$4byZX.ShapeRecognition)({onShapeRecognized:t=>{let e=this.shapeRecognition.getRecognizedShape();console.log("Shape recognized:",t,e),this.onShapeDetected&&e&&this.onShapeDetected(e)}}),this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.brushCursorRound=new $2b394378f1de843c$export$249b9041c848ec46,this.brushCursorPixelSquare=new $a79112c6366113fa$export$e91d1e53efcc28e3,this.currentCursor=this.brushCursorRound,this.svgEl.append(this.currentCursor.getElement()),this.eventChain=new(0,$VbzD9.EventChain)({chainArr:[new(0,$h5jm6.CoalescedExploder)]}),this.eventChain.setChainOut(t=>{this.onExplodedPointer(t)})}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $d5ac8c3334d6d49f$export$abfede0290e9bfba{update(){let t=this.klCanvas.getWidth(),e=this.klCanvas.getHeight();this.easel.setProject({width:t,height:e,layers:this.klCanvas.getLayersFast().map(i=>({image:i.compositeObj?()=>{var s;(this.compositeCanvas.width!=t||this.compositeCanvas.height!=e)&&(this.compositeCanvas.width=t,this.compositeCanvas.height=e);let n=this.compositeCanvas.getContext("2d");return n.clearRect(0,0,t,e),n.drawImage(i.canvas,0,0),null==(s=i.compositeObj)||s.draw((0,$VM6dD.throwIfNull)(this.compositeCanvas.getContext("2d"))),this.compositeCanvas}:i.canvas,isVisible:i.isVisible,opacity:i.opacity,mixModeStr:i.mixModeStr,hasClipping:!1})),selection:this.klCanvas.getSelection()})}freeCompositeCanvas(){this.compositeCanvas.width=1,this.compositeCanvas.height=1}constructor(t){this.compositeCanvas=$2Eggz.BB.canvas(1,1),this.klCanvas=t.klCanvas,this.easel=t.easel,this.update()}}var $2Eggz=parcelRequire("2Eggz"),$f57775de34880207$exports={};$f57775de34880207$exports=$parcel$resolve("6rWqS");class $0bd0e1e89228720f$export$1fda302750a9ba48{getSvgElement(){return this.svgEl}onPointer(t){let e;this.easel.setCursor("url('"+$parcel$interopDefault($f57775de34880207$exports)+"') 0 15, crosshair");let i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.easel.getTransform())),{x:t.relX,y:t.relY}),s=["left","right"].includes(t.button);if(s?(this.svgEl.setAttribute("transform",`translate(${t.relX},${t.relY})`),this.svgEl.style.opacity="1"):this.svgEl.style.opacity="0","pointerdown"===t.type&&s&&(e=this.onPick(i),this.isDragging=!0,s=!0),"pointermove"===t.type&&s&&(e=this.onPick(i),s=!0),"pointerup"===t.type&&void 0===t.button&&this.isDragging&&(this.onPickEnd(),this.isDragging=!1),e&&s){this.previewColor.setAttribute("stroke",$2Eggz.BB.ColorConverter.toRgbStr(e));let t=$2Eggz.BB.testIsWhiteBestContrast(e)?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)";this.previewBorder.setAttribute("stroke",t)}}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("url('"+$parcel$interopDefault($f57775de34880207$exports)+"') 0 15, crosshair"),this.isDragging=!1,this.svgEl.style.opacity="0"}onPointerLeave(){this.isDragging||(this.svgEl.style.opacity="0")}constructor(t){this.easel={},this.isDragging=!1,this.tempTriggers=["mouse-right","alt"],this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.onPick=t.onPick,this.onPickEnd=t.onPickEnd,this.previewBorder=$2Eggz.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"22",fill:"none"}),this.previewColor=$2Eggz.BB.createSvg({elementType:"circle",r:"47",stroke:"black","stroke-width":"20",fill:"none"}),this.svgEl.append(this.previewBorder,this.previewColor)}}var $2Eggz=parcelRequire("2Eggz"),$2620a7374975e56c$exports={};$2620a7374975e56c$exports=$parcel$resolve("gy6aj");class $b94c0aafb6fba54d$export$9b29623161064b87{getSvgElement(){return this.svgEl}onPointer(t){this.easel.setCursor("url('"+$parcel$interopDefault($2620a7374975e56c$exports)+"') 1 12, crosshair");let e=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.easel.getTransform())),{x:t.relX,y:t.relY});"pointerdown"===t.type&&"left"===t.button&&this.onFill({x:Math.floor(e.x),y:Math.floor(e.y)})}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("url('"+$parcel$interopDefault($2620a7374975e56c$exports)+"') 1 12, crosshair")}constructor(t){this.easel={},this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.onFill=t.onFill}}var $2Eggz=parcelRequire("2Eggz");class $317b4db69c17519a$export$11badb1ec62816a1{getSvgElement(){return this.svgEl}onPointer(t){this.easel.setCursor("crosshair");let e=this.easel.getTransform(),i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(e)),{x:t.relX,y:t.relY});"pointerdown"===t.type&&"left"===t.button&&(this.onDown(i,e.angleDeg/180*Math.PI),this.isDragging=!0),"pointermove"===t.type&&"left"===t.button&&this.onMove(i),"pointerup"===t.type&&void 0===t.button&&this.isDragging&&(this.onUp(i),this.isDragging=!1)}setEaselInterface(t){this.easel=t}getIsLocked(){return this.isDragging}activate(t){this.easel.setCursor("crosshair"),this.isDragging=!1}constructor(t){this.easel={},this.isDragging=!1,this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.onDown=t.onDown,this.onMove=t.onMove,this.onUp=t.onUp}}var $2Eggz=parcelRequire("2Eggz"),$2ea6783c01238ca9$exports={};$2ea6783c01238ca9$exports=$parcel$resolve("9SVhx");class $737d4594390c240a$export$b10c22a3fee9197f{getSvgElement(){return this.svgEl}onPointer(t){this.easel.setCursor("url('"+$parcel$interopDefault($2ea6783c01238ca9$exports)+"') 1 12, crosshair");let e=this.easel.getTransform(),i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(e)),{x:t.relX,y:t.relY});"pointerdown"===t.type&&"left"===t.button&&this.onDown(i,e.angleDeg/180*Math.PI)}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("url('"+$parcel$interopDefault($2ea6783c01238ca9$exports)+"') 1 12, crosshair")}constructor(t){this.easel={},this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.onDown=t.onDown}}var $2Eggz=parcelRequire("2Eggz");class $065fe39023128955$export$4deed4c512c630c2{movementLoop(){if(!this.cornerDirection){this.animationFrameHandle&&cancelAnimationFrame(this.animationFrameHandle),this.animationFrameHandle=void 0,this.lastFrameTimestamp=0;return}this.animationFrameHandle=requestAnimationFrame(()=>this.movementLoop());let t=performance.now(),e=Math.min((t-this.lastFrameTimestamp)/(1e3/60),10);this.lastFrameTimestamp=t;let i=this.getTransform();i.x+=this.cornerDirection.x*e,i.y+=this.cornerDirection.y*e,this.setTransform(i),this.onRepeatEvent(this.repeatEvent)}getSpeed(t){return .4*Math.min(t,this.thresholdPx)}onPointer(t){let e=!1;this.cornerDirection={x:0,y:0},this.testCanPan(void 0!==t.button)&&"pointermove"===t.type&&(t.relX>this.getEaselSize().width-this.thresholdPx&&(this.cornerDirection.x-=this.getSpeed(t.relX-(this.getEaselSize().width-this.thresholdPx)),e=!0),t.relX<this.thresholdPx&&(this.cornerDirection.x+=this.getSpeed(this.thresholdPx-t.relX),e=!0),t.relY>this.getEaselSize().height-this.thresholdPx&&(this.cornerDirection.y-=this.getSpeed(t.relY-(this.getEaselSize().height-this.thresholdPx)),e=!0),t.relY<this.thresholdPx&&(this.cornerDirection.y+=this.getSpeed(this.thresholdPx-t.relY),e=!0)),e?(0===this.lastFrameTimestamp&&(this.lastFrameTimestamp=performance.now()),this.repeatEvent=t,this.animationFrameHandle=requestAnimationFrame(()=>this.movementLoop())):this.cornerDirection=void 0}constructor(t){this.thresholdPx=25,this.lastFrameTimestamp=0,this.repeatEvent={},this.getEaselSize=t.getEaselSize,this.getTransform=t.getTransform,this.setTransform=t.setTransform,this.testCanPan=t.testCanPan,this.onRepeatEvent=t.onRepeatEvent}}class $0d69a1331eb93d66$export$f4821fa73b1145e5{getSvgElement(){return this.svgEl}onPointer(t,e){this.doPan&&!e&&this.cornerPanning.onPointer(t),this.easel.setCursor("crosshair");let i=this.easel.getTransform(),s=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(i)),{x:t.relX,y:t.relY});"pointerdown"===t.type&&"left"===t.button&&(this.onDown(s,i.angleDeg/180*Math.PI),this.isDragging=!0),"pointermove"===t.type&&"left"===t.button&&this.onMove(s),"pointerup"===t.type&&void 0===t.button&&this.isDragging&&(this.onUp(s),this.isDragging=!1)}setEaselInterface(t){this.easel=t}getIsLocked(){return this.isDragging}activate(t){this.easel.setCursor("crosshair"),this.isDragging=!1}setPanning(t){this.doPan=t}constructor(t){this.easel={},this.isDragging=!1,this.doPan=!1,this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.onDown=t.onDown,this.onMove=t.onMove,this.onUp=t.onUp,this.cornerPanning=new $065fe39023128955$export$4deed4c512c630c2({getEaselSize:()=>this.easel.getSize(),getTransform:()=>this.easel.getTargetTransform(),setTransform:t=>this.easel.setTransform(t,!0),testCanPan:t=>t,onRepeatEvent:t=>{this.onPointer(t,!0)}})}}var $2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis"),$VM6dD=parcelRequire("VM6dD");class $7d88d4eb596d13ba$export$f3b0846760df78b{getSvgElement(){return this.svgEl}onPointer(t){if(this.easel.setCursor("left"===t.button?"grabbing":"grab"),"pointerdown"===t.type&&"left"===t.button)this.downPos={x:t.relX,y:t.relY},this.downTransform=$2Eggz.BB.copyObj(this.easel.getTargetTransform());else if("left"===t.button&&this.downPos&&this.downTransform){let{width:e,height:i}=this.easel.getSize(),s={x:e/2,y:i/2},n=$2Eggz.BB.Vec2.angle(s,this.downPos),r=($2Eggz.BB.Vec2.angle(s,{x:t.relX,y:t.relY})-n)/Math.PI*180,a=this.downTransform.angleDeg+r;this.easel.isKeyPressed("shift")&&(a=45*Math.round(a/45)),a=(0,$8cWis.minimizeAngleDeg)(a);let o=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.downTransform)),s);this.easel.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(s,o,this.downTransform.scale,a),!this.easel.isKeyPressed("shift")),this.easel.requestRender()}else"pointerup"===t.type&&this.downPos&&(this.downPos=void 0,this.downTransform=void 0)}onUpdateTransform(t){let e=this.easel.getTargetTransform();this.needleWrapper.setAttribute("transform","rotate("+t.angleDeg+")"),this.compassLineCircle.style.opacity=e.angleDeg%90==0?"1":"0"}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("grab");let{width:e,height:i}=this.easel.getSize();this.compass.setAttribute("transform","translate("+e/2+", "+i/2+")"),this.onUpdateTransform(this.easel.getTransform())}onKeyDown(t,e,i){["r+left","r+right"].includes(i)&&("left"===t&&this.easel.setAngleDeg(-15,!0),"right"===t&&this.easel.setAngleDeg(15,!0)),["r+up"].includes(i)&&this.easel.setAngleDeg(0,!1)}onResize(t,e){this.compass.setAttribute("transform","translate("+t/2+", "+e/2+")")}constructor(t){this.easel={},this.downPos=void 0,this.tempTriggers=["r"],this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.compassSize=30,this.compass=$2Eggz.BB.createSvg({elementType:"g"}),(0,$VM6dD.css)(this.compass,{transition:"opacity 0.25s ease-in-out"}),this.compassInner=$2Eggz.BB.createSvg({elementType:"g"}),this.compassBaseCircle=$2Eggz.BB.createSvg({elementType:"circle",fill:"rgba(0,0,0,0.9)",stroke:"none",cx:"0",cy:"0",r:""+this.compassSize}),this.compassLineCircle=$2Eggz.BB.createSvg({elementType:"circle",fill:"none",stroke:"rgba(255,255,255,0.75)","stroke-width":"1",cx:"0",cy:"0",r:""+.9*this.compassSize}),(0,$VM6dD.css)(this.compassLineCircle,{transition:"opacity 0.1s ease-in-out"}),this.needleWrapper=$2Eggz.BB.createSvg({elementType:"g","transform-origin":"0 0"}),this.compassUpperTriangle=$2Eggz.BB.createSvg({elementType:"path",fill:"#f00",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,-"+.9*this.compassSize+" z"}),this.compassLowerTriangle=$2Eggz.BB.createSvg({elementType:"path",fill:"#fff",stroke:"none",d:"M -"+.25*this.compassSize+",0 "+.25*this.compassSize+",0 0,"+.9*this.compassSize+" z"}),this.needleWrapper.append(this.compassUpperTriangle,this.compassLowerTriangle),this.compassInner.append(this.compassBaseCircle,this.compassLineCircle,this.needleWrapper),this.compass.append(this.compassInner),this.svgEl.append(this.compass)}}var $2Eggz=parcelRequire("2Eggz"),$25a553072a0e8a1f$exports={};$25a553072a0e8a1f$exports=$parcel$resolve("5mHop");class $44d9d077b3aa143c$export$6c389c8425707374{getSvgElement(){return this.svgEl}onPointer(t){if(this.easel.setCursor("url('"+$parcel$interopDefault($25a553072a0e8a1f$exports)+"') 7 7, zoom-in"),"pointerdown"===t.type&&["left"].includes(t.button)&&(this.downPos={x:t.relX,y:t.relY},this.downTransform=$2Eggz.BB.copyObj(this.easel.getTransform())),"pointermove"===t.type&&["left"].includes(t.button)&&this.downPos&&this.downTransform){let e=this.downPos,i=$855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.downTransform)),e),s=t.relX-this.downPos.x,n=$2Eggz.BB.clamp(this.downTransform.scale*Math.pow(1+1/400,s),this.easel.minScale,this.easel.maxScale);this.easel.setTransform($68a5ab3e745a3a87$export$99c68a89351e15c0(e,i,n,this.downTransform.angleDeg),!0),this.easel.requestRender()}"pointerup"===t.type&&void 0===t.button&&(this.downPos=void 0,this.downTransform=void 0)}setEaselInterface(t){this.easel=t}activate(t){this.easel.setCursor("url('"+$parcel$interopDefault($25a553072a0e8a1f$exports)+"') 7 7, zoom-in")}constructor(t){this.easel={},this.downPos=void 0,this.tempTriggers=["z"],this.svgEl=$2Eggz.BB.createSvg({elementType:"g"})}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$e14946753ad377e3$exports={};$e14946753ad377e3$exports=$parcel$resolve("6WP3U");var $becee295081a3fa9$exports={};$becee295081a3fa9$exports=$parcel$resolve("hNYGT");var $15ecc27dd88d5ab1$exports={};$15ecc27dd88d5ab1$exports=$parcel$resolve("lU1xy");var $a6f29d5eb2004776$exports={};$a6f29d5eb2004776$exports=$parcel$resolve("d4ONi");var $8915f4d9d327a3ba$exports={};$8915f4d9d327a3ba$exports=$parcel$resolve("efKXt");var $742817cefa663d54$exports={};$742817cefa663d54$exports=$parcel$resolve("iG2IE");var $67fed947ea9fa458$exports={};$67fed947ea9fa458$exports=$parcel$resolve("heTsK");var $e5e249ddf082f14c$exports={};$e5e249ddf082f14c$exports=$parcel$resolve("bXno8");var $529fdcde1dab71dc$exports={};$529fdcde1dab71dc$exports=$parcel$resolve("4BXSU");var $jmKbV=parcelRequire("jmKbV"),$VM6dD=parcelRequire("VM6dD"),$wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz");class $d49d366dcf65e875$export$f04a61298a47a40f{getElement(){return this.rootEl}constructor(t){this.rootEl=$2Eggz.BB.el({className:t.darkInvert?"dark-invert":"",css:(0,$wpIFA._)({backgroundImage:`url("${t.imageUrl}")`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:t.width+"px",height:t.height+"px"},t.css)})}}class $726e24f56af72b92$export$b3e6ed306341f794{update(){this.selectResetBtn.style.display=this.hasSelection?"block":"none"}setIsVisible(t){this.isVisible=t,this.rootEl.style.display=this.isVisible?"block":"none",this.isVisible&&this.operationOptions.setValue("new")}setMode(t){this.modeOptions.setValue(t)}setLayers(t){this.moveToLayerSelect.setOptionArr(t.map((t,e)=>[""+e,t]).reverse())}setMoveToLayer(t){this.moveToLayerSelect.setValue(void 0===t?void 0:""+t)}setHasSelection(t){this.hasSelection=t,this.update()}setBackgroundIsTransparent(t){this.transparentBackgroundToggle.setValue(t)}setAlgorithm(t){this.algorithmSelect.setValue(t)}setFreeTransformTransformation(t){let e=$2Eggz.BB.round(t.x,0),i=$2Eggz.BB.round(t.y,0),s=$2Eggz.BB.round(t.angleDeg,0);this.positionOutput.innerText=`X: ${e}; Y: ${i}; ${$63d0b335c576c718$export$ce37e184d908d785("filter-transform-rotation")}: ${s}\xb0`}setShowTransparentBackgroundToggle(t){this.transparentBackgroundToggle.getElement().style.display=t?"block":"none"}getElement(){return this.rootEl}destroy(){}constructor(t){this.isVisible=!0,this.hasSelection=!1,this.onChangeMode=t.onChangeMode,this.modeOptions=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"select",label:$934e5f47c3374e21$export$db3b6bfb95261072("",[$934e5f47c3374e21$export$db3b6bfb95261072({content:"<img class='dark-invert' src='"+$parcel$interopDefault($e14946753ad377e3$exports)+"' height='20'/><span>"+$63d0b335c576c718$export$ce37e184d908d785("select-select")+"</span>",css:{display:"flex",gap:"5px",alignItems:"center",height:"100%",margin:"10px 4px",justifyContent:"center"}})])},{id:"transform",label:$934e5f47c3374e21$export$db3b6bfb95261072("",[$934e5f47c3374e21$export$db3b6bfb95261072({content:"<img class='dark-invert' src='"+$parcel$interopDefault($becee295081a3fa9$exports)+"' height='20'/><span>"+$63d0b335c576c718$export$ce37e184d908d785("select-transform")+"</span>",css:{display:"flex",gap:"5px",alignItems:"center",height:"100%",margin:"10px 4px",justifyContent:"center"}})])}],initId:"select",onChange:t=>{"select"===t&&this.operationOptions.setValue("new"),this.onChangeMode(t),C()},onBeforeChange:e=>"transform"!==e||t.canTransform(),optionCss:{flexGrow:"1",flexBasis:"0"},css:{marginBottom:"10px"}});let e=$2Eggz.BB.el(),i=new Image;i.src=$parcel$interopDefault($15ecc27dd88d5ab1$exports),i.classList.add("dark-invert");let s=new Image;s.src=$parcel$interopDefault($a6f29d5eb2004776$exports),s.classList.add("dark-invert");let n=new Image;n.src=$parcel$interopDefault($8915f4d9d327a3ba$exports),n.classList.add("dark-invert"),this.operationOptions=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"new",label:i,title:$63d0b335c576c718$export$ce37e184d908d785("select-boolean-replace")},{id:"union",label:s,title:$63d0b335c576c718$export$ce37e184d908d785("select-boolean-add")},{id:"difference",label:n,title:$63d0b335c576c718$export$ce37e184d908d785("select-boolean-subtract")}],initId:"new",onChange:e=>{t.onChangeBooleanOperation(e)},css:{marginBottom:"10px"}});let r={width:"32px",height:"32px"},a=new Image;a.src=$parcel$interopDefault($742817cefa663d54$exports),a.classList.add("dark-invert"),(0,$VM6dD.css)(a,r);let o=new Image;o.src=$parcel$interopDefault($67fed947ea9fa458$exports),o.classList.add("dark-invert"),(0,$VM6dD.css)(o,r);let l=new Image;l.src=$parcel$interopDefault($e5e249ddf082f14c$exports),l.classList.add("dark-invert"),(0,$VM6dD.css)(l,r);let h=new Image;h.src=$parcel$interopDefault($529fdcde1dab71dc$exports),h.classList.add("dark-invert"),(0,$VM6dD.css)(h,r);let c=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"rect",label:a,title:$63d0b335c576c718$export$ce37e184d908d785("shape-rect")},{id:"ellipse",label:o,title:$63d0b335c576c718$export$ce37e184d908d785("shape-ellipse")},{id:"lasso",label:l,title:$63d0b335c576c718$export$ce37e184d908d785("select-lasso")},{id:"poly",label:h,title:$63d0b335c576c718$export$ce37e184d908d785("select-polygon")}],initId:t.select.shape,onChange:e=>{t.select.onChangeShape(e)},css:{marginBottom:"10px"}});e.append(c.getElement(),this.operationOptions.getElement());let d=$2Eggz.BB.el({parent:e,css:{display:"flex",gap:"5px",flexWrap:"wrap"}});$2Eggz.BB.el({parent:d,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("select-all"),onClick:()=>{t.select.onAll()},custom:{tabindex:"-1"},css:{minHeight:"30px"}}),$2Eggz.BB.el({parent:d,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("select-invert"),onClick:()=>{t.select.onInvert()},custom:{tabindex:"-1"},css:{minHeight:"30px"}}),this.selectResetBtn=$2Eggz.BB.el({parent:d,tagName:"button",content:[(0,$jmKbV.createImage)({src:$parcel$interopDefault($03e87c70019af696$exports),alt:"icon",height:20,css:{marginRight:"3px",filter:"invert(1)"}}),$63d0b335c576c718$export$ce37e184d908d785("select-reset")],className:"kl-button kl-button-primary",css:{paddingRight:"8px",display:"none"},onClick:()=>{t.select.onReset()},custom:{tabindex:"-1"}}),$2Eggz.BB.el({className:"grid-hr",parent:e,css:{margin:"10px 0"}});let p=$2Eggz.BB.el({parent:e,css:{display:"flex",gap:"5px"}});$2Eggz.BB.el({parent:p,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("select-erase"),onClick:()=>{t.onErase()},custom:{tabindex:"-1"}}),$2Eggz.BB.el({parent:p,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("select-fill"),onClick:()=>{t.onFill()},custom:{tabindex:"-1"}});let u=$2Eggz.BB.el({css:{display:"flex",flexDirection:"column",gap:"10px"}});this.positionOutput=$2Eggz.BB.el({}),u.append(this.positionOutput);let g=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-flip")+" X",className:"kl-button",onClick:()=>{t.transform.onFlipX()},custom:{tabindex:"-1"}}),m=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-flip")+" Y",onClick:()=>{t.transform.onFlipY()},custom:{tabindex:"-1"}}),f=$2Eggz.BB.el({tagName:"button",content:"-90",onClick:()=>{t.transform.onRotateDeg(-90)},custom:{tabindex:"-1"}}),y=$2Eggz.BB.el({tagName:"button",content:"+90",onClick:()=>{t.transform.onRotateDeg(90)},custom:{tabindex:"-1"}}),v=new $d49d366dcf65e875$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($0ecce9fc138ec1e3$exports),width:20,height:20,darkInvert:!0}),x=$2Eggz.BB.el({tagName:"button",content:[v.getElement(),$63d0b335c576c718$export$ce37e184d908d785("select-transform-clone")],onClick:()=>{t.transform.onClone()},css:{display:"flex",gap:"5px"},custom:{tabindex:"-1"}}),b=$2Eggz.BB.el({tagName:"button",content:"2&times;",onClick:()=>{t.transform.onScale(2)},custom:{tabindex:"-1"}}),w=$2Eggz.BB.el({tagName:"button",content:"&frac12;&times;",onClick:()=>{t.transform.onScale(.5)},custom:{tabindex:"-1"}}),B=$2Eggz.BB.el({tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("center"),onClick:()=>{t.transform.onCenter()},custom:{tabindex:"-1"}});$2Eggz.BB.el({parent:u,content:[x,g,m,f,y,b,w,B],css:{display:"flex",flexWrap:"wrap",gap:"5px"}}),this.constrainCheckbox=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-constrain"),title:$63d0b335c576c718$export$ce37e184d908d785("constrain-proportions"),callback:function(e){t.transform.onChangeConstrain(e)},css:{display:"inline-block"},name:"constrain-proportions"}),this.snappingCheckbox=new $213947897b67ec3a$export$48513f6b9f8ce62d({init:!0,label:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-snap"),title:$63d0b335c576c718$export$ce37e184d908d785("filter-transform-snap-title"),callback:function(e){t.transform.onChangeSnapping(e)},css:{display:"inline-block",marginLeft:"10px"},name:"enable-snapping"});let S=$2Eggz.BB.el();S.append(this.constrainCheckbox.getElement(),this.snappingCheckbox.getElement()),u.append(S),this.algorithmSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:[["smooth",$63d0b335c576c718$export$ce37e184d908d785("algorithm-smooth")],["pixelated",$63d0b335c576c718$export$ce37e184d908d785("algorithm-pixelated")]],initValue:"smooth",onChange:e=>{t.transform.onChangeAlgorithm(e)},name:"interpolation-algorithm"}),u.append($934e5f47c3374e21$export$db3b6bfb95261072(",flex,items-center,gap-5,flexWrap",[$63d0b335c576c718$export$ce37e184d908d785("scaling-algorithm")+":",this.algorithmSelect.getElement()])),this.moveToLayerSelect=new $b1ef42bd443626ca$export$ef9b1a59e592288f({optionArr:[["1","Layer 2"],["0","Layer 1"]],onChange:e=>{t.transform.onMoveToLayer(+e)},name:"move-to-layer",css:{width:"100%"}}),u.append($934e5f47c3374e21$export$db3b6bfb95261072(",flex,items-center,gap-5,flexWrap",[$63d0b335c576c718$export$ce37e184d908d785("select-transform-move-to-layer"),this.moveToLayerSelect.getElement()])),this.transparentBackgroundToggle=new $213947897b67ec3a$export$48513f6b9f8ce62d({label:$63d0b335c576c718$export$ce37e184d908d785("brush-eraser-transparent-bg"),callback:e=>{t.transform.onChangeTransparentBackground(e)},name:"enable-transparent-background"}),(0,$VM6dD.css)(this.transparentBackgroundToggle.getElement(),{display:"inline-block"}),u.append(this.transparentBackgroundToggle.getElement());let C=()=>{"select"===this.modeOptions.getValue()?(this.rootEl.append(e),u.remove()):(e.remove(),this.rootEl.append(u))};this.rootEl=$2Eggz.BB.el({content:[this.modeOptions.getElement()],css:{margin:"10px"}}),C()}}var $wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis"),$aXq9D=parcelRequire("aXq9D"),$VbzD9=parcelRequire("VbzD9"),$lEiB9=parcelRequire("lEiB9"),$aXq9D=parcelRequire("aXq9D"),$8cWis=parcelRequire("8cWis");function $6dd27963ff379fef$export$a8cb0d8fd60b16e8(t,e){t.imageSmoothingEnabled="smooth"===e,"smooth"===e&&(t.imageSmoothingQuality="high")}function $b856d19f26b0608b$export$e464a809f7257768(t,e){let i={x:e.x1+(e.x2-e.x1)/2,y:e.y1+(e.y2-e.y1)/2},s=e.x2-e.x1,n=e.y2-e.y1,r=t.width/s,a=t.height/n,o=t.angleDeg/180*Math.PI;return $611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(t.x,t.y),$20520e5c69c4ad5d$export$bb628a54ab399bc9(o),$a78c550eaaca7cca$export$dcdf75081b88279d(r,a),$cf0617f9860dc277$export$d73ee8ef04f5226a(-i.x,-i.y))}class $b856d19f26b0608b$export$68f5601e78b8ada8{setBackgroundIsTransparent(t){this.backgroundIsTransparent=t}setSelection(t){this.selection=t,this.selectionBounds=(0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(this.selection)),this.transform=$5c473edaf09eadd3$export$f0954fd7d5368655()}isTransformationChanged(){let t=$5c473edaf09eadd3$export$f0954fd7d5368655(),e=Object.keys(t);for(let i=0;i<e.length;i++){let s=e[i];if(t[s]!==this.transform[s])return!0}return!1}reset(){this.transform=$5c473edaf09eadd3$export$f0954fd7d5368655(),this.selection=[],this.selectionBounds={x1:0,y1:0,x2:0,y2:0}}translate(t){this.transform=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(t.x,t.y),this.transform)}center(t,e){let i={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},s=$855520c81dfcb96a$export$9b20165a36586806(this.transform,i);this.transform=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(t-s.x,e-s.y),this.transform)}flip(t){let e={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},i=$855520c81dfcb96a$export$9b20165a36586806(this.transform,e);this.transform=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(i.x,i.y),$a78c550eaaca7cca$export$dcdf75081b88279d("x"===t?-1:1,"y"===t?-1:1),$cf0617f9860dc277$export$d73ee8ef04f5226a(-i.x,-i.y),this.transform)}scale(t){let e={x:(this.selectionBounds.x1+this.selectionBounds.x2)/2,y:(this.selectionBounds.y1+this.selectionBounds.y2)/2},i=$855520c81dfcb96a$export$9b20165a36586806(this.transform,e);this.transform=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(i.x,i.y),$a78c550eaaca7cca$export$dcdf75081b88279d(t),$cf0617f9860dc277$export$d73ee8ef04f5226a(-i.x,-i.y),this.transform)}setDoClone(t){this.doClone=t}getDoClone(){return this.doClone}getTransform(){return this.transform}setTransform(t){this.transform=t}getTransformedSelection(){return $1d9e27e0466b80f7$export$aa391dbbf8073422(this.selection,this.getTransform())}setSelectionSample(t){this.selectionSample=t}setAlgorithm(t){this.algorithm=t}getAlgorithm(){return this.algorithm}createComposite(t){let e=(0,$aXq9D.getSelectionPath2d)(this.selection),i=this.getTransform();return{draw:s=>{if(s.save(),$6dd27963ff379fef$export$a8cb0d8fd60b16e8(s,this.algorithm),this.selectionSample&&this.doClone){if(this.selectionSample.image){s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i)),s.clip(e);let t=$611d5fdbbcda65d9$export$f672e0b6f7222cd7(i,this.selectionSample.transformation);s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(t)),s.drawImage(this.selectionSample.image,0,0)}}else this.doClone||(s.save(),s.clip(e),this.backgroundIsTransparent?s.clearRect(0,0,t.width,t.height):(s.globalCompositeOperation="source-in",s.fillStyle="#fff",s.fillRect(0,0,t.width,t.height)),s.restore()),s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i)),s.clip(e),s.drawImage(t,0,0);s.restore()}}}createSourceComposite(t){let e=(0,$aXq9D.getSelectionPath2d)(this.selection);if(!this.doClone)return{draw:i=>{i.save(),$6dd27963ff379fef$export$a8cb0d8fd60b16e8(i,this.algorithm),i.clip(e),this.backgroundIsTransparent?i.clearRect(0,0,t.width,t.height):(i.globalCompositeOperation="source-in",i.fillStyle="#fff",i.fillRect(0,0,t.width,t.height)),i.restore()}}}createTargetComposite(t){let e=(0,$aXq9D.getSelectionPath2d)(this.selection),i=this.getTransform();return{draw:s=>{if(s.save(),$6dd27963ff379fef$export$a8cb0d8fd60b16e8(s,this.algorithm),this.selectionSample&&this.doClone){if(this.selectionSample.image){s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i)),s.clip(e);let t=$611d5fdbbcda65d9$export$f672e0b6f7222cd7(i,this.selectionSample.transformation);s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(t)),s.drawImage(this.selectionSample.image,0,0)}}else s.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i)),s.clip(e),s.drawImage(t,0,0);s.restore()}}}constructor(){this.selection=[],this.selectionBounds={},this.transform={},this.doClone=!1,this.backgroundIsTransparent=!1,this.algorithm="smooth"}}function $4c7f3f5331b420df$var$transformFreeTransformViaMatrix(t,e){let i=t.width,s=t.height,n=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($cf0617f9860dc277$export$d73ee8ef04f5226a(t.x,t.y),$20520e5c69c4ad5d$export$bb628a54ab399bc9(t.angleDeg/180*Math.PI)),r=$855520c81dfcb96a$export$9b20165a36586806(e,t),a=$855520c81dfcb96a$export$9b20165a36586806(n,{x:0,y:1}),o=$855520c81dfcb96a$export$9b20165a36586806(e,a),l=(0,$8cWis.pointsToAngleDeg)(r,o)-90,h=$855520c81dfcb96a$export$9b20165a36586806(n,{x:-i/2,y:-s/2}),c=$855520c81dfcb96a$export$9b20165a36586806(n,{x:i/2,y:-s/2}),d=$855520c81dfcb96a$export$9b20165a36586806(n,{x:-i/2,y:s/2}),p=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($20520e5c69c4ad5d$export$bb628a54ab399bc9(-l/180*Math.PI,r.x,r.y),e),u=$855520c81dfcb96a$export$9b20165a36586806(p,h),g=$855520c81dfcb96a$export$9b20165a36586806(p,c),m=$855520c81dfcb96a$export$9b20165a36586806(p,d),f=g.x-u.x,y=m.y-u.y;return{x:r.x,y:r.y,width:Math.round(f),height:Math.round(y),angleDeg:l}}let $4c7f3f5331b420df$var$modeToCursor={select:"default",transform:"move"},$4c7f3f5331b420df$var$operationToCursor={new:"default",union:"copy",difference:"alias"};class $4c7f3f5331b420df$export$24961ed376c522a3{viewportToCanvas(t){return $855520c81dfcb96a$export$9b20165a36586806($077740f52fe6870e$export$70ae2c07e401031b($00bfc001d6438b5d$export$ad1d215dd03fe75a(this.easel.getTransform())),t)}updateSelectionPath(){this.selectionPath=(0,$aXq9D.getSelectionPath2d)(this.canvasSelection)}resetPolyShape(){return 0!==this.polyShape.length&&(this.polyShape=[],this.doubleTapPointerTypes=["touch"],this.easel.updateDoubleTapPointerTypes(),this.easel.requestRender(),!0)}getEffectiveBooleanOperation(){let t="new"===this.defaultBooleanOperation?this.easel.keyListener.isPressed("alt"):"difference"===this.defaultBooleanOperation,e="new"===this.defaultBooleanOperation?this.easel.keyListener.isPressed("shift"):"union"===this.defaultBooleanOperation;return t?"difference":e?"union":"new"}getDoMoveSelection(t,e){let i=this.polyShape.length<2&&this.selectionPath&&this.tempCtx.isPointInPath(this.selectionPath,e.x,e.y);return"new"===t&&i}selectOnPointer(t){var e,i,s;let n=this.getEffectiveBooleanOperation(),r=this.isDragging,a=this.viewportToCanvas({x:t.relX,y:t.relY}),o=this.getDoMoveSelection(n,a);if("pointerdown"===t.type&&(this.isDragging=!0,o?this.selectSelectMode="move":this.selectSelectMode="select"),"pointerup"===t.type&&(this.isDragging=!1),"move"===this.selectSelectMode)"pointerdown"===t.type&&"left"===t.button&&(this.didSelectionMove=!1,this.onStartMoveSelect(a)),"pointermove"===t.type&&"left"===t.button&&(this.didSelectionMove=!0,this.onGoMoveSelect(a)),"pointerup"===t.type&&(this.onEndMoveSelect(),this.didSelectionMove||this.onResetSelection());else if("poly"===this.selectShape){if("pointermove"===t.type&&((null==(e=this.polyShape[this.polyShape.length-1])?void 0:e.temp)&&this.polyShape.pop(),this.polyShape.push((0,$9FMZM._)((0,$wpIFA._)({},a),{temp:!0})),this.easel.requestRender()),"pointerup"===t.type&&r){this.polyShape.length<2&&(this.appliedBooleanOperation=n),this.doubleTapPointerTypes=[],this.easel.updateDoubleTapPointerTypes(),(null==(i=this.polyShape[this.polyShape.length-1])?void 0:i.temp)&&this.polyShape.pop();let t=this.polyShape[this.polyShape.length-1];t&&a.x===t.x&&a.y===t.y||(this.polyShape.push(a),this.easel.requestRender());let e=this.polyShape[0],s=this.polyShape[this.polyShape.length-1];if(this.polyShape.length>2&&$2Eggz.BB.dist(e.x,e.y,s.x,s.y)*this.viewportTransform.scale<4){this.polyShape.pop(),this.polyShape.push((0,$wpIFA._)({},this.polyShape[0]));let t=this.polyShape;this.polyShape=[],this.onSelectAddPoly(t,this.appliedBooleanOperation),this.appliedBooleanOperation=void 0}}}else"pointerdown"===t.type&&"left"===t.button&&(this.appliedBooleanOperation=n,this.onStartSelect(a,this.appliedBooleanOperation)),"pointermove"===t.type&&"left"===t.button&&this.isDragging&&this.onGoSelect(a),"pointerup"===t.type&&r&&(this.onEndSelect(),this.appliedBooleanOperation=void 0);t.button||(o?this.selectSelectMode="move":this.selectSelectMode="select"),"move"===this.selectSelectMode?this.easel.setCursor("move"):this.easel.setCursor($4c7f3f5331b420df$var$operationToCursor[null!=(s=this.appliedBooleanOperation)?s:n])}transformOnPointer(t){this.easel.setCursor("default")}onPointerChainOut(t){"select"===this.mode?(this.cornerPanning.onPointer(t),this.selectOnPointer(t)):this.transformOnPointer(t)}createFreeTransform(){let t=!0;this.freeTransform=new $d42d1384577ab84d$export$79a74567acf241b0({x:1,y:1,width:1,height:1,angleDeg:0,isConstrained:this.freeTransformIsConstrained,snapX:[],snapY:[],viewportTransform:{scale:1,x:0,y:0,angleDeg:0},callback:e=>{if(t){t=!1;return}if(!this.selection||"select"===this.mode||!this.selectionBounds)return;let i=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($b856d19f26b0608b$export$e464a809f7257768(e,this.selectionBounds),$077740f52fe6870e$export$70ae2c07e401031b(this.initialTransformMatrix));this.onFreeTransform(i)},onWheel:this.easel.onWheel,wheelParent:this.easel.getElement()}),this.freeTransform.setSnapping(this.freeTransformIsSnapping),this.htmlEl.append(this.freeTransform.getElement()),this.freeTransform.setViewportTransform(this.viewportTransform)}destroyFreeTransform(){var t,e;null==(t=this.freeTransform)||t.getElement().remove(),null==(e=this.freeTransform)||e.destroy(),this.freeTransform=void 0}getSvgElement(){return this.svgEl}getHtmlOverlayElement(){return this.htmlEl}onPointer(t){this.onPointerChainOut(t),this.pointerChain.chainIn(t)}setEaselInterface(t){this.easel=t,this.viewportTransform=this.easel.getTransform()}setMode(t){this.mode=t,this.resetPolyShape(),"transform"===this.mode?this.createFreeTransform():this.destroyFreeTransform()}onTool(t){"select"===t?this.htmlEl.style.display="block":this.htmlEl.style.display="none"}activate(t,e){this.easel.setCursor($4c7f3f5331b420df$var$modeToCursor[this.mode]),this.isDragging=!1,this.onUpdateTransform(this.easel.getTransform()),e||this.resetPolyShape()}onUpdateTransform(t){var e;this.viewportTransform=t,this.updateSelectionPath(),null==(e=this.freeTransform)||e.setViewportTransform(t)}onUpdateSelection(t){this.canvasSelection=t||[],this.updateSelectionPath()}setRenderedSelection(t){this.selection=t,this.easel.setRenderedSelection(t)}updateInitialTransformMatrix(){if(!this.freeTransform)return;let t=this.freeTransform.getValue();this.initialFreeTransform=t,this.initialTransformMatrix=$b856d19f26b0608b$export$e464a809f7257768(t,this.selectionBounds)}initialiseTransform(t){var e,i;this.selectionBounds={x1:0,y1:0,x2:t.x2-t.x1,y2:t.y2-t.y1};let s=(0,$8cWis.boundsToRect)(t,!1);null==(e=this.freeTransform)||e.initialise({x:s.x+s.width/2,y:s.y+s.height/2,width:s.width,height:s.height,angleDeg:0});let{width:n,height:r}=this.easel.getProjectSize();null==(i=this.freeTransform)||i.setSnappingPoints([0,n],[0,r]),this.updateInitialTransformMatrix()}setTransform(t){var e;let i=$4c7f3f5331b420df$var$transformFreeTransformViaMatrix(this.initialFreeTransform,t);null==(e=this.freeTransform)||e.initialise(i)}clearRenderedSelection(t){this.easel.clearRenderedSelection(t)}setBooleanOperation(t){this.defaultBooleanOperation=t}setSelectShape(t){this.resetPolyShape(),this.selectShape=t}getIsLocked(){return this.isDragging}renderAfterViewport(t,e){if(this.polyShape.length<2)return;t.save(),t.globalCompositeOperation="difference",t.beginPath();let i=this.polyShape;t.moveTo(i[0].x,i[0].y);for(let e=1;e<i.length;e++)t.lineTo(i[e].x,i[e].y);t.lineWidth=1/e.scaleX,t.strokeStyle="white",t.lineCap="round",t.lineJoin="round",t.stroke(),t.restore()}onKeyDown(t,e){"esc"===t&&this.resetPolyShape()&&e.preventDefault()}onClickOutside(){this.resetPolyShape()}onBlur(){this.resetPolyShape()}onArrowKeys(t){if(!this.freeTransform)return!1;let e={x:0,y:0};return"left"===t&&(e={x:-1,y:0}),"right"===t&&(e={x:1,y:0}),"up"===t&&(e={x:0,y:-1}),"down"===t&&(e={x:0,y:1}),this.easel.isKeyPressed("shift")&&(e.x*=5,e.y*=5),this.freeTransform.move(e.x,e.y),!0}setIsConstrained(t){var e;this.freeTransformIsConstrained=t,null==(e=this.freeTransform)||e.setIsConstrained(t)}setIsSnapping(t){var e;this.freeTransformIsSnapping=t,null==(e=this.freeTransform)||e.setSnapping(t)}getFreeTransformTransformation(){var t;return null==(t=this.freeTransform)?void 0:t.getValue()}rotateFreeTransform(t){if(!this.freeTransform||!this.selectionBounds)return;let e=(this.freeTransform.getValue().angleDeg+t)%360;this.freeTransform.setAngleDeg(e);let i=$611d5fdbbcda65d9$export$f672e0b6f7222cd7($b856d19f26b0608b$export$e464a809f7257768(this.freeTransform.getValue(),this.selectionBounds),$077740f52fe6870e$export$70ae2c07e401031b(this.initialTransformMatrix));this.onFreeTransform(i)}constructor(t){this.easel={},this.viewportTransform={},this.tempCtx=$2Eggz.BB.ctx($2Eggz.BB.canvas(1,1)),this.canvasSelection=[],this.selectionPath=(0,$aXq9D.getSelectionPath2d)([]),this.mode="select",this.isDragging=!1,this.selectSelectMode="select",this.didSelectionMove=!1,this.defaultBooleanOperation="new",this.selectShape="rect",this.polyShape=[],this.initialTransformMatrix={},this.initialFreeTransform={},this.freeTransformIsConstrained=!0,this.freeTransformIsSnapping=!0,this.doubleTapPointerTypes=["touch"],this.blockTrigger="alt",this.mode=t.selectMode,this.onStartSelect=t.onStartSelect,this.onGoSelect=t.onGoSelect,this.onEndSelect=t.onEndSelect,this.onStartMoveSelect=t.onStartMoveSelect,this.onGoMoveSelect=t.onGoMoveSelect,this.onEndMoveSelect=t.onEndMoveSelect,this.onSelectAddPoly=t.onSelectAddPoly,this.onResetSelection=t.onResetSelection,this.onFreeTransform=t.onFreeTransform,this.cornerPanning=new $065fe39023128955$export$4deed4c512c630c2({getEaselSize:()=>this.easel.getSize(),getTransform:()=>this.easel.getTargetTransform(),setTransform:t=>this.easel.setTransform(t,!0),testCanPan:t=>(t||this.polyShape.length>1)&&("lasso"!==this.selectShape||"select"!==this.selectSelectMode),onRepeatEvent:t=>{"select"===this.mode?this.selectOnPointer(t):this.transformOnPointer(t)}}),this.pointerChain=new(0,$VbzD9.EventChain)({chainArr:[new(0,$lEiB9.DoubleTapper)({onDoubleTap:e=>{if(this.polyShape.length<3)return;let i=this.polyShape.map(t=>({x:t.x,y:t.y}));this.resetPolyShape(),i.length>1&&(i.push((0,$wpIFA._)({},i[0])),t.onSelectAddPoly(i,this.appliedBooleanOperation))},isInstant:!0})]}),this.svgEl=$2Eggz.BB.createSvg({elementType:"g"}),this.htmlEl=$2Eggz.BB.el()}}var $VM6dD=parcelRequire("VM6dD");function $5af8531f823a0d35$export$1b1b9d54d324857f(t,e,i,s,n){let r=[],a=2*Math.PI/n;for(let n=0;n<2*Math.PI;n+=a)r.push([Math.cos(n)*i+t,Math.sin(n)*s+e]);return[r]}var $2Eggz=parcelRequire("2Eggz");let $baef18034167f5fc$export$6f71e8a0179bd005=2;function $baef18034167f5fc$export$1f0b3b9c2ff2269f(t){return parseFloat(t.toFixed($baef18034167f5fc$export$6f71e8a0179bd005))}function $baef18034167f5fc$export$9ff2e12a5746572e(t){return t.map(t=>t.map(([t,e])=>[$baef18034167f5fc$export$1f0b3b9c2ff2269f(t),$baef18034167f5fc$export$1f0b3b9c2ff2269f(e)]))}class $baef18034167f5fc$export$53d9e71218013355{reset(){this.selection=void 0}combineSelection(t){var e;let i=null!=(e=this.selection)?e:[];return"new"===this.selectOperation?i=[t]:this.selection&&this.selection.length>0?i=$bec2c57bfccd422e$export$7ec1a3fdd6e82838("difference"===this.selectOperation?"difference":"union",this.selection,t):"union"===this.selectOperation&&(i=[t]),i}getSelection(){let t=this.selection||[];if(this.selectDragInputs.length>1)if(this.selectOperation,"rect"===this.shape){let e=this.selectDragInputs[0],i=this.selectDragInputs[this.selectDragInputs.length-1],s=Math.floor(Math.min(e.x,i.x)),n=Math.floor(Math.min(e.y,i.y)),r=Math.ceil(Math.max(e.x,i.x)),a=Math.ceil(Math.max(e.y,i.y));t=this.combineSelection([[[s,n],[r,n],[r,a],[s,a]]])}else if("ellipse"===this.shape){let e=this.selectDragInputs[0],i=this.selectDragInputs[this.selectDragInputs.length-1],s=(e.x+i.x)/2,n=(e.y+i.y)/2,r=Math.abs(i.x-e.x)/2,a=Math.abs(i.y-e.y)/2;t=this.combineSelection($baef18034167f5fc$export$9ff2e12a5746572e($5af8531f823a0d35$export$1b1b9d54d324857f(s,n,r,a,50)))}else"lasso"===this.shape&&(t=this.combineSelection([this.selectDragInputs.map(t=>[$baef18034167f5fc$export$1f0b3b9c2ff2269f(t.x),$baef18034167f5fc$export$1f0b3b9c2ff2269f(t.y)])]));return 0===t.length?void 0:t}startSelect(t,e){this.selectOperation=e,"new"===this.selectOperation&&this.reset(),this.selectDragInputs=[t]}goSelect(t){this.selectDragInputs.push({x:t.x,y:t.y})}endSelect(){this.selectDragInputs.length>1?this.selection=this.getSelection():this.reset(),this.selectDragInputs=[]}addPoly(t,e){this.selectOperation=e,this.selection=this.combineSelection([t.map(t=>[$baef18034167f5fc$export$1f0b3b9c2ff2269f(t.x),$baef18034167f5fc$export$1f0b3b9c2ff2269f(t.y)])])}startMoveSelect(t){this.moveLastPos=t,this.didMove=!1}goMoveSelect(t){if(!this.moveLastPos)return;this.didMove=!0;let e=Math.round(t.x-this.moveLastPos.x),i=Math.round(t.y-this.moveLastPos.y);this.selection&&(this.selection=$b5fa43d1e9c9aab9$export$199acb5b15c43176(this.selection,e,i)),this.moveLastPos={x:this.moveLastPos.x+e,y:this.moveLastPos.y+i}}endMoveSelect(){this.moveLastPos=void 0}getDidMove(){return this.didMove}selectAll(){this.reset();let t=this.klCanvas.getWidth(),e=this.klCanvas.getHeight();this.selection=[[[[0,0],[t,0],[t,e],[0,e],[0,0]]]]}invertSelection(){var t;let e=null!=(t=this.selection)?t:[],i=this.klCanvas.getWidth(),s=this.klCanvas.getHeight();this.selection=$bec2c57bfccd422e$export$7ec1a3fdd6e82838("difference",[[[0,0],[i,0],[i,s],[0,s]]],e)}setShape(t){this.shape=t}getShape(){return this.shape}setSelection(t){this.selection=t?$2Eggz.BB.copyObj(t).map($baef18034167f5fc$export$9ff2e12a5746572e):void 0}constructor(t){this.shape="rect",this.selectOperation="new",this.selectDragInputs=[],this.didMove=!1,this.klCanvas=t.klCanvas}}var $8cWis=parcelRequire("8cWis"),$wpIFA=parcelRequire("wpIFA"),$9FMZM=parcelRequire("9FMZM"),$8cWis=parcelRequire("8cWis");function $a7ff30e5e74c6b7d$export$a70ad15f9d5e7f79(t){if(t.image)return(0,$8cWis.integerBounds)($bc9f0500a48e5dd5$export$7efa1f930df882cc({x1:0,y1:0,x2:t.image.width,y2:t.image.height},t.transformation))}var $2Eggz=parcelRequire("2Eggz"),$aXq9D=parcelRequire("aXq9D");function $6941d465213761e0$var$createSelectionSample(t,e){let i=e.getLayersRaw()[t],s=$273e2af276df50c0$export$6be4733fa804854c(e.getSelectionOrFallback(),i.context);if(!s)return{image:void 0,transformation:$5c473edaf09eadd3$export$f0954fd7d5368655()};let n=$2Eggz.BB.canvas(s.width,s.height),r=$2Eggz.BB.ctx(n);return r.save(),r.translate(-s.x,-s.y),r.drawImage(i.canvas,0,0),r.restore(),{image:n,transformation:$cf0617f9860dc277$export$d73ee8ef04f5226a(s.x,s.y)}}function $6941d465213761e0$var$transformSelectionAndSample(t,e,i){return{selection:i?$1d9e27e0466b80f7$export$aa391dbbf8073422(i,t):void 0,selectionSample:(0,$9FMZM._)((0,$wpIFA._)({},e),{transformation:$611d5fdbbcda65d9$export$f672e0b6f7222cd7([t,e.transformation])})}}function $6941d465213761e0$var$drawSelectionSample(t,e,i,s){if(!i.image)return;let n=s.getLayersRaw()[t],r=$2Eggz.BB.ctx(n.canvas),a=s.getSelectionOrFallback(),o=(0,$aXq9D.getSelectionPath2d)(a);r.save(),r.clip(o),r.setTransform(...$974f651610599156$export$2b60e7dafdbde18a(i.transformation)),$6dd27963ff379fef$export$a8cb0d8fd60b16e8(r,e?"pixelated":"smooth"),r.drawImage(i.image,0,0),r.restore()}function $6941d465213761e0$export$1653b9fe2026bf29(t){var e,i;let s=t.klCanvas.getKlHistory(),n=t.klCanvas.getLayersRaw();s.pause(!0);let r=$6941d465213761e0$var$createSelectionSample(t.sourceLayer,t.klCanvas),a=$a7ff30e5e74c6b7d$export$a70ad15f9d5e7f79(r);t.klCanvas.eraseLayer({layerIndex:t.sourceLayer,useSelection:!0,useAlphaLock:0===t.sourceLayer&&!t.backgroundIsTransparent});let o=$6941d465213761e0$var$transformSelectionAndSample(t.transformation,r,t.klCanvas.getSelection());r=o.selectionSample,t.klCanvas.setSelection(o.selection);let l=$a7ff30e5e74c6b7d$export$a70ad15f9d5e7f79(r);$6941d465213761e0$var$drawSelectionSample(null!=(e=t.targetLayer)?e:t.sourceLayer,null!=(i=t.isPixelated)&&i,r,t.klCanvas),s.pause(!1);let h=!t.targetLayer||t.sourceLayer===t.targetLayer;if(!s.isPaused()){let e=n[t.sourceLayer],i=void 0!==t.targetLayer&&t.targetLayer!==t.sourceLayer?n[t.targetLayer]:void 0;s.push({selection:{value:t.klCanvas.getSelection()},layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(n,{layerId:e.id,attributes:["tiles"],bounds:h?$2Eggz.BB.updateBounds(a,l):a},i?{layerId:i.id,attributes:["tiles"],bounds:l}:void 0)})}return r}function $6941d465213761e0$export$97eaf46efcb3997(t){var e;let i=t.klCanvas.getKlHistory(),s=t.klCanvas.getLayersRaw(),n=t.selectionSample;if(i.pause(!0),!n){if(void 0===t.sourceLayer)throw Error("no source layer");n=$6941d465213761e0$var$createSelectionSample(t.sourceLayer,t.klCanvas)}let r=$6941d465213761e0$var$transformSelectionAndSample(t.transformation,n,t.klCanvas.getSelection());n=r.selectionSample,t.klCanvas.setSelection(r.selection),$6941d465213761e0$var$drawSelectionSample(t.targetLayer,null!=(e=t.isPixelated)&&e,n,t.klCanvas);let a=$a7ff30e5e74c6b7d$export$a70ad15f9d5e7f79(n);if(i.pause(!1),!i.isPaused()&&a){let e=s[t.targetLayer];i.push({selection:{value:t.klCanvas.getSelection()},layerMap:$52ec11e106a92aac$export$7cefb04ac49374c4(s,{layerId:e.id,attributes:["tiles"],bounds:a})})}return n}var $2Eggz=parcelRequire("2Eggz");function $9f442e11ca4a81af$var$isSelectTransformTempEntry(t){return"select-transform"===t.type&&!!t.data}class $9f442e11ca4a81af$export$e471993a29671b7{isSourceLayerBackgroundTransparent(){let t=this.getCurrentLayerCtx();return(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(t.canvas))>0||this.backgroundIsTransparent}resetComposites(){let t=this.getCurrentLayerCtx(),e=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(t.canvas));this.klCanvas.setComposite(e,void 0),this.targetLayerIndex!==e&&this.klCanvas.setComposite(this.targetLayerIndex,void 0)}updateComposites(){let t=this.getCurrentLayerCtx().canvas,e=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(t));e===this.targetLayerIndex?this.klCanvas.setComposite(e,this.transformTool.createComposite(t)):(this.klCanvas.setComposite(e,this.transformTool.createSourceComposite(t)),this.klCanvas.setComposite(this.targetLayerIndex,this.transformTool.createTargetComposite(t)))}updateUiLayerList(){this.selectUi.setLayers(this.klCanvas.getLayers().map(t=>t.name))}resetSelection(){this.selectTool.reset();let t=this.selectTool.getSelection();this.klCanvas.setSelection(t),this.selectUi.setHasSelection(!!t)}tempHistoryReplaceTop(){this.tempHistory.replaceTop({type:"select-transform",data:{transform:this.transformTool.getTransform(),doClone:this.transformTool.getDoClone(),targetLayerIndex:this.targetLayerIndex,backgroundIsTransparent:this.backgroundIsTransparent,algorithm:this.transformTool.getAlgorithm()}})}propagateTransformationChange(){let t=this.transformTool.getTransformedSelection();this.easelSelect.setRenderedSelection(t),this.updateComposites(),this.onUpdateProject(),this.updateSelectUi(),this.tempHistoryReplaceTop()}updateSelectUi(){let t=this.easelSelect.getFreeTransformTransformation();t&&this.selectUi.setFreeTransformTransformation(t)}getSelectUi(){return this.selectUi}getEaselSelect(){return this.easelSelect}commitTransform(){let t=!1;return"transform"===this.selectMode&&(this.selectUi.setMode("select"),t=!0),t}discardTransform(){if("transform"===this.selectMode){this.transformTool.reset(),this.transformTool.setDoClone(!1);let t=this.getCurrentLayerCtx().canvas;return this.targetLayerIndex=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(t)),this.selectUi.setMode("select"),!0}return!1}onHistory(t){if("undo"===t)this.selectUi.setMode("select");else if("tempUndo"===t||"tempRedo"===t){this.resetComposites();let t=this.tempHistory.getEntries().at(-1),e=(0,$9FMZM._)((0,$wpIFA._)({},this.initialTransform),{doClone:this.transformTool.getDoClone()});t&&$9f442e11ca4a81af$var$isSelectTransformTempEntry(t)&&(e=t.data),this.transformTool.setTransform(e.transform),this.transformTool.setDoClone(e.doClone),this.targetLayerIndex=e.targetLayerIndex,this.backgroundIsTransparent=e.backgroundIsTransparent,this.selectUi.setBackgroundIsTransparent(e.backgroundIsTransparent),this.transformTool.setBackgroundIsTransparent(this.isSourceLayerBackgroundTransparent()),this.selectUi.setAlgorithm(e.algorithm),this.transformTool.setAlgorithm(e.algorithm);let i=this.transformTool.getTransformedSelection();this.easelSelect.setRenderedSelection(i),this.easelSelect.setTransform(this.transformTool.getTransform()),this.selectUi.setMoveToLayer(this.klCanvas.getLayerIndex(this.getCurrentLayerCtx().canvas)===e.targetLayerIndex?void 0:e.targetLayerIndex),this.updateComposites(),this.onUpdateProject()}}destroy(){}constructor(t){this.selectMode="select",this.targetLayerIndex=0,this.initialTransform={transform:$5c473edaf09eadd3$export$f0954fd7d5368655(),doClone:!1,targetLayerIndex:0,backgroundIsTransparent:!1,algorithm:"smooth"},this.backgroundIsTransparent=!1,this.selectionSample=void 0,this.klCanvas=t.klCanvas,this.onUpdateProject=t.onUpdateProject,this.getCurrentLayerCtx=t.getCurrentLayerCtx,this.klHistory=t.klHistory,this.tempHistory=t.tempHistory,this.statusOverlay=t.statusOverlay,this.onFill=t.onFill,this.onErase=t.onErase,this.klHistory.addListener(()=>{this.selectUi.setHasSelection(!!this.klCanvas.getSelection()),"transform"===this.selectMode&&this.updateUiLayerList()}),this.selectTool=new $baef18034167f5fc$export$53d9e71218013355({klCanvas:this.klCanvas}),this.transformTool=new $b856d19f26b0608b$export$68f5601e78b8ada8,this.easelSelect=new $4c7f3f5331b420df$export$24961ed376c522a3({selectMode:this.selectMode,onStartSelect:(t,e)=>this.selectTool.startSelect(t,e),onGoSelect:t=>{this.selectTool.goSelect(t),this.easelSelect.setRenderedSelection(this.selectTool.getSelection())},onEndSelect:()=>{this.selectTool.endSelect();let t=this.selectTool.getSelection();this.easelSelect.clearRenderedSelection(),this.klCanvas.setSelection(t),this.selectUi.setHasSelection(!!t)},onStartMoveSelect:t=>{this.selectTool.startMoveSelect(t)},onGoMoveSelect:t=>{this.selectTool.goMoveSelect(t),this.easelSelect.setRenderedSelection(this.selectTool.getSelection())},onEndMoveSelect:()=>{if(this.selectTool.endMoveSelect(),!this.selectTool.getDidMove())return;let t=this.selectTool.getSelection();this.easelSelect.clearRenderedSelection(),this.klCanvas.setSelection(t),this.selectUi.setHasSelection(!!t)},onSelectAddPoly:(t,e)=>{this.selectTool.addPoly(t,e);let i=this.selectTool.getSelection();this.klCanvas.setSelection(i),this.selectUi.setHasSelection(!!i)},onResetSelection:()=>this.resetSelection(),onFreeTransform:t=>{this.transformTool.setTransform(t),this.propagateTransformationChange()}}),this.selectUi=new $726e24f56af72b92$export$b3e6ed306341f794({onChangeMode:e=>{if(this.selectMode=e,"select"===this.selectMode){this.tempHistory.clear(),this.tempHistory.setIsActive(!1);let e=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(this.getCurrentLayerCtx().canvas));(this.transformTool.isTransformationChanged()||this.transformTool.getDoClone()||e!==this.targetLayerIndex)&&(this.transformTool.getDoClone()?$6941d465213761e0$export$97eaf46efcb3997({klCanvas:this.klCanvas,selectionSample:this.selectionSample,sourceLayer:e,targetLayer:this.targetLayerIndex,transformation:this.transformTool.getTransform(),isPixelated:"pixelated"===this.transformTool.getAlgorithm()}):$6941d465213761e0$export$1653b9fe2026bf29({klCanvas:this.klCanvas,sourceLayer:e,targetLayer:this.targetLayerIndex,transformation:this.transformTool.getTransform(),backgroundIsTransparent:this.backgroundIsTransparent,isPixelated:"pixelated"===this.transformTool.getAlgorithm()}),t.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("select-transform-applied"),!0)),this.selectionSample=void 0,this.transformTool.setSelectionSample(this.selectionSample),this.klCanvas.setComposite(e,void 0),this.klCanvas.setComposite(this.targetLayerIndex,void 0),this.easelSelect.clearRenderedSelection(!0);let i=this.klCanvas.getSelection();this.selectTool.setSelection(i),this.selectUi.setHasSelection(!!i),this.onUpdateProject(),this.easelSelect.setMode(this.selectMode)}else{this.tempHistory.setIsActive(!0);let t=this.selectTool.getSelection()||[];if(0===t.length){let e=$2Eggz.BB.canvasBounds(this.getCurrentLayerCtx());t=[[[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.height+e.y],[e.x,e.height+e.y],[e.x,e.y]]]]}this.transformTool.setSelection(t),this.transformTool.setDoClone(!1),this.transformTool.setSelectionSample(this.selectionSample);let e=this.getCurrentLayerCtx().canvas,i=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(e));this.initialTransform.targetLayerIndex=i,this.initialTransform.backgroundIsTransparent=this.backgroundIsTransparent,this.initialTransform.algorithm=this.transformTool.getAlgorithm(),this.targetLayerIndex=i;let s=0===i;this.selectUi.setShowTransparentBackgroundToggle(s);let n=!1;s&&(n=$31d0877b7a0bd896$export$d7a217b118c790a6(Object.entries(this.klHistory.getComposed().layerMap).find(([t,e])=>e.index===i)[1]),this.selectUi.setBackgroundIsTransparent(n)),this.backgroundIsTransparent=n,this.initialTransform.backgroundIsTransparent=n,this.transformTool.setBackgroundIsTransparent(this.isSourceLayerBackgroundTransparent()),this.updateComposites(),this.selectUi.setHasSelection(!!t),this.updateUiLayerList(),this.selectUi.setMoveToLayer(void 0),this.onUpdateProject(),this.easelSelect.setMode(this.selectMode);let r=this.transformTool.getTransformedSelection();this.easelSelect.setRenderedSelection(r),this.easelSelect.initialiseTransform((0,$8cWis.integerBounds)($b6390a4afb7d8067$export$a04a50ae6d6450f8(t))),this.updateSelectUi()}},onChangeBooleanOperation:t=>{this.easelSelect.setBooleanOperation(t)},canTransform:()=>{let t=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(this.getCurrentLayerCtx().canvas)),e=!!this.klCanvas.getSelectionArea(t);return e||setTimeout(()=>{$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:$63d0b335c576c718$export$ce37e184d908d785("select-transform-empty"),type:"error"})}),e},select:{shape:this.selectTool.getShape(),onChangeShape:t=>{this.selectTool.setShape(t),this.easelSelect.setSelectShape(t)},onReset:()=>this.resetSelection(),onAll:()=>{this.selectTool.selectAll();let t=this.selectTool.getSelection();this.klCanvas.setSelection(t),this.selectUi.setHasSelection(!!t)},onInvert:()=>{this.selectTool.invertSelection();let t=this.selectTool.getSelection();this.klCanvas.setSelection(t),this.selectUi.setHasSelection(!!t)}},transform:{onFlipY:()=>{this.transformTool.flip("y"),this.propagateTransformationChange(),this.easelSelect.setTransform(this.transformTool.getTransform())},onFlipX:()=>{this.transformTool.flip("x"),this.propagateTransformationChange(),this.easelSelect.setTransform(this.transformTool.getTransform())},onRotateDeg:t=>{this.easelSelect.rotateFreeTransform(t)},onClone:()=>{this.tempHistory.clear();let t=(0,$VM6dD.throwIfNull)(this.klCanvas.getLayerIndex(this.getCurrentLayerCtx().canvas));this.transformTool.getDoClone()?this.selectionSample=$6941d465213761e0$export$97eaf46efcb3997({klCanvas:this.klCanvas,selectionSample:this.selectionSample,sourceLayer:t,targetLayer:this.targetLayerIndex,transformation:this.transformTool.getTransform(),isPixelated:"pixelated"===this.transformTool.getAlgorithm()}):this.transformTool.isTransformationChanged()&&(this.selectionSample=$6941d465213761e0$export$1653b9fe2026bf29({klCanvas:this.klCanvas,sourceLayer:t,targetLayer:this.targetLayerIndex,transformation:this.transformTool.getTransform(),backgroundIsTransparent:this.backgroundIsTransparent,isPixelated:"pixelated"===this.transformTool.getAlgorithm()}));let e=this.transformTool.getTransformedSelection(),i=this.klCanvas.getSelection()||e;this.initialTransform.backgroundIsTransparent=this.backgroundIsTransparent,this.transformTool.setSelection(i),this.transformTool.setDoClone(!0),this.transformTool.setSelectionSample(this.selectionSample),this.updateComposites(),this.easelSelect.setRenderedSelection(this.transformTool.getTransformedSelection()),this.easelSelect.updateInitialTransformMatrix(),this.selectUi.setHasSelection(!!i),this.onUpdateProject(),this.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("select-transform-clone-applied"),!0)},onScale:t=>{this.transformTool.scale(t),this.propagateTransformationChange(),this.easelSelect.setTransform(this.transformTool.getTransform())},onCenter:()=>{this.transformTool.center(this.klCanvas.getWidth()/2,this.klCanvas.getHeight()/2),this.propagateTransformationChange(),this.easelSelect.setTransform(this.transformTool.getTransform())},onMoveToLayer:t=>{this.resetComposites(),this.targetLayerIndex=t,this.updateComposites(),this.onUpdateProject(),this.tempHistoryReplaceTop()},onChangeTransparentBackground:t=>{this.backgroundIsTransparent=t,this.transformTool.setBackgroundIsTransparent(this.isSourceLayerBackgroundTransparent()),this.updateComposites(),this.onUpdateProject(),this.tempHistoryReplaceTop()},onChangeAlgorithm:t=>{this.transformTool.setAlgorithm(t),this.updateComposites(),this.onUpdateProject(),this.tempHistoryReplaceTop()},onChangeConstrain:t=>{this.easelSelect.setIsConstrained(t)},onChangeSnapping:t=>{this.easelSelect.setIsSnapping(t)}},onErase:()=>{this.onErase()},onFill:()=>{this.onFill()}}),this.klHistory.addListener(()=>{let t=this.klCanvas.getSelection();"select"===this.selectMode&&this.selectTool.setSelection(t)})}}class $444b5d8ddd6258bc$export$ab82e91194f5da86{emit(t){this.listeners.forEach(e=>e(t))}push(t){this.currentIndex<this.entries.length-1&&this.entries.splice(this.currentIndex+1),this.entries.push(t),this.currentIndex=this.entries.length-1,setTimeout(()=>this.emit("push"))}replaceTop(t){this.entries.splice(this.currentIndex),this.entries.push(t),this.currentIndex=this.entries.length-1,setTimeout(()=>this.emit("push"))}canDecreaseIndex(){return this.currentIndex>-1}canIncreaseIndex(){return this.currentIndex<this.entries.length-1}decreaseIndex(){this.canDecreaseIndex()&&(this.currentIndex--,setTimeout(()=>this.emit("decrease")))}increaseIndex(){this.canIncreaseIndex()&&(this.currentIndex++,setTimeout(()=>this.emit("increase")))}getEntries(){return this.entries.slice(0,this.currentIndex+1)}clear(){this.entries=[],this.currentIndex=-1,setTimeout(()=>this.emit("clear"))}addListener(t){this.listeners.includes(t)||this.listeners.push(t)}removeListener(t){this.listeners.map((e,i)=>{e===t&&this.listeners.splice(i,1)})}setIsActive(t){this.isActive!==t&&(this.isActive=t,this.emit("active"))}getIsActive(){return this.isActive}constructor(){this.entries=[],this.currentIndex=-1,this.listeners=[],this.isActive=!1}}var $2Eggz=parcelRequire("2Eggz"),$VM6dD=parcelRequire("VM6dD");class $a5b80f2248448743$export$3e66e8feec69f8d{constructor(){if(!("visualViewport"in window)||null===visualViewport)return;let t=visualViewport,e=!1,i=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("browser-zoom-help"),className:"kl-pinch-overlay",css:{position:"fixed",pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"100",flexDirection:"column",gap:"10px",padding:"10px",backdropFilter:"blur(3px)"}});$2Eggz.BB.el({parent:i,tagName:"button",content:$63d0b335c576c718$export$ce37e184d908d785("dismiss"),onClick:()=>{e=!0,s.remove(),i.remove()},css:{pointerEvents:"initial"}});let s=$2Eggz.BB.el({tagName:"iframe",css:{position:"fixed",width:"100vw",height:"100vh",zIndex:"99",opacity:"0"}}),n=!1;function r(){if(e)return;let r=$2Eggz.BB.el({parent:document.body,css:{position:"fixed",inset:"0",zIndex:"-1"}}),a=r.getBoundingClientRect();r.remove();let o=(t.width!==Math.round(a.width)||t.height!==Math.round(a.height))&&t.scale>1;o?((0,$VM6dD.css)(i,{left:t.offsetLeft+"px",top:t.offsetTop+"px",width:t.width+"px",height:t.height+"px"}),n||(document.body.append(s),document.body.append(i))):n&&(s.remove(),i.remove()),n=o}t.addEventListener("resize",r),t.addEventListener("scroll",r),setTimeout(r)}}class $22677d38776ea068$export$cb9945923eaef1dd{testShouldSkip(){return!!this.doIgnore||(this.doIgnore=!0,setTimeout(()=>{this.doIgnore=!1},0),!1)}canUndo(){return this.tempHistory.getIsActive()&&this.tempHistory.canDecreaseIndex()||this.klHistory.canUndo()}canRedo(){return this.tempHistory.getIsActive()?this.tempHistory.canIncreaseIndex():this.klHistory.canRedo()}undo(){return this.testShouldSkip()?void 0:this.tempHistory.getIsActive()&&this.tempHistory.canDecreaseIndex()?(this.tempHistory.decreaseIndex(),{type:"tempUndo"}):this.klHistory.canUndo()?(this.klHistory.decreaseIndex(),{type:"undo"}):void 0}redo(){return this.testShouldSkip()?void 0:this.tempHistory.getIsActive()&&this.tempHistory.canIncreaseIndex()?(this.tempHistory.increaseIndex(),{type:"tempRedo"}):this.klHistory.canRedo()?(this.klHistory.increaseIndex(),{type:"redo"}):void 0}constructor(t){this.doIgnore=!1,this.lastCanUndo=!1,this.lastCanRedo=!1,this.klHistory=t.klHistory,this.tempHistory=t.tempHistory,this.onCanUndoRedoChange=t.onCanUndoRedoChange;let e=()=>{let t=this.canUndo(),e=this.canRedo();(this.lastCanUndo!==t||this.lastCanRedo!==e)&&(this.lastCanUndo=t,this.lastCanRedo=e,this.onCanUndoRedoChange(t,e))};this.klHistory.addListener(e),this.tempHistory.addListener(e)}}function $4b95c7d5307dee66$export$beb462111ff337c5(t){let e=Object.keys(t);return 1===e.length&&"activeLayerId"===e[0]}var $2Eggz=parcelRequire("2Eggz"),$dGRuJ=parcelRequire("dGRuJ"),$VM6dD=parcelRequire("VM6dD");class $0497dee7143bcf86$export$38b681d46b785af1{update(){this.isVisible?(this.toolspaceIsOpen?(this.mobileWrapperEl.style.display="none","left"===this.orientation?(0,$VM6dD.css)(this.rootEl,{left:"271px",right:""}):(0,$VM6dD.css)(this.rootEl,{left:"",right:"271px"})):(this.mobileWrapperEl.style.display="flex","left"===this.orientation?(0,$VM6dD.css)(this.rootEl,{left:"0",right:""}):(0,$VM6dD.css)(this.rootEl,{left:"",right:"0"})),this.rootEl.style.display="block"):this.rootEl.style.display="none"}setOrientation(t){this.orientation=t,this.toolspaceCollapser.setOrientation(t)}setIsVisible(t){this.isVisible=t}getToolspaceIsOpen(){return this.toolspaceIsOpen}setToolspaceIsOpen(t){this.toolspaceIsOpen=t,this.toolspaceCollapser.setIsOpen(t),this.onShowToolspace(t)}getElement(){return this.rootEl}constructor(t){this.toolspaceIsOpen=!0,this.orientation="right",this.isVisible=!1,this.onShowToolspace=t.onShowToolspace,this.toolspaceCollapser=new $49faab2330529a96$export$6e4a713ddcda1e5e.ToolspaceCollapser({onChange:()=>{this.toolspaceIsOpen=this.toolspaceCollapser.isOpen(),this.onShowToolspace(this.toolspaceIsOpen),this.toolspaceIsOpen?$dGRuJ.LocalStorage.removeItem("uiShowMobile"):$dGRuJ.LocalStorage.setItem("uiShowMobile","true")}}),this.mobileWrapperEl=$2Eggz.BB.el({css:{marginTop:"4px",display:"flex",flexDirection:"column",gap:"4px"}}),this.mobileWrapperEl.append(...t.toolUis),this.rootEl=$2Eggz.BB.el({css:{position:"absolute",top:"0",userSelect:"none"}}),this.rootEl.append(this.toolspaceCollapser.getElement(),this.mobileWrapperEl),this.update()}}var $2Eggz=parcelRequire("2Eggz");class $690058b3c2558cac$export$87fd7552ee5cd26e{setIsVisible(t){this.rootEl.style.display=t?"block":"none"}setType(t){this.brushOptions.setValue(t,!0)}getElement(){return this.rootEl}constructor(t){let e=new $d49d366dcf65e875$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($4933c2551a80d49a$exports),width:28,height:28,darkInvert:!0,css:{margin:"4px"}}),i=new $d49d366dcf65e875$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($224bfe309e7ff70b$exports),width:28,height:28,darkInvert:!0,css:{margin:"4px"}});this.brushOptions=new $1166276dc18d3ea9$export$c019608e5b5bb4cb({optionArr:[{id:"brush",label:e.getElement(),title:$63d0b335c576c718$export$ce37e184d908d785("tool-brush")},{id:"eraser",label:i.getElement(),title:$63d0b335c576c718$export$ce37e184d908d785("eraser")}],initId:"brush",onChange:e=>{"brush"===e?t.onBrush():t.onEraser()},isColumn:!0}),this.rootEl=$2Eggz.BB.el({css:{}}),this.rootEl.append(this.brushOptions.getElement())}}var $ao0qX=parcelRequire("ao0qX"),$2Eggz=parcelRequire("2Eggz");function $d45be62ad1325a1c$export$f8f3f96593f6a47(t){let e="",i=Object.fromEntries(t.layers.map((i,s)=>{var n;e=$07b32ff703dd0314$export$b2ce7a8a096070e2();let r=[];return r=i.image instanceof Array?[...i.image]:$a262f7e0a9f5e4af$export$7b1ba44282f9a519((()=>{if(i.image instanceof HTMLCanvasElement)return i.image;let e=$2Eggz.BB.canvas(t.width,t.height),s=$2Eggz.BB.ctx(e);return $15ded6c5722f2bc8$export$dba0834b723f37f4(i.image)?(s.fillStyle=i.image.fill,s.fillRect(0,0,t.width,t.height)):s.drawImage(i.image,0,0),e})()),[e,{name:i.name,opacity:i.opacity,isVisible:i.isVisible,mixModeStr:null!=(n=i.mixModeStr)?n:"source-over",index:s,tiles:r}]}));return{projectId:{value:t.projectId},size:{width:t.width,height:t.height},selection:{},activeLayerId:e,layerMap:i}}var $VM6dD=parcelRequire("VM6dD");class $8545773f317e59cd$export$747c5e57cda7ca57{update(){let t=this.klHistory.getTotalIndex();this.getLastSavedHistoryIndex()!==t?window.addEventListener("beforeunload",this.onBeforeUnload):window.removeEventListener("beforeunload",this.onBeforeUnload)}destroy(){}constructor(t){this.onBeforeUnload=t=>{t.preventDefault(),t.returnValue=""},this.klHistory=t.klHistory,this.getLastSavedHistoryIndex=t.getLastSavedHistoryIndex,t.klHistory.addListener(()=>this.update())}}var $2Eggz=parcelRequire("2Eggz");$88c9efa60ac19d5d$export$bb5ee47d9ea2348e="RP219q_banner",$88c9efa60ac19d5d$export$534219b709288da9="RP219q_btn",$88c9efa60ac19d5d$export$8001e369bcc9b474="RP219q_closeArea",$88c9efa60ac19d5d$export$efe229eab43a9869="RP219q_closeButton",$88c9efa60ac19d5d$export$ad430d422a89f9f0="RP219q_mainContent",$88c9efa60ac19d5d$export$48c2d0f2f545ac27="RP219q_preview",$88c9efa60ac19d5d$export$4a3e8128f471434a="RP219q_rightCol",$88c9efa60ac19d5d$export$e8e78c978b129247="RP219q_root";var $VM6dD=parcelRequire("VM6dD");async function $df709f40cddecd59$export$4a2ed1038e76f37f(t){var e;if(!t.projectStore)return;let i=[],s=new $a12bfee0fab37a82$export$84f7c9d87f70395e("kl-tab-communication");{s.subscribe(e=>{"request-project-ids"===e.type&&s.postMessage({type:"response-project-id",id:t.klHistory.getComposed().projectId.value})});let e=t=>{"response-project-id"===t.type&&i.push(t.id)};s.subscribe(e),s.postMessage({type:"request-project-ids"}),await (0,$VM6dD.sleep)(100),s.unsubscribe(e)}if((null==(e=t.klRecoveryManager)?void 0:e.getTabId())!==void 0)return;let n=await t.projectStore.readMeta();if(!n||i.includes(n.projectId))return;let r=(0,$VM6dD.fitInto)(n.thumbnail.width,n.thumbnail.height,100,100);(0,$VM6dD.css)(n.thumbnail,{width:r.width+"px",height:r.height+"px"});let a=$2Eggz.BB.el({tagName:"button",className:$88c9efa60ac19d5d$export$efe229eab43a9869+" popup-x",content:`<img alt="${$63d0b335c576c718$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($f6d60f0cc8cfa5ae$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("modal-close"),custom:{tabindex:"0"}});a.onclick=f;let o=$2Eggz.BB.el({className:$88c9efa60ac19d5d$export$48c2d0f2f545ac27,content:n.thumbnail,title:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open")});o.onclick=()=>{f(),t.onOpenBrowserStorage()};let l=$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("file-storage")}),h=$88c9efa60ac19d5d$export$534219b709288da9,c=$2Eggz.BB.el({tagName:"button",className:["kl-button-primary",h].join(" "),content:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open"),custom:{tabIndex:"-1"}});c.onclick=()=>{f(),t.onOpenBrowserStorage()};let d=$2Eggz.BB.el({className:$88c9efa60ac19d5d$export$4a3e8128f471434a,content:[l,c]}),p=$2Eggz.BB.el({className:$88c9efa60ac19d5d$export$ad430d422a89f9f0,content:[o,d]}),u=$2Eggz.BB.el({className:$88c9efa60ac19d5d$export$8001e369bcc9b474});u.onclick=f;let g=$2Eggz.BB.el({className:$88c9efa60ac19d5d$export$bb5ee47d9ea2348e,content:[u,p,a]});g.onclick=$2Eggz.BB.handleClick;let m=$2Eggz.BB.el({content:[g],className:$88c9efa60ac19d5d$export$e8e78c978b129247});function f(){clearTimeout(y),document.removeEventListener("pointerdown",v),(0,$VM6dD.css)(m,{opacity:"0"}),(0,$VM6dD.css)(g,{pointerEvents:"none"}),setTimeout(()=>{m.remove()},200)}document.body.append(m);let y=setTimeout(f,4500),v=t=>{let e=t.target;g.contains(e)||g.contains(e)||f()};document.addEventListener("pointerdown",v,{passive:!1})}var $wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$wpIFA=parcelRequire("wpIFA"),$2Eggz=parcelRequire("2Eggz"),$8cWis=parcelRequire("8cWis"),$VM6dD=parcelRequire("VM6dD");class $2a29e69ee6709f86$export$a82a053f5f536d09{applyPosition(){let t=this.rootEl.getBoundingClientRect();this.position.x=(0,$8cWis.clamp)(this.position.x,0,window.innerWidth-t.width),this.position.y=(0,$8cWis.clamp)(this.position.y,0,window.innerHeight-t.height),(0,$VM6dD.css)(this.rootEl,{left:this.position.x+"px",top:this.position.y+"px"})}getElement(){return this.rootEl}getPosition(){return(0,$wpIFA._)({},this.position)}destroy(){this.pointerListener.destroy()}constructor(t){this.position=(0,$wpIFA._)({},t.position),this.xButton=$2Eggz.BB.el({tagName:"button",className:"popup-x",content:`<img alt="${$63d0b335c576c718$export$ce37e184d908d785("modal-close")}" height="20" src="${$parcel$interopDefault($f6d60f0cc8cfa5ae$exports)}">`,title:$63d0b335c576c718$export$ce37e184d908d785("modal-close"),noRef:!0,onClick:()=>{t.onClose()},css:{width:"32px",height:"32px",lineHeight:"32px",background:"none",boxShadow:"none"},custom:{tabindex:"0"}});let e=$2Eggz.BB.el({className:"kl-floating-window-header"});e.append(this.xButton);let i=$2Eggz.BB.el({content:t.content}),s={x:0,y:0};this.pointerListener=new $2Eggz.BB.PointerListener({target:e,onPointer:t=>{t.eventPreventDefault(),"left"===t.button&&"pointerdown"===t.type&&(s=(0,$wpIFA._)({},this.position)),"left"===t.button&&"pointermove"===t.type&&(this.position.x=s.x+t.pageX-t.downPageX,this.position.y=s.y+t.pageY-t.downPageY,this.applyPosition())}}),this.rootEl=$2Eggz.BB.el({css:{position:"fixed",display:"flex",flexDirection:"column",left:this.position.x+"px",top:this.position.y+"px"}}),this.rootEl.append(e,i),setTimeout(()=>this.applyPosition())}}class $2099b242ded3a643$export$f27d6e4616dd9b30{getIsEyedropping(){return this.eyedropperToggle.getValue()}setIsEyedropping(t){this.eyedropperToggle.setValue(t)}setColor(t){var e;this.color=(0,$wpIFA._)({},t),this.colorCircle.style.backgroundColor=$2Eggz.BB.ColorConverter.toRgbStr(t),null==(e=this.colorPicker)||e.setColor(t)}closeColorPicker(){var t,e,i;this.colorWindow&&(this.colorPickerPosition=this.colorWindow.getPosition(),null==(e=this.colorWindow)||e.destroy(),null==(i=this.colorWindow)||i.getElement().remove(),this.colorWindow=void 0),null==(t=this.colorPicker)||t.destroy(),this.colorPicker=void 0}setIsVisible(t){this.rootEl.style.display=t?"flex":"none",t||this.closeColorPicker()}getElement(){return this.rootEl}constructor(t){this.colorPickerPosition={x:100,y:100},this.color={r:0,g:0,b:0},this.color=(0,$wpIFA._)({},t.color),this.colorCircle=$2Eggz.BB.el({css:{width:"30px",height:"30px",background:$2Eggz.BB.ColorConverter.toRgbStr(t.color),borderRadius:"100%",boxShadow:"0 0 0 1px rgba(0,0,0,0.5), inset 0 0 0 1px rgba(255,255,255,0.5)",alignSelf:"center",cursor:"pointer"},noRef:!0,onClick:()=>{this.colorPicker?this.closeColorPicker():(this.colorPicker=new $8f768338795db7a0$export$66306bf21a9ff39e({width:200,heightSV:200,heightH:30,color:this.color,callback:t.onColorChange}),this.colorWindow=new $2a29e69ee6709f86$export$a82a053f5f536d09({content:$2Eggz.BB.el({content:this.colorPicker.getElement()}),onClose:()=>{this.closeColorPicker()},position:this.colorPickerPosition}),document.body.append(this.colorWindow.getElement()))}});let e=new $d49d366dcf65e875$export$f04a61298a47a40f({imageUrl:$parcel$interopDefault($d1c3e18053002796$exports),width:1,height:1,css:{width:"100%",height:"100%"},darkInvert:!0});this.eyedropperToggle=new $8d99bd5fadaac7f9$export$2358c75ad3c15b2d({init:!1,title:$63d0b335c576c718$export$ce37e184d908d785("eyedropper"),onChange:e=>{t.onEyedropper(e)},label:$2Eggz.BB.el({content:e.getElement(),css:{padding:"6px",height:"36px"}})}),this.rootEl=$2Eggz.BB.el({css:{display:"flex",flexDirection:"column",gap:"4px"}}),this.rootEl.append(this.colorCircle,this.eyedropperToggle.getElement())}}var $aXq9D=parcelRequire("aXq9D");$a5bdfa66fb1ba8cd$export$4283b00eae4a6956();class $b7af2ed4a75d4700$export$96f6458b62e4c2c{updateLastSaved(){var t,e;this.lastSavedHistoryIndex=this.klHistory.getTotalIndex(),null==(t=this.saveReminder)||t.reset(),null==(e=this.unloadWarningTrigger)||e.update()}updateCollapse(t){if(t){var e;null!=(e=$dGRuJ.LocalStorage.getItem("uiShowMobile"))&&e&&this.mobileUi.setToolspaceIsOpen(!1)}this.mobileUi.setOrientation(this.uiLayout),this.uiWidth<this.collapseThreshold?(this.mobileUi.setIsVisible(!0),this.mobileUi.getToolspaceIsOpen()?("left"===this.uiLayout?(0,$VM6dD.css)(this.easel.getElement(),{left:"271px"}):(0,$VM6dD.css)(this.easel.getElement(),{left:"0"}),this.toolspace.style.display="block",this.easel.setSize(Math.max(0,this.uiWidth-this.toolWidth),this.uiHeight),this.statusOverlay.setWide(!1)):(this.uiLayout,(0,$VM6dD.css)(this.easel.getElement(),{left:"0"}),this.toolspace.style.display="none",this.easel.setSize(Math.max(0,this.uiWidth),this.uiHeight),this.statusOverlay.setWide(!0))):(this.mobileColorUi.closeColorPicker(),this.mobileUi.setIsVisible(!1),"left"===this.uiLayout&&(0,$VM6dD.css)(this.easel.getElement(),{left:"271px"}),this.toolspace.style.display="block",this.easel.setSize(Math.max(0,this.uiWidth-this.toolWidth),this.uiHeight),this.statusOverlay.setWide(!1)),this.mobileUi.update()}updateBottomBar(){if(!this.bottomBar)return;let t=this.toolspaceInner.scrollHeight+40<window.innerHeight?"":"none";t!==this.bottomBarWrapper.style.display&&(this.bottomBarWrapper.style.display=t)}updateUi(){this.toolspace.classList.toggle("kl-toolspace--left","left"===this.uiLayout),this.toolspace.classList.toggle("kl-toolspace--right","right"===this.uiLayout),"left"===this.uiLayout?((0,$VM6dD.css)(this.toolspace,{left:"0",right:""}),(0,$VM6dD.css)(this.easel.getElement(),{left:"271px"})):((0,$VM6dD.css)(this.toolspace,{left:"",right:"0"}),(0,$VM6dD.css)(this.easel.getElement(),{left:"0"})),this.statusOverlay.setUiState(this.uiLayout),this.layerPreview.setUiState(this.uiLayout),this.layersUi.setUiState(this.uiLayout),this.updateCollapse(),this.toolspaceScroller.updateUiState(this.uiLayout)}getElement(){return this.rootEl}resize(t,e){window.scrollY>0&&window.scrollTo(0,0),(this.uiWidth!==Math.max(0,t)||this.uiHeight!==Math.max(0,e))&&(this.uiWidth=Math.max(0,t),this.uiHeight=Math.max(0,e),this.updateCollapse(),this.updateBottomBar(),this.layerPreview.setIsVisible(this.uiHeight>=579),this.klColorSlider.setHeight(Math.max(163,Math.min(400,this.uiHeight-505))),this.toolspaceToolRow.setIsSmall(this.uiHeight<540))}out(t){this.statusOverlay.out(t)}async getPNG(){return await (0,$ao0qX.canvasToBlob)(this.klCanvas.getCompleteCanvas(1),"image/png")}getProject(){return this.klCanvas.getProject()}swapUiLeftRight(){this.uiLayout="left"===this.uiLayout?"right":"left",this.embed||$dGRuJ.LocalStorage.setItem("uiState",this.uiLayout),this.updateUi()}saveAsPsd(){this.saveToComputer.save("psd")}isDrawing(){return this.lineSanitizer.getIsDrawing()||this.easel.getIsLocked()}constructor(t){var e,i;let s,n,r,a,o,l;this.collapseThreshold=2e5,this.toolWidth=271,this.lastSavedHistoryIndex=0,this.drawMode="freehand",this.liveShape=null,this.getPSD=async()=>await $3ccac2760787e643$export$92433b641be3f7a(this.klCanvas),this.embed=t.embed;let h=Math.min(4096,Math.max(2048,Math.max(window.screen.width,window.screen.height)));this.uiLayout=this.embed?"left":$dGRuJ.LocalStorage.getItem("uiState")?$dGRuJ.LocalStorage.getItem("uiState"):"right";let c=$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable()?new $e42d359db0fc5c76$export$93d91060b9af7e2a:void 0;this.rootEl=$2Eggz.BB.el({className:"g-root",css:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0"}}),this.uiWidth=Math.max(0,window.innerWidth),this.uiHeight=Math.max(0,window.innerHeight);let d="png",p=Math.max(10,Math.min(h,window.innerWidth<this.collapseThreshold?this.uiWidth:this.uiWidth-this.toolWidth)),u=Math.max(10,Math.min(h,this.uiHeight));this.klHistory=new $d2dccce11beb16cf$export$1a1044741a812c67({oldest:$d45be62ad1325a1c$export$f8f3f96593f6a47(null!=(i=t.project)?i:{projectId:(0,$VM6dD.randomUuid)(),width:p,height:u,layers:[{name:$63d0b335c576c718$export$ce37e184d908d785("layers-layer")+" 1",opacity:1,isVisible:!0,mixModeStr:"source-over",image:{fill:$2Eggz.BB.ColorConverter.toRgbStr({r:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,g:$7a2aeb795d64bafc$export$e4203cb02d5e5b28,b:$7a2aeb795d64bafc$export$e4203cb02d5e5b28})}}]})});let g=t.klRecoveryManager;g&&(g.setKlHistory(this.klHistory),g.setGetThumbnail(t=>$2b8bf7b32e5ba51f$export$5f63a7b18dc4503a(this.klCanvas.getProject(),t))),t.project&&t.project.layers.forEach(t=>{t.image instanceof HTMLCanvasElement&&$2Eggz.BB.freeCanvas(t.image),t.image=null}),this.klCanvas=new $49faab2330529a96$export$6e4a713ddcda1e5e.KlCanvas(this.klHistory,this.embed?-1:1);let m=new $444b5d8ddd6258bc$export$ab82e91194f5da86,f=(t,e)=>{E();let i=v.index;this.klCanvas.eraseLayer({layerIndex:i,useAlphaLock:0===i&&!O.eraserBrush.getIsTransparentBg(),useSelection:!e}),t&&this.statusOverlay.out(this.klCanvas.getSelection()?$63d0b335c576c718$export$ce37e184d908d785("cleared-selected-area"):$63d0b335c576c718$export$ce37e184d908d785("cleared-layer"),!0)},y=new $2Eggz.BB.RGB(0,0,0),v=this.klCanvas.getLayer(this.klCanvas.getLayerCount()-1),x=()=>{if("eraserBrush"===n)return r;let t=Object.keys(O).filter(t=>"eraserBrush"!==t),e=t.findIndex(t=>t===n);return t[(e+1)%t.length]},b=t=>{w.emitSize(t),this.easelBrush&&this.easelBrush.setBrush({radius:t})},w=new $49faab2330529a96$export$6e4a713ddcda1e5e.BrushSettingService({onSetColor:t=>{this.klColorSlider.setColor(t),s.setColor(t),this.mobileColorUi.setColor(t),y=$2Eggz.BB.copyObj(t)},onSetSize:t=>{s.setSize(t),this.easelBrush.setBrush({radius:t})},onSetOpacity:t=>{s.setOpacity(t)},onSetScatter:t=>{s.setScatter(t)},onGetColor:()=>this.klColorSlider.getColor(),onGetSize:()=>O[n].getSize(),onGetOpacity:()=>O[n].getOpacity(),onGetScatter:()=>O[n].getScatter(),onGetSliderConfig:()=>({sizeSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].sizeSlider,opacitySlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].opacitySlider,scatterSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].scatterSlider})}),B=new $2d79f7f8e2e2d334$export$c57e2ed65bcf4d6a({smoothing:$b2e5423e81cbdb22$export$bcd109042a2e4bb5(1)});this.lineSanitizer=new $b47927ff4e129b10$export$91dcf4209534d21f;let S=new $2Eggz.BB.EventChain({chainArr:[this.lineSanitizer,B]});S.setChainOut(t=>{if("down"===t.type&&(this.toolspace.style.pointerEvents="none",s.startLine(t.x,t.y,t.pressure),this.easelBrush.setLastDrawEvent({x:t.x,y:t.y}),this.easel.requestRender()),"move"===t.type){if("liveShape"===this.drawMode&&this.liveShape){this.liveShape=(0,$9FMZM._)((0,$wpIFA._)({},this.liveShape),{x2:t.x,y2:t.y});let e=this.liveShape;this.klCanvas.setComposite(e.layerIndex,{draw:t=>{let i={type:e.type,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,angleRad:e.angleRad,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};"line"===e.type?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth(),i.isAngleSnap=$.getIsSnap()):(i.isFixedRatio=$.getIsFixed(),"stroke"===$.getMode()?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth()):i.fillRgb=this.klColorSlider.getColor()),$49faab2330529a96$export$6e4a713ddcda1e5e.drawShape(t,i,void 0)}}),this.easelProjectUpdater.update();return}s.goLine(t.x,t.y,t.pressure,t.isCoalesced),this.easelBrush.setLastDrawEvent({x:t.x,y:t.y}),this.easel.requestRender()}if("up"===t.type){if(this.toolspace.style.pointerEvents="","liveShape"===this.drawMode&&this.liveShape){let t=this.liveShape,e=t.layerIndex;this.klCanvas.setComposite(e,void 0);let i={type:t.type,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,angleRad:t.angleRad,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};"line"===t.type?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth(),i.isAngleSnap=!1):(i.isFixedRatio=!1,"stroke"===$.getMode()?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth()):i.fillRgb=this.klColorSlider.getColor()),this.klCanvas.drawShape(e,i),this.easelProjectUpdater.update(),this.liveShape=null,this.drawMode="freehand";return}s.endLine(),this.easel.requestRender()}"line"===t.type&&(s.getBrush().drawLineSegment(t.x0,t.y0,t.x1,t.y1),this.easelBrush.setLastDrawEvent({x:t.x1,y:t.y1}),this.easel.requestRender())});let C={size:20,align:"left",isBold:!1,isItalic:!1,font:"sans-serif",letterSpacing:0,lineHeight:1,fill:{color:{r:0,g:0,b:0,a:1}}},E=()=>{let t=!1;if(this.liveShape){let e=this.liveShape,i=e.layerIndex,s={type:e.type,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,angleRad:e.angleRad,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};"line"===e.type?(s.strokeRgb=this.klColorSlider.getColor(),s.lineWidth=$.getLineWidth(),s.isAngleSnap=!1):(s.isFixedRatio=!1,"stroke"===$.getMode()?(s.strokeRgb=this.klColorSlider.getColor(),s.lineWidth=$.getLineWidth()):s.fillRgb=this.klColorSlider.getColor()),this.klCanvas.setComposite(i,void 0),this.klCanvas.drawShape(i,s),this.easelProjectUpdater.update(),this.liveShape=null,t=!0}return"select"===this.easel.getTool()&&(t=P.commitTransform()||t),t},k=()=>"select"===this.easel.getTool()&&P.discardTransform(),I=(t,e)=>{if(["undo","redo"].includes(t)){let t=this.klHistory.getComposed();this.klCanvas.updateViaComposed(e,t),F(this.klCanvas.getLayer(t.layerMap[t.activeLayerId].index)),this.easelProjectUpdater.update(),(e.size.width!==t.size.width||e.size.height!==t.size.height)&&this.easel.resetOrFitTransform(!0),this.easelBrush.setLastDrawEvent(),this.layersUi.update(v.index)}P.onHistory(t)},T=t=>{m.canDecreaseIndex()||k();let e=this.klHistory.getComposed(),i=J.undo();i&&(I(i.type,e),t&&this.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("undo"),!0))},M=t=>{let e=this.klHistory.getComposed(),i=J.redo();i&&(I(i.type,e),t&&this.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("redo"),!0))};this.statusOverlay=new $49faab2330529a96$export$6e4a713ddcda1e5e.StatusOverlay;let P=new $9f442e11ca4a81af$export$e471993a29671b7({klCanvas:this.klCanvas,getCurrentLayerCtx:()=>v.context,onUpdateProject:()=>this.easelProjectUpdater.update(),klHistory:this.klHistory,tempHistory:m,statusOverlay:this.statusOverlay,onFill:()=>{this.klCanvas.layerFill(v.index,this.klColorSlider.getColor(),void 0,!0),this.statusOverlay.out(this.klCanvas.getSelection()?$63d0b335c576c718$export$ce37e184d908d785("filled-selected-area"):$63d0b335c576c718$export$ce37e184d908d785("filled"),!0)},onErase:()=>{let t=v.index;this.klCanvas.eraseLayer({layerIndex:t,useAlphaLock:0===t&&!O.eraserBrush.getIsTransparentBg(),useSelection:!0}),this.statusOverlay.out(this.klCanvas.getSelection()?$63d0b335c576c718$export$ce37e184d908d785("cleared-selected-area"):$63d0b335c576c718$export$ce37e184d908d785("cleared-layer"),!0)}});this.selectTool=new $baef18034167f5fc$export$53d9e71218013355({klCanvas:this.klCanvas}),this.easelBrush=new $d5398ba9251670c1$export$dfeedd8879a1038a({radius:5,onLineStart:t=>{S.chainIn({type:"down",scale:this.easel.getTransform().scale,shiftIsPressed:_.isPressed("shift"),pressure:t.pressure,isCoalesced:t.isCoalesced,x:t.x,y:t.y})},onLineGo:t=>{S.chainIn({type:"move",scale:this.easel.getTransform().scale,shiftIsPressed:_.isPressed("shift"),pressure:t.pressure,isCoalesced:t.isCoalesced,x:t.x,y:t.y})},onLineEnd:()=>{S.chainIn({type:"up",scale:this.easel.getTransform().scale,shiftIsPressed:_.isPressed("shift"),isCoalesced:!1})},onLine:(t,e)=>{S.chainIn({type:"line",x0:t.x,y0:t.y,x1:e.x,y1:e.y,pressure0:1,pressure1:1})},onShapeDetected:t=>{let e,i,n,r;if(console.log("Shape detected by algorithm:",t),"liveShape"===this.drawMode)return;try{var a;null==s||null==(a=s.endLine)||a.call(s)}catch(t){console.warn("endLine call failed on currentBrushUi",t)}T(!1);let o=null;if("rectangle"===t.type?o="rect":"circle"===t.type?o="ellipse":"line"===t.type&&(o="line"),!o)return;"line"===o?(e=t.x1,n=t.y1,i=t.x2,r=t.y2):(e=Math.min(t.x1,t.x2),i=Math.max(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.max(t.y1,t.y2));let h=0,c=v.index;this.liveShape={type:o,x1:e,y1:n,x2:i,y2:r,angleRad:h,layerIndex:c},this.drawMode="liveShape";let d=()=>{if(!this.liveShape)return null;let t=this.liveShape,e={type:t.type,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,angleRad:t.angleRad,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};return"line"===t.type?(e.strokeRgb=this.klColorSlider.getColor(),e.lineWidth=$.getLineWidth(),e.isAngleSnap=$.getIsSnap()):(e.isFixedRatio=$.getIsFixed(),"stroke"===$.getMode()?(e.strokeRgb=this.klColorSlider.getColor(),e.lineWidth=$.getLineWidth()):e.fillRgb=this.klColorSlider.getColor()),e};this.klCanvas.setComposite(c,{draw:t=>{let e=d();e&&$49faab2330529a96$export$6e4a713ddcda1e5e.drawShape(t,e,void 0)}}),this.easelProjectUpdater.update(),null==l||l.open("shape"),z()}});let L=new $d8c027c12d076d23$export$8202a4a90789f655({}),R=!1,A=new $0d69a1331eb93d66$export$f4821fa73b1145e5({onDown:(t,e)=>{if(this.liveShape){let e=this.liveShape,i=Math.min(e.x1,e.x2),s=Math.max(e.x1,e.x2),n=Math.min(e.y1,e.y2),r=Math.max(e.y1,e.y2);if(t.x>=i&&t.x<=s&&t.y>=n&&t.y<=r){R=!0;return}}R=!1,Z.onDown(t.x,t.y,e)},onMove:t=>{if(R&&this.liveShape){this.liveShape=(0,$9FMZM._)((0,$wpIFA._)({},this.liveShape),{x2:t.x,y2:t.y});let e=this.liveShape;this.klCanvas.setComposite(e.layerIndex,{draw:t=>{let i={type:e.type,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,angleRad:e.angleRad,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};"line"===e.type?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth(),i.isAngleSnap=$.getIsSnap()):(i.isFixedRatio=$.getIsFixed(),"stroke"===$.getMode()?(i.strokeRgb=this.klColorSlider.getColor(),i.lineWidth=$.getLineWidth()):i.fillRgb=this.klColorSlider.getColor()),$49faab2330529a96$export$6e4a713ddcda1e5e.drawShape(t,i,void 0)}}),this.easelProjectUpdater.update();return}Z.onMove(t.x,t.y)},onUp:t=>{if(R){R=!1;return}Z.onUp(t.x,t.y)}}),D=!0;this.easel=new $ef524340be1400ac$export$2732362bcaeb02c2({width:Math.max(0,this.uiWidth-this.toolWidth),height:this.uiHeight,project:{width:this.klCanvas.getWidth(),height:this.klCanvas.getHeight(),layers:[]},tools:{brush:this.easelBrush,hand:L,select:P.getEaselSelect(),eyedropper:new $0bd0e1e89228720f$export$1fda302750a9ba48({onPick:t=>{let e=this.klCanvas.getColorAt(t.x,t.y);return w.setColor(e),e},onPickEnd:()=>{(this.klColorSlider.getIsEyedropping()||this.mobileColorUi.getIsEyedropping())&&(this.klColorSlider.setIsEyedropping(!1),this.mobileColorUi.setIsEyedropping(!1),this.easel.setTool(this.toolspaceToolRow.getActive()))}}),paintBucket:new $b94c0aafb6fba54d$export$9b29623161064b87({onFill:t=>{this.klCanvas.floodFill(v.index,t.x,t.y,Y.getIsEraser()?null:this.klColorSlider.getColor(),Y.getOpacity(),Y.getTolerance(),Y.getSample(),Y.getGrow(),Y.getContiguous()),this.easel.requestRender()}}),gradient:new $317b4db69c17519a$export$11badb1ec62816a1({onDown:(t,e)=>{K.onDown(t.x,t.y,e)},onMove:t=>{K.onMove(t.x,t.y)},onUp:t=>{K.onUp(t.x,t.y)}}),text:new $737d4594390c240a$export$b10c22a3fee9197f({onDown:(t,e)=>{$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||$49faab2330529a96$export$6e4a713ddcda1e5e.textToolDialog({klCanvas:this.klCanvas,layerIndex:v.index,primaryColor:this.klColorSlider.getColor(),secondaryColor:this.klColorSlider.getSecondaryRGB(),text:(0,$9FMZM._)((0,$wpIFA._)({},C),{text:"",x:t.x,y:t.y,angleRad:e,fill:C.fill?{color:(0,$9FMZM._)((0,$wpIFA._)({},this.klColorSlider.getColor()),{a:C.fill.color.a})}:void 0,stroke:C.stroke?(0,$9FMZM._)((0,$wpIFA._)({},C.stroke),{color:(0,$9FMZM._)((0,$wpIFA._)({},this.klColorSlider.getSecondaryRGB()),{a:C.stroke.color.a})}):void 0}),onConfirm:t=>{C=(0,$9FMZM._)((0,$wpIFA._)({},t),{text:""}),this.klCanvas.text(v.index,t)}})}}),shape:A,rotate:new $7d88d4eb596d13ba$export$f3b0846760df78b({}),zoom:new $44d9d077b3aa143c$export$6c389c8425707374({})},tool:"brush",onChangeTool:t=>{this.mobileBrushUi.setIsVisible("brush"===t),this.mobileColorUi.setIsVisible("select"!==t)},onTransformChange:(t,e)=>{X.update(t.scale,t.angleDeg),this.toolspaceToolRow.setEnableZoomIn(t.scale!==$3757e4eb154d55dd$export$ac82c07320907c00),this.toolspaceToolRow.setEnableZoomOut(t.scale!==$3757e4eb154d55dd$export$5e2c057e240c0b8c),e&&!D&&this.statusOverlay.out({type:"transform",scale:t.scale,angleDeg:t.angleDeg}),D&&(D=!1)},onUndo:()=>{T(!0)},onRedo:()=>{M(!0)}}),(0,$VM6dD.css)(this.easel.getElement(),{position:"absolute",left:"0",top:"0"}),this.easelProjectUpdater=new $d5ac8c3334d6d49f$export$abfede0290e9bfba({klCanvas:this.klCanvas,easel:this.easel}),this.klHistory.addListener(()=>{this.easelProjectUpdater.update()}),$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.subscribe(t=>{this.easel.setIsFrozen(t>0)});let z=()=>{if(!l)return;let t={brush:{},hand:{},paintBucket:{},gradient:{},text:{},shape:{},select:{}},e=this.toolspaceToolRow.getActive(),i=l.getOpenedTabId(),s=Object.keys(t);for(let t=0;t<s.length;t++)e===s[t]?l.setIsVisible(s[t],!0):(l.setIsVisible(s[t],!1),i===s[t]&&l.open(e))},_=new $2Eggz.BB.KeyListener({onDown:(t,e,i)=>{if(!($49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||$2Eggz.BB.isInputFocused(!0))&&!(this.lineSanitizer.getIsDrawing()||this.easel.getIsLocked())){if("home"===i&&this.easel.fitTransform(),"end"===i&&this.easel.resetTransform(),["ctrl+z","cmd+z"].includes(i)&&(e.preventDefault(),T()),(["ctrl+y","cmd+y"].includes(i)||($2Eggz.BB.sameKeys("ctrl+shift+z",i)||$2Eggz.BB.sameKeys("cmd+shift+z",i))&&"z"===t)&&(e.preventDefault(),M()),!this.embed&&(["ctrl+s","cmd+s"].includes(i)&&(e.preventDefault(),E(),this.saveToComputer.save()),["ctrl+shift+s","cmd+shift+s"].includes(i)&&(e.preventDefault(),E(),c?(async()=>{await $2e574af1dfdb7def$export$f565b71ad023b7df();let t=c.getCurrentMeta(),e=this.getProject();if(t&&t.projectId!==e.projectId&&!await new Promise((t,e)=>{$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,type:"warning",message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-overwrite-confirm"),buttons:[$63d0b335c576c718$export$ce37e184d908d785("file-storage-overwrite"),"Cancel"],callback:async e=>{"Cancel"===e?t(!1):t(!0)}})}))return;let i=!0;try{await c.store(this.klCanvas.getProject())}catch(t){i=!1,setTimeout(()=>{throw Error("keyboard-shortcut: failed to store browser storage, "+t)},0),this.statusOverlay.out(" "+$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed"),!0)}i&&(this.updateLastSaved(),this.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("file-storage-stored"),!0))})():this.statusOverlay.out(" "+$63d0b335c576c718$export$ce37e184d908d785("file-storage-failed"),!0)),["ctrl+c","cmd+c"].includes(i)&&(e.preventDefault(),E(),ti(!0))),["ctrl+a","cmd+a"].includes(i)&&e.preventDefault(),"sqbr_open"===i&&s.decreaseSize(Math.max(.005,.03/this.easel.getTransform().scale)),"sqbr_close"===i&&s.increaseSize(Math.max(.005,.03/this.easel.getTransform().scale)),"enter"!==i||E()||(this.klCanvas.layerFill(v.index,this.klColorSlider.getColor(),void 0,!0),this.statusOverlay.out(this.klCanvas.getSelection()?$63d0b335c576c718$export$ce37e184d908d785("filled-selected-area"):$63d0b335c576c718$export$ce37e184d908d785("filled"),!0)),"esc"===i&&k()&&e.preventDefault(),["delete","backspace"].includes(i)&&f(!0),"shift+e"===i){var r;e.preventDefault(),null==(r=s.toggleEraser)||r.call(s)}else"e"===i&&(e.preventDefault(),E(),this.easel.setTool("brush"),this.toolspaceToolRow.setActive("brush"),null==l||l.open("brush"),z(),W.open("eraserBrush"));if("b"===i){e.preventDefault(),E();let t=this.easel.getTool();this.easel.setTool("brush"),this.toolspaceToolRow.setActive("brush"),null==l||l.open("brush"),z(),W.open("brush"===t?x():n)}if("g"===i){e.preventDefault(),E();let t="paintBucket"===this.easel.getTool()?"gradient":"paintBucket";this.easel.setTool(t),this.toolspaceToolRow.setActive(t),null==l||l.open(t),z()}"t"===i&&(e.preventDefault(),E(),this.easel.setTool("text"),this.toolspaceToolRow.setActive("text"),null==l||l.open("text"),z()),"u"===i&&(e.preventDefault(),E(),this.easel.setTool("shape"),this.toolspaceToolRow.setActive("shape"),null==l||l.open("shape"),z()),"l"===i&&(e.preventDefault(),E(),this.easel.setTool("select"),this.toolspaceToolRow.setActive("select"),null==l||l.open("select"),z()),"x"===i&&(e.preventDefault(),this.klColorSlider.swapColors())}},onUp:(t,e)=>{}}),O={};Object.entries($49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI).forEach(([t,e])=>{let i=new e.Ui({klHistory:this.klHistory,onSizeChange:b,onScatterChange:t=>{w.emitScatter(t)},onOpacityChange:t=>{w.emitOpacity(t)},onConfigChange:()=>{w.emitSliderConfig({sizeSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].sizeSlider,opacitySlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].opacitySlider,scatterSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[n].scatterSlider})}});O[t]=i,i.getElement().style.padding="10px"}),this.toolspace=$2Eggz.BB.el({className:"kl-toolspace",css:{position:"absolute",right:"0",top:"0",bottom:"0",width:this.toolWidth+"px",overflow:"hidden",userSelect:"none",touchAction:"none"}}),this.toolspaceInner=$2Eggz.BB.el({parent:this.toolspace}),this.toolspace.oncontextmenu=()=>!1,this.toolspace.onclick=$2Eggz.BB.handleClick,this.mobileBrushUi=new $690058b3c2558cac$export$87fd7552ee5cd26e({onBrush:()=>{W.open(r)},onEraser:()=>{W.open("eraserBrush")}}),this.mobileColorUi=new $2099b242ded3a643$export$f27d6e4616dd9b30({onEyedropper:t=>{t?(this.klColorSlider.setIsEyedropping(!0),this.easel.setTool("eyedropper")):(this.klColorSlider.setIsEyedropping(!1),this.easel.setTool(this.toolspaceToolRow.getActive()))},color:y,onColorChange:t=>{w.setColor(t)}}),this.mobileUi=new $0497dee7143bcf86$export$38b681d46b785af1({onShowToolspace:t=>{this.mobileColorUi.closeColorPicker(),this.updateCollapse()},toolUis:[this.mobileBrushUi.getElement(),this.mobileColorUi.getElement()]}),this.updateCollapse(!0),setTimeout(()=>{a=new $49faab2330529a96$export$6e4a713ddcda1e5e.OverlayToolspace({enabledTest:()=>0===$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()&&!this.easel.getIsLocked(),brushSettingService:w}),this.rootEl.append(a.getElement())},0),$2Eggz.BB.append(this.rootEl,[this.easel.getElement(),this.toolspace,this.mobileUi.getElement()]),(o=this.embed?new $db287580a54bd175$export$ce26cd3db18613a3({onHelp:()=>{$165d2995997b2f9b$export$35fa34e5af64bd4a(this.embed.url+"/help.html",!!this.embed)},onSubmit:()=>{E();let t=()=>{let t,e=$2Eggz.BB.el({tagName:"button",textContent:$63d0b335c576c718$export$ce37e184d908d785("save-reminder-save-psd"),css:{display:"block"}});e.onclick=()=>{this.saveAsPsd(),t()},$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.rootEl,message:"<b>"+$63d0b335c576c718$export$ce37e184d908d785("upload-failed")+"</b>",div:$2Eggz.BB.el({content:[$2Eggz.BB.el({content:$63d0b335c576c718$export$ce37e184d908d785("backup-drawing"),css:{marginBottom:"10px"}}),e]}),ignoreBackground:!0,closeFunc:e=>{t=e}})};$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.rootEl,message:$63d0b335c576c718$export$ce37e184d908d785("submit-prompt"),buttons:[$63d0b335c576c718$export$ce37e184d908d785("submit"),"Cancel"],callback:async e=>{if(e!==$63d0b335c576c718$export$ce37e184d908d785("submit"))return;let i=$2Eggz.BB.el({parent:this.rootEl,className:"upload-overlay",content:'<div class="spinner"></div> '+$63d0b335c576c718$export$ce37e184d908d785("submit-submitting")});this.embed.onSubmit(()=>{this.updateLastSaved(),i.remove()},()=>{i.remove(),t()})}})},onLeftRight:()=>{this.uiLayout="left"===this.uiLayout?"right":"left",this.updateUi()}}):new $49faab2330529a96$export$6e4a713ddcda1e5e.ToolspaceTopRow({logoImg:t.logoImg,onLogo:()=>{$165d2995997b2f9b$export$35fa34e5af64bd4a("./home/",!!this.embed)},onNew:()=>{tt()},onImport:()=>{tn.triggerImport()},onSave:()=>{this.saveToComputer.save()},onShare:()=>{te()},onHelp:()=>{$165d2995997b2f9b$export$35fa34e5af64bd4a("./help/",!!this.embed)}})).getElement().style.marginBottom="10px",this.toolspaceInner.append(o.getElement()),this.toolspaceToolRow=new $49faab2330529a96$export$6e4a713ddcda1e5e.ToolspaceToolRow({onActivate:t=>{if("hand"!==t&&E(),"brush"===t)this.easel.setTool("brush");else if("hand"===t)this.easel.setTool("hand");else if("paintBucket"===t)this.easel.setTool("paintBucket");else if("gradient"===t)this.easel.setTool("gradient");else if("text"===t)this.easel.setTool("text");else if("shape"===t)this.easel.setTool("shape");else if("select"===t)this.easel.setTool("select");else throw Error("unknown activeStr");null==l||l.open(t),z(),this.klColorSlider.setIsEyedropping(!1),this.mobileColorUi.setIsEyedropping(!1)},onZoomIn:()=>{let t=this.easel.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,_.isPressed("shift")?1/8:.5);this.easel.scale(e/t)},onZoomOut:()=>{let t=this.easel.getTransform().scale,e=$b18d1bd8e7aad78b$export$8c03162b1a39d183(t,_.isPressed("shift")?-1/8:-.5);this.easel.scale(e/t)},onUndo:()=>{T()},onRedo:()=>{M()}}),this.toolspaceToolRow.setIsSmall(this.uiHeight<540),this.toolspaceInner.append(this.toolspaceToolRow.getElement());let H=t=>{y=t,s.setColor(t),w.emitColor(t),this.mobileColorUi.setColor(t),this.klColorSlider.setIsEyedropping(!1),this.mobileColorUi.setIsEyedropping(!1)};this.klColorSlider=new $49faab2330529a96$export$6e4a713ddcda1e5e.KlColorSlider({width:250,height:30,svHeight:100,startValue:new $2Eggz.BB.RGB(0,0,0),onPick:H,onEyedropper:t=>{t?(this.mobileColorUi.setIsEyedropping(!0),this.easel.setTool("eyedropper")):(this.mobileColorUi.setIsEyedropping(!1),this.easel.setTool(this.toolspaceToolRow.getActive()))}}),this.klColorSlider.setHeight(Math.max(163,Math.min(400,this.uiHeight-505)));let V=t=>{"eraserBrush"!==t&&(r=t),this.klColorSlider&&("eraserBrush"===t?this.klColorSlider.enable(!1):this.klColorSlider.enable(!0)),n=t,(s=O[t]).setColor(y),s.setLayer(v),this.easelBrush.setBrush({type:"pixelBrush"===n?"pixel-square":"round"}),this.toolspaceToolRow.setActive("brush"),z()},F=t=>{v=t,s.setLayer(v),this.layerPreview.setLayer(v)},U=$2Eggz.BB.el(),j=$2Eggz.BB.el({css:{margin:"10px",display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-end"}}),N=new $49faab2330529a96$export$6e4a713ddcda1e5e.ToolspaceStabilizerRow({smoothing:1,onSelect:t=>{B.setSmoothing($b2e5423e81cbdb22$export$bcd109042a2e4bb5(t))}});U.append(j),$2Eggz.BB.append(j,[this.klColorSlider.getElement(),this.klColorSlider.getOutputElement(),N.getElement()]);let W=new $49faab2330529a96$export$6e4a713ddcda1e5e.TabRow({initialId:"penBrush",useAccent:!0,tabArr:(()=>{let t=[],e=t=>({id:t,image:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[t].image,title:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[t].tooltip,onOpen:()=>{O[t].getElement().style.display="block",V(t),this.klColorSlider.setIsEyedropping(!1),this.mobileColorUi.setIsEyedropping(!1),w.emitSliderConfig({sizeSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[t].sizeSlider,opacitySlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[t].opacitySlider,scatterSlider:$49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI[t].scatterSlider}),b(O[t].getSize()),w.emitOpacity(O[t].getOpacity()),this.mobileBrushUi.setType("eraserBrush"===t?"eraser":"brush")},onClose:()=>{O[t].getElement().style.display="none"}}),i=Object.keys(O);for(let s=0;s<i.length;s++)t.push(e(i[s]));return t})()});$2Eggz.BB.append(U,[W.getElement(),...Object.entries($49faab2330529a96$export$6e4a713ddcda1e5e.BRUSHES_UI).map(([t])=>O[t].getElement())]);let X=new $49faab2330529a96$export$6e4a713ddcda1e5e.HandUi({scale:this.easel.getTransform().scale,angleDeg:0,onReset:()=>{this.easel.resetTransform()},onFit:()=>{this.easel.fitTransform()},onAngleChange:(t,e)=>{this.easel.setAngleDeg(t,e)},onChangeUseInertiaScrolling:t=>{L.setUseInertiaScrolling(t)}}),Y=new $49faab2330529a96$export$6e4a713ddcda1e5e.FillUi({colorSlider:this.klColorSlider}),G=new $49faab2330529a96$export$6e4a713ddcda1e5e.GradientUi({colorSlider:this.klColorSlider}),q=new $49faab2330529a96$export$6e4a713ddcda1e5e.TextUi({colorSlider:this.klColorSlider}),$=new $49faab2330529a96$export$6e4a713ddcda1e5e.ShapeUi({colorSlider:this.klColorSlider,onChangePanning:t=>A.setPanning(t)}),K=new $49faab2330529a96$export$6e4a713ddcda1e5e.GradientTool({onGradient:(t,e,i,s,n,r)=>{let a=v.index,o=G.getSettings(),l={type:o.type,color1:this.klColorSlider.getColor(),isReversed:o.isReversed,opacity:o.opacity,doLockAlpha:o.doLockAlpha,isEraser:o.isEraser,doSnap:_.isPressed("shift")||o.doSnap,x1:e,y1:i,x2:s,y2:n,angleRad:r};if(t)this.klCanvas.setComposite(a,void 0),this.klCanvas.drawGradient(a,l);else{let t=this.klCanvas.getSelection(),e=t?new Path2D((0,$aXq9D.getSelectionPath2d)(t)):void 0;this.klCanvas.setComposite(a,{draw:t=>{$49faab2330529a96$export$6e4a713ddcda1e5e.drawGradient(t,l,e)}})}this.easelProjectUpdater.update()}}),Z=new $49faab2330529a96$export$6e4a713ddcda1e5e.ShapeTool({onShape:(t,e,i,s,n,r)=>{let a=v.index,o={type:$.getShape(),x1:e,y1:i,x2:s,y2:n,angleRad:r,isOutwards:$.getIsOutwards(),opacity:$.getOpacity(),isEraser:$.getIsEraser(),doLockAlpha:$.getDoLockAlpha()};if("line"===$.getShape()?(o.strokeRgb=this.klColorSlider.getColor(),o.lineWidth=$.getLineWidth(),o.isAngleSnap=$.getIsSnap()||_.isPressed("shift")):(o.isFixedRatio=$.getIsFixed()||_.isPressed("shift"),"stroke"===$.getMode()?(o.strokeRgb=this.klColorSlider.getColor(),o.lineWidth=$.getLineWidth()):o.fillRgb=this.klColorSlider.getColor()),t)this.klCanvas.setComposite(a,void 0),this.klCanvas.drawShape(a,o);else{let t=this.klCanvas.getSelection(),e=t?new Path2D((0,$aXq9D.getSelectionPath2d)(t)):void 0;this.klCanvas.setComposite(a,{draw:t=>{$49faab2330529a96$export$6e4a713ddcda1e5e.drawShape(t,o,e)}})}this.easelProjectUpdater.update()}});this.layersUi=new $49faab2330529a96$export$6e4a713ddcda1e5e.LayersUi({klCanvas:this.klCanvas,onSelect:(t,e)=>{let i=this.klCanvas.getLayer(t);if(F(i),e){let t=$4b95c7d5307dee66$export$beb462111ff337c5(this.klHistory.getEntries().at(-1).data);this.klHistory.push({activeLayerId:i.id},t)}},parentEl:this.rootEl,uiState:this.uiLayout,applyUncommitted:()=>E(),klHistory:this.klHistory,onUpdateProject:()=>this.easelProjectUpdater.update(),onClearLayer:()=>f(!1,!0)}),this.layerPreview=new $49faab2330529a96$export$6e4a713ddcda1e5e.LayerPreview({klRootEl:this.rootEl,onClick:()=>{null==l||l.open("layers")},uiState:this.uiLayout,klHistory:this.klHistory}),this.layerPreview.setIsVisible(this.uiHeight>=579),this.layerPreview.setLayer(v);let Q=new $49faab2330529a96$export$6e4a713ddcda1e5e.EditUi({klRootEl:this.rootEl,klColorSlider:this.klColorSlider,layersUi:this.layersUi,getCurrentColor:()=>y,maxCanvasSize:h,klCanvas:this.klCanvas,getCurrentLayer:()=>v,isEmbed:!!this.embed,statusOverlay:this.statusOverlay,onCanvasChanged:()=>{this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0)},applyUncommitted:()=>E(),klHistory:this.klHistory,onCopyToClipboard:()=>{E(),ti(!1,!1)},onPaste:()=>ta.readClipboard()}),J=new $22677d38776ea068$export$cb9945923eaef1dd({klHistory:this.klHistory,tempHistory:m,onCanUndoRedoChange:(t,e)=>{this.toolspaceToolRow.setEnableUndo(t),this.toolspaceToolRow.setEnableRedo(e)}}),tt=()=>{E(),$49faab2330529a96$export$6e4a713ddcda1e5e.newImageDialog({currentColor:y,secondaryColor:this.klColorSlider.getSecondaryRGB(),maxCanvasSize:h,canvasWidth:this.klCanvas.getWidth(),canvasHeight:this.klCanvas.getHeight(),workspaceWidth:window.innerWidth<this.collapseThreshold?this.uiWidth:this.uiWidth-this.toolWidth,workspaceHeight:this.uiHeight,onConfirm:(t,e,i)=>{this.klCanvas.reset({width:t,height:e,color:1===i.a?i:void 0}),this.layersUi.update(0),F(this.klCanvas.getLayer(0)),this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0)},onCancel:()=>{}})},te=t=>{E(),$2Eggz.BB.shareCanvas({canvas:this.klCanvas.getCompleteCanvas(1),fileName:$2Eggz.BB.getDate()+$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.filenameBase+".png",title:$2Eggz.BB.getDate()+$5a2f7ed66bdaf6a4$export$67ac20532b9ededa.filenameBase+".png",callback:t||(()=>{})})};this.saveToComputer=new $49faab2330529a96$export$6e4a713ddcda1e5e.SaveToComputer(()=>d,this.klCanvas,()=>{this.updateLastSaved()});let ti=(t=!1,e=!0)=>{$49faab2330529a96$export$6e4a713ddcda1e5e.clipboardDialog(this.rootEl,t=>this.klCanvas.getCompleteCanvas(1,t),t=>{(0!==t.left||0!==t.right||0!==t.top||0!==t.bottom)&&($49faab2330529a96$export$6e4a713ddcda1e5e.FILTER_LIB.cropExtend.apply({layer:v,klCanvas:this.klCanvas,input:t,klHistory:this.klHistory}),this.layersUi.update(),this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0))},this.statusOverlay,t||!1,e,this.klCanvas.getSelection())},ts=async()=>{let t,e,i=()=>{$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.rootEl,message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open-failed"),type:"error"})};if(!c)return void i();let s=c.getCurrentMeta();if(s&&this.klHistory.getComposed().projectId.value!==s.projectId){let t=!0,e=new $a12bfee0fab37a82$export$84f7c9d87f70395e("kl-tab-communication"),i=[],n=t=>{"response-project-id"===t.type&&i.push(t.id)};if(e.subscribe(n),e.postMessage({type:"request-project-ids"}),await (0,$VM6dD.sleep)(100),e.unsubscribe(n),s&&i.includes(s.projectId)&&(t=await new Promise((t,e)=>{$2016c314bff36ab9$export$d7e8d4d4450c819c({target:document.body,message:$63d0b335c576c718$export$ce37e184d908d785("file-storage-open-confirmation"),buttons:[$63d0b335c576c718$export$ce37e184d908d785("file-storage-open"),"Cancel"],callback:async e=>{"Cancel"===e?t(!1):t(!0)}})})),e.close(),!t)return}$49faab2330529a96$export$6e4a713ddcda1e5e.popup({target:this.rootEl,message:$63d0b335c576c718$export$ce37e184d908d785("loading"),callback:e=>{t=void 0},closeFunc:e=>{t=e}});try{e=await (null==c?void 0:c.read())}catch(t){setTimeout(()=>{throw t})}if(!e){null==t||t(),i();return}E();let n=this.klCanvas.reset({projectId:e.project.projectId,width:e.project.width,height:e.project.height,layers:e.project.layers.map(t=>{var i;let s=t.image;return!(s instanceof HTMLCanvasElement)&&(s=$2Eggz.BB.canvas(e.project.width,e.project.height),t.image instanceof HTMLImageElement&&$2Eggz.BB.ctx(s).drawImage(t.image,0,0)),(0,$9FMZM._)((0,$wpIFA._)({},t),{id:(0,$VM6dD.randomUuid)(),image:s,mixModeStr:null!=(i=t.mixModeStr)?i:"source-over"})})});this.layersUi.update(n),F(this.klCanvas.getLayer(n)),this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0),setTimeout(()=>{this.statusOverlay.out($63d0b335c576c718$export$ce37e184d908d785("file-storage-restored"))}),null==t||t()},tn=this.embed?null:new $49faab2330529a96$export$6e4a713ddcda1e5e.FileUi({klRootEl:this.rootEl,projectStore:c,getProject:()=>this.klCanvas.getProject(),exportType:d,onExportTypeChange:t=>{d=t},onFileSelect:(t,e)=>ta.handleFileSelect(t,e),onSaveImageToComputer:()=>{E(),this.saveToComputer.save()},onNewImage:tt,onShareImage:t=>{E(),te(t)},onUpload:()=>{E(),$49faab2330529a96$export$6e4a713ddcda1e5e.imgurUpload(this.klCanvas,this.rootEl,t.app&&t.app.imgurKey?t.app.imgurKey:"",()=>this.updateLastSaved())},applyUncommitted:()=>E(),onChangeShowSaveDialog:t=>{this.saveToComputer.setShowSaveDialog(t)},klRecoveryManager:g,onOpenBrowserStorage:ts,onStoredToBrowserStorage:()=>{this.updateLastSaved()}});!this.embed&&c&&(this.saveReminder=new $5ecc5a61dcd332b6$export$befc6437ad34b28a({onSaveAsPsd:()=>{this.embed||this.saveAsPsd()},isDrawing:()=>this.isDrawing(),projectStore:c,getProject:()=>this.getProject(),onStored:()=>{this.updateLastSaved()},applyUncommitted:E,klHistory:this.klHistory}));let tr=new $49faab2330529a96$export$6e4a713ddcda1e5e.SettingsUi({onLeftRight:()=>{this.uiLayout="left"===this.uiLayout?"right":"left",this.updateUi(),this.embed||$dGRuJ.LocalStorage.setItem("uiState",this.uiLayout)},saveReminder:this.saveReminder,customAbout:t.aboutEl});l=new $49faab2330529a96$export$6e4a713ddcda1e5e.TabRow({initialId:"brush",tabArr:[{id:"brush",title:$63d0b335c576c718$export$ce37e184d908d785("tool-brush"),image:$parcel$interopDefault($4933c2551a80d49a$exports),onOpen:()=>{"eraserBrush"===n&&this.klColorSlider.enable(!1),$2Eggz.BB.append(j,[this.klColorSlider.getElement(),this.klColorSlider.getOutputElement(),N.getElement()]),U.style.display="block"},onClose:()=>{U.style.display="none"},css:{minWidth:"45px"}},{id:"hand",title:$63d0b335c576c718$export$ce37e184d908d785("tool-hand"),image:$parcel$interopDefault($071c8859c903033f$exports),isVisible:!1,onOpen:()=>{X.setIsVisible(!0)},onClose:()=>{X.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"paintBucket",title:$63d0b335c576c718$export$ce37e184d908d785("tool-paint-bucket"),image:$parcel$interopDefault($43ffa4c6f98eaf6b$exports),isVisible:!1,onOpen:()=>{this.klColorSlider.enable(!0),Y.setIsVisible(!0)},onClose:()=>{Y.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"gradient",title:$63d0b335c576c718$export$ce37e184d908d785("tool-gradient"),image:$parcel$interopDefault($c4a14de060935e98$exports),isVisible:!1,onOpen:()=>{this.klColorSlider.enable(!0),G.setIsVisible(!0)},onClose:()=>{G.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"text",title:$63d0b335c576c718$export$ce37e184d908d785("tool-text"),image:$parcel$interopDefault($821d1b86107d7d25$exports),isVisible:!1,onOpen:()=>{this.klColorSlider.enable(!0),q.setIsVisible(!0)},onClose:()=>{q.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"shape",title:$63d0b335c576c718$export$ce37e184d908d785("tool-shape"),image:$parcel$interopDefault($fd406f4e4b510fcf$exports),isVisible:!1,onOpen:()=>{this.klColorSlider.enable(!0),$.setIsVisible(!0)},onClose:()=>{$.setIsVisible(!1)},css:{minWidth:"45px"}},{id:"select",title:$63d0b335c576c718$export$ce37e184d908d785("tool-select"),image:$parcel$interopDefault($7783104c7d4a03b1$exports),isVisible:!1,onOpen:()=>{P.getSelectUi().setIsVisible(!0)},onClose:()=>{P.getSelectUi().setIsVisible(!1)},css:{minWidth:"45px"}},{id:"layers",title:$63d0b335c576c718$export$ce37e184d908d785("layers"),image:$parcel$interopDefault($4c22caf787ef90d3$exports),onOpen:()=>{this.layersUi.update(),this.layersUi.getElement().style.display="block"},onClose:()=>{this.layersUi.getElement().style.display="none"},css:{minWidth:"45px"}},{id:"edit",title:$63d0b335c576c718$export$ce37e184d908d785("tab-edit"),image:$parcel$interopDefault($a4d127e6391465c0$exports),onOpen:()=>{Q.show()},onClose:()=>{Q.hide()},css:{minWidth:"45px"}},{id:"file",label:$63d0b335c576c718$export$ce37e184d908d785("tab-file"),isVisible:!!tn,onOpen:()=>{tn&&(tn.getElement().style.display="block",tn.setIsVisible(!0))},onClose:()=>{tn&&(tn.getElement().style.display="none",tn.setIsVisible(!1))},css:{padding:"0 7px"}},{id:"settings",title:$63d0b335c576c718$export$ce37e184d908d785("tab-settings"),image:$parcel$interopDefault($b1066d3ce24bdbb8$exports),onOpen:()=>{tr.getElement().style.display="block"},onClose:()=>{tr.getElement().style.display="none"},css:{minWidth:"45px"}}]}),this.bottomBarWrapper=$2Eggz.BB.el({css:{width:"270px",position:"absolute",bottom:"0",left:"0"}}),t.bottomBar&&(this.bottomBar=t.bottomBar,this.bottomBarWrapper.append(this.bottomBar),new MutationObserver(()=>this.updateBottomBar()).observe(this.toolspaceInner,{attributes:!0,childList:!0,subtree:!0})),$2Eggz.BB.append(this.toolspaceInner,[this.layerPreview.getElement(),l.getElement(),U,X.getElement(),Y.getElement(),G.getElement(),q.getElement(),$.getElement(),P.getSelectUi().getElement(),this.layersUi.getElement(),Q.getElement(),tn?tn.getElement():void 0,tr.getElement(),$2Eggz.BB.el({css:{height:"10px"}}),this.bottomBarWrapper?this.bottomBarWrapper:void 0]),this.toolspaceScroller=new $49faab2330529a96$export$6e4a713ddcda1e5e.ToolspaceScroller({toolspace:this.toolspace,uiState:this.uiLayout}),this.embed||Object.defineProperty(window,"KL",{value:$1050fcf084a1ca84$export$982e7602957287fa({onDraw:t=>{t&&0!==t.length&&(t.forEach((t,e)=>{0===e?s.startLine(t.x,t.y,1):s.goLine(t.x,t.y,1)}),s.endLine())}}),writable:!1}),this.resize(this.uiWidth,this.uiHeight),this.updateUi();let ta=new $d4355fc62c3bbadf$export$1ec1306c0c05d48d({klRootEl:this.rootEl,maxCanvasSize:h,layersUi:this.layersUi,setCurrentLayer:F,klCanvas:this.klCanvas,onImportConfirm:()=>{this.easelProjectUpdater.update(),this.easel.resetOrFitTransform(!0)},applyUncommitted:()=>E()},{onColor:t=>w.setColor(t)});(!this.embed||this.embed.enableImageDropperImport)&&(new $49faab2330529a96$export$6e4a713ddcda1e5e.KlImageDropper({target:document.body,onDrop:(t,e)=>{$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()>0||(E(),ta.handleFileSelect(t,e))},enabledTest:()=>0===$49faab2330529a96$export$6e4a713ddcda1e5e.DIALOG_COUNTER.get()}),window.document.addEventListener("paste",t=>ta.onPaste(t),!1)),this.unloadWarningTrigger=new $8545773f317e59cd$export$747c5e57cda7ca57({klHistory:this.klHistory,getLastSavedHistoryIndex:()=>this.lastSavedHistoryIndex});{window.addEventListener("resize",()=>{this.resize(window.innerWidth,window.innerHeight)}),window.addEventListener("orientationchange",()=>{this.resize(window.innerWidth,window.innerHeight)}),"visualViewport"in window&&null!==visualViewport&&visualViewport.addEventListener("resize",()=>{this.resize(window.innerWidth,window.innerHeight)});let t=$2Eggz.BB.el({parent:document.body,css:{position:"fixed",left:"0",top:"0",right:"0",bottom:"0",pointerEvents:"none",zIndex:"-1",userSelect:"none"}});try{new ResizeObserver(()=>this.resize(window.innerWidth,window.innerHeight)).observe(t)}catch(e){t.remove()}this.rootEl.addEventListener("wheel",t=>{_.isPressed("ctrl")&&t.preventDefault()},{passive:!1});let e=t=>{t.preventDefault()};window.addEventListener("gesturestart",e,{passive:!1}),window.addEventListener("gesturechange",e,{passive:!1}),window.addEventListener("gestureend",e,{passive:!1}),new $a5b80f2248448743$export$3e66e8feec69f8d}this.embed||setTimeout(()=>{$df709f40cddecd59$export$4a2ed1038e76f37f({projectStore:c,klRecoveryManager:g,onOpenBrowserStorage:ts,klHistory:this.klHistory})}),null==(e=this.saveReminder)||e.init()}}function $8e7310a6fc595c9c$var$showInitError(t){let e=document.createElement("div");e.style.textAlign="center",e.style.background="#fff",e.style.padding="20px",e.innerHTML="<h1>App failed to initialize</h1>";let i=document.createElement("div");i.textContent="Error: "+(t.message?t.message:""+t),e.append(i),document.body.append(e),console.error(t)}(async()=>{try{let t,e=[];await $63d0b335c576c718$export$7a2ea9f2e4d199d3(),$2a3419e253354ddb$export$8d693ea241b9d9a6.init($2a3419e253354ddb$export$620c18ffd80459f1(),$2a3419e253354ddb$export$94f2205ed1af0024,$2a3419e253354ddb$export$889f6d04a9c72786,$2a3419e253354ddb$export$a11d3f631bfac1e6),await $2a3419e253354ddb$export$8d693ea241b9d9a6.testConnection()||e.push($63d0b335c576c718$export$ce37e184d908d785("file-storage-cant-access"));let i=$2a3419e253354ddb$export$8d693ea241b9d9a6.getIsAvailable()?new $b2aa268a64dedc9f$export$36c5c4b26ead79bd({}):void 0;try{let s=i?await i.getRecovery():void 0;s&&(t=s.project,e.push($63d0b335c576c718$export$ce37e184d908d785("tab-recovery-recovered")))}catch(t){setTimeout(()=>{throw t}),e.push($63d0b335c576c718$export$ce37e184d908d785("tab-recovery-failed-to-recover"))}let s=document.getElementById("loading-screen");null==s||s.remove();let n=new $b7af2ed4a75d4700$export$96f6458b62e4c2c({project:t,klRecoveryManager:i});document.body.append(n.getElement()),setTimeout(()=>{e.forEach(t=>{n.out(t)})},100)}catch(t){$8e7310a6fc595c9c$var$showInitError(t)}})();
//# sourceMappingURL=klecks.65963c80.js.map
